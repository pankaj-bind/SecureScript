{
  "check_type": "CONDITIONAL",
  "condition": {
    "type": "AND",
    "rules": [
      {
        "type": "CMD_EXEC",
        "description": "GDM is installed",
        "cmd": "/bin/dpkg -s gdm3 2>&1 | /bin/grep -E '(^Status:|not installed)'",
        "expect": "^Status: install ok"
      }
    ]
  },
  "then": {
    "report": {
      "description": "1.7.2 Ensure GDM login banner is configured",
      "info": "GDM is the GNOME Display Manager which handles graphical login for GNOME based systems.\n\nWarning messages inform users who are attempting to login to the system of their legal status regarding the system and must include the name of the organization that owns the system and any monitoring policies that are in place.",
      "solution": "\"- IF - A user profile is already created run the following commands to set and enable the text banner message on the login screen:\n\n# gsettings set org.gnome.login-screen banner-message-text 'Authorized uses only. All activity may be monitored and reported' # gsettings set org.gnome.login-screen banner-message-enable true",
      "Note": "- Users must log out and back in again before the system-wide settings take effect.\n - There is no character limit for the banner message. gnome-shell autodetects longer stretches of text and enters two column mode.\n - The banner message cannot be read from an external file.\"",
      "user-db": "user",
      "system-db": "gdm",
      "file-db": "/usr/share/gdm/greeter-dconf-defaults",
      "<xhtml": "ol start=\\\"2\\\"> - Create a gdm keyfile for machine-wide settings in /etc/dconf/db/gdm.d/01-banner-message :\n\n[org/gnome/login-screen]\nbanner-message-enable=true\nbanner-message-text='Type the banner message here.' <xhtml:ol start=\\\"3\\\"> - Update the system databases\n\n# dconf update",
      "reference": "800-171|3.1.9,800-171r3|03.01.09,800-53|AC-8,800-53r5|AC-8,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.5,ITSG-33|AC-8,LEVEL|1A,NESA|M1.3.6,TBA-FIISB|45.2.4",
      "see_also": "https://workbench.cisecurity.org/benchmarks/18959",
      "show_output": true,
      "type": "PASSED"
    }
  }
}