{
  "type": "CMD_EXEC",
  "description": "2.1.16 Ensure tftp server services are not in use",
  "info": "Trivial File Transfer Protocol (TFTP) is a simple protocol for exchanging files between two TCP/IP machines. TFTP servers allow connections from a TFTP Client for sending and receiving files.\n\nUnless there is a need to run the system as a TFTP server, it is recommended that the package be removed to reduce the potential attack surface.\n\nTFTP does not have built-in encryption, access control or authentication. This makes it very easy for an attacker to exploit TFTP to gain access to files",
  "solution": "\"Run the following commands to stop tftpd-hpa.service and remove the tftpd-hpa package:\n\n# systemctl stop tftpd-hpa.service\n# apt purge tftpd-hpa\n\n- OR -\n\n- IF - the tftpd-hpa package is required as a dependency:\n\nRun the following commands to stop and mask tftpd-hpa.service :\n\n# systemctl stop tftpd-hpa.service\n# systemctl mask tftpd-hpa.service",
  "Impact": "TFTP is often used to provide files for network booting such as for PXE based installation of servers.\n\nThere may be packages that are dependent on the tftpd-hpa package. If the tftpd-hpa package is removed, these dependent packages will be removed as well. Before removing the tftpd-hpa package, review any dependent packages to determine if they are required on the system.\n\n- IF - a dependent package is required: stop and mask tftpd-hpa.service leaving the tftpd-hpa package installed.\"",
  "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
  "see_also": "https://workbench.cisecurity.org/benchmarks/18959",
  "cmd": "/bin/dpkg -s tftpd-hpa 2>&1 | /bin/grep -E '(^Status:|not installed)'",
  "expect": "(^Status: deinstall ok|not installed)"
}