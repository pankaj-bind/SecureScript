{
  "check_type": "CONDITIONAL",
  "condition": {
    "auto_status": "FAILED",
    "type": "AND",
    "rules": [
      {
        "type": "FILE_CONTENT_CHECK",
        "description": "/etc/pam.d/common-password",
        "file": "/etc/pam.d/common-password",
        "regex": "^\\\\h*password\\\\h+[^#\\\\n\\\\r]+\\\\h+pam_unix\\\\.so\\\\b",
        "expect": "^\\\\h*password\\\\h+[^#\\\\n\\\\r]+\\\\h+pam_unix\\\\.so\\\\b"
      },
      {
        "type": "FILE_CONTENT_CHECK",
        "description": "/etc/pam.d/common-account",
        "file": "/etc/pam.d/common-account",
        "regex": "^\\\\h*account\\\\h+[^#\\\\n\\\\r]+\\\\h+pam_unix\\\\.so\\\\b",
        "expect": "^\\\\h*account\\\\h+[^#\\\\n\\\\r]+\\\\h+pam_unix\\\\.so\\\\b"
      },
      {
        "type": "FILE_CONTENT_CHECK",
        "description": "/etc/pam.d/common-session",
        "file": "/etc/pam.d/common-session",
        "regex": "^\\\\h*session\\\\h+[^#\\\\n\\\\r]+\\\\h+pam_unix\\\\.so\\\\b",
        "expect": "^\\\\h*session\\\\h+[^#\\\\n\\\\r]+\\\\h+pam_unix\\\\.so\\\\b"
      },
      {
        "type": "FILE_CONTENT_CHECK",
        "description": "/etc/pam.d/common-auth",
        "file": "/etc/pam.d/common-auth",
        "regex": "^\\\\h*auth\\\\h+[^#\\\\n\\\\r]+\\\\h+pam_unix\\\\.so\\\\b",
        "expect": "^\\\\h*auth\\\\h+[^#\\\\n\\\\r]+\\\\h+pam_unix\\\\.so\\\\b"
      }
    ]
  },
  "then": {
    "report": {
      "description": "5.3.2.1 Ensure pam_unix module is enabled",
      "info": "pam_unix is the standard Unix authentication module. It uses standard calls from the system's libraries to retrieve and set account information as well as authentication. Usually this is obtained from the /etc/passwd and if shadow is enabled, the /etc/shadow file as well.\n\nThe account component performs the task of establishing the status of the user's account and password based on the following shadow elements: expire last_change max_change min_change warn_change In the case of the latter, it may offer advice to the user on changing their password or, through the PAM_AUTHTOKEN_REQD return, delay giving service to the user until they have established a new password. The entries listed above are documented in the shadow(5) manual page. Should the user's record not contain one or more of these entries, the corresponding shadow check is not performed.\n\nThe authentication component performs the task of checking the users credentials (password). The default action of this module is to not permit the user access to a service if their official password is blank.\n\nThe system should only provide access after performing authentication of a user.",
      "solution": "\"Run the following command to enable the pam_unix module:\n\n# pam-auth-update --enable unix",
      "Note": "If a site specific custom profile is being used in your environment to configure PAM that includes the configuration for the pam_faillock module, enable that module instead\"",
      "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-171r3|03.01.02,800-171r3|03.01.04,800-171r3|03.01.05a.,800-171r3|03.08.02,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,CSF2.0|PR.AA-05,CSF2.0|PR.DS-10,CSF2.0|PR.IR-01,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO-27001-2022|A.5.3,ISO-27001-2022|A.5.10,ISO-27001-2022|A.5.15,ISO-27001-2022|A.5.33,ISO-27001-2022|A.7.7,ISO-27001-2022|A.7.10,ISO-27001-2022|A.8.2,ISO-27001-2022|A.8.3,ISO-27001-2022|A.8.18,ISO-27001-2022|A.8.20,ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
      "see_also": "https://workbench.cisecurity.org/benchmarks/18959",
      "show_output": true,
      "type": "PASSED"
    }
  }
}