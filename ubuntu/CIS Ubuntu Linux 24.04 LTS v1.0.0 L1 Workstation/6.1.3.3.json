{
  "check_type": "CONDITIONAL",
  "condition": {
    "type": "OR",
    "rules": [
      {
        "type": "CMD_EXEC",
        "description": "journald check - active",
        "cmd": "/bin/systemctl is-active systemd-journald",
        "expect": "^active$"
      },
      {
        "type": "CMD_EXEC",
        "description": "active",
        "cmd": "/bin/systemctl is-active rsyslog",
        "expect": "^active$"
      }
    ]
  },
  "then": {
    "report": {
      "description": "6.1.3.3 Ensure journald is configured to send logs to rsyslog",
      "info": "\"Data from systemd-journald may be stored in volatile memory or persisted locally on the server. Utilities exist to accept remote export of systemd-journald logs, however, use of the rsyslog service provides a consistent means of log collection and export.\n\n- IF - rsyslog is the preferred method for capturing logs, all logs of the system should be sent to it for further processing.",
      "Note": "If this setting appears in a canonically later file, or later in the same file, the setting will be overwritten\n\nRun to following command to update the parameters in the service:\n\nRestart systemd-journald.service :\n\n# systemctl reload-or-restart systemd-journald.service\"",
      "solution": "\"- IF - Journald is the preferred method for capturing logs, this section and Recommendation should be skipped and the \\\"Configure Journald\\\" section followed.\n\n- IF - rsyslog is the preferred method for capturing logs:\n\nSet the following parameter in the [Journal] section in /etc/systemd/journald.conf or a file in /etc/systemd/journald.conf.d/ ending inconf :\n\nForwardToSyslog=yes\n\nExample script to create systemd drop-in configuration file:\n\n#!/usr/bin/env bash\n\n{\n   a_settings=(\\\"ForwardToSyslog=yes\\\")\n   [ ! -d /etc/systemd/journald.conf.d/ ] && mkdir /etc/systemd/journald.conf.d/\n   if grep -Psq -- '^\\h*\\[Journal\\]' /etc/systemd/journald.conf.d/60-journald.conf; then\n      printf '%s\\n' \\\"\\\" \\\"${a_settings[@]}\\\" >> /etc/systemd/journald.conf.d/60-journald.conf\n   else\n      printf '%s\\n' \\\"\\\" \\\"[Journal]\\\" \\\"${a_settings[@]}\\\" >> /etc/systemd/journald.conf.d/60-journald.conf\n   fi\n}",
      "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.5,800-171|3.3.6,800-171r3|03.03.01,800-171r3|03.03.03,800-171r3|03.03.05c.,800-171r3|03.03.06a.,800-53|AU-2,800-53|AU-6(3),800-53|AU-7,800-53|AU-12,800-53r5|AU-2,800-53r5|AU-6(3),800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(c),CN-L3|7.1.3.3(d),CN-L3|8.1.4.3(a),CSCv7|6.2,CSCv7|6.3,CSCv7|6.5,CSCv8|8.2,CSCv8|8.9,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|DE.DP-4,CSF|PR.PT-1,CSF|RS.AN-1,CSF|RS.AN-3,CSF|RS.CO-2,CSF2.0|DE.AE-02,CSF2.0|DE.AE-03,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|DE.CM-09,CSF2.0|PR.PS-04,CSF2.0|RS.AN-03,CSF2.0|RS.AN-06,CSF2.0|RS.AN-07,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO-27001-2022|A.5.25,ISO-27001-2022|A.6.8,ISO-27001-2022|A.8.15,ITSG-33|AU-2,ITSG-33|AU-6(3),ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1A,NESA|M1.2.2,NESA|M5.2.5,NESA|M5.5.1,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|SS30,NIAv2|VL8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
      "see_also": "https://workbench.cisecurity.org/benchmarks/18959",
      "show_output": true,
      "type": "PASSED"
    }
  }
}