{
  "type": "CMD_EXEC",
  "description": "6.1.1.4 Ensure only one logging system is in use",
  "info": "Best practices recommend that a single centralized logging system be used for log management, choose a single service either rsyslog - OR - journald to be used as a single centralized logging system.\n\nConfiguring only one logging service either rsyslog - OR - journald avoids redundancy, optimizes resources, simplifies configuration and management, and ensures consistency.",
  "solution": "\"- Determine whether to use journald - OR - rsyslog depending on site needs\n - Configure systemd-jounald.service\n - Configure only ONE either journald - OR - rsyslog and complete the recommendations in that subsection\n - Return to this recommendation to ensure only one logging system is in use",
  "Impact": "Transitioning from one logging service to another can be complex and time consuming, it involves reconfiguration and may result in data loss if not managed and reconfigured correctly.\"",
  "reference": "800-171|3.3.1,800-171|3.3.2,800-171r3|03.03.01,800-53|AU-2,800-53r5|AU-2,CN-L3|8.1.4.3(a),CSF|PR.PT-1,CSF2.0|PR.PS-04,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO-27001-2022|A.8.15,ITSG-33|AU-2,LEVEL|1A,NESA|M1.2.2,NESA|M5.5.1,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|SS30,NIAv2|VL8,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
  "see_also": "https://workbench.cisecurity.org/benchmarks/18959",
  "cmd": "#!/bin/bash\n\n{\n  l_output=\\\"\\\" l_output2=\\\"\\\" # Check the status of rsyslog and journald\n  if systemctl is-active --quiet rsyslog; then\n    l_output=\\\"$l_output\\\\n - rsyslog is in use\\\\n- follow the recommendations in Configure rsyslog subsection only\\\"\n  elif systemctl is-active --quiet systemd-journald; then\n    l_output=\\\"$l_output\\\\n - journald is in use\\\\n- follow the recommendations in Configure journald subsection only\\\"\n  else\n    echo -e \\\"unable to determine system logging\\\"\n    l_output2=\\\"$l_output2\\\\n - unable to determine system logging\\\\n- Configure only ONE system logging: rsyslog OR journald\\\"\n  fi\n  if [ -z \\\"$l_output2\\\" ]; then # Provide audit results\n    echo -e \\\"\\\\n- Audit Result:\\\\n ** PASS **\\\\n$l_output\\\\n\\\"\n  else\n    echo -e \\\"\\\\n- Audit Result:\\\\n ** FAIL **\\\\n - Reason(s) for audit failure:\\\\n$l_output2\\\"\n  fi\n}",
  "expect": "(?i)^[\\\\s]*\\\\**[\\\\s]*pass:?[\\\\s]*\\\\**$"
}