{
  "check_type": "CONDITIONAL",
  "condition": {
    "type": "AND",
    "rules": [
      {
        "type": "CMD_EXEC",
        "description": "dpkg check systemd-timesyncd",
        "cmd": "/bin/dpkg -s systemd-timesyncd | /bin/grep -E Status:",
        "expect": "^Status: install ok installed$"
      }
    ]
  },
  "then": {
    "report": {
      "description": "2.3.2.2 Ensure systemd-timesyncd is enabled and running",
      "info": "systemd-timesyncd is a daemon that has been added for synchronizing the system clock across the network\n\nsystemd-timesyncd needs to be enabled and running in order to synchronize the system to a timeserver.\n\nTime synchronization is important to support time sensitive security mechanisms and to ensure log files have consistent time records across the enterprise to aid in forensic investigations",
      "solution": "- IF - systemd-timesyncd is in use on the system, run the following commands:\n\nRun the following command to unmask systemd-timesyncd.service :\n\n# systemctl unmask systemd-timesyncd.service\n\nRun the following command to enable and start systemd-timesyncd.service :\n\n# systemctl --now enable systemd-timesyncd.service\n\n- OR -\n\nIf another time synchronization service is in use on the system, run the following command to stop and mask systemd-timesyncd :\n\n# systemctl --now mask systemd-timesyncd.service",
      "reference": "800-171|3.3.6,800-171|3.3.7,800-171r3|03.03.06a.,800-171r3|03.03.07,800-53|AU-7,800-53|AU-8,800-53r5|AU-7,800-53r5|AU-8,CN-L3|7.1.2.3(c),CN-L3|8.1.4.3(b),CSCv7|6.1,CSCv8|8.4,CSF|PR.PT-1,CSF|RS.AN-3,CSF2.0|PR.PS-04,CSF2.0|RS.AN-03,CSF2.0|RS.AN-06,CSF2.0|RS.AN-07,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO-27001-2022|A.8.17,ITSG-33|AU-7,ITSG-33|AU-8,LEVEL|1A,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4,TBA-FIISB|37.4",
      "see_also": "https://workbench.cisecurity.org/benchmarks/18959",
      "show_output": true,
      "type": "PASSED"
    }
  }
}