{
  "check_type": "CONDITIONAL",
  "condition": {
    "auto_status": "FAILED",
    "type": "AND",
    "rules": [
      {
        "type": "FILE_CONTENT_CHECK",
        "description": "/etc/security/faillock.conf",
        "file": "/etc/security/faillock.conf",
        "regex": "(?i)^\\\\h*unlock_time\\\\h*=",
        "expect": "(?i)^\\\\h*unlock_time\\\\h*=\\\\h*@PASSWORD_UNLOCK_TIME@\\\\b"
      },
      {
        "type": "FILE_CONTENT_CHECK",
        "description": "/etc/pam.d/common-auth",
        "file": "/etc/pam.d/common-auth",
        "regex": "^\\\\h*auth\\\\h+(requisite|required|sufficient)\\\\h+pam_faillock\\\\.so\\\\h+([^#\\\\r]+\\\\h+)?unlock_time\\\\h*=",
        "expect": "^\\\\h*auth\\\\h+(requisite|required|sufficient)\\\\h+pam_faillock\\\\.so\\\\h+([^#\\\\r]+\\\\h+)?unlock_time\\\\h*=\\\\h*@PASSWORD_UNLOCK_TIME@\\\\b",
        "string_required": false
      }
    ]
  },
  "then": {
    "report": {
      "description": "5.3.3.1.2 Ensure password unlock time is configured",
      "info": "\"unlock_time=<n> - The access will be re-enabled after\n\nseconds after the lock out. The value 0 has the same meaning as value never - the access will not be re-enabled without resetting the faillock entries by the faillock(8) command.",
      "Note": "- The default directory that pam_faillock uses is usually cleared on system boot so the access will be also re-enabled after system reboot. If that is undesirable a different tally directory must be set with the dir option.\n - It is usually undesirable to permanently lock out users as they can become easily a target of denial of service attack unless the usernames are random and kept secret to potential attackers.\n - The maximum configurable value for unlock_time is 604800\n\nLocking out user IDs after\n\nn\n\nunsuccessful consecutive login attempts mitigates brute force password attacks against your systems.\"",
      "solution": "\"Set password unlock time to conform to site policy. unlock_time should be 0 (never), or 900 seconds or greater.\n\nEdit /etc/security/faillock.conf and update or add the following line:\n\nunlock_time = 900\n\nRun the following command: remove the unlock_time argument from the pam_faillock.so module in the PAM files:\n\n# grep -Pl -- '\\bpam_faillock\\.so\\h+([^#\\n\\r]+\\h+)?unlock_time\\b' /usr/share/pam-configs/*\n\nEdit any returned files and remove the unlock_time=<N> argument from the pam_faillock.so line(s):",
      "Impact": "Use of unlock_time=0 may allow an attacker to cause denial of service to legitimate users. This will also require a systems administrator with elevated privileges to unlock the account.\"",
      "reference": "800-171|3.1.1,800-171r3|03.01.01,800-171r3|03.15.01,800-53|AC-1,800-53|AC-2,800-53|AC-2(1),800-53r5|AC-1,800-53r5|AC-2,800-53r5|AC-2(1),CN-L3|7.1.3.2(d),CN-L3|8.1.4.2(e),CN-L3|8.1.10.6(c),CSCv7|16.7,CSCv8|6.2,CSF|DE.CM-1,CSF|DE.CM-3,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|GV.OC-03,CSF2.0|GV.OV-01,CSF2.0|GV.PO-01,CSF2.0|GV.PO-02,CSF2.0|GV.SC-03,CSF2.0|ID.IM-01,CSF2.0|ID.IM-02,CSF2.0|ID.IM-03,CSF2.0|PR.AA-01,CSF2.0|PR.AA-05,CSF2.0|PR.DS-10,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO-27001-2022|A.5.1,ISO-27001-2022|A.5.2,ISO-27001-2022|A.5.4,ISO-27001-2022|A.5.15,ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.18,ISO-27001-2022|A.5.31,ISO-27001-2022|A.5.36,ISO-27001-2022|A.5.37,ISO-27001-2022|A.8.2,ISO-27001-2022|5.2,ISO-27001-2022|5.3,ISO-27001-2022|7.5.1,ISO-27001-2022|7.5.2,ISO-27001-2022|7.5.3,ISO/IEC-27001|A.9.1.1,ISO/IEC-27001|A.9.2.1,ITSG-33|AC-1,ITSG-33|AC-2,ITSG-33|AC-2(1),LEVEL|1A,NESA|M1.2.2,NIAv2|AM28,NIAv2|AM29,NIAv2|AM30,NIAv2|NS5j,NIAv2|SS14e,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2",
      "see_also": "https://workbench.cisecurity.org/benchmarks/18959",
      "show_output": true,
      "type": "PASSED"
    }
  }
}