{
  "type": "CMD_EXEC",
  "description": "2.1.15 Ensure snmp services are not in use",
  "info": "\"Simple Network Management Protocol (SNMP) is a widely used protocol for monitoring the health and welfare of network equipment, computer equipment and devices like UPSs.\n\nNet-SNMP is a suite of applications used to implement SNMPv1 (RFC 1157), SNMPv2 (RFCs 1901-1908), and SNMPv3 (RFCs 3411-3418) using both IPv4 and IPv6.\n\nSupport for SNMPv2 classic (a.k.a. \\\"SNMPv2 historic\\\" - RFCs 1441-1452) was dropped with the 4.0 release of the UCD-snmp package.\n\nThe Simple Network Management Protocol (SNMP) server is used to listen for SNMP commands from an SNMP management system, execute the commands or collect the information and then send results back to the requesting system.\n\nThe SNMP server can communicate using SNMPv1 which transmits data in the clear and does not require authentication to execute commands. SNMPv3 replaces the simple/clear text password sharing used in SNMPv2 with more securely encoded parameters. If the the SNMP service is not required, the snmpd package should be removed to reduce the attack surface of the system.",
  "Note": "If SNMP is required:\n\n - The server should be configured for SNMP v3 only. User Authentication and Message Encryption should be configured.\n - If SNMP v2 is absolutely necessary, modify the community strings' values.\"",
  "solution": "\"Run the following commands to stop snmpd.service and remove the snmpd package:\n\n# systemctl stop snmpd.service\n# apt purge snmpd\n\n- OR - If the package is required for dependencies:\n\nRun the following commands to stop and mask the snmpd.service :\n\n# systemctl stop snmpd.service\n# systemctl mask snmpd.service",
  "Impact": "There may be packages that are dependent on the snmpd package. If the snmpd package is removed, these packages will be removed as well.\n\nBefore removing the snmpd package, review any dependent packages to determine if they are required on the system. If a dependent package is required, stop and mask the snmpd.service leaving the snmpd package installed.\"",
  "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
  "see_also": "https://workbench.cisecurity.org/benchmarks/18959",
  "cmd": "/bin/dpkg -s snmpd 2>&1 | /bin/grep -E '(^Status:|not installed)'",
  "expect": "(^Status: deinstall ok|not installed)"
}