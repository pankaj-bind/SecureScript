{
  "type": "CMD_EXEC",
  "description": "2.1.6 Ensure ftp server services are not in use",
  "info": "The File Transfer Protocol (FTP) provides networked computers with the ability to transfer files. vsftpd is the Very Secure File Transfer Protocol Daemon.\n\nFTP does not protect the confidentiality of data or authentication credentials. It is recommended SFTP be used if file transfer is required. Unless there is a need to run the system as a FTP server (for example, to allow anonymous downloads), it is recommended that the package be deleted to reduce the potential attack surface.",
  "solution": "\"Run the following commands to stop vsftpd.service and remove the vsftpd package:\n\n# systemctl stop vsftpd.service\n# apt purge vsftpd\n\n- OR -\n\n- IF - the vsftpd package is required as a dependency:\n\nRun the following commands to stop and mask the vsftpd.service :\n\n# systemctl stop vsftpd.service\n# systemctl mask vsftpd.service",
  "Note": "Other ftp server packages may exist. If not required and authorized by local site policy, they should also be removed. If the package is required for a dependency, the service should be stopped and masked.",
  "Impact": "There may be packages that are dependent on the vsftpd package. If the vsftpd package is removed, these dependent packages will be removed as well. Before removing the vsftpd package, review any dependent packages to determine if they are required on the system.\n\n- IF - a dependent package is required: stop and mask the vsftpd.service leaving the vsftpd package installed.\"",
  "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
  "see_also": "https://workbench.cisecurity.org/benchmarks/18959",
  "cmd": "/bin/dpkg -s vsftpd 2>&1 | /bin/grep -E '(^Status:|not installed)'",
  "expect": "(^Status: deinstall ok|not installed)"
}