{
  "type": "FILE_CONTENT_CHECK",
  "description": "5.3.3.2.8 Ensure password quality is enforced for the root user",
  "info": "\"If the pwquality enforce_for_root option is enabled, the module will return error on failed check even if the user changing the password is root.\n\nThis option is off by default which means that just the message about the failed check is printed but root can change the password anyway.",
  "Note": "The root is not asked for an old password so the checks that compare the old and new password are not performed.\n\nUse of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determines how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.\"",
  "solution": "\"Edit or add the following line in a *.conf file in /etc/security/pwquality.conf.d or in /etc/security/pwquality.conf :",
  "Example": "#!/urs/bin/env bash\n\n{\n   [ ! -d /etc/security/pwquality.conf.d/ ] && mkdir /etc/security/pwquality.conf.d/\n   printf '\\n%s\\n' \\\"enforce_for_root\\\" > /etc/security/pwquality.conf.d/50-pwroot.conf\n}\"",
  "reference": "800-171|3.5.2,800-171r3|03.05.07,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.17,ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
  "see_also": "https://workbench.cisecurity.org/benchmarks/18959",
  "file": "/etc/security/pwquality.conf /etc/security/pwquality.conf.d/*.conf",
  "regex": "(?i)^\\\\h*enforce_for_root\\\\b",
  "expect": "(?i)^\\\\h*enforce_for_root\\\\b",
  "min_occurrences": "1",
  "string_required": false
}