{
  "type": "CMD_EXEC",
  "description": "2.1.9 Ensure network file system services are not in use",
  "info": "The Network File System (NFS) is one of the first and most widely distributed file systems in the UNIX environment. It provides the ability for systems to mount file systems of other servers through the network.\n\nIf the system does not export NFS shares, it is recommended that the nfs-kernel-server package be removed to reduce the remote attack surface.",
  "solution": "\"Run the following command to stop nfs-server.service and remove nfs-kernel-server package:\n\n# systemctl stop nfs-server.service\n# apt purge nfs-kernel-server\n\n- OR -\n\n- IF - the nfs-kernel-server package is required as a dependency:\n\nRun the following commands to stop and mask the nfs-server.service :\n\n# systemctl stop nfs-server.service\n# systemctl mask nfs-server.service",
  "Impact": "There may be packages that are dependent on the nfs-kernel-server package. If the nfs-kernel-server package is removed, these dependent packages will be removed as well. Before removing the nfs-kernel-server package, review any dependent packages to determine if they are required on the system.\n\n- IF - a dependent package is required: stop and mask the nfs-server.service leaving the nfs-kernel-server package installed.\"",
  "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
  "see_also": "https://workbench.cisecurity.org/benchmarks/18959",
  "cmd": "/bin/dpkg -s nfs-kernel-server 2>&1 | /bin/grep -E '(^Status:|not installed)'",
  "expect": "(^Status: deinstall ok|not installed)"
}