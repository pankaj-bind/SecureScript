#TRUSTED 7b9619741fcab3e113bba4002ec5f92dce213629b0cf224453015ea99f920aa429f11db05651c7dac985b3091098223ae49b4fc505d82ab6d2e1fb6a4d3080f3c13bc1f5312475ace2f93113860484f219e8002f18ea057dd873e7ae557dd9e07c6d01d45888db54718fdc9e3e6214a9020f8a1b15f99629e988c83ef38933e6f18eb6c42467f78ceac4083a037df757bd6f3ba98a41a8fd4f8c0f23104b9bfe0708bf82a21ef7046aede07d7d0f1feda012c2525dee56215f1585d1d08e8dff6264ae1e6d7917fda94487c5f9cf9290505a37cb1d28582653e70be562e9b099e05bc7049c1ac15a32b56e7bfe9e151f1ebb9bd3d9b4ab982b211b4a8771c20951c21ba3bb22cc0028789015995bbcbd106af7704396716faf21e46580e1b2d974c7ad81a18f1481ff3b97d53de4be52197175d4dbf8b4404df56a7fb793bab1aecd3497f43399bfc97f6f8fc284c2e7fced69ff85f7ece9737437acce2cf45d0727c145a5e9634bd83afa46b3ada071e6c6babb7782dfe5f5f3db5b911a327a2c23899d21f72e35d419ec078481bd4c6637c7a01a2a89b5744cfd02193e38e3dd9c46e293a2c2f3d68aac470ca596470d8c32df28ab6eb018d2ea7dc66a4e36d9bb0046e3b61ef39adb5f65f81f041e08cffd1de745bdc34921f47d713978a68342be5faf7fff5fb08422a4a124f2fb02aac9cf952ed6a75296fb2ccd3d10db
#TRUST-RSA-SHA256 a2f8627a173c6aa543702e7abef3c28d2e80d1b0300bb4972b3409b01ae62658ee138b0e09b7ab35ad35cfbe180022510bc5ae1941626b82025e73fce71d362f5c1c35b5da317538cfe91ec35a7dc481c13ca3b2f2fb82954d123b363f60c62b0a43a59d8df223f52b34fd24810184a080c398fa41e4dd01f9a6d50888f8a025628b726874fbfa3222459a0815ee62bd36ee43836a2f5246fd391c21d46548ff7657d486ae9b55efbf9471a05c2e38487475365d52f286c0dd398c0029a462bc1bc8d45937f47991c438bb12bc012136ee0c9258625c7c14d2141e3cd89bc41d903071ad8b9548b196de7b1eafef59d9cd5a17779bb59fa4adc5ebbd28e60f3895dab6d01b6638bf857638e78bc7365d47f6f1af2a0fae03c507b98185510dbee9f08465786a1f92587a9428eacb27bd198e7a4ae1c3d1a7e93e745a7a233b10fbf5d7508e7f2c76f320d1eb9a808fd812c9a547092ccf4e514538011da5f9ea0b7e245214b14077860c63c3a6b41126cd9857e864c184d689319c85c9c21481ef00d2ea8c3fa4bdfe1f5c21f8f721c7ca96cdfe265dc4c78c2e0c421889878b719bae881abced646f7a4645c4d04df845fb37c22d3c542760ba0d97a18882a6ca943dff09a33dc33b25f0431daad53b7feabc544b32e71cbe9f94990dc3a28e7976e94c2b2a21979454c367e91700b9333d1a56c28b67cb96cf15267b33a758
#
# This script is Copyright (C) 2004-2025 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
# $Revision: 1.0 $
# $Date: 2025/06/24 $
#
# description : This .audit is designed against the DISA Oracle Database 19c STIG v1r1
#
#<ui_metadata>
#<display_name>DISA Oracle Database 19c STIG v1r1 Unix</display_name>
#<spec>
#  <type>DISA STIG</type>
#  <name>Oracle Database 19c</name>
#  <profile>OS Unix</profile>
#  <version>1.1.0</version>
#  <link>https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_Database_19c_V1R1_STIG.zip</link>
#</spec>
#<labels>agent,distribution_independent_linux,unix,disa,oracle_database_19c_stig,oracle_19c</labels>
#<benchmark_refs>CAT,CCE,CCI,DISA_Benchmark,Group-ID,Rule-ID,STIG-ID,STIG-Legacy,Vuln-ID</benchmark_refs>
#<variables>
#  <variable>
#    <name>ORACLE_HOME</name>
#    <default>/opt/oracle/product/19c/dbhome_1</default>
#    <description>Oracle Home</description>
#    <info>The directory where your Oracle installation is located.</info>
#    <value_type>UNIX_FILE_PATH</value_type>
#  </variable>
#  <variable>
#    <name>ORACLE_GROUP</name>
#    <default>oinstall</default>
#    <description>Oracle Group</description>
#    <info>The group that the Oracle user belongs to.</info>
#    <value_type>UNIX_ACCT</value_type>
#  </variable>
#  <variable>
#    <name>ORACLE_GROUP_MEMBERS</name>
#    <default>oracle</default>
#    <description>Oracle Group Members</description>
#    <info>The list of users authorized to be member of the Oracle group, separated by commas.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>LISTENER_LIST</name>
#    <default>LISTENER</default>
#    <description>Oracle Listener List</description>
#    <info>The space delimited list of listeners configured on your server</info>
#    <value_type>SQL_REQUEST_VALUE</value_type>
#  </variable>
#  <variable>
#    <name>SRC_IP</name>
#    <default>192.168.0.50/24</default>
#    <description>Oracle Connection Manager Source IP</description>
#    <info>The source IP (in CIDR notation) for Oracle Connection Manager traffic</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>DEST_IP</name>
#    <default>192.168.0.99</default>
#    <description>Oracle Connection Manager Destination IP</description>
#    <info>The destination IP or hostname for Oracle Connection Manager traffic</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>ORACLE_DIAG</name>
#    <default>/opt/oracle/diag</default>
#    <description>Oracle Diagnostic Data</description>
#    <info>The directory where your Oracle installation stores diagnostic data.</info>
#    <value_type>UNIX_FILE_PATH</value_type>
#  </variable>
#  <variable>
#    <name>DBA_ACCTS</name>
#    <default>oracle|dba</default>
#    <description>Oracle DBA Accounts</description>
#    <info>The organization's DBA account list.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>SSL_CIPHERS</name>
#    <default>TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</default>
#    <description>Allowed SSL/TLS ciphers</description>
#    <info>The allowed cipher suites for connecting to the Oracle database.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>SSL_VERSION</name>
#    <default>1.3</default>
#    <description>Allowed SSL/TLS version</description>
#    <info>The allowed SSL/TLS version for connecting to the Oracle database.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>SSL_AUTH</name>
#    <default>TRUE</default>
#    <description>SSL/TLS Authentication</description>
#    <info>Whether SSL/TLS is required for connecting to the Oracle database. True for TLS, false for Kerberos or RADIUS.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>CLIENT_CHECKSUM_TYPES</name>
#    <default>SHA384</default>
#    <description>Checksum Types</description>
#    <info>Checksum types to be used by the SQLPlus Client.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>SERVER_CHECKSUM_TYPES</name>
#    <default>SHA384</default>
#    <description>Server Checksum Types</description>
#    <info>Checksum types to be used by the Oracle Server.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>CLIENT_CHECKSUM</name>
#    <default>requested</default>
#    <description>Client Checksum Status</description>
#    <info>Whether client checksums are to be requested or required.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>SERVER_CHECKSUM</name>
#    <default>required</default>
#    <description>Server Checksum Status</description>
#    <info>Whether server checksums are to be requested or required.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>CLIENT_ENCRYPTION_TYPES</name>
#    <default>AES256</default>
#    <description>Client Encryption Types</description>
#    <info>The types of encryption to be allowed by the client.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>SERVER_ENCRYPTION_TYPES</name>
#    <default>AES256</default>
#    <description>Server Encryption Types</description>
#    <info>The types of encryption to be allowed by the server.</info>
#    <value_type>STRING</value_type>
#  </variable>
#</variables>
#</ui_metadata>

<check_type:"Unix">

<if>
  <condition type:"AND">
    <custom_item>
      type        : CMD_EXEC
      description : "Linux found"
      cmd         : "uname -a"
      expect      : "Linux"
    </custom_item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "DISA_Oracle_Database_19c_STIG_v1r1.audit from DISA Oracle Database 19c STIG v1r1"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_Database_19c_V1R1_STIG.zip"
      show_output : YES
    </report>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "O19C-00-000200 - Oracle Database must protect against or limit the effects of organization-defined types of denial-of-service (DoS) attacks."
      info        : "A variety of technologies exist to limit, or in some cases, eliminate the effects of DoS attacks. For example, boundary protection devices can filter certain types of packets to protect devices on an organization's internal network from being directly affected by DoS attacks.

Employing increased capacity and bandwidth combined with service redundancy may reduce the susceptibility to some DoS attacks.

Some of the ways databases can limit their exposure to DoS attacks are through limiting the number of connections that can be opened by a single user and database clustering."
      solution    : "Implement measures to limit the effects of organization-defined types of DoS attacks.

Modify the $ORACLE_HOME/network/admin/listener.ora to establish a Rate Limit.

Restart the listener for changes to take effect.

More information can be found at https://docs.oracle.com/en/database/oracle/oracle-database/19/netrf/oracle-net-listener-parameters-in-listener-ora.html#GUID-980ED9B7-2D41-4419-BF3E-A1C96FF0F880."
      reference   : "800-53|AC-10,800-53r5|AC-10,CAT|II,CCI|CCI-000054,CSF2.0|PR.AA-05,DISA_Benchmark|Oracle_Database_19c_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-10,NESA|T5.5.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,Rule-ID|SV-270496r1064766_rule,STIG-ID|O19C-00-000200,Vuln-ID|V-270496"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_Database_19c_V1R1_STIG.zip"
      file        : "@ORACLE_HOME@/network/admin/listener.ora"
      regex       : "(?i)^[\\s]*\\([\\s]*ADDRESS[\\s]*="
      expect      : "(?i)\\(RATE_LIMIT[\\s]*=[\\s]*(YES|[1-9]|[1-9][0-9]+)"
    </custom_item>

    <report type:"WARNING">
      description : "O19C-00-006000 - Oracle Database must provide an immediate real-time alert to appropriate support staff of all audit log failures."
      info        : "It is critical for the appropriate personnel to be aware if a system is at risk of failing to process audit logs as required. Without a real-time alert, security personnel may be unaware of an impending failure of the audit capability, and system operation may be adversely affected.

The appropriate support staff include, at a minimum, the information system security officer (ISSO) and the database administrator (DBA)/system administrator (SA).

A failure of database auditing will result in either the database continuing to function without auditing or in a complete halt to database operations. When audit processing fails, appropriate personnel must be alerted immediately to avoid further downtime or unaudited transactions.

Alerts provide organizations with urgent messages. Real-time alerts provide these messages immediately (i.e., the time from event detection to alert occurs in seconds or less).

If Oracle Enterprise Manager is in use, the capability to issue such an alert is built in and configurable via the console so an alert can be sent to a designated administrator.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Configure logging software to send a real-time alert to appropriate personnel when auditing fails for any reason.

Oracle recommends the use of Oracle Enterprise Manager."
      reference   : "800-171|3.3.4,800-171r3|03.03.04,800-53|AU-5(2),800-53r5|AU-5(2),CAT|II,CCI|CCI-001858,CN-L3|7.1.3.3(e),CSF|PR.PT-1,DISA_Benchmark|Oracle_Database_19c_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-5(2),NESA|T3.6.2,NIAv2|GS7f,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-270509r1065202_rule,STIG-ID|O19C-00-006000,Vuln-ID|V-270509"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_Database_19c_V1R1_STIG.zip"
    </report>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          type        : FILE_CHECK
          description : "check $ORACLE_HOME privileges"
          file        : "@ORACLE_HOME@"
          mask        : "007"
          group       : "@ORACLE_GROUP@"
        </custom_item>

        <custom_item>
          type        : CMD_EXEC
          description : "check group members"
          cmd         : "grep @ORACLE_GROUP@ /etc/group | cut -d: -f4"
          expect      : "^(@ORACLE_GROUP_MEMBERS@)$"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "O19C-00-007300 - Oracle Database must support enforcement of logical access restrictions associated with changes to the database management system (DBMS) configuration and to the database itself."
          info        : "Failure to provide logical access restrictions associated with changes to configuration may have significant effects on the overall security of the system.

When dealing with access restrictions pertaining to change control, it should be noted that any changes to the hardware, software, and/or firmware components of the information system can potentially have significant effects on the overall security of the system.

Accordingly, only qualified and authorized individuals should be allowed to obtain access to system components for the purposes of initiating changes, including upgrades and modifications."
          solution    : "For Unix Systems:
Set the umask of the Oracle software owner account to 022. Determine the shell being used for the Oracle software owner account:

  env | grep -i shell

Startup files for each shell are as follows (located in users $HOME directory):

  C-Shell (CSH) = .cshrc
  Bourne Shell (SH) = .profile
  Korn Shell (KSH) = .kshrc
  TC Shell (TCS) = .tcshrc
  BASH Shell = .bash_profile or .bashrc

Edit the shell startup file for the account and add or modify the line:

  umask 022

Log off and log on, then enter the umask command to confirm the setting.

Note: To effect this change for all Oracle processes, a reboot of the DBMS server may be required.

For Windows Systems:
Restrict access to the DBMS software libraries to the fewest accounts that clearly require access based on job function.

Document authorized access controls and justify any access grants that do not fall under DBA, DBMS process, ownership, or system administrator (SA) accounts."
          reference   : "800-171|3.4.5,800-171r3|03.04.05,800-53|CM-5(1),800-53r5|CM-5(1)(a),CAT|II,CCI|CCI-001813,CSF|PR.IP-1,CSF2.0|PR.PS-01,DISA_Benchmark|Oracle_Database_19c_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.2,ISO-27001-2022|A.8.4,ISO-27001-2022|A.8.9,ISO-27001-2022|A.8.19,ISO-27001-2022|A.8.31,ISO-27001-2022|A.8.32,ITSG-33|CM-5(1),NESA|T5.1.1,NESA|T5.6.1,NESA|T7.5.3,QCSC-v1|7.2,Rule-ID|SV-270512r1065305_rule,STIG-ID|O19C-00-007300,Vuln-ID|V-270512"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_Database_19c_V1R1_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <custom_item>
      type        : CMD_EXEC
      description : "O19C-00-009900 - The Oracle Listener must be configured to require administration authentication."
      info        : "Oracle listener authentication helps prevent unauthorized administration of the Oracle listener. Unauthorized administration of the listener could lead to denial-of-service (DoS) exploits, loss of connection audit data, unauthorized reconfiguration, or other unauthorized access. This is a Category I finding because privileged access to the listener is not restricted to authorized users. Unauthorized access can result in stopping of the listener (DoS) and overwriting of listener audit logs."
      solution    : "By default, Oracle Net Listener permits only local administration for security reasons. As a policy, the listener can be administered only by the user who started it.

Oracle Listener authentication is enforced through local operating system authentication. For example, if user1 starts the listener, then only user1 can administer it. Any other user trying to administer the listener receives an error. The super user is the only exception.

Remote administration of the listener must not be permitted. If listener administration from a remote system is required, granting secure remote access to the Oracle database management system (DBMS) server and performing local administration is preferred. Authorize and document this requirement in the system documentation.

Refer to Oracle Database Net Services Reference for additional information."
      reference   : "800-171|3.4.2,800-171r3|03.04.02a.,800-53|CM-6b.,800-53r5|CM-6b.,CAT|I,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Oracle_Database_19c_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-270531r1065272_rule,STIG-ID|O19C-00-009900,SWIFT-CSCv1|2.3,Vuln-ID|V-270531"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_Database_19c_V1R1_STIG.zip"
      cmd         : "for LISTENER in @LISTENER_LIST@; do @ORACLE_HOME@/bin/lsnrctl status $LISTENER; done | grep -E '^Security' | grep -Ev 'ON: Local OS Authentication' | awk '{print} END {if (NR == 0) print \"pass\"}'"
      expect      : "^pass$"
    </custom_item>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : FILE_CHECK
          description : "check for oracle connection manager"
          file        : "@ORACLE_HOME@/network/admin/cman.ora"
        </custom_item>
      </condition>

      <then>
        <custom_item>
          type        : FILE_CONTENT_CHECK
          description : "O19C-00-011200 - Network access to Oracle Database must be restricted to authorized personnel."
          info        : "Restricting remote access to specific, trusted systems helps prevent access by unauthorized and potentially malicious users."
          solution    : "Configure the database listener to restrict access by IP address or set up an external device to restrict network access to the DBMS.

More information can be found at https://docs.oracle.com/en/database/oracle/oracle-database/19/netrf/parameters-for-the-sqlnet.ora.html#GUID-5C3AB641-7541-4CE9-BC9E-BA5DD30616A8."
          reference   : "800-171|3.4.2,800-171r3|03.04.02a.,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Oracle_Database_19c_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-270539r1064895_rule,STIG-ID|O19C-00-011200,SWIFT-CSCv1|2.3,Vuln-ID|V-270539"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_Database_19c_V1R1_STIG.zip"
          file        : "@ORACLE_HOME@/network/admin/cman.ora"
          regex       : "(?i)^[\\s]*\\(rule[\\s]*=[\\s]*\\(src[\\s]*=[\\s]*"
          expect      : "(?i)^[\\s]*\\(rule[\\s]*=[\\s]*\\(src[\\s]*=[\\s]*@SRC_IP@\\)[\\s]*\\(dst[\\s]*=[\\s]*@DEST_IP@\\)"
        </custom_item>
      </then>

      <else>
        <if>
          <condition auto:"FAILED" type:"AND">
            <custom_item>
              type        : FILE_CONTENT_CHECK
              description : "check for validnode_checking"
              file        : "@ORACLE_HOME@/network/admin/sqlnet.ora"
              regex       : "(?i)^[\\s]*tcp\\.validnode_checking[\\s]*="
              expect      : "(?i)^[\\s]*tcp\\.validnode_checking[\\s]*=[\\s]*yes$"
            </custom_item>

            <custom_item>
              type        : FILE_CONTENT_CHECK
              description : "check for invited_nodes"
              file        : "@ORACLE_HOME@/network/admin/sqlnet.ora"
              regex       : "(?i)^[\\s]*tcp\\.invited_nodes[\\s]*="
              expect      : "(?i)^[\\s]*tcp\\.invited_nodes[\\s]*="
            </custom_item>
          </condition>

          <then>
            <report type:"PASSED">
              description : "O19C-00-011200 - Network access to Oracle Database must be restricted to authorized personnel."
              info        : "Restricting remote access to specific, trusted systems helps prevent access by unauthorized and potentially malicious users."
              solution    : "Configure the database listener to restrict access by IP address or set up an external device to restrict network access to the DBMS.

More information can be found at https://docs.oracle.com/en/database/oracle/oracle-database/19/netrf/parameters-for-the-sqlnet.ora.html#GUID-5C3AB641-7541-4CE9-BC9E-BA5DD30616A8."
              reference   : "800-171|3.4.2,800-171r3|03.04.02a.,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Oracle_Database_19c_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-270539r1064895_rule,STIG-ID|O19C-00-011200,SWIFT-CSCv1|2.3,Vuln-ID|V-270539"
              see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_Database_19c_V1R1_STIG.zip"
              show_output : YES
            </report>
          </then>
        </if>
      </else>
    </if>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          type        : FILE_CHECK
          description : "check $ORACLE_DIAG privileges"
          file        : "@ORACLE_DIAG@"
          mask        : "007"
          group       : "@ORACLE_GROUP@"
        </custom_item>

        <custom_item>
          type        : CMD_EXEC
          description : "check group members"
          cmd         : "grep @ORACLE_GROUP@ /etc/group | cut -d: -f4"
          expect      : "^(@ORACLE_GROUP_MEMBERS@)$"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "O19C-00-011500 - The /diag subdirectory under the directory assigned to the DIAGNOSTIC_DEST parameter must be protected from unauthorized access."
          info        : "<DIAGNOSTIC_DEST>/diag indicates the directory where trace, alert, core, and incident directories and files are located. The files may contain sensitive data or information that could prove useful to potential attackers."
          solution    : "Alter host system permissions to the <DIAGNOSTIC_DEST>/diag directory to the Oracle process and software owner accounts, DBAs, system administrators (SAs) (if required), and developers or other users that may specifically require access for debugging or other purposes.

Authorize and document user access requirements to the directory outside of the Oracle, DBA, and SA account list."
          reference   : "800-171|3.4.2,800-171r3|03.04.02a.,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Oracle_Database_19c_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-270541r1065276_rule,STIG-ID|O19C-00-011500,SWIFT-CSCv1|2.3,Vuln-ID|V-270541"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_Database_19c_V1R1_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <custom_item>
      type          : FILE_CONTENT_CHECK
      description   : "O19C-00-011600 - Remote administration must be disabled for the Oracle connection manager."
      info          : "Remote administration provides a potential opportunity for malicious users to make unauthorized changes to the Connection Manager configuration or interrupt its service."
      solution      : "View the cman.ora file in the ORACLE_HOME/network/admin directory of the Connection Manager.

Include the following line in the file:

REMOTE_ADMIN = NO"
      reference     : "800-171|3.4.2,800-171r3|03.04.02a.,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Oracle_Database_19c_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-270542r1064904_rule,STIG-ID|O19C-00-011600,SWIFT-CSCv1|2.3,Vuln-ID|V-270542"
      see_also      : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_Database_19c_V1R1_STIG.zip"
      file          : "@ORACLE_HOME@/network/admin/cman.ora"
      regex         : "(?i)^[\\s]*REMOTE_ADMIN[\\s]*="
      expect        : "(?i)^[\\s]*REMOTE_ADMIN[\\s]*=[\\s]*no"
      file_required : NO
    </custom_item>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          type        : FILE_CONTENT_CHECK
          description : "check for sqlnet.allowed_logon_version_server"
          file        : "@ORACLE_HOME@/network/admin/sqlnet.ora"
          regex       : "(?i)^sqlnet\\.allowed_logon_version_server[\\s]*=[\\s]*"
          expect      : "(?i)^sqlnet\\.allowed_logon_version_server[\\s]*=[\\s]*(12|12a)[\\s]*$"
        </custom_item>

        <custom_item>
          type        : FILE_CONTENT_CHECK
          description : "check for sqlnet.allowed_logon_version_client"
          file        : "@ORACLE_HOME@/network/admin/sqlnet.ora"
          regex       : "(?i)^sqlnet\\.allowed_logon_version_client[\\s]*=[\\s]*"
          expect      : "(?i)^sqlnet\\.allowed_logon_version_client[\\s]*=[\\s]*(12|12a)[\\s]*$"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "O19C-00-011700 - Network client connections must be restricted to supported versions."
          info        : "Unsupported Oracle network client installations may introduce vulnerabilities to the database. Restriction to use of supported versions helps to protect the database and helps to enforce newer, more robust security controls."
          solution    : "Edit the SQLNET.ORA file to add or edit the entries:

SQLNET.ALLOWED_LOGON_VERSION_SERVER = 12
SQLNET.ALLOWED_LOGON_VERSION_CLIENT = 12

Set the value to 12 or higher.
Valid values for SQLNET.ALLOWED_LOGON_VERSION_SERVER are: 12 and 12a

Valid values for SQLNET.ALLOWED_LOGON_VERSION_CLIENT are: 12 and 12a

For more information on sqlnet.ora parameters refer to the following document:
https://docs.oracle.com/en/database/oracle/oracle-database/19/netrf/parameters-for-the-sqlnet.ora.html"
          reference   : "800-171|3.4.2,800-171r3|03.04.02a.,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Oracle_Database_19c_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-270543r1064907_rule,STIG-ID|O19C-00-011700,SWIFT-CSCv1|2.3,Vuln-ID|V-270543"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_Database_19c_V1R1_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          type        : CMD_EXEC
          description : "check for dba group"
          cmd         : "cat /etc/group | grep -E -i '^dba' | grep root | awk '{print} END {if (NR == 0) print \"none\"}'"
          expect      : "^none$"
        </custom_item>

        <custom_item>
          type        : FILE_CONTENT_CHECK_NOT
          description : "check that dba accounts are not in root group"
          file        : "/etc/group"
          regex       : "^root:"
          expect      : "(@DBA_ACCTS@)"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "O19C-00-011800 - Database administrator (DBA) OS accounts must be granted only those host system privileges necessary for the administration of the Oracle Database."
          info        : "This requirement is intended to limit exposure due to operating from within a privileged account or role. The inclusion of role is intended to address those situations where an access control policy, such as Role Based Access Control (RBAC), is being implemented and where a change of role provides the same degree of assurance in the change of access authorizations for both the user and all processes acting on behalf of the user as would be provided by a change between a privileged and nonprivileged account.

DBAs, if assigned excessive OS privileges, could perform actions that could endanger the information system or hide evidence of malicious activity."
          solution    : "Revoke all host system privileges from the DBA group accounts and DBA user accounts not required for database management system (DBMS) administration.

Revoke all OS group memberships that assign excessive privileges to the DBA group accounts and DBA user accounts.

Remove any directly applied permissions or user rights from the DBA group accounts and DBA user accounts.

Document all DBA group accounts and individual DBA account-assigned privileges in the system documentation."
          reference   : "800-171|3.4.2,800-171r3|03.04.02a.,800-53|CM-6b.,800-53r5|CM-6b.,CAT|I,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Oracle_Database_19c_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-270544r1065278_rule,STIG-ID|O19C-00-011800,SWIFT-CSCv1|2.3,Vuln-ID|V-270544"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_Database_19c_V1R1_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          type        : FILE_CONTENT_CHECK
          description : "check in externaljob.ora that extproc runs as user nobody"
          file        : "@ORACLE_HOME@/rdbms/admin/externaljob.ora"
          regex       : "(?i)^[\\s]*run_user[\\s]*="
          expect      : "(?i)^[\\s]*run_user[\\s]*=[\\s]*nobody"
        </custom_item>

        <custom_item>
          type        : FILE_CONTENT_CHECK
          description : "check in externaljob.ora that extproc runs as group nobody"
          file        : "@ORACLE_HOME@/rdbms/admin/externaljob.ora"
          regex       : "(?i)^[\\s]*run_group[\\s]*="
          expect      : "(?i)^[\\s]*run_group[\\s]*=[\\s]*nobody"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "O19C-00-013200 - OS accounts used to run external procedures called by Oracle Database must have limited privileges."
          info        : "This requirement is intended to limit exposure due to operating from within a privileged account or role. The inclusion of role is intended to address those situations where an access control policy, such as Role Based Access Control (RBAC) is being implemented and where a change of role provides the same degree of assurance in the change of access authorizations for both the user and all processes acting on behalf of the user as would be provided by a change between a privileged and nonprivileged account.

To limit exposure when operating from within a privileged account or role, the application must support organizational requirements that users of information system accounts, or roles, with access to organization-defined lists of security functions or security-relevant information, use nonprivileged accounts, or roles, when accessing other (nonsecurity) system functions.

Use of privileged accounts for nonadministrative purposes puts data at risk of unintended or unauthorized loss, modification, or exposure. In particular, database administrator (DBA) accounts if used for nonadministration application development or application maintenance can lead to miss-assignment of privileges where privileges are inherited by object owners. It may also lead to loss or compromise of application data where the elevated privileges bypass controls designed in and provided by applications.

External applications called or spawned by the database management system (DBMS) process may be executed under OS accounts with unnecessary privileges. This can lead to unauthorized access to OS resources and compromise of the OS, the DBMS or any other services provided by the host platform."
          solution    : "Limit privileges to DBMS-related OS accounts to those required to perform their DBMS specific functionality."
          reference   : "800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.06a.,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|PR.PS-01,DISA_Benchmark|Oracle_Database_19c_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-270555r1065222_rule,STIG-ID|O19C-00-013200,SWIFT-CSCv1|2.3,Vuln-ID|V-270555"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_Database_19c_V1R1_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : FIND_CMD
          description : "check for extproc"
          not_expect  : ".+"
          find_name   : "extproc"
          find_type   : "f"
          target      : "@ORACLE_HOME@"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "O19C-00-013400 - Access to external executables must be disabled or restricted."
          info        : "The Oracle external procedure capability provides use of the Oracle process account outside the operation of the database management system (DBMS) process. It can be used to submit and execute applications stored externally from the database under operating system controls. The external procedure process is the subject of frequent and successful attacks as it allows unauthenticated use of the Oracle process account on the operating system. As of Oracle version 11.1, the external procedure agent may be run directly from the database and not require use of the Oracle listener. This reduces the risk of unauthorized access to the procedure from outside of the database process."
          solution    : "If use of the external procedure agent is required, then authorize and document the requirement in the system documentation.

If the external procedure agent must be accessible to the Oracle listener, then specify this and authorize it in the system documentation.

If use of the Oracle External Procedure agent is not required:

1. Stop the Oracle Listener process.
2. Remove all references to extproc in the listener.ora and tnsnames.ora files.
3. Alter the permissions on the executable files:
Unix: Remove read/write/execute permissions from owner, group, and world.
Windows: Remove Groups/Users from the executable (except groups SYSTEM and ADMINISTRATORS) and allow READ [only] for SYSTEM and ADMINISTRATORS groups.

If required:

1. Restrict extproc execution to only authorized applications.
2. Specify EXTPROC_DLLS=ONLY: [list of authorized DLLS] in the extproc.ora and the listener.ora files.
3. Create a separate, dedicated listener for use by the external procedure agent.

Refer to the Oracle Net Services Administrators Guides, External Procedures section for detailed configuration information."
          reference   : "800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.06a.,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|PR.PS-01,DISA_Benchmark|Oracle_Database_19c_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-270557r1065281_rule,STIG-ID|O19C-00-013400,SWIFT-CSCv1|2.3,Vuln-ID|V-270557"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_Database_19c_V1R1_STIG.zip"
          show_output : YES
        </report>
      </then>

      <else>
        <if>
          <condition type:"AND">
            <custom_item>
              type        : FILE_CONTENT_CHECK
              description : "check if extproc is accessible via listener"
              file        : "@ORACLE_HOME@/network/admin/listener.ora"
              regex       : "(?i)^[^#]+\\((key|program)[\\s]*=[\\s]*extproc[\\s]*\\).*$"
              expect      : "(?i)^[^#]+\\((key|program)[\\s]*=[\\s]*extproc[\\s]*\\).*$"
            </custom_item>
          </condition>

          <then>
            <if>
              <condition auto:"WARNING" type:"AND">
                <custom_item>
                  type        : FILE_CONTENT_CHECK
                  description : "check in externaljob.ora that extproc runs as user nobody"
                  file        : "@ORACLE_HOME@/rdbms/admin/externaljob.ora"
                  regex       : "(?i)^[\\s]*run_user[\\s]*="
                  expect      : "(?i)^[\\s]*run_user[\\s]*=[\\s]*nobody"
                </custom_item>

                <custom_item>
                  type        : FILE_CONTENT_CHECK
                  description : "check in externaljob.ora that extproc runs as group nobody"
                  file        : "@ORACLE_HOME@/rdbms/admin/externaljob.ora"
                  regex       : "(?i)^[\\s]*run_group[\\s]*="
                  expect      : "(?i)^[\\s]*run_group[\\s]*=[\\s]*nobody"
                </custom_item>

                <custom_item>
                  type        : FILE_CONTENT_CHECK
                  description : "check in extproc.ora for EXTPROC_DLLS=ONLY"
                  file        : "@ORACLE_HOME@/hs/admin/extproc.ora"
                  regex       : "(?i)^[^#]+extproc_dlls="
                  expect      : "(?i)^[^#]+extproc_dlls[\\s]*=[\\s]*ONLY:.*$"
                </custom_item>

                <custom_item>
                  type        : FILE_CONTENT_CHECK
                  description : "check in listener.ora for EXTPROC_DLLS=ONLY"
                  file        : "@ORACLE_HOME@/network/admin/listener.ora"
                  regex       : "(?i)^[^#]+extproc_dlls[\\s]*="
                  expect      : "(?i)^[^#]+extproc_dlls[\\s]*=[\\s]*ONLY:.*$"
                </custom_item>

                <custom_item>
                  type        : CMD_EXEC
                  description : "check listener.ora for dedicated process listener"
                  cmd         : "cat @ORACLE_HOME@/network/admin/listener.ora"
                  expect      : "^Manual Review Required$"
                  severity    : MEDIUM
                </custom_item>

                <custom_item>
                  type        : CMD_EXEC
                  description : "check tnsnames.ora for dedicated process listener"
                  cmd         : "cat @ORACLE_HOME@/network/admin/tnsnames.ora"
                  expect      : "^Manual Review Required$"
                  severity    : MEDIUM
                </custom_item>
              </condition>

              <then>
                <report type:"PASSED">
                  description : "O19C-00-013400 - Access to external executables must be disabled or restricted."
                  info        : "The Oracle external procedure capability provides use of the Oracle process account outside the operation of the database management system (DBMS) process. It can be used to submit and execute applications stored externally from the database under operating system controls. The external procedure process is the subject of frequent and successful attacks as it allows unauthenticated use of the Oracle process account on the operating system. As of Oracle version 11.1, the external procedure agent may be run directly from the database and not require use of the Oracle listener. This reduces the risk of unauthorized access to the procedure from outside of the database process.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
                  solution    : "If use of the external procedure agent is required, then authorize and document the requirement in the system documentation.

If the external procedure agent must be accessible to the Oracle listener, then specify this and authorize it in the system documentation.

If use of the Oracle External Procedure agent is not required:

1. Stop the Oracle Listener process.
2. Remove all references to extproc in the listener.ora and tnsnames.ora files.
3. Alter the permissions on the executable files:
Unix: Remove read/write/execute permissions from owner, group, and world.
Windows: Remove Groups/Users from the executable (except groups SYSTEM and ADMINISTRATORS) and allow READ [only] for SYSTEM and ADMINISTRATORS groups.

If required:

1. Restrict extproc execution to only authorized applications.
2. Specify EXTPROC_DLLS=ONLY: [list of authorized DLLS] in the extproc.ora and the listener.ora files.
3. Create a separate, dedicated listener for use by the external procedure agent.

Refer to the Oracle Net Services Administrators Guides, External Procedures section for detailed configuration information."
                  reference   : "800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.06a.,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|PR.PS-01,DISA_Benchmark|Oracle_Database_19c_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-270557r1065281_rule,STIG-ID|O19C-00-013400,SWIFT-CSCv1|2.3,Vuln-ID|V-270557"
                  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_Database_19c_V1R1_STIG.zip"
                  show_output : YES
                </report>
              </then>
            </if>
          </then>

          <else>
            <if>
              <condition auto:"FAILED" type:"AND">
                <custom_item>
                  type        : FILE_CONTENT_CHECK
                  description : "check in externaljob.ora that extproc runs as user nobody"
                  file        : "@ORACLE_HOME@/rdbms/admin/externaljob.ora"
                  regex       : "(?i)^[\\s]*run_user[\\s]*="
                  expect      : "(?i)^[\\s]*run_user[\\s]*=[\\s]*nobody"
                </custom_item>

                <custom_item>
                  type        : FILE_CONTENT_CHECK
                  description : "check in externaljob.ora that extproc runs as group nobody"
                  file        : "@ORACLE_HOME@/rdbms/admin/externaljob.ora"
                  regex       : "(?i)^[\\s]*run_group[\\s]*="
                  expect      : "(?i)^[\\s]*run_group[\\s]*=[\\s]*nobody"
                </custom_item>

                <custom_item>
                  type        : FILE_CONTENT_CHECK
                  description : "check in extproc.ora for EXTPROC_DLLS=ONLY"
                  file        : "@ORACLE_HOME@/hs/admin/extproc.ora"
                  regex       : "(?i)^[^#]+extproc_dlls[\\s]*="
                  expect      : "(?i)^[^#]+extproc_dlls[\\s]*=[\\s]*ONLY:.*$"
                </custom_item>
              </condition>

              <then>
                <report type:"PASSED">
                  description : "O19C-00-013400 - Access to external executables must be disabled or restricted."
                  info        : "The Oracle external procedure capability provides use of the Oracle process account outside the operation of the database management system (DBMS) process. It can be used to submit and execute applications stored externally from the database under operating system controls. The external procedure process is the subject of frequent and successful attacks as it allows unauthenticated use of the Oracle process account on the operating system. As of Oracle version 11.1, the external procedure agent may be run directly from the database and not require use of the Oracle listener. This reduces the risk of unauthorized access to the procedure from outside of the database process."
                  solution    : "If use of the external procedure agent is required, then authorize and document the requirement in the system documentation.

If the external procedure agent must be accessible to the Oracle listener, then specify this and authorize it in the system documentation.

If use of the Oracle External Procedure agent is not required:

1. Stop the Oracle Listener process.
2. Remove all references to extproc in the listener.ora and tnsnames.ora files.
3. Alter the permissions on the executable files:
Unix: Remove read/write/execute permissions from owner, group, and world.
Windows: Remove Groups/Users from the executable (except groups SYSTEM and ADMINISTRATORS) and allow READ [only] for SYSTEM and ADMINISTRATORS groups.

If required:

1. Restrict extproc execution to only authorized applications.
2. Specify EXTPROC_DLLS=ONLY: [list of authorized DLLS] in the extproc.ora and the listener.ora files.
3. Create a separate, dedicated listener for use by the external procedure agent.

Refer to the Oracle Net Services Administrators Guides, External Procedures section for detailed configuration information."
                  reference   : "800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.06a.,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|PR.PS-01,DISA_Benchmark|Oracle_Database_19c_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-270557r1065281_rule,STIG-ID|O19C-00-013400,SWIFT-CSCv1|2.3,Vuln-ID|V-270557"
                  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_Database_19c_V1R1_STIG.zip"
                  show_output : YES
                </report>
              </then>
            </if>
          </else>
        </if>
      </else>
    </if>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          type        : FILE_CONTENT_CHECK
          description : "check the sqlnet.ora file for wallet_location"
          file        : "@ORACLE_HOME@/network/admin/sqlnet.ora"
          regex       : "(?i)^[\\s]*WALLET_LOCATION[\\s]*="
          expect      : "(?i)^[\\s]*WALLET_LOCATION[\\s]*=.*$"
        </custom_item>

        <custom_item>
          type        : FILE_CONTENT_CHECK
          description : "check the sqlnet.ora file for SSL cipher suites"
          file        : "@ORACLE_HOME@/network/admin/sqlnet.ora"
          regex       : "(?i)^[\\s]*SSL_CIPHER_SUITES[\\s]*="
          expect      : "(?i)^[\\s]*SSL_CIPHER_SUITES[\\s]*=[\\s]*\\(@SSL_CIPHERS@\\)"
        </custom_item>

        <custom_item>
          type        : FILE_CONTENT_CHECK
          description : "check the sqlnet.ora file for SSL version"
          file        : "@ORACLE_HOME@/network/admin/sqlnet.ora"
          regex       : "(?i)^[\\s]*SSL_VERSION[\\s]*="
          expect      : "(?i)^[\\s]*SSL_VERSION[\\s]*=[\\s]*@SSL_VERSION@$"
        </custom_item>

        <custom_item>
          type        : FILE_CONTENT_CHECK
          description : "check the sqlnet.ora file for SSL client authentication"
          file        : "@ORACLE_HOME@/network/admin/sqlnet.ora"
          regex       : "(?i)^[\\s]*SSL_CLIENT_AUTHENTICATION[\\s]*="
          expect      : "(?i)^[\\s]*SSL_CLIENT_AUTHENTICATION[\\s]*=[\\s]*@SSL_AUTH@$"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "O19C-00-014900 - If passwords are used for authentication, the Oracle Database must transmit only encrypted representations of passwords."
          info        : "The DOD standard for authentication is DOD-approved public key infrastructure (PKI) certificates.

Authentication based on user ID and password may be used only when it is not possible to employ a PKI certificate, and requires authorizing official (AO) approval.

In such cases, passwords need to be protected at all times, and encryption is the standard method for protecting passwords during transmission.

Database management system (DBMS) passwords sent in clear text format across the network are vulnerable to discovery by unauthorized users. Disclosure of passwords may easily lead to unauthorized access to the database.

Transport Layer Security (TLS) is the successor protocol to Secure Sockets Layer (SSL). Although the Oracle configuration parameters have names including \"SSL\", such as SSL_VERSION and SSL_CIPHER_SUITES, they refer to TLS."
          solution    : "Configure encryption for transmission of passwords across the network.

Configure the database to support TLS protocols and the Oracle Wallet to store authentication and signing credentials, including private keys.

More information can be found at https://docs.oracle.com/en/database/oracle/oracle-database/19/dbseg/configuring-secure-sockets-layer-authentication.html#GUID-EF8DEC69-C8BE-462B-ABDD-E621914E617E."
          reference   : "800-171|3.5.10,800-171r3|03.05.07c.,800-53|IA-5(1)(c),800-53r5|IA-5(1)(c),CAT|II,CCI|CCI-000197,CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|Oracle_Database_19c_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.17,ITSG-33|IA-5(1)(c),NESA|T5.2.3,NIAv2|CY6,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-270565r1064973_rule,STIG-ID|O19C-00-014900,SWIFT-CSCv1|4.1,TBA-FIISB|26.1,Vuln-ID|V-270565"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_Database_19c_V1R1_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          type        : FILE_CONTENT_CHECK
          description : "check the sqlnet.ora file for wallet_location"
          file        : "@ORACLE_HOME@/network/admin/sqlnet.ora"
          regex       : "(?i)^[\\s]*WALLET_LOCATION[\\s]*="
          expect      : "(?i)^[\\s]*WALLET_LOCATION[\\s]*=.*$"
        </custom_item>

        <custom_item>
          type        : FILE_CONTENT_CHECK
          description : "check the sqlnet.ora file for SSL cipher suites"
          file        : "@ORACLE_HOME@/network/admin/sqlnet.ora"
          regex       : "(?i)^[\\s]*SSL_CIPHER_SUITES[\\s]*="
          expect      : "(?i)^[\\s]*SSL_CIPHER_SUITES[\\s]*=[\\s]*\\(@SSL_CIPHERS@\\)"
        </custom_item>

        <custom_item>
          type        : FILE_CONTENT_CHECK
          description : "check the sqlnet.ora file for SSL version"
          file        : "@ORACLE_HOME@/network/admin/sqlnet.ora"
          regex       : "(?i)^[\\s]*SSL_VERSION[\\s]*="
          expect      : "(?i)^[\\s]*SSL_VERSION[\\s]*=[\\s]*@SSL_VERSION@$"
        </custom_item>

        <custom_item>
          type        : FILE_CONTENT_CHECK
          description : "check the sqlnet.ora file for SSL client authentication"
          file        : "@ORACLE_HOME@/network/admin/sqlnet.ora"
          regex       : "(?i)^[\\s]*SSL_CLIENT_AUTHENTICATION[\\s]*="
          expect      : "(?i)^[\\s]*SSL_CLIENT_AUTHENTICATION[\\s]*=[\\s]*@SSL_AUTH@$"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "O19C-00-015200 - Oracle Database, when using public key infrastructure (PKI)-based authentication, must enforce authorized access to the corresponding private key."
          info        : "The cornerstone of the PKI is the private key used to encrypt or digitally sign information.

If the private key is stolen, this will lead to the compromise of the authentication and nonrepudiation gained through PKI because the attacker can use the private key to digitally sign documents and can pretend to be the authorized user.

Both the holders of a digital certificate and the issuing authority must protect the computers, storage devices, or whatever they use to keep the private keys.

All access to the private key of Oracle Database must be restricted to authorized and authenticated users. If unauthorized users have access to the database management system's (DBMS's) private key, an attacker could gain access to the primary key and use it to impersonate the database on the network.

Transport Layer Security (TLS) is the successor protocol to Secure Sockets Layer (SSL). Although the Oracle configuration parameters have names including 'SSL', such as SSL_VERSION and SSL_CIPHER_SUITES, they refer to TLS."
          solution    : "Implement strong access and authentication controls to protect the database's private key.

Configure the database to support TLS protocols and the Oracle Wallet to store authentication and signing credentials, including private keys.

More information can be found at https://docs.oracle.com/en/database/oracle/oracle-database/19/dbseg/configuring-secure-sockets-layer-authentication.html#GUID-EF8DEC69-C8BE-462B-ABDD-E621914E617E."
          reference   : "800-171|3.5.2,800-171r3|03.05.12,800-53|IA-5(2)(b),800-53r5|IA-5(2)(a)(1),CAT|I,CCI|CCI-000186,CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|Oracle_Database_19c_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.17,ITSG-33|IA-5(2)(b),NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-270566r1064976_rule,STIG-ID|O19C-00-015200,Vuln-ID|V-270566"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_Database_19c_V1R1_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "O19C-00-015500 - Oracle Database must use NIST-validated FIPS 140-2/140-3 compliant cryptography for authentication mechanisms."
      info        : "Use of weak or not validated cryptographic algorithms undermines the purposes of using encryption and digital signatures to protect data. Weak algorithms can be easily broken and not validated cryptographic modules may not implement algorithms correctly. Unapproved cryptographic modules or algorithms should not be relied on for authentication, confidentiality, or integrity. Weak cryptography could allow an attacker to gain access to and modify data stored in the database as well as the administration settings of the database management system (DBMS).

Applications (including DBMSs) using cryptography are required to use approved NIST FIPS 140-2/140-3 validated cryptographic modules that meet the requirements of applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.

NSA Type-X (where X=1, 2, 3, 4) products are NSA-certified, hardware-based encryption modules.

The standard for validating cryptographic modules will transition to the NIST FIPS 140-3 publication.

FIPS 140-2 modules can remain active for up to five years after validation or until September 21, 2026, when the FIPS 140-2 validations will be moved to the historical list. Even on the historical list, CMVP supports the purchase and use of these modules for existing systems. While federal agencies decide when they move to FIPS 140-3 only modules, purchasers are reminded that for several years there may be a limited selection of FIPS 140-3 modules from which to choose. CMVP recommends purchasers consider all modules that appear on the Validated Modules Search Page:
https://csrc.nist.gov/projects/cryptographic-module-validation-program/validated-modules.

More information on the FIPS 140-3 transition can be found here:
https://csrc.nist.gov/Projects/fips-140-3-transition-effort/."
      solution    : "Utilize NIST-validated FIPS 140-2/140-3 compliant cryptography for all authentication mechanisms.

Open the fips.ora file in an editor. (The default location for fips.ora is $ORACLE_HOME/ldap/admin/ but alternate locations are possible. An alternate location, if it is in use, is specified in the FIPS_HOME environment variable.)
Create or modify fips.ora to include the line \"SSLFIPS_140=TRUE\".

The strength requirements are dependent upon data classification.

For unclassified data, where cryptography is required:
AES 128 for encryption
SHA 256 for hashing

NSA has established the suite B encryption requirements for protecting National Security Systems (NSS) as follows:
AES 128 for Secret
AES 256 for Top Secret
SHA 256 for Secret
SHA 384 for Top Secret

NSS is defined as: (OMB Circular A-130) Any telecommunications or information system operated by the United States Government, the function, operation, or use of which (1) involves intelligence activities; (2) involves cryptologic activities related to national security; (3) involves command and control of military forces; (4) involves equipment that is an integral part of a weapon or weapons system; or (5) is critical to the direct fulfillment of military or intelligence missions, but excluding any system that is to be used for routine administrative and business applications (including payroll, finance, logistics, and personnel management applications).

There is more information on this topic in the Oracle Database 19c Advanced Security Administrator's Guide, located at https://docs.oracle.com/en/database/oracle/oracle-database/19/dbseg/oracle-database-fips-140-settings.html.

Note: Because of changes in Oracle's licensing policy, it is no longer necessary to purchase Oracle Advanced Security to use network encryption and advanced authentication.

FIPS documentation can be downloaded from https://csrc.nist.gov/publications/fips."
      reference   : "800-53|IA-7,800-53r5|IA-7,CAT|I,CCI|CCI-000803,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|Oracle_Database_19c_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(d),ITSG-33|IA-7,ITSG-33|IA-7a.,NESA|M5.2.1,NESA|M5.2.6,NESA|M5.3.1,NESA|T7.4.1,QCSC-v1|13.2,Rule-ID|SV-270569r1065205_rule,STIG-ID|O19C-00-015500,Vuln-ID|V-270569"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_Database_19c_V1R1_STIG.zip"
      file        : "@ORACLE_HOME@/ldap/admin/fips.ora"
      regex       : "(?i)^[\\s]*SSLFIPS_140[\\s]*="
      expect      : "(?i)^[\\s]*SSLFIPS_140[\\s]*=[\\s]*TRUE[\\s]*$"
    </custom_item>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          type        : FILE_CONTENT_CHECK
          description : "check the sqlnet.ora file for client checksum types"
          file        : "@ORACLE_HOME@/network/admin/sqlnet.ora"
          regex       : "(?i)^[\\s]*SQLNET.CRYPTO_CHECKSUM_TYPES_CLIENT[\\s]*="
          expect      : "(?i)^[\\s]*SQLNET.CRYPTO_CHECKSUM_TYPES_CLIENT[\\s]*=[\\s]*\\(@CLIENT_CHECKSUM_TYPES@\\)"
        </custom_item>

        <custom_item>
          type        : FILE_CONTENT_CHECK
          description : "check the sqlnet.ora file for server checksum types"
          file        : "@ORACLE_HOME@/network/admin/sqlnet.ora"
          regex       : "(?i)^[\\s]*SQLNET.CRYPTO_CHECKSUM_TYPES_SERVER[\\s]*="
          expect      : "(?i)^[\\s]*SQLNET.CRYPTO_CHECKSUM_TYPES_SERVER[\\s]*=[\\s]*\\(@SERVER_CHECKSUM_TYPES@\\)"
        </custom_item>

        <custom_item>
          type        : FILE_CONTENT_CHECK
          description : "check the sqlnet.ora file for client encryption types"
          file        : "@ORACLE_HOME@/network/admin/sqlnet.ora"
          regex       : "(?i)^[\\s]*SQLNET.ENCRYPTION_TYPES_CLIENT[\\s]*="
          expect      : "(?i)^[\\s]*SQLNET.ENCRYPTION_TYPES_CLIENT[\\s]*=[\\s]*\\(@CLIENT_ENCRYPTION_TYPES@\\)"
        </custom_item>

        <custom_item>
          type        : FILE_CONTENT_CHECK
          description : "check the sqlnet.ora file for server encryption types"
          file        : "@ORACLE_HOME@/network/admin/sqlnet.ora"
          regex       : "(?i)^[\\s]*SQLNET.ENCRYPTION_TYPES_SERVER[\\s]*="
          expect      : "(?i)^[\\s]*SQLNET.ENCRYPTION_TYPES_SERVER[\\s]*=[\\s]*\\(@SERVER_ENCRYPTION_TYPES@\\)"
        </custom_item>

        <custom_item>
          type        : FILE_CONTENT_CHECK
          description : "check the sqlnet.ora file for client checksum"
          file        : "@ORACLE_HOME@/network/admin/sqlnet.ora"
          regex       : "(?i)^[\\s]*SQLNET.CRYPTO_CHECKSUM_CLIENT[\\s]*="
          expect      : "(?i)^[\\s]*SQLNET.CRYPTO_CHECKSUM_CLIENT[\\s]*=[\\s]*@CLIENT_CHECKSUM@"
        </custom_item>

        <custom_item>
          type        : FILE_CONTENT_CHECK
          description : "check the sqlnet.ora file for server checksum"
          file        : "@ORACLE_HOME@/network/admin/sqlnet.ora"
          regex       : "(?i)^[\\s]*SQLNET.CRYPTO_CHECKSUM_SERVER[\\s]*="
          expect      : "(?i)^[\\s]*SQLNET.CRYPTO_CHECKSUM_SERVER[\\s]*=[\\s]*@SERVER_CHECKSUM@"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "O19C-00-017700 - Oracle Database must employ cryptographic mechanisms preventing the unauthorized disclosure of information during transmission unless the transmitted data is otherwise protected by alternative physical measures."
          info        : "Preventing the disclosure of transmitted information requires that applications take measures to employ some form of cryptographic mechanism to protect the information during transmission. This is usually achieved using Transport Layer Security (TLS), secure sockets layer (SSL) virtual private network (VPN), or IPsec tunnel.

Alternative physical protection measures include Protected Distribution Systems (PDS). PDS are used to transmit unencrypted classified NSI through an area of lesser classification or control. Inasmuch as the classified NSI is unencrypted, the PDS must provide adequate electrical, electromagnetic, and physical safeguards to deter exploitation. Refer to NSTSSI No. 7003 for additional details on a PDS.

Information in transmission is particularly vulnerable to attack. If the database management system (DBMS) does not employ cryptographic mechanisms preventing unauthorized disclosure of information during transit, the information may be compromised.

SHA-1 is in the process of being removed from service within the DOD and its use is to be limited during the transition to SHA-2. Use of SHA-1 for digital signature generation is prohibited. Allowable uses during the transition include CHECKSUM usage and verification of legacy certificate signatures. SHA-1 is considered a temporary solution during legacy application transitionary periods and should not be engineered into new applications. SHA-2 is the path forward for DOD."
          solution    : "Configure DBMS and/or operating system to use cryptographic mechanisms to prevent unauthorized disclosure of information during transmission where physical measures are not being used."
          reference   : "800-171|3.13.8,800-171r3|03.13.08,800-53|SC-8(2),800-53r5|SC-8(2),CAT|I,CCI|CCI-002420,CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSF|PR.DS-2,CSF|PR.DS-5,CSF2.0|PR.DS-02,DISA_Benchmark|Oracle_Database_19c_STIG,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO-27001-2022|A.5.10,ISO-27001-2022|A.5.14,ISO-27001-2022|A.5.33,ISO-27001-2022|A.8.20,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,Rule-ID|SV-270579r1065015_rule,STIG-ID|O19C-00-017700,SWIFT-CSCv1|2.1,Vuln-ID|V-270579"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_Database_19c_V1R1_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          type        : FILE_CONTENT_CHECK
          description : "check the sqlnet.ora file for wallet_location"
          file        : "@ORACLE_HOME@/network/admin/sqlnet.ora"
          regex       : "(?i)^[\\s]*WALLET_LOCATION[\\s]*="
          expect      : "(?i)^[\\s]*WALLET_LOCATION[\\s]*=.*$"
        </custom_item>

        <custom_item>
          type        : FILE_CONTENT_CHECK
          description : "check the sqlnet.ora file for SSL cipher suites"
          file        : "@ORACLE_HOME@/network/admin/sqlnet.ora"
          regex       : "(?i)^[\\s]*SSL_CIPHER_SUITES[\\s]*="
          expect      : "(?i)^[\\s]*SSL_CIPHER_SUITES[\\s]*=[\\s]*\\(@SSL_CIPHERS@\\)"
        </custom_item>

        <custom_item>
          type        : FILE_CONTENT_CHECK
          description : "check the sqlnet.ora file for SSL version"
          file        : "@ORACLE_HOME@/network/admin/sqlnet.ora"
          regex       : "(?i)^[\\s]*SSL_VERSION[\\s]*="
          expect      : "(?i)^[\\s]*SSL_VERSION[\\s]*=[\\s]*@SSL_VERSION@$"
        </custom_item>

        <custom_item>
          type        : FILE_CONTENT_CHECK
          description : "check the sqlnet.ora file for SSL client authentication"
          file        : "@ORACLE_HOME@/network/admin/sqlnet.ora"
          regex       : "(?i)^[\\s]*SSL_CLIENT_AUTHENTICATION[\\s]*="
          expect      : "(?i)^[\\s]*SSL_CLIENT_AUTHENTICATION[\\s]*=[\\s]*@SSL_AUTH@$"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "O19C-00-020400 - Oracle Database must include only approved trust anchors in trust stores or certificate stores managed by the organization."
          info        : "Public key infrastructure (PKI) certificates are certificates with visibility external to organizational systems and certificates related to the internal operations of systems, such as application-specific time services. In cryptographic systems with a hierarchical structure, a trust anchor is an authoritative source (i.e., a certificate authority) for which trust is assumed and not derived. A root certificate for a PKI system is an example of a trust anchor. A trust store or certificate store maintains a list of trusted root certificates."
          solution    : "Configure the DBMS to include only approved trust anchors in trust stores or certificate stores managed by the organization.

Configure the database to support TLS protocols and the Oracle Wallet to store authentication and signing credentials, including private keys."
          reference   : "800-53|SC-17,800-53r5|SC-17b.,CAT|II,CCI|CCI-004909,DISA_Benchmark|Oracle_Database_19c_STIG,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.24,ITSG-33|SC-17,ITSG-33|SC-17a.,NESA|T7.4.2,NIAv2|CY5a,NIAv2|CY10,NIAv2|CY12,NIAv2|SS25,Rule-ID|SV-270589r1065045_rule,STIG-ID|O19C-00-020400,Vuln-ID|V-270589"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_Database_19c_V1R1_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>
  </then>

  <else>
    <report type:"WARNING">
      description : "DISA_Oracle_Database_19c_STIG_v1r1.audit from DISA Oracle Database 19c STIG v1r1"
      info        : "NOTE: Nessus has not identified that the chosen audit applies to the target device."
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_Database_19c_V1R1_STIG.zip"
      show_output : YES
    </report>
  </else>
</if>

</check_type>
