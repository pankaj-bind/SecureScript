#TRUSTED 779e0fe0eae428ec19f7b754da965409eca649e87b26166eda1e83ab84785b2b5a0dacc4f03de60df19450ae4c3f63e286552297fa842f48de31162d40fa6fa7f0e2f9900bc5d8ebb09db268f8aff7b11cfb9fdb90d8cab6ec2a301acf5ae0f4f71542acefb031daddca9bd307460fdebe029476526941fd78582832549af12b62b0858047783ef032982a9bfc6e950aacb3da60144620db7400d3e2cd15cb66701bedd247ad85fd3a282e334ffd49d89b9dc9bf2915efbaa9fc435eace83d7556638c717f6233238ca72d58f9072393759622f3f65391900b2ab3e7f1abe9822c02047c5dccd995bfc2d97ea480be06c4f09f1c985814aabe2e614efb2221c1b36c2adfc085d5d05ca299184fce6f6622ff29f7811b8eaccef08c3f996f270615b7096873a46a4e870c6f7ca58eacf6e8664bbdf042239019d8117b4c486571fab1cf010d3a433afec02c050c5da1c05ca597abcb0bf9a68d7e2ab14548052e554fbc2807a644279fc6384c4097400d30704903bc321315361a419acc2067f68c3d20752146d22884698030beaaa18f5307d1308bd6c0cd9f25ef19c10222a23e77be9cec9d29156668d72fd46155c1f14208a2751bd5049d025f15b3341f43f1808e61a754273c7bde6e7bf6397ca887938cd250f591a7af06c791d7b8b94e1f569843a720da8f9ff4292e96579acd4fe324741c3c0423ba87f7cb83ec89ac
#TRUST-RSA-SHA256 3afbab83eb8c88120e84d95bad0d24bba88881c65bf6f33d29cef0c2f8d3ae3e082686724b7c0ad3ec4607863dca0312775bc345571109b716f563c92fe5ecd5eef9b872535a5ad5ea9d0a58f4918953efe275aed616ce2f1aa0fa7cc355832b6319f6a5a28fe4dd521a317481655510eb71f1b51159396f7f127fae7e565718a97ddcafd1a7bf50744483aeee9f1a98ccb6996d92ae5a933d08a34440cae569c704e2c4d4aa84ccb54b89681fc55c0bcd9e5f8d50dedddc1bc475428ee531eef300f9928e2a7b631d18b6a2fc3c3a35b5e44ab1ea2103aff3dc370ded213f728f27aed9b461fcd4720413a32526a88ad3533c2ddb95d2705085724196761d20f6b7bb54c68f15a8d85236b78ce09b6f09415ab90e9c11a81d9d2caaebf7b354873f74943f37cf1ed4a12eeedc2ff062a3cca52d6e8be08e75ccf799fddb0da8dc422bdb688f68e858d3b7358fd337c23f01e4d20eaaff402c00ecf0ed175333c6c6ad0b71bef1837c7885ec9da8f1d66bccc1b719422064060d598740a9eb0fd63dab86b21c1d73ebab146f846c2904cef10953bbe6ff8b8c8789a7842b348f7cbc4139f261cb12e52ec4b6a8dc4ce1a37e334ff547a5d5f3a95f4648174da490b10edd123952f336addb320a9940f94dbfc0fea1791952ef52f4a3d3b9df1611ee8b64ef9b28a143294947368056baf207089e5956bf56ef19ef613fb445b9
#
# This script is Copyright (C) 2004-2023 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
# $Revision: 1.3 $
# $Date: 2023/03/07 $
#
#     description : ArubaOS Switch 16.x Hardening Guide - v1.0.0.
#                   https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us
#
#<ui_metadata>
#<display_name>ArubaOS Switch 16.x Hardening Guide v1.0.0</display_name>
#<spec>
#  <type>TNS</type>
#  <name>ArubaOS Switch 16.x Hardening Guide</name>
#  <version>1.0.0</version>
#  <link>https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us</link>
#</spec>
#<labels>aruba,arubaos,switch,update_20230227</labels>
#<variables>
#  <variable>
#    <name>BANNER_MOTD_TEXT</name>
#    <default>This system is for authorized use only. Unauthorized or improper\nuse of this system may result in civil or criminal penalties. By\ncontinuing to use this system you acknowledge your consent to\nthese conditions of use.</default>
#    <description>MOTD Banner Text</description>
#    <info>The banner to be displayed during the login process.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>BANNER_EXEC_TEXT</name>
#    <default>All activity is logged and monitored\non this device.</default>
#    <description>EXEC Banner Text</description>
#    <info>The banner to be displayed after the login process.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>SSH_IDLE_TIMEOUT</name>
#    <default>5</default>
#    <description>SSH Idle Timeout Minutes</description>
#    <info>The SSH idle timeout setting for your organization in minutes.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>WEB_IDLE_TIMEOUT</name>
#    <default>300</default>
#    <description>Web Management Idle Timeout Seconds</description>
#    <info>The web management idle timeout setting for your organization in seconds.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>MIN_PASSWORD_LENGTH</name>
#    <default>12</default>
#    <description>Minimum Password Length</description>
#    <info>The minimum password length for users.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>PASSWORD_LOWER_LENGTH</name>
#    <default>3</default>
#    <description>Password Lower Case Requirement</description>
#    <info>The minimum number of required lower case letters.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>PASSWORD_UPPER_LENGTH</name>
#    <default>3</default>
#    <description>Password Upper Case Requirement</description>
#    <info>The minimum number of required upper case letters.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>PASSWORD_NUMBER_LENGTH</name>
#    <default>3</default>
#    <description>Password Number Requirement</description>
#    <info>The minimum number of required numbers.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>PASSWORD_SPECIAL_LENGTH</name>
#    <default>3</default>
#    <description>Password Special Character Requirement</description>
#    <info>The minimum number of required special characters.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>AAA_LIMIT_LOGIN_ATTEMPTS</name>
#    <default>2</default>
#    <description>Failed Login Attempts</description>
#    <info>The number of failed logins attempts before locking out the account.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>AAA_LOCKOUT_TIME</name>
#    <default>300</default>
#    <description>Login attempt lockout time</description>
#    <info>The number of seconds an account is locked out after invalid login attempts is reached.</info>
#    <value_type>STRING</value_type>
#  </variable>
#</variables>
#</ui_metadata>

<check_type:"ArubaOS">

<custom_item>
  type        : CONFIG_CHECK
  description : "Time synchronization - timesync ntp"
  info        : "Many secure protocols and auditing functions rely on system times being synchronized with a reliable time source, either within or (where security considerations permit) external to the managed network. One of the most commonly used protocols to accomplish this is the Network Time Protocol (NTP), which can use both local and Internet-hosted servers to synchronize system time across a network. NTP should be configured and enabled on the device prior to enabling secure management protocols."
  solution    : "For example, to configure a switch to use NTP authentication and connect to a local NTP server at 10.100.1.254 in unicast mode, use NTP authentication, and set the time synchronization mode to NTP:
  switch(config)# timesync ntp
  switch(config)# ntp unicast
  switch(config)# ntp authentication key-id 1 authentication-mode sha1 key-value MySecretValue
  switch(config)# ntp server 10.100.1.254
  switch(config)# ntp enable

  For more details, refer to the time information in the ArubaOS-Switch Management and Configuration Guide foryour switch."
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  item        : "timesync ntp"
  reference   : "800-171|3.3.7,800-53|AU-8(1),800-53r5|SC-45(1),CN-L3|8.1.4.3(b),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.4,ITSG-33|AU-8(1),NESA|T3.6.7,NIAv2|NS44,NIAv2|NS45,NIAv2|NS46,NIAv2|NS47,PCI-DSSv3.2.1|10.4,PCI-DSSv3.2.1|10.4.1,PCI-DSSv3.2.1|10.4.3,PCI-DSSv4.0|10.6,PCI-DSSv4.0|10.6.1,PCI-DSSv4.0|10.6.2,PCI-DSSv4.0|10.6.3,QCSC-v1|8.2.1,QCSC-v1|13.2,TBA-FIISB|37.4"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Time synchronization - ntp unicast"
  info        : "Many secure protocols and auditing functions rely on system times being synchronized with a reliable time source, either within or (where security considerations permit) external to the managed network. One of the most commonly used protocols to accomplish this is the Network Time Protocol (NTP), which can use both local and Internet-hosted servers to synchronize system time across a network. NTP should be configured and enabled on the device prior to enabling secure management protocols."
  solution    : "For example, to configure a switch to use NTP authentication and connect to a local NTP server at 10.100.1.254 in unicast mode, use NTP authentication, and set the time synchronization mode to NTP:
  switch(config)# timesync ntp
  switch(config)# ntp unicast
  switch(config)# ntp authentication key-id 1 authentication-mode sha1 key-value MySecretValue
  switch(config)# ntp server 10.100.1.254
  switch(config)# ntp enable

  For more details, refer to the time information in the ArubaOS-Switch Management and Configuration Guide foryour switch."
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  regex       : "ntp"
  item        : "ntp unicast"
  reference   : "800-171|3.3.7,800-53|AU-8(1),800-53r5|SC-45(1),CN-L3|8.1.4.3(b),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.4,ITSG-33|AU-8(1),NESA|T3.6.7,NIAv2|NS44,NIAv2|NS45,NIAv2|NS46,NIAv2|NS47,PCI-DSSv3.2.1|10.4,PCI-DSSv3.2.1|10.4.1,PCI-DSSv3.2.1|10.4.3,PCI-DSSv4.0|10.6,PCI-DSSv4.0|10.6.1,PCI-DSSv4.0|10.6.2,PCI-DSSv4.0|10.6.3,QCSC-v1|8.2.1,QCSC-v1|13.2,TBA-FIISB|37.4"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Time synchronization - ntp authentication"
  info        : "Many secure protocols and auditing functions rely on system times being synchronized with a reliable time source, either within or (where security considerations permit) external to the managed network. One of the most commonly used protocols to accomplish this is the Network Time Protocol (NTP), which can use both local and Internet-hosted servers to synchronize system time across a network. NTP should be configured and enabled on the device prior to enabling secure management protocols."
  solution    : "For example, to configure a switch to use NTP authentication and connect to a local NTP server at 10.100.1.254 in unicast mode, use NTP authentication, and set the time synchronization mode to NTP:
  switch(config)# timesync ntp
  switch(config)# ntp unicast
  switch(config)# ntp authentication key-id 1 authentication-mode sha1 key-value MySecretValue
  switch(config)# ntp server 10.100.1.254
  switch(config)# ntp enable

  For more details, refer to the time information in the ArubaOS-Switch Management and Configuration Guide foryour switch."
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  regex       : "ntp"
  item        : "ntp authentication key-id [0-9]+"
  reference   : "800-171|3.3.7,800-171|3.5.1,800-53|AU-8(1),800-53|IA-2,800-53r5|IA-2,800-53r5|SC-45(1),CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.1.4.3(b),CN-L3|8.5.4.1(a),CSF|PR.AC-1,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(b),HIPAA|164.312(d),ISO/IEC-27001|A.12.4.4,ITSG-33|AU-8(1),ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T3.6.7,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,NIAv2|NS44,NIAv2|NS45,NIAv2|NS46,NIAv2|NS47,PCI-DSSv3.2.1|10.4,PCI-DSSv3.2.1|10.4.1,PCI-DSSv3.2.1|10.4.3,PCI-DSSv4.0|10.6,PCI-DSSv4.0|10.6.1,PCI-DSSv4.0|10.6.2,PCI-DSSv4.0|10.6.3,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1,TBA-FIISB|37.4"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Time synchronization - ntp server"
  info        : "Many secure protocols and auditing functions rely on system times being synchronized with a reliable time source, either within or (where security considerations permit) external to the managed network. One of the most commonly used protocols to accomplish this is the Network Time Protocol (NTP), which can use both local and Internet-hosted servers to synchronize system time across a network. NTP should be configured and enabled on the device prior to enabling secure management protocols."
  solution    : "For example, to configure a switch to use NTP authentication and connect to a local NTP server at 10.100.1.254 in unicast mode, use NTP authentication, and set the time synchronization mode to NTP:
  switch(config)# timesync ntp
  switch(config)# ntp unicast
  switch(config)# ntp authentication key-id 1 authentication-mode sha1 key-value MySecretValue
  switch(config)# ntp server 10.100.1.254
  switch(config)# ntp enable

  For more details, refer to the time information in the ArubaOS-Switch Management and Configuration Guide foryour switch."
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  regex       : "ntp"
  item        : "ntp server [0-9\\.]+"
  reference   : "800-171|3.3.7,800-53|AU-8(1),800-53r5|SC-45(1),CN-L3|8.1.4.3(b),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.4,ITSG-33|AU-8(1),NESA|T3.6.7,NIAv2|NS44,NIAv2|NS45,NIAv2|NS46,NIAv2|NS47,PCI-DSSv3.2.1|10.4,PCI-DSSv3.2.1|10.4.1,PCI-DSSv3.2.1|10.4.3,PCI-DSSv4.0|10.6,PCI-DSSv4.0|10.6.1,PCI-DSSv4.0|10.6.2,PCI-DSSv4.0|10.6.3,QCSC-v1|8.2.1,QCSC-v1|13.2,TBA-FIISB|37.4"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Time synchronization - ntp enable"
  info        : "Many secure protocols and auditing functions rely on system times being synchronized with a reliable time source, either within or (where security considerations permit) external to the managed network. One of the most commonly used protocols to accomplish this is the Network Time Protocol (NTP), which can use both local and Internet-hosted servers to synchronize system time across a network. NTP should be configured and enabled on the device prior to enabling secure management protocols."
  solution    : "For example, to configure a switch to use NTP authentication and connect to a local NTP server at 10.100.1.254 in unicast mode, use NTP authentication, and set the time synchronization mode to NTP:
  switch(config)# timesync ntp
  switch(config)# ntp unicast
  switch(config)# ntp authentication key-id 1 authentication-mode sha1 key-value MySecretValue
  switch(config)# ntp server 10.100.1.254
  switch(config)# ntp enable

  For more details, refer to the time information in the ArubaOS-Switch Management and Configuration Guide foryour switch."
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  regex       : "ntp"
  item        : "ntp enable"
  reference   : "800-171|3.3.7,800-53|AU-8(1),800-53r5|SC-45(1),CN-L3|8.1.4.3(b),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.4,ITSG-33|AU-8(1),NESA|T3.6.7,NIAv2|NS44,NIAv2|NS45,NIAv2|NS46,NIAv2|NS47,PCI-DSSv3.2.1|10.4,PCI-DSSv3.2.1|10.4.1,PCI-DSSv3.2.1|10.4.3,PCI-DSSv4.0|10.6,PCI-DSSv4.0|10.6.1,PCI-DSSv4.0|10.6.2,PCI-DSSv4.0|10.6.3,QCSC-v1|8.2.1,QCSC-v1|13.2,TBA-FIISB|37.4"
</custom_item>

<custom_item>
  type        : BANNER_CHECK
  description : "Login banner - banner motd"
  info        : "Setting a banner to be displayed during the login process notifies users that unauthorized use is prohibited, and that access to and use of the system may be monitored and logged."
  solution    : "TThe following is an example of creating a \"message of the day\" (MOTD) banner that will be displayed when a user connects to the switch, prior to logging in (using the ^ character to denote the end of the banner):

  switch(config)# banner motd ^Enter TEXT message.  End with the character '^'
  switch(config-banner-motd)# This system is for authorized use only. Unauthorized or improper
  switch(config-banner-motd)# use of this system may result in civil or criminal penalties. By
  switch(config-banner-motd)# continuing to use this system you acknowledge your consent to
  switch(config-banner-motd)# these conditions of use.switch(config-banner-motd)# ^"
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  item        : "banner motd"
  content     : "@BANNER_MOTD_TEXT@"
  reference   : "800-171|3.1.9,800-53|AC-8,800-53r5|AC-8,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-8,NESA|M1.3.6,TBA-FIISB|45.2.4"
</custom_item>

<custom_item>
  type        : BANNER_CHECK
  description : "Login banner - banner exec"
  info        : "Setting a banner to be displayed during the login process notifies users that unauthorized use is prohibited, and that access to and use of the system may be monitored and logged."
  solution    : "TThe following is an example of creating a \"message of the day\" (MOTD) banner that will be displayed when a user connects to the switch, prior to logging in (using the ^ character to denote the end of the banner):

  switch(config)# banner motd ^Enter TEXT message.  End with the character '^'
  switch(config-banner-motd)# This system is for authorized use only. Unauthorized or improper
  switch(config-banner-motd)# use of this system may result in civil or criminal penalties. By
  switch(config-banner-motd)# continuing to use this system you acknowledge your consent to
  switch(config-banner-motd)# these conditions of use.switch(config-banner-motd)# ^"
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  item        : "banner exec"
  content     : "@BANNER_EXEC_TEXT@"
  reference   : "800-171|3.1.9,800-53|AC-8,800-53r5|AC-8,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-8,NESA|M1.3.6,TBA-FIISB|45.2.4"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "Switch identity profile"
  info        : "Creating an identity profile simplifies the generation of cryptographic certificates and certificate signing requests by defining commonly used subject information that is used to identify and authenticate a device using secure, encrypted protocols. ArubaOS-Switch stores one identity profile per device; creating a new profile overwrites an existing profile (if defined).

  NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "This command creates an example identity profile for a device with the hostname \"switch\":

  switch(config)# crypto pki identity-profile switch-id-profile subject common-name
  switch country us state California locality Roseville org HPE org-unit Aruba

  This identity profile will be used whenever a certificate or certificate request is generated later in this guide.

  If no identity profile is defined, required subject fields (including the device common name, at a minimum) must be specified each time a cryptographic certificate signing request or self-signed certificate is generated. If a profile is present, the pertinent data is populated automatically."
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  cmd         : "show crypto pki identity-profile"
  regex       : ".*"
  expect      : "Manual Review Required"
  severity    : MEDIUM
  reference   : "800-171|3.13.10,800-53|SC-12,800-53r5|SC-12,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.10.1.2,ITSG-33|SC-12,ITSG-33|SC-12a.,NESA|T7.4.1,NESA|T7.4.2,NIAv2|CY2,NIAv2|CY8,NIAv2|CY9,QCSC-v1|5.2.2,QCSC-v1|6.2"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Enhanced secure mode"
  info        : "ArubaOS-Switch devices are capable of operating in one of two secure modes: standard and enhanced. Instandard secure mode, passwords and security keys may be entered directly in plaintext from the configurationconsole (though they are, by default, stored separately from the switch configuration), and show commandsgenerally do not hide or obscure configuration parameters. In enhanced secure mode, there are a number of operating differences in software feature support, how commands are executed, and the way configuration parameters are displayed. Some significant changes include:
  -  SSH drops support for less-secure ciphers, including 3des-cbc and rijndael-dbd@lysator.liu.se.
  -  HTTPS supports only TLS 1.0 or later.
  -  Passwords and authentication keys must be entered interactively, and can no longer be set as part of acommand; password/key characters are displayed as asterisks.
  -  Authentication must be completed any time a user transitions from one access level to another (for example, operator to manager or vice versa).
  -  The switch ROM console is password-protected.

  NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Entering enhanced secure mode results in the following sequence of events:

  -  The switch is rebooted.
  -  The management module file system is zeroized, then firmware images are restored.

  switch(config)# secure-mode enhanced
  Validating software and configurations, this may take a minute...
  The system will be rebooted and all management module files except software images will be erased and zeroized. This will take up to 60 minutes and the switch will not be usable during that time. A power-cycle will then be required to complete the transition. Continue (y/n)? y

  The switch will reboot at this point.

  Zeroizing the file system ... 100%
  Verifying cleanness of the file system... 100%
  Restoring firmware image and other system files...
  Zeroization of file system completed
  Continue initializing...

  The current switch operating mode can be displayed using the show secure-mode command:
  switch(config)# show secure-mode
  Level: Enhanced

  For more details, refer to the chapter titled \"Secure mode (FIPS)\" in the ArubaOS-Switch Access Security Guide."
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  regex       : "secure-mode *"
  item        : "Manual Review Required"
  severity    : MEDIUM
  reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,SWIFT-CSCv1|2.3"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Hiding sensitive data"
  info        : "The hide-sensitive-data command, configurable in standard secure mode, requires interactive entry of passwords and authentication keys for applicable commands, and obscures password/key text as it is entered.

  NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  regex       : "hide-sensitive-data"
  item        : "Manual Review Required"
  severity    : MEDIUM
  reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,SWIFT-CSCv1|2.3"
</custom_item>

# Insecure protocols and secure alternatives

<custom_item>
  type        : CONFIG_CHECK
  description : "Telnet vs. Secure Shell - ip ssh"
  info        : "Telnet is insecure by nature as it sends all traffic across the wire in clear text, including user names and passwords. Anyone snooping or sniffing network traffic will be able to intercept these credentials and potentially gain management access to the device. It is recommended to use Secure Shell (SSH) instead of Telnet, as it uses asymmetric encryption to exchange keys and create a secure management session. In addition, setting an idle timeout period for login sessions can prevent unauthorized access when a management session is left unattended."
  solution    : "Use the following commands to enable SSH, disable the Telnet server, and set an idle timeout of 5 minutes for SSH management sessions:

  switch(config)# crypto key generate ssh
  switch(config)# ip ssh
  switch(config)# no telnet-server
  switch(config)# idle-timeout 5

  For details, refer to the chapter titled \"Configuring Secure Shell (SSH)\" in the ArubaOS-Switch Access Security Guide."
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  item        : "ip ssh[\\s]*$"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,SWIFT-CSCv1|2.3"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Telnet vs. Secure Shell - no telnet-server"
  info        : "Telnet is insecure by nature as it sends all traffic across the wire in clear text, including user names and passwords. Anyone snooping or sniffing network traffic will be able to intercept these credentials and potentially gain management access to the device. It is recommended to use Secure Shell (SSH) instead of Telnet, as it uses asymmetric encryption to exchange keys and create a secure management session. In addition, setting an idle timeout period for login sessions can prevent unauthorized access when a management session is left unattended."
  solution    : "Use the following commands to enable SSH, disable the Telnet server, and set an idle timeout of 5 minutes for SSH management sessions:

  switch(config)# crypto key generate ssh
  switch(config)# ip ssh
  switch(config)# no telnet-server
  switch(config)# idle-timeout 5

  For details, refer to the chapter titled \"Configuring Secure Shell (SSH)\" in the ArubaOS-Switch Access Security Guide."
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  item        : "no telnet-server"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Telnet vs. Secure Shell - idle-timeout"
  info        : "Telnet is insecure by nature as it sends all traffic across the wire in clear text, including user names and passwords. Anyone snooping or sniffing network traffic will be able to intercept these credentials and potentially gain management access to the device. It is recommended to use Secure Shell (SSH) instead of Telnet, as it uses asymmetric encryption to exchange keys and create a secure management session. In addition, setting an idle timeout period for login sessions can prevent unauthorized access when a management session is left unattended."
  solution    : "Use the following commands to enable SSH, disable the Telnet server, and set an idle timeout of 5 minutes for SSH management sessions:

  switch(config)# crypto key generate ssh
  switch(config)# ip ssh
  switch(config)# no telnet-server
  switch(config)# idle-timeout 5

  For details, refer to the chapter titled \"Configuring Secure Shell (SSH)\" in the ArubaOS-Switch Access Security Guide."
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  regex       : "idle-timeout"
  item        : "idle-timeout @SSH_IDLE_TIMEOUT@"
  reference   : "800-171|3.1.11,800-53|AC-12,800-53r5|AC-12,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ITSG-33|AC-12,NIAv2|NS49"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "HTTP vs. HTTPS - ssl"
  info        : "ArubaOS-Switch devices can be configured through an HTTP interface, which is enabled by default. This methodshares the same vulnerability to credential interception as Telnet. It is recommended that the HTTPS interface be enabled and the HTTP interface be disabled. HTTPS is HTTP traffic running over an encrypted Transport LayerSecurity (TLS) or Secure Sockets Layer (SSL) session."
  solution    : "Enable SSL, disable plaintext HTTP, and set a 5-minute idle timeout:

  switch(config)# web-management ssl
  switch(config)# no web-management plaintext
  switch(config)# web-management idle-timeout 300"
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  regex       : "web-management"
  item        : "web-management ssl"
  reference   : "800-171|3.13.11,800-53|SC-13,800-53r5|SC-13,CSF|PR.DS-5,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK_NOT
  description : "HTTP vs. HTTPS - plaintext"
  info        : "ArubaOS-Switch devices can be configured through an HTTP interface, which is enabled by default. This methodshares the same vulnerability to credential interception as Telnet. It is recommended that the HTTPS interface be enabled and the HTTP interface be disabled. HTTPS is HTTP traffic running over an encrypted Transport LayerSecurity (TLS) or Secure Sockets Layer (SSL) session."
  solution    : "Enable SSL, disable plaintext HTTP, and set a 5-minute idle timeout:

  switch(config)# web-management ssl
  switch(config)# no web-management plaintext
  switch(config)# web-management idle-timeout 300"
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  regex       : "web-management"
  item        : "web-management plaintext"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "HTTP vs. HTTPS - idle-timeout"
  info        : "ArubaOS-Switch devices can be configured through an HTTP interface, which is enabled by default. This methodshares the same vulnerability to credential interception as Telnet. It is recommended that the HTTPS interface be enabled and the HTTP interface be disabled. HTTPS is HTTP traffic running over an encrypted Transport LayerSecurity (TLS) or Secure Sockets Layer (SSL) session."
  solution    : "Enable SSL, disable plaintext HTTP, and set a 5-minute idle timeout:

  switch(config)# web-management ssl
  switch(config)# no web-management plaintext
  switch(config)# web-management idle-timeout 300"
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  regex       : "web-management"
  item        : "web-management idle-timeout @WEB_IDLE_TIMEOUT@"
  reference   : "800-171|3.1.11,800-53|AC-12,800-53r5|AC-12,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ITSG-33|AC-12,NIAv2|NS49"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "TFTP vs SFTP and SCP - ip ssh filetransfer"
  info        : "The TFTP client and server should be disabled as they do not require any authentication, and (as with Telnet) transfer data in the clear. Secure File Transfer Protocol (SFTP) and Secure Copy Protocol (SCP), part of the SSH protocol suite, should be used instead as they provide an encrypted session using public/private keys between client and server just like SSH. In this case, the switch acts as the server, with the management station acting as the client."
  solution    : "You will need a secure terminal client program running on your PC. To enable SFTP and SCP and disable TFTP, follow these steps:

  switch(config)# crypto key generate ssh
  switch(config)# ip ssh filetransfer
  TFTP and auto-TFTP are now disabled because they cannot be secured with SSH. TFTP can be re-enabled with the 'tftp' command.

  When executing ip ssh filetransfer, the TFTP client and server will be disabled automatically. To disable the TFTP client and server manually (if, for instance, you are disabling all file transfer protocols), execute the following commands:

  switch(config)# no tftp server
  switch(config)# no tftp client"
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  regex       : "ip ssh"
  item        : "ip ssh filetransfer"
  reference   : "800-171|3.13.11,800-53|SC-13,800-53r5|SC-13,CSF|PR.DS-5,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "TFTP vs SFTP and SCP - no tftp server"
  info        : "The TFTP client and server should be disabled as they do not require any authentication, and (as with Telnet) transfer data in the clear. Secure File Transfer Protocol (SFTP) and Secure Copy Protocol (SCP), part of the SSH protocol suite, should be used instead as they provide an encrypted session using public/private keys between client and server just like SSH. In this case, the switch acts as the server, with the management station acting as the client."
  solution    : "You will need a secure terminal client program running on your PC. To enable SFTP and SCP and disable TFTP, follow these steps:

  switch(config)# crypto key generate ssh
  switch(config)# ip ssh filetransfer
  TFTP and auto-TFTP are now disabled because they cannot be secured with SSH. TFTP can be re-enabled with the 'tftp' command.

  When executing ip ssh filetransfer, the TFTP client and server will be disabled automatically. To disable the TFTP client and server manually (if, for instance, you are disabling all file transfer protocols), execute the following commands:

  switch(config)# no tftp server
  switch(config)# no tftp client"
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  regex       : "no tftp"
  item        : "no tftp server"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "TFTP vs SFTP and SCP - no tftp client"
  info        : "The TFTP client and server should be disabled as they do not require any authentication, and (as with Telnet) transfer data in the clear. Secure File Transfer Protocol (SFTP) and Secure Copy Protocol (SCP), part of the SSH protocol suite, should be used instead as they provide an encrypted session using public/private keys between client and server just like SSH. In this case, the switch acts as the server, with the management station acting as the client."
  solution    : "You will need a secure terminal client program running on your PC. To enable SFTP and SCP and disable TFTP, follow these steps:

  switch(config)# crypto key generate ssh
  switch(config)# ip ssh filetransfer
  TFTP and auto-TFTP are now disabled because they cannot be secured with SSH. TFTP can be re-enabled with the 'tftp' command.

  When executing ip ssh filetransfer, the TFTP client and server will be disabled automatically. To disable the TFTP client and server manually (if, for instance, you are disabling all file transfer protocols), execute the following commands:

  switch(config)# no tftp server
  switch(config)# no tftp client"
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  regex       : "no tftp"
  item        : "no tftp client"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "SNMPv1 and v2c vs SNMPv3 - snmpv3 enable"
  info        : "SNMP version 2c is enabled by default. This protocol is used to manage switches and routers from a central management server such as AirWave or IMC. SNMPv2c uses community names for read and write access, much like passwords are used for authentication; these community names are sent across the wire as . If a malicious user were to capture these community names, they could potentially issue SNMP set commands to make unauthorized and potentially harmful configuration changes to a network device."
  solution    : "SNMP version 3 was developed to overcome this weakness by using asymmetric cryptography, similar to that used by SSH, to encrypt SNMP traffic over the wire. To enable SNMPv3, create an SNMPv3 user, and disable SNMPv1 and v2c, follow these steps:

  switch(config)# snmpv3 enable
  SNMPv3 Initialization process.
  Creating user 'initial'
  Authentication Protocol: MD5
  Enter authentication password: ********
  Privacy protocol is DESEnter privacy password: ********

  User 'initial' has been created
  Would you like to create a user that uses SHA? [y/n] y
  Enter user name: snmpv3user
  Authentication Protocol: SHA
  Enter authentication password: ********
  Privacy protocol is DES
  Enter privacy password: ********

  User creation is done.  SNMPv3 is now functional.
  Would you like to restrict SNMPv1 and SNMPv2c messages to have read only access (you can set this later by the command 'snmpv3 restricted-access')? [y/n] y

  switch(config)# snmpv3 only

  If for any reason SNMPv3 is not an option for your network, you can enable SNMPv2c in restricted mode to allow management devices to retrieve information from, but not change any settings on, the switch:

  switch(config)# snmp-server community readonly_community restricted

  In any SNMP operating mode, disable the \"public\" community name by entering the following command:

  switch(config)# no snmp-server community public

  Some security policies may mandate that SNMP be disabled altogether. Disable all SNMP features by entering the following command:

  switch(config)# no snmp-server enable"
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  regex       : "snmpv3"
  item        : "snmpv3 enable"
  reference   : "800-171|3.4.2,800-171|3.14.1,800-53|CM-6b.,800-53|SI-2c.,800-53r5|CM-6b.,800-53r5|SI-2c.,CN-L3|8.1.4.4(e),CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(d),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSF|ID.RA-1,CSF|PR.IP-1,CSF|PR.IP-12,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,ITSG-33|SI-2,NESA|T3.2.1,NESA|T7.6.2,NESA|T7.7.1,NIAv2|AM38,NIAv2|AM39,NIAv2|SS14b,PCI-DSSv3.2.1|6.2,PCI-DSSv4.0|6.3,PCI-DSSv4.0|6.3.3,QCSC-v1|11.2,SWIFT-CSCv1|2.2,SWIFT-CSCv1|2.3"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "SNMPv1 and v2c vs SNMPv3 - snmpv3 only"
  info        : "SNMP version 2c is enabled by default. This protocol is used to manage switches and routers from a central management server such as AirWave or IMC. SNMPv2c uses community names for read and write access, much like passwords are used for authentication; these community names are sent across the wire as . If a malicious user were to capture these community names, they could potentially issue SNMP set commands to make unauthorized and potentially harmful configuration changes to a network device."
  solution    : "SNMP version 3 was developed to overcome this weakness by using asymmetric cryptography, similar to that used by SSH, to encrypt SNMP traffic over the wire. To enable SNMPv3, create an SNMPv3 user, and disable SNMPv1 and v2c, follow these steps:

  switch(config)# snmpv3 enable
  SNMPv3 Initialization process.
  Creating user 'initial'
  Authentication Protocol: MD5
  Enter authentication password: ********
  Privacy protocol is DESEnter privacy password: ********

  User 'initial' has been created
  Would you like to create a user that uses SHA? [y/n] y
  Enter user name: snmpv3user
  Authentication Protocol: SHA
  Enter authentication password: ********
  Privacy protocol is DES
  Enter privacy password: ********

  User creation is done.  SNMPv3 is now functional.
  Would you like to restrict SNMPv1 and SNMPv2c messages to have read only access (you can set this later by the command 'snmpv3 restricted-access')? [y/n] y

  switch(config)# snmpv3 only

  If for any reason SNMPv3 is not an option for your network, you can enable SNMPv2c in restricted mode to allow management devices to retrieve information from, but not change any settings on, the switch:

  switch(config)# snmp-server community readonly_community restricted

  In any SNMP operating mode, disable the \"public\" community name by entering the following command:

  switch(config)# no snmp-server community public

  Some security policies may mandate that SNMP be disabled altogether. Disable all SNMP features by entering the following command:

  switch(config)# no snmp-server enable"
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  regex       : "snmpv3"
  item        : "snmpv3 only"
  reference   : "800-171|3.4.2,800-171|3.14.1,800-53|CM-6b.,800-53|SI-2c.,800-53r5|CM-6b.,800-53r5|SI-2c.,CN-L3|8.1.4.4(e),CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(d),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSF|ID.RA-1,CSF|PR.IP-1,CSF|PR.IP-12,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,ITSG-33|SI-2,NESA|T3.2.1,NESA|T7.6.2,NESA|T7.7.1,NIAv2|AM38,NIAv2|AM39,NIAv2|SS14b,PCI-DSSv3.2.1|6.2,PCI-DSSv4.0|6.3,PCI-DSSv4.0|6.3.3,QCSC-v1|11.2,SWIFT-CSCv1|2.2,SWIFT-CSCv1|2.3"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK_NOT
  description : "SNMPv1 and v2c vs SNMPv3 - snmp community"
  info        : "SNMP version 2c is enabled by default. This protocol is used to manage switches and routers from a central management server such as AirWave or IMC. SNMPv2c uses community names for read and write access, much like passwords are used for authentication; these community names are sent across the wire as . If a malicious user were to capture these community names, they could potentially issue SNMP set commands to make unauthorized and potentially harmful configuration changes to a network device."
  solution    : "SNMP version 3 was developed to overcome this weakness by using asymmetric cryptography, similar to that used by SSH, to encrypt SNMP traffic over the wire. To enable SNMPv3, create an SNMPv3 user, and disable SNMPv1 and v2c, follow these steps:

  switch(config)# snmpv3 enable
  SNMPv3 Initialization process.
  Creating user 'initial'
  Authentication Protocol: MD5
  Enter authentication password: ********
  Privacy protocol is DESEnter privacy password: ********

  User 'initial' has been created
  Would you like to create a user that uses SHA? [y/n] y
  Enter user name: snmpv3user
  Authentication Protocol: SHA
  Enter authentication password: ********
  Privacy protocol is DES
  Enter privacy password: ********

  User creation is done.  SNMPv3 is now functional.
  Would you like to restrict SNMPv1 and SNMPv2c messages to have read only access (you can set this later by the command 'snmpv3 restricted-access')? [y/n] y

  switch(config)# snmpv3 only

  If for any reason SNMPv3 is not an option for your network, you can enable SNMPv2c in restricted mode to allow management devices to retrieve information from, but not change any settings on, the switch:

  switch(config)# snmp-server community readonly_community restricted

  In any SNMP operating mode, disable the \"public\" community name by entering the following command:

  switch(config)# no snmp-server community public

  Some security policies may mandate that SNMP be disabled altogether. Disable all SNMP features by entering the following command:

  switch(config)# no snmp-server enable"
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  regex       : "snmp-server community"
  item        : "(public|readonly|write)"
  match_case  : NO
  reference   : "800-171|3.5.2,800-53|IA-5e.,800-53r5|IA-5e.,CN-L3|7.1.3.2(d),CN-L3|8.1.4.2(b),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5e.,NESA|T5.2.3,NIAv2|NS2,NIAv2|NS39,NIAv2|SS14f,PCI-DSSv3.2.1|2.1,PCI-DSSv4.0|2.2.2,QCSC-v1|5.2.2,QCSC-v1|13.2"
</custom_item>

# Auditing and logging

<custom_item>
  type        : CONFIG_CHECK
  description : "Auditing and logging - server"
  info        : "ArubaOS-Switch provides both locally stored event and security logs, as well as using the syslog protocol to forward events to a remote server for auditing purposes. Logged events can be filtered by severity level, originating system modules, or using regular expressions to match against message text.

  The syslog client is capable of connecting to a server using UDP (default), TCP, or TLS protocols. TLS is the preferred protocol, as it provides an encrypted connection to the syslog receiver. This requires the switch to possess a signed TLS client certificate, and the receiver to possess a signed TLS server certificate. (Self-signed certificates cannot be used for connections to a syslog receiver.)"
  solution    : "Refer to the user documentation for the desired syslog receiver to generate and install the required TLS server certificate.

  Once the required certificates are installed, use the following commands to configure the switch to forward all events with a severity of warning or higher to a syslog server at 10.100.1.250 using TLS:

  switch(config)# logging 10.100.1.250 tls
  switch(config)# logging severity warning"
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  regex       : "logging"
  item        : "logging [0-9\.]+ tls"
  reference   : "800-53|AU-4(1),800-53r5|AU-4(1),CSF|PR.DS-4,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-4,NESA|T3.3.1,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|13.2"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Auditing and logging - severity"
  info        : "ArubaOS-Switch provides both locally stored event and security logs, as well as using the syslog protocol to forward events to a remote server for auditing purposes. Logged events can be filtered by severity level, originating system modules, or using regular expressions to match against message text.

  The syslog client is capable of connecting to a server using UDP (default), TCP, or TLS protocols. TLS is the preferred protocol, as it provides an encrypted connection to the syslog receiver. This requires the switch to possess a signed TLS client certificate, and the receiver to possess a signed TLS server certificate. (Self-signed certificates cannot be used for connections to a syslog receiver.)"
  solution    : "Refer to the user documentation for the desired syslog receiver to generate and install the required TLS server certificate.

  Once the required certificates are installed, use the following commands to configure the switch to forward all events with a severity of warning or higher to a syslog server at 10.100.1.250 using TLS:

  switch(config)# logging 10.100.1.250 tls
  switch(config)# logging severity warning"
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  regex       : "logging"
  item        : "logging severity warning"
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,800-53r5|AU-12c.,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
</custom_item>

# Access control

<custom_item>
  type        : CONFIG_CHECK
  description : "Out-of-Band Management port"
  info        : "The Out-of-Band Management (OoBM) port, enabled by default, is intended to provide a means to access and manage the switch from a network segregated from production traffic. Only stations on the segregated management network can gain management access to the switch; this sharply limits the universe of devices that may attempt unauthorized access.

  Switch management services can be configured to use the OoBM port rather than switch data ports. Traffic cannot be routed between the OoBM port and data ports, and the OoBM port can be assigned a dedicated gateway address. In a switch stack (backplane or VSF), a single global OoBM IP address can be assigned for the entire stack, in addition to addresses for each individual stack member.

  NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "This example sets a global OoBM IP address on a three-switch stack, as well as individual static addresses for each of the three members:

  switch(config)# oobm
  switch(oobm)# ip address 10.1.0.5/24
  switch(oobm)# ip default-gateway 10.1.0.1
  switch(oobm)# member 1
  switch(oobm member-1)# ip address 10.1.0.6/24
  switch(oobm member-1)# ip default-gateway 10.1.0.1
  switch(oobm member-1)# member 2
  switch(oobm member-2)# ip address 10.1.0.7/24
  switch(oobm member-2)# ip default-gateway 10.1.0.1
  switch(oobm member-2)# member 3
  switch(oobm member-3)# ip address 10.1.0.8/24
  switch(oobm member-3)# ip default-gateway 10.1.0.1

  To use DHCP on a standalone switch:
  switch(config)# oobm
  switch(oobm)# ip address dhcp-bootp

  There are a couple of useful show commands that can be used to monitor the status of OoBM ports:

  switch# show oobm
   Global OOBM Configuration
      OOBM Enabled           : Yes
   VSF Member 1
      OOBM Port Type         : 100/1000T
      OOBM Interface Status  : Up
      OOBM Port              : Enabled
      OOBM Port Speed        : Auto
      MAC Address            : 00005E-005301

  VSF Member 2
      OOBM Port Type         : 100/1000T
      OOBM Interface Status  : Up
      OOBM Port              : Enabled
      OOBM Port Speed        : Auto
      MAC Address            : 00005E-005302

  switch# show oobm ip
    IPv4 Status          : Enabled
    IPv4 Default Gateway : 10.1.0.1
               |                                     Address  Interface
    VSF-member | IP Config IP Address/Prefix Length  Status   Status
    ---------- + --------- ------------------------- -------- ---------
    Global     | manual    10.1.0.5/24               Active   Up
    1          | manual    10.1.0.6/24               Active   Up
    2          | manual    10.1.0.7/24               Active   Up"
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  context     : "inteface oobm"
  regex       : ".*"
  item        : "Manual Review Required"
  severity    : MEDIUM
  reference   : "800-171|3.13.2,800-171|3.13.5,800-53|SC-7(13),800-53r5|SC-7(13),CN-L3|8.1.10.6(h),CSF|PR.AC-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(13),NESA|T4.5.4,NIAv2|GS7d,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|3.1,TBA-FIISB|43.1"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Management VLAN"
  info        : "Management VLANs are designed to restrict management access to the switch to only those nodes connected to the Management VLAN. That is, only clients who are connected to ports who are members of the Management VLAN can be allowed to gain management access to the Aruba switch. This sharply limits the universe of devices that can attempt unauthorized access.

  NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "In this example, VLAN 200 is created, designated the Management VLAN, and assigned to port 24:

  switch(config)# vlan 200 name \"Management VLAN\"s
  witch(config)# management-vlan 200
  switch(config)# vlan 200 untagged 24

  Any VLAN can be assigned as the Management VLAN. Take care to ensure that the same VLAN is configured as Management VLAN on all devices that are to be members of the Management VLAN.

  There are a few restrictions and guidelines on Management VLANs to keep in mind:
  -  Only one VLAN per switch can be designated as the Management VLAN.
  -  Traffic cannot be routed between the Management VLAN and other VLANs, even if routing is enabled on the switch.
  -  The Management VLAN will not acquire a DHCP IP address; only static IP addressing may be used.
  -  Only switch ports connected to authorized management stations, or those extending the VLAN to otherswitches, should be members of the Management VLAN.
  -  Internet Group Management Protocol (IGMP) is not supported on the Management VLAN."
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  regex       : "management-vlan"
  item        : "Manual Review Required"
  severity    : MEDIUM
  reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,SWIFT-CSCv1|2.3"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Authorized IP managers"
  info        : "In cases where configuring a dedicated Management VLAN is too restrictive, such as when management stations are on a different subnet from the switch management IP address, it is possible to identify up to 10 authorized IP addresses or address groups that are allowed management access to the switch through the network, with both access levels and methods configurable.

  NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Here, two authorized endpoints (10.100.1.10 and 10.100.1.11) are configured as an authorized manager and operator, respectively, with different access methods permitted:

switch(config)# ip authorized-manager 10.100.1.10 255.255.255.255 access manager access-method all
switch(config)# ip authorized-manager 10.100.1.11 255.255.255.255 access operator access-method web

Access methods that can be configured include SSH, Telnet, Web, SNMP, and TFTP. Only one access method (or all at once) can be specified per instance of the command; to allow multiple access methods for a given authorized IP address/range, the command must be run multiple times:

switch(config)# ip authorized-manager 10.100.1.12 255.255.255.255 access manager access-method ssh
switch(config)# ip authorized-manager 10.100.1.12 255.255.255.255 access manager access-method web

Once configured, only those addresses identified will be granted access to the switch over the network, using the specified methods. Some addresses can be limited to operator access while others are granted full manager status.

It is important to keep in mind that this is not a fool-proof access control method; IP spoofing will defeat this protection, as will an authorized workstation whose security has been compromised. It also does not protect against unauthorized access through the serial console. It is strongly recommended that this feature be used in conjunction with a role-based authentication scheme, such as RADIUS or TACACS+."
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  regex       : "ip authorized-manager .*"
  item        : "Manual Review Required"
  severity    : MEDIUM
  reference   : "800-171|3.13.1,800-53|SC-7(15),800-53r5|SC-7(15),CN-L3|8.1.10.6(j),CSF|PR.AC-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(15),NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Access control lists"
  info        : "For situations where management access must be provided on interfaces other than the dedicated management interface, IP Access Control Lists (ACLs) can be used to limit management access to specific management stations or subnets, permitting granular control over IP ranges or protocols permitted to access the switch.

  NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "ACLs cannot be applied on the management interface or mgmt VRF. If access controls must be implemented for this interface, an ACL should be applied on the upstream device. ACLs should be used in conjunction with a trusted authentication service, such as a RADIUS or TACACS+ server."
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  context     : "ip access-list"
  regex       : ".*"
  item        : "Manual Review Required"
  severity    : MEDIUM
  reference   : "800-171|3.13.1,800-53|SC-7(11),800-53r5|SC-7(11),CN-L3|8.1.10.6(j),CSF|PR.AC-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(11),NESA|T4.5.4,NIAv2|GS7c,PCI-DSSv3.2.1|1.3.1,PCI-DSSv3.2.1|1.3.2,PCI-DSSv3.2.1|1.3.3,PCI-DSSv3.2.1|1.3.5,PCI-DSSv4.0|1.3.1,PCI-DSSv4.0|1.4.2,PCI-DSSv4.0|1.4.3,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|31.3"
</custom_item>

# Authentication, authorization, and accounting

<custom_item>
  type        : CONFIG_CHECK
  description : "Local password complexity - password complexity all"
  info        : "Device administrators can specify password complexity policies that can be used to ensure that managementuser passwords cannot be easily guessed or brute-forced to gain access to devices.Configurable complexity requirements include:
  -  Minimum password length
  -  Password composition (lowercase, uppercase, numbers, symbols)
  -  Checking for repeat characters, repeating password, or username as part of password
  -  Password aging and history"
  solution    : "The following example defines a password complexity policy that prohibits more than three repeated characters in a password, repeating password strings, or entering the username (forward or reverse) as part of the password:

  switch(config)# password complexity all"
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  regex       : "password complexity"
  item        : "password complexity all"
  reference   : "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(a),CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Local password complexity - password minimum-length"
  info        : "Device administrators can specify password complexity policies that can be used to ensure that managementuser passwords cannot be easily guessed or brute-forced to gain access to devices.Configurable complexity requirements include:
  -  Minimum password length
  -  Password composition (lowercase, uppercase, numbers, symbols)
  -  Checking for repeat characters, repeating password, or username as part of password
  -  Password aging and history"
  solution    : "To require a minimum password length of 12 characters:

  switch(config)# password minimum-length 12"
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  regex       : "password minimum-length"
  item        : "password minimum-length @MIN_PASSWORD_LENGTH@"
  reference   : "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(a),CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Local password complexity - password composition lowercase"
  info        : "Device administrators can specify password complexity policies that can be used to ensure that managementuser passwords cannot be easily guessed or brute-forced to gain access to devices.Configurable complexity requirements include:
  -  Minimum password length
  -  Password composition (lowercase, uppercase, numbers, symbols)
  -  Checking for repeat characters, repeating password, or username as part of password
  -  Password aging and history"
  solution    : "To create a composition policy requiring three each of lowercase and uppercase letters, three numbers, and three symbols:

  switch(config)# password composition lowercase 3
  switch(config)# password composition uppercase 3
  switch(config)# password composition number 3
  switch(config)# password composition specialcharacter 3"
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  regex       : "password composition"
  item        : "password composition lowercase @PASSWORD_LOWER_LENGTH@"
  reference   : "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(a),CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Local password complexity - password composition uppercase"
  info        : "Device administrators can specify password complexity policies that can be used to ensure that managementuser passwords cannot be easily guessed or brute-forced to gain access to devices.Configurable complexity requirements include:
  -  Minimum password length
  -  Password composition (lowercase, uppercase, numbers, symbols)
  -  Checking for repeat characters, repeating password, or username as part of password
  -  Password aging and history"
  solution    : "To create a composition policy requiring three each of lowercase and uppercase letters, three numbers, and three symbols:

  switch(config)# password composition lowercase 3
  switch(config)# password composition uppercase 3
  switch(config)# password composition number 3
  switch(config)# password composition specialcharacter 3"
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  regex       : "password composition"
  item        : "password composition uppercase @PASSWORD_UPPER_LENGTH@"
  reference   : "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(a),CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Local password complexity - password composition number"
  info        : "Device administrators can specify password complexity policies that can be used to ensure that managementuser passwords cannot be easily guessed or brute-forced to gain access to devices.Configurable complexity requirements include:
  -  Minimum password length
  -  Password composition (lowercase, uppercase, numbers, symbols)
  -  Checking for repeat characters, repeating password, or username as part of password
  -  Password aging and history"
  solution    : "To create a composition policy requiring three each of lowercase and uppercase letters, three numbers, and three symbols:

  switch(config)# password composition lowercase 3
  switch(config)# password composition uppercase 3
  switch(config)# password composition number 3
  switch(config)# password composition specialcharacter 3"
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  regex       : "password composition"
  item        : "password composition number @PASSWORD_NUMBER_LENGTH@"
  reference   : "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(a),CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Local password complexity - password composition specialcharacter"
  info        : "Device administrators can specify password complexity policies that can be used to ensure that managementuser passwords cannot be easily guessed or brute-forced to gain access to devices.Configurable complexity requirements include:
  -  Minimum password length
  -  Password composition (lowercase, uppercase, numbers, symbols)
  -  Checking for repeat characters, repeating password, or username as part of password
  -  Password aging and history"
  solution    : "To create a composition policy requiring three each of lowercase and uppercase letters, three numbers, and three symbols:

  switch(config)# password composition lowercase 3
  switch(config)# password composition uppercase 3
  switch(config)# password composition number 3
  switch(config)# password composition specialcharacter 3"
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  regex       : "password composition"
  item        : "password composition specialcharacter @PASSWORD_SPECIAL_LENGTH@"
  reference   : "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(a),CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Local password complexity - password configuration aging"
  info        : "Device administrators can specify password complexity policies that can be used to ensure that managementuser passwords cannot be easily guessed or brute-forced to gain access to devices.Configurable complexity requirements include:
  -  Minimum password length
  -  Password composition (lowercase, uppercase, numbers, symbols)
  -  Checking for repeat characters, repeating password, or username as part of password
  -  Password aging and history"
  solution    : "Enable password aging and history checking, using the default settings of 90 days and eight passwords retained, respectively:

  switch(config)# password configuration aging
  switch(config)# password configuration history"
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  regex       : "password configuration"
  item        : "password configuration aging"
  reference   : "800-171|3.5.2,800-53|IA-5(1)(d),800-53r5|IA-5(1)(d),CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(d),NESA|T5.2.3,NIAv2|AM20,NIAv2|AM21,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.2"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Local password complexity - password configuration history"
  info        : "Device administrators can specify password complexity policies that can be used to ensure that managementuser passwords cannot be easily guessed or brute-forced to gain access to devices.Configurable complexity requirements include:
  -  Minimum password length
  -  Password composition (lowercase, uppercase, numbers, symbols)
  -  Checking for repeat characters, repeating password, or username as part of password
  -  Password aging and history"
  solution    : "Enable password aging and history checking, using the default settings of 90 days and eight passwords retained, respectively:

  switch(config)# password configuration aging
  switch(config)# password configuration history"
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  regex       : "password configuration"
  item        : "password configuration history"
  reference   : "800-171|3.5.8,800-53|IA-5(1)(e),800-53r5|IA-5(1)(e),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(e),NESA|T5.2.3,NIAv2|AM22c,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.3"
</custom_item>

<if>
  <condition type:"AND">
    <custom_item>
      type        : CONFIG_CHECK
      description : "Check for include-credentials"
      item        : "include-credentials"
    </custom_item>
  </condition>

  <then>
    <custom_item>
      type        : CONFIG_CHECK
      description : "Storing credentials in the switch configuration"
      info        : "By default, usernames and passwords (and other credentials, such as RADIUS/TACACS authentication keys) are stored separately from the switch configuration file, and are not shown when saved or running configurations are displayed. Credentials may be stored and shown as part of the switch configuration using the include-credentials command. If this feature is enabled, Aruba strongly recommends also enabling the encrypt-credentials feature to encrypt stored credentials using aes-256-cbc encryption, using either a hard-coded 256-bit key common to all Aruba switches, or (recommended) a custom pre-shared key defined as either a plaintext string or a 64-character hexadecimal string. Using a pre-shared key common to devices in a given network enables transfer of configurations, including credentials, between devices using the same key."
      solution    : "To enable both of these features, with credentials encrypted using a custom pre-shared key:

      switch(config)# include-credentials
      switch(config)# encrypt-credentials pre-shared-key plaintext encryptme"
      see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
      regex       : "encrypt-credentials"
      item        : "encrypt-credentials"
      reference   : "800-171|3.5.10,800-53|IA-5(1)(c),800-53r5|IA-5(1)(c),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1)(c),NESA|T5.2.3,NIAv2|CY6,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.1"
    </custom_item>
  </then>

  <else>
    <report type:"PASSED">
      description : "Storing credentials in the switch configuration"
      info        : "By default, usernames and passwords (and other credentials, such as RADIUS/TACACS authentication keys) are stored separately from the switch configuration file, and are not shown when saved or running configurations are displayed. Credentials may be stored and shown as part of the switch configuration using the include-credentials command. If this feature is enabled, Aruba strongly recommends also enabling the encrypt-credentials feature to encrypt stored credentials using aes-256-cbc encryption, using either a hard-coded 256-bit key common to all Aruba switches, or (recommended) a custom pre-shared key defined as either a plaintext string or a 64-character hexadecimal string. Using a pre-shared key common to devices in a given network enables transfer of configurations, including credentials, between devices using the same key.

    NOTE: include-credentials configuration was not found. This check is not applicable."
      solution    : "To enable both of these features, with credentials encrypted using a custom pre-shared key:

    switch(config)# include-credentials
    switch(config)# encrypt-credentials pre-shared-key plaintext encryptme"
      see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
      reference   : "800-171|3.5.10,800-53|IA-5(1)(c),800-53r5|IA-5(1)(c),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1)(c),NESA|T5.2.3,NIAv2|CY6,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.1"
    </report>
  </else>
</if>

<custom_item>
  type        : CONFIG_CHECK
  description : "Failed authentication lockout - num-attempts"
  info        : "The default number of allowed login attempts per session or user is three, meaning the user has three chances to supply valid access credentials. Once this limit is reached, the session terminates, and the user must start the login process over after an optional lockout delay (disabled by default). Both the number of allowed login attempts and the lockout delay period are configurable."
  solution    : "To reduce the number of login attempts before terminating the session to two, use the following command:

  switch(config)# aaa authentication num-attempts 2

  This setting can be set to a value of 1-10. If the lockout delay is set to a non-zero value, the number of attempts are enforced per user account; if there is no configured delay, the setting is enforced per-session."
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  regex       : "aaa authentication"
  item        : "aaa authentication num-attempts @AAA_LIMIT_LOGIN_ATTEMPTS@"
  reference   : "800-171|3.1.8,800-53|AC-7,800-53r5|AC-7,CN-L3|8.1.4.1(b),GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-7,NIAv2|AM24,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Failed authentication lockout - lockout-delay"
  info        : "The default number of allowed login attempts per session or user is three, meaning the user has three chances to supply valid access credentials. Once this limit is reached, the session terminates, and the user must start the login process over after an optional lockout delay (disabled by default). Both the number of allowed login attempts and the lockout delay period are configurable."
  solution    : "To reduce the number of login attempts before terminating the session to two, use the following command:

  switch(config)# aaa authentication num-attempts 2

  This setting can be set to a value of 1-10. If the lockout delay is set to a non-zero value, the number of attempts are enforced per user account; if there is no configured delay, the setting is enforced per-session."
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  regex       : "aaa authentication"
  item        : "aaa authentication lockout-delay @AAA_LOCKOUT_TIME@"
  reference   : "800-171|3.1.8,800-53|AC-7,800-53r5|AC-7,CN-L3|8.1.4.1(b),GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-7,NIAv2|AM24,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Centralized authentication - server"
  info        : "Authenticating users through RADIUS/TACACS provides a centralized way to manage access to the switch. This allows the administrator to make modifications to the set of authorized users without having to make changes on every network device. RADIUS/TACACS authentication is supported by Aruba ClearPass Policy Manager."
  solution    : "In the following example, a RADIUS server at IP address 10.100.0.253, with the authentication key \"secret\", is configured to be used for authentication on the switch:

  switch(config)# radius-server host 10.100.0.253 key secret

  Similar to the RADIUS example above, the following command designates a TACACS server at 10.100.0.252, with the authentication key \"terces\", as an authentication server:

  switch(config)# tacacs-server host 10.100.0.252 key terces"
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  regex       : "(tacacs|radius)-server"
  item        : "(tacacs|radius)-server host .+"
  reference   : "800-171|3.5.1,800-53|IA-2,800-53r5|IA-2,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Centralized authentication - configuration"
  info        : "Authenticating users through RADIUS provides a centralized way to manage access to the switch. This allows the administrator to make modifications to the set of authorized users without having to make changes on every network device. RADIUS authentication is supported by Aruba ClearPass Policy Manager.

  NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "To enable RADIUS authentication for serial console, SSH, and web interface login and enable access as the primary authentication method, with local authentication as the secondary method, use the following configuration commands:

  switch(config)# aaa authentication console login radius local
  switch(config)# aaa authentication console enable radius local
  switch(config)# aaa authentication ssh login radius local
  switch(config)# aaa authentication ssh enable radius local
  switch(config)# aaa authentication web login radius local
  switch(config)# aaa authentication web enable radius local

  SSH also includes authentication for SCP and SFTP file transfers.

  To enable TACACS authentication as the primary method and local authentication as the secondary method for console or SSH management access, use the following configuration commands:

  switch(config)# aaa authentication console login tacacs local
  switch(config)# aaa authentication console enable tacacs local
  switch(config)# aaa authentication ssh login tacacs local
  switch(config)# aaa authentication ssh enable tacacs local

  TACACS authentication is not supported for web management UI access."
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  regex       : "aaa authentication .*"
  item        : "Manual Review Required"
  severity    : MEDIUM
  reference   : "800-171|3.5.1,800-53|IA-2,800-53r5|IA-2,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "RADIUS and TACACS+ authorization and accounting - authorization commands access-level"
  info        : "Both RADIUS and TACACS+ provide the capability to limit access to commands through command authorization, as well as collect accounting data for management sessions, command usage, and system events. This allows for more fine-grained control of management user permissions, and monitoring of user sessions for unexpected or malicious activity.

  Command authorization can use locally defined authorization groups, RADIUS, or TACACS+, and can be enabled for all commands or limited to manager-level commands."
  solution    : "To configure command authorization for all commands using the same protocol used for authentication:

  switch(config)# aaa authorization commands access-level all
  switch(config)# aaa authorization commands auto

  Accounting data that can be sent to an external server include command usage, exec session start and stop, network usage, and system events. The following commands enable exec session start-stop accounting and command accounting with interim updates, using TACACS+ as the selected protocol:

  switch(config)# aaa accounting exec start-stop tacacs
  switch(config)# aaa accounting commands interim-update tacacs

  To use RADIUS instead:

  switch(config)# aaa accounting exec start-stop radius
  switch(config)# aaa accounting commands interim-update radius"
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  regex       : "aaa authorization commands"
  item        : "aaa authorization commands access-level all"
  reference   : "800-171|3.5.1,800-53|IA-2,800-53r5|IA-2,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "RADIUS and TACACS+ authorization and accounting - authorization commands auto"
  info        : "Both RADIUS and TACACS+ provide the capability to limit access to commands through command authorization, as well as collect accounting data for management sessions, command usage, and system events. This allows for more fine-grained control of management user permissions, and monitoring of user sessions for unexpected or malicious activity.

  Command authorization can use locally defined authorization groups, RADIUS, or TACACS+, and can be enabled for all commands or limited to manager-level commands."
  solution    : "To configure command authorization for all commands using the same protocol used for authentication:

  switch(config)# aaa authorization commands access-level all
  switch(config)# aaa authorization commands auto

  Accounting data that can be sent to an external server include command usage, exec session start and stop, network usage, and system events. The following commands enable exec session start-stop accounting and command accounting with interim updates, using TACACS+ as the selected protocol:

  switch(config)# aaa accounting exec start-stop tacacs
  switch(config)# aaa accounting commands interim-update tacacs

  To use RADIUS instead:

  switch(config)# aaa accounting exec start-stop radius
  switch(config)# aaa accounting commands interim-update radius"
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  regex       : "aaa authorization commands"
  item        : "aaa authorization commands auto"
  reference   : "800-171|3.5.1,800-53|IA-2,800-53r5|IA-2,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "RADIUS and TACACS+ authorization and accounting - accounting exec"
  info        : "Both RADIUS and TACACS+ provide the capability to limit access to commands through command authorization, as well as collect accounting data for management sessions, command usage, and system events. This allows for more fine-grained control of management user permissions, and monitoring of user sessions for unexpected or malicious activity.

  Command authorization can use locally defined authorization groups, RADIUS, or TACACS+, and can be enabled for all commands or limited to manager-level commands."
  solution    : "To configure command authorization for all commands using the same protocol used for authentication:

  switch(config)# aaa authorization commands access-level all
  switch(config)# aaa authorization commands auto

  Accounting data that can be sent to an external server include command usage, exec session start and stop, network usage, and system events. The following commands enable exec session start-stop accounting and command accounting with interim updates, using TACACS+ as the selected protocol:

  switch(config)# aaa accounting exec start-stop tacacs
  switch(config)# aaa accounting commands interim-update tacacs

  To use RADIUS instead:

  switch(config)# aaa accounting exec start-stop radius
  switch(config)# aaa accounting commands interim-update radius"
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  regex       : "aaa accounting exec"
  item        : "aaa accounting exec start-stop (tacacs|radius)"
  reference   : "800-171|3.5.1,800-53|IA-2,800-53r5|IA-2,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "RADIUS and TACACS+ authorization and accounting - accounting commands"
  info        : "Both RADIUS and TACACS+ provide the capability to limit access to commands through command authorization, as well as collect accounting data for management sessions, command usage, and system events. This allows for more fine-grained control of management user permissions, and monitoring of user sessions for unexpected or malicious activity.

  Command authorization can use locally defined authorization groups, RADIUS, or TACACS+, and can be enabled for all commands or limited to manager-level commands."
  solution    : "To configure command authorization for all commands using the same protocol used for authentication:

  switch(config)# aaa authorization commands access-level all
  switch(config)# aaa authorization commands auto

  Accounting data that can be sent to an external server include command usage, exec session start and stop, network usage, and system events. The following commands enable exec session start-stop accounting and command accounting with interim updates, using TACACS+ as the selected protocol:

  switch(config)# aaa accounting exec start-stop tacacs
  switch(config)# aaa accounting commands interim-update tacacs

  To use RADIUS instead:

  switch(config)# aaa accounting exec start-stop radius
  switch(config)# aaa accounting commands interim-update radius"
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  regex       : "aaa accounting commands"
  item        : "aaa accounting commands interim-update (tacacs|radius)"
  reference   : "800-171|3.5.1,800-53|IA-2,800-53r5|IA-2,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Server-supplied privilege level"
  info        : "Login privilege level instructs the switch to accept the authenticating user's command level (manager or operator) that is supplied by the server. This allows manager-level users to skip the login context and proceed immediately to enable context, thus eliminating the need for a manager-level user to log in twice."
  solution    : "To allow the switch to accept the privilege level provided by the server, use the following configuration command:

  switch(config)# aaa authentication login privilege-mode

  To supply a privilege level for a user account on a RADIUS server, specify the \"Service-Type\" attribute in the user's credentials:
  -  Service-Type = 6 allows manager-level access
  -  Service-Type = 7 allows operator-level access
  -  A user with no Service-Type, or a Service-Type not equal to 6 or 7, is denied access

  To supply a privilege level for a user account on a TACACS server, specify the \"Max Privilege\" level in the user's credentials:
  -  Max-privilege = 15 allows manager-level access
  -  Max-privilege = 0 allows only operator-level access"
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  regex       : "aaa authentication"
  item        : "aaa authentication login privilege-mode"
  reference   : "800-171|3.5.1,800-53|IA-2,800-53r5|IA-2,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Console inactivity timer"
  info        : "The console inactivity timer should be configured to a nonzero value. Leaving the inactivity timer set to zero (the default setting) prevents an idle console session from timing out, and leaves the session open to anyone with access to the management station. When the inactivity time threshold is met the session is terminated and the user must reauthenticate. The inactivity timer can be set between 0 (disabled) and 120 minutes."
  solution    : "Use the following command to set a 5-minute inactivity timer:

  switch(config): console inactivity-timer 5"
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  regex       : "console"
  item        : "console inactivity-timer 5"
  reference   : "800-171|3.1.11,800-53|AC-12,800-53r5|AC-12,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ITSG-33|AC-12,NIAv2|NS49"
</custom_item>

# Attack prevention

<custom_item>
  type        : CONFIG_CHECK
  description : "Control Plane Policing"
  info        : "Control Plane Policing (CoPP)-available on the 5400R (v3-only mode), 3810M, and 2930 switch platforms-prevents flooding of certain types of packets from overloading the switch or module CPU by either rate-limiting or dropping packets. The switch software provides a number of default classes of packets that can be rate-limited, including broadcasts, MAC notifications, routing protocols (BGP, OSPF, RIP), and spanning tree protocols (MSTP and PVST).

  To enable CoPP using all pre-defined traffic classes and their default rate limits:

  switch(config)# copp traffic-class all limit default

  NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Users can also create up to 8 custom CoPP traffic classes that may either rate-limit or drop packets based on destination IPv4/IPv6 address and/or TCP or UDP port.

  This example limits SNMP traffic entering the switch, regardless of destination IP address, to a maximum of 80 packets per second:

  switch(config)# copp user-def 1 ipv4 any udp 161 limit 80

  With this CoPP class configured, SNMP packets entering the switch in excess of the allowed 80 per second are dropped.

  This second example causes all Telnet packets entering the switch to be dropped:

  switch(config)# copp user-def 2 ipv4 any tcp 23 drop"
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  regex       : "copp .*"
  item        : "Manual Review Required"
  severity    : MEDIUM
  reference   : "800-53|SC-5,800-53r5|SC-5,CSF|DE.CM-1,CSF|PR.DS-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-5,ITSG-33|SC-5a.,NESA|T3.3.1,NIAv2|GS8e,NIAv2|GS10c,QCSC-v1|8.2.1"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Port security"
  info        : "The port security feature allows network managers to specify specific devices (by MAC address) that have access to ports on a switch, or to limit the number of devices that can connect to a port at the same time. Authorized MAC addresses can be specified manually by a switch administrator, learned dynamically as devices are connected, or authorized by a specified RADIUS server.

  NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "In this example, port security is configured on port 2 in configured address mode with two statically assigned addresses, an address limit of 2, eavesdrop prevention enabled, and with intrusion detection configured to both send an SNMP trap and disable the port:

  switch(config)# port-security 2 learn-mode configured address-limit 2 mac-address 308d99-000000 308d99-000001 eavesdrop-prevention action send-disable

  This configuration will allow only the two devices specified by their MAC addresses to connect to port 2 (for example, an IP phone with a passthrough Ethernet port connected to a PC); any other devices that attempt to connect to the port will be flagged as an intrusion, an SNMP trap will be sent to configured SNMP targets, and the port will automatically be disabled."
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  regex       : "port-security .*"
  item        : "Manual Review Required"
  severity    : MEDIUM
  reference   : "800-171|3.13.1,800-53|SC-7(11),800-53r5|SC-7(11),CN-L3|8.1.10.6(j),CSF|PR.AC-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(11),NESA|T4.5.4,NIAv2|GS7c,PCI-DSSv3.2.1|1.3.1,PCI-DSSv3.2.1|1.3.2,PCI-DSSv3.2.1|1.3.3,PCI-DSSv3.2.1|1.3.5,PCI-DSSv4.0|1.3.1,PCI-DSSv4.0|1.4.2,PCI-DSSv4.0|1.4.3,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|31.3"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Port security auto-recovery"
  info        : "Normally, a port disabled by the port security feature must be re-enabled manually; the auto-recovery feature allows the switch to automatically re-enable a disabled port after a specified disable timer has elapsed. The timer can be set between 1 and 300 seconds; setting it to 0 disables the timer.

  NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "To enable auto-recovery on a port, port security must be enabled by setting the MAC address learning mode to any mode other than continuous. Disabling port security by using the no port-security <port> command also clears the disable timer setting.

  The following command enables auto-recovery on port 2 with a 30-second disable timer:

  switch(config)# port-security 2 disable-timer 30"
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  regex       : "port-security .*"
  item        : "Manual Review Required"
  severity    : MEDIUM
  reference   : "800-171|3.13.1,800-53|SC-7(11),800-53r5|SC-7(11),CN-L3|8.1.10.6(j),CSF|PR.AC-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(11),NESA|T4.5.4,NIAv2|GS7c,PCI-DSSv3.2.1|1.3.1,PCI-DSSv3.2.1|1.3.2,PCI-DSSv3.2.1|1.3.3,PCI-DSSv3.2.1|1.3.5,PCI-DSSv4.0|1.3.1,PCI-DSSv4.0|1.4.2,PCI-DSSv4.0|1.4.3,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|31.3"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "DHCP snooping - global"
  info        : "DHCP snooping protects the network from common DHCP attacks, including address spoofing resulting from arogue DHCP server operating on the network, or exhaustion of addresses on a DHCP server caused by mass address requests by an attacker on the network. The feature works by designating trusted DHCP servers andports on which DHCP requests and responses will be accepted."
  solution    : "To enable DHCPv4 snooping globally:

  switch(config)# dhcp-snooping

  If using DHCPv6, this is the equivalent command:

  switch(config)# dhcpv6-snooping

  Once DHCP snooping is globally enabled, the following commands specify the DHCP server at 10.100.0.254 as an authorized server and designate port 8 on the switch-the port from which the authorized DHCP server can be reached-as a trusted port:

  switch(config)# dhcp-snooping authorized-server 10.100.0.254
  switch(config)# dhcp-snooping trust 8

  Lastly, enable DHCP snooping on client VLANs to be protected:

  switch(config)# dhcp-snooping vlan 100,110

  With this configuration, DHCP packets received from an unauthorized DHCP server on any port, or from any DHCP server (including the authorized server) on an untrusted port, will be dropped."
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  regex       : "dhcp(v6)?-snooping"
  item        : "dhcp(v6)?-snooping[\\s]*$"
  reference   : "800-53|SC-5,800-53r5|SC-5,CSF|DE.CM-1,CSF|PR.DS-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-5,ITSG-33|SC-5a.,NESA|T3.3.1,NIAv2|GS8e,NIAv2|GS10c,QCSC-v1|8.2.1"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "DHCP snooping - authorized-server"
  info        : "DHCP snooping protects the network from common DHCP attacks, including address spoofing resulting from arogue DHCP server operating on the network, or exhaustion of addresses on a DHCP server caused by mass address requests by an attacker on the network. The feature works by designating trusted DHCP servers andports on which DHCP requests and responses will be accepted."
  solution    : "To enable DHCPv4 snooping globally:

  switch(config)# dhcp-snooping

  If using DHCPv6, this is the equivalent command:

  switch(config)# dhcpv6-snooping

  Once DHCP snooping is globally enabled, the following commands specify the DHCP server at 10.100.0.254 as an authorized server and designate port 8 on the switch-the port from which the authorized DHCP server can be reached-as a trusted port:

  switch(config)# dhcp-snooping authorized-server 10.100.0.254
  switch(config)# dhcp-snooping trust 8

  Lastly, enable DHCP snooping on client VLANs to be protected:

  switch(config)# dhcp-snooping vlan 100,110

  With this configuration, DHCP packets received from an unauthorized DHCP server on any port, or from any DHCP server (including the authorized server) on an untrusted port, will be dropped."
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  regex       : "dhcp(v6)?-snooping"
  item        : "dhcp(v6)?-snooping authorized-server .+"
  reference   : "800-53|SC-5,800-53r5|SC-5,CSF|DE.CM-1,CSF|PR.DS-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-5,ITSG-33|SC-5a.,NESA|T3.3.1,NIAv2|GS8e,NIAv2|GS10c,QCSC-v1|8.2.1"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "DHCP snooping - port trust and vlans"
  info        : "DHCP snooping protects the network from common DHCP attacks, including address spoofing resulting from arogue DHCP server operating on the network, or exhaustion of addresses on a DHCP server caused by mass address requests by an attacker on the network. The feature works by designating trusted DHCP servers andports on which DHCP requests and responses will be accepted.

  NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "To enable DHCPv4 snooping globally:

  switch(config)# dhcp-snooping

  If using DHCPv6, this is the equivalent command:

  switch(config)# dhcpv6-snooping

  Once DHCP snooping is globally enabled, the following commands specify the DHCP server at 10.100.0.254 as an authorized server and designate port 8 on the switch-the port from which the authorized DHCP server can be reached-as a trusted port:

  switch(config)# dhcp-snooping authorized-server 10.100.0.254
  switch(config)# dhcp-snooping trust 8

  Lastly, enable DHCP snooping on client VLANs to be protected:

  switch(config)# dhcp-snooping vlan 100,110

  With this configuration, DHCP packets received from an unauthorized DHCP server on any port, or from any DHCP server (including the authorized server) on an untrusted port, will be dropped."
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  regex       : "dhcp(v6)?-snooping (trust|vlan) .*"
  item        : "Manual Review Required"
  severity    : MEDIUM
  reference   : "800-53|SC-5,800-53r5|SC-5,CSF|DE.CM-1,CSF|PR.DS-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-5,ITSG-33|SC-5a.,NESA|T3.3.1,NIAv2|GS8e,NIAv2|GS10c,QCSC-v1|8.2.1"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Dynamic ARP Protection - global"
  info        : "Address Resolution Protocol (ARP) allows hosts to communicate over the network by creating an IP to MAC address mapping used in the transmission of packets. Attackers can use ARP to generate bogus mappings, allowing them to spoof other clients' MAC addresses and intercept traffic destined to them. Additionally, an attacker could generate an unlimited number of artificial ARP entries, filling up the caches of other clients on the network and causing a denial of service (DoS)."
  solution    : "To enable Dynamic ARP Protection globally on the switch, use the following command:

  switch(config)# arp-protect

  To designate VLANs 10 and 20 to be protected, ports 1-4 as trusted, and enable source MAC address, destination MAC address, and IP address validation for ARP protected VLANs:

  switch(config)# arp-protect vlan 10 20
  switch(config)# arp-protect trust 1-4
  switch(config)# arp-protect validate src-mac dest-mac ip"
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  regex       : "arp-protect"
  item        : "arp-protect[\\s]*$"
  reference   : "800-53|SC-5,800-53r5|SC-5,CSF|DE.CM-1,CSF|PR.DS-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-5,ITSG-33|SC-5a.,NESA|T3.3.1,NIAv2|GS8e,NIAv2|GS10c,QCSC-v1|8.2.1"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Dynamic ARP Protection - port trust, vlans, and validate"
  info        : "Address Resolution Protocol (ARP) allows hosts to communicate over the network by creating an IP to MAC address mapping used in the transmission of packets. Attackers can use ARP to generate bogus mappings, allowing them to spoof other clients' MAC addresses and intercept traffic destined to them. Additionally, an attacker could generate an unlimited number of artificial ARP entries, filling up the caches of other clients on the network and causing a denial of service (DoS).

  NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "To enable Dynamic ARP Protection globally on the switch, use the following command:

  switch(config)# arp-protect

  To designate VLANs 10 and 20 to be protected, ports 1-4 as trusted, and enable source MAC address, destination MAC address, and IP address validation for ARP protected VLANs:

  switch(config)# arp-protect vlan 10 20
  switch(config)# arp-protect trust 1-4
  switch(config)# arp-protect validate src-mac dest-mac ip"
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  regex       : "arp-protect (vlan|trust|validate) .*"
  item        : "Manual Review Required"
  severity    : MEDIUM
  reference   : "800-53|SC-5,800-53r5|SC-5,CSF|DE.CM-1,CSF|PR.DS-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-5,ITSG-33|SC-5a.,NESA|T3.3.1,NIAv2|GS8e,NIAv2|GS10c,QCSC-v1|8.2.1"
</custom_item>

# Physical security

<custom_item>
  type            : CONFIG_CHECK
  description     : "Front panel security"
  info            : "Aruba switches use Reset and Clear buttons, on the front panel, to allow users to reset the switch configuration to factory default or to reset the console password. This capability creates a security and denial-of-service risk if the switch is in a location where it is impossible to prevent physical access to the front panel. It is recommended that administrators disable these features to prevent malicious use by an attacker with physical access to the device."
  solution        : "It is critical to understand that disabling these features severely restricts administrator options if the manager password is lost or forgotten. Before making these changes, users are encouraged to review all considerations outlined in the section \"Front panel security\" in the chapter titled \"Configuring Username and Password Security\" in the ArubaOS-Switch Access Security Guide.

  The following two commands will disable the front-panel buttons:

  switch(config)# no front-panel-security password-clear
  switch(config)# no front-panel-security factory-reset"
  see_also        : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  regex           : "no front-panel-security"
  item            : "no front-panel-security (password-clear|factory-reset)"
  min_occurrences : "2"
  reference       : "800-171|3.13.1,800-53|SC-7(16),800-53r5|SC-7(16),CN-L3|8.1.10.6(j),CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(16),NESA|T4.5.4,NIAv2|GS8d,PCI-DSSv3.2.1|1.3.7,PCI-DSSv4.0|1.4.5,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "USB port"
  info        : "The switch includes a USB port to receive a flash drive for deploying, troubleshooting, backing up configurations, or updating switches. This port should be disabled when not in use, and only temporarily enabled when needed."
  solution    : "To enable the USB port, use the following command:

  switch# usb-port

  To disable the port:

  switch# no usb-port"
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  item        : "no usb-port"
  reference   : "800-171|3.13.1,800-53|SC-7(14),800-53r5|SC-7(14),CN-L3|8.1.3.1(b),CN-L3|8.1.3.1(c),CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(14),NESA|T4.5.4,NIAv2|CS1,NIAv2|CS2,NIAv2|CS3,NIAv2|NS5b,NIAv2|PH6,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.1,TBA-FIISB|43.1"
</custom_item>

# MACsec

<custom_item>
  type        : CONFIG_CHECK
  description : "MACsec"
  info        : "Media Access Control security (MACsec) is an IEEE 802 standard specifying how to transparently secure all orpart of a Local Area Network (LAN) at the link layer. MACsec PHY devices can do this while meeting the scalability and high-speed requirements set on such networks. MACsec is intended for wired LANs only, as wireless networks use a different protocol set. To ensure wired network security, MACsec functionality is required on newer-generation network infrastructure switches. It is supported on the Aruba 5400R (v3 modules only),3810M, and 2930M switch families.

  NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "To define a MACsec policy and assign a CA Key Name (CKN) and CA Key:

  switch(config)# macsec policy macsecpolicy
  switch(Policy-examplepolicy)# mode pre-shared-key ckn 1a2b3c4d5e6f cak f6e5d4c3b2a1

  To assign the MACsec policy examplepolicy to ports 21-24:

  switch(config)# macsec apply policy macsecpolicy 21-24"
  see_also    : "https://support.hpe.com/hpesc/public/docDisplay?docId=a00056155en_us"
  regex       : "macsec .*"
  item        : "Manual Review Required"
  severity    : MEDIUM
  reference   : "800-53|SC-5,800-53r5|SC-5,CSF|DE.CM-1,CSF|PR.DS-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-5,ITSG-33|SC-5a.,NESA|T3.3.1,NIAv2|GS8e,NIAv2|GS10c,QCSC-v1|8.2.1"
</custom_item>

</check_type>
