#TRUSTED 243439d6c0f877416322c7bcc40351cf4d3331fb0bbd0b071b47756681b0483bea4631fc48a252b1da244271158640eca355c01832c7f93399976e4aa864cf17f087e88459e2857a04f8b406ee74e0369f21441fdbf1cbe8d6aa23d373a0c30e8420b3239b7878d1304a4f6d0ca84039720b94b1bb32d43c328cdb3ed36ca9958fd528d7645776fb729f70c3df69fd651a5a9236e3d08bb17e77b3317ecab958fb79551b5ca3436ac533b1b843b8169f57a035e1023be5b6fdd65132b45e2689a59780abf8c8e27fe79c0099adf0aace9e1fb434a41f55e3aa0655bcc1deb5010bd25f64ca8a4c7dd9f5ca232d343b16d4aab1474e6d12a6ba8a4580caa74dc73ce1155bb7d3f085c200cc0ed852d144e45dc52b887d31693e23684cabf8e9c9dc4768491c042531f3e8f663c8a9e43878f1397c09c49074aac4fef657c75a28339af0809f9311f1b89f6f5de8faa577afe4b1883f48fcaf6bb6a9b4f5d774e68845234207364f4c217372e0ede9777632b46e68b6e59a1fada88ef9e9696eba76807ed497ba980ff027c17a613b8965f98cd9c5277614ea7813e21ddce4aca9ac4b15baa70edc38f511f3b416b33dbe4d8ea3347f62a2bf07d85fdea691301dd20a3e014b259e6be32f23524a93581965f8ea424b9a30e82cb4bc32767a1338e262076d61544af5003467d795932e4e53460052deef4f9acb823385ecb5089a
#TRUST-RSA-SHA256 1e268d3ddf0dfca2356ffc7a9d80d9ccd2b027adf6013bb0aea10626c4ad4b8ca3220519831749a5fd1a0314351db2578dafed9e49784011c55ba9ca1725e2c87f47f8363821eb003a0714c452a6bd2fc6f423c5fc328269324dd70fe17f1ad31b304f57d73fa8fb765c76cd3dd02d0853aa724b6af489567be1a8869dc5ae5bf1b7f8ba82fa17a1b1d367a7b7821b1197a578095fd32d03a6b606fe62f4003eff23e5129fc8b2ff0b096dbef53b6e7490d683c72d16c1921523d3b18473ee25612f440af8ff6b4fee681a4b20c232822ca89ef1847fa01f83eb6c660e2fa1c9ddd1355d543b51a9775f8d539d5df68afa02fac6e2b22c494d8752899993ff030ef9ca8de8d7c012d479280826cf74ba7462a7221d9787312ac68a189b9e093e481e529e380c000a48cb9bd33bc4abee50ac586cc0f11f23c196d93797927c1d7679d117ecb8989b24a9c40c03425225acc1db4ebc4b56924195a7597d91041ed51a67e9bc5e9605a8314208fbac877a5969c186f5c9050fbec11b05168d99d5c8fa841041e1b2679e74722cad94e13f6c4c9bbb2b479d900b1e4d78c0d1b64c20d4862c9df656e764aab2c4b5550e02dcc19286f0dcd1199628d328cdfa23e8b33ce0d0a72b5e8e7a3945b18c79490ee1882f6d753a5ece70ef1c30f805a5008e37b71c9d2431b16f9bb2a440891b5c5b437211b5e9b09464d1c44bee7521fd
#
# This script is Copyright (C) 2004-2025 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
# $Revision: 1.1 $
# $Date: 2025/04/21 $
#
# Description : This document implements the security configuration as recommended by the
#               DISA Palo Alto Networks NDM v3r2 STIG.
#
#<ui_metadata>
#<display_name>DISA STIG Palo Alto NDM v3r2</display_name>
#<spec>
#  <type>DISA STIG</type>
#  <name>Palo Alto NDM</name>
#  <version>3.2.0</version>
#  <link>https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_PAN_Y24M10_STIG.zip</link>
#</spec>
#<labels>palo_alto,disa,panos,pan</labels>
#<benchmark_refs>CAT,CCE,CCI,DISA_Benchmark,Group-ID,Rule-ID,STIG-ID,STIG-Legacy,Vuln-ID</benchmark_refs>
#<variables>
#  <variable>
#    <name>BANNER_TEXT</name>
#    <default>^[\\s]*You are accessing a U.S. Government \\(USG\\) Information System \\(IS\\) that is provided for USG-authorized use only\.</default>
#    <description>Banner text</description>
#    <info>The text of the SSH logon banner file. The contents of the text must meet DoD requirements.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>CONFIG_TYPE</name>
#    <default>merged</default>
#    <description>Palo Alto Config Type</description>
#    <info>Type of configuration audited. Valid entries are merged or effective-running.</info>
#    <value_type>PALO_ALTO_CONFIG</value_type>
#  </variable>
#</variables>
#</ui_metadata>

<check_type:"Palo_Alto">

<report type:"PASSED">
  description : "DISA_STIG_Palo_Alto_Networks_NDM_v3r2.audit from DISA Palo Alto Networks NDM v3r2 STIG"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_PAN_Y24M10_STIG.zip"
</report>

<custom_item>
  type             : AUDIT_XML
  description      : "PANW-NM-000015 - The Palo Alto Networks security platform must enforce the limit of three consecutive invalid logon attempts."
  info             : "By limiting the number of failed logon attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute-forcing, is reduced."
  solution         : "This should not be configured in Device >> Setup >> Management >> Authentication Settings; instead, an authentication profile should be configured with lockout settings of three failed attempts and a lockout time of zero minutes.
Go to Device >> Authentication Profile
Select the configured authentication profile or select 'Add' (in the bottom-left corner of the pane) to create a new one.
In the 'Authentication Profile' field, enter the name of the authentication profile that will be used to control each person's authentication process.
The 'Lockout Time (min)' field is the lockout duration; this must be set to '0'.  This will keep the lockout in effect until it is manually unlocked.
In the 'Failed Attempts' field, enter '3'.
Select 'OK'.

Apply the authentication profile to the Administrator accounts.
Go to Device >> Administrators
Select each configured account or select 'Add' (in the bottom-left corner of the pane) to create a new one.
In the 'Authentication Profile' field, enter the configured authentication profile.
Select 'OK'.

This authentication profile should not be applied to the emergency administration account since it has special requirements.
Commit changes by selecting 'Commit' in the upper-right corner of the screen.
Select 'OK' when the confirmation dialog appears."
  reference        : "800-171|3.1.8,800-171r3|03.01.08a.,800-53|AC-7a.,800-53r5|AC-7a.,CAT|II,CCI|CCI-000044,CN-L3|8.1.4.1(b),CSF2.0|PR.AA-03,DISA_Benchmark|Palo_Alto_Networks_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.5,ITSG-33|AC-7a.,NESA|T5.5.1,NIAv2|AM24,PCI-DSSv3.2.1|8.1.6,PCI-DSSv4.0|8.3.4,Rule-ID|SV-228639r960840_rule,STIG-ID|PANW-NM-000015,STIG-Legacy|SV-77195,STIG-Legacy|V-62705,TBA-FIISB|45.1.2,TBA-FIISB|45.2.1,TBA-FIISB|45.2.2,Vuln-ID|V-228639"
  see_also         : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_PAN_Y24M10_STIG.zip"
  api_request_type : "op"
  request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
  xsl_stmt         : "<xsl:template match=\"/\">"
  xsl_stmt         : "<xsl:for-each select=\"response/result/config/shared/authentication-profile/entry\">"
  xsl_stmt         : "<xsl:text xml:space=\"preserve\">&#10;</xsl:text>"
  xsl_stmt         : "<xsl:choose>"
  xsl_stmt         : "<xsl:when test=\"lockout/failed-attempts &gt; 3\">"
  xsl_stmt         : "<xsl:text>Failed authentication profile: </xsl:text><xsl:value-of select=\"@name\"/> - <xsl:text>Lockout attempts: </xsl:text><xsl:value-of select=\"lockout/failed-attempts\"/>"
  xsl_stmt         : "</xsl:when>"
  xsl_stmt         : "<xsl:otherwise>"
  xsl_stmt         : "<xsl:text>Passed authentication profile: </xsl:text><xsl:value-of select=\"@name\"/> - <xsl:text>Lockout attempts: </xsl:text><xsl:value-of select=\"lockout/failed-attempts\"/>"
  xsl_stmt         : "</xsl:otherwise>"
  xsl_stmt         : "</xsl:choose>"
  xsl_stmt         : "</xsl:for-each>"
  regex            : "(Failed|Passed)"
  not_expect       : "Failed"
</custom_item>

<custom_item>
  type             : AUDIT_XML
  description      : "PANW-NM-000016 - The Palo Alto Networks security platform must display the Standard Mandatory DoD Notice and Consent Banner before granting access to the device."
  info             : "Display of the DoD-approved use notification before granting access to the network device ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.

System use notifications are required only for access via logon interfaces with human users."
  solution         : "Go to Device >> Setup >> Management >> General Settings ('Edit' icon) >> Login Banner
Type in the required text
Select 'OK'.
Commit changes by selecting 'Commit' in the upper-right corner of the screen.
Select 'OK' when the confirmation dialog appears."
  reference        : "800-171|3.1.9,800-171r3|03.01.09,800-53|AC-8a.,800-53r5|AC-8a.,CAT|III,CCI|CCI-000048,DISA_Benchmark|Palo_Alto_Networks_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.5,ITSG-33|AC-8a.,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,Rule-ID|SV-228640r960843_rule,STIG-ID|PANW-NM-000016,STIG-Legacy|SV-77197,STIG-Legacy|V-62707,TBA-FIISB|45.2.4,Vuln-ID|V-228640"
  see_also         : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_PAN_Y24M10_STIG.zip"
  api_request_type : "op"
  request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
  xsl_stmt         : "<xsl:template match=\"/\">"
  xsl_stmt         : "<xsl:choose>"
  xsl_stmt         : "<xsl:when test=\"not(//login-banner) or not(//login-banner = '@BANNER_TEXT@')\">"
  xsl_stmt         : "<xsl:text>Failed - Login Banner not set</xsl:text>"
  xsl_stmt         : "</xsl:when>"
  xsl_stmt         : "<xsl:otherwise>"
  xsl_stmt         : "<xsl:text>Passed - Login Banner set</xsl:text>"
  xsl_stmt         : "</xsl:otherwise>"
  xsl_stmt         : "</xsl:choose>"
  regex            : "(Failed|Passed)"
  not_expect       : "Failed"
</custom_item>

<if>
  <condition auto:"FAILED" type:"AND">
    <custom_item>
      type             : AUDIT_XML
      description      : "System Logs 'INFORMATIONAL'"
      api_request_type : "op"
      request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
      xsl_stmt         : "<xsl:template match=\"/\">"
      xsl_stmt         : "<xsl:choose>"
      xsl_stmt         : "<xsl:when test=\"(/response/result/config/shared/log-settings/system/match-list/entry/send-syslog) and (/response/result/config/shared/log-settings/system/match-list/entry/filter='(severity eq informational)' or /response/result/config/shared/log-settings/system/match-list/entry/filter='All Logs')\">"
      xsl_stmt         : "<xsl:text>Passed - INFORMATIONAL Syslog Server - </xsl:text><xsl:value-of select=\"/response/result/config/shared/log-settings/system/match-list/entry/send-syslog/member\"/>"
      xsl_stmt         : "</xsl:when>"
      xsl_stmt         : "<xsl:otherwise>"
      xsl_stmt         : "<xsl:text>Failed - No Syslog Server set for INFORMATIONAL Log Level</xsl:text>"
      xsl_stmt         : "</xsl:otherwise>"
      xsl_stmt         : "</xsl:choose>"
      regex            : "(Failed|Passed)"
      not_expect       : "Failed"
    </custom_item>

    <custom_item>
      type             : AUDIT_XML
      description      : "System Logs 'LOW'"
      api_request_type : "op"
      request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
      xsl_stmt         : "<xsl:template match=\"/\">"
      xsl_stmt         : "<xsl:choose>"
      xsl_stmt         : "<xsl:when test=\"(/response/result/config/shared/log-settings/system/match-list/entry/send-syslog) and (/response/result/config/shared/log-settings/system/match-list/entry/filter='(severity eq low)' or /response/result/config/shared/log-settings/system/match-list/entry/filter='All Logs')\">"
      xsl_stmt         : "<xsl:text>Passed - LOW Syslog Server - </xsl:text><xsl:value-of select=\"/response/result/config/shared/log-settings/system/match-list/entry/send-syslog/member\"/>"
      xsl_stmt         : "</xsl:when>"
      xsl_stmt         : "<xsl:otherwise>"
      xsl_stmt         : "<xsl:text>Failed - No Syslog Server set for LOW Log Level</xsl:text>"
      xsl_stmt         : "</xsl:otherwise>"
      xsl_stmt         : "</xsl:choose>"
      regex            : "(Failed|Passed)"
      not_expect       : "Failed"
    </custom_item>

    <custom_item>
      type             : AUDIT_XML
      description      : "System Logs 'MEDIUM'"
      api_request_type : "op"
      request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
      xsl_stmt         : "<xsl:template match=\"/\">"
      xsl_stmt         : "<xsl:choose>"
      xsl_stmt         : "<xsl:when test=\"(/response/result/config/shared/log-settings/system/match-list/entry/send-syslog) and (/response/result/config/shared/log-settings/system/match-list/entry/filter='(severity eq medium)' or /response/result/config/shared/log-settings/system/match-list/entry/filter='All Logs')\">"
      xsl_stmt         : "<xsl:text>Passed - MEDIUM Syslog Server - </xsl:text><xsl:value-of select=\"/response/result/config/shared/log-settings/system/match-list/entry/send-syslog/member\"/>"
      xsl_stmt         : "</xsl:when>"
      xsl_stmt         : "<xsl:otherwise>"
      xsl_stmt         : "<xsl:text>Failed - No Syslog Server set for MEDIUM Log Level</xsl:text>"
      xsl_stmt         : "</xsl:otherwise>"
      xsl_stmt         : "</xsl:choose>"
      regex            : "(Failed|Passed)"
      not_expect       : "Failed"
    </custom_item>

    <custom_item>
      type             : AUDIT_XML
      description      : "System Logs 'HIGH'"
      api_request_type : "op"
      request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
      xsl_stmt         : "<xsl:template match=\"/\">"
      xsl_stmt         : "<xsl:choose>"
      xsl_stmt         : "<xsl:when test=\"(/response/result/config/shared/log-settings/system/match-list/entry/send-syslog) and (/response/result/config/shared/log-settings/system/match-list/entry/filter='(severity eq high)' or /response/result/config/shared/log-settings/system/match-list/entry/filter='All Logs')\">"
      xsl_stmt         : "<xsl:text>Passed - HIGH Syslog Server - </xsl:text><xsl:value-of select=\"/response/result/config/shared/log-settings/system/match-list/entry/send-syslog/member\"/>"
      xsl_stmt         : "</xsl:when>"
      xsl_stmt         : "<xsl:otherwise>"
      xsl_stmt         : "<xsl:text>Failed - No Syslog Server set for HIGH Log Level</xsl:text>"
      xsl_stmt         : "</xsl:otherwise>"
      xsl_stmt         : "</xsl:choose>"
      regex            : "(Failed|Passed)"
      not_expect       : "Failed"
    </custom_item>

    <custom_item>
      type             : AUDIT_XML
      description      : "System Logs 'CRITICAL'"
      api_request_type : "op"
      request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
      xsl_stmt         : "<xsl:template match=\"/\">"
      xsl_stmt         : "<xsl:choose>"
      xsl_stmt         : "<xsl:when test=\"(/response/result/config/shared/log-settings/system/match-list/entry/send-syslog) and (/response/result/config/shared/log-settings/system/match-list/entry/filter='(severity eq critical)' or /response/result/config/shared/log-settings/system/match-list/entry/filter='All Logs')\">"
      xsl_stmt         : "<xsl:text>Passed - CRITICAL Syslog Server - </xsl:text><xsl:value-of select=\"/response/result/config/shared/log-settings/system/match-list/entry/send-syslog/member\"/>"
      xsl_stmt         : "</xsl:when>"
      xsl_stmt         : "<xsl:otherwise>"
      xsl_stmt         : "<xsl:text>Failed - No Syslog Server set for CRITICAL Log Level</xsl:text>"
      xsl_stmt         : "</xsl:otherwise>"
      xsl_stmt         : "</xsl:choose>"
      regex            : "(Failed|Passed)"
      not_expect       : "Failed"
    </custom_item>

    <custom_item>
      type             : AUDIT_XML
      description      : "Configuration Logs 'INFORMATIONAL'"
      api_request_type : "op"
      request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
      xsl_stmt         : "<xsl:template match=\"/\">"
      xsl_stmt         : "<xsl:choose>"
      xsl_stmt         : "<xsl:when test=\"(/response/result/config/shared/log-settings/config/match-list/entry/send-syslog) and (/response/result/config/shared/log-settings/config/match-list/entry/filter='(severity eq informational)' or /response/result/config/shared/log-settings/config/match-list/entry/filter='All Logs')\">"
      xsl_stmt         : "<xsl:text>Passed - INFORMATIONAL Syslog Server - </xsl:text><xsl:value-of select=\"/response/result/config/shared/log-settings/config/match-list/entry/send-syslog/member\"/>"
      xsl_stmt         : "</xsl:when>"
      xsl_stmt         : "<xsl:otherwise>"
      xsl_stmt         : "<xsl:text>Failed - No Syslog Server set for INFORMATIONAL Log Level</xsl:text>"
      xsl_stmt         : "</xsl:otherwise>"
      xsl_stmt         : "</xsl:choose>"
      regex            : "(Failed|Passed)"
      not_expect       : "Failed"
    </custom_item>

    <custom_item>
      type             : AUDIT_XML
      description      : "Configuration Logs 'LOW'"
      api_request_type : "op"
      request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
      xsl_stmt         : "<xsl:template match=\"/\">"
      xsl_stmt         : "<xsl:choose>"
      xsl_stmt         : "<xsl:when test=\"(/response/result/config/shared/log-settings/config/match-list/entry/send-syslog) and (/response/result/config/shared/log-settings/config/match-list/entry/filter='(severity eq low)' or /response/result/config/shared/log-settings/config/match-list/entry/filter='All Logs')\">"
      xsl_stmt         : "<xsl:text>Passed - LOW Syslog Server - </xsl:text><xsl:value-of select=\"/response/result/config/shared/log-settings/config/match-list/entry/send-syslog/member\"/>"
      xsl_stmt         : "</xsl:when>"
      xsl_stmt         : "<xsl:otherwise>"
      xsl_stmt         : "<xsl:text>Failed - No Syslog Server set for LOW Log Level</xsl:text>"
      xsl_stmt         : "</xsl:otherwise>"
      xsl_stmt         : "</xsl:choose>"
      regex            : "(Failed|Passed)"
      not_expect       : "Failed"
    </custom_item>

    <custom_item>
      type             : AUDIT_XML
      description      : "Configuration Logs 'MEDIUM'"
      api_request_type : "op"
      request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
      xsl_stmt         : "<xsl:template match=\"/\">"
      xsl_stmt         : "<xsl:choose>"
      xsl_stmt         : "<xsl:when test=\"(/response/result/config/shared/log-settings/config/match-list/entry/send-syslog) and (/response/result/config/shared/log-settings/config/match-list/entry/filter='(severity eq medium)' or /response/result/config/shared/log-settings/config/match-list/entry/filter='All Logs')\">"
      xsl_stmt         : "<xsl:text>Passed - MEDIUM Syslog Server - </xsl:text><xsl:value-of select=\"/response/result/config/shared/log-settings/config/match-list/entry/send-syslog/member\"/>"
      xsl_stmt         : "</xsl:when>"
      xsl_stmt         : "<xsl:otherwise>"
      xsl_stmt         : "<xsl:text>Failed - No Syslog Server set for MEDIUM Log Level</xsl:text>"
      xsl_stmt         : "</xsl:otherwise>"
      xsl_stmt         : "</xsl:choose>"
      regex            : "(Failed|Passed)"
      not_expect       : "Failed"
    </custom_item>

    <custom_item>
      type             : AUDIT_XML
      description      : "Configuration Logs 'HIGH'"
      api_request_type : "op"
      request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
      xsl_stmt         : "<xsl:template match=\"/\">"
      xsl_stmt         : "<xsl:choose>"
      xsl_stmt         : "<xsl:when test=\"(/response/result/config/shared/log-settings/config/match-list/entry/send-syslog) and (/response/result/config/shared/log-settings/config/match-list/entry/filter='(severity eq high)' or /response/result/config/shared/log-settings/config/match-list/entry/filter='All Logs')\">"
      xsl_stmt         : "<xsl:text>Passed - HIGH Syslog Server - </xsl:text><xsl:value-of select=\"/response/result/config/shared/log-settings/config/match-list/entry/send-syslog/member\"/>"
      xsl_stmt         : "</xsl:when>"
      xsl_stmt         : "<xsl:otherwise>"
      xsl_stmt         : "<xsl:text>Failed - No Syslog Server set for HIGH Log Level</xsl:text>"
      xsl_stmt         : "</xsl:otherwise>"
      xsl_stmt         : "</xsl:choose>"
      regex            : "(Failed|Passed)"
      not_expect       : "Failed"
    </custom_item>

    <custom_item>
      type             : AUDIT_XML
      description      : "Configuration Logs 'CRITICAL'"
      api_request_type : "op"
      request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
      xsl_stmt         : "<xsl:template match=\"/\">"
      xsl_stmt         : "<xsl:choose>"
      xsl_stmt         : "<xsl:when test=\"(/response/result/config/shared/log-settings/config/match-list/entry/send-syslog) and (/response/result/config/shared/log-settings/config/match-list/entry/filter='(severity eq critical)' or /response/result/config/shared/log-settings/config/match-list/entry/filter='All Logs')\">"
      xsl_stmt         : "<xsl:text>Passed - CRITICAL Syslog Server - </xsl:text><xsl:value-of select=\"/response/result/config/shared/log-settings/config/match-list/entry/send-syslog/member\"/>"
      xsl_stmt         : "</xsl:when>"
      xsl_stmt         : "<xsl:otherwise>"
      xsl_stmt         : "<xsl:text>Failed - No Syslog Server set for CRITICAL Log Level</xsl:text>"
      xsl_stmt         : "</xsl:otherwise>"
      xsl_stmt         : "</xsl:choose>"
      regex            : "(Failed|Passed)"
      not_expect       : "Failed"
    </custom_item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "PANW-NM-000024 - The Palo Alto Networks security platform must generate audit records when successful/unsuccessful attempts to access privileges occur"
      info        : "Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

By default, the Configuration Log contains the administrator username, client (Web or CLI), and date and time for any changes to configurations and for configuration commit actions.  The System Log also shows both successful and unsuccessful attempts for configuration commit actions.

The System Log and Configuration Log can be configured to send log messages by severity level to specific destinations; the Panorama management console, an SNMP console, an e-mail server, or a syslog server.  Since both the System Log and Configuration Log contain information concerning the use of privileges, both must be configured to send messages to a syslog server at a minimum."
      solution    : "Create a syslog server profile.
Go to Device >> Server Profiles >> Syslog
Select 'Add'
In the 'Syslog Server Profile', enter the name of the profile; select 'Add'.
In the 'Servers' tab, enter the required information.
Name: Name of the syslog server
Server: Server IP address where the logs will be forwarded to
Port: Default port 514
Facility: Select from the drop down list
Select 'OK'.

Go to Device >> Log Settings >> System
For each severity level, select which destinations should receive the log messages.
Note: The 'Syslog Profile' field must be completed.

Commit changes by selecting 'Commit' in the upper-right corner of the screen.
Select 'OK' when the confirmation dialog appears."
      reference   : "800-171|3.3.1,800-171|3.3.2,800-171r3|03.03.03a.,800-53|AU-12c.,800-53r5|AU-12c.,CAT|II,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|DE.CM-09,CSF2.0|PR.PS-04,DISA_Benchmark|Palo_Alto_Networks_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO-27001-2022|A.8.15,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-228642r960885_rule,STIG-ID|PANW-NM-000024,STIG-Legacy|SV-77201,STIG-Legacy|V-62711,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-228642"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_PAN_Y24M10_STIG.zip"
      show_output : YES
    </report>
  </then>
</if>

<if>
  <condition auto:"FAILED" type:"AND">
    <custom_item>
      type             : AUDIT_XML
      description      : "'Hostname'"
      api_request_type : "op"
      request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
      xsl_stmt         : "<xsl:template match=\"/\">"
      xsl_stmt         : "<xsl:choose>"
      xsl_stmt         : "<xsl:when test=\"response/result/config/devices/entry/deviceconfig/system/hostname\">"
      xsl_stmt         : "<xsl:text>Passed - Device Hostname - </xsl:text><xsl:value-of select=\"response/result/config/devices/entry/deviceconfig/system/hostname\"/>"
      xsl_stmt         : "</xsl:when>"
      xsl_stmt         : "<xsl:otherwise>"
      xsl_stmt         : "<xsl:text>Failed - No device hostname is set</xsl:text>"
      xsl_stmt         : "</xsl:otherwise>"
      xsl_stmt         : "</xsl:choose>"
      regex            : "(Failed|Passed)"
      not_expect       : "Failed - No device hostname is set"
    </custom_item>

    <custom_item>
      type             : AUDIT_XML
      description      : "'Send Hostname in Syslog'"
      api_request_type : "op"
      request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
      xsl_stmt         : "<xsl:template match=\"/response/result/config/devices/entry/deviceconfig/setting/management\">"
      xsl_stmt         : "<xsl:choose>"
      xsl_stmt         : "<xsl:when test=\"hostname-type-in-syslog = 'FQDN' or hostname-type-in-syslog = 'hostname' or hostname-type-in-syslog = 'ipv4-address' or hostname-type-in-syslog = 'ipv6-address'\">"
      xsl_stmt         : "<xsl:text>Passed - Send Hostname set in Syslog</xsl:text>"
      xsl_stmt         : "</xsl:when>"
      xsl_stmt         : "<xsl:otherwise>"
      xsl_stmt         : "<xsl:text>Failed - Send Hostname in Syslog is not set</xsl:text>"
      xsl_stmt         : "</xsl:otherwise>"
      xsl_stmt         : "</xsl:choose>"
      regex            : "(Failed|Passed)"
      not_expect       : "Failed - Send Hostname in Syslog is not set"
    </custom_item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "PANW-NM-000029 - The Palo Alto Networks security platform must produce audit log records containing information (FQDN, unique hostname, management IP address) to establish the source of events"
      info        : "In order to compile an accurate risk assessment and provide forensic analysis, it is essential for security personnel to know the source of the event.  The source may be a component, module, or process within the device or an external session, administrator, or device.  Associating information about where the source of the event occurred provides a means of investigating an attack; recognizing resource utilization or capacity thresholds; or identifying an improperly configured device.

The device must have a unique hostname that can be used to identify the device; fully qualified domain name (FQDN), hostname, or management IP address is used in audit logs to identify the source of a log message."
      solution    : "Set a unique hostname.
Go to Device >> Setup >> Management
in the 'General Settings' window, select the 'Edit' icon (the gear symbol in the upper-right corner of the pane).
In the 'General Settings' window, in the 'hostname' field; enter a unique hostname.
Select 'OK'.

Configure the device to send the FQDN, hostname, ipv4-address, or ipv6-address with log messages.
Device >> Setup >> Management
Click the 'Edit' icon in the 'Logging and Reporting Settings' section.
Select the 'Log Export and Reporting' tab.
Select one of the following options from the 'Send Hostname in the Syslog' drop-down list:
FQDN - (the default) Concatenates the hostname and domain name defined on the sending device.
hostname - Uses the hostname defined on the sending device.
ipv4-address -Uses the IPv4 address of the interface used to send logs on the device. By default, this is the management interface of the device.
ipv6-address -Uses the IPv6 address of the interface used to send logs on the device. By default, this is the management interface of the device.
Note that the last two selections must be consistent with the IP address used by the management interface.
Select 'OK'.
Commit changes by selecting 'Commit' in the upper-right corner of the screen.  Select 'OK' when the confirmation dialog appears."
      reference   : "800-171|3.3.1,800-171|3.3.2,800-171r3|03.03.02a.,800-53|AU-3,800-53r5|AU-3d.,CAT|III,CCI|CCI-000133,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.3.3(a),CN-L3|8.1.4.3(b),CSF|PR.PT-1,CSF2.0|PR.PS-04,DISA_Benchmark|Palo_Alto_Networks_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO-27001-2022|A.5.28,ISO-27001-2022|A.8.15,ITSG-33|AU-3,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-228643r960900_rule,STIG-ID|PANW-NM-000029,STIG-Legacy|SV-77203,STIG-Legacy|V-62713,SWIFT-CSCv1|6.4,Vuln-ID|V-228643"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_PAN_Y24M10_STIG.zip"
      show_output : YES
    </report>
  </then>
</if>

<custom_item>
  type             : AUDIT_XML
  description      : "PANW-NM-000046 - The Palo Alto Networks security platform must be configured to prohibit the use of all unnecessary and/or nonsecure functions, ports, protocols, and/or services, as defined in the PPSM CAL and vulnerability assessments."
  info             : "In order to prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable unused or unnecessary physical and logical ports/protocols on information systems.

Network devices are capable of providing a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., email and web services); however, doing so increases risk over limiting the services provided by any one component.

To support the requirements and principles of least functionality, the network device must support the organizational requirements providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality of life issues.

The Palo Alto Networks security platform uses a hardened operating system in which unnecessary services are not present.  The device has a DNS, NTP, update, and e-mail client installed.  Note that these are client applications and not servers; additionally, each has a valid purpose.  However, local policy may dictate that the update service, e-mail client, and statistics (reporting) service capabilities not be used. DNS can be either 'Server' or 'Proxy'; both are allowed unless local policy declares otherwise. NTP and SNMP are necessary functions.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution         : "Go to Device >> Setup >> Services
In the 'Services' window, select the 'Edit' icon (the gear symbol in the upper-right corner of the pane).
Note: DNS can be either 'Server' or 'Proxy'; both are allowed unless local policy declares otherwise.
Note: The Palo Alto Networks security platform cannot be a DNS server, only a client or proxy.

NTP is a necessary service.
Note: The Palo Alto Networks security platform cannot be an NTP server, only a client.

Go to Device >> Setup >> Management
In the 'Management Interface Settings' window, select the 'Edit' icon (the gear symbol in the upper-right corner of the pane).
In the 'Management Interface Settings' window, select HTTP OCSP, HTTPS, SSH,  SNMP, User-ID, User-ID Syslog Listener-SSL, User-ID Syslog Listener-UDP if these protocols will be used.
Select 'OK'.
Note: SNMP Versions 1 and 2 are not considered secure; use SNMP Version 3.

Device >> Setup >> Operations tab>> Miscellaneous
Select SNMP Setup.
In the 'SNMP Setup' window, select V3.
Select 'OK'.
Commit changes by selecting 'Commit' in the upper-right corner of the screen.
Select 'OK' when the confirmation dialog appears."
  reference        : "800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.06b.,800-53|CM-7b.,800-53r5|CM-7b.,CAT|II,CCI|CCI-000382,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|PR.PS-01,DISA_Benchmark|Palo_Alto_Networks_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,Rule-ID|SV-228645r960966_rule,STIG-ID|PANW-NM-000046,STIG-Legacy|SV-77207,STIG-Legacy|V-62717,SWIFT-CSCv1|2.3,Vuln-ID|V-228645"
  see_also         : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_PAN_Y24M10_STIG.zip"
  api_request_type : "op"
  request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
  xsl_stmt         : "<xsl:template match=\"/\">"
  xsl_stmt         : "<xsl:text>The following services are enabled:</xsl:text>"
  xsl_stmt         : "<xsl:text xml:space=\"preserve\">&#10;</xsl:text>"
  xsl_stmt         : "<xsl:choose>"
  xsl_stmt         : "<xsl:when test=\"//disable-telnet = 'no'\">"
  xsl_stmt         : "<xsl:text>Telnet</xsl:text>"
  xsl_stmt         : "<xsl:text xml:space=\"preserve\">&#10;</xsl:text>"
  xsl_stmt         : "</xsl:when>"
  xsl_stmt         : "</xsl:choose>"
  xsl_stmt         : "<xsl:choose>"
  xsl_stmt         : "<xsl:when test=\"//disable-http = 'no'\">"
  xsl_stmt         : "<xsl:text>HTTP</xsl:text>"
  xsl_stmt         : "<xsl:text xml:space=\"preserve\">&#10;</xsl:text>"
  xsl_stmt         : "</xsl:when>"
  xsl_stmt         : "</xsl:choose>"
  xsl_stmt         : "<xsl:choose>"
  xsl_stmt         : "<xsl:when test=\"//disable-snmp = 'no'\">"
  xsl_stmt         : "<xsl:text>SNMP</xsl:text>"
  xsl_stmt         : "<xsl:text xml:space=\"preserve\">&#10;</xsl:text>"
  xsl_stmt         : "</xsl:when>"
  xsl_stmt         : "</xsl:choose>"
  xsl_stmt         : "<xsl:choose>"
  xsl_stmt         : "<xsl:when test=\"//disable-userid-service = 'no'\">"
  xsl_stmt         : "<xsl:text>UserID</xsl:text>"
  xsl_stmt         : "<xsl:text xml:space=\"preserve\">&#10;</xsl:text>"
  xsl_stmt         : "</xsl:when>"
  xsl_stmt         : "</xsl:choose>"
  xsl_stmt         : "<xsl:choose>"
  xsl_stmt         : "<xsl:when test=\"//disable-userid-syslog-listener-ssl = 'no'\">"
  xsl_stmt         : "<xsl:text>User-ID Syslog Listener-SSL</xsl:text>"
  xsl_stmt         : "<xsl:text xml:space=\"preserve\">&#10;</xsl:text>"
  xsl_stmt         : "</xsl:when>"
  xsl_stmt         : "</xsl:choose>"
  xsl_stmt         : "<xsl:choose>"
  xsl_stmt         : "<xsl:when test=\"//disable-userid-syslog-listener-udp = 'no'\">"
  xsl_stmt         : "<xsl:text>User-ID Syslog Listener-UDP</xsl:text>"
  xsl_stmt         : "<xsl:text xml:space=\"preserve\">&#10;</xsl:text>"
  xsl_stmt         : "</xsl:when>"
  xsl_stmt         : "</xsl:choose>"
  xsl_stmt         : "<xsl:choose>"
  xsl_stmt         : "<xsl:when test=\"//disable-http-ocsp = 'no'\">"
  xsl_stmt         : "<xsl:text>HTTP OCSP</xsl:text>"
  xsl_stmt         : "<xsl:text xml:space=\"preserve\">&#10;</xsl:text>"
  xsl_stmt         : "</xsl:when>"
  xsl_stmt         : "</xsl:choose>"
  regex            : ""
  severity         : MEDIUM
</custom_item>

<custom_item>
  type             : AUDIT_XML
  description      : "PANW-NM-000047 - The Palo Alto Networks security platform must uniquely identify and authenticate organizational administrators (or processes acting on behalf of organizational administrators)."
  info             : "To assure accountability and prevent unauthenticated access, organizational administrators must be uniquely identified and authenticated for all network management accesses to prevent potential misuse and compromise of the system.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution         : "Create a separate administrative account for each person who needs access to the administrative or reporting functions of the firewall.
Go to Device >> Administrators
Select 'Add' (in the lower-left corner of the pane).
Complete the required information;
In the 'Name' field, enter the name of the Administrator.
Note: That accounts must identify a single person; the only exception allowed is the emergency administration account.

In the 'Authentication Profile' field, enter the name of the authentication profile that will be used to control that person's authentication process.
For the Role, select either 'Dynamic' or 'Role Based'.
If selecting 'Dynamic', then select the role assigned for this person; Administrators can be assigned one of these built-in roles: Superuser, Superuser (read-only), Device administrator, Device administrator (read-only), Virtual system administrator, and Virtual system administrator (read-only).
If 'Role Based' is selected, then select one of the three pre-configured profiles (auditadmin, cryptoadmin, or securityadmin) or a custom profile.
Select 'OK'.
Commit changes by selecting 'Commit' in the upper-right corner of the screen.  Select 'OK' when the confirmation dialog appears."
  reference        : "800-171|3.4.2,800-171|3.5.1,800-171r3|03.04.02a.,800-171r3|03.05.01a.,800-53|CM-6b.,800-53|IA-2,800-53r5|CM-6b.,800-53r5|IA-2,CAT|II,CCI|CCI-000366,CCI|CCI-000764,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.1.10.6(d),CN-L3|8.5.4.1(a),CSF|PR.AC-1,CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,CSF2.0|PR.PS-01,DISA_Benchmark|Palo_Alto_Networks_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO-27001-2022|A.5.16,ISO-27001-2022|A.8.9,ITSG-33|CM-6b.,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T3.2.1,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-228646r961863_rule,STIG-ID|PANW-NM-000047,STIG-Legacy|SV-77209,STIG-Legacy|V-62719,SWIFT-CSCv1|2.3,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-228646"
  see_also         : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_PAN_Y24M10_STIG.zip"
  api_request_type : "op"
  request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
  xsl_stmt         : "<xsl:template match=\"/\">"
  xsl_stmt         : "<xsl:text>Administrative Users:</xsl:text>"
  xsl_stmt         : "<xsl:text xml:space=\"preserve\">&#10;</xsl:text>"
  xsl_stmt         : "<xsl:for-each select=\"//mgt-config/users/entry\">"
  xsl_stmt         : "<xsl:value-of select=\"@name\"/>"
  xsl_stmt         : "<xsl:text xml:space=\"preserve\">&#10;</xsl:text>"
  xsl_stmt         : "</xsl:for-each>"
  regex            : ""
  severity         : MEDIUM
</custom_item>

<custom_item>
  type             : AUDIT_XML
  description      : "PANW-NM-000048 - The Palo Alto device must be configured with only one local account to be used as the account of last resort in the event the authentication server is unavailable."
  info             : "Authentication for administrative (privileged level) access to the device is required at all times. An account can be created on the device's local database for use when the authentication server is down or connectivity between the device and the authentication server is not operable. This account is referred to as the account of last resort since it is intended to be used as a last resort and when immediate administrative access is absolutely necessary.

The account of last resort logon credentials must be stored in a sealed envelope and kept in a safe. The safe must be periodically audited to verify the envelope remains sealed. The signature of the auditor and the date of the audit should be added to the envelope as a record. Administrators should secure the credentials and disable the root account (if possible) when not needed for system administration functions."
  solution         : "Navigate to Device >> Authentication Profile.
Remove any unauthorized or unnecessary authentication profiles for users other than the account of last resort.
Select 'OK'."
  reference        : "800-171|3.1.1,800-171r3|03.01.01,800-171r3|03.01.01a.,800-53|AC-2a.,800-53|AC-2(7)(a),800-53r5|AC-2(7)(a),CAT|II,CCI|CCI-001358,CCI|CCI-002111,CN-L3|7.1.3.2(d),CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|PR.AA-01,CSF2.0|PR.AA-05,CSF2.0|PR.DS-10,DISA_Benchmark|Palo_Alto_Networks_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.18,ISO-27001-2022|A.8.2,ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2a.,ITSG-33|AC-2(7)(a),NESA|M5.3.1,NESA|T5.2.1,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,PCI-DSSv3.2.1|1.1.5,PCI-DSSv4.0|1.1.2,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,Rule-ID|SV-268323r1018733_rule,STIG-ID|PANW-NM-000048,Vuln-ID|V-268323"
  see_also         : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_PAN_Y24M10_STIG.zip"
  api_request_type : "op"
  request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
  xsl_stmt         : "<xsl:template match=\"/\">"
  xsl_stmt         : "<xsl:choose>"
  xsl_stmt         : "<xsl:when test=\"count(//mgt-config/users/entry) > 1\">"
  xsl_stmt         : "Failed - <xsl:value-of select=\"count(//mgt-config/users/entry)\"/> users configured"
  xsl_stmt         : "</xsl:when>"
  xsl_stmt         : "<xsl:otherwise>"
  xsl_stmt         : "Passed - One user configured"
  xsl_stmt         : "</xsl:otherwise>"
  xsl_stmt         : "</xsl:choose>"
  regex            : "(Passed|Failed)"
  expect           : "Passed"
</custom_item>

<if>
  <condition type:"AND">
    <custom_item>
      type             : AUDIT_XML
      description      : "RADIUS Authentication Server is in use"
      api_request_type : "op"
      request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
      xsl_stmt         : "<xsl:template match=\"/\">"
      xsl_stmt         : "<xsl:choose>"
      xsl_stmt         : "<xsl:when test=\"//server-profile/radius/entry\">"
      xsl_stmt         : "<xsl:text>Radius Authentication is in use</xsl:text>"
      xsl_stmt         : "</xsl:when>"
      xsl_stmt         : "<xsl:otherwise>"
      xsl_stmt         : "<xsl:text>Radius Authentication is not in use</xsl:text>"
      xsl_stmt         : "</xsl:otherwise>"
      xsl_stmt         : "</xsl:choose>"
      regex            : "is not in use"
      not_expect       : "is not in use"
    </custom_item>
  </condition>

  <then>
    <custom_item>
      type             : AUDIT_XML
      description      : "PANW-NM-000051 - The Palo Alto Networks security platform must implement replay-resistant authentication mechanisms for network access to privileged accounts."
      info             : "A replay attack may enable an unauthorized user to gain access to the application. Authentication sessions between the authenticator and the application validating the user credentials must not be vulnerable to a replay attack.  An authentication process resists replay attacks if it is impractical to achieve a successful authentication by recording and replaying a previous authentication message.

Techniques used to address this include protocols using nonces (e.g., numbers generated for a specific one-time use) or challenges (e.g., TLS, WS_Security). Additional techniques include time-synchronous or challenge-response one-time authenticators.  Of the three authentication protocols on the Palo Alto Networks security platform, only Kerberos is inherently replay-resistant.  If LDAP is selected, TLS must also be used.  If RADIUS is used, the device must be operating in FIPS mode.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution         : "To configure the Palo Alto Networks security platform to use an LDAP server with SSL/TLS.
Go to Device >> Server-Profiles >> LDAP
Select 'Add' (lower left of window).
Populate the required fields.
Enter the name of the profile in the 'Name' field.

In the server box:
Enter the name of the server in the 'Name' field.
Enter the IP Address of the server.
Enter the Port number the firewall should use to connect to the LDAP server (default=389 for LDAP; 636 for LDAP over SSL).
Enter the LDAP Domain name to prepend to all objects learned from the server. The value entered here depends on the specific deployment. If using Active Directory, enter the NetBIOS domain name, not a FQDN (for example, enter acme, not acme.com). Note that if collecting data from multiple domains, it is necessary to create separate server profiles. If using a global catalog server, leave this field blank.
Select the Type of LDAP server connecting to. The correct LDAP attributes in the group mapping settings will automatically be populated based on the selection.
In the Base field, select the DN that corresponds to the point in the LDAP tree where the firewall is to begin its search for user and group information.
Select (check) the SSL checkbox.
Select 'OK'.
Commit changes by selecting 'Commit' in the upper-right corner of the screen.  Select 'OK' when the confirmation dialog appears."
      reference        : "800-171|3.5.4,800-171r3|03.05.04,800-53|IA-2(8),800-53r5|IA-2(8),CAT|II,CCI|CCI-001941,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|Palo_Alto_Networks_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO-27001-2022|A.5.16,ITSG-33|IA-2(8),NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM18,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-228647r960993_rule,STIG-ID|PANW-NM-000051,STIG-Legacy|SV-77211,STIG-Legacy|V-62721,SWIFT-CSCv1|4.2,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-228647"
      see_also         : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_PAN_Y24M10_STIG.zip"
      api_request_type : "op"
      request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
      xsl_stmt         : "<xsl:template match=\"/\">"
      xsl_stmt         : "<xsl:text>Radius profile: </xsl:text><xsl:value-of select=\"//server-profile/radius/entry/@name\"/> | <xsl:text>Server Name: </xsl:text><xsl:value-of select=\"//server-profile/radius/entry/server/entry/@name\"/> | <xsl:text>IP: </xsl:text><xsl:value-of select=\"//server-profile/radius/entry/server/entry/ip-address\"/>"
      xsl_stmt         : "<xsl:text xml:space=\"preserve\">&#10;</xsl:text>"
      xsl_stmt         : "<xsl:text>FIPS mode must be checked</xsl:text>"
      regex            : ""
      severity         : MEDIUM
    </custom_item>
  </then>

  <else>
    <custom_item>
      type             : AUDIT_XML
      description      : "PANW-NM-000051 - The Palo Alto Networks security platform must implement replay-resistant authentication mechanisms for network access to privileged accounts."
      info             : "A replay attack may enable an unauthorized user to gain access to the application. Authentication sessions between the authenticator and the application validating the user credentials must not be vulnerable to a replay attack.  An authentication process resists replay attacks if it is impractical to achieve a successful authentication by recording and replaying a previous authentication message.

Techniques used to address this include protocols using nonces (e.g., numbers generated for a specific one-time use) or challenges (e.g., TLS, WS_Security). Additional techniques include time-synchronous or challenge-response one-time authenticators.  Of the three authentication protocols on the Palo Alto Networks security platform, only Kerberos is inherently replay-resistant.  If LDAP is selected, TLS must also be used.  If RADIUS is used, the device must be operating in FIPS mode."
      solution         : "To configure the Palo Alto Networks security platform to use an LDAP server with SSL/TLS.
Go to Device >> Server-Profiles >> LDAP
Select 'Add' (lower left of window).
Populate the required fields.
Enter the name of the profile in the 'Name' field.

In the server box:
Enter the name of the server in the 'Name' field.
Enter the IP Address of the server.
Enter the Port number the firewall should use to connect to the LDAP server (default=389 for LDAP; 636 for LDAP over SSL).
Enter the LDAP Domain name to prepend to all objects learned from the server. The value entered here depends on the specific deployment. If using Active Directory, enter the NetBIOS domain name, not a FQDN (for example, enter acme, not acme.com). Note that if collecting data from multiple domains, it is necessary to create separate server profiles. If using a global catalog server, leave this field blank.
Select the Type of LDAP server connecting to. The correct LDAP attributes in the group mapping settings will automatically be populated based on the selection.
In the Base field, select the DN that corresponds to the point in the LDAP tree where the firewall is to begin its search for user and group information.
Select (check) the SSL checkbox.
Select 'OK'.
Commit changes by selecting 'Commit' in the upper-right corner of the screen.  Select 'OK' when the confirmation dialog appears."
      reference        : "800-171|3.5.4,800-171r3|03.05.04,800-53|IA-2(8),800-53r5|IA-2(8),CAT|II,CCI|CCI-001941,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|Palo_Alto_Networks_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO-27001-2022|A.5.16,ITSG-33|IA-2(8),NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM18,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-228647r960993_rule,STIG-ID|PANW-NM-000051,STIG-Legacy|SV-77211,STIG-Legacy|V-62721,SWIFT-CSCv1|4.2,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-228647"
      see_also         : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_PAN_Y24M10_STIG.zip"
      api_request_type : "op"
      request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
      xsl_stmt         : "<xsl:template match=\"/\">"
      xsl_stmt         : "<xsl:text>Administrative Users:</xsl:text>"
      xsl_stmt         : "<xsl:text xml:space=\"preserve\">&#10;</xsl:text>"
      xsl_stmt         : "<xsl:choose>"
      xsl_stmt         : "<xsl:when test=\"//server-profile/kerberos/entry\">"
      xsl_stmt         : "<xsl:text>Passed - Kerberos is in use</xsl:text>"
      xsl_stmt         : "</xsl:when>"
      xsl_stmt         : "<xsl:otherwise>"
      xsl_stmt         : "<xsl:choose>"
      xsl_stmt         : "<xsl:when test=\"//server-profile/ldap/entry\">"
      xsl_stmt         : "<xsl:choose>"
      xsl_stmt         : "<xsl:when test=\"//server-profile/ldap/entry/ssl = 'yes'\">"
      xsl_stmt         : "<xsl:text>Passed - LDAP is in use and SSL is used</xsl:text>"
      xsl_stmt         : "</xsl:when>"
      xsl_stmt         : "<xsl:otherwise>"
      xsl_stmt         : "<xsl:text>Failed - LDAP is in use and SSL is not used</xsl:text>"
      xsl_stmt         : "</xsl:otherwise>"
      xsl_stmt         : "</xsl:choose>"
      xsl_stmt         : "</xsl:when>"
      xsl_stmt         : "</xsl:choose>"
      xsl_stmt         : "</xsl:otherwise>"
      xsl_stmt         : "</xsl:choose>"
      regex            : "(Failed|Passed)"
      not_expect       : "Failed"
    </custom_item>
  </else>
</if>

<custom_item>
  type             : AUDIT_XML
  description      : "PANW-NM-000053 - If multifactor authentication is not available and passwords must be used, the Palo Alto Networks security platform must enforce a minimum 15-character password length."
  info             : "Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. Password length is one factor of several that helps to determine strength and how long it takes to crack a password.

The shorter the password, the lower the number of possible combinations that needs to be tested before the password is compromised. Use of more characters in a password helps to exponentially increase the time and/or resources required to compromise the password."
  solution         : "Go to Device >> Setup >> Management.
In the 'Minimum Password Complexity' window, select the 'Edit' icon (the gear symbol in the upper-right corner of the pane).
In the 'Minimum Length' field, enter '15'.
Check the 'Enabled' box, then select 'OK'.
Commit changes by selecting 'Commit' in the upper-right corner of the screen.
Select 'OK' when the confirmation dialog appears."
  reference        : "800-171|3.5.7,800-171r3|03.05.07a.,800-53|IA-5(1)(a),800-53r5|IA-5(1)(h),CAT|II,CCI|CCI-000205,CCI|CCI-004066,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|Palo_Alto_Networks_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.17,ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-228648r1018774_rule,STIG-ID|PANW-NM-000053,STIG-Legacy|SV-77213,STIG-Legacy|V-62723,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-228648"
  see_also         : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_PAN_Y24M10_STIG.zip"
  api_request_type : "op"
  request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
  xsl_stmt         : "<xsl:template match=\"/\">"
  xsl_stmt         : "<xsl:choose>"
  xsl_stmt         : "<xsl:when test=\"//password-complexity/enabled='no'\">"
  xsl_stmt         : "<xsl:text>Failed - Minimum Password Complexity is disabled</xsl:text>"
  xsl_stmt         : "</xsl:when>"
  xsl_stmt         : "<xsl:otherwise>"
  xsl_stmt         : "<xsl:choose>"
  xsl_stmt         : "<xsl:when test=\"not(//password-complexity/minimum-length) or //password-complexity/minimum-length &lt; 15\">"
  xsl_stmt         : "<xsl:text>Failed - Password minimum length less than 15</xsl:text>"
  xsl_stmt         : "</xsl:when>"
  xsl_stmt         : "<xsl:otherwise>"
  xsl_stmt         : "<xsl:text>Passed - Password minimum length is 15 or greater</xsl:text>"
  xsl_stmt         : "</xsl:otherwise>"
  xsl_stmt         : "</xsl:choose>"
  xsl_stmt         : "</xsl:otherwise>"
  xsl_stmt         : "</xsl:choose>"
  regex            : "(Failed|Passed)"
  not_expect       : "Failed"
</custom_item>

<custom_item>
  type             : AUDIT_XML
  description      : "PANW-NM-000055 - If multifactor authentication is not available and passwords must be used, the Palo Alto Networks security platform must enforce password complexity by requiring that at least one uppercase character be used."
  info             : "Use of a complex passwords helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.

Password complexity is one factor of several that determines how long it takes to crack a password. The more complex the password is, the greater the number of possible combinations that needs to be tested before the password is compromised."
  solution         : "Go to Device >> Setup >> Management.
In the 'Minimum Password Complexity' window, select the 'Edit' icon (the gear symbol in the upper-right corner of the pane).
In the 'Minimum Uppercase Letters' field, enter '1'.
Check the 'Enabled' box, then select 'OK'.
Commit changes by selecting 'Commit' in the upper-right corner of the screen.
Select 'OK' when the confirmation dialog appears."
  reference        : "800-171|3.5.7,800-171r3|03.05.07a.,800-53|IA-5(1)(a),800-53r5|IA-5(1)(h),CAT|II,CCI|CCI-000192,CCI|CCI-004066,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|Palo_Alto_Networks_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.17,ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-228650r1018775_rule,STIG-ID|PANW-NM-000055,STIG-Legacy|SV-77217,STIG-Legacy|V-62727,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-228650"
  see_also         : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_PAN_Y24M10_STIG.zip"
  api_request_type : "op"
  request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
  xsl_stmt         : "<xsl:template match=\"/\">"
  xsl_stmt         : "<xsl:choose>"
  xsl_stmt         : "<xsl:when test=\"//password-complexity/enabled='no'\">"
  xsl_stmt         : "<xsl:text>Failed - Minimum Password Complexity is disabled</xsl:text>"
  xsl_stmt         : "</xsl:when>"
  xsl_stmt         : "<xsl:otherwise>"
  xsl_stmt         : "<xsl:choose>"
  xsl_stmt         : "<xsl:when test=\"not(//password-complexity/minimum-uppercase-letters) or //password-complexity/minimum-uppercase-letters &lt; 1\">"
  xsl_stmt         : "<xsl:text>Failed - Minimum Uppercase Letters is less than 1</xsl:text>"
  xsl_stmt         : "</xsl:when>"
  xsl_stmt         : "<xsl:otherwise>"
  xsl_stmt         : "<xsl:text>Passed - Minimum Uppercase Letters is 1 or greater</xsl:text>"
  xsl_stmt         : "</xsl:otherwise>"
  xsl_stmt         : "</xsl:choose>"
  xsl_stmt         : "</xsl:otherwise>"
  xsl_stmt         : "</xsl:choose>"
  regex            : "(Failed|Passed)"
  not_expect       : "Failed"
</custom_item>

<custom_item>
  type             : AUDIT_XML
  description      : "PANW-NM-000056 - If multifactor authentication is not available and passwords must be used, the Palo Alto Networks security platform must enforce password complexity by requiring that at least one lowercase character be used."
  info             : "Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.

Password complexity is one factor of several that determines how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that needs to be tested before the password is compromised."
  solution         : "Go to Device >> Setup >> Management.
In the 'Minimum Password Complexity' window, select the 'Edit' icon (the gear symbol in the upper-right corner of the pane).
In the 'Minimum Lowercase Letters' field, enter '1'.
Check the 'Enabled' box, then select 'OK'.
Commit changes by selecting 'Commit' in the upper-right corner of the screen.
Select 'OK' when the confirmation dialog appears."
  reference        : "800-171|3.5.7,800-171r3|03.05.07a.,800-53|IA-5(1)(a),800-53r5|IA-5(1)(h),CAT|II,CCI|CCI-000193,CCI|CCI-004066,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|Palo_Alto_Networks_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.17,ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-228651r1018776_rule,STIG-ID|PANW-NM-000056,STIG-Legacy|SV-77219,STIG-Legacy|V-62729,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-228651"
  see_also         : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_PAN_Y24M10_STIG.zip"
  api_request_type : "op"
  request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
  xsl_stmt         : "<xsl:template match=\"/\">"
  xsl_stmt         : "<xsl:choose>"
  xsl_stmt         : "<xsl:when test=\"//password-complexity/enabled='no'\">"
  xsl_stmt         : "<xsl:text>Failed - Minimum Password Complexity is disabled</xsl:text>"
  xsl_stmt         : "</xsl:when>"
  xsl_stmt         : "<xsl:otherwise>"
  xsl_stmt         : "<xsl:choose>"
  xsl_stmt         : "<xsl:when test=\"not(//password-complexity/minimum-lowercase-letters) or //password-complexity/minimum-lowercase-letters &lt; 1\">"
  xsl_stmt         : "<xsl:text>Failed - Minimum Lowercase Letters is less than 1</xsl:text>"
  xsl_stmt         : "</xsl:when>"
  xsl_stmt         : "<xsl:otherwise>"
  xsl_stmt         : "<xsl:text>Passed - Minimum Lowercase Letters is 1 or greater</xsl:text>"
  xsl_stmt         : "</xsl:otherwise>"
  xsl_stmt         : "</xsl:choose>"
  xsl_stmt         : "</xsl:otherwise>"
  xsl_stmt         : "</xsl:choose>"
  regex            : "(Failed|Passed)"
  not_expect       : "Failed"
</custom_item>

<custom_item>
  type             : AUDIT_XML
  description      : "PANW-NM-000057 - If multifactor authentication is not available and passwords must be used, the Palo Alto Networks security platform must enforce password complexity by requiring that at least one numeric character be used."
  info             : "Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.

Password complexity is one factor of several that determines how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that needs to be tested before the password is compromised."
  solution         : "Go to Device >> Setup >> Management.
In the 'Minimum Password Complexity' window, select the 'Edit' icon (the gear symbol in the upper-right corner of the pane).
In the 'Minimum Numeric Letters' field, enter '1'.
Check the 'Enabled' box, then select 'OK'.
Commit changes by selecting 'Commit' in the upper-right corner of the screen.
Select 'OK' when the confirmation dialog appears."
  reference        : "800-171|3.5.7,800-171r3|03.05.07a.,800-53|IA-5(1)(a),800-53r5|IA-5(1)(h),CAT|II,CCI|CCI-000194,CCI|CCI-004066,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|Palo_Alto_Networks_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.17,ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-228652r1018777_rule,STIG-ID|PANW-NM-000057,STIG-Legacy|SV-77221,STIG-Legacy|V-62731,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-228652"
  see_also         : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_PAN_Y24M10_STIG.zip"
  api_request_type : "op"
  request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
  xsl_stmt         : "<xsl:template match=\"/\">"
  xsl_stmt         : "<xsl:choose>"
  xsl_stmt         : "<xsl:when test=\"//password-complexity/enabled='no'\">"
  xsl_stmt         : "<xsl:text>Failed - Minimum Password Complexity is disabled</xsl:text>"
  xsl_stmt         : "</xsl:when>"
  xsl_stmt         : "<xsl:otherwise>"
  xsl_stmt         : "<xsl:choose>"
  xsl_stmt         : "<xsl:when test=\"not(//password-complexity/minimum-numeric-letters) or //password-complexity/minimum-numeric-letters &lt; 1\">"
  xsl_stmt         : "<xsl:text>Failed - Minimum Numeric Letters is less than 1</xsl:text>"
  xsl_stmt         : "</xsl:when>"
  xsl_stmt         : "<xsl:otherwise>"
  xsl_stmt         : "<xsl:text>Passed - Minimum Numeric Letters is 1 or greater</xsl:text>"
  xsl_stmt         : "</xsl:otherwise>"
  xsl_stmt         : "</xsl:choose>"
  xsl_stmt         : "</xsl:otherwise>"
  xsl_stmt         : "</xsl:choose>"
  regex            : "(Failed|Passed)"
  not_expect       : "Failed"
</custom_item>

<custom_item>
  type             : AUDIT_XML
  description      : "PANW-NM-000058 - If multifactor authentication is not available and passwords must be used, the Palo Alto Networks security platform must enforce password complexity by requiring that at least one special character be used."
  info             : "Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.

Password complexity is one factor of several that determines how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that needs to be tested before the password is compromised."
  solution         : "Go to Device >> Setup >> Management.
In the 'Minimum Password Complexity' window, select the 'Edit' icon (the gear symbol in the upper-right corner of the pane).
In the 'Minimum Special Letters' field, enter '1'.
Check the 'Enabled box', then select 'OK'.
Commit changes by selecting 'Commit' in the upper-right corner of the screen.
Select 'OK' when the confirmation dialog appears."
  reference        : "800-171|3.5.7,800-171r3|03.05.07a.,800-53|IA-5(1)(a),800-53r5|IA-5(1)(h),CAT|II,CCI|CCI-001619,CCI|CCI-004066,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|Palo_Alto_Networks_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.17,ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-228653r1018778_rule,STIG-ID|PANW-NM-000058,STIG-Legacy|SV-77223,STIG-Legacy|V-62733,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-228653"
  see_also         : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_PAN_Y24M10_STIG.zip"
  api_request_type : "op"
  request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
  xsl_stmt         : "<xsl:template match=\"/\">"
  xsl_stmt         : "<xsl:choose>"
  xsl_stmt         : "<xsl:when test=\"//password-complexity/enabled='no'\">"
  xsl_stmt         : "<xsl:text>Failed - Minimum Password Complexity is disabled</xsl:text>"
  xsl_stmt         : "</xsl:when>"
  xsl_stmt         : "<xsl:otherwise>"
  xsl_stmt         : "<xsl:choose>"
  xsl_stmt         : "<xsl:when test=\"not(//password-complexity/minimum-special-characters) or //password-complexity/minimum-special-characters &lt; 1\">"
  xsl_stmt         : "<xsl:text>Failed - Minimum Special Characters is less than 1</xsl:text>"
  xsl_stmt         : "</xsl:when>"
  xsl_stmt         : "<xsl:otherwise>"
  xsl_stmt         : "<xsl:text>Passed - Minimum Special Characters is 1 or greater</xsl:text>"
  xsl_stmt         : "</xsl:otherwise>"
  xsl_stmt         : "</xsl:choose>"
  xsl_stmt         : "</xsl:otherwise>"
  xsl_stmt         : "</xsl:choose>"
  regex            : "(Failed|Passed)"
  not_expect       : "Failed"
</custom_item>

<custom_item>
  type             : AUDIT_XML
  description      : "PANW-NM-000059 - If multifactor authentication is not available and passwords must be used, the Palo Alto Networks security platform must require that when a password is changed, the characters are changed in at least 8 of the positions within the password."
  info             : "If the application allows the user to consecutively reuse extensive portions of passwords, this increases the chances of password compromise by increasing the window of opportunity for attempts at guessing and brute-force attacks.

The number of changed characters refers to the number of changes required with respect to the total number of positions in the current password. In other words, characters may be the same within the two passwords; however, the positions of the like characters must be different."
  solution         : "Go to Device >> Setup >> Management.
In the 'Minimum Password Complexity' window, select the 'Edit' icon (the gear symbol in the upper-right corner of the pane).
In the 'New Password Differs by Characters' field, enter '8'.
Check the 'Enabled box', then select 'OK'.
Commit changes by selecting 'Commit' in the upper-right corner of the screen.
Select 'OK' when the confirmation dialog appears."
  reference        : "800-171|3.5.7,800-171r3|03.05.07b.,800-53|IA-5(1)(b),800-53r5|IA-5(1)(h),CAT|II,CCI|CCI-000195,CCI|CCI-004066,CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|Palo_Alto_Networks_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.17,ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(b),NESA|T5.2.3,NIAv2|AM22d,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-228654r1018779_rule,STIG-ID|PANW-NM-000059,STIG-Legacy|SV-77225,STIG-Legacy|V-62735,SWIFT-CSCv1|4.1,Vuln-ID|V-228654"
  see_also         : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_PAN_Y24M10_STIG.zip"
  api_request_type : "op"
  request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
  xsl_stmt         : "<xsl:template match=\"/\">"
  xsl_stmt         : "<xsl:choose>"
  xsl_stmt         : "<xsl:when test=\"//password-complexity/enabled='no'\">"
  xsl_stmt         : "<xsl:text>Failed - Minimum Password Complexity is disabled</xsl:text>"
  xsl_stmt         : "</xsl:when>"
  xsl_stmt         : "<xsl:otherwise>"
  xsl_stmt         : "<xsl:choose>"
  xsl_stmt         : "<xsl:when test=\"not(//password-complexity/new-password-differs-by-characters) or //password-complexity/new-password-differs-by-characters &lt; 8\">"
  xsl_stmt         : "<xsl:text>Failed - New Password Differs by Characters is less than 8</xsl:text>"
  xsl_stmt         : "</xsl:when>"
  xsl_stmt         : "<xsl:otherwise>"
  xsl_stmt         : "<xsl:text>Passed - New Password Differs by Characters is 8 or greater</xsl:text>"
  xsl_stmt         : "</xsl:otherwise>"
  xsl_stmt         : "</xsl:choose>"
  xsl_stmt         : "</xsl:otherwise>"
  xsl_stmt         : "</xsl:choose>"
  regex            : "(Failed|Passed)"
  not_expect       : "Failed"
</custom_item>

<custom_item>
  type             : AUDIT_XML
  description      : "PANW-NM-000061 - The Palo Alto Networks security platform must prohibit the use of unencrypted protocols for network access to privileged accounts."
  info             : "Passwords need to be protected at all times, and encryption is the standard method for protecting passwords. If passwords are not encrypted, they can be plainly read (i.e., clear text) and easily compromised.

Network devices can accomplish this by making direct function calls to encryption modules or by leveraging operating system encryption capabilities."
  solution         : "Go to Device >> Setup >> Management
In the 'Management Interface Settings' window, select the 'Edit' icon (the gear symbol in the upper-right corner of the pane).  In the 'Management Interface Settings' window, make sure that HTTP and Telnet are not checked (enabled).
If they are not checked, select either 'OK' or 'Cancel'.
If either one is checked, select the check box to disable it, then select 'OK'.
If any changes were made, commit changes by selecting 'Commit' in the upper-right corner of the screen.
Select 'OK' when the confirmation dialog appears."
  reference        : "800-171|3.5.10,800-171r3|03.05.07c.,800-53|IA-5(1)(c),800-53r5|IA-5(1)(c),CAT|II,CCI|CCI-000197,CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|Palo_Alto_Networks_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.17,ITSG-33|IA-5(1)(c),NESA|T5.2.3,NIAv2|CY6,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-228655r961029_rule,STIG-ID|PANW-NM-000061,STIG-Legacy|SV-77227,STIG-Legacy|V-62737,SWIFT-CSCv1|4.1,TBA-FIISB|26.1,Vuln-ID|V-228655"
  see_also         : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_PAN_Y24M10_STIG.zip"
  api_request_type : "op"
  request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
  xsl_stmt         : "<xsl:template match=\"/\">"
  xsl_stmt         : "<xsl:choose>"
  xsl_stmt         : "<xsl:when test=\"//disable-http='yes' and //disable-telnet='yes'\">"
  xsl_stmt         : "<xsl:text>Passed</xsl:text>"
  xsl_stmt         : "</xsl:when>"
  xsl_stmt         : "<xsl:otherwise>"
  xsl_stmt         : "<xsl:choose>"
  xsl_stmt         : "<xsl:when test=\"//disable-telnet='no'\">"
  xsl_stmt         : "<xsl:text>Failed - Telnet is enabled</xsl:text>"
  xsl_stmt         : "<xsl:text xml:space=\"preserve\">&#10;</xsl:text>"
  xsl_stmt         : "</xsl:when>"
  xsl_stmt         : "</xsl:choose>"
  xsl_stmt         : "<xsl:choose>"
  xsl_stmt         : "<xsl:when test=\"//disable-http='no'\">"
  xsl_stmt         : "<xsl:text>Failed - HTTP is enabled</xsl:text>"
  xsl_stmt         : "</xsl:when>"
  xsl_stmt         : "</xsl:choose>"
  xsl_stmt         : "</xsl:otherwise>"
  xsl_stmt         : "</xsl:choose>"
  regex            : "(Failed|Passed)"
  not_expect       : "Failed"
</custom_item>

<custom_item>
  type             : AUDIT_XML
  description      : "PANW-NM-000069 - The Palo Alto Networks security platform must terminate management sessions after 10 minutes of inactivity except to fulfill documented and validated mission requirements."
  info             : "Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session will also free up resources committed by the managed network element.

Terminating network connections associated with communications sessions includes, for example, de-allocating associated TCP/IP address/port pairs at the operating system level, or de-allocating networking assignments at the application level if multiple application sessions are using a single, operating system-level network connection. This does not mean that the device terminates all sessions or network access; it only ends the inactive session and releases the resources associated with that session.

Device management sessions are normally ended by the Administrator when he or she has completed the management activity.  The session termination takes place from the web client by selecting 'Logout' (located at the bottom-left of the GUI window) or using the command line commands 'exit' or 'quit' at Operational mode."
  solution         : "Go to Device >> Setup >> Management.
In the 'Authentication Settings' pane, select the 'Edit' icon (the gear symbol in the upper-right corner of the pane).
In the 'Idle Timeout (min)' field, enter '10', then select 'OK'.
Commit changes by selecting 'Commit' in the upper-right corner of the screen.
Select 'OK' when the confirmation dialog appears."
  reference        : "800-171|3.13.9,800-171r3|03.13.09,800-53|SC-10,800-53r5|SC-10,CAT|I,CCI|CCI-001133,DISA_Benchmark|Palo_Alto_Networks_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.20,ITSG-33|SC-10,ITSG-33|SC-10a.,NESA|T2.3.8,NESA|T4.5.1,NESA|T5.5.1,Rule-ID|SV-228658r961068_rule,STIG-ID|PANW-NM-000069,STIG-Legacy|SV-77233,STIG-Legacy|V-62743,SWIFT-CSCv1|2.6,Vuln-ID|V-228658"
  see_also         : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_PAN_Y24M10_STIG.zip"
  api_request_type : "op"
  request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
  xsl_stmt         : "<xsl:template match=\"/\">"
  xsl_stmt         : "<xsl:choose>"
  xsl_stmt         : "<xsl:when test=\"not(//setting/management/idle-timeout) or //setting/management/idle-timeout &gt; 10\">"
  xsl_stmt         : "<xsl:text>Failed - Idle Timeout (min) is not 10 or less</xsl:text>"
  xsl_stmt         : "</xsl:when>"
  xsl_stmt         : "<xsl:otherwise>"
  xsl_stmt         : "<xsl:text>Passed - Idle Timeout (min) is 10 or less</xsl:text>"
  xsl_stmt         : "</xsl:otherwise>"
  xsl_stmt         : "</xsl:choose>"
  regex            : "(Failed|Passed)"
  not_expect       : "Failed"
</custom_item>

<custom_item>
  type             : AUDIT_XML
  description      : "PANW-NM-000075 - Administrators in the role of Security Administrator,  Cryptographic Administrator, or Audit Administrator must not also have the role of Audit Administrator."
  info             : "The Palo Alto Networks security platform has both pre-configured and configurable Administrator roles. Administrator roles determine the functions that the administrator is permitted to perform after logging in. Roles can be assigned directly to an administrator account, or define role profiles, which specify detailed privileges, and assign those to administrator accounts.

There are three preconfigured roles designed to comply with Common Criteria requirements - Security Administrator, Audit Administrator, and Cryptographic Administrator. Of the three, only the Audit Administrator can delete audit records.  The Palo Alto Networks security platform can use both pre-configured and configurable Administrator roles.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution         : "Do not assign or configure more than one account to the same Administrator. Also, neither the Security Administrator nor the Cryptographic Administrator can be have the role of Audit Administrator.

Note that the system allows each account to have only one role assigned. However, individuals, either accidentally or intentionally, may have more than one account."
  reference        : "800-171|3.4.2,800-171r3|03.04.02a.,800-53|CM-6b.,800-53|SI-11b.,800-53r5|CM-6b.,800-53r5|SI-11b.,CAT|II,CCI|CCI-000366,CCI|CCI-001314,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Palo_Alto_Networks_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6b.,ITSG-33|SI-11c.,NESA|T3.2.1,Rule-ID|SV-228659r961863_rule,STIG-ID|PANW-NM-000075,STIG-Legacy|SV-77235,STIG-Legacy|V-62745,SWIFT-CSCv1|2.3,Vuln-ID|V-228659"
  see_also         : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_PAN_Y24M10_STIG.zip"
  api_request_type : "op"
  request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
  xsl_stmt         : "<xsl:template match=\"/\">"
  xsl_stmt         : "<xsl:text>Users: </xsl:text>"
  xsl_stmt         : "<xsl:text xml:space=\"preserve\">&#10;</xsl:text>"
  xsl_stmt         : "<xsl:for-each select=\"//mgt-config/users/entry\">"
  xsl_stmt         : "<xsl:value-of select=\"@name\"/>"
  xsl_stmt         : "<xsl:text xml:space=\"preserve\">&#10;</xsl:text>"
  xsl_stmt         : "</xsl:for-each>"
  regex            : ""
  severity         : MEDIUM
</custom_item>

<custom_item>
  type             : AUDIT_XML
  description      : "PANW-NM-000092 - The Palo Alto Networks security platform must automatically lock the account until the locked account is released by an administrator when three unsuccessful logon attempts in 15 minutes are exceeded."
  info             : "By limiting the number of failed logon attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute-forcing, is reduced. Limits are imposed by locking the account.

This should not be configured in Device >> Setup >> Management >> Authentication Settings; instead, an authentication profile should be configured with lockout settings of three failed attempts and a lockout time of zero minutes.  The Lockout Time is the number of minutes that a user is locked out if the number of failed attempts is reached (0-60 minutes, default 0). 0 means that the lockout is in effect until it is manually unlocked."
  solution         : "This should not be configured in Device >> Setup >> Management >> Authentication Settings; instead, an authentication profile should be configured with lockout settings of three failed attempts and a lockout time of zero minutes.
Go to Device >> Authentication Profile
Select the configured authentication profile, or select 'Add' (in the bottom-left corner of the pane) to create a new one.
In the 'Authentication Profile' field, enter the name of the authentication profile that will be used to control each person's authentication process.
The 'Lockout Time (min)' field is the lockout duration; this must be set to '0'.  This will keep the lockout in effect until it is manually unlocked.
In the 'Failed Attempts' field, enter '3'.
Select 'OK'.

Apply the authentication profile to the Administrator accounts.
Go to Device >> Administrators
Select each configured account, or select 'Add' (in the bottom-left corner of the pane) to create a new one.
In the 'Authentication Profile' field, enter the configured authentication profile.
Select 'OK'.

This authentication profile should not be applied to the emergency administration account since it has special requirements.
Commit changes by selecting 'Commit' in the upper-right corner of the screen.
Select 'OK' when the confirmation dialog appears."
  reference        : "800-171|3.1.8,800-171|3.4.2,800-171r3|03.01.08b.,800-171r3|03.04.02a.,800-53|AC-7b.,800-53|CM-6b.,800-53r5|AC-7b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CCI|CCI-002238,CN-L3|7.1.2.7(f),CN-L3|7.1.3.1(c),CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.AA-03,CSF2.0|PR.PS-01,DISA_Benchmark|Palo_Alto_Networks_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.5,ISO-27001-2022|A.8.9,ITSG-33|AC-7b.,ITSG-33|CM-6b.,NESA|T3.2.1,NESA|T5.5.1,NIAv2|AM24,PCI-DSSv3.2.1|8.1.7,PCI-DSSv4.0|8.3.4,Rule-ID|SV-228660r961863_rule,STIG-ID|PANW-NM-000092,STIG-Legacy|SV-77237,STIG-Legacy|V-62747,SWIFT-CSCv1|2.3,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2,Vuln-ID|V-228660"
  see_also         : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_PAN_Y24M10_STIG.zip"
  api_request_type : "op"
  request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
  xsl_stmt         : "<xsl:template match=\"/\">"
  xsl_stmt         : "<xsl:for-each select=\"response/result/config/shared/authentication-profile/entry\">"
  xsl_stmt         : "<xsl:text xml:space=\"preserve\">&#10;</xsl:text>"
  xsl_stmt         : "<xsl:choose>"
  xsl_stmt         : "<xsl:when test=\"lockout/lockout-time and not(lockout/lockout-time = 0)\">"
  xsl_stmt         : "<xsl:text>Failed authentication profile: </xsl:text><xsl:value-of select=\"@name\"/> - <xsl:text>Lockout time: </xsl:text><xsl:value-of select=\"lockout/lockout-time\"/>"
  xsl_stmt         : "</xsl:when>"
  xsl_stmt         : "<xsl:otherwise>"
  xsl_stmt         : "<xsl:text>Passed authentication profile: </xsl:text><xsl:value-of select=\"@name\"/> - <xsl:text>Lockout time: </xsl:text><xsl:value-of select=\"lockout/lockout-time\"/>"
  xsl_stmt         : "</xsl:otherwise>"
  xsl_stmt         : "</xsl:choose>"
  xsl_stmt         : "</xsl:for-each>"
  regex            : "(Failed|Passed)"
  not_expect       : "Failed"
</custom_item>

<custom_item>
  type             : AUDIT_XML
  description      : "PANW-NM-000096 - The Palo Alto Networks security platform must generate an immediate alert when allocated audit record storage volume reaches 75% of repository maximum audit record storage capacity."
  info             : "If security personnel are not notified immediately upon storage volume utilization reaching 75%, they are unable to plan for storage capacity expansion. This could lead to the loss of audit information. Note that while the network device must generate the alert, notification may be done by a management server."
  solution         : "Go to Device >> Log Settings >> Alarms
Select the 'Edit' icon (the gear symbol in the upper-right corner of the pane).

In the 'Alarm Settings' window:
Select the 'Enable Alarms' box.
In the 'Traffic Log DB' field, enter '75'.
In the 'Threat Log DB' field, enter '75'.
In the 'Configuration Log DB' field, enter '75'.
In the 'System Log DB' field, enter '75'.
In the 'Alarm DB' field, enter '75'.
In the 'HIP Match Log DB' field, enter '75'.
Select 'OK'.
Commit changes by selecting 'Commit' in the upper-right corner of the screen.  Select 'OK' when the confirmation dialog appears."
  reference        : "800-171|3.3.4,800-171|3.4.2,800-171r3|03.03.04,800-171r3|03.04.02a.,800-53|AU-5(1),800-53|CM-6b.,800-53r5|AU-5(1),800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CCI|CCI-001855,CN-L3|7.1.3.7(e),CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF|PR.PT-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Palo_Alto_Networks_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO-27001-2022|A.8.9,ITSG-33|AU-5(1),ITSG-33|CM-6b.,NESA|T3.2.1,NESA|T3.3.1,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-228661r961863_rule,STIG-ID|PANW-NM-000096,STIG-Legacy|SV-77239,STIG-Legacy|V-62749,SWIFT-CSCv1|2.3,TBA-FIISB|37.3.2,Vuln-ID|V-228661"
  see_also         : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_PAN_Y24M10_STIG.zip"
  api_request_type : "op"
  request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
  xsl_stmt         : "<xsl:template match=\"/\">"
  xsl_stmt         : "<xsl:choose>"
  xsl_stmt         : "<xsl:when test=\"//log-databases-alarm-threshold/traffic &gt; 75 or //log-databases-alarm-threshold/threat &gt; 75 or //log-databases-alarm-threshold/config &gt; 75 or //log-databases-alarm-threshold/system &gt; 75 or //log-databases-alarm-threshold/alarm &gt; 75 or //log-databases-alarm-threshold/hipmatch &gt; 75\">"
  xsl_stmt         : "<xsl:choose>"
  xsl_stmt         : "<xsl:when test=\"//log-databases-alarm-threshold/traffic &gt; 75\">"
  xsl_stmt         : "<xsl:text>Failed - Traffic Log DB is greater than 75</xsl:text>"
  xsl_stmt         : "<xsl:text xml:space=\"preserve\">&#10;</xsl:text>"
  xsl_stmt         : "</xsl:when>"
  xsl_stmt         : "</xsl:choose>"
  xsl_stmt         : "<xsl:choose>"
  xsl_stmt         : "<xsl:when test=\"//log-databases-alarm-threshold/threat &gt; 75\">"
  xsl_stmt         : "<xsl:text>Failed - Threat Log DB is greater than 75</xsl:text>"
  xsl_stmt         : "<xsl:text xml:space=\"preserve\">&#10;</xsl:text>"
  xsl_stmt         : "</xsl:when>"
  xsl_stmt         : "</xsl:choose>"
  xsl_stmt         : "<xsl:choose>"
  xsl_stmt         : "<xsl:when test=\"//log-databases-alarm-threshold/config &gt; 75\">"
  xsl_stmt         : "<xsl:text>Failed - Configuration Log DB is greater than 75</xsl:text>"
  xsl_stmt         : "<xsl:text xml:space=\"preserve\">&#10;</xsl:text>"
  xsl_stmt         : "</xsl:when>"
  xsl_stmt         : "</xsl:choose>"
  xsl_stmt         : "<xsl:choose>"
  xsl_stmt         : "<xsl:when test=\"//log-databases-alarm-threshold/system &gt; 75\">"
  xsl_stmt         : "<xsl:text>Failed - System Log DB is greater than 75</xsl:text>"
  xsl_stmt         : "<xsl:text xml:space=\"preserve\">&#10;</xsl:text>"
  xsl_stmt         : "</xsl:when>"
  xsl_stmt         : "</xsl:choose>"
  xsl_stmt         : "<xsl:choose>"
  xsl_stmt         : "<xsl:when test=\"//log-databases-alarm-threshold/alarm &gt; 75\">"
  xsl_stmt         : "<xsl:text>Failed - Alarm Log DB is greater than 75</xsl:text>"
  xsl_stmt         : "<xsl:text xml:space=\"preserve\">&#10;</xsl:text>"
  xsl_stmt         : "</xsl:when>"
  xsl_stmt         : "</xsl:choose>"
  xsl_stmt         : "<xsl:choose>"
  xsl_stmt         : "<xsl:when test=\"//log-databases-alarm-threshold/hipmatch &gt; 75\">"
  xsl_stmt         : "<xsl:text>Failed - HIP Match Log DB is greater than 75</xsl:text>"
  xsl_stmt         : "<xsl:text xml:space=\"preserve\">&#10;</xsl:text>"
  xsl_stmt         : "</xsl:when>"
  xsl_stmt         : "</xsl:choose>"
  xsl_stmt         : "</xsl:when>"
  xsl_stmt         : "<xsl:otherwise>"
  xsl_stmt         : "<xsl:text>Passed - Alert Log DB settings are correct</xsl:text>"
  xsl_stmt         : "</xsl:otherwise>"
  xsl_stmt         : "</xsl:choose>"
  regex            : "(Failed|Passed)"
  not_expect       : "Failed"
</custom_item>

<custom_item>
  type             : AUDIT_XML
  description      : "PANW-NM-000097 - The Palo Alto Networks security platform must have alarms enabled."
  info             : "It is critical for the appropriate personnel to be aware if a system is at risk of failing to process audit logs as required. Without a real-time alert, security personnel may be unaware of an impending failure of the audit capability, and system operation may be adversely affected.

Alerts provide organizations with urgent messages. Real-time alerts provide these messages immediately (i.e., the time from event detection to alert occurs in seconds or less)."
  solution         : "Go to Device >> Log Settings >> Alarms.
Select the 'Edit' icon (the gear symbol in the upper-right corner of the pane).
In the 'Alarm Settings' window; select the 'Enable Alarms' box.
Select 'OK'.
Commit changes by selecting 'Commit' in the upper-right corner of the screen.
Select 'OK' when the confirmation dialog appears."
  reference        : "800-171|3.3.4,800-171r3|03.03.04,800-53|AU-5(2),800-53r5|AU-5(2),800-53r5|AU-9b.,CAT|III,CCI|CCI-001858,CCI|CCI-003831,CN-L3|7.1.3.3(e),CSF|PR.PT-1,DISA_Benchmark|Palo_Alto_Networks_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-5(2),NESA|T3.6.2,NIAv2|GS7f,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-228662r997675_rule,STIG-ID|PANW-NM-000097,STIG-Legacy|SV-77241,STIG-Legacy|V-62751,Vuln-ID|V-228662"
  see_also         : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_PAN_Y24M10_STIG.zip"
  api_request_type : "op"
  request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
  xsl_stmt         : "<xsl:template match=\"/\">"
  xsl_stmt         : "<xsl:choose>"
  xsl_stmt         : "<xsl:when test=\"not(//common-criteria-alarm-generation/enable-alarm-generation) or not(//common-criteria-alarm-generation/enable-alarm-generation='yes')\">"
  xsl_stmt         : "<xsl:text>Failed - Enable Alarms in Log Settings is not selected</xsl:text>"
  xsl_stmt         : "</xsl:when>"
  xsl_stmt         : "<xsl:otherwise>"
  xsl_stmt         : "<xsl:text>Passed - Enable Alarms is selected</xsl:text>"
  xsl_stmt         : "</xsl:otherwise>"
  xsl_stmt         : "</xsl:choose>"
  regex            : "(Failed|Passed)"
  not_expect       : "Failed"
</custom_item>

<custom_item>
  type             : AUDIT_XML
  description      : "PANW-NM-000098 - The Palo Alto Networks security platform must compare internal information system clocks at least every 24 hours with an authoritative time server."
  info             : "Inaccurate time stamps make it more difficult to correlate events and can lead to an inaccurate analysis. Determining the correct time a particular event occurred on a system is critical when conducting forensic analysis and investigating system events. Synchronizing internal information system clocks provides uniformity of time stamps for information systems with multiple system clocks and systems connected over a network.

Network Time Protocol (NTP) is used to synchronize the system clock of a computer to reference time source. The Palo Alto Networks security platform can be configured to use specified NTP servers. For synchronization with the NTP server(s), NTP uses a minimum polling value of 64 seconds and a maximum polling value of 1024 seconds. These minimum and maximum polling values are not configurable on the firewall."
  solution         : "Go to Device >> Setup >> Services.
Select the 'Edit' icon (the gear symbol in the upper-right corner of the pane).
In the 'Services' window, in the NTP tab, in the 'Primary NTP Server Address' field and the 'Secondary NTP Server Address' field, enter the IP address or hostname of the NTP servers.

In the 'Authentication Type' field, select one of the following:
Symmetric Key; this option uses symmetric key exchange, which are shared secrets. Enter the key ID, algorithm, authentication key, and confirm the authentication key; for the algorithm, select 'SHA1'.
Autokey; this option uses auto key, or public key cryptography.
Commit changes by selecting 'Commit' in the upper-right corner of the screen.
Select 'OK' when the confirmation dialog appears."
  reference        : "800-171|3.3.7,800-171|3.4.2,800-171r3|03.03.07,800-171r3|03.04.02a.,800-53|AU-8(1)(a),800-53|CM-6b.,800-53r5|CM-6b.,800-53r5|SC-45(1)(a),CAT|III,CCI|CCI-000366,CCI|CCI-001891,CCI|CCI-004923,CN-L3|8.1.4.3(b),CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF|PR.PT-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Palo_Alto_Networks_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO-27001-2022|A.8.9,ISO-27001-2022|A.8.17,ISO/IEC-27001|A.12.4.4,ITSG-33|AU-8(1),ITSG-33|CM-6b.,NESA|T3.2.1,NESA|T3.6.7,NIAv2|NS44,NIAv2|NS45,NIAv2|NS46,NIAv2|NS47,PCI-DSSv3.2.1|10.4,PCI-DSSv3.2.1|10.4.1,PCI-DSSv3.2.1|10.4.3,PCI-DSSv4.0|10.6,PCI-DSSv4.0|10.6.1,PCI-DSSv4.0|10.6.2,PCI-DSSv4.0|10.6.3,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-228663r1018780_rule,STIG-ID|PANW-NM-000098,STIG-Legacy|SV-77243,STIG-Legacy|V-62753,SWIFT-CSCv1|2.3,TBA-FIISB|37.4,Vuln-ID|V-228663"
  see_also         : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_PAN_Y24M10_STIG.zip"
  api_request_type : "op"
  request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
  xsl_stmt         : "<xsl:template match=\"/\">"
  xsl_stmt         : "<xsl:choose>"
  xsl_stmt         : "<xsl:when test=\"//ntp-servers/primary-ntp-server/ntp-server-address and //ntp-servers/secondary-ntp-server/ntp-server-address\">"
  xsl_stmt         : "<xsl:text>Passed - NTP Servers are set</xsl:text>"
  xsl_stmt         : "</xsl:when>"
  xsl_stmt         : "<xsl:otherwise>"
  xsl_stmt         : "<xsl:choose>"
  xsl_stmt         : "<xsl:when test=\"not(//ntp-servers/primary-ntp-server/ntp-server-address)\">"
  xsl_stmt         : "<xsl:text>Failed - Primary NTP Server not set</xsl:text>"
  xsl_stmt         : "<xsl:text xml:space=\"preserve\">&#10;</xsl:text>"
  xsl_stmt         : "</xsl:when>"
  xsl_stmt         : "</xsl:choose>"
  xsl_stmt         : "<xsl:choose>"
  xsl_stmt         : "<xsl:when test=\"not(//ntp-servers/secondary-ntp-server/ntp-server-address)\">"
  xsl_stmt         : "<xsl:text>Failed - Secondary NTP Server not set</xsl:text>"
  xsl_stmt         : "</xsl:when>"
  xsl_stmt         : "</xsl:choose>"
  xsl_stmt         : "</xsl:otherwise>"
  xsl_stmt         : "</xsl:choose>"
  regex            : "(Failed|Passed)"
  not_expect       : "Failed"
</custom_item>

<custom_item>
  type             : AUDIT_XML
  description      : "PANW-NM-000099 - The Palo Alto Networks security platform must synchronize internal information system clocks to the authoritative time source when the time difference is greater than one second."
  info             : "Inaccurate time stamps make it more difficult to correlate events and can lead to an inaccurate analysis. Determining the correct time a particular event occurred on a system is critical when conducting forensic analysis and investigating system events. Synchronizing internal information system clocks provides uniformity of time stamps for information systems with multiple system clocks and systems connected over a network.

The Palo Alto Networks security platform can be configured to use specified Network Time Protocol (NTP) servers. NTP is used to synchronize the system clock of a computer to reference time source. Sources outside of the configured acceptable allowance (drift) may be inaccurate. When properly configured, NTP will synchronize all participating computers to within a few milliseconds of the reference time source."
  solution         : "Go to Device >> Setup >> Services.
Select the 'Edit' icon (the gear symbol in the upper-right corner of the pane).
In the 'Services' window, in the 'Primary NTP Server Address' field and the 'Secondary NTP Server Address' field, enter the IP address or hostname of the NTP servers.

In the 'Authentication Type' field, select one of the following:
None (default); this option disables NTP authentication.
Symmetric Key; this option uses symmetric key exchange, which are shared secrets. Enter the key ID, algorithm, authentication key, and confirm the authentication key.
Autokey; this option uses auto key, or public key cryptography.
Commit changes by selecting 'Commit' in the upper-right corner of the screen.
Select 'OK' when the confirmation dialog appears."
  reference        : "800-171|3.3.7,800-171|3.4.2,800-171r3|03.03.07,800-171r3|03.04.02a.,800-53|AU-8(1)(b),800-53|CM-6b.,800-53r5|CM-6b.,800-53r5|SC-45(1)(a),800-53r5|SC-45(1)(b),CAT|III,CCI|CCI-000366,CCI|CCI-002046,CCI|CCI-004923,CCI|CCI-004926,CN-L3|8.1.4.3(b),CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF|PR.PT-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Palo_Alto_Networks_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO-27001-2022|A.8.9,ISO-27001-2022|A.8.17,ISO/IEC-27001|A.12.4.4,ITSG-33|AU-8(1),ITSG-33|CM-6b.,NESA|T3.2.1,NESA|T3.6.7,NIAv2|NS44,NIAv2|NS45,NIAv2|NS46,NIAv2|NS47,PCI-DSSv3.2.1|10.4,PCI-DSSv3.2.1|10.4.1,PCI-DSSv3.2.1|10.4.3,PCI-DSSv4.0|10.6,PCI-DSSv4.0|10.6.1,PCI-DSSv4.0|10.6.2,PCI-DSSv4.0|10.6.3,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-228664r1018781_rule,STIG-ID|PANW-NM-000099,STIG-Legacy|SV-77245,STIG-Legacy|V-62755,SWIFT-CSCv1|2.3,TBA-FIISB|37.4,Vuln-ID|V-228664"
  see_also         : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_PAN_Y24M10_STIG.zip"
  api_request_type : "op"
  request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
  xsl_stmt         : "<xsl:template match=\"/\">"
  xsl_stmt         : "<xsl:choose>"
  xsl_stmt         : "<xsl:when test=\"//ntp-servers/primary-ntp-server/ntp-server-address and //ntp-servers/secondary-ntp-server/ntp-server-address\">"
  xsl_stmt         : "<xsl:text>Passed - NTP Servers are set</xsl:text>"
  xsl_stmt         : "</xsl:when>"
  xsl_stmt         : "<xsl:otherwise>"
  xsl_stmt         : "<xsl:choose>"
  xsl_stmt         : "<xsl:when test=\"not(//ntp-servers/primary-ntp-server/ntp-server-address)\">"
  xsl_stmt         : "<xsl:text>Failed - Primary NTP Server not set</xsl:text>"
  xsl_stmt         : "<xsl:text xml:space=\"preserve\">&#10;</xsl:text>"
  xsl_stmt         : "</xsl:when>"
  xsl_stmt         : "</xsl:choose>"
  xsl_stmt         : "<xsl:choose>"
  xsl_stmt         : "<xsl:when test=\"not(//ntp-servers/secondary-ntp-server/ntp-server-address)\">"
  xsl_stmt         : "<xsl:text>Failed - Secondary NTP Server not set</xsl:text>"
  xsl_stmt         : "</xsl:when>"
  xsl_stmt         : "</xsl:choose>"
  xsl_stmt         : "</xsl:otherwise>"
  xsl_stmt         : "</xsl:choose>"
  regex            : "(Failed|Passed)"
  not_expect       : "Failed"
</custom_item>

<if>
  <condition type:"AND">
    <custom_item>
      type             : AUDIT_XML
      description      : "NTP Servers configured equals 2"
      api_request_type : "op"
      request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
      xsl_stmt         : "<xsl:template match=\"/\">"
      xsl_stmt         : "<xsl:choose>"
      xsl_stmt         : "<xsl:when test=\"//ntp-servers/primary-ntp-server/ntp-server-address and //ntp-servers/secondary-ntp-server/ntp-server-address\">"
      xsl_stmt         : "<xsl:text>Passed - Two NTP Servers Configured</xsl:text>"
      xsl_stmt         : "</xsl:when>"
      xsl_stmt         : "<xsl:otherwise>"
      xsl_stmt         : "<xsl:text>Failed - Two NTP Servers are not configured</xsl:text>"
      xsl_stmt         : "</xsl:otherwise>"
      xsl_stmt         : "</xsl:choose>"
      regex            : "(Failed|Passed)"
      not_expect       : "Failed"
    </custom_item>
  </condition>

  <then>
    <custom_item>
      type             : AUDIT_XML
      description      : "PANW-NM-000100 - The Palo Alto Networks security platform must be configured to synchronize internal information system clocks with the primary and secondary time sources located in different geographic regions using redundant authoritative time sources."
      info             : "The loss of connectivity to a particular authoritative time source will result in the loss of time synchronization (free-run mode) and increasingly inaccurate time stamps on audit events and other functions. Multiple time sources provide redundancy by including a secondary source. Time synchronization is usually a hierarchy; clients synchronize time to a local source while that source synchronizes its time to a more accurate source.

DOD-approved solutions consist of a combination of a primary and secondary time source using a combination or multiple instances of the following: a time server designated for the appropriate DOD network (NIPRNet/SIPRNet); United States Naval Observatory (USNO) time servers; and/or the Global Positioning System (GPS). The secondary time source must be located in a different geographic region from the primary time source.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution         : "Go to Device >> Setup >> Services.
Select the 'Edit' icon (the gear symbol in the upper-right corner of the pane).
In the 'Services' window, in the 'Primary NTP Server Address' field and the 'Secondary NTP Server Address' field, enter the IP address or hostname of the NTP servers.

In the 'Authentication Type' field, select one of the following:
None (default); this option disables NTP authentication.
Symmetric Key; this option uses symmetric key exchange, which are shared secrets. Enter the key ID, algorithm, authentication key, and confirm the authentication key.
Autokey; this option uses auto key, or public key cryptography.
Commit changes by selecting 'Commit' in the upper-right corner of the screen.
Select 'OK' when the confirmation dialog appears."
      reference        : "800-171|3.3.7,800-171|3.4.2,800-171r3|03.03.07,800-171r3|03.04.02a.,800-53|AU-8(2),800-53|CM-6b.,800-53r5|CM-6b.,800-53r5|SC-45,800-53r5|SC-45(2)(a),CAT|II,CCI|CCI-000366,CCI|CCI-001893,CCI|CCI-004922,CCI|CCI-004928,CN-L3|8.1.4.3(b),CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF|PR.PT-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Palo_Alto_Networks_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO-27001-2022|A.8.9,ISO-27001-2022|A.8.17,ISO/IEC-27001|A.12.4.4,ITSG-33|AU-8(1),ITSG-33|CM-6b.,NESA|T3.2.1,NESA|T3.6.7,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-228665r1018782_rule,STIG-ID|PANW-NM-000100,STIG-Legacy|SV-77247,STIG-Legacy|V-62757,SWIFT-CSCv1|2.3,TBA-FIISB|37.4,Vuln-ID|V-228665"
      see_also         : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_PAN_Y24M10_STIG.zip"
      api_request_type : "op"
      request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
      xsl_stmt         : "<xsl:template match=\"/\">"
      xsl_stmt         : "<xsl:text>NTP Servers configured:</xsl:text>"
      xsl_stmt         : "<xsl:text xml:space=\"preserve\">&#10;</xsl:text>"
      xsl_stmt         : "<xsl:text>Primary NTP Server: </xsl:text><xsl:value-of select=\"//ntp-servers/primary-ntp-server/ntp-server-address\"/>"
      xsl_stmt         : "<xsl:text xml:space=\"preserve\">&#10;</xsl:text>"
      xsl_stmt         : "<xsl:text>Secondary NTP Server: </xsl:text><xsl:value-of select=\"//ntp-servers/secondary-ntp-server/ntp-server-address\"/>"
      regex            : ""
      expect           : "Manual Review Required"
      severity         : MEDIUM
    </custom_item>
  </then>

  <else>
    <custom_item>
      type             : AUDIT_XML
      description      : "PANW-NM-000100 - The Palo Alto Networks security platform must be configured to synchronize internal information system clocks with the primary and secondary time sources located in different geographic regions using redundant authoritative time sources."
      info             : "The loss of connectivity to a particular authoritative time source will result in the loss of time synchronization (free-run mode) and increasingly inaccurate time stamps on audit events and other functions. Multiple time sources provide redundancy by including a secondary source. Time synchronization is usually a hierarchy; clients synchronize time to a local source while that source synchronizes its time to a more accurate source.

DOD-approved solutions consist of a combination of a primary and secondary time source using a combination or multiple instances of the following: a time server designated for the appropriate DOD network (NIPRNet/SIPRNet); United States Naval Observatory (USNO) time servers; and/or the Global Positioning System (GPS). The secondary time source must be located in a different geographic region from the primary time source.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution         : "Go to Device >> Setup >> Services.
Select the 'Edit' icon (the gear symbol in the upper-right corner of the pane).
In the 'Services' window, in the 'Primary NTP Server Address' field and the 'Secondary NTP Server Address' field, enter the IP address or hostname of the NTP servers.

In the 'Authentication Type' field, select one of the following:
None (default); this option disables NTP authentication.
Symmetric Key; this option uses symmetric key exchange, which are shared secrets. Enter the key ID, algorithm, authentication key, and confirm the authentication key.
Autokey; this option uses auto key, or public key cryptography.
Commit changes by selecting 'Commit' in the upper-right corner of the screen.
Select 'OK' when the confirmation dialog appears."
      reference        : "800-171|3.3.7,800-171|3.4.2,800-171r3|03.03.07,800-171r3|03.04.02a.,800-53|AU-8(2),800-53|CM-6b.,800-53r5|CM-6b.,800-53r5|SC-45,800-53r5|SC-45(2)(a),CAT|II,CCI|CCI-000366,CCI|CCI-001893,CCI|CCI-004922,CCI|CCI-004928,CN-L3|8.1.4.3(b),CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF|PR.PT-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Palo_Alto_Networks_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO-27001-2022|A.8.9,ISO-27001-2022|A.8.17,ISO/IEC-27001|A.12.4.4,ITSG-33|AU-8(1),ITSG-33|CM-6b.,NESA|T3.2.1,NESA|T3.6.7,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-228665r1018782_rule,STIG-ID|PANW-NM-000100,STIG-Legacy|SV-77247,STIG-Legacy|V-62757,SWIFT-CSCv1|2.3,TBA-FIISB|37.4,Vuln-ID|V-228665"
      see_also         : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_PAN_Y24M10_STIG.zip"
      api_request_type : "op"
      request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
      xsl_stmt         : "<xsl:template match=\"/\">"
      xsl_stmt         : "<xsl:choose>"
      xsl_stmt         : "<xsl:when test=\"not(//ntp-servers/primary-ntp-server/ntp-server-address)\">"
      xsl_stmt         : "<xsl:text>Failed - Primary NTP Server not configured</xsl:text>"
      xsl_stmt         : "<xsl:text xml:space=\"preserve\">&#10;</xsl:text>"
      xsl_stmt         : "</xsl:when>"
      xsl_stmt         : "<xsl:otherwise>"
      xsl_stmt         : "<xsl:text>Primary NTP Server: </xsl:text><xsl:value-of select=\"//ntp-servers/primary-ntp-server/ntp-server-address\"/>"
      xsl_stmt         : "<xsl:text xml:space=\"preserve\">&#10;</xsl:text>"
      xsl_stmt         : "</xsl:otherwise>"
      xsl_stmt         : "</xsl:choose>"
      xsl_stmt         : "<xsl:choose>"
      xsl_stmt         : "<xsl:when test=\"not(//ntp-servers/secondary-ntp-server/ntp-server-address)\">"
      xsl_stmt         : "<xsl:text>Failed - Secondary NTP Server not configured</xsl:text>"
      xsl_stmt         : "<xsl:text xml:space=\"preserve\">&#10;</xsl:text>"
      xsl_stmt         : "</xsl:when>"
      xsl_stmt         : "<xsl:otherwise>"
      xsl_stmt         : "<xsl:text>Secondary NTP Server: </xsl:text><xsl:value-of select=\"//ntp-servers/secondary-ntp-server/ntp-server-address\"/>"
      xsl_stmt         : "<xsl:text xml:space=\"preserve\">&#10;</xsl:text>"
      xsl_stmt         : "</xsl:otherwise>"
      xsl_stmt         : "</xsl:choose>"
      regex            : ""
      expect           : "Manual Review Required"
      severity         : MEDIUM
    </custom_item>
  </else>
</if>

<custom_item>
  type             : AUDIT_XML
  description      : "PANW-NM-000101 - The Palo Alto Networks security platform must record time stamps for audit records that can be mapped to Coordinated Universal Time (UTC) or Greenwich Mean Time (GMT)."
  info             : "If time stamps are not consistently applied and there is no common time reference, it is difficult to perform forensic analysis.  Time stamps generated by the application include date and time and must be expressed in Coordinated Universal Time (UTC), also known as Zulu time, a modern continuation of Greenwich Mean Time (GMT)."
  solution         : "Go to Device >> Setup >> Management
In the 'General Settings' window, select the 'Edit' icon (the gear symbol in the upper-right corner of the pane).
In the 'General Settings' window, in the 'Time Zone' field, select 'GMT' or 'UTC' from the list of time zones.
Select 'OK'.
Commit changes by selecting 'Commit' in the upper-right corner of the screen.  Select 'OK' when the confirmation dialog appears."
  reference        : "800-171|3.3.7,800-171r3|03.03.07b.,800-53|AU-8b.,800-53r5|AU-8b.,CAT|II,CCI|CCI-001890,CN-L3|8.1.4.3(b),CSF|PR.PT-1,DISA_Benchmark|Palo_Alto_Networks_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO-27001-2022|A.8.17,ITSG-33|AU-8,NESA|T3.6.7,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-228666r961443_rule,STIG-ID|PANW-NM-000101,STIG-Legacy|SV-77249,STIG-Legacy|V-62759,TBA-FIISB|37.4,Vuln-ID|V-228666"
  see_also         : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_PAN_Y24M10_STIG.zip"
  api_request_type : "op"
  request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
  xsl_stmt         : "<xsl:template match=\"/\">"
  xsl_stmt         : "<xsl:choose>"
  xsl_stmt         : "<xsl:when test=\"not(//deviceconfig/system/timezone = 'UTC') and not(//deviceconfig/system/timezone='GMT')\">"
  xsl_stmt         : "<xsl:text>Failed - Device Timzone is not set to 'GMT' or 'UTC'</xsl:text>"
  xsl_stmt         : "</xsl:when>"
  xsl_stmt         : "<xsl:otherwise>"
  xsl_stmt         : "<xsl:text>Passed - Device Timezone is set properly</xsl:text>"
  xsl_stmt         : "</xsl:otherwise>"
  xsl_stmt         : "</xsl:choose>"
  regex            : "(Failed|Passed)"
  not_expect       : "Failed"
</custom_item>

<if>
  <condition auto:"WARNING" type:"AND">
    <custom_item>
      type             : AUDIT_XML
      description      : "'DOD CA certificates'"
      api_request_type : "op"
      request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
      xsl_stmt         : "<xsl:template match=\"/\">"
      xsl_stmt         : "<xsl:for-each select=\"//config/shared/certificate/entry\">"
      xsl_stmt         : "<xsl:text>Certificate name: </xsl:text><xsl:value-of select=\"@name\"/>"
      xsl_stmt         : "<xsl:text xml:space=\"preserve\">&#10;</xsl:text>"
      xsl_stmt         : "<xsl:text>Issuer: </xsl:text><xsl:value-of select=\"issuer\"/>"
      xsl_stmt         : "<xsl:text xml:space=\"preserve\">&#10;</xsl:text>"
      xsl_stmt         : "<xsl:text xml:space=\"preserve\">&#10;</xsl:text>"
      xsl_stmt         : "</xsl:for-each>"
      regex            : ""
      severity         : MEDIUM
    </custom_item>

    <custom_item>
      type             : AUDIT_XML
      description      : "'Certificate Profile'"
      api_request_type : "op"
      request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
      xsl_stmt         : "<xsl:template match=\"/\">"
      xsl_stmt         : "<xsl:choose>"
      xsl_stmt         : "<xsl:when test=\"not(//config/devices/entry/deviceconfig/system/certificate-profile)\">"
      xsl_stmt         : "<xsl:text>Failed - Certificate Profile not Selected</xsl:text>"
      xsl_stmt         : "</xsl:when>"
      xsl_stmt         : "<xsl:otherwise>"
      xsl_stmt         : "<xsl:text>Passed - Certificate Profile is set</xsl:text>"
      xsl_stmt         : "</xsl:otherwise>"
      xsl_stmt         : "</xsl:choose>"
      regex            : "(Failed|Passed)"
      not_expect       : "Failed"
    </custom_item>

    <custom_item>
      type             : AUDIT_XML
      description      : "'Use OCSP'"
      api_request_type : "op"
      request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
      xsl_stmt         : "<xsl:template match=\"/\">"
      xsl_stmt         : "<xsl:choose>"
      xsl_stmt         : "<xsl:when test=\"//config/shared/certificate-profile/entry\">"
      xsl_stmt         : "<xsl:for-each select=\"//config/shared/certificate-profile/entry\">"
      xsl_stmt         : "<xsl:choose>"
      xsl_stmt         : "<xsl:when test=\"not(use-ocsp='yes')\">"
      xsl_stmt         : "<xsl:text>Failed - Certificate Profile: </xsl:text><xsl:value-of select=\"@name\"/><xsl:text> does not have OCSP enabled</xsl:text>"
      xsl_stmt         : "<xsl:text xml:space=\"preserve\">&#10;</xsl:text>"
      xsl_stmt         : "</xsl:when>"
      xsl_stmt         : "<xsl:otherwise>"
      xsl_stmt         : "<xsl:text>Passed - Certificate Profile: </xsl:text><xsl:value-of select=\"@name\"/><xsl:text> has OCSP enabled</xsl:text>"
      xsl_stmt         : "</xsl:otherwise>"
      xsl_stmt         : "</xsl:choose>"
      xsl_stmt         : "</xsl:for-each>"
      xsl_stmt         : "</xsl:when>"
      xsl_stmt         : "<xsl:otherwise>"
      xsl_stmt         : "<xsl:text>Failed - No Certificate Profiles found</xsl:text>"
      xsl_stmt         : "</xsl:otherwise>"
      xsl_stmt         : "</xsl:choose>"
      regex            : "(Failed|Passed)"
      not_expect       : "Failed"
    </custom_item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "PANW-NM-000110 - The Palo Alto Networks security platform must accept and verify Personal Identity Verification (PIV) credentials"
      info        : "The use of PIV credentials facilitates standardization and reduces the risk of unauthorized access.

DOD has mandated the use of the CAC to support identity management and personal authentication for systems covered under HSPD 12 and as a primary component of layered protection for national security systems.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "Import the DOD CA certificates and subordinate certificates for all of the certificate authorities.
Go to Device >> Certificate Management >> Certificates.
Select the Import icon at the bottom of the pane.
In the Import Certificate window, complete the required information.
Select 'OK'.

Create a certificate profile.
Go to Device >> Setup >> Management.
In the Authentication Settings pane, select the select the 'Edit' icon (the gear symbol in the upper-right corner).
In the Authentication Settings window, complete the required information.
In the Authentication Profile field, select 'None'.
In the Certificate Profile field, select 'New Certificate Profile'. This will change the Authentication Settings window to the Certificate Profile window.
Leave the username field blank.
Leave the domain field blank.

In the Certificate Profile window, complete the required fields.
In the CA Certificates section, select 'Add' to import the DOD certificate authorities.
Select the Use OCSP checkbox.
When importing the top level DOD CA Certificate, for the Default OCSP URL field, add the DOD/DISA OCSP URL.
Select 'OK'.
Select 'OK' again.
Commit changes by selecting 'Commit' in the upper-right corner of the screen.
Select 'OK' when the confirmation dialog appears."
      reference   : "800-171|3.4.2,800-171|3.5.1,800-171r3|03.04.02a.,800-171r3|03.05.01a.,800-53|CM-6b.,800-53|IA-2(12),800-53r5|CM-6b.,800-53r5|IA-2(12),800-53r5|IA-5(2)(b)(2),CAT|II,CCI|CCI-000366,CCI|CCI-001953,CCI|CCI-004068,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.1.10.6(d),CN-L3|8.5.4.1(a),CSF|PR.AC-1,CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,CSF2.0|PR.PS-01,DISA_Benchmark|Palo_Alto_Networks_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO-27001-2022|A.5.16,ISO-27001-2022|A.8.9,ITSG-33|CM-6b.,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T3.2.1,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-228667r997687_rule,STIG-ID|PANW-NM-000110,STIG-Legacy|SV-77251,STIG-Legacy|V-62761,SWIFT-CSCv1|2.3,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-228667"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_PAN_Y24M10_STIG.zip"
      show_output : YES
    </report>
  </then>
</if>

<custom_item>
  type             : AUDIT_XML
  description      : "PANW-NM-000117 - The Palo Alto Networks security platform must only allow the use of secure protocols that implement cryptographic mechanisms to protect the integrity of maintenance and diagnostic communications for nonlocal maintenance sessions."
  info             : "This requires the use of secure protocols instead of their unsecured counterparts, such as SSH instead of telnet, SCP instead of FTP, and HTTPS instead of HTTP. Note that HTTP OCSP is permitted to support OCSP where used. If unsecured protocols (lacking cryptographic mechanisms) are used for sessions, the contents of those sessions will be susceptible to manipulation, potentially allowing alteration and hijacking of maintenance sessions."
  solution         : "Go to Device >> Setup >> Management.
In the 'Management Interface Settings' window, select the 'Edit' icon (the gear symbol in the upper-right corner).
In the 'Management Interface Settings' window, make sure that Telnet or HTTP are not selected.
Select 'OK'.
Commit changes by selecting 'Commit' in the upper-right corner of the screen.
Select 'OK' when the confirmation dialog appears."
  reference        : "800-171|3.7.5,800-171r3|03.07.05,800-53|MA-4(6),800-53r5|MA-4(6),CAT|II,CCI|CCI-002890,CSF|PR.MA-2,DISA_Benchmark|Palo_Alto_Networks_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|MA-4(6),NESA|T2.3.4,NESA|T5.4.4,QCSC-v1|5.2.2,Rule-ID|SV-228669r961554_rule,STIG-ID|PANW-NM-000117,STIG-Legacy|SV-77255,STIG-Legacy|V-62765,SWIFT-CSCv1|2.6,TBA-FIISB|45.2.3,Vuln-ID|V-228669"
  see_also         : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_PAN_Y24M10_STIG.zip"
  api_request_type : "op"
  request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
  xsl_stmt         : "<xsl:template match=\"/\">"
  xsl_stmt         : "<xsl:choose>"
  xsl_stmt         : "<xsl:when test=\"not(//disable-telnet) or //disable-telnet = 'yes' and not(//disable-http) or //disable-http = 'yes' and not(//disable-http-ocsp) or //disable-http-ocsp = 'yes'\">"
  xsl_stmt         : "<xsl:text>Passed</xsl:text>"
  xsl_stmt         : "</xsl:when>"
  xsl_stmt         : "<xsl:otherwise>"
  xsl_stmt         : "<xsl:choose>"
  xsl_stmt         : "<xsl:when test=\"//disable-telnet = 'no'\">"
  xsl_stmt         : "<xsl:text>Failed - Telnet</xsl:text>"
  xsl_stmt         : "<xsl:text xml:space=\"preserve\">&#10;</xsl:text>"
  xsl_stmt         : "</xsl:when>"
  xsl_stmt         : "</xsl:choose>"
  xsl_stmt         : "<xsl:choose>"
  xsl_stmt         : "<xsl:when test=\"//disable-http = 'no'\">"
  xsl_stmt         : "<xsl:text>Failed - HTTP</xsl:text>"
  xsl_stmt         : "<xsl:text xml:space=\"preserve\">&#10;</xsl:text>"
  xsl_stmt         : "</xsl:when>"
  xsl_stmt         : "</xsl:choose>"
  xsl_stmt         : "<xsl:choose>"
  xsl_stmt         : "<xsl:when test=\"//disable-http-ocsp = 'no'\">"
  xsl_stmt         : "<xsl:text>Failed - HTTP OCSP</xsl:text>"
  xsl_stmt         : "<xsl:text xml:space=\"preserve\">&#10;</xsl:text>"
  xsl_stmt         : "</xsl:when>"
  xsl_stmt         : "</xsl:choose>"
  xsl_stmt         : "</xsl:otherwise>"
  xsl_stmt         : "</xsl:choose>"
  regex            : "(Failed|Passed)"
  not_expect       : "Failed"
</custom_item>

<if>
  <condition auto:"FAILED" type:"AND">
    <custom_item>
      type             : AUDIT_XML
      description      : "'SNMP v3'"
      api_request_type : "op"
      request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
      xsl_stmt         : "<xsl:template match=\"/\">"
      xsl_stmt         : "<xsl:choose>"
      xsl_stmt         : "<xsl:when test=\"not(//snmp-setting/access-setting/version/v3)\">"
      xsl_stmt         : "<xsl:text>Failed - SNMP v3 is not enabled</xsl:text>"
      xsl_stmt         : "</xsl:when>"
      xsl_stmt         : "<xsl:otherwise>"
      xsl_stmt         : "<xsl:text>Passed - SNMP v3 is enabled</xsl:text>"
      xsl_stmt         : "</xsl:otherwise>"
      xsl_stmt         : "</xsl:choose>"
      regex            : "(Failed|Passed)"
      not_expect       : "Failed"
    </custom_item>

    <custom_item>
      type             : AUDIT_XML
      description      : "'SNMP Trap v3'"
      api_request_type : "op"
      request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
      xsl_stmt         : "<xsl:template match=\"/\">"
      xsl_stmt         : "<xsl:for-each select=\"//log-settings/snmptrap/entry\">"
      xsl_stmt         : "<xsl:choose>"
      xsl_stmt         : "<xsl:when test=\"not(version/v3)\">"
      xsl_stmt         : "<xsl:text>Failed - SNMP Trap not v3: </xsl:text><xsl:value-of select=\"@name\"/>"
      xsl_stmt         : "<xsl:text xml:space=\"preserve\">&#10;</xsl:text>"
      xsl_stmt         : "</xsl:when>"
      xsl_stmt         : "<xsl:otherwise>"
      xsl_stmt         : "<xsl:text>Passed - </xsl:text><xsl:value-of select=\"@name\"/>"
      xsl_stmt         : "<xsl:text xml:space=\"preserve\">&#10;</xsl:text>"
      xsl_stmt         : "</xsl:otherwise>"
      xsl_stmt         : "</xsl:choose>"
      xsl_stmt         : "</xsl:for-each>"
      regex            : "(Failed|Passed)"
      not_expect       : "Failed"
    </custom_item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "PANW-NM-000118 - The Palo Alto Networks security platform must not use SNMP Versions 1 or 2"
      info        : "SNMP Versions 1 and 2 are not considered secure. Without the strong authentication and privacy that is provided by the SNMP Version 3 User-based Security Model (USM), an unauthorized user can gain access to network management information used to launch an attack against the network.  SNMP Versions 1 and 2 cannot authenticate the source of a message nor can they provide encryption. Without authentication, it is possible for nonauthorized users to exercise SNMP network management functions. It is also possible for nonauthorized users to eavesdrop on management information as it passes from managed systems to the management system."
      solution    : "Go to Device >> Setup >> Operations; in the Miscellaneous pane, select SNMP Setup.
In the SNMP Setup window, complete the required fields.
For the Version, select V3.
Configure a view and assign it to a user.
In the upper half of the SNMP Setup window, select 'Add'.
In the Views window, complete the required fields; obtain the values for the OID and Mask fields from product documentation or vendor support.
In the Option field, select 'include'.
Select 'OK'.
In the lower half of the SNMP Setup window, select 'Add'.
Complete the required fields.
Select 'OK'.
Obtain the engineID of the Palo Alto device by issuing an SNMPv3 GET from the management workstation against the OID of the Palo Alto device.
Configure the SNMPv3 Trap Server profile; go to Device >> Server Profiles >> SNMP Trap; select 'Add'.
In the SNMP Trap Server Profile window, complete the required fields.
Select 'OK'.
Commit changes by selecting 'Commit' in the upper-right corner of the screen.
Select 'OK' when the confirmation dialog appears."
      reference   : "800-171|3.7.5,800-171r3|03.07.05,800-53|MA-4(6),800-53r5|MA-4(6),CAT|I,CCI|CCI-003123,CSF|PR.MA-2,DISA_Benchmark|Palo_Alto_Networks_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|MA-4(6),NESA|T2.3.4,NESA|T5.4.4,QCSC-v1|5.2.2,Rule-ID|SV-228670r961557_rule,STIG-ID|PANW-NM-000118,STIG-Legacy|SV-77257,STIG-Legacy|V-62767,SWIFT-CSCv1|2.6,TBA-FIISB|45.2.3,Vuln-ID|V-228670"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_PAN_Y24M10_STIG.zip"
      show_output : YES
    </report>
  </then>
</if>

<if>
  <condition auto:"FAILED" type:"AND">
    <custom_item>
      type             : AUDIT_XML
      description      : "'Syslog Server Profiles'"
      api_request_type : "op"
      request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
      xsl_stmt         : "<xsl:template match=\"/\">"
      xsl_stmt         : "<xsl:choose>"
      xsl_stmt         : "<xsl:when test=\"not(//log-settings/syslog/entry)\">"
      xsl_stmt         : "<xsl:text>Failed - No Syslog servers set</xsl:text>"
      xsl_stmt         : "</xsl:when>"
      xsl_stmt         : "<xsl:otherwise>"
      xsl_stmt         : "<xsl:text>Passed</xsl:text>"
      xsl_stmt         : "</xsl:otherwise>"
      xsl_stmt         : "</xsl:choose>"
      regex            : "(Failed|Passed)"
      not_expect       : "Failed"
    </custom_item>

    <custom_item>
      type             : AUDIT_XML
      description      : "'Syslog Servers'"
      api_request_type : "op"
      request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
      xsl_stmt         : "<xsl:template match=\"/\">"
      xsl_stmt         : "<xsl:choose>"
      xsl_stmt         : "<xsl:when test=\"not(//log-settings/syslog/entry)\">"
      xsl_stmt         : "<xsl:text>Failed - Syslog Server not configured</xsl:text>"
      xsl_stmt         : "<xsl:text xml:space=\"preserve\">&#10;</xsl:text>"
      xsl_stmt         : "</xsl:when>"
      xsl_stmt         : "<xsl:otherwise>"
      xsl_stmt         : "<xsl:text>Passed - Syslog Server is configured for profile: </xsl:text><xsl:value-of select=\"@name\"/>"
      xsl_stmt         : "</xsl:otherwise>"
      xsl_stmt         : "</xsl:choose>"
      regex            : "(Failed|Passed)"
      not_expect       : "Failed"
    </custom_item>

    <custom_item>
      type             : AUDIT_XML
      description      : "'Log Forwarding Profile'"
      api_request_type : "op"
      request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
      xsl_stmt         : "<xsl:template match=\"/\">"
      xsl_stmt         : "<xsl:choose>"
      xsl_stmt         : "<xsl:when test=\"not(//log-settings/profiles/entry)\">"
      xsl_stmt         : "<xsl:text>Failed - No Log Forwarding Profile</xsl:text>"
      xsl_stmt         : "</xsl:when>"
      xsl_stmt         : "<xsl:otherwise>"
      xsl_stmt         : "<xsl:text>Passed</xsl:text>"
      xsl_stmt         : "</xsl:otherwise>"
      xsl_stmt         : "</xsl:choose>"
      regex            : "(Failed|Passed)"
      not_expect       : "Failed"
    </custom_item>

    <custom_item>
      type             : AUDIT_XML
      description      : "'Traffic Log Syslog'"
      api_request_type : "op"
      request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
      xsl_stmt         : "<xsl:template match=\"/\">"
      xsl_stmt         : "<xsl:for-each select=\"//log-settings/profiles/entry\">"
      xsl_stmt         : "<xsl:choose>"
      xsl_stmt         : "<xsl:when test=\"not(match-list/entry/log-type='traffic') and not(match-list/entry/send-syslog) and not(match-list/entry/filter='All Logs')\">"
      xsl_stmt         : "<xsl:text>Failed - Syslog Server not set for Traffic logging on Log Forwarding profile: </xsl:text><xsl:value-of select=\"@name\"/>"
      xsl_stmt         : "<xsl:text xml:space=\"preserve\">&#10;</xsl:text>"
      xsl_stmt         : "</xsl:when>"
      xsl_stmt         : "<xsl:otherwise>"
      xsl_stmt         : "<xsl:text>Passed - Syslog Server set for Traffic logging on Log Forwarding profile: </xsl:text><xsl:value-of select=\"@name\"/>"
      xsl_stmt         : "</xsl:otherwise>"
      xsl_stmt         : "</xsl:choose>"
      xsl_stmt         : "</xsl:for-each>"
      regex            : "(Failed|Passed)"
      not_expect       : "Failed"
    </custom_item>

    <custom_item>
      type             : AUDIT_XML
      description      : "'Threat Log Syslog'"
      api_request_type : "op"
      request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
      xsl_stmt         : "<xsl:template match=\"/\">"
      xsl_stmt         : "<xsl:for-each select=\"//log-settings/profiles/entry\">"
      xsl_stmt         : "<xsl:choose>"
      xsl_stmt         : "<xsl:when test=\"not(match-list/entry/log-type='threat') and not(match-list/entry/send-syslog) and not(match-list/entry/filter='All Logs')\">"
      xsl_stmt         : "<xsl:text>Failed - Syslog Server not set for all Threat Severity levels on Log Forwarding profile: </xsl:text><xsl:value-of select=\"@name\"/>"
      xsl_stmt         : "<xsl:text xml:space=\"preserve\">&#10;</xsl:text>"
      xsl_stmt         : "</xsl:when>"
      xsl_stmt         : "<xsl:otherwise>"
      xsl_stmt         : "<xsl:text>Passed - </xsl:text><xsl:value-of select=\"@name\"/>"
      xsl_stmt         : "</xsl:otherwise>"
      xsl_stmt         : "</xsl:choose>"
      xsl_stmt         : "</xsl:for-each>"
      regex            : "(Failed|Passed)"
      not_expect       : "Failed"
    </custom_item>

    <custom_item>
      type             : AUDIT_XML
      description      : "'System Log Syslog'"
      api_request_type : "op"
      request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
      xsl_stmt         : "<xsl:template match=\"/\">"
      xsl_stmt         : "<xsl:choose>"
      xsl_stmt         : "<xsl:when test=\"not(//log-settings/system/match-list/entry/filter='All Logs') or not(//log-settings/system/match-list/entry/send-syslog)\">"
      xsl_stmt         : "<xsl:text>Failed - System Syslog Server is not set for all Severity levels</xsl:text>"
      xsl_stmt         : "</xsl:when>"
      xsl_stmt         : "<xsl:otherwise>"
      xsl_stmt         : "<xsl:text>Passed</xsl:text>"
      xsl_stmt         : "</xsl:otherwise>"
      xsl_stmt         : "</xsl:choose>"
      regex            : "(Failed|Passed)"
      not_expect       : "Failed"
    </custom_item>

    <custom_item>
      type             : AUDIT_XML
      description      : "'Config Log Syslog'"
      api_request_type : "op"
      request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
      xsl_stmt         : "<xsl:template match=\"/\">"
      xsl_stmt         : "<xsl:choose>"
      xsl_stmt         : "<xsl:when test=\"not(//log-settings/config/match-list/entry/filter='All Logs') or not(//log-settings/config/match-list/entry/send-syslog)\">"
      xsl_stmt         : "<xsl:text>Failed - Syslog Server not set for Configuration Log</xsl:text>"
      xsl_stmt         : "</xsl:when>"
      xsl_stmt         : "<xsl:otherwise>"
      xsl_stmt         : "<xsl:text>Passed</xsl:text>"
      xsl_stmt         : "</xsl:otherwise>"
      xsl_stmt         : "</xsl:choose>"
      regex            : "(Failed|Passed)"
      not_expect       : "Failed"
    </custom_item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "PANW-NM-000128 - The Palo Alto Networks security platform must off-load audit records onto a different system or media than the system being audited"
      info        : "Information stored in one location is vulnerable to accidental or incidental deletion or alteration.  Off-loading is a common process in information systems with limited audit storage capacity.

The Palo Alto Networks security platform has multiple log types; at a minimum, the Traffic, Threat, System, and Configuration logs must be sent to a Syslog server."
      solution    : "To create a syslog server profile:
Go to Device >> Server Profiles >> Syslog
Select 'Add'.
In the Syslog Server Profile, enter the name of the profile.
Select 'Add'.
In the 'Servers' tab, enter the required information.
Name: Name of the syslog server
Server: Server IP address where the logs will be forwarded to
Port: Default port 514
Facility: Select from the drop-down list.
Select 'OK'.

After creating the Server Profiles that define where to logs, enable log forwarding.
The way to enable forwarding depends on the log type:
Traffic Logs-Enable forwarding of Traffic logs by creating a Log Forwarding Profile (Objects >> Log Forwarding) and adding it to the security policies to trigger the log forwarding. Only traffic that matches a specific rule within the security policy will be logged and forwarded.
Configure the log-forwarding profile to select the logs to be forwarded to syslog server.
Go to Objects >> Log forwarding
The Log Forwarding Profile window appears.  Note that it has five columns.  In the Syslog column, select the syslog server profile for forwarding threat logs to the configured server(s).
Select 'OK'.

When the Log Forwarding Profile window disappears, the screen will show the configured log-forwarding profile.
Threat Logs-Enable forwarding of Threat logs by creating a Log Forwarding Profile (Objects >> Log Forwarding) that specifies which severity levels to forward and then adding it to the security policies, which triggers the log forwarding. A Threat log entry will only be created (and therefore forwarded) if the associated traffic matches a Security Profile (Antivirus, Anti-spyware, Vulnerability, URL Filtering, File Blocking, Data Filtering, or DoS Protection).
Configure the log-forwarding profile to select the logs to be forwarded to syslog server.
Go to Objects >> Log forwarding
The Log Forwarding Profile window appears.  Note that it has five columns.  In the 'Syslog' column, select the syslog server profile for forwarding threat logs to the configured server(s).
Select 'OK'.

When the Log Forwarding Profile window disappears, the screen will show the configured log-forwarding profile.
System Logs-Enable forwarding of System logs by specifying a Server Profile in the log settings configuration.
Go to Device >> Log Settings >> System Logs
The list of severity levels is displayed.
Select a Server Profile for each severity level to forward.
Select each severity level in turn; with each selection, the 'Log Systems - Setting' window will appear.
In the 'Log Systems - Setting' window, in the 'Syslog drop-down' box, select the configured Server Profile.
Select 'OK'.
Config Logs-Enable forwarding of Config logs by specifying a Server Profile in the log settings configuration.
Go to Device >> Log Settings >> Config Logs
Select the 'Edit' icon (the gear symbol in the upper-right corner of the pane).
In the 'Log Settings Config' window, in the 'Syslog drop-down' box, select the configured Server Profile.
Select 'OK'.

For Traffic Logs and Threat Logs, use the log forwarding profile in the security rules.
Go to Policies >> Security Rule
Select the rule for which the log forwarding needs to be applied.
Apply the security profiles to the rule.
Go to Actions >> Log forwarding
Select the log forwarding profile from drop-down list.
Commit changes by selecting 'Commit' in the upper-right corner of the screen.  Select 'OK' when the confirmation dialog appears."
      reference   : "800-53|AU-4(1),800-53r5|AU-4(1),CAT|II,CCI|CCI-001851,CSF|PR.DS-4,CSF|PR.PT-1,DISA_Benchmark|Palo_Alto_Networks_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO-27001-2022|A.8.6,ITSG-33|AU-4,NESA|T3.3.1,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-228671r961860_rule,STIG-ID|PANW-NM-000128,STIG-Legacy|SV-77259,STIG-Legacy|V-62769,Vuln-ID|V-228671"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_PAN_Y24M10_STIG.zip"
      show_output : YES
    </report>
  </then>
</if>

<report type:"WARNING">
  description : "PANW-NM-000131 - The Palo Alto Networks security platform must use automated mechanisms to alert security personnel to threats identified by authoritative sources (e.g., CTOs) and IAW CJCSM 6510.01B."
  info        : "CJCSM 6510.01B, 'Cyber Incident Handling Program', in subsection e.(6)(c) sets forth three requirements for Cyber events detected by an automated system:
If the cyber event is detected by an automated system, an alert will be sent to the POC designated for receiving such automated alerts.
CC/S/A/FAs that maintain automated detection systems and sensors must ensure that a POC for receiving the alerts has been defined and that the IS configured to send alerts to that POC.
The POC must then ensure that the cyber event is reviewed as part of the preliminary analysis phase and reported to the appropriate individuals if it meets the criteria for a reportable cyber event or incident.

By immediately displaying an alarm message, potential security violations can be identified more quickly even when administrators are not logged on to the network device. An example of a mechanism to facilitate this would be through the utilization of SNMP traps.

The Palo Alto Networks security platform can be configured to send messages to an SNMP server and to an email server as well as a Syslog server. SNMP traps can be generated for each of the five logging event types on the firewall: traffic, threat, system, hip, config. For this requirement, only the threat logs must be sent. Note that only traffic that matches an action in a rule will be logged and forwarded. In the case of traps, the messages are initiated by the firewall and sent unsolicited to the management stations.

The use of email as a notification method may result in a very larger number of messages being sent and possibly overwhelming the email server as well as the POC. The use of SNMP is preferred over email in general, but organizations may want to use email in addition to SNMP for high-priority messages.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "For SNMP traps, follow the following steps:
Configure the SNMP Trap Destinations; go to Device >> Server Profiles >> SNMP Trap.
Select 'Add'.

In the 'SNMP Trap Server Profile' window, enter the required information.
For SNMP Version, select 'V3'.
Enter the name of the SNMP Server Profile.
Select 'Add'.
Server-Specify the SNMP trap destination name (up to 31 characters).
Manager-Specify the IP address of the trap destination.
User-Specify the SNMP user.
EngineID-Specify the engine ID of the firewall. The input is a string in hexadecimal representation. The engine ID is any number between 5 to 64 bytes. When represented as a hexadecimal string, this is between 10 and 128 characters (2 characters for each byte) with two additional characters for 0x that must be used as a prefix in the input string.
Auth Password-Specify the user's authentication password (minimum 8 characters, maximum of 256 characters, and no character restrictions). Only Secure Hash Algorithm (SHA) is supported.
Priv Password-Specify the user's encryption password (minimum 8 characters, maximum of 256 characters, and no character restrictions). Only Advanced Encryption Standard (AES) is supported.
Select 'OK'.

Configure generating 'Traps for Threat' events:
Go to Objects >> Log Forwarding.
Select 'Add'.
In the 'Log Forwarding Profile' window, enter the required information.
Enter the name of the Log Forwarding Profile.
In the 'Threat Settings' section, in the 'SNMP Trap' field for each Severity, select the SNMP Trap Server Profile.
Select 'OK'.

Add the Log Forwarding Profile to the security policies to trigger log forwarding to the SNMP server.
Go to Policies >> Security.
Select the rule for which the log forwarding needs to be applied. Apply the security profiles to the rule.
Go to 'Actions' (tab); in the 'Log forwarding' field, select the 'log forwarding' profile.
Commit changes by selecting 'Commit' in the upper-right corner of the screen.
Select 'OK' when the confirmation dialog appears."
  reference   : "800-171|3.4.2,800-171|3.14.6,800-171|3.14.7,800-171r3|03.04.02a.,800-171r3|03.14.06,800-53|CM-6b.,800-53|SI-4(12),800-53r5|AU-9b.,800-53r5|CM-6b.,800-53r5|SI-4(12),CAT|II,CCI|CCI-000366,CCI|CCI-001274,CCI|CCI-003831,CN-L3|7.1.3.5(a),CN-L3|8.1.10.6(d),CSF|DE.AE-1,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|ID.RA-1,CSF|PR.IP-1,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,CSF2.0|DE.AE-02,CSF2.0|DE.AE-03,CSF2.0|DE.CM-01,CSF2.0|DE.CM-06,CSF2.0|DE.CM-09,CSF2.0|ID.IM-01,CSF2.0|ID.IM-02,CSF2.0|ID.IM-03,CSF2.0|ID.RA-01,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,CSF2.0|PR.PS-01,DISA_Benchmark|Palo_Alto_Networks_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO-27001-2022|A.8.9,ISO-27001-2022|A.8.16,ITSG-33|CM-6b.,ITSG-33|SI-4(12),NESA|M1.2.2,NESA|T3.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,Rule-ID|SV-228672r997690_rule,STIG-ID|PANW-NM-000131,STIG-Legacy|SV-77261,STIG-Legacy|V-62771,SWIFT-CSCv1|2.3,TBA-FIISB|45.2.5,TBA-FIISB|51.2.2,Vuln-ID|V-228672"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_PAN_Y24M10_STIG.zip"
</report>

<report type:"WARNING">
  description : "PANW-NM-000136 - The Palo Alto Networks security platform must employ centrally managed authentication server(s)."
  info        : "The use of authentication servers or other centralized management servers for providing centralized authentication services is required for network device management. Maintaining local administrator accounts for daily usage on each network device without centralized management is not scalable or feasible. Without centralized management, it is likely that credentials for some network devices will be forgotten, leading to delays in administration, which itself leads to delays in remediating production problems and in addressing compromises in a timely fashion.

Only the emergency administration account, also known as the account of last resort, can be locally configured on the device.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "The device allows three different authentication protocols; RADIUS, LDAP, and Kerberos. In this explanation, LDAP is used.
To configure the Palo Alto Networks security platform to use an LDAP server, follow these steps:
Go to Device >> Server-Profiles >> LDAP.
Select 'Add' (lower left of window).
Populate the required fields.
Enter the name of the profile in the 'Name' field.
In the server box enter the name of the server in the 'Name' field.
Enter the IP Address of the server.
Enter the Port number the firewall should use to connect to the LDAP server (default=389 for LDAP; 636 for LDAP over SSL).
Enter the LDAP Domain name to prepend to all objects learned from the server. The value entered here depends on the specific deployment. If using Active Directory, enter the NetBIOS domain name; not a FQDN (for example, enter acme, not acme.com). Note that if collecting data from multiple domains, it is necessary to create separate server profiles. If using a global catalog server, leave this field blank.
Select the Type of LDAP server connecting to. The correct LDAP attributes in the group mapping settings will automatically be populated based on the selection.
In the Base field, select the DN that corresponds to the point in the LDAP tree where the firewall is to begin its search for user and group information.
Select (check) the SSL checkbox.
Select 'OK'.

To create an Authentication Profile using the newly created LDAP server, follow these steps:
Go to Device >> Authentication Profile.
Select 'Add' (lower left of window).
Populate the required fields as needed.
In the Authentication field, select 'LDAP'.
In the Server Profile field, select the configured LDAP server profile.
In the Login Attribute field, enter 'sAMAccountName'.
Select 'OK'.

Apply the authentication profile to the Administrator accounts.
Go to Device >> Administrators.
Select each configured account or select 'Add' (in the bottom-left corner of the pane) to create a new one.
In the 'Authentication Profile' field, enter the configured LDAP authentication profile.
Select 'OK'.
Note: The name of the administrator must match the name of the user in the LDAP server.
Note: The authentication profile should not be applied to the emergency administration account since it has special requirements.
Commit changes by selecting 'Commit' in the upper-right corner of the screen.
Select 'OK' when the confirmation dialog appears.

Note that the emergency administration account is the only account that is configured locally on the device itself."
  reference   : "800-171|3.4.2,800-171r3|03.04.02,800-171r3|03.04.02a.,800-53|CM-6b.,800-53|CM-6(1),800-53r5|CM-6b.,800-53r5|CM-6(1),CAT|II,CCI|CCI-000366,CCI|CCI-000372,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Palo_Alto_Networks_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6b.,ITSG-33|CM-6(1),NESA|T3.2.1,NIAv2|NS5f,Rule-ID|SV-228673r997692_rule,STIG-ID|PANW-NM-000136,STIG-Legacy|SV-77263,STIG-Legacy|V-62773,SWIFT-CSCv1|2.3,Vuln-ID|V-228673"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_PAN_Y24M10_STIG.zip"
</report>

<custom_item>
  type             : AUDIT_XML
  description      : "PANW-NM-000141 - The Palo Alto Networks security platform must use DoD-approved PKI rather than proprietary or self-signed device certificates."
  info             : "DoD Instruction 8520.02, Public Key Infrastructure (PKI) and Public Key (PK) Enabling mandates that certificates must be issued by the DoD PKI or by a DoD-approved PKI for authentication, digital signature, or encryption.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution         : "Obtain a Device Certificate from the DoD PKI or from a DoD-approved PKI:
Go to Device >> Certificate Management >> Certificates
Select 'Import' (at the bottom of the pane).
In the 'Import Certificate' pane, complete each field.
Select 'OK'."
  reference        : "800-171|3.4.2,800-171r3|03.04.02a.,800-53|CM-6b.,800-53|SC-17,800-53r5|CM-6b.,800-53r5|SC-17a.,CAT|II,CCI|CCI-000366,CCI|CCI-001159,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Palo_Alto_Networks_NDM_STIG,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ISO-27001-2022|A.8.24,ITSG-33|CM-6b.,ITSG-33|SC-17,ITSG-33|SC-17a.,NESA|T3.2.1,NESA|T7.4.2,NIAv2|CY5a,NIAv2|CY10,NIAv2|CY12,NIAv2|SS25,Rule-ID|SV-228674r961863_rule,STIG-ID|PANW-NM-000141,STIG-Legacy|SV-77267,STIG-Legacy|V-62777,SWIFT-CSCv1|2.3,Vuln-ID|V-228674"
  see_also         : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_PAN_Y24M10_STIG.zip"
  api_request_type : "op"
  request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
  xsl_stmt         : "<xsl:template match=\"/\">"
  xsl_stmt         : "<xsl:text>Installed Certificates:</xsl:text>"
  xsl_stmt         : "<xsl:text xml:space=\"preserve\">&#10;</xsl:text>"
  xsl_stmt         : "<xsl:text xml:space=\"preserve\">&#10;</xsl:text>"
  xsl_stmt         : "<xsl:for-each select=\"//config/shared/certificate/entry\">"
  xsl_stmt         : "<xsl:text>Certificate Name: </xsl:text><xsl:value-of select=\"@name\"/>"
  xsl_stmt         : "<xsl:text xml:space=\"preserve\">&#10;</xsl:text>"
  xsl_stmt         : "<xsl:text>Issuer: </xsl:text><xsl:value-of select=\"issuer\"/>"
  xsl_stmt         : "<xsl:text xml:space=\"preserve\">&#10;</xsl:text>"
  xsl_stmt         : "<xsl:text xml:space=\"preserve\">&#10;</xsl:text>"
  xsl_stmt         : "</xsl:for-each>"
  regex            : ""
  severity         : MEDIUM
</custom_item>

<custom_item>
  type             : AUDIT_XML
  description      : "PANW-NM-000142 - The Palo Alto Networks security platform must not use Password Profiles."
  info             : "Password profiles override settings made in the Minimum Password Complexity window.  If Password Profiles are used they can bypass password complexity requirements."
  solution         : "Go to Device >> Password Profiles
If the screen is blank (no configured Password Profiles), do nothing.

If there are configured Password Profiles, identify which accounts are using them and bring this to the attention of the ISSO immediately.
Delete the Password Profiles when authorized to make changes to the device in accordance with local change management policies."
  reference        : "800-171|3.4.2,800-171r3|03.04.02a.,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Palo_Alto_Networks_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-228675r961863_rule,STIG-ID|PANW-NM-000142,STIG-Legacy|SV-77269,STIG-Legacy|V-62779,SWIFT-CSCv1|2.3,Vuln-ID|V-228675"
  see_also         : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_PAN_Y24M10_STIG.zip"
  api_request_type : "op"
  request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
  xsl_stmt         : "<xsl:template match=\"/\">"
  xsl_stmt         : "<xsl:choose>"
  xsl_stmt         : "<xsl:when test=\"//mgt-config/password-profile/entry\">"
  xsl_stmt         : "<xsl:text>Failed - Password Profiles are configured</xsl:text>"
  xsl_stmt         : "</xsl:when>"
  xsl_stmt         : "<xsl:otherwise>"
  xsl_stmt         : "<xsl:text>Passed</xsl:text>"
  xsl_stmt         : "</xsl:otherwise>"
  xsl_stmt         : "</xsl:choose>"
  regex            : "(Failed|Passed)"
  not_expect       : "Failed"
</custom_item>

<report type:"WARNING">
  description : "PANW-NM-000143 - The Palo Alto Networks security platform must not use the default admin account password."
  info        : "To assure accountability and prevent unauthenticated access, organizational administrators must be uniquely identified and authenticated for all network management accesses to prevent potential misuse and compromise of the system.

The use of a default password for any account, especially one for administrative access, can quickly lead to a compromise of the device and subsequently, the entire enclave or system.  The 'admin' account is intended solely for the initial setup of the device and must be disabled when the device is initially configured.  The default password for this account must immediately be changed at the first login of an authorized administrator.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Go to Device >> Administrators
Select the admin user.
In the 'Old Password' field, enter 'admin'.
In the 'New Password' field, enter the new password.
In the 'Confirm New Password' field, enter the new password.
Select 'OK'.
Commit changes by selecting 'Commit' in the upper-right corner of the screen.
Select 'OK' when the confirmation dialog appears."
  reference   : "800-171|3.4.2,800-171|3.5.1,800-171r3|03.04.02a.,800-171r3|03.05.01a.,800-53|CM-6b.,800-53|IA-2,800-53r5|CM-6b.,800-53r5|IA-2,CAT|I,CCI|CCI-000366,CCI|CCI-000764,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.1.10.6(d),CN-L3|8.5.4.1(a),CSF|PR.AC-1,CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,CSF2.0|PR.PS-01,DISA_Benchmark|Palo_Alto_Networks_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO-27001-2022|A.5.16,ISO-27001-2022|A.8.9,ITSG-33|CM-6b.,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T3.2.1,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-228676r961863_rule,STIG-ID|PANW-NM-000143,STIG-Legacy|SV-77271,STIG-Legacy|V-62781,SWIFT-CSCv1|2.3,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-228676"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_PAN_Y24M10_STIG.zip"
</report>

<custom_item>
  type             : AUDIT_XML
  description      : "PANW-NM-000144 - The Palo Alto Networks security platform must generate an audit log record when the Data Plane CPU utilization is 100%."
  info             : "Auditing and logging are key components of any security architecture. Logging the actions of specific events provides a means to investigate an attack; to recognize resource utilization or capacity thresholds; or to identify an improperly configured network device. If auditing is not comprehensive, it will not be useful for intrusion monitoring, security investigations, and forensic analysis.

If the Data Plane CPU utilization is 100%, this may indicate an attack or simply an over-utilized device.  In either case, action must be taken to identify the source of the issue and take corrective action."
  solution         : "Go to Device >> Setup >> Management
In the 'Logging and Reporting Settings' pane, select the 'Edit' icon (the gear symbol in the upper-right corner of the pane).
In the 'Log Export and Reporting' tab, select the 'Enable Log on High DP Load' check box.
Select 'OK'.
Commit changes by selecting 'Commit' in the upper-right corner of the screen.
Select 'OK' when the confirmation dialog appears."
  reference        : "800-171|3.4.2,800-171r3|03.04.02a.,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Palo_Alto_Networks_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-228677r961863_rule,STIG-ID|PANW-NM-000144,STIG-Legacy|SV-77273,STIG-Legacy|V-62783,SWIFT-CSCv1|2.3,Vuln-ID|V-228677"
  see_also         : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_PAN_Y24M10_STIG.zip"
  api_request_type : "op"
  request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
  xsl_stmt         : "<xsl:template match=\"/\">"
  xsl_stmt         : "<xsl:choose>"
  xsl_stmt         : "<xsl:when test=\"not(//config/devices/entry/deviceconfig/setting/management/enable-log-high-dp-load) or not(//config/devices/entry/deviceconfig/setting/management/enable-log-high-dp-load='yes')\">"
  xsl_stmt         : "<xsl:text>Failed - Enable Log on High DP Load is not selected</xsl:text>"
  xsl_stmt         : "</xsl:when>"
  xsl_stmt         : "<xsl:otherwise>"
  xsl_stmt         : "<xsl:text>Passed</xsl:text>"
  xsl_stmt         : "</xsl:otherwise>"
  xsl_stmt         : "</xsl:choose>"
  regex            : "(Failed|Passed)"
  not_expect       : "Failed"
</custom_item>

<if>
  <condition auto:"FAILED" type:"AND">
    <custom_item>
      type             : AUDIT_XML
      description      : "'Primary NTP Server'"
      api_request_type : "op"
      request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
      xsl_stmt         : "<xsl:template match=\"/\">"
      xsl_stmt         : "<xsl:choose>"
      xsl_stmt         : "<xsl:when test=\"not(//config/devices/entry/deviceconfig/system/ntp-servers/primary-ntp-server/authentication-type/symmetric-key) and not(//config/devices/entry/deviceconfig/system/ntp-servers/primary-ntp-server/authentication-type/autokey)\">"
      xsl_stmt         : "<xsl:text>Failed - Primary NTP Server Authenication type is not Symmetric Key or AutoKey</xsl:text>"
      xsl_stmt         : "</xsl:when>"
      xsl_stmt         : "<xsl:otherwise>"
      xsl_stmt         : "<xsl:text>Passed</xsl:text>"
      xsl_stmt         : "</xsl:otherwise>"
      xsl_stmt         : "</xsl:choose>"
      regex            : "(Failed|Passed)"
      not_expect       : "Failed"
    </custom_item>

    <custom_item>
      type             : AUDIT_XML
      description      : "'Secondary NTP Server'"
      api_request_type : "op"
      request          : "<show><config><@CONFIG_TYPE@></@CONFIG_TYPE@></config></show>"
      xsl_stmt         : "<xsl:template match=\"/\">"
      xsl_stmt         : "<xsl:choose>"
      xsl_stmt         : "<xsl:when test=\"not(//config/devices/entry/deviceconfig/system/ntp-servers/secondary-ntp-server/authentication-type/symmetric-key) and not(//config/devices/entry/deviceconfig/system/ntp-servers/secondary-ntp-server/authentication-type/autokey)\">"
      xsl_stmt         : "<xsl:text>Failed - Secondary NTP Server Authenication type is not Symmetric Key or AutoKey</xsl:text>"
      xsl_stmt         : "</xsl:when>"
      xsl_stmt         : "<xsl:otherwise>"
      xsl_stmt         : "<xsl:text>Passed</xsl:text>"
      xsl_stmt         : "</xsl:otherwise>"
      xsl_stmt         : "</xsl:choose>"
      regex            : "(Failed|Passed)"
      not_expect       : "Failed"
    </custom_item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "PANW-NM-000145 - The Palo Alto Networks security platform must authenticate Network Time Protocol sources"
      info        : "If Network Time Protocol is not authenticated, an attacker can introduce a rogue NTP server.  This rogue server can then be used to send incorrect time information to network devices, which will make log timestamps inaccurate and affected scheduled actions.  NTP authentication is used to prevent this tampering by authenticating the time source."
      solution    : "Go to Device >> Setup >> Services
Select the 'Edit' icon (the gear symbol in the upper-right corner of the pane).
In the 'Services' window, in the NTP tab, in the 'Primary NTP Server Address' field and the 'Secondary NTP Server Address' field, enter the IP address or hostname of the NTP servers.

In the 'Authentication Type' field, select one of the following:
Symmetric Key; this option uses symmetric key exchange, which are shared secrets. Enter the key ID, algorithm, authentication key, and confirm the authentication key; for the algorithm, select 'SHA1'.
Autokey; this option uses auto key, or public key cryptography.
Commit changes by selecting 'Commit' in the upper-right corner of the screen.
Select 'OK' when the confirmation dialog appears."
      reference   : "800-171r3|03.05.02,800-53|IA-3(1),800-53r5|IA-3(1),CAT|II,CCI|CCI-001967,CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|Palo_Alto_Networks_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-3(1),NESA|T5.4.3,QCSC-v1|13.2,Rule-ID|SV-228678r961506_rule,STIG-ID|PANW-NM-000145,STIG-Legacy|SV-77275,STIG-Legacy|V-62785,TBA-FIISB|27.1,Vuln-ID|V-228678"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_PAN_Y24M10_STIG.zip"
      show_output : YES
    </report>
  </then>
</if>

</check_type>
