#TRUSTED 4f67f43d10d99e38025abfc373a2297ad65662b03645d5b80e2811b378c273e2b7de9cac6fdde611d8bbfcdab12e297157fe009fbad3b185377f691c89d1ddc7e9ca86c14c7dc8af3e33316a73cb2ab75afcaca20f03aa93a24a9c825d544602ed2ff4af2f8dfb46baad8de71bcef71d141693ee82b9cbea9b1659b51b0a88c4391fae86206ec7ca339981d97ff47c80e80fb870b2ed747930ae6e34f97354545f1a0d411d8ac178dad28fc850f6159ebdceed80d9ea57eebcc2cc53610c1c3d48898c5140560f056c1e2f50d9a811b3cbb03812c604ac054e2a7933fb5e6b2e1ed962268e5146bcc79988d87458a09c1a7e32eeead139b94b68df12eddc7e4201e875f6c9bf5a68e0bc29b15292223f98b4c0560499e10d7eb853b7ea3cc8aa7c493b7262efab89c3c24b165c5d57545296c5a2c26f32414306946389e18f82032e97405e9defe5cbc362c4cf06b10b54e159dfc62b98ac773daf219d0887847479a2257f9cea3c311a2659651696ec48dd2af71139958c7739d394061d2225fd9c96bda3849719aed7bc7e5b8b6b0c13de7df9226e757dd0e5613ffaa54339a4765cde91a347335488b1b1f9831f1ad86cf1d99bd8817d457fe77561ad0ff387789b122182290febb635e59c3710a3833d3f2aa631dfc7b0b17be459f6ad2c1f77dfcc1d6f86108b1b752d240ac980b2c28b5b301ae04b38ca1735cbe45b42
#TRUST-RSA-SHA256 a69f584dd4e188f96bd71a61f9979aa611f97bb9c7f380fe5ed6f58ad419ceb41ee61737a9508ecb285e885278ee4918f28c19e1bef058559ab5c61b80abe24be20b8f4fa4bfc32bc1738cff0a052bdc7c0c71e65d3e10cb894bf9f30b53e1024d199b2feebc83090181ded978f0ba3cb3813339f95b75e2f7b18ffa013e42b7afae69ef1322567fc2c1831df50b7cf27e4f0add3775007185a91a727246d26a62e958a3fb17e272a377a031de5f18a0cbe673bdf12b624b9976019eb2b8113922976905e3e89a67dac3df792e3223781b29543c5b7c730132ef1428b52aa50b0674fbe39d6622dfc4d1ee60e88fa7841598c62416d8882118b255b5931d4280e781f8091fcd42071426efaf1dff6ba3a2a94816396ef5bf93362f9e25d1403aa381d0005e8af16ffc79a4b79371c8db369b89383542a9a3e96b87d6731a447beda60209108e36766728513fae5d34b82fb61c7806a6613997d46e7e595ec0588dd88edde2d0c474631c563fee91ec43773a63beb0dfb8d8986609c620a47b1ab9758294f967f996838f2a21fa304f1830076200e3017a63f5a4b64dfb92818b6e9940fea67963758228401c8bb8a78bad1c082a173b85df37dafa7278eb3f9127776ab2158ecca87afce7bc8f9a7dd42dd79a8cd1ff93527ee56daadeb90fe6d4d351fb483c66ffbc7a50723585ef1db4233f723bf7c7bbcaab6322e7a7eb72
#
# This script is Copyright (C) 2004-2024 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
#
# $Revision: 1.5 $
# $Date: 2024/06/17 $
#
# description	: Tenable Best Practices for Microsoft Intune Windows v1.0 audit
#
#<ui_metadata>
#<display_name>Tenable Best Practices for Microsoft Intune Windows v1.0</display_name>
#<spec>
#  <type>TNS</type>
#  <name>Tenable Best Practices for Microsoft Intune</name>
#  <profile>OS Windows</profile>
#  <version>1.0.0</version>
#  <link>https://docs.microsoft.com/en-us/mem/intune/</link>
#</spec>
#<labels>microsoft,azure,cloud,intune,windows,update_20230227</labels>
#</ui_metadata>

<check_type:"microsoft_azure">

<custom_item>
  description    : "Windows Compliance Policy - Require a password to unlock mobile devices"
  info           : "This control determines whether a password is required before allowing access to the device via the touch screen."
  solution       : "From the Intune console, open the compliance policy. Under 'System Security' verify that 'Require a password to unlock mobile devices' is set to 'Require'."
  reference      : "800-171|3.1.18,800-171|3.5.2,800-53|AC-19,800-53|IA-5,800-53r5|AC-19,800-53r5|IA-5,CSF|PR.AC-1,CSF|PR.AC-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|IA-5,NESA|T5.2.3,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2"
  see_also       : "https://docs.microsoft.com/en-us/mem/intune/"
  request        : "listDeviceCompliancePolicies"
  json_transform : '.[] | select(.["@odata.type"] | test("windows10CompliancePolicy")) | "Display Name: \(.displayName) - Password Required: \(.passwordRequired)"'
  regex          : "Password Required:"
  expect         : "Password Required: true"
  match_all      : YES
</custom_item>

<custom_item>
  description    : "Windows Compliance Policy - Required password type"
  info           : "This control determines whether alphanumeric passcode is required."
  solution       : "From the Intune console, open the compliance profile. Under 'System Security' verify that 'Required Password Type' is set to 'Alphanumeric'."
  reference      : "800-171|3.1.18,800-171|3.5.7,800-53|AC-19,800-53|IA-5(1)(a),800-53r5|AC-19,800-53r5|IA-5(1)(a),CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,CSF|PR.AC-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.6.2.1,ISO/IEC-27001|A.9.4.3,ITSG-33|AC-19,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4"
  see_also       : "https://docs.microsoft.com/en-us/mem/intune/"
  request        : "listDeviceCompliancePolicies"
  json_transform : '.[] | select(.["@odata.type"] | test("windows10CompliancePolicy")) | "Display Name: \(.displayName) - Required Password Type: \(.passwordRequiredType)"'
  regex          : "Required Password Type:"
  expect         : "Required Password Type: alphanumeric"
  match_all      : YES
</custom_item>

<custom_item>
  description    : "Windows Compliance Policy - Maximum minutes of inactivity before password is required"
  info           : "This control determines the amount of idle time before the screen will lock and reentry of the passcode is required."
  solution       : "From the Intune console, open the compliance profile. Under 'System Security' verify that the 'Maximum Minutes of Inactivity Before Password is Required' is set to 5 or less."
  reference      : "800-171|3.1.10,800-171|3.1.18,800-53|AC-11,800-53|AC-19,800-53r5|AC-11,800-53r5|AC-19,CN-L3|8.1.4.1(b),CSF|PR.AC-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.6.2.1,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11,ITSG-33|AC-19,NIAv2|AM23c,NIAv2|AM23d,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2"
  see_also       : "https://docs.microsoft.com/en-us/mem/intune/"
  request        : "listDeviceCompliancePolicies"
  json_transform : '.[] | select(.["@odata.type"] | test("windows10CompliancePolicy")) | "Display Name: \(.displayName) - Inactivity minutes: \(.passwordMinutesOfInactivityBeforeLock)"'
  regex          : "Inactivity minutes:"
  expect         : "Inactivity minutes: [1-5]$"
  match_all      : YES
</custom_item>

<custom_item>
  description    : "Windows Compliance Policy - Password expiration (days)"
  info           : "This control determines the maximum age of a password."
  solution       : "From the Intune console, open the compliance profile. Under 'System Security' verify that 'Number of Days Until Password expires' is set to 90 or less."
  reference      : "800-171|3.1.18,800-171|3.5.2,800-53|AC-19,800-53|IA-5(1)(d),800-53r5|AC-19,800-53r5|IA-5(1)(d),CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,CSF|PR.AC-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.6.2.1,ISO/IEC-27001|A.9.4.3,ITSG-33|AC-19,ITSG-33|IA-5(1)(d),NESA|T5.2.3,NIAv2|AM20,NIAv2|AM21,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.2"
  see_also       : "https://docs.microsoft.com/en-us/mem/intune/"
  request        : "listDeviceCompliancePolicies"
  json_transform : '.[] | select(.["@odata.type"] | test("windows10CompliancePolicy")) | "Display Name: \(.displayName) - Password expiration: \(.passwordExpirationDays)"'
  regex          : "Password expiration:"
  expect         : "Password expiration: ([1-9]|[1-8][0-9]|90)$"
  match_all      : YES
</custom_item>

<custom_item>
  description    : "Windows Compliance Policy - Minimum password length"
  info           : "This control determines whether a minimum length password is required. It is recommended that a passcode of 5 or more be set."
  solution       : "From the Intune console, open the compliance profile. Under 'System Security' verify that 'Minimum Password Length' is configured correctly."
  reference      : "800-171|3.1.18,800-171|3.5.7,800-53|AC-19,800-53|IA-5(1)(a),800-53r5|AC-19,800-53r5|IA-5(1)(a),CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,CSF|PR.AC-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.6.2.1,ISO/IEC-27001|A.9.4.3,ITSG-33|AC-19,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4"
  see_also       : "https://docs.microsoft.com/en-us/mem/intune/"
  request        : "listDeviceCompliancePolicies"
  json_transform : '.[] | select(.["@odata.type"] | test("windows10CompliancePolicy")) | "Display Name: \(.displayName) - Minimum password length: \(.passwordMinimumLength)"'
  regex          : "Minimum password length:"
  expect         : "Minimum password length: ([5-9]|[1-9][0-9])$"
  match_all      : YES
</custom_item>

<custom_item>
  description    : "Windows Compliance Policy - Number of previous passwords to prevent reuse"
  info           : "This control determines the number of allowed previous passwords."
  solution       : "From the Intune console, open the compliance profile. Under 'System Security' verify that 'Number of previous passwords to prevent reuse' is configured to 5 or more."
  reference      : "800-171|3.1.18,800-171|3.5.8,800-53|AC-19,800-53|IA-5(1)(e),800-53r5|AC-19,800-53r5|IA-5(1)(e),CSF|PR.AC-1,CSF|PR.AC-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.6.2.1,ISO/IEC-27001|A.9.4.3,ITSG-33|AC-19,ITSG-33|IA-5(1)(e),NESA|T5.2.3,NIAv2|AM22c,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.3"
  see_also       : "https://docs.microsoft.com/en-us/mem/intune/"
  request        : "listDeviceCompliancePolicies"
  json_transform : '.[] | select(.["@odata.type"] | test("windows10CompliancePolicy")) | "Display Name: \(.displayName) - Number of previous passwords: \(.passwordPreviousPasswordBlockCount)"'
  regex          : "Number of previous passwords:"
  expect         : "Number of previous passwords: ([5-9]|[1-9][0-9])$"
  match_all      : YES
</custom_item>

<custom_item>
  description    : "Windows Compliance Policy - Encryption of data storage on device"
  info           : "This control determines whether encryption is required on the device."
  solution       : "From the Intune console, open the compliance profile. Under 'System Security' verify that 'Encryption of data storage on device' is set to 'Require'."
  reference      : "800-171|3.1.19,800-53|AC-19(5),800-53r5|AC-19(5),CSF|PR.AC-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,NIAv2|OS5,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2"
  see_also       : "https://docs.microsoft.com/en-us/mem/intune/"
  request        : "listDeviceCompliancePolicies"
  json_transform : '.[] | select(.["@odata.type"] | test("windows10CompliancePolicy")) | "Display Name: \(.displayName) - Encryption of data storage on device: \(.storageRequireEncryption)"'
  regex          : "Encryption of data storage on device:"
  expect         : "Encryption of data storage on device: true"
  match_all      : YES
</custom_item>

<custom_item>
  description    : "Windows Compliance Policy - Block USB debugging on device"
  info           : "This control determines whether use of USB Debugging is allowed."
  solution       : "From the Intune console, open the compliance profile. Under 'System Security' verify that 'Block USB debugging on device' is set to 'Block'."
  reference      : "800-171|3.1.18,800-171|3.4.6,800-171|3.4.7,800-53|AC-19,800-53|CM-7b.,800-53r5|AC-19,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|2.3"
  see_also       : "https://docs.microsoft.com/en-us/mem/intune/"
  request        : "listDeviceCompliancePolicies"
  json_transform : '.[] | select(.["@odata.type"] | test("windows10CompliancePolicy")) | "Display Name: \(.displayName) - Block USB debugging on device: \(.storageRequireEncryption)"'
  regex          : "Block USB debugging on device:"
  expect         : "Block USB debugging on device: true"
  match_all      : YES
</custom_item>

<custom_item>
  description    : "Windows Device Configuration - Camera"
  info           : "This control determines whether the camera is allowed."
  solution       : "From the Intune console, open the device configuration profile. Under 'General' verify that 'Camera' is set to 'Block'."
  reference      : "800-171|3.1.18,800-171|3.4.6,800-171|3.4.7,800-53|AC-19,800-53|CM-7b.,800-53r5|AC-19,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|2.3"
  see_also       : "https://docs.microsoft.com/en-us/mem/intune/"
  request        : "listDeviceManagement"
  json_transform : '.[] | select(.["@odata.type"] | test("windows10GeneralConfiguration")) | "Display Name: \(.displayName) - Block Camera: \(.cameraBlocked)"'
  regex          : "Block Camera:"
  expect         : "Block Camera: true"
  match_all      : YES
</custom_item>

<custom_item>
  description    : "Windows Device Configuration - Password"
  info           : "This control determines whether a password is required before allowing access to the device via the touch screen."
  solution       : "From the Intune console, open the device configuration policy. Under 'Password' verify that 'Password' is set to 'Require'."
  reference      : "800-171|3.1.18,800-171|3.5.2,800-53|AC-19,800-53|IA-5,800-53r5|AC-19,800-53r5|IA-5,CSF|PR.AC-1,CSF|PR.AC-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|IA-5,NESA|T5.2.3,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2"
  see_also       : "https://docs.microsoft.com/en-us/mem/intune/"
  request        : "listDeviceManagement"
  json_transform : '.[] | select(.["@odata.type"] | test("windows10GeneralConfiguration")) | "Display Name: \(.displayName) - Password Required: \(.passwordRequired)"'
  regex          : "Password Required:"
  expect         : "Password Required: true"
  match_all      : YES
</custom_item>

<custom_item>
  description    : "Windows Device Configuration - Maximum minutes of inactivity until screen locks"
  info           : "This control determines the amount of idle time before the screen will lock and reentry of the passcode is required."
  solution       : "From the Intune console, open the device configuration profile. Under 'Password' verify that the 'Maximum minutes of inactivity until screen locks' is set to 5 or less."
  reference      : "800-171|3.1.10,800-171|3.1.18,800-53|AC-11,800-53|AC-19,800-53r5|AC-11,800-53r5|AC-19,CN-L3|8.1.4.1(b),CSF|PR.AC-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.6.2.1,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11,ITSG-33|AC-19,NIAv2|AM23c,NIAv2|AM23d,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2"
  see_also       : "https://docs.microsoft.com/en-us/mem/intune/"
  request        : "listDeviceManagement"
  json_transform : '.[] | select(.["@odata.type"] | test("windows10GeneralConfiguration")) | "Display Name: \(.displayName) - Inactivity minutes: \(.passwordMinutesOfInactivityBeforeScreenTimeout)"'
  regex          : "Inactivity minutes:"
  expect         : "Inactivity minutes: [1-5]$"
  match_all      : YES
</custom_item>

<custom_item>
  description    : "Windows Device Configuration - Password expiration (days)"
  info           : "This control determines the maximum age of a password."
  solution       : "From the Intune console, open the device configuration profile. Under 'Password' verify that 'Password expiration (days)' is set to 90 or less."
  reference      : "800-171|3.1.18,800-171|3.5.2,800-53|AC-19,800-53|IA-5(1)(d),800-53r5|AC-19,800-53r5|IA-5(1)(d),CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,CSF|PR.AC-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.6.2.1,ISO/IEC-27001|A.9.4.3,ITSG-33|AC-19,ITSG-33|IA-5(1)(d),NESA|T5.2.3,NIAv2|AM20,NIAv2|AM21,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.2"
  see_also       : "https://docs.microsoft.com/en-us/mem/intune/"
  request        : "listDeviceManagement"
  json_transform : '.[] | select(.["@odata.type"] | test("windows10GeneralConfiguration")) | "Display Name: \(.displayName) - Password expiration: \(.passwordExpirationDays)"'
  regex          : "Password expiration:"
  expect         : "Password expiration: ([1-9]|[1-8][0-9]|90)$"
  match_all      : YES
</custom_item>

<custom_item>
  description    : "Windows Device Configuration - Required password type"
  info           : "This control determines whether alphanumeric passcode is required."
  solution       : "From the Intune console, open the device configuration profile. Under 'Password' verify that 'Required Password Type' is set to 'At least alphanumeric with symbols'."
  reference      : "800-171|3.1.18,800-171|3.5.7,800-53|AC-19,800-53|IA-5(1)(a),800-53r5|AC-19,800-53r5|IA-5(1)(a),CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,CSF|PR.AC-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.6.2.1,ISO/IEC-27001|A.9.4.3,ITSG-33|AC-19,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4"
  see_also       : "https://docs.microsoft.com/en-us/mem/intune/"
  request        : "listDeviceManagement"
  json_transform : '.[] | select(.["@odata.type"] | test("windows10GeneralConfiguration")) | "Display Name: \(.displayName) - Required password type: \(.passwordRequiredType)"'
  regex          : "Required password type:"
  expect         : "Required password type: alphanumeric"
  match_all      : YES
</custom_item>

<custom_item>
  description    : "Windows Device Configuration - NFC"
  info           : "This control determines whether NFC is allowed."
  solution       : "From the Intune console, open the device configuration profile. Under 'Cellular and connectivity' verify that 'NFC' is set to 'Block'."
  reference      : "800-171|3.1.18,800-171|3.4.6,800-171|3.4.7,800-53|AC-19,800-53|CM-7b.,800-53r5|AC-19,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|2.3"
  see_also       : "https://docs.microsoft.com/en-us/mem/intune/"
  request        : "listDeviceManagement"
  json_transform : '.[] | select(.["@odata.type"] | test("windows10GeneralConfiguration")) | "Display Name: \(.displayName) - Block NFC: \(.nfcBlocked)"'
  regex          : "Block NFC:"
  expect         : "Block NFC: true"
  match_all      : YES
</custom_item>

<custom_item>
  description    : "Windows Device Configuration - Browser Pop-ups"
  info           : "This control determines whether Pop-Ups are allowed."
  solution       : "From the Intune console, open the device configuration profile. Under 'Microsoft Edge Browser' verify that 'Allow pop-ups' is set to 'No'."
  reference      : "800-171|3.1.18,800-171|3.4.6,800-171|3.4.7,800-53|AC-19,800-53|CM-7b.,800-53r5|AC-19,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|2.3"
  see_also       : "https://docs.microsoft.com/en-us/mem/intune/"
  request        : "listDeviceManagement"
  json_transform : '.[] | select(.["@odata.type"] | test("windows10GeneralConfiguration")) | "Display Name: \(.displayName) - Block Browser Pop-ups: \(.edgeBlockPopups)"'
  regex          : "Block Browser Pop-ups:"
  expect         : "Block Browser Pop-ups: true"
  match_all      : YES
</custom_item>

<custom_item>
  description    : "Windows Device Configuration - Browser Autofill"
  info           : "This control determines whether autofill is allowed."
  solution       : "From the Intune console, open the device configuration profile. Under 'Microsoft Edge Browser' verify that 'Allow Autofill in forms' is set to 'No'."
  reference      : "800-171|3.1.18,800-171|3.4.6,800-171|3.4.7,800-53|AC-19,800-53|CM-7b.,800-53r5|AC-19,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|2.3"
  see_also       : "https://docs.microsoft.com/en-us/mem/intune/"
  request        : "listDeviceManagement"
  json_transform : '.[] | select(.["@odata.type"] | test("windows10GeneralConfiguration")) | "Display Name: \(.displayName) - Block Browser Autofill: \(.edgeBlockAutofill)"'
  regex          : "Block Browser Autofill:"
  expect         : "Block Browser Autofill: true"
  match_all      : YES
</custom_item>

<custom_item>
  description    : "Windows Device Configuration - Removable storage"
  info           : "This control determines whether removable storage is allowed."
  solution       : "From the Intune console, open the device configuration profile. Under 'General' verify that 'Removable storage' is set to 'Block'."
  reference      : "800-171|3.1.18,800-171|3.4.6,800-171|3.4.7,800-53|AC-19,800-53|CM-7b.,800-53r5|AC-19,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|2.3"
  see_also       : "https://docs.microsoft.com/en-us/mem/intune/"
  request        : "listDeviceManagement"
  json_transform : '.[] | select(.["@odata.type"] | test("windows10GeneralConfiguration")) | "Display Name: \(.displayName) - Block Removable storage: \(.storageBlockRemovableStorage)"'
  regex          : "Block Removable storage:"
  expect         : "Block Removable storage: true"
  match_all      : YES
</custom_item>

<custom_item>
  description    : "Windows Device Configuration - OneDrive file sync"
  info           : "This control determines whether OneDrive file sync is allowed."
  solution       : "From the Intune console, open the device configuration profile. Under 'General' verify that 'OneDrive file sync' is set to 'Block'."
  reference      : "800-171|3.1.18,800-171|3.4.6,800-171|3.4.7,800-53|AC-19,800-53|CM-7b.,800-53r5|AC-19,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|2.3"
  see_also       : "https://docs.microsoft.com/en-us/mem/intune/"
  request        : "listDeviceManagement"
  json_transform : '.[] | select(.["@odata.type"] | test("windows10GeneralConfiguration")) | "Display Name: \(.displayName) - Block OneDrive file sync: \(.oneDriveDisableFileSync)"'
  regex          : "Block OneDrive file sync:"
  expect         : "Block OneDrive file sync: true"
  match_all      : YES
</custom_item>

<custom_item>
  description    : "Windows Device Configuration - Geolocation"
  info           : "This control determines whether Geolocation is allowed."
  solution       : "From the Intune console, open the device configuration profile. Under 'General' verify that 'Geolocation' is set to 'Block'."
  reference      : "800-171|3.1.18,800-171|3.4.6,800-171|3.4.7,800-53|AC-19,800-53|CM-7b.,800-53r5|AC-19,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|2.3"
  see_also       : "https://docs.microsoft.com/en-us/mem/intune/"
  request        : "listDeviceManagement"
  json_transform : '.[] | select(.["@odata.type"] | test("windows10GeneralConfiguration")) | "Display Name: \(.displayName) - Block Geolocation: \(.locationServicesBlocked)"'
  regex          : "Block Geolocation:"
  expect         : "Block Geolocation: true"
  match_all      : YES
</custom_item>

<custom_item>
  description    : "Windows Device Configuration - Internet sharing"
  info           : "This control determines whether Internet sharing is allowed."
  solution       : "From the Intune console, open the device configuration profile. Under 'General' verify that 'Internet sharing' is set to 'Block'."
  reference      : "800-171|3.1.18,800-171|3.4.6,800-171|3.4.7,800-53|AC-19,800-53|CM-7b.,800-53r5|AC-19,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|2.3"
  see_also       : "https://docs.microsoft.com/en-us/mem/intune/"
  request        : "listDeviceManagement"
  json_transform : '.[] | select(.["@odata.type"] | test("windows10GeneralConfiguration")) | "Display Name: \(.displayName) - Block Internet sharing: \(.internetSharingBlocked)"'
  regex          : "Block Internet sharing:"
  expect         : "Block Internet sharing: true"
  match_all      : YES
</custom_item>

<custom_item>
  description    : "Windows Device Configuration - USB connection"
  info           : "This control determines whether USB connection is allowed."
  solution       : "From the Intune console, open the device configuration profile. Under 'General' verify that 'USB connection' is set to 'Block'."
  reference      : "800-171|3.1.18,800-171|3.4.6,800-171|3.4.7,800-53|AC-19,800-53|CM-7b.,800-53r5|AC-19,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|2.3"
  see_also       : "https://docs.microsoft.com/en-us/mem/intune/"
  request        : "listDeviceManagement"
  json_transform : '.[] | select(.["@odata.type"] | test("windows10GeneralConfiguration")) | "Display Name: \(.displayName) - Block USB connection: \(.usbBlocked)"'
  regex          : "Block USB connection:"
  expect         : "Block USB connection: true"
  match_all      : YES
</custom_item>

<custom_item>
  description    : "Windows Device Configuration - Device name modification"
  info           : "This control determines whether Device name modification is allowed."
  solution       : "From the Intune console, open the device configuration profile. Under 'General' verify that 'Device name modification' is set to 'Block'."
  reference      : "800-171|3.1.18,800-171|3.4.6,800-171|3.4.7,800-53|AC-19,800-53|CM-7b.,800-53r5|AC-19,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|2.3"
  see_also       : "https://docs.microsoft.com/en-us/mem/intune/"
  request        : "listDeviceManagement"
  json_transform : '.[] | select(.["@odata.type"] | test("windows10GeneralConfiguration")) | "Display Name: \(.displayName) - Block Device name modification: \(.settingsBlockEditDeviceName)"'
  regex          : "Block Device name modification:"
  expect         : "Block Device name modification: true"
  match_all      : YES
</custom_item>

<custom_item>
  description    : "Windows Device Configuration - Device discovery"
  info           : "This control determines whether Device discovery is allowed."
  solution       : "From the Intune console, open the device configuration profile. Under 'General' verify that 'Device discovery' is set to 'Block'."
  reference      : "800-171|3.1.18,800-171|3.4.6,800-171|3.4.7,800-53|AC-19,800-53|CM-7b.,800-53r5|AC-19,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|2.3"
  see_also       : "https://docs.microsoft.com/en-us/mem/intune/"
  request        : "listDeviceManagement"
  json_transform : '.[] | select(.["@odata.type"] | test("windows10GeneralConfiguration")) | "Display Name: \(.displayName) - Block Device discovery: \(.experienceBlockDeviceDiscovery)"'
  regex          : "Block Device discovery:"
  expect         : "Block Device discovery: true"
  match_all      : YES
</custom_item>

<custom_item>
  description    : "Windows Device Configuration - Network Inspection System"
  info           : "This control determines whether Network Inspection System is allowed."
  solution       : "From the Intune console, open the device configuration profile. Under 'Microsoft Defender Antivirus' verify that 'Network Inspection System' is set to 'Enable'."
  reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3"
  see_also       : "https://docs.microsoft.com/en-us/mem/intune/"
  request        : "listDeviceManagement"
  json_transform : '.[] | select(.["@odata.type"] | test("windows10GeneralConfiguration")) | "Display Name: \(.displayName) - Enable Network Inspection System: \(.defenderRequireNetworkInspectionSystem)"'
  regex          : "Enable Network Inspection System:"
  expect         : "Enable Network Inspection System: true"
  match_all      : YES
</custom_item>

<custom_item>
  description    : "Windows Device Configuration - Behavior monitoring"
  info           : "This control determines whether Behavior monitoring is allowed."
  solution       : "From the Intune console, open the device configuration profile. Under 'Microsoft Defender Antivirus' verify that 'Behavior monitoring' is set to 'Enable'."
  reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3"
  see_also       : "https://docs.microsoft.com/en-us/mem/intune/"
  request        : "listDeviceManagement"
  json_transform : '.[] | select(.["@odata.type"] | test("windows10GeneralConfiguration")) | "Display Name: \(.displayName) - Enable Behavior monitoring: \(.defenderRequireBehaviorMonitoring)"'
  regex          : "Enable Behavior monitoring:"
  expect         : "Enable Behavior monitoring: true"
  match_all      : YES
</custom_item>

<custom_item>
  description    : "Windows Device Configuration - Real-time monitoring"
  info           : "This control determines whether Real-time monitoring is allowed."
  solution       : "From the Intune console, open the device configuration profile. Under 'Microsoft Defender Antivirus' verify that 'Real-time monitoring' is set to 'Enable'."
  reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3"
  see_also       : "https://docs.microsoft.com/en-us/mem/intune/"
  request        : "listDeviceManagement"
  json_transform : '.[] | select(.["@odata.type"] | test("windows10GeneralConfiguration")) | "Display Name: \(.displayName) - Enable Real-time monitoring: \(.defenderRequireRealTimeMonitoring)"'
  regex          : "Enable Real-time monitoring:"
  expect         : "Enable Real-time monitoring: true"
  match_all      : YES
</custom_item>

<custom_item>
  description    : "Windows Device Configuration - Scan all downloads"
  info           : "This control determines whether Scan all downloads is allowed."
  solution       : "From the Intune console, open the device configuration profile. Under 'Microsoft Defender Antivirus' verify that 'Scan all downloads' is set to 'Enable'."
  reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3"
  see_also       : "https://docs.microsoft.com/en-us/mem/intune/"
  request        : "listDeviceManagement"
  json_transform : '.[] | select(.["@odata.type"] | test("windows10GeneralConfiguration")) | "Display Name: \(.displayName) - Enable Scan all downloads: \(.defenderScanDownloads)"'
  regex          : "Enable Scan all downloads:"
  expect         : "Enable Scan all downloads: true"
  match_all      : YES
</custom_item>

<custom_item>
  description    : "Windows Device Configuration - Scan scripts loaded in Microsoft web browsers"
  info           : "This control determines whether Scan scripts loaded in Microsoft web browsers is allowed."
  solution       : "From the Intune console, open the device configuration profile. Under 'Microsoft Defender Antivirus' verify that 'Scan scripts loaded in Microsoft web browsers' is set to 'Enable'."
  reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3"
  see_also       : "https://docs.microsoft.com/en-us/mem/intune/"
  request        : "listDeviceManagement"
  json_transform : '.[] | select(.["@odata.type"] | test("windows10GeneralConfiguration")) | "Display Name: \(.displayName) - Enable Scan scripts loaded in Microsoft web browsers: \(.defenderScanScriptsLoadedInInternetExplorer)"'
  regex          : "Enable Scan scripts loaded in Microsoft web browsers:"
  expect         : "Enable Scan scripts loaded in Microsoft web browsers: true"
  match_all      : YES
</custom_item>

<custom_item>
  description    : "Windows Device Configuration - End-user access to Defender"
  info           : "This control determines whether End-user access to Defender is allowed."
  solution       : "From the Intune console, open the device configuration profile. Under 'Microsoft Defender Antivirus' verify that 'End-user access to Defender' is set to 'Block'."
  reference      : "800-171|3.1.18,800-171|3.4.6,800-171|3.4.7,800-53|AC-19,800-53|CM-7b.,800-53r5|AC-19,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|2.3"
  see_also       : "https://docs.microsoft.com/en-us/mem/intune/"
  request        : "listDeviceManagement"
  json_transform : '.[] | select(.["@odata.type"] | test("windows10GeneralConfiguration")) | "Display Name: \(.displayName) - Block End-user access to Defender: \(.defenderBlockEndUserAccess)"'
  regex          : "Block End-user access to Defender:"
  expect         : "Block End-user access to Defender: true"
  match_all      : YES
</custom_item>

<custom_item>
  description    : "Windows Device Configuration - Monitor file and program activity"
  info           : "This control determines whether Monitor file and program activity is allowed."
  solution       : "From the Intune console, open the device configuration profile. Under 'Microsoft Defender Antivirus' verify that 'Monitor file and program activity' is set to 'Monitor all files'."
  reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3"
  see_also       : "https://docs.microsoft.com/en-us/mem/intune/"
  request        : "listDeviceManagement"
  json_transform : '.[] | select(.["@odata.type"] | test("windows10GeneralConfiguration")) | "Display Name: \(.displayName) - Monitor file and program activity: \(.defenderMonitorFileActivity)"'
  regex          : "Monitor file and program activity:"
  expect         : "Monitor file and program activity: monitorAllFiles"
  match_all      : YES
</custom_item>

<custom_item>
  description    : "Windows Device Configuration - Scan archive file"
  info           : "This control determines whether Scan archive file is allowed."
  solution       : "From the Intune console, open the device configuration profile. Under 'Microsoft Defender Antivirus' verify that 'Scan archive file' is set to 'Enable'."
  reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3"
  see_also       : "https://docs.microsoft.com/en-us/mem/intune/"
  request        : "listDeviceManagement"
  json_transform : '.[] | select(.["@odata.type"] | test("windows10GeneralConfiguration")) | "Display Name: \(.displayName) - Enable Scan archive file: \(.defenderScanArchiveFiles)"'
  regex          : "Enable Scan archive file:"
  expect         : "Enable Scan archive file: true"
  match_all      : YES
</custom_item>

<custom_item>
  description    : "Windows Device Configuration - Scan incoming mail messages"
  info           : "This control determines whether Scan incoming mail messages is allowed."
  solution       : "From the Intune console, open the device configuration profile. Under 'Microsoft Defender Antivirus' verify that 'Scan incoming mail messages' is set to 'Enable'."
  reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3"
  see_also       : "https://docs.microsoft.com/en-us/mem/intune/"
  request        : "listDeviceManagement"
  json_transform : '.[] | select(.["@odata.type"] | test("windows10GeneralConfiguration")) | "Display Name: \(.displayName) - Enable Scan incoming mail messages: \(.defenderScanIncomingMail)"'
  regex          : "Enable Scan incoming mail messages:"
  expect         : "Enable Scan incoming mail messages: true"
  match_all      : YES
</custom_item>

<custom_item>
  description    : "Windows Device Configuration - Cloud-delivered protection"
  info           : "This control determines whether Cloud-delivered protection is allowed."
  solution       : "From the Intune console, open the device configuration profile. Under 'Microsoft Defender Antivirus' verify that 'Cloud-delivered protection' is set to 'Enable'."
  reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3"
  see_also       : "https://docs.microsoft.com/en-us/mem/intune/"
  request        : "listDeviceManagement"
  json_transform : '.[] | select(.["@odata.type"] | test("windows10GeneralConfiguration")) | "Display Name: \(.displayName) - Enable Cloud-delivered protection: \(.defenderRequireCloudProtection)"'
  regex          : "Enable Cloud-delivered protection:"
  expect         : "Enable Cloud-delivered protection: true"
  match_all      : YES
</custom_item>

<custom_item>
  description    : "Windows Device Configuration - File Blocking Level"
  info           : "This control determines whether File Blocking Level is set to High."
  solution       : "From the Intune console, open the device configuration profile. Under 'Microsoft Defender Antivirus' verify that 'File Blocking Level' is set to 'High'."
  reference      : "800-171|3.14.6,800-171|3.14.7,800-53|SI-4(4),800-53r5|SI-4(4),CN-L3|7.1.2.2(c),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|RS.AN-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|SI-4(4),NESA|M1.2.2,NIAv2|NS32,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,SWIFT-CSCv1|6.5"
  see_also       : "https://docs.microsoft.com/en-us/mem/intune/"
  request        : "listDeviceManagement"
  json_transform : '.[] | select(.["@odata.type"] | test("windows10GeneralConfiguration")) | "Display Name: \(.displayName) - File Blocking Level: \(.defenderCloudBlockLevel)"'
  regex          : "File Blocking Level:"
  expect         : "File Blocking Level: high"
  match_all      : YES
</custom_item>

<custom_item>
  description    : "Windows Device Configuration - Screen timeout"
  info           : "This control determines whether Screen timeout is allowed."
  solution       : "From the Intune console, open the device configuration profile. Under 'Locked Screen Experience' verify that 'Screen timeout' is set to is set to 60 or less."
  reference      : "800-171|3.1.18,800-53|AC-19,800-53r5|AC-19,CSF|PR.AC-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2"
  see_also       : "https://docs.microsoft.com/en-us/mem/intune/"
  request        : "listDeviceManagement"
  json_transform : '.[] | select(.["@odata.type"] | test("windows10GeneralConfiguration")) | "Display Name: \(.displayName) - Screen timeout: \(.lockScreenTimeoutInSeconds)"'
  regex          : "Screen timeout:"
  expect         : "Screen timeout: ([1-9]|[1-5][0-9]|60)$"
  match_all      : YES
</custom_item>

<custom_item>
  description    : "Windows Device Configuration - System"
  info           : "This control determines whether System is allowed."
  solution       : "From the Intune console, open the device configuration profile. Under 'Control Panel and Settings' verify that 'System' is set to 'Block'."
  reference      : "800-171|3.1.18,800-171|3.4.6,800-171|3.4.7,800-53|AC-19,800-53|CM-7b.,800-53r5|AC-19,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|2.3"
  see_also       : "https://docs.microsoft.com/en-us/mem/intune/"
  request        : "listDeviceManagement"
  json_transform : '.[] | select(.["@odata.type"] | test("windows10GeneralConfiguration")) | "Display Name: \(.displayName) - Block System: \(.settingsBlockSystemPage)"'
  regex          : "Block System:"
  expect         : "Block System: true"
  match_all      : YES
</custom_item>

<custom_item>
  description    : "Windows Device Configuration - Devices"
  info           : "This control determines whether Devices is allowed."
  solution       : "From the Intune console, open the device configuration profile. Under 'Control Panel and Settings' verify that 'Devices' is set to 'Block'."
  reference      : "800-171|3.1.18,800-171|3.4.6,800-171|3.4.7,800-53|AC-19,800-53|CM-7b.,800-53r5|AC-19,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|2.3"
  see_also       : "https://docs.microsoft.com/en-us/mem/intune/"
  request        : "listDeviceManagement"
  json_transform : '.[] | select(.["@odata.type"] | test("windows10GeneralConfiguration")) | "Display Name: \(.displayName) - Block Devices: \(.settingsBlockDevicesPage)"'
  regex          : "Block Devices:"
  expect         : "Block Devices: true"
  match_all      : YES
</custom_item>

<custom_item>
  description    : "Windows Device Configuration - Network and Internet"
  info           : "This control determines whether Network and Internet is allowed."
  solution       : "From the Intune console, open the device configuration profile. Under 'Control Panel and Settings' verify that 'Network and Internet' is set to 'Block'."
  reference      : "800-171|3.1.18,800-171|3.4.6,800-171|3.4.7,800-53|AC-19,800-53|CM-7b.,800-53r5|AC-19,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|2.3"
  see_also       : "https://docs.microsoft.com/en-us/mem/intune/"
  request        : "listDeviceManagement"
  json_transform : '.[] | select(.["@odata.type"] | test("windows10GeneralConfiguration")) | "Display Name: \(.displayName) - Block Network and Internet: \(.settingsBlockNetworkInternetPage)"'
  regex          : "Block Network and Internet:"
  expect         : "Block Network and Internet: true"
  match_all      : YES
</custom_item>

<custom_item>
  description    : "Windows Device Configuration - Personalization"
  info           : "This control determines whether Personalization is allowed."
  solution       : "From the Intune console, open the device configuration profile. Under 'Control Panel and Settings' verify that 'Personalization' is set to 'Block'."
  reference      : "800-171|3.1.18,800-171|3.4.6,800-171|3.4.7,800-53|AC-19,800-53|CM-7b.,800-53r5|AC-19,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|2.3"
  see_also       : "https://docs.microsoft.com/en-us/mem/intune/"
  request        : "listDeviceManagement"
  json_transform : '.[] | select(.["@odata.type"] | test("windows10GeneralConfiguration")) | "Display Name: \(.displayName) - Block Personalization: \(.settingsBlockPersonalizationPage)"'
  regex          : "Block Personalization:"
  expect         : "Block Personalization: true"
  match_all      : YES
</custom_item>

<custom_item>
  description    : "Windows Device Configuration - Accounts"
  info           : "This control determines whether Accounts is allowed."
  solution       : "From the Intune console, open the device configuration profile. Under 'Control Panel and Settings' verify that 'Accounts' is set to 'Block'."
  reference      : "800-171|3.1.18,800-171|3.4.6,800-171|3.4.7,800-53|AC-19,800-53|CM-7b.,800-53r5|AC-19,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|2.3"
  see_also       : "https://docs.microsoft.com/en-us/mem/intune/"
  request        : "listDeviceManagement"
  json_transform : '.[] | select(.["@odata.type"] | test("windows10GeneralConfiguration")) | "Display Name: \(.displayName) - Block Accounts: \(.settingsBlockAccountsPage)"'
  regex          : "Block Accounts:"
  expect         : "Block Accounts: true"
  match_all      : YES
</custom_item>

<custom_item>
  description    : "Windows Device Configuration - Time and Language"
  info           : "This control determines whether Time and Language is allowed."
  solution       : "From the Intune console, open the device configuration profile. Under 'Control Panel and Settings' verify that 'Time and Language' is set to 'Block'."
  reference      : "800-171|3.1.18,800-171|3.4.6,800-171|3.4.7,800-53|AC-19,800-53|CM-7b.,800-53r5|AC-19,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|2.3"
  see_also       : "https://docs.microsoft.com/en-us/mem/intune/"
  request        : "listDeviceManagement"
  json_transform : '.[] | select(.["@odata.type"] | test("windows10GeneralConfiguration")) | "Display Name: \(.displayName) - Block Time and Language: \(.settingsBlockTimeLanguagePage)"'
  regex          : "Block Time and Language:"
  expect         : "Block Time and Language: true"
  match_all      : YES
</custom_item>

<custom_item>
  description    : "Windows Device Configuration - Gaming"
  info           : "This control determines whether Gaming is allowed."
  solution       : "From the Intune console, open the device configuration profile. Under 'Control Panel and Settings' verify that 'Gaming' is set to 'Block'."
  reference      : "800-171|3.1.18,800-171|3.4.6,800-171|3.4.7,800-53|AC-19,800-53|CM-7b.,800-53r5|AC-19,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|2.3"
  see_also       : "https://docs.microsoft.com/en-us/mem/intune/"
  request        : "listDeviceManagement"
  json_transform : '.[] | select(.["@odata.type"] | test("windows10GeneralConfiguration")) | "Display Name: \(.displayName) - Block Gaming: \(.settingsBlockGamingPage)"'
  regex          : "Block Gaming:"
  expect         : "Block Gaming: true"
  match_all      : YES
</custom_item>

</check_type>
