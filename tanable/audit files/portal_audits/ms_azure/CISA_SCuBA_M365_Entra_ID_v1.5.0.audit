#TRUSTED ae29ef709090ebd3c3edf2fd40c65dc4d8abe98ac56ae43528fda3563185bfb773406704ca74c4ab01494e88acae909056c379294d6a193cf426f9977ae8b8b1459140d41a7ae1144a901f4a4135378f12427821d81c2195885e80ee687aa3975720552e1d852d1c6970733c33a7e20cfc149e4263e6fb7b2283640c05266968061b2532bd235746fff44db8e7aa1af0e653416aa014d4b32b28147f23da17a8e1a33c88eafce42e1a5b341e76d3287c85116e87d9cc1499b259a2f8be2d6f7386439a0fef7aed161bcf0c4eab39761dfd46d7e2852aa6097b7d852c4c86ca334ecbb52aa55c073bbd2465cec764feba642995c92f4e8bd9e124d55860208078923fbf8b9b796562beddfb05ae91c32898d0669d28ec8c1172bf106f90458582df10704cfbe63f16036af85bcd6b3885dc0527d7ec40bc89571edfc3a73f68bf5501d12338efe4c865d8d1765b79c1c76516358f1d0760cf5e4c604a4584b8131179afc22e71ef9934040a0b1056639cb3cb937974b8abc172ce11e94bcd3c86b9a9b3496857347915833b7e2b50016eb1f12f268090a29d18b40c82c59c95cf7094faf7145a26b6cbaf7ca4dba9645b4911a85fece810968433e30e33dc9746a87cde7425fd9489542830a21a3d90dd8dc6e7daab213a7fae9c3f09b3123f90383f2d205cd3e7ac2fa7d1b1113e74dcb069b917eeecec8fe5f779250c73a331
#TRUST-RSA-SHA256 26863b9c73a5e02d218908d08db3644ae1e6ca809112743a7cdafa277cb1e16286cffc7999356f1aaf4c20a1aee0e59629e4a49de7cf6426c40cab11f3539583a05c606f1719e1935b95047765c83049c6025333f1874185ec66aadfc10f08d77fd4bbc5d54a554854b5ad132b86f7a9b528c9ada064339f0b55126d8833ed7fe4d36bf687502ad2a5bed024c8e95b3b3aa720100e534aa80d05c6ba264e85d32c497a9502f48b1e9fd49bb46a990661f62cf08ae397f29d4b98eef4d9f0301efb080a8bb57d42e816eec401c910b261e47645438255110a1ec287113adc91bf87ad5dadf3e677ed8674d20ed393bb79cba8e86bd49f44431ed11876a86f1ab8b01de05503793ea0cc9153f7add6883304e087fe351fd266b9f41272c7c70ecf990e2eaee266cda8c2aecc4c247366165afe1b613e6dd967dce24c767a5111f13bad5ea1fb22c09c0135178b6f71873d4f02d64fc822d57483803e6eafc74ebb2f180b30a040eca6626f1581fc7847a7440ebbdb5781f4c5c7defb91fffbd08025ecd1ea1f5bfd2c41d43565eb257275977be7b6de3ddcbef6aae298a36533f327fb6bd1a79a345255a6f72a97033cad22ed4f5d6b1ce2cb5e6e34d450d902cba94d32f1c2b666922d6ea76e51fcfaa515a039fdd829f2946248c2d62c2a28c6e485b515c1ae8bff1bc54c18c9b514286bc0c612451aa7f2f0232c2d55981807
#
# This script is Copyright (C) 2004-2025 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
#
# $Revision: 1.0 $
# $Date: 2025/03/22 $
#
# description	: CISA SCuBA M365 Security Baseline v1.5.0
#
#<ui_metadata>
#<display_name>CISA SCuBA Microsoft 365 Entra ID v1.5.0</display_name>
#<spec>
#  <type>TNS</type>
#  <name>CISA ScubaGear Microsoft 365</name>
#  <profile>Entra ID</profile>
#  <version>1.5.0</version>
#  <link>https://github.com/cisagov/ScubaGear/tree/v1.5.0/</link>
#</spec>
#<labels>scubagear</labels>
#<benchmark_refs>CISA_BOD</benchmark_refs>
#</ui_metadata>

<check_type:"microsoft_azure">

<custom_item>
  type        : POLICY
  description : "MS.AAD.1.1v1 - Legacy authentication SHALL be blocked."
  info        : "The security risk of allowing legacy authentication protocols is they do not support MFA. Blocking legacy protocols reduces the impact of user credential theft."
  solution    : "- [Determine if an agency's existing applications use legacy authentication](https://learn.microsoft.com/en-us/entra/identity/conditional-access/block-legacy-authentication#identify-legacy-authentication-use) before blocking legacy authentication across the entire application base.

- Create a [Conditional Access policy to block legacy authentication](https://learn.microsoft.com/en-us/entra/identity/conditional-access/howto-conditional-access-policy-block-legacy)."
  reference   : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.1.8,800-171|3.1.20,800-171|3.4.1,800-171|3.4.2,800-171|3.4.5,800-171|3.5.1,800-171|3.5.2,800-171|3.5.5,800-171|3.5.6,800-171|3.12.3,800-171|3.13.1,800-171|3.13.2,800-171|3.13.16,800-171|3.14.6,800-171|3.14.7,800-171r3|03.01.01,800-171r3|03.01.02,800-171r3|03.01.04,800-171r3|03.01.05a.,800-171r3|03.01.08,800-171r3|03.01.20,800-171r3|03.04.01,800-171r3|03.04.02,800-171r3|03.04.05,800-171r3|03.05.01a.,800-171r3|03.05.01b.,800-171r3|03.05.05,800-171r3|03.05.12,800-171r3|03.12.03,800-171r3|03.13.08,800-171r3|03.14.06,800-171r3|03.16.01,800-53|AC-2,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|AC-7,800-53|AC-20,800-53|CA-7,800-53|CM-2,800-53|CM-5,800-53|CM-6,800-53|IA-2,800-53|IA-4,800-53|IA-5,800-53|IA-11,800-53|SA-3,800-53|SA-4,800-53|SA-8,800-53|SA-10,800-53|SA-11,800-53|SA-15,800-53|SA-16,800-53|SA-17,800-53|SC-28,800-53|SI-4,800-53r5|AC-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|AC-7,800-53r5|AC-20,800-53r5|CA-7,800-53r5|CM-2,800-53r5|CM-5,800-53r5|CM-6,800-53r5|IA-2,800-53r5|IA-4,800-53r5|IA-5,800-53r5|IA-11,800-53r5|SA-3,800-53r5|SA-4,800-53r5|SA-8,800-53r5|SA-10,800-53r5|SA-11,800-53r5|SA-15,800-53r5|SA-16,800-53r5|SA-17,800-53r5|SC-28,800-53r5|SI-4,CISA_BOD|25-01_Required,CN-L3|7.1.2.7(b),CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(d),CN-L3|7.1.3.2(g),CN-L3|7.1.3.5(a),CN-L3|8.1.4.1(a),CN-L3|8.1.4.1(b),CN-L3|8.1.4.2(a),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.7(b),CN-L3|8.1.4.8(b),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(a),CN-L3|8.1.10.6(f),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-2,CSF|DE.CM-3,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-1,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.AM-4,CSF|ID.RA-1,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.AC-4,CSF|PR.DS-1,CSF|PR.DS-5,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.IP-7,CSF|PR.IP-8,CSF|PR.PT-3,CSF|RS.AN-1,CSF|RS.CO-3,CSF|RS.MI-3,CSF2.0|DE.AE-02,CSF2.0|DE.AE-03,CSF2.0|DE.CM-01,CSF2.0|DE.CM-02,CSF2.0|DE.CM-03,CSF2.0|DE.CM-06,CSF2.0|DE.CM-09,CSF2.0|GV.SC-05,CSF2.0|GV.SC-06,CSF2.0|GV.SC-07,CSF2.0|GV.SC-08,CSF2.0|GV.SC-09,CSF2.0|GV.SC-10,CSF2.0|ID.AM-02,CSF2.0|ID.AM-04,CSF2.0|ID.AM-08,CSF2.0|ID.IM-01,CSF2.0|ID.IM-02,CSF2.0|ID.IM-03,CSF2.0|ID.RA-01,CSF2.0|ID.RA-07,CSF2.0|ID.RA-09,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,CSF2.0|PR.AA-05,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,CSF2.0|PR.IR-01,CSF2.0|PR.IR-03,CSF2.0|PR.PS-01,CSF2.0|PR.PS-06,GDPR|32.1.a,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(b),HIPAA|164.312(d),HIPAA|164.312(e)(2)(ii),ISO-27001-2022|A.5.2,ISO-27001-2022|A.5.3,ISO-27001-2022|A.5.8,ISO-27001-2022|A.5.10,ISO-27001-2022|A.5.14,ISO-27001-2022|A.5.15,ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.17,ISO-27001-2022|A.5.18,ISO-27001-2022|A.5.20,ISO-27001-2022|A.5.23,ISO-27001-2022|A.5.33,ISO-27001-2022|A.5.36,ISO-27001-2022|A.7.9,ISO-27001-2022|A.8.2,ISO-27001-2022|A.8.3,ISO-27001-2022|A.8.4,ISO-27001-2022|A.8.5,ISO-27001-2022|A.8.9,ISO-27001-2022|A.8.16,ISO-27001-2022|A.8.18,ISO-27001-2022|A.8.19,ISO-27001-2022|A.8.20,ISO-27001-2022|A.8.25,ISO-27001-2022|A.8.26,ISO-27001-2022|A.8.27,ISO-27001-2022|A.8.28,ISO-27001-2022|A.8.29,ISO-27001-2022|A.8.30,ISO-27001-2022|A.8.31,ISO-27001-2022|A.8.32,ISO-27001-2022|8.1,ISO-27001-2022|9.1,ISO-27001-2022|9.3.2,ISO-27001-2022|9.3.3,ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-2,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|AC-7,ITSG-33|AC-20,ITSG-33|CA-7,ITSG-33|CM-2,ITSG-33|CM-5,ITSG-33|CM-6,ITSG-33|IA-2,ITSG-33|IA-2a.,ITSG-33|IA-4,ITSG-33|IA-5,ITSG-33|SA-3,ITSG-33|SA-4,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,ITSG-33|SA-11,ITSG-33|SC-28,ITSG-33|SC-28a.,ITSG-33|SI-4,NESA|M1.2.2,NESA|M1.3.5,NESA|M5.3.1,NESA|M5.4.1,NESA|M6.2.2,NESA|T1.2.3,NESA|T2.3.8,NESA|T3.2.3,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.2.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.2.3,NESA|T5.3.1,NESA|T5.4.1,NESA|T5.4.2,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.2.1,NESA|T7.2.2,NESA|T7.5.1,NESA|T7.5.2,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.3,NESA|T7.6.5,NIAv2|AM1,NIAv2|AM2,NIAv2|AM3,NIAv2|AM8,NIAv2|AM14b,NIAv2|AM23f,NIAv2|AM24,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS3,NIAv2|SS5,NIAv2|SS6a,NIAv2|SS6c,NIAv2|SS6d,NIAv2|SS13c,NIAv2|SS14e,NIAv2|SS15c,NIAv2|SS16,NIAv2|SS29,NIAv2|VL2,PCI-DSSv3.2.1|3.4,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|3.3.2,PCI-DSSv4.0|3.5.1,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|7.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,SWIFT-CSCv1|5,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,TBA-FIISB|35.1,TBA-FIISB|36.1,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2"
  see_also    : "https://github.com/cisagov/ScubaGear/tree/v1.5.0/"
  name        : "MS.AAD.1.1v1"
</custom_item>

<custom_item>
  type        : POLICY
  description : "MS.AAD.2.1v1 - Users detected as high risk SHALL be blocked."
  info        : "Blocking high-risk users may prevent compromised accounts from accessing the tenant."
  solution    : "1. Create a conditional access policy blocking users categorized as high risk by the Identity Protection service. Configure the following policy settings in the new conditional access policy as per the values below:

 Users > Include > All users

 Target resources > Cloud apps > All cloud apps

 Conditions > User risk > High

 Access controls > Grant > Block Access"
  reference   : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.1.8,800-171|3.1.20,800-171|3.4.2,800-171|3.4.5,800-171|3.5.1,800-171|3.5.2,800-171|3.12.3,800-171|3.13.1,800-171|3.13.2,800-171|3.13.16,800-171|3.14.6,800-171|3.14.7,800-171r3|03.01.01,800-171r3|03.01.02,800-171r3|03.01.04,800-171r3|03.01.05a.,800-171r3|03.01.08,800-171r3|03.01.20,800-171r3|03.04.02,800-171r3|03.04.05,800-171r3|03.05.01a.,800-171r3|03.05.12,800-171r3|03.12.03,800-171r3|03.13.08,800-171r3|03.14.06,800-171r3|03.16.01,800-53|AC-2,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|AC-7,800-53|AC-20,800-53|CA-7,800-53|CM-5,800-53|CM-6,800-53|IA-2,800-53|IA-5,800-53|SA-3,800-53|SA-4,800-53|SA-8,800-53|SA-10,800-53|SA-11,800-53|SA-15,800-53|SA-16,800-53|SA-17,800-53|SC-28,800-53|SI-4,800-53r5|AC-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|AC-7,800-53r5|AC-20,800-53r5|CA-7,800-53r5|CM-5,800-53r5|CM-6,800-53r5|IA-2,800-53r5|IA-5,800-53r5|SA-3,800-53r5|SA-4,800-53r5|SA-8,800-53r5|SA-10,800-53r5|SA-11,800-53r5|SA-15,800-53r5|SA-16,800-53r5|SA-17,800-53r5|SC-28,800-53r5|SI-4,CISA_BOD|25-01_Required,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(d),CN-L3|7.1.3.2(g),CN-L3|7.1.3.5(a),CN-L3|8.1.4.1(a),CN-L3|8.1.4.1(b),CN-L3|8.1.4.2(a),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.7(b),CN-L3|8.1.4.8(b),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(a),CN-L3|8.1.10.6(f),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-2,CSF|DE.CM-3,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-1,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.AM-4,CSF|ID.RA-1,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.AC-4,CSF|PR.DS-1,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.IP-7,CSF|PR.IP-8,CSF|PR.PT-3,CSF|RS.AN-1,CSF|RS.CO-3,CSF|RS.MI-3,CSF2.0|DE.AE-02,CSF2.0|DE.AE-03,CSF2.0|DE.CM-01,CSF2.0|DE.CM-02,CSF2.0|DE.CM-03,CSF2.0|DE.CM-06,CSF2.0|DE.CM-09,CSF2.0|GV.SC-05,CSF2.0|GV.SC-06,CSF2.0|GV.SC-07,CSF2.0|GV.SC-08,CSF2.0|GV.SC-09,CSF2.0|GV.SC-10,CSF2.0|ID.AM-02,CSF2.0|ID.AM-04,CSF2.0|ID.AM-08,CSF2.0|ID.IM-01,CSF2.0|ID.IM-02,CSF2.0|ID.IM-03,CSF2.0|ID.RA-01,CSF2.0|ID.RA-07,CSF2.0|ID.RA-09,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,CSF2.0|PR.AA-05,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,CSF2.0|PR.IR-01,CSF2.0|PR.IR-03,CSF2.0|PR.PS-01,CSF2.0|PR.PS-06,GDPR|32.1.a,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(b),HIPAA|164.312(d),HIPAA|164.312(e)(2)(ii),ISO-27001-2022|A.5.2,ISO-27001-2022|A.5.3,ISO-27001-2022|A.5.8,ISO-27001-2022|A.5.10,ISO-27001-2022|A.5.14,ISO-27001-2022|A.5.15,ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.17,ISO-27001-2022|A.5.18,ISO-27001-2022|A.5.20,ISO-27001-2022|A.5.23,ISO-27001-2022|A.5.33,ISO-27001-2022|A.5.36,ISO-27001-2022|A.7.9,ISO-27001-2022|A.8.2,ISO-27001-2022|A.8.3,ISO-27001-2022|A.8.4,ISO-27001-2022|A.8.5,ISO-27001-2022|A.8.9,ISO-27001-2022|A.8.16,ISO-27001-2022|A.8.18,ISO-27001-2022|A.8.19,ISO-27001-2022|A.8.20,ISO-27001-2022|A.8.25,ISO-27001-2022|A.8.26,ISO-27001-2022|A.8.27,ISO-27001-2022|A.8.28,ISO-27001-2022|A.8.29,ISO-27001-2022|A.8.30,ISO-27001-2022|A.8.31,ISO-27001-2022|A.8.32,ISO-27001-2022|8.1,ISO-27001-2022|9.1,ISO-27001-2022|9.3.2,ISO-27001-2022|9.3.3,ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-2,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|AC-7,ITSG-33|AC-20,ITSG-33|CA-7,ITSG-33|CM-5,ITSG-33|CM-6,ITSG-33|IA-2,ITSG-33|IA-2a.,ITSG-33|IA-5,ITSG-33|SA-3,ITSG-33|SA-4,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,ITSG-33|SA-11,ITSG-33|SC-28,ITSG-33|SC-28a.,ITSG-33|SI-4,NESA|M1.2.2,NESA|M1.3.5,NESA|M5.3.1,NESA|M5.4.1,NESA|M6.2.2,NESA|T1.2.3,NESA|T2.3.8,NESA|T3.2.3,NESA|T3.4.1,NESA|T4.2.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.2.3,NESA|T5.3.1,NESA|T5.4.1,NESA|T5.4.2,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.2.1,NESA|T7.2.2,NESA|T7.5.1,NESA|T7.5.2,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.3,NESA|T7.6.5,NIAv2|AM1,NIAv2|AM2,NIAv2|AM3,NIAv2|AM8,NIAv2|AM14b,NIAv2|AM23f,NIAv2|AM24,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS3,NIAv2|SS5,NIAv2|SS6a,NIAv2|SS6c,NIAv2|SS6d,NIAv2|SS13c,NIAv2|SS14e,NIAv2|SS15c,NIAv2|SS29,NIAv2|VL2,PCI-DSSv3.2.1|3.4,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|3.3.2,PCI-DSSv4.0|3.5.1,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|7.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,TBA-FIISB|35.1,TBA-FIISB|36.1,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2"
  see_also    : "https://github.com/cisagov/ScubaGear/tree/v1.5.0/"
  name        : "MS.AAD.2.1v1"
</custom_item>

<custom_item>
  type        : POLICY
  description : "MS.AAD.2.2v1 - A notification SHOULD be sent to the administrator when high-risk users are detected."
  info        : "Notification enables the admin to monitor the event and remediate the risk. This helps the organization proactively respond to cyber intrusions as they occur."
  solution    : "1. [Configure Microsoft Entra ID Protection to send a regularly monitored security mailbox email notification](https://learn.microsoft.com/en-us/entra/id-protection/howto-identity-protection-configure-notifications#configure-users-at-risk-detected-alerts) when user accounts are determined to be high risk."
  reference   : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.1.8,800-171|3.1.20,800-171|3.4.2,800-171|3.4.5,800-171|3.5.1,800-171|3.5.2,800-171|3.12.3,800-171|3.13.1,800-171|3.13.2,800-171|3.13.16,800-171|3.14.6,800-171|3.14.7,800-171r3|03.01.01,800-171r3|03.01.02,800-171r3|03.01.04,800-171r3|03.01.05a.,800-171r3|03.01.08,800-171r3|03.01.20,800-171r3|03.04.02,800-171r3|03.04.05,800-171r3|03.05.01a.,800-171r3|03.05.12,800-171r3|03.12.03,800-171r3|03.13.08,800-171r3|03.14.06,800-171r3|03.16.01,800-53|AC-2,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|AC-7,800-53|AC-20,800-53|CA-7,800-53|CM-5,800-53|CM-6,800-53|IA-2,800-53|IA-5,800-53|SA-3,800-53|SA-4,800-53|SA-8,800-53|SA-10,800-53|SA-11,800-53|SA-15,800-53|SA-16,800-53|SA-17,800-53|SC-28,800-53|SI-4,800-53r5|AC-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|AC-7,800-53r5|AC-20,800-53r5|CA-7,800-53r5|CM-5,800-53r5|CM-6,800-53r5|IA-2,800-53r5|IA-5,800-53r5|SA-3,800-53r5|SA-4,800-53r5|SA-8,800-53r5|SA-10,800-53r5|SA-11,800-53r5|SA-15,800-53r5|SA-16,800-53r5|SA-17,800-53r5|SC-28,800-53r5|SI-4,CISA_BOD|25-01_Not_Required,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(d),CN-L3|7.1.3.2(g),CN-L3|7.1.3.5(a),CN-L3|8.1.4.1(a),CN-L3|8.1.4.1(b),CN-L3|8.1.4.2(a),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.7(b),CN-L3|8.1.4.8(b),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(a),CN-L3|8.1.10.6(f),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-2,CSF|DE.CM-3,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-1,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.AM-4,CSF|ID.RA-1,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.AC-4,CSF|PR.DS-1,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.IP-7,CSF|PR.IP-8,CSF|PR.PT-3,CSF|RS.AN-1,CSF|RS.CO-3,CSF|RS.MI-3,CSF2.0|DE.AE-02,CSF2.0|DE.AE-03,CSF2.0|DE.CM-01,CSF2.0|DE.CM-02,CSF2.0|DE.CM-03,CSF2.0|DE.CM-06,CSF2.0|DE.CM-09,CSF2.0|GV.SC-05,CSF2.0|GV.SC-06,CSF2.0|GV.SC-07,CSF2.0|GV.SC-08,CSF2.0|GV.SC-09,CSF2.0|GV.SC-10,CSF2.0|ID.AM-02,CSF2.0|ID.AM-04,CSF2.0|ID.AM-08,CSF2.0|ID.IM-01,CSF2.0|ID.IM-02,CSF2.0|ID.IM-03,CSF2.0|ID.RA-01,CSF2.0|ID.RA-07,CSF2.0|ID.RA-09,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,CSF2.0|PR.AA-05,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,CSF2.0|PR.IR-01,CSF2.0|PR.IR-03,CSF2.0|PR.PS-01,CSF2.0|PR.PS-06,GDPR|32.1.a,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(b),HIPAA|164.312(d),HIPAA|164.312(e)(2)(ii),ISO-27001-2022|A.5.2,ISO-27001-2022|A.5.3,ISO-27001-2022|A.5.8,ISO-27001-2022|A.5.10,ISO-27001-2022|A.5.14,ISO-27001-2022|A.5.15,ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.17,ISO-27001-2022|A.5.18,ISO-27001-2022|A.5.20,ISO-27001-2022|A.5.23,ISO-27001-2022|A.5.33,ISO-27001-2022|A.5.36,ISO-27001-2022|A.7.9,ISO-27001-2022|A.8.2,ISO-27001-2022|A.8.3,ISO-27001-2022|A.8.4,ISO-27001-2022|A.8.5,ISO-27001-2022|A.8.9,ISO-27001-2022|A.8.16,ISO-27001-2022|A.8.18,ISO-27001-2022|A.8.19,ISO-27001-2022|A.8.20,ISO-27001-2022|A.8.25,ISO-27001-2022|A.8.26,ISO-27001-2022|A.8.27,ISO-27001-2022|A.8.28,ISO-27001-2022|A.8.29,ISO-27001-2022|A.8.30,ISO-27001-2022|A.8.31,ISO-27001-2022|A.8.32,ISO-27001-2022|8.1,ISO-27001-2022|9.1,ISO-27001-2022|9.3.2,ISO-27001-2022|9.3.3,ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-2,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|AC-7,ITSG-33|AC-20,ITSG-33|CA-7,ITSG-33|CM-5,ITSG-33|CM-6,ITSG-33|IA-2,ITSG-33|IA-2a.,ITSG-33|IA-5,ITSG-33|SA-3,ITSG-33|SA-4,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,ITSG-33|SA-11,ITSG-33|SC-28,ITSG-33|SC-28a.,ITSG-33|SI-4,NESA|M1.2.2,NESA|M1.3.5,NESA|M5.3.1,NESA|M5.4.1,NESA|M6.2.2,NESA|T1.2.3,NESA|T2.3.8,NESA|T3.2.3,NESA|T3.4.1,NESA|T4.2.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.2.3,NESA|T5.3.1,NESA|T5.4.1,NESA|T5.4.2,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.2.1,NESA|T7.2.2,NESA|T7.5.1,NESA|T7.5.2,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.3,NESA|T7.6.5,NIAv2|AM1,NIAv2|AM2,NIAv2|AM3,NIAv2|AM8,NIAv2|AM14b,NIAv2|AM23f,NIAv2|AM24,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS3,NIAv2|SS5,NIAv2|SS6a,NIAv2|SS6c,NIAv2|SS6d,NIAv2|SS13c,NIAv2|SS14e,NIAv2|SS15c,NIAv2|SS29,NIAv2|VL2,PCI-DSSv3.2.1|3.4,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|3.3.2,PCI-DSSv4.0|3.5.1,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|7.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,TBA-FIISB|35.1,TBA-FIISB|36.1,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2"
  see_also    : "https://github.com/cisagov/ScubaGear/tree/v1.5.0/"
  name        : "MS.AAD.2.2v1"
</custom_item>

<custom_item>
  type        : POLICY
  description : "MS.AAD.2.3v1 - Sign-ins detected as high risk SHALL be blocked."
  info        : "This prevents compromised accounts from accessing the tenant."
  solution    : "1. Create a Conditional Access policy blocking sign-ins determined high risk by the Identity Protection service. Configure the following policy settings in the new Conditional Access policy as per the values below:

 Users > Include > All users

 Target resources > Cloud apps > All cloud apps

 Conditions > Sign-in risk > High

 Access controls > Grant > Block Access"
  reference   : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.1.8,800-171|3.1.20,800-171|3.4.2,800-171|3.4.5,800-171|3.5.1,800-171|3.5.2,800-171|3.12.3,800-171|3.13.1,800-171|3.13.2,800-171|3.13.16,800-171|3.14.6,800-171|3.14.7,800-171r3|03.01.01,800-171r3|03.01.02,800-171r3|03.01.04,800-171r3|03.01.05a.,800-171r3|03.01.08,800-171r3|03.01.20,800-171r3|03.04.02,800-171r3|03.04.05,800-171r3|03.05.01a.,800-171r3|03.05.12,800-171r3|03.12.03,800-171r3|03.13.08,800-171r3|03.14.06,800-171r3|03.16.01,800-53|AC-2,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|AC-7,800-53|AC-20,800-53|CA-7,800-53|CM-5,800-53|CM-6,800-53|IA-2,800-53|IA-5,800-53|SA-3,800-53|SA-4,800-53|SA-8,800-53|SA-10,800-53|SA-11,800-53|SA-15,800-53|SA-16,800-53|SA-17,800-53|SC-28,800-53|SI-4,800-53r5|AC-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|AC-7,800-53r5|AC-20,800-53r5|CA-7,800-53r5|CM-5,800-53r5|CM-6,800-53r5|IA-2,800-53r5|IA-5,800-53r5|SA-3,800-53r5|SA-4,800-53r5|SA-8,800-53r5|SA-10,800-53r5|SA-11,800-53r5|SA-15,800-53r5|SA-16,800-53r5|SA-17,800-53r5|SC-28,800-53r5|SI-4,CISA_BOD|25-01_Required,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(d),CN-L3|7.1.3.2(g),CN-L3|7.1.3.5(a),CN-L3|8.1.4.1(a),CN-L3|8.1.4.1(b),CN-L3|8.1.4.2(a),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.7(b),CN-L3|8.1.4.8(b),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(a),CN-L3|8.1.10.6(f),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-2,CSF|DE.CM-3,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-1,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.AM-4,CSF|ID.RA-1,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.AC-4,CSF|PR.DS-1,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.IP-7,CSF|PR.IP-8,CSF|PR.PT-3,CSF|RS.AN-1,CSF|RS.CO-3,CSF|RS.MI-3,CSF2.0|DE.AE-02,CSF2.0|DE.AE-03,CSF2.0|DE.CM-01,CSF2.0|DE.CM-02,CSF2.0|DE.CM-03,CSF2.0|DE.CM-06,CSF2.0|DE.CM-09,CSF2.0|GV.SC-05,CSF2.0|GV.SC-06,CSF2.0|GV.SC-07,CSF2.0|GV.SC-08,CSF2.0|GV.SC-09,CSF2.0|GV.SC-10,CSF2.0|ID.AM-02,CSF2.0|ID.AM-04,CSF2.0|ID.AM-08,CSF2.0|ID.IM-01,CSF2.0|ID.IM-02,CSF2.0|ID.IM-03,CSF2.0|ID.RA-01,CSF2.0|ID.RA-07,CSF2.0|ID.RA-09,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,CSF2.0|PR.AA-05,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,CSF2.0|PR.IR-01,CSF2.0|PR.IR-03,CSF2.0|PR.PS-01,CSF2.0|PR.PS-06,GDPR|32.1.a,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(b),HIPAA|164.312(d),HIPAA|164.312(e)(2)(ii),ISO-27001-2022|A.5.2,ISO-27001-2022|A.5.3,ISO-27001-2022|A.5.8,ISO-27001-2022|A.5.10,ISO-27001-2022|A.5.14,ISO-27001-2022|A.5.15,ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.17,ISO-27001-2022|A.5.18,ISO-27001-2022|A.5.20,ISO-27001-2022|A.5.23,ISO-27001-2022|A.5.33,ISO-27001-2022|A.5.36,ISO-27001-2022|A.7.9,ISO-27001-2022|A.8.2,ISO-27001-2022|A.8.3,ISO-27001-2022|A.8.4,ISO-27001-2022|A.8.5,ISO-27001-2022|A.8.9,ISO-27001-2022|A.8.16,ISO-27001-2022|A.8.18,ISO-27001-2022|A.8.19,ISO-27001-2022|A.8.20,ISO-27001-2022|A.8.25,ISO-27001-2022|A.8.26,ISO-27001-2022|A.8.27,ISO-27001-2022|A.8.28,ISO-27001-2022|A.8.29,ISO-27001-2022|A.8.30,ISO-27001-2022|A.8.31,ISO-27001-2022|A.8.32,ISO-27001-2022|8.1,ISO-27001-2022|9.1,ISO-27001-2022|9.3.2,ISO-27001-2022|9.3.3,ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-2,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|AC-7,ITSG-33|AC-20,ITSG-33|CA-7,ITSG-33|CM-5,ITSG-33|CM-6,ITSG-33|IA-2,ITSG-33|IA-2a.,ITSG-33|IA-5,ITSG-33|SA-3,ITSG-33|SA-4,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,ITSG-33|SA-11,ITSG-33|SC-28,ITSG-33|SC-28a.,ITSG-33|SI-4,NESA|M1.2.2,NESA|M1.3.5,NESA|M5.3.1,NESA|M5.4.1,NESA|M6.2.2,NESA|T1.2.3,NESA|T2.3.8,NESA|T3.2.3,NESA|T3.4.1,NESA|T4.2.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.2.3,NESA|T5.3.1,NESA|T5.4.1,NESA|T5.4.2,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.2.1,NESA|T7.2.2,NESA|T7.5.1,NESA|T7.5.2,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.3,NESA|T7.6.5,NIAv2|AM1,NIAv2|AM2,NIAv2|AM3,NIAv2|AM8,NIAv2|AM14b,NIAv2|AM23f,NIAv2|AM24,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS3,NIAv2|SS5,NIAv2|SS6a,NIAv2|SS6c,NIAv2|SS6d,NIAv2|SS13c,NIAv2|SS14e,NIAv2|SS15c,NIAv2|SS29,NIAv2|VL2,PCI-DSSv3.2.1|3.4,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|3.3.2,PCI-DSSv4.0|3.5.1,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|7.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,TBA-FIISB|35.1,TBA-FIISB|36.1,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2"
  see_also    : "https://github.com/cisagov/ScubaGear/tree/v1.5.0/"
  name        : "MS.AAD.2.3v1"
</custom_item>

<custom_item>
  type        : POLICY
  description : "MS.AAD.3.1v1 - Phishing-resistant MFA SHALL be enforced for all users."
  info        : "Weaker forms of MFA do not protect against sophisticated phishing attacks. By enforcing methods resistant to phishing, those risks are minimized."
  solution    : "1. Create a conditional access policy enforcing phishing-resistant MFA for all users. Configure the following policy settings in the new conditional access policy, per the values below:

 Users > Include > All users

 Target resources > Cloud apps > All cloud apps

 Access controls > Grant > Grant Access > Require authentication strength > Phishing-resistant MFA"
  reference   : "800-171|3.1.3,800-171|3.4.1,800-171|3.4.2,800-171|3.12.3,800-171|3.13.1,800-171|3.13.5,800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-171|3.14.6,800-171|3.14.7,800-171r3|03.01.03,800-171r3|03.04.01,800-171r3|03.04.02,800-171r3|03.12.03,800-171r3|03.13.01,800-171r3|03.14.02,800-171r3|03.14.06,800-53|AC-4,800-53|CA-7,800-53|CM-2,800-53|CM-6,800-53|IA-9,800-53|SC-7,800-53|SC-20,800-53|SC-44,800-53|SI-3,800-53|SI-4,800-53|SI-8,800-53r5|AC-4,800-53r5|CA-7,800-53r5|CM-2,800-53r5|CM-6,800-53r5|IA-9,800-53r5|SC-7,800-53r5|SC-20,800-53r5|SC-44,800-53r5|SI-3,800-53r5|SI-4,800-53r5|SI-8,CISA_BOD|25-01_Required,CN-L3|7.1.3.5(a),CN-L3|7.1.3.6(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CN-L3|8.1.10.6(j),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-2,CSF|DE.CM-3,CSF|DE.CM-4,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-1,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.AM-3,CSF|ID.RA-1,CSF|PR.AC-4,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-7,CSF|PR.IP-8,CSF|PR.PT-4,CSF|RS.AN-1,CSF|RS.CO-3,CSF|RS.MI-3,CSF2.0|DE.AE-02,CSF2.0|DE.AE-03,CSF2.0|DE.CM-01,CSF2.0|DE.CM-02,CSF2.0|DE.CM-03,CSF2.0|DE.CM-06,CSF2.0|DE.CM-09,CSF2.0|ID.AM-03,CSF2.0|ID.IM-01,CSF2.0|ID.IM-02,CSF2.0|ID.IM-03,CSF2.0|ID.RA-01,CSF2.0|ID.RA-07,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,CSF2.0|PR.IR-01,CSF2.0|PR.PS-01,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(b),HIPAA|164.312(d),ISO-27001-2022|A.5.14,ISO-27001-2022|A.5.36,ISO-27001-2022|A.8.7,ISO-27001-2022|A.8.9,ISO-27001-2022|A.8.16,ISO-27001-2022|A.8.20,ISO-27001-2022|A.8.22,ISO-27001-2022|9.1,ISO-27001-2022|9.3.2,ISO-27001-2022|9.3.3,ISO/IEC-27001|A.12.2.1,ISO/IEC-27001|A.13.1.3,ITSG-33|AC-4,ITSG-33|CA-7,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|SC-7,ITSG-33|SC-20,ITSG-33|SI-3,ITSG-33|SI-4,ITSG-33|SI-8,NESA|M1.2.2,NESA|M5.3.1,NESA|M5.4.1,NESA|M6.2.2,NESA|T3.2.5,NESA|T4.2.1,NESA|T4.5.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.4.6,NESA|T5.7.2,NESA|T7.5.1,NESA|T7.5.2,NESA|T7.6.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS8a,NIAv2|GS11a,NIAv2|GS12a,NIAv2|GS14a,NIAv2|GS15a,NIAv2|GS16a,NIAv2|NS13a,NIAv2|NS13b,NIAv2|NS13c,NIAv2|NS14,NIAv2|SS16,NIAv2|SS23,NIAv2|SS27a,NIAv2|SS27b,NIAv2|SS32,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|5.1,PCI-DSSv3.2.1|5.1.1,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,PCI-DSSv4.0|5.2.1,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.4,TBA-FIISB|43.1,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7"
  see_also    : "https://github.com/cisagov/ScubaGear/tree/v1.5.0/"
  name        : "MS.AAD.3.1v1"
</custom_item>

<custom_item>
  type        : POLICY
  description : "MS.AAD.3.2v1 - If phishing-resistant MFA has not been enforced, an alternative MFA method SHALL be enforced for all users."
  info        : "This is a stopgap security policy to help protect the tenant if phishing-resistant MFA has not been enforced. This policy requires MFA enforcement, thus reducing single-form authentication risk."
  solution    : "1. If phishing-resistant MFA has not been enforced for all users yet, create a conditional access policy that enforces MFA but does not dictate MFA method. Configure the following policy settings in the new conditional access policy, per the values below:

 Users > Include > All users

 Target resources > Cloud apps > All cloud apps

 Access controls > Grant > Grant Access > Require multifactor authentication"
  reference   : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.1.8,800-171|3.1.20,800-171|3.4.1,800-171|3.4.2,800-171|3.5.1,800-171|3.5.2,800-171|3.5.5,800-171|3.5.6,800-171|3.12.3,800-171|3.14.6,800-171|3.14.7,800-171r3|03.01.01,800-171r3|03.01.02,800-171r3|03.01.04,800-171r3|03.01.05a.,800-171r3|03.01.08,800-171r3|03.01.20,800-171r3|03.04.01,800-171r3|03.04.02,800-171r3|03.05.01a.,800-171r3|03.05.01b.,800-171r3|03.05.05,800-171r3|03.05.12,800-171r3|03.12.03,800-171r3|03.14.06,800-53|AC-2,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|AC-7,800-53|AC-20,800-53|CA-7,800-53|CM-2,800-53|CM-6,800-53|IA-2,800-53|IA-4,800-53|IA-5,800-53|IA-11,800-53|SI-4,800-53r5|AC-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|AC-7,800-53r5|AC-20,800-53r5|CA-7,800-53r5|CM-2,800-53r5|CM-6,800-53r5|IA-2,800-53r5|IA-4,800-53r5|IA-5,800-53r5|IA-11,800-53r5|SI-4,CISA_BOD|25-01_Required,CN-L3|7.1.2.7(b),CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(d),CN-L3|7.1.3.2(g),CN-L3|7.1.3.5(a),CN-L3|8.1.4.1(a),CN-L3|8.1.4.1(b),CN-L3|8.1.4.2(a),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(a),CN-L3|8.1.10.6(f),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-2,CSF|DE.CM-3,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-1,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.AM-4,CSF|ID.RA-1,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-7,CSF|PR.IP-8,CSF|PR.PT-3,CSF|RS.AN-1,CSF|RS.CO-3,CSF|RS.MI-3,CSF2.0|DE.AE-02,CSF2.0|DE.AE-03,CSF2.0|DE.CM-01,CSF2.0|DE.CM-02,CSF2.0|DE.CM-03,CSF2.0|DE.CM-06,CSF2.0|DE.CM-09,CSF2.0|ID.AM-02,CSF2.0|ID.AM-04,CSF2.0|ID.IM-01,CSF2.0|ID.IM-02,CSF2.0|ID.IM-03,CSF2.0|ID.RA-01,CSF2.0|ID.RA-07,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,CSF2.0|PR.AA-05,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,CSF2.0|PR.IR-01,CSF2.0|PR.PS-01,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(b),HIPAA|164.312(d),ISO-27001-2022|A.5.3,ISO-27001-2022|A.5.14,ISO-27001-2022|A.5.15,ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.17,ISO-27001-2022|A.5.18,ISO-27001-2022|A.5.33,ISO-27001-2022|A.5.36,ISO-27001-2022|A.7.9,ISO-27001-2022|A.8.2,ISO-27001-2022|A.8.3,ISO-27001-2022|A.8.5,ISO-27001-2022|A.8.9,ISO-27001-2022|A.8.16,ISO-27001-2022|A.8.18,ISO-27001-2022|A.8.20,ISO-27001-2022|9.1,ISO-27001-2022|9.3.2,ISO-27001-2022|9.3.3,ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-2,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|AC-7,ITSG-33|AC-20,ITSG-33|CA-7,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|IA-2,ITSG-33|IA-2a.,ITSG-33|IA-4,ITSG-33|IA-5,ITSG-33|SI-4,NESA|M1.2.2,NESA|M1.3.5,NESA|M5.3.1,NESA|M5.4.1,NESA|M6.2.2,NESA|T1.2.3,NESA|T2.3.8,NESA|T3.2.5,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.2.3,NESA|T5.3.1,NESA|T5.4.1,NESA|T5.4.2,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM2,NIAv2|AM3,NIAv2|AM8,NIAv2|AM14b,NIAv2|AM23f,NIAv2|AM24,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS13c,NIAv2|SS14e,NIAv2|SS15c,NIAv2|SS16,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,SWIFT-CSCv1|5,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,TBA-FIISB|35.1,TBA-FIISB|36.1,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2"
  see_also    : "https://github.com/cisagov/ScubaGear/tree/v1.5.0/"
  name        : "MS.AAD.3.2v1"
</custom_item>

<custom_item>
  type        : POLICY
  description : "MS.AAD.3.3v1 - If phishing-resistant MFA has not been enforced and Microsoft Authenticator is enabled, it SHALL be configured to show login context information."
  info        : "This stopgap security policy helps protect the tenant when phishing-resistant MFA has not been enforced and Microsoft Authenticator is used. This policy helps improve the security of Microsoft Authenticator by showing user context information, which helps reduce MFA phishing compromises."
  solution    : "If phishing-resistant MFA has not been deployed yet and Microsoft Authenticator is in use, configure Authenticator to display context information to users when they log in.

1. In  Microsoft Entra admin center, click Security > Authentication methods > Microsoft Authenticator.
2. Click the Configure tab.
3. For Allow use of Microsoft Authenticator OTP select *No*.
4. Under Show application name in push and passwordless notifications select Status > Enabled and Target > Include > All users.
5. Under Show geographic location in push and passwordless notifications select Status > Enabled and Target > Include > All users.
6. Select Save"
  reference   : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.1.8,800-171|3.1.20,800-171|3.4.1,800-171|3.4.2,800-171|3.5.1,800-171|3.5.2,800-171|3.5.5,800-171|3.5.6,800-171|3.12.3,800-171|3.14.6,800-171|3.14.7,800-171r3|03.01.01,800-171r3|03.01.02,800-171r3|03.01.04,800-171r3|03.01.05a.,800-171r3|03.01.08,800-171r3|03.01.20,800-171r3|03.04.01,800-171r3|03.04.02,800-171r3|03.05.01a.,800-171r3|03.05.01b.,800-171r3|03.05.05,800-171r3|03.05.12,800-171r3|03.12.03,800-171r3|03.14.06,800-53|AC-2,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|AC-7,800-53|AC-20,800-53|CA-7,800-53|CM-2,800-53|CM-6,800-53|IA-2,800-53|IA-4,800-53|IA-5,800-53|IA-11,800-53|SI-4,800-53r5|AC-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|AC-7,800-53r5|AC-20,800-53r5|CA-7,800-53r5|CM-2,800-53r5|CM-6,800-53r5|IA-2,800-53r5|IA-4,800-53r5|IA-5,800-53r5|IA-11,800-53r5|SI-4,CISA_BOD|25-01_Required,CN-L3|7.1.2.7(b),CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(d),CN-L3|7.1.3.2(g),CN-L3|7.1.3.5(a),CN-L3|8.1.4.1(a),CN-L3|8.1.4.1(b),CN-L3|8.1.4.2(a),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(a),CN-L3|8.1.10.6(f),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-2,CSF|DE.CM-3,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-1,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.AM-4,CSF|ID.RA-1,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-7,CSF|PR.IP-8,CSF|PR.PT-3,CSF|RS.AN-1,CSF|RS.CO-3,CSF|RS.MI-3,CSF2.0|DE.AE-02,CSF2.0|DE.AE-03,CSF2.0|DE.CM-01,CSF2.0|DE.CM-02,CSF2.0|DE.CM-03,CSF2.0|DE.CM-06,CSF2.0|DE.CM-09,CSF2.0|ID.AM-02,CSF2.0|ID.AM-04,CSF2.0|ID.IM-01,CSF2.0|ID.IM-02,CSF2.0|ID.IM-03,CSF2.0|ID.RA-01,CSF2.0|ID.RA-07,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,CSF2.0|PR.AA-05,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,CSF2.0|PR.IR-01,CSF2.0|PR.PS-01,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(b),HIPAA|164.312(d),ISO-27001-2022|A.5.3,ISO-27001-2022|A.5.14,ISO-27001-2022|A.5.15,ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.17,ISO-27001-2022|A.5.18,ISO-27001-2022|A.5.33,ISO-27001-2022|A.5.36,ISO-27001-2022|A.7.9,ISO-27001-2022|A.8.2,ISO-27001-2022|A.8.3,ISO-27001-2022|A.8.5,ISO-27001-2022|A.8.9,ISO-27001-2022|A.8.16,ISO-27001-2022|A.8.18,ISO-27001-2022|A.8.20,ISO-27001-2022|9.1,ISO-27001-2022|9.3.2,ISO-27001-2022|9.3.3,ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-2,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|AC-7,ITSG-33|AC-20,ITSG-33|CA-7,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|IA-2,ITSG-33|IA-2a.,ITSG-33|IA-4,ITSG-33|IA-5,ITSG-33|SI-4,NESA|M1.2.2,NESA|M1.3.5,NESA|M5.3.1,NESA|M5.4.1,NESA|M6.2.2,NESA|T1.2.3,NESA|T2.3.8,NESA|T3.2.5,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.2.3,NESA|T5.3.1,NESA|T5.4.1,NESA|T5.4.2,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM2,NIAv2|AM3,NIAv2|AM8,NIAv2|AM14b,NIAv2|AM23f,NIAv2|AM24,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS13c,NIAv2|SS14e,NIAv2|SS15c,NIAv2|SS16,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,SWIFT-CSCv1|5,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,TBA-FIISB|35.1,TBA-FIISB|36.1,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2"
  see_also    : "https://github.com/cisagov/ScubaGear/tree/v1.5.0/"
  name        : "MS.AAD.3.3v1"
</custom_item>

<custom_item>
  type        : POLICY
  description : "MS.AAD.3.4v1 - The Authentication Methods Manage Migration feature SHALL be set to Migration Complete."
  info        : "To disable the legacy authentication methods screen for the tenant, configure the Manage Migration feature to Migration Complete. The MFA and Self-Service Password Reset (SSPR) authentication methods are both managed from a central admin page, thereby reducing administrative complexity and potential security misconfigurations."
  solution    : "1. Go through the process of [How to migrate MFA and SSPR policy settings to the Authentication methods policy for Microsoft Entra ID](https://learn.microsoft.com/en-us/entra/identity/authentication/how-to-authentication-methods-manage).
2. Once ready to finish the migration, [set the Manage Migration option to Migration Complete](https://learn.microsoft.com/en-us/entra/identity/authentication/how-to-authentication-methods-manage#finish-the-migration)."
  reference   : "800-171|3.4.2,800-171r3|03.04.02a.,800-53|CM-6b.,800-53r5|CM-6b.,CISA_BOD|25-01_Required,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6b.,NESA|T3.2.1,SWIFT-CSCv1|2.3"
  see_also    : "https://github.com/cisagov/ScubaGear/tree/v1.5.0/"
  name        : "MS.AAD.3.4v1"
</custom_item>

<custom_item>
  type        : POLICY
  description : "MS.AAD.3.5v1 - The authentication methods SMS, Voice Call, and Email One-Time Passcode (OTP) SHALL be disabled."
  info        : "SMS, voice call, and email OTP are the weakest authenticators. This policy forces users to use stronger MFA methods.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. In Microsoft Entra admin center , click Security > Authentication methods
2. Click on the SMS, Voice Call, and Email OTP authentication methods and disable each of them. Their statuses should be Enabled > No on the Authentication methods > Policies page."
  reference   : "800-171|3.1.1,800-171|3.1.3,800-171|3.1.5,800-171|3.4.1,800-171|3.4.2,800-171|3.4.5,800-171|3.5.1,800-171|3.5.2,800-171|3.12.3,800-171|3.13.1,800-171|3.13.5,800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-171|3.14.6,800-171|3.14.7,800-171r3|03.01.01,800-171r3|03.01.03,800-171r3|03.01.05a.,800-171r3|03.04.01,800-171r3|03.04.02,800-171r3|03.04.05,800-171r3|03.05.01a.,800-171r3|03.05.02,800-171r3|03.05.12,800-171r3|03.12.03,800-171r3|03.13.01,800-171r3|03.14.02,800-171r3|03.14.06,800-53|AC-2,800-53|AC-4,800-53|AC-6,800-53|CA-7,800-53|CM-2,800-53|CM-5,800-53|CM-6,800-53|IA-2,800-53|IA-3,800-53|IA-5,800-53|IA-9,800-53|SC-7,800-53|SC-20,800-53|SC-44,800-53|SI-3,800-53|SI-4,800-53|SI-8,800-53r5|AC-2,800-53r5|AC-4,800-53r5|AC-6,800-53r5|CA-7,800-53r5|CM-2,800-53r5|CM-5,800-53r5|CM-6,800-53r5|IA-2,800-53r5|IA-3,800-53r5|IA-5,800-53r5|IA-9,800-53r5|SC-7,800-53r5|SC-20,800-53r5|SC-44,800-53r5|SI-3,800-53r5|SI-4,800-53r5|SI-8,CISA_BOD|25-01_Not_Required,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(d),CN-L3|7.1.3.2(g),CN-L3|7.1.3.5(a),CN-L3|7.1.3.6(b),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.1.4.2(d),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(a),CN-L3|8.1.10.6(f),CN-L3|8.1.10.6(j),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.5.4.1(a),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-2,CSF|DE.CM-3,CSF|DE.CM-4,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-1,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.AM-3,CSF|ID.RA-1,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-7,CSF|PR.IP-8,CSF|PR.PT-4,CSF|RS.AN-1,CSF|RS.CO-3,CSF|RS.MI-3,CSF2.0|DE.AE-02,CSF2.0|DE.AE-03,CSF2.0|DE.CM-01,CSF2.0|DE.CM-02,CSF2.0|DE.CM-03,CSF2.0|DE.CM-06,CSF2.0|DE.CM-09,CSF2.0|ID.AM-03,CSF2.0|ID.IM-01,CSF2.0|ID.IM-02,CSF2.0|ID.IM-03,CSF2.0|ID.RA-01,CSF2.0|ID.RA-07,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,CSF2.0|PR.AA-05,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,CSF2.0|PR.IR-01,CSF2.0|PR.PS-01,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(b),HIPAA|164.312(d),ISO-27001-2022|A.5.14,ISO-27001-2022|A.5.15,ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.17,ISO-27001-2022|A.5.18,ISO-27001-2022|A.5.36,ISO-27001-2022|A.8.2,ISO-27001-2022|A.8.4,ISO-27001-2022|A.8.7,ISO-27001-2022|A.8.9,ISO-27001-2022|A.8.16,ISO-27001-2022|A.8.18,ISO-27001-2022|A.8.19,ISO-27001-2022|A.8.20,ISO-27001-2022|A.8.22,ISO-27001-2022|A.8.31,ISO-27001-2022|A.8.32,ISO-27001-2022|9.1,ISO-27001-2022|9.3.2,ISO-27001-2022|9.3.3,ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.12.2.1,ISO/IEC-27001|A.13.1.3,ITSG-33|AC-2,ITSG-33|AC-4,ITSG-33|AC-6,ITSG-33|CA-7,ITSG-33|CM-2,ITSG-33|CM-5,ITSG-33|CM-6,ITSG-33|IA-2,ITSG-33|IA-2a.,ITSG-33|IA-3,ITSG-33|IA-3a.,ITSG-33|IA-5,ITSG-33|SC-7,ITSG-33|SC-20,ITSG-33|SI-3,ITSG-33|SI-4,ITSG-33|SI-8,NESA|M1.2.2,NESA|M5.3.1,NESA|M5.4.1,NESA|M6.2.2,NESA|T2.3.8,NESA|T3.2.3,NESA|T3.2.5,NESA|T4.2.1,NESA|T4.5.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.2.3,NESA|T5.3.1,NESA|T5.4.1,NESA|T5.4.2,NESA|T5.4.3,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.4.6,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NESA|T5.5.4,NESA|T5.6.1,NESA|T5.7.2,NESA|T7.5.1,NESA|T7.5.2,NESA|T7.5.3,NESA|T7.6.3,NESA|T7.6.4,NIAv2|AM1,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,NIAv2|AM23f,NIAv2|AM28,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS8a,NIAv2|GS11a,NIAv2|GS12a,NIAv2|GS14a,NIAv2|GS15a,NIAv2|GS16a,NIAv2|NS5j,NIAv2|NS13a,NIAv2|NS13b,NIAv2|NS13c,NIAv2|NS14,NIAv2|SS13c,NIAv2|SS14e,NIAv2|SS15c,NIAv2|SS16,NIAv2|SS23,NIAv2|SS27a,NIAv2|SS27b,NIAv2|SS32,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|5.1,PCI-DSSv3.2.1|5.1.1,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,PCI-DSSv4.0|5.2.1,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|7.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.4,SWIFT-CSCv1|5.1,TBA-FIISB|27.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,TBA-FIISB|35.1,TBA-FIISB|36.1,TBA-FIISB|43.1,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7"
  see_also    : "https://github.com/cisagov/ScubaGear/tree/v1.5.0/"
  name        : "MS.AAD.3.5v1"
  severity    : MEDIUM
</custom_item>

<custom_item>
  type        : POLICY
  description : "MS.AAD.3.6v1 - Phishing-resistant MFA SHALL be required for highly privileged roles."
  info        : "This is a backup security policy to help protect privileged access to the tenant if the conditional access policy, which requires MFA for all users, is disabled or misconfigured."
  solution    : "1. Create a conditional access policy enforcing phishing-resistant MFA for highly privileged roles. Configure the following policy settings in the new conditional access policy, per the values below:

 Users > Include > Select users and groups > Directory roles > select each of the roles listed in the Highly Privileged Roles section at the top of this document

 Target resources > Cloud apps > All cloud apps

 Access controls > Grant > Grant Access > Require authentication strength > Phishing-resistant MFA"
  reference   : "800-171|3.1.1,800-171|3.1.3,800-171|3.1.4,800-171|3.1.5,800-171|3.1.8,800-171|3.1.20,800-171|3.4.1,800-171|3.4.2,800-171|3.4.5,800-171|3.5.1,800-171|3.5.2,800-171|3.12.3,800-171|3.13.1,800-171|3.13.2,800-171|3.13.5,800-171|3.13.16,800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-171|3.14.6,800-171|3.14.7,800-171r3|03.01.01,800-171r3|03.01.02,800-171r3|03.01.03,800-171r3|03.01.04,800-171r3|03.01.05a.,800-171r3|03.01.08,800-171r3|03.01.20,800-171r3|03.04.01,800-171r3|03.04.02,800-171r3|03.04.05,800-171r3|03.05.01a.,800-171r3|03.05.12,800-171r3|03.12.03,800-171r3|03.13.01,800-171r3|03.13.08,800-171r3|03.14.02,800-171r3|03.14.06,800-171r3|03.16.01,800-53|AC-2,800-53|AC-3,800-53|AC-4,800-53|AC-5,800-53|AC-6,800-53|AC-7,800-53|AC-20,800-53|CA-7,800-53|CM-2,800-53|CM-5,800-53|CM-6,800-53|IA-2,800-53|IA-5,800-53|IA-9,800-53|SA-3,800-53|SA-4,800-53|SA-8,800-53|SA-10,800-53|SA-11,800-53|SA-15,800-53|SA-16,800-53|SA-17,800-53|SC-7,800-53|SC-20,800-53|SC-28,800-53|SC-44,800-53|SI-3,800-53|SI-4,800-53|SI-8,800-53r5|AC-2,800-53r5|AC-3,800-53r5|AC-4,800-53r5|AC-5,800-53r5|AC-6,800-53r5|AC-7,800-53r5|AC-20,800-53r5|CA-7,800-53r5|CM-2,800-53r5|CM-5,800-53r5|CM-6,800-53r5|IA-2,800-53r5|IA-5,800-53r5|IA-9,800-53r5|SA-3,800-53r5|SA-4,800-53r5|SA-8,800-53r5|SA-10,800-53r5|SA-11,800-53r5|SA-15,800-53r5|SA-16,800-53r5|SA-17,800-53r5|SC-7,800-53r5|SC-20,800-53r5|SC-28,800-53r5|SC-44,800-53r5|SI-3,800-53r5|SI-4,800-53r5|SI-8,CISA_BOD|25-01_Required,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(d),CN-L3|7.1.3.2(g),CN-L3|7.1.3.5(a),CN-L3|7.1.3.6(b),CN-L3|8.1.4.1(a),CN-L3|8.1.4.1(b),CN-L3|8.1.4.2(a),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.5,CN-L3|8.1.4.7(b),CN-L3|8.1.4.8(b),CN-L3|8.1.4.11(b),CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(a),CN-L3|8.1.10.6(f),CN-L3|8.1.10.6(j),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-2,CSF|DE.CM-3,CSF|DE.CM-4,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-1,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.AM-3,CSF|ID.AM-4,CSF|ID.RA-1,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.AC-4,CSF|PR.AC-5,CSF|PR.DS-1,CSF|PR.DS-5,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.IP-7,CSF|PR.IP-8,CSF|PR.PT-3,CSF|PR.PT-4,CSF|RS.AN-1,CSF|RS.CO-3,CSF|RS.MI-3,CSF2.0|DE.AE-02,CSF2.0|DE.AE-03,CSF2.0|DE.CM-01,CSF2.0|DE.CM-02,CSF2.0|DE.CM-03,CSF2.0|DE.CM-06,CSF2.0|DE.CM-09,CSF2.0|GV.SC-05,CSF2.0|GV.SC-06,CSF2.0|GV.SC-07,CSF2.0|GV.SC-08,CSF2.0|GV.SC-09,CSF2.0|GV.SC-10,CSF2.0|ID.AM-02,CSF2.0|ID.AM-03,CSF2.0|ID.AM-04,CSF2.0|ID.AM-08,CSF2.0|ID.IM-01,CSF2.0|ID.IM-02,CSF2.0|ID.IM-03,CSF2.0|ID.RA-01,CSF2.0|ID.RA-07,CSF2.0|ID.RA-09,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,CSF2.0|PR.AA-05,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,CSF2.0|PR.IR-01,CSF2.0|PR.IR-03,CSF2.0|PR.PS-01,CSF2.0|PR.PS-06,GDPR|32.1.a,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(b),HIPAA|164.312(d),HIPAA|164.312(e)(2)(ii),ISO-27001-2022|A.5.2,ISO-27001-2022|A.5.3,ISO-27001-2022|A.5.8,ISO-27001-2022|A.5.10,ISO-27001-2022|A.5.14,ISO-27001-2022|A.5.15,ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.17,ISO-27001-2022|A.5.18,ISO-27001-2022|A.5.20,ISO-27001-2022|A.5.23,ISO-27001-2022|A.5.33,ISO-27001-2022|A.5.36,ISO-27001-2022|A.7.9,ISO-27001-2022|A.8.2,ISO-27001-2022|A.8.3,ISO-27001-2022|A.8.4,ISO-27001-2022|A.8.5,ISO-27001-2022|A.8.7,ISO-27001-2022|A.8.9,ISO-27001-2022|A.8.16,ISO-27001-2022|A.8.18,ISO-27001-2022|A.8.19,ISO-27001-2022|A.8.20,ISO-27001-2022|A.8.22,ISO-27001-2022|A.8.25,ISO-27001-2022|A.8.26,ISO-27001-2022|A.8.27,ISO-27001-2022|A.8.28,ISO-27001-2022|A.8.29,ISO-27001-2022|A.8.30,ISO-27001-2022|A.8.31,ISO-27001-2022|A.8.32,ISO-27001-2022|8.1,ISO-27001-2022|9.1,ISO-27001-2022|9.3.2,ISO-27001-2022|9.3.3,ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ISO/IEC-27001|A.12.2.1,ISO/IEC-27001|A.13.1.3,ITSG-33|AC-2,ITSG-33|AC-3,ITSG-33|AC-4,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|AC-7,ITSG-33|AC-20,ITSG-33|CA-7,ITSG-33|CM-2,ITSG-33|CM-5,ITSG-33|CM-6,ITSG-33|IA-2,ITSG-33|IA-2a.,ITSG-33|IA-5,ITSG-33|SA-3,ITSG-33|SA-4,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,ITSG-33|SA-11,ITSG-33|SC-7,ITSG-33|SC-20,ITSG-33|SC-28,ITSG-33|SC-28a.,ITSG-33|SI-3,ITSG-33|SI-4,ITSG-33|SI-8,NESA|M1.2.2,NESA|M1.3.5,NESA|M5.3.1,NESA|M5.4.1,NESA|M6.2.2,NESA|T1.2.3,NESA|T2.3.8,NESA|T3.2.3,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.2.1,NESA|T4.5.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.2.3,NESA|T5.3.1,NESA|T5.4.1,NESA|T5.4.2,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.4.6,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NESA|T5.5.4,NESA|T5.6.1,NESA|T5.7.2,NESA|T7.2.1,NESA|T7.2.2,NESA|T7.5.1,NESA|T7.5.2,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.3,NESA|T7.6.4,NESA|T7.6.5,NIAv2|AM1,NIAv2|AM2,NIAv2|AM3,NIAv2|AM8,NIAv2|AM14b,NIAv2|AM23f,NIAv2|AM24,NIAv2|AM28,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS8a,NIAv2|GS11a,NIAv2|GS12a,NIAv2|GS14a,NIAv2|GS15a,NIAv2|GS16a,NIAv2|NS5j,NIAv2|NS13a,NIAv2|NS13b,NIAv2|NS13c,NIAv2|NS14,NIAv2|SS3,NIAv2|SS5,NIAv2|SS6a,NIAv2|SS6c,NIAv2|SS6d,NIAv2|SS13c,NIAv2|SS14e,NIAv2|SS15c,NIAv2|SS16,NIAv2|SS23,NIAv2|SS27a,NIAv2|SS27b,NIAv2|SS29,NIAv2|SS32,NIAv2|VL2,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|3.4,PCI-DSSv3.2.1|5.1,PCI-DSSv3.2.1|5.1.1,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,PCI-DSSv4.0|3.3.2,PCI-DSSv4.0|3.5.1,PCI-DSSv4.0|5.2.1,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|7.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.4,SWIFT-CSCv1|2.5,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,TBA-FIISB|35.1,TBA-FIISB|36.1,TBA-FIISB|36.2.4,TBA-FIISB|43.1,TBA-FIISB|45.1.2,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7"
  see_also    : "https://github.com/cisagov/ScubaGear/tree/v1.5.0/"
  name        : "MS.AAD.3.6v1"
</custom_item>

<custom_item>
  type        : POLICY
  description : "MS.AAD.3.7v1 - Managed devices SHOULD be required for authentication."
  info        : "The security risk of an adversary authenticating to the tenant from their own device is reduced by requiring a managed device to authenticate. Managed devices are under the provisioning and control of the agency. [OMB-22-09](https://www.whitehouse.gov/wp-content/uploads/2022/01/M-22-09.pdf) states, \"When authorizing users to access resources, agencies must consider at least one device-level signal alongside identity information about the authenticated user.\""
  solution    : "1. Create a conditional access policy requiring a user's device to be either Microsoft Entra ID hybrid joined or compliant during authentication. Configure the following policy settings in the new conditional access policy, per the values below:

 Users > Include > All users

 Target resources > Cloud apps > All cloud apps

 Access controls > Grant > Grant Access > Require device to be marked as compliant and Require Microsoft Entra ID hybrid joined device > For multiple controls > Require one of the selected controls"
  reference   : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.1.8,800-171|3.1.20,800-171|3.4.2,800-171|3.4.5,800-171|3.5.1,800-171|3.5.2,800-171|3.12.3,800-171|3.13.1,800-171|3.13.2,800-171|3.13.16,800-171|3.14.6,800-171|3.14.7,800-171r3|03.01.01,800-171r3|03.01.02,800-171r3|03.01.04,800-171r3|03.01.05a.,800-171r3|03.01.08,800-171r3|03.01.20,800-171r3|03.04.02,800-171r3|03.04.05,800-171r3|03.05.01a.,800-171r3|03.05.12,800-171r3|03.12.03,800-171r3|03.13.08,800-171r3|03.14.06,800-171r3|03.16.01,800-53|AC-2,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|AC-7,800-53|AC-20,800-53|CA-7,800-53|CM-5,800-53|CM-6,800-53|IA-2,800-53|IA-5,800-53|SA-3,800-53|SA-4,800-53|SA-8,800-53|SA-10,800-53|SA-11,800-53|SA-15,800-53|SA-16,800-53|SA-17,800-53|SC-28,800-53|SI-4,800-53r5|AC-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|AC-7,800-53r5|AC-20,800-53r5|CA-7,800-53r5|CM-5,800-53r5|CM-6,800-53r5|IA-2,800-53r5|IA-5,800-53r5|SA-3,800-53r5|SA-4,800-53r5|SA-8,800-53r5|SA-10,800-53r5|SA-11,800-53r5|SA-15,800-53r5|SA-16,800-53r5|SA-17,800-53r5|SC-28,800-53r5|SI-4,CISA_BOD|25-01_Not_Required,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(d),CN-L3|7.1.3.2(g),CN-L3|7.1.3.5(a),CN-L3|8.1.4.1(a),CN-L3|8.1.4.1(b),CN-L3|8.1.4.2(a),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.7(b),CN-L3|8.1.4.8(b),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(a),CN-L3|8.1.10.6(f),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-2,CSF|DE.CM-3,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-1,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.AM-4,CSF|ID.RA-1,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.AC-4,CSF|PR.DS-1,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.IP-7,CSF|PR.IP-8,CSF|PR.PT-3,CSF|RS.AN-1,CSF|RS.CO-3,CSF|RS.MI-3,CSF2.0|DE.AE-02,CSF2.0|DE.AE-03,CSF2.0|DE.CM-01,CSF2.0|DE.CM-02,CSF2.0|DE.CM-03,CSF2.0|DE.CM-06,CSF2.0|DE.CM-09,CSF2.0|GV.SC-05,CSF2.0|GV.SC-06,CSF2.0|GV.SC-07,CSF2.0|GV.SC-08,CSF2.0|GV.SC-09,CSF2.0|GV.SC-10,CSF2.0|ID.AM-02,CSF2.0|ID.AM-04,CSF2.0|ID.AM-08,CSF2.0|ID.IM-01,CSF2.0|ID.IM-02,CSF2.0|ID.IM-03,CSF2.0|ID.RA-01,CSF2.0|ID.RA-07,CSF2.0|ID.RA-09,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,CSF2.0|PR.AA-05,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,CSF2.0|PR.IR-01,CSF2.0|PR.IR-03,CSF2.0|PR.PS-01,CSF2.0|PR.PS-06,GDPR|32.1.a,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(b),HIPAA|164.312(d),HIPAA|164.312(e)(2)(ii),ISO-27001-2022|A.5.2,ISO-27001-2022|A.5.3,ISO-27001-2022|A.5.8,ISO-27001-2022|A.5.10,ISO-27001-2022|A.5.14,ISO-27001-2022|A.5.15,ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.17,ISO-27001-2022|A.5.18,ISO-27001-2022|A.5.20,ISO-27001-2022|A.5.23,ISO-27001-2022|A.5.33,ISO-27001-2022|A.5.36,ISO-27001-2022|A.7.9,ISO-27001-2022|A.8.2,ISO-27001-2022|A.8.3,ISO-27001-2022|A.8.4,ISO-27001-2022|A.8.5,ISO-27001-2022|A.8.9,ISO-27001-2022|A.8.16,ISO-27001-2022|A.8.18,ISO-27001-2022|A.8.19,ISO-27001-2022|A.8.20,ISO-27001-2022|A.8.25,ISO-27001-2022|A.8.26,ISO-27001-2022|A.8.27,ISO-27001-2022|A.8.28,ISO-27001-2022|A.8.29,ISO-27001-2022|A.8.30,ISO-27001-2022|A.8.31,ISO-27001-2022|A.8.32,ISO-27001-2022|8.1,ISO-27001-2022|9.1,ISO-27001-2022|9.3.2,ISO-27001-2022|9.3.3,ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-2,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|AC-7,ITSG-33|AC-20,ITSG-33|CA-7,ITSG-33|CM-5,ITSG-33|CM-6,ITSG-33|IA-2,ITSG-33|IA-2a.,ITSG-33|IA-5,ITSG-33|SA-3,ITSG-33|SA-4,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,ITSG-33|SA-11,ITSG-33|SC-28,ITSG-33|SC-28a.,ITSG-33|SI-4,NESA|M1.2.2,NESA|M1.3.5,NESA|M5.3.1,NESA|M5.4.1,NESA|M6.2.2,NESA|T1.2.3,NESA|T2.3.8,NESA|T3.2.3,NESA|T3.4.1,NESA|T4.2.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.2.3,NESA|T5.3.1,NESA|T5.4.1,NESA|T5.4.2,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.2.1,NESA|T7.2.2,NESA|T7.5.1,NESA|T7.5.2,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.3,NESA|T7.6.5,NIAv2|AM1,NIAv2|AM2,NIAv2|AM3,NIAv2|AM8,NIAv2|AM14b,NIAv2|AM23f,NIAv2|AM24,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS3,NIAv2|SS5,NIAv2|SS6a,NIAv2|SS6c,NIAv2|SS6d,NIAv2|SS13c,NIAv2|SS14e,NIAv2|SS15c,NIAv2|SS29,NIAv2|VL2,PCI-DSSv3.2.1|3.4,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|3.3.2,PCI-DSSv4.0|3.5.1,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|7.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,TBA-FIISB|35.1,TBA-FIISB|36.1,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2"
  see_also    : "https://github.com/cisagov/ScubaGear/tree/v1.5.0/"
  name        : "MS.AAD.3.7v1"
</custom_item>

<custom_item>
  type        : POLICY
  description : "MS.AAD.3.8v1 - Managed Devices SHOULD be required to register MFA."
  info        : "Reduce risk of an adversary using stolen user credentials and then registering their own MFA device to access the tenant by requiring a managed device provisioned and controlled by the agency to perform registration actions. This prevents the adversary from using their own unmanaged device to perform the registration."
  solution    : "1. Create a conditional access policy requiring a user to be on a managed device when registering for MFA. Configure the following policy settings in the new conditional access policy, per the values below:

 Users > Include > All users

 Target resources > User actions > Register security information

 Access controls > Grant > Grant Access > Require device to be marked as compliant and Require Microsoft Entra ID hybrid joined device > For multiple controls > Require one of the selected controls"
  reference   : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.1.8,800-171|3.1.20,800-171|3.4.2,800-171|3.4.5,800-171|3.5.1,800-171|3.5.2,800-171|3.12.3,800-171|3.13.1,800-171|3.13.2,800-171|3.13.16,800-171|3.14.6,800-171|3.14.7,800-171r3|03.01.01,800-171r3|03.01.02,800-171r3|03.01.04,800-171r3|03.01.05a.,800-171r3|03.01.08,800-171r3|03.01.20,800-171r3|03.04.02,800-171r3|03.04.05,800-171r3|03.05.01a.,800-171r3|03.05.12,800-171r3|03.12.03,800-171r3|03.13.08,800-171r3|03.14.06,800-171r3|03.16.01,800-53|AC-2,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|AC-7,800-53|AC-20,800-53|CA-7,800-53|CM-5,800-53|CM-6,800-53|IA-2,800-53|IA-5,800-53|SA-3,800-53|SA-4,800-53|SA-8,800-53|SA-10,800-53|SA-11,800-53|SA-15,800-53|SA-16,800-53|SA-17,800-53|SC-28,800-53|SI-4,800-53r5|AC-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|AC-7,800-53r5|AC-20,800-53r5|CA-7,800-53r5|CM-5,800-53r5|CM-6,800-53r5|IA-2,800-53r5|IA-5,800-53r5|SA-3,800-53r5|SA-4,800-53r5|SA-8,800-53r5|SA-10,800-53r5|SA-11,800-53r5|SA-15,800-53r5|SA-16,800-53r5|SA-17,800-53r5|SC-28,800-53r5|SI-4,CISA_BOD|25-01_Not_Required,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(d),CN-L3|7.1.3.2(g),CN-L3|7.1.3.5(a),CN-L3|8.1.4.1(a),CN-L3|8.1.4.1(b),CN-L3|8.1.4.2(a),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.7(b),CN-L3|8.1.4.8(b),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(a),CN-L3|8.1.10.6(f),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-2,CSF|DE.CM-3,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-1,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.AM-4,CSF|ID.RA-1,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.AC-4,CSF|PR.DS-1,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.IP-7,CSF|PR.IP-8,CSF|PR.PT-3,CSF|RS.AN-1,CSF|RS.CO-3,CSF|RS.MI-3,CSF2.0|DE.AE-02,CSF2.0|DE.AE-03,CSF2.0|DE.CM-01,CSF2.0|DE.CM-02,CSF2.0|DE.CM-03,CSF2.0|DE.CM-06,CSF2.0|DE.CM-09,CSF2.0|GV.SC-05,CSF2.0|GV.SC-06,CSF2.0|GV.SC-07,CSF2.0|GV.SC-08,CSF2.0|GV.SC-09,CSF2.0|GV.SC-10,CSF2.0|ID.AM-02,CSF2.0|ID.AM-04,CSF2.0|ID.AM-08,CSF2.0|ID.IM-01,CSF2.0|ID.IM-02,CSF2.0|ID.IM-03,CSF2.0|ID.RA-01,CSF2.0|ID.RA-07,CSF2.0|ID.RA-09,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,CSF2.0|PR.AA-05,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,CSF2.0|PR.IR-01,CSF2.0|PR.IR-03,CSF2.0|PR.PS-01,CSF2.0|PR.PS-06,GDPR|32.1.a,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(b),HIPAA|164.312(d),HIPAA|164.312(e)(2)(ii),ISO-27001-2022|A.5.2,ISO-27001-2022|A.5.3,ISO-27001-2022|A.5.8,ISO-27001-2022|A.5.10,ISO-27001-2022|A.5.14,ISO-27001-2022|A.5.15,ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.17,ISO-27001-2022|A.5.18,ISO-27001-2022|A.5.20,ISO-27001-2022|A.5.23,ISO-27001-2022|A.5.33,ISO-27001-2022|A.5.36,ISO-27001-2022|A.7.9,ISO-27001-2022|A.8.2,ISO-27001-2022|A.8.3,ISO-27001-2022|A.8.4,ISO-27001-2022|A.8.5,ISO-27001-2022|A.8.9,ISO-27001-2022|A.8.16,ISO-27001-2022|A.8.18,ISO-27001-2022|A.8.19,ISO-27001-2022|A.8.20,ISO-27001-2022|A.8.25,ISO-27001-2022|A.8.26,ISO-27001-2022|A.8.27,ISO-27001-2022|A.8.28,ISO-27001-2022|A.8.29,ISO-27001-2022|A.8.30,ISO-27001-2022|A.8.31,ISO-27001-2022|A.8.32,ISO-27001-2022|8.1,ISO-27001-2022|9.1,ISO-27001-2022|9.3.2,ISO-27001-2022|9.3.3,ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-2,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|AC-7,ITSG-33|AC-20,ITSG-33|CA-7,ITSG-33|CM-5,ITSG-33|CM-6,ITSG-33|IA-2,ITSG-33|IA-2a.,ITSG-33|IA-5,ITSG-33|SA-3,ITSG-33|SA-4,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,ITSG-33|SA-11,ITSG-33|SC-28,ITSG-33|SC-28a.,ITSG-33|SI-4,NESA|M1.2.2,NESA|M1.3.5,NESA|M5.3.1,NESA|M5.4.1,NESA|M6.2.2,NESA|T1.2.3,NESA|T2.3.8,NESA|T3.2.3,NESA|T3.4.1,NESA|T4.2.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.2.3,NESA|T5.3.1,NESA|T5.4.1,NESA|T5.4.2,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.2.1,NESA|T7.2.2,NESA|T7.5.1,NESA|T7.5.2,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.3,NESA|T7.6.5,NIAv2|AM1,NIAv2|AM2,NIAv2|AM3,NIAv2|AM8,NIAv2|AM14b,NIAv2|AM23f,NIAv2|AM24,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS3,NIAv2|SS5,NIAv2|SS6a,NIAv2|SS6c,NIAv2|SS6d,NIAv2|SS13c,NIAv2|SS14e,NIAv2|SS15c,NIAv2|SS29,NIAv2|VL2,PCI-DSSv3.2.1|3.4,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|3.3.2,PCI-DSSv4.0|3.5.1,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|7.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,TBA-FIISB|35.1,TBA-FIISB|36.1,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2"
  see_also    : "https://github.com/cisagov/ScubaGear/tree/v1.5.0/"
  name        : "MS.AAD.3.8v1"
</custom_item>

<custom_item>
  type        : POLICY
  description : "MS.AAD.4.1v1 - Security logs SHALL be sent to the agency's security operations center for monitoring."
  info        : "The security risk of not having visibility into cyber attacks is reduced by collecting logs in the agency's centralized security detection infrastructure. This makes security events available for auditing, query, and incident response.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Follow the configuration instructions unique to the products and integration patterns at your organization to send the security logs to the security operations center for monitoring."
  reference   : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.4.5,800-171|3.5.1,800-171r3|03.01.01,800-171r3|03.01.02,800-171r3|03.01.04,800-171r3|03.01.05a.,800-171r3|03.04.05,800-171r3|03.05.01a.,800-53|AC-2,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|CM-5,800-53|IA-2,800-53r5|AC-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|CM-5,800-53r5|IA-2,CISA_BOD|25-01_Not_Required,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(d),CN-L3|7.1.3.2(g),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,CSF2.0|PR.AA-05,CSF2.0|PR.DS-10,CSF2.0|PR.IR-01,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO-27001-2022|A.5.3,ISO-27001-2022|A.5.15,ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.18,ISO-27001-2022|A.5.33,ISO-27001-2022|A.8.2,ISO-27001-2022|A.8.3,ISO-27001-2022|A.8.4,ISO-27001-2022|A.8.9,ISO-27001-2022|A.8.18,ISO-27001-2022|A.8.19,ISO-27001-2022|A.8.20,ISO-27001-2022|A.8.31,ISO-27001-2022|A.8.32,ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-2,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|CM-5,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T3.2.3,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.3.1,NESA|T5.4.1,NESA|T5.4.2,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.1,NESA|T7.5.2,NESA|T7.5.3,NESA|T7.6.3,NIAv2|AM1,NIAv2|AM2,NIAv2|AM3,NIAv2|AM8,NIAv2|AM14b,NIAv2|AM23f,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS13c,NIAv2|SS14e,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|7.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://github.com/cisagov/ScubaGear/tree/v1.5.0/"
  name        : "MS.AAD.4.1v1"
  severity    : MEDIUM
</custom_item>

<custom_item>
  type        : POLICY
  description : "MS.AAD.5.1v1 - Only administrators SHALL be allowed to register applications."
  info        : "Application access for the tenant presents a heightened security risk compared to interactive user access because applications are typically not subject to critical security protections, such as MFA policies. Reduce risk of unauthorized users installing malicious applications into the tenant by ensuring that only specific privileged users can register applications."
  solution    : "1. In Microsoft Entra admin center, under Manage, select Users.

2. Select User settings.

3. For Users can register applications, select No.

4. Click Save."
  reference   : "800-171|3.1.1,800-171|3.1.3,800-171|3.1.4,800-171|3.1.5,800-171|3.1.20,800-171|3.4.2,800-171|3.4.5,800-171|3.4.6,800-171|3.4.7,800-171|3.5.1,800-171|3.5.2,800-171|3.13.1,800-171|3.13.5,800-171|3.14.6,800-171|3.14.7,800-171r3|03.01.01,800-171r3|03.01.02,800-171r3|03.01.03,800-171r3|03.01.04,800-171r3|03.01.05a.,800-171r3|03.01.20,800-171r3|03.04.02,800-171r3|03.04.05,800-171r3|03.04.06,800-171r3|03.05.01a.,800-171r3|03.05.12,800-171r3|03.13.01,800-171r3|03.14.06,800-53|AC-2,800-53|AC-3,800-53|AC-4,800-53|AC-5,800-53|AC-6,800-53|AC-20,800-53|CM-5,800-53|CM-6,800-53|CM-7,800-53|IA-2,800-53|IA-5,800-53|SC-7,800-53|SI-4,800-53|SI-7,800-53r5|AC-2,800-53r5|AC-3,800-53r5|AC-4,800-53r5|AC-5,800-53r5|AC-6,800-53r5|AC-20,800-53r5|CM-5,800-53r5|CM-6,800-53r5|CM-7,800-53r5|IA-2,800-53r5|IA-5,800-53r5|SC-7,800-53r5|SI-4,800-53r5|SI-7,CISA_BOD|25-01_Required,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(d),CN-L3|7.1.3.2(g),CN-L3|7.1.3.5(a),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(a),CN-L3|8.1.10.6(f),CN-L3|8.1.10.6(j),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.AM-3,CSF|ID.AM-4,CSF|ID.RA-1,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.AC-4,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.DS-6,CSF|PR.IP-1,CSF|PR.IP-8,CSF|PR.PT-3,CSF|PR.PT-4,CSF|RS.AN-1,CSF|RS.CO-3,CSF2.0|DE.AE-02,CSF2.0|DE.AE-03,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|DE.CM-06,CSF2.0|DE.CM-09,CSF2.0|ID.AM-02,CSF2.0|ID.AM-03,CSF2.0|ID.AM-04,CSF2.0|ID.IM-01,CSF2.0|ID.IM-02,CSF2.0|ID.IM-03,CSF2.0|ID.RA-01,CSF2.0|ID.RA-09,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,CSF2.0|PR.AA-05,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,CSF2.0|PR.IR-01,CSF2.0|PR.PS-01,CSF2.0|PR.PS-02,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(b),HIPAA|164.312(c)(1),HIPAA|164.312(c)(2),HIPAA|164.312(d),HIPAA|164.312(e)(2)(i),ISO-27001-2022|A.5.3,ISO-27001-2022|A.5.14,ISO-27001-2022|A.5.15,ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.17,ISO-27001-2022|A.5.18,ISO-27001-2022|A.5.33,ISO-27001-2022|A.7.9,ISO-27001-2022|A.8.2,ISO-27001-2022|A.8.3,ISO-27001-2022|A.8.4,ISO-27001-2022|A.8.9,ISO-27001-2022|A.8.16,ISO-27001-2022|A.8.18,ISO-27001-2022|A.8.19,ISO-27001-2022|A.8.20,ISO-27001-2022|A.8.22,ISO-27001-2022|A.8.31,ISO-27001-2022|A.8.32,ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ISO/IEC-27001|A.13.1.3,ITSG-33|AC-2,ITSG-33|AC-3,ITSG-33|AC-4,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|AC-20,ITSG-33|CM-5,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|IA-2,ITSG-33|IA-2a.,ITSG-33|IA-5,ITSG-33|SC-7,ITSG-33|SI-4,ITSG-33|SI-7,ITSG-33|SI-7a.,NESA|M1.2.2,NESA|M1.3.5,NESA|T1.2.3,NESA|T2.3.8,NESA|T3.2.3,NESA|T3.4.1,NESA|T4.2.1,NESA|T4.5.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.2.3,NESA|T5.3.1,NESA|T5.4.1,NESA|T5.4.2,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.4.6,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NESA|T5.5.4,NESA|T5.6.1,NESA|T5.7.2,NESA|T7.3.2,NESA|T7.3.3,NESA|T7.5.1,NESA|T7.5.2,NESA|T7.5.3,NESA|T7.6.3,NESA|T7.6.4,NIAv2|AM1,NIAv2|AM2,NIAv2|AM3,NIAv2|AM8,NIAv2|AM14b,NIAv2|AM23f,NIAv2|AM28,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS11a,NIAv2|GS12a,NIAv2|GS14a,NIAv2|GS15a,NIAv2|GS16a,NIAv2|NS5j,NIAv2|NS13a,NIAv2|NS13b,NIAv2|NS13c,NIAv2|NS14,NIAv2|SS13c,NIAv2|SS14e,NIAv2|SS15a,NIAv2|SS15c,NIAv2|SS23,NIAv2|SS27a,NIAv2|SS27b,NIAv2|SS29,NIAv2|SS32,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.2,PCI-DSSv3.2.1|7.1.2,PCI-DSSv3.2.1|10.5.5,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|7.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.4,SWIFT-CSCv1|2.5,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,TBA-FIISB|35.1,TBA-FIISB|36.1,TBA-FIISB|43.1"
  see_also    : "https://github.com/cisagov/ScubaGear/tree/v1.5.0/"
  name        : "MS.AAD.5.1v1"
</custom_item>

<custom_item>
  type        : POLICY
  description : "MS.AAD.5.2v1 - Only administrators SHALL be allowed to consent to applications."
  info        : "Limiting applications consent to only specific privileged users reduces risk of users giving insecure applications access to their data via [consent grant attacks](https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/detect-and-remediate-illicit-consent-grants?view=o365-worldwide)."
  solution    : "1. In Microsoft Entra admin center under Manage, select Enterprise Applications.

2. Under Security, select Consent and permissions. Then select User Consent Settings.

3. Under User consent for applications, select Do not allow user consent.

4. Click Save."
  reference   : "800-171|3.1.1,800-171|3.1.3,800-171|3.1.4,800-171|3.1.5,800-171|3.1.20,800-171|3.4.2,800-171|3.4.5,800-171|3.4.6,800-171|3.4.7,800-171|3.5.1,800-171|3.5.2,800-171|3.13.1,800-171|3.13.5,800-171|3.14.6,800-171|3.14.7,800-171r3|03.01.01,800-171r3|03.01.02,800-171r3|03.01.03,800-171r3|03.01.04,800-171r3|03.01.05a.,800-171r3|03.01.20,800-171r3|03.04.02,800-171r3|03.04.05,800-171r3|03.04.06,800-171r3|03.05.01a.,800-171r3|03.05.12,800-171r3|03.13.01,800-171r3|03.14.06,800-53|AC-2,800-53|AC-3,800-53|AC-4,800-53|AC-5,800-53|AC-6,800-53|AC-20,800-53|CM-5,800-53|CM-6,800-53|CM-7,800-53|IA-2,800-53|IA-5,800-53|SC-7,800-53|SI-4,800-53|SI-7,800-53r5|AC-2,800-53r5|AC-3,800-53r5|AC-4,800-53r5|AC-5,800-53r5|AC-6,800-53r5|AC-20,800-53r5|CM-5,800-53r5|CM-6,800-53r5|CM-7,800-53r5|IA-2,800-53r5|IA-5,800-53r5|SC-7,800-53r5|SI-4,800-53r5|SI-7,CISA_BOD|25-01_Required,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(d),CN-L3|7.1.3.2(g),CN-L3|7.1.3.5(a),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(a),CN-L3|8.1.10.6(f),CN-L3|8.1.10.6(j),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.AM-3,CSF|ID.AM-4,CSF|ID.RA-1,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.AC-4,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.DS-6,CSF|PR.IP-1,CSF|PR.IP-8,CSF|PR.PT-3,CSF|PR.PT-4,CSF|RS.AN-1,CSF|RS.CO-3,CSF2.0|DE.AE-02,CSF2.0|DE.AE-03,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|DE.CM-06,CSF2.0|DE.CM-09,CSF2.0|ID.AM-02,CSF2.0|ID.AM-03,CSF2.0|ID.AM-04,CSF2.0|ID.IM-01,CSF2.0|ID.IM-02,CSF2.0|ID.IM-03,CSF2.0|ID.RA-01,CSF2.0|ID.RA-09,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,CSF2.0|PR.AA-05,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,CSF2.0|PR.IR-01,CSF2.0|PR.PS-01,CSF2.0|PR.PS-02,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(b),HIPAA|164.312(c)(1),HIPAA|164.312(c)(2),HIPAA|164.312(d),HIPAA|164.312(e)(2)(i),ISO-27001-2022|A.5.3,ISO-27001-2022|A.5.14,ISO-27001-2022|A.5.15,ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.17,ISO-27001-2022|A.5.18,ISO-27001-2022|A.5.33,ISO-27001-2022|A.7.9,ISO-27001-2022|A.8.2,ISO-27001-2022|A.8.3,ISO-27001-2022|A.8.4,ISO-27001-2022|A.8.9,ISO-27001-2022|A.8.16,ISO-27001-2022|A.8.18,ISO-27001-2022|A.8.19,ISO-27001-2022|A.8.20,ISO-27001-2022|A.8.22,ISO-27001-2022|A.8.31,ISO-27001-2022|A.8.32,ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ISO/IEC-27001|A.13.1.3,ITSG-33|AC-2,ITSG-33|AC-3,ITSG-33|AC-4,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|AC-20,ITSG-33|CM-5,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|IA-2,ITSG-33|IA-2a.,ITSG-33|IA-5,ITSG-33|SC-7,ITSG-33|SI-4,ITSG-33|SI-7,ITSG-33|SI-7a.,NESA|M1.2.2,NESA|M1.3.5,NESA|T1.2.3,NESA|T2.3.8,NESA|T3.2.3,NESA|T3.4.1,NESA|T4.2.1,NESA|T4.5.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.2.3,NESA|T5.3.1,NESA|T5.4.1,NESA|T5.4.2,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.4.6,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NESA|T5.5.4,NESA|T5.6.1,NESA|T5.7.2,NESA|T7.3.2,NESA|T7.3.3,NESA|T7.5.1,NESA|T7.5.2,NESA|T7.5.3,NESA|T7.6.3,NESA|T7.6.4,NIAv2|AM1,NIAv2|AM2,NIAv2|AM3,NIAv2|AM8,NIAv2|AM14b,NIAv2|AM23f,NIAv2|AM28,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS11a,NIAv2|GS12a,NIAv2|GS14a,NIAv2|GS15a,NIAv2|GS16a,NIAv2|NS5j,NIAv2|NS13a,NIAv2|NS13b,NIAv2|NS13c,NIAv2|NS14,NIAv2|SS13c,NIAv2|SS14e,NIAv2|SS15a,NIAv2|SS15c,NIAv2|SS23,NIAv2|SS27a,NIAv2|SS27b,NIAv2|SS29,NIAv2|SS32,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.2,PCI-DSSv3.2.1|7.1.2,PCI-DSSv3.2.1|10.5.5,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|7.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.4,SWIFT-CSCv1|2.5,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,TBA-FIISB|35.1,TBA-FIISB|36.1,TBA-FIISB|43.1"
  see_also    : "https://github.com/cisagov/ScubaGear/tree/v1.5.0/"
  name        : "MS.AAD.5.2v1"
</custom_item>

<custom_item>
  type        : POLICY
  description : "MS.AAD.5.3v1 - An admin consent workflow SHALL be configured for applications."
  info        : "Configuring an admin consent workflow reduces the risk of the previous policy by setting up a process for users to securely request access to applications necessary for business purposes. Administrators have the opportunity to review the permissions requested by new applications and approve or deny access based on a risk assessment."
  solution    : "1. In Microsoft Entra admin center create a new Microsoft Entra ID Group that contains admin users responsible for reviewing and adjudicating application consent requests. Group members will be notified when users request consent for new applications.

2. Then in Microsoft Entra admin center under Applications, select Enterprise Applications.

3. Under Security, select Consent and permissions. Then select Admin consent settings.

4. Under Admin consent requests > Users can request admin consent to apps they are unable to consent to select Yes.

5. Under Who can review admin consent requests, select + Add groups and select the group responsible for reviewing and adjudicating app requests (created in step one above).

6. Click Save."
  reference   : "800-171|3.1.1,800-171|3.1.3,800-171|3.1.4,800-171|3.1.5,800-171|3.1.20,800-171|3.4.2,800-171|3.4.5,800-171|3.4.6,800-171|3.4.7,800-171|3.5.1,800-171|3.5.2,800-171|3.13.1,800-171|3.13.5,800-171|3.14.6,800-171|3.14.7,800-171r3|03.01.01,800-171r3|03.01.02,800-171r3|03.01.03,800-171r3|03.01.04,800-171r3|03.01.05a.,800-171r3|03.01.20,800-171r3|03.04.02,800-171r3|03.04.05,800-171r3|03.04.06,800-171r3|03.05.01a.,800-171r3|03.05.12,800-171r3|03.13.01,800-171r3|03.14.06,800-53|AC-2,800-53|AC-3,800-53|AC-4,800-53|AC-5,800-53|AC-6,800-53|AC-20,800-53|CM-5,800-53|CM-6,800-53|CM-7,800-53|IA-2,800-53|IA-5,800-53|SC-7,800-53|SI-4,800-53|SI-7,800-53r5|AC-2,800-53r5|AC-3,800-53r5|AC-4,800-53r5|AC-5,800-53r5|AC-6,800-53r5|AC-20,800-53r5|CM-5,800-53r5|CM-6,800-53r5|CM-7,800-53r5|IA-2,800-53r5|IA-5,800-53r5|SC-7,800-53r5|SI-4,800-53r5|SI-7,CISA_BOD|25-01_Required,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(d),CN-L3|7.1.3.2(g),CN-L3|7.1.3.5(a),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(a),CN-L3|8.1.10.6(f),CN-L3|8.1.10.6(j),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.AM-3,CSF|ID.AM-4,CSF|ID.RA-1,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.AC-4,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.DS-6,CSF|PR.IP-1,CSF|PR.IP-8,CSF|PR.PT-3,CSF|PR.PT-4,CSF|RS.AN-1,CSF|RS.CO-3,CSF2.0|DE.AE-02,CSF2.0|DE.AE-03,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|DE.CM-06,CSF2.0|DE.CM-09,CSF2.0|ID.AM-02,CSF2.0|ID.AM-03,CSF2.0|ID.AM-04,CSF2.0|ID.IM-01,CSF2.0|ID.IM-02,CSF2.0|ID.IM-03,CSF2.0|ID.RA-01,CSF2.0|ID.RA-09,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,CSF2.0|PR.AA-05,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,CSF2.0|PR.IR-01,CSF2.0|PR.PS-01,CSF2.0|PR.PS-02,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(b),HIPAA|164.312(c)(1),HIPAA|164.312(c)(2),HIPAA|164.312(d),HIPAA|164.312(e)(2)(i),ISO-27001-2022|A.5.3,ISO-27001-2022|A.5.14,ISO-27001-2022|A.5.15,ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.17,ISO-27001-2022|A.5.18,ISO-27001-2022|A.5.33,ISO-27001-2022|A.7.9,ISO-27001-2022|A.8.2,ISO-27001-2022|A.8.3,ISO-27001-2022|A.8.4,ISO-27001-2022|A.8.9,ISO-27001-2022|A.8.16,ISO-27001-2022|A.8.18,ISO-27001-2022|A.8.19,ISO-27001-2022|A.8.20,ISO-27001-2022|A.8.22,ISO-27001-2022|A.8.31,ISO-27001-2022|A.8.32,ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ISO/IEC-27001|A.13.1.3,ITSG-33|AC-2,ITSG-33|AC-3,ITSG-33|AC-4,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|AC-20,ITSG-33|CM-5,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|IA-2,ITSG-33|IA-2a.,ITSG-33|IA-5,ITSG-33|SC-7,ITSG-33|SI-4,ITSG-33|SI-7,ITSG-33|SI-7a.,NESA|M1.2.2,NESA|M1.3.5,NESA|T1.2.3,NESA|T2.3.8,NESA|T3.2.3,NESA|T3.4.1,NESA|T4.2.1,NESA|T4.5.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.2.3,NESA|T5.3.1,NESA|T5.4.1,NESA|T5.4.2,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.4.6,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NESA|T5.5.4,NESA|T5.6.1,NESA|T5.7.2,NESA|T7.3.2,NESA|T7.3.3,NESA|T7.5.1,NESA|T7.5.2,NESA|T7.5.3,NESA|T7.6.3,NESA|T7.6.4,NIAv2|AM1,NIAv2|AM2,NIAv2|AM3,NIAv2|AM8,NIAv2|AM14b,NIAv2|AM23f,NIAv2|AM28,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS11a,NIAv2|GS12a,NIAv2|GS14a,NIAv2|GS15a,NIAv2|GS16a,NIAv2|NS5j,NIAv2|NS13a,NIAv2|NS13b,NIAv2|NS13c,NIAv2|NS14,NIAv2|SS13c,NIAv2|SS14e,NIAv2|SS15a,NIAv2|SS15c,NIAv2|SS23,NIAv2|SS27a,NIAv2|SS27b,NIAv2|SS29,NIAv2|SS32,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.2,PCI-DSSv3.2.1|7.1.2,PCI-DSSv3.2.1|10.5.5,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|7.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.4,SWIFT-CSCv1|2.5,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,TBA-FIISB|35.1,TBA-FIISB|36.1,TBA-FIISB|43.1"
  see_also    : "https://github.com/cisagov/ScubaGear/tree/v1.5.0/"
  name        : "MS.AAD.5.3v1"
</custom_item>

<custom_item>
  type        : POLICY
  description : "MS.AAD.5.4v1 - Group owners SHALL NOT be allowed to consent to applications."
  info        : "In M365, group owners and team owners can consent to applications accessing data in the tenant. By requiring consent requests to go through an approval workflow, risk of exposure to malicious applications is reduced.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. In Microsoft Entra admin center under Applications, select Enterprise Applications.

2. Under Security, select Consent and permissions. Then select User Consent Settings.

3. Under Group owner consent for apps accessing data, select Do not allow group owner consent.

4. Click Save."
  reference   : "800-171|3.1.1,800-171|3.1.3,800-171|3.1.4,800-171|3.1.5,800-171|3.1.20,800-171|3.4.2,800-171|3.4.5,800-171|3.4.6,800-171|3.4.7,800-171|3.5.1,800-171|3.5.2,800-171|3.13.1,800-171|3.13.5,800-171|3.14.6,800-171|3.14.7,800-171r3|03.01.01,800-171r3|03.01.02,800-171r3|03.01.03,800-171r3|03.01.04,800-171r3|03.01.05a.,800-171r3|03.01.20,800-171r3|03.04.02,800-171r3|03.04.05,800-171r3|03.04.06,800-171r3|03.05.01a.,800-171r3|03.05.12,800-171r3|03.13.01,800-171r3|03.14.06,800-53|AC-2,800-53|AC-3,800-53|AC-4,800-53|AC-5,800-53|AC-6,800-53|AC-20,800-53|CM-5,800-53|CM-6,800-53|CM-7,800-53|IA-2,800-53|IA-5,800-53|SC-7,800-53|SI-4,800-53|SI-7,800-53r5|AC-2,800-53r5|AC-3,800-53r5|AC-4,800-53r5|AC-5,800-53r5|AC-6,800-53r5|AC-20,800-53r5|CM-5,800-53r5|CM-6,800-53r5|CM-7,800-53r5|IA-2,800-53r5|IA-5,800-53r5|SC-7,800-53r5|SI-4,800-53r5|SI-7,CISA_BOD|25-01_Required,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(d),CN-L3|7.1.3.2(g),CN-L3|7.1.3.5(a),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(a),CN-L3|8.1.10.6(f),CN-L3|8.1.10.6(j),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.AM-3,CSF|ID.AM-4,CSF|ID.RA-1,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.AC-4,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.DS-6,CSF|PR.IP-1,CSF|PR.IP-8,CSF|PR.PT-3,CSF|PR.PT-4,CSF|RS.AN-1,CSF|RS.CO-3,CSF2.0|DE.AE-02,CSF2.0|DE.AE-03,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|DE.CM-06,CSF2.0|DE.CM-09,CSF2.0|ID.AM-02,CSF2.0|ID.AM-03,CSF2.0|ID.AM-04,CSF2.0|ID.IM-01,CSF2.0|ID.IM-02,CSF2.0|ID.IM-03,CSF2.0|ID.RA-01,CSF2.0|ID.RA-09,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,CSF2.0|PR.AA-05,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,CSF2.0|PR.IR-01,CSF2.0|PR.PS-01,CSF2.0|PR.PS-02,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(b),HIPAA|164.312(c)(1),HIPAA|164.312(c)(2),HIPAA|164.312(d),HIPAA|164.312(e)(2)(i),ISO-27001-2022|A.5.3,ISO-27001-2022|A.5.14,ISO-27001-2022|A.5.15,ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.17,ISO-27001-2022|A.5.18,ISO-27001-2022|A.5.33,ISO-27001-2022|A.7.9,ISO-27001-2022|A.8.2,ISO-27001-2022|A.8.3,ISO-27001-2022|A.8.4,ISO-27001-2022|A.8.9,ISO-27001-2022|A.8.16,ISO-27001-2022|A.8.18,ISO-27001-2022|A.8.19,ISO-27001-2022|A.8.20,ISO-27001-2022|A.8.22,ISO-27001-2022|A.8.31,ISO-27001-2022|A.8.32,ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ISO/IEC-27001|A.13.1.3,ITSG-33|AC-2,ITSG-33|AC-3,ITSG-33|AC-4,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|AC-20,ITSG-33|CM-5,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|IA-2,ITSG-33|IA-2a.,ITSG-33|IA-5,ITSG-33|SC-7,ITSG-33|SI-4,ITSG-33|SI-7,ITSG-33|SI-7a.,NESA|M1.2.2,NESA|M1.3.5,NESA|T1.2.3,NESA|T2.3.8,NESA|T3.2.3,NESA|T3.4.1,NESA|T4.2.1,NESA|T4.5.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.2.3,NESA|T5.3.1,NESA|T5.4.1,NESA|T5.4.2,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.4.6,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NESA|T5.5.4,NESA|T5.6.1,NESA|T5.7.2,NESA|T7.3.2,NESA|T7.3.3,NESA|T7.5.1,NESA|T7.5.2,NESA|T7.5.3,NESA|T7.6.3,NESA|T7.6.4,NIAv2|AM1,NIAv2|AM2,NIAv2|AM3,NIAv2|AM8,NIAv2|AM14b,NIAv2|AM23f,NIAv2|AM28,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS11a,NIAv2|GS12a,NIAv2|GS14a,NIAv2|GS15a,NIAv2|GS16a,NIAv2|NS5j,NIAv2|NS13a,NIAv2|NS13b,NIAv2|NS13c,NIAv2|NS14,NIAv2|SS13c,NIAv2|SS14e,NIAv2|SS15a,NIAv2|SS15c,NIAv2|SS23,NIAv2|SS27a,NIAv2|SS27b,NIAv2|SS29,NIAv2|SS32,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.2,PCI-DSSv3.2.1|7.1.2,PCI-DSSv3.2.1|10.5.5,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|7.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.4,SWIFT-CSCv1|2.5,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,TBA-FIISB|35.1,TBA-FIISB|36.1,TBA-FIISB|43.1"
  see_also    : "https://github.com/cisagov/ScubaGear/tree/v1.5.0/"
  name        : "MS.AAD.5.4v1"
  severity    : MEDIUM
</custom_item>

<custom_item>
  type        : POLICY
  description : "MS.AAD.6.1v1 - User passwords SHALL NOT expire."
  info        : "The National Institute of Standards and Technology (NIST), OMB, and Microsoft have published guidance indicating mandated periodic password changes make user accounts less secure. For example, OMB-22-09 states, \"Password policies must not require use of special characters or regular rotation.\""
  solution    : "1. [Configure the Password expiration policy to Set passwords to never expire](https://learn.microsoft.com/en-us/microsoft-365/admin/manage/set-password-expiration-policy?view=o365-worldwide#set-password-expiration-policy)."
  reference   : "800-171|3.4.2,800-171r3|03.04.02a.,800-53|CM-6b.,800-53r5|CM-6b.,CISA_BOD|25-01_Required,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6b.,NESA|T3.2.1,SWIFT-CSCv1|2.3"
  see_also    : "https://github.com/cisagov/ScubaGear/tree/v1.5.0/"
  name        : "MS.AAD.6.1v1"
</custom_item>

<custom_item>
  type        : POLICY
  description : "MS.AAD.7.1v1 - A minimum of two users and a maximum of eight users SHALL be provisioned with the Global Administrator role."
  info        : "The Global Administrator role provides unfettered access to the tenant. Limiting the number of users with this level of access makes tenant compromise more challenging. Microsoft recommends fewer than five users in the Global Administrator role. However, additional user accounts, up to eight, may be necessary to support emergency access and some operational scenarios."
  solution    : "When counting the number of users assigned to the Global Administrator role, count each user only once.

1. In Microsoft Entra admin center count the number of users assigned to the Global Administrator role. Count users that are assigned directly to the role and users assigned via group membership. If you have Microsoft Entra ID PIM, count both the Eligible assignments and Active assignments. If any of the groups assigned to Global Administrator are enrolled in PIM for Groups, also count the number of group members from the PIM for Groups portal Eligible assignments.

2. Validate that there are a total of two to eight users assigned to the Global Administrator role."
  reference   : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.1.20,800-171|3.4.2,800-171|3.4.5,800-171|3.5.1,800-171|3.5.2,800-171|3.14.6,800-171|3.14.7,800-171r3|03.01.01,800-171r3|03.01.02,800-171r3|03.01.04,800-171r3|03.01.05a.,800-171r3|03.01.20,800-171r3|03.04.02,800-171r3|03.04.05,800-171r3|03.05.01a.,800-171r3|03.05.12,800-171r3|03.14.06,800-53|AC-2,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|AC-20,800-53|CM-5,800-53|CM-6,800-53|IA-2,800-53|IA-5,800-53|SI-4,800-53|SI-7,800-53r5|AC-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|AC-20,800-53r5|CM-5,800-53r5|CM-6,800-53r5|IA-2,800-53r5|IA-5,800-53r5|SI-4,800-53r5|SI-7,CISA_BOD|25-01_Required,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(d),CN-L3|7.1.3.2(g),CN-L3|7.1.3.5(a),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(a),CN-L3|8.1.10.6(f),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.AM-4,CSF|ID.RA-1,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.DS-6,CSF|PR.IP-1,CSF|PR.IP-8,CSF|PR.PT-3,CSF|RS.AN-1,CSF|RS.CO-3,CSF2.0|DE.AE-02,CSF2.0|DE.AE-03,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|DE.CM-06,CSF2.0|DE.CM-09,CSF2.0|ID.AM-02,CSF2.0|ID.AM-04,CSF2.0|ID.IM-01,CSF2.0|ID.IM-02,CSF2.0|ID.IM-03,CSF2.0|ID.RA-01,CSF2.0|ID.RA-09,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,CSF2.0|PR.AA-05,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,CSF2.0|PR.IR-01,CSF2.0|PR.PS-01,CSF2.0|PR.PS-02,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(b),HIPAA|164.312(c)(1),HIPAA|164.312(c)(2),HIPAA|164.312(d),HIPAA|164.312(e)(2)(i),ISO-27001-2022|A.5.3,ISO-27001-2022|A.5.14,ISO-27001-2022|A.5.15,ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.17,ISO-27001-2022|A.5.18,ISO-27001-2022|A.5.33,ISO-27001-2022|A.7.9,ISO-27001-2022|A.8.2,ISO-27001-2022|A.8.3,ISO-27001-2022|A.8.4,ISO-27001-2022|A.8.9,ISO-27001-2022|A.8.16,ISO-27001-2022|A.8.18,ISO-27001-2022|A.8.19,ISO-27001-2022|A.8.20,ISO-27001-2022|A.8.31,ISO-27001-2022|A.8.32,ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-2,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|AC-20,ITSG-33|CM-5,ITSG-33|CM-6,ITSG-33|IA-2,ITSG-33|IA-2a.,ITSG-33|IA-5,ITSG-33|SI-4,ITSG-33|SI-7,ITSG-33|SI-7a.,NESA|M1.2.2,NESA|M1.3.5,NESA|T1.2.3,NESA|T2.3.8,NESA|T3.2.3,NESA|T3.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.2.3,NESA|T5.3.1,NESA|T5.4.1,NESA|T5.4.2,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.3.2,NESA|T7.3.3,NESA|T7.5.1,NESA|T7.5.2,NESA|T7.5.3,NESA|T7.6.3,NIAv2|AM1,NIAv2|AM2,NIAv2|AM3,NIAv2|AM8,NIAv2|AM14b,NIAv2|AM23f,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS13c,NIAv2|SS14e,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv3.2.1|10.5.5,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|7.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://github.com/cisagov/ScubaGear/tree/v1.5.0/"
  name        : "MS.AAD.7.1v1"
</custom_item>

<custom_item>
  type        : POLICY
  description : "MS.AAD.7.2v1 - Privileged users SHALL be provisioned with finer-grained roles instead of Global Administrator."
  info        : "Many privileged administrative users do not need unfettered access to the tenant to perform their duties. By assigning them to roles based on least privilege, the risks associated with having their accounts compromised are reduced."
  solution    : "This policy is based on the ratio below:

`X = (Number of users assigned to the Global Administrator role) / (Number of users assigned to other highly privileged roles)`

1. Follow the instructions for policy MS.AAD.7.1v1 above to get a count of users assigned to the Global Administrator role.

2. Follow the instructions for policy MS.AAD.7.1v1 above but get a count of users assigned to the other highly privileged roles (not Global Administrator). If a user is assigned to both Global Administrator and other roles, only count that user for the Global Administrator assignment.

3. Divide the value from step 2 from the value from step 1 to calculate X. If X is less than or equal to 1 then the tenant is compliant with the policy."
  reference   : "800-171|3.1.1,800-171|3.1.3,800-171|3.1.4,800-171|3.1.5,800-171|3.1.20,800-171|3.4.2,800-171|3.4.5,800-171|3.4.6,800-171|3.4.7,800-171|3.5.1,800-171|3.5.2,800-171|3.13.1,800-171|3.13.5,800-171|3.14.6,800-171|3.14.7,800-171r3|03.01.01,800-171r3|03.01.02,800-171r3|03.01.03,800-171r3|03.01.04,800-171r3|03.01.05a.,800-171r3|03.01.20,800-171r3|03.04.02,800-171r3|03.04.05,800-171r3|03.04.06,800-171r3|03.05.01a.,800-171r3|03.05.12,800-171r3|03.13.01,800-171r3|03.14.06,800-53|AC-2,800-53|AC-3,800-53|AC-4,800-53|AC-5,800-53|AC-6,800-53|AC-20,800-53|CM-5,800-53|CM-6,800-53|CM-7,800-53|IA-2,800-53|IA-5,800-53|SC-7,800-53|SI-4,800-53|SI-7,800-53r5|AC-2,800-53r5|AC-3,800-53r5|AC-4,800-53r5|AC-5,800-53r5|AC-6,800-53r5|AC-20,800-53r5|CM-5,800-53r5|CM-6,800-53r5|CM-7,800-53r5|IA-2,800-53r5|IA-5,800-53r5|SC-7,800-53r5|SI-4,800-53r5|SI-7,CISA_BOD|25-01_Required,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(d),CN-L3|7.1.3.2(g),CN-L3|7.1.3.5(a),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(a),CN-L3|8.1.10.6(f),CN-L3|8.1.10.6(j),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.AM-3,CSF|ID.AM-4,CSF|ID.RA-1,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.AC-4,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.DS-6,CSF|PR.IP-1,CSF|PR.IP-8,CSF|PR.PT-3,CSF|PR.PT-4,CSF|RS.AN-1,CSF|RS.CO-3,CSF2.0|DE.AE-02,CSF2.0|DE.AE-03,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|DE.CM-06,CSF2.0|DE.CM-09,CSF2.0|ID.AM-02,CSF2.0|ID.AM-03,CSF2.0|ID.AM-04,CSF2.0|ID.IM-01,CSF2.0|ID.IM-02,CSF2.0|ID.IM-03,CSF2.0|ID.RA-01,CSF2.0|ID.RA-09,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,CSF2.0|PR.AA-05,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,CSF2.0|PR.IR-01,CSF2.0|PR.PS-01,CSF2.0|PR.PS-02,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(b),HIPAA|164.312(c)(1),HIPAA|164.312(c)(2),HIPAA|164.312(d),HIPAA|164.312(e)(2)(i),ISO-27001-2022|A.5.3,ISO-27001-2022|A.5.14,ISO-27001-2022|A.5.15,ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.17,ISO-27001-2022|A.5.18,ISO-27001-2022|A.5.33,ISO-27001-2022|A.7.9,ISO-27001-2022|A.8.2,ISO-27001-2022|A.8.3,ISO-27001-2022|A.8.4,ISO-27001-2022|A.8.9,ISO-27001-2022|A.8.16,ISO-27001-2022|A.8.18,ISO-27001-2022|A.8.19,ISO-27001-2022|A.8.20,ISO-27001-2022|A.8.22,ISO-27001-2022|A.8.31,ISO-27001-2022|A.8.32,ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ISO/IEC-27001|A.13.1.3,ITSG-33|AC-2,ITSG-33|AC-3,ITSG-33|AC-4,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|AC-20,ITSG-33|CM-5,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|IA-2,ITSG-33|IA-2a.,ITSG-33|IA-5,ITSG-33|SC-7,ITSG-33|SI-4,ITSG-33|SI-7,ITSG-33|SI-7a.,NESA|M1.2.2,NESA|M1.3.5,NESA|T1.2.3,NESA|T2.3.8,NESA|T3.2.3,NESA|T3.4.1,NESA|T4.2.1,NESA|T4.5.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.2.3,NESA|T5.3.1,NESA|T5.4.1,NESA|T5.4.2,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.4.6,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NESA|T5.5.4,NESA|T5.6.1,NESA|T5.7.2,NESA|T7.3.2,NESA|T7.3.3,NESA|T7.5.1,NESA|T7.5.2,NESA|T7.5.3,NESA|T7.6.3,NESA|T7.6.4,NIAv2|AM1,NIAv2|AM2,NIAv2|AM3,NIAv2|AM8,NIAv2|AM14b,NIAv2|AM23f,NIAv2|AM28,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS11a,NIAv2|GS12a,NIAv2|GS14a,NIAv2|GS15a,NIAv2|GS16a,NIAv2|NS5j,NIAv2|NS13a,NIAv2|NS13b,NIAv2|NS13c,NIAv2|NS14,NIAv2|SS13c,NIAv2|SS14e,NIAv2|SS15a,NIAv2|SS15c,NIAv2|SS23,NIAv2|SS27a,NIAv2|SS27b,NIAv2|SS29,NIAv2|SS32,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.2,PCI-DSSv3.2.1|7.1.2,PCI-DSSv3.2.1|10.5.5,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|7.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.4,SWIFT-CSCv1|2.5,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,TBA-FIISB|35.1,TBA-FIISB|36.1,TBA-FIISB|43.1"
  see_also    : "https://github.com/cisagov/ScubaGear/tree/v1.5.0/"
  name        : "MS.AAD.7.2v1"
</custom_item>

<custom_item>
  type        : POLICY
  description : "MS.AAD.7.3v1 - Privileged users SHALL be provisioned cloud-only accounts separate from an on-premises directory or other federated identity providers."
  info        : "By provisioning cloud-only Microsoft Entra ID user accounts to privileged users, the risks associated with a compromise of on-premises federation infrastructure are reduced. It is more challenging for the adversary to pivot from the compromised environment to the cloud with privileged access."
  solution    : "1. Perform the steps below for each highly privileged role. We reference the Global Administrator role as an example.

2. Create a list of all the users assigned to the Global Administrator role. Include users that are assigned directly to the role and users assigned via group membership. If you have Microsoft Entra ID PIM, include both the Eligible assignments and Active assignments. If any of the groups assigned to Global Administrator are enrolled in PIM for Groups, also include group members from the PIM for Groups portal Eligible assignments.

3. For each highly privileged user in the list, execute the Powershell code below but replace the `username@somedomain.com` with the principal name of the user who is specific to your environment. You can get the data value from the Principal name field displayed in the Microsoft Entra ID portal.

 Connect-MgGraph
 Get-MgBetaUser -Filter \"userPrincipalName eq 'username@somedomain.com'\" | FL

6. Review the output field named OnPremisesImmutableId. If this field contains a data value, it means that the user is not cloud-only. If the user is not cloud-only, create a cloud-only account for that user, assign the user to their respective roles and then remove the account that is not cloud-only from Microsoft Entra ID."
  reference   : "800-171|3.1.1,800-171|3.1.5,800-171|3.3.1,800-171|3.3.2,800-171|3.5.1,800-171r3|03.01.01,800-171r3|03.01.02,800-171r3|03.01.05a.,800-171r3|03.03.01,800-171r3|03.05.01a.,800-171r3|03.05.01b.,800-171r3|03.15.01,800-53|AC-1,800-53|AC-2,800-53|AC-3,800-53|AC-6,800-53|AU-1,800-53|AU-2,800-53|IA-2,800-53|IA-11,800-53r5|AC-1,800-53r5|AC-2,800-53r5|AC-3,800-53r5|AC-6,800-53r5|AU-1,800-53r5|AU-2,800-53r5|IA-2,800-53r5|IA-11,CISA_BOD|25-01_Required,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(d),CN-L3|7.1.3.2(g),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(e),CN-L3|8.1.4.2(f),CN-L3|8.1.4.3(a),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.1.10.6(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-1,CSF|PR.PT-3,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|GV.OC-03,CSF2.0|GV.OV-01,CSF2.0|GV.PO-01,CSF2.0|GV.PO-02,CSF2.0|GV.SC-03,CSF2.0|ID.IM-01,CSF2.0|ID.IM-02,CSF2.0|ID.IM-03,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,CSF2.0|PR.AA-05,CSF2.0|PR.DS-10,CSF2.0|PR.IR-01,CSF2.0|PR.PS-04,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(b),HIPAA|164.312(d),ISO-27001-2022|A.5.1,ISO-27001-2022|A.5.2,ISO-27001-2022|A.5.4,ISO-27001-2022|A.5.15,ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.18,ISO-27001-2022|A.5.31,ISO-27001-2022|A.5.33,ISO-27001-2022|A.5.36,ISO-27001-2022|A.5.37,ISO-27001-2022|A.8.2,ISO-27001-2022|A.8.3,ISO-27001-2022|A.8.15,ISO-27001-2022|A.8.18,ISO-27001-2022|A.8.20,ISO-27001-2022|5.2,ISO-27001-2022|5.3,ISO-27001-2022|7.5.1,ISO-27001-2022|7.5.2,ISO-27001-2022|7.5.3,ISO/IEC-27001|A.9.1.1,ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-1,ITSG-33|AC-2,ITSG-33|AC-3,ITSG-33|AC-6,ITSG-33|AU-1,ITSG-33|AU-2,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|M1.2.2,NESA|M5.5.1,NESA|T2.3.8,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.3.1,NESA|T5.4.1,NESA|T5.4.2,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM2,NIAv2|AM3,NIAv2|AM7,NIAv2|AM8,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|AM14b,NIAv2|AM23f,NIAv2|AM28,NIAv2|AM29,NIAv2|AM30,NIAv2|NS5j,NIAv2|SS13c,NIAv2|SS14e,NIAv2|SS15c,NIAv2|SS29,NIAv2|SS30,NIAv2|VL8,PCI-DSSv3.2.1|7.1.2,PCI-DSSv3.2.1|10.8,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|5.1,SWIFT-CSCv1|6.4,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://github.com/cisagov/ScubaGear/tree/v1.5.0/"
  name        : "MS.AAD.7.3v1"
</custom_item>

<custom_item>
  type        : POLICY
  description : "MS.AAD.7.4v1 - Permanent active role assignments SHALL NOT be allowed for highly privileged roles."
  info        : "Instead of giving users permanent assignments to privileged roles, provisioning access just in time lessens exposure if those accounts become compromised. In Microsoft Entra ID PIM or an alternative PAM system, just in time access can be provisioned by assigning users to roles as eligible instead of perpetually active."
  solution    : "1. In Microsoft Entra admin center select Roles and administrators. Perform the steps below for each highly privileged role. We reference the Global Administrator role as an example.

2. Select the Global administrator role.

3. Under Manage, select Assignments and click the Active assignments tab.

4. Verify there are no users or groups with a value of Permanent in the End time column. If there are any, recreate those assignments to have an expiration date using Microsoft Entra ID PIM or an alternative PAM system. If a group is identified and it is enrolled in PIM for Groups, see the exception cases below for details.

Exception cases:
- Emergency access accounts that require perpetual active assignment.
- Service accounts that require perpetual active assignment.
- If using PIM for Groups, a group that is enrolled in PIM is allowed to have a perpetual active assignment to a role because activation is handled by PIM for Groups."
  reference   : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.1.20,800-171|3.4.2,800-171|3.4.5,800-171|3.5.1,800-171|3.5.2,800-171|3.14.6,800-171|3.14.7,800-171r3|03.01.01,800-171r3|03.01.02,800-171r3|03.01.04,800-171r3|03.01.05a.,800-171r3|03.01.20,800-171r3|03.04.02,800-171r3|03.04.05,800-171r3|03.05.01a.,800-171r3|03.05.12,800-171r3|03.14.06,800-53|AC-2,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|AC-20,800-53|CM-5,800-53|CM-6,800-53|IA-2,800-53|IA-5,800-53|SI-4,800-53|SI-7,800-53r5|AC-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|AC-20,800-53r5|CM-5,800-53r5|CM-6,800-53r5|IA-2,800-53r5|IA-5,800-53r5|SI-4,800-53r5|SI-7,CISA_BOD|25-01_Required,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(d),CN-L3|7.1.3.2(g),CN-L3|7.1.3.5(a),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(a),CN-L3|8.1.10.6(f),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.AM-4,CSF|ID.RA-1,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.DS-6,CSF|PR.IP-1,CSF|PR.IP-8,CSF|PR.PT-3,CSF|RS.AN-1,CSF|RS.CO-3,CSF2.0|DE.AE-02,CSF2.0|DE.AE-03,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|DE.CM-06,CSF2.0|DE.CM-09,CSF2.0|ID.AM-02,CSF2.0|ID.AM-04,CSF2.0|ID.IM-01,CSF2.0|ID.IM-02,CSF2.0|ID.IM-03,CSF2.0|ID.RA-01,CSF2.0|ID.RA-09,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,CSF2.0|PR.AA-05,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,CSF2.0|PR.IR-01,CSF2.0|PR.PS-01,CSF2.0|PR.PS-02,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(b),HIPAA|164.312(c)(1),HIPAA|164.312(c)(2),HIPAA|164.312(d),HIPAA|164.312(e)(2)(i),ISO-27001-2022|A.5.3,ISO-27001-2022|A.5.14,ISO-27001-2022|A.5.15,ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.17,ISO-27001-2022|A.5.18,ISO-27001-2022|A.5.33,ISO-27001-2022|A.7.9,ISO-27001-2022|A.8.2,ISO-27001-2022|A.8.3,ISO-27001-2022|A.8.4,ISO-27001-2022|A.8.9,ISO-27001-2022|A.8.16,ISO-27001-2022|A.8.18,ISO-27001-2022|A.8.19,ISO-27001-2022|A.8.20,ISO-27001-2022|A.8.31,ISO-27001-2022|A.8.32,ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-2,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|AC-20,ITSG-33|CM-5,ITSG-33|CM-6,ITSG-33|IA-2,ITSG-33|IA-2a.,ITSG-33|IA-5,ITSG-33|SI-4,ITSG-33|SI-7,ITSG-33|SI-7a.,NESA|M1.2.2,NESA|M1.3.5,NESA|T1.2.3,NESA|T2.3.8,NESA|T3.2.3,NESA|T3.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.2.3,NESA|T5.3.1,NESA|T5.4.1,NESA|T5.4.2,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.3.2,NESA|T7.3.3,NESA|T7.5.1,NESA|T7.5.2,NESA|T7.5.3,NESA|T7.6.3,NIAv2|AM1,NIAv2|AM2,NIAv2|AM3,NIAv2|AM8,NIAv2|AM14b,NIAv2|AM23f,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS13c,NIAv2|SS14e,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv3.2.1|10.5.5,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|7.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://github.com/cisagov/ScubaGear/tree/v1.5.0/"
  name        : "MS.AAD.7.4v1"
</custom_item>

<custom_item>
  type        : POLICY
  description : "MS.AAD.7.5v1 - Provisioning users to highly privileged roles SHALL NOT occur outside of a PAM system."
  info        : "Provisioning users to privileged roles within a PAM system enables enforcement of numerous privileged access policies and monitoring. If privileged users are assigned directly to roles in the M365 admin center or via PowerShell outside of the context of a PAM system, a significant set of critical security capabilities are bypassed."
  solution    : "1. Perform the steps below for each highly privileged role. We reference the Global Administrator role as an example.

2. In Microsoft Entra admin center select Roles and administrators.

3. Select the Global administrator role.

4. Under Manage, select Assignments and click the Active assignments tab.

5. For each user or group listed, examine the value in the Start time column. If it contains a value of -, this indicates the respective user/group was assigned to that role outside of Microsoft Entra ID PIM. If the role was assigned outside of Microsoft Entra ID PIM, delete the assignment and recreate it using Microsoft Entra ID PIM."
  reference   : "800-171|3.4.2,800-171r3|03.04.02a.,800-53|CM-6b.,800-53r5|CM-6b.,CISA_BOD|25-01_Required,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6b.,NESA|T3.2.1,SWIFT-CSCv1|2.3"
  see_also    : "https://github.com/cisagov/ScubaGear/tree/v1.5.0/"
  name        : "MS.AAD.7.5v1"
</custom_item>

<custom_item>
  type        : POLICY
  description : "MS.AAD.7.6v1 - Activation of the Global Administrator role SHALL require approval."
  info        : "Requiring approval for a user to activate Global Administrator, which provides unfettered access, makes it more challenging for an attacker to compromise the tenant with stolen credentials and it provides visibility of activities indicating a compromise is taking place."
  solution    : "1. In Microsoft Entra Privileged Identity Management (PIM), under Manage, select Microsoft Entra roles.

2. Under Manage, select Roles.

 1. Select the Global Administrator role in the list.
 2. Click Settings.
 3. Click Edit.
 4. Select the Require approval to activate option.
 5. Click Update.

3. Review the list of groups that are actively assigned to the Global Administrator role. If any of the groups are enrolled in PIM for Groups, then also apply the same configurations under step 2 above to each PIM group's Member settings."
  reference   : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.1.20,800-171|3.4.2,800-171|3.4.5,800-171|3.5.1,800-171|3.5.2,800-171|3.14.6,800-171|3.14.7,800-171r3|03.01.01,800-171r3|03.01.02,800-171r3|03.01.04,800-171r3|03.01.05a.,800-171r3|03.01.20,800-171r3|03.04.02,800-171r3|03.04.05,800-171r3|03.05.01a.,800-171r3|03.05.12,800-171r3|03.14.06,800-53|AC-2,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|AC-20,800-53|CM-5,800-53|CM-6,800-53|IA-2,800-53|IA-5,800-53|SI-4,800-53|SI-7,800-53r5|AC-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|AC-20,800-53r5|CM-5,800-53r5|CM-6,800-53r5|IA-2,800-53r5|IA-5,800-53r5|SI-4,800-53r5|SI-7,CISA_BOD|25-01_Required,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(d),CN-L3|7.1.3.2(g),CN-L3|7.1.3.5(a),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(a),CN-L3|8.1.10.6(f),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.AM-4,CSF|ID.RA-1,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.DS-6,CSF|PR.IP-1,CSF|PR.IP-8,CSF|PR.PT-3,CSF|RS.AN-1,CSF|RS.CO-3,CSF2.0|DE.AE-02,CSF2.0|DE.AE-03,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|DE.CM-06,CSF2.0|DE.CM-09,CSF2.0|ID.AM-02,CSF2.0|ID.AM-04,CSF2.0|ID.IM-01,CSF2.0|ID.IM-02,CSF2.0|ID.IM-03,CSF2.0|ID.RA-01,CSF2.0|ID.RA-09,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,CSF2.0|PR.AA-05,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,CSF2.0|PR.IR-01,CSF2.0|PR.PS-01,CSF2.0|PR.PS-02,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(b),HIPAA|164.312(c)(1),HIPAA|164.312(c)(2),HIPAA|164.312(d),HIPAA|164.312(e)(2)(i),ISO-27001-2022|A.5.3,ISO-27001-2022|A.5.14,ISO-27001-2022|A.5.15,ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.17,ISO-27001-2022|A.5.18,ISO-27001-2022|A.5.33,ISO-27001-2022|A.7.9,ISO-27001-2022|A.8.2,ISO-27001-2022|A.8.3,ISO-27001-2022|A.8.4,ISO-27001-2022|A.8.9,ISO-27001-2022|A.8.16,ISO-27001-2022|A.8.18,ISO-27001-2022|A.8.19,ISO-27001-2022|A.8.20,ISO-27001-2022|A.8.31,ISO-27001-2022|A.8.32,ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-2,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|AC-20,ITSG-33|CM-5,ITSG-33|CM-6,ITSG-33|IA-2,ITSG-33|IA-2a.,ITSG-33|IA-5,ITSG-33|SI-4,ITSG-33|SI-7,ITSG-33|SI-7a.,NESA|M1.2.2,NESA|M1.3.5,NESA|T1.2.3,NESA|T2.3.8,NESA|T3.2.3,NESA|T3.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.2.3,NESA|T5.3.1,NESA|T5.4.1,NESA|T5.4.2,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.3.2,NESA|T7.3.3,NESA|T7.5.1,NESA|T7.5.2,NESA|T7.5.3,NESA|T7.6.3,NIAv2|AM1,NIAv2|AM2,NIAv2|AM3,NIAv2|AM8,NIAv2|AM14b,NIAv2|AM23f,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS13c,NIAv2|SS14e,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv3.2.1|10.5.5,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|7.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://github.com/cisagov/ScubaGear/tree/v1.5.0/"
  name        : "MS.AAD.7.6v1"
</custom_item>

<custom_item>
  type        : POLICY
  description : "MS.AAD.7.7v1 - Eligible and Active highly privileged role assignments SHALL trigger an alert."
  info        : "Closely monitor assignment of the highest privileged roles for signs of compromise. Send assignment alerts to enable the security monitoring team to detect compromise attempts."
  solution    : "1. In Microsoft Entra Privileged Identity Management (PIM), under Manage, select Microsoft Entra roles.

2. Under Manage, select Roles. Perform the steps below for each highly privileged role. We reference the Global Administrator role as an example.

3. Click the Global Administrator role.

4. Click Settings and then click Edit.

5. Click the Notification tab.

6. Under Send notifications when members are assigned as eligible to this role, in the Role assignment alert > Additional recipients textbox, enter the email address of the security monitoring mailbox configured to receive privileged role assignment alerts.

7. Under Send notifications when members are assigned as active to this role, in the Role assignment alert > Additional recipients textbox, enter the email address of the security monitoring mailbox configured to receive privileged role assignment alerts.

8. Click Update.

9. For each of the highly privileged roles, if they have any PIM groups actively assigned to them, then also apply the same configurations per the steps above to each PIM group's Member settings."
  reference   : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.1.20,800-171|3.4.2,800-171|3.4.5,800-171|3.5.1,800-171|3.5.2,800-171|3.14.6,800-171|3.14.7,800-171r3|03.01.01,800-171r3|03.01.02,800-171r3|03.01.04,800-171r3|03.01.05a.,800-171r3|03.01.20,800-171r3|03.04.02,800-171r3|03.04.05,800-171r3|03.05.01a.,800-171r3|03.05.12,800-171r3|03.14.06,800-53|AC-2,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|AC-20,800-53|CM-5,800-53|CM-6,800-53|IA-2,800-53|IA-5,800-53|SI-4,800-53|SI-7,800-53r5|AC-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|AC-20,800-53r5|CM-5,800-53r5|CM-6,800-53r5|IA-2,800-53r5|IA-5,800-53r5|SI-4,800-53r5|SI-7,CISA_BOD|25-01_Required,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(d),CN-L3|7.1.3.2(g),CN-L3|7.1.3.5(a),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(a),CN-L3|8.1.10.6(f),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.AM-4,CSF|ID.RA-1,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.DS-6,CSF|PR.IP-1,CSF|PR.IP-8,CSF|PR.PT-3,CSF|RS.AN-1,CSF|RS.CO-3,CSF2.0|DE.AE-02,CSF2.0|DE.AE-03,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|DE.CM-06,CSF2.0|DE.CM-09,CSF2.0|ID.AM-02,CSF2.0|ID.AM-04,CSF2.0|ID.IM-01,CSF2.0|ID.IM-02,CSF2.0|ID.IM-03,CSF2.0|ID.RA-01,CSF2.0|ID.RA-09,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,CSF2.0|PR.AA-05,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,CSF2.0|PR.IR-01,CSF2.0|PR.PS-01,CSF2.0|PR.PS-02,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(b),HIPAA|164.312(c)(1),HIPAA|164.312(c)(2),HIPAA|164.312(d),HIPAA|164.312(e)(2)(i),ISO-27001-2022|A.5.3,ISO-27001-2022|A.5.14,ISO-27001-2022|A.5.15,ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.17,ISO-27001-2022|A.5.18,ISO-27001-2022|A.5.33,ISO-27001-2022|A.7.9,ISO-27001-2022|A.8.2,ISO-27001-2022|A.8.3,ISO-27001-2022|A.8.4,ISO-27001-2022|A.8.9,ISO-27001-2022|A.8.16,ISO-27001-2022|A.8.18,ISO-27001-2022|A.8.19,ISO-27001-2022|A.8.20,ISO-27001-2022|A.8.31,ISO-27001-2022|A.8.32,ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-2,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|AC-20,ITSG-33|CM-5,ITSG-33|CM-6,ITSG-33|IA-2,ITSG-33|IA-2a.,ITSG-33|IA-5,ITSG-33|SI-4,ITSG-33|SI-7,ITSG-33|SI-7a.,NESA|M1.2.2,NESA|M1.3.5,NESA|T1.2.3,NESA|T2.3.8,NESA|T3.2.3,NESA|T3.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.2.3,NESA|T5.3.1,NESA|T5.4.1,NESA|T5.4.2,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.3.2,NESA|T7.3.3,NESA|T7.5.1,NESA|T7.5.2,NESA|T7.5.3,NESA|T7.6.3,NIAv2|AM1,NIAv2|AM2,NIAv2|AM3,NIAv2|AM8,NIAv2|AM14b,NIAv2|AM23f,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS13c,NIAv2|SS14e,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv3.2.1|10.5.5,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|7.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://github.com/cisagov/ScubaGear/tree/v1.5.0/"
  name        : "MS.AAD.7.7v1"
</custom_item>

<custom_item>
  type        : POLICY
  description : "MS.AAD.7.8v1 - User activation of the Global Administrator role SHALL trigger an alert."
  info        : "Closely monitor activation of the Global Administrator role for signs of compromise. Send activation alerts to enable the security monitoring team to detect compromise attempts."
  solution    : "1. In Microsoft Entra Privileged Identity Management (PIM), under Manage, select Microsoft Entra roles.

2. Under Manage, select Roles.

3. Click the Global Administrator role.

4. Click Settings and then click Edit.

5. Click the Notification tab.

6. Under Send notifications when eligible members activate this role, in the Role activation alert > Additional recipients textbox, enter the email address of the security monitoring mailbox configured to receive Global Administrator activation alerts.

7. Click Update.

8. If the Global Administrator role has any PIM groups actively assigned to it, then also apply the same configurations per the steps above to each PIM group's Member settings."
  reference   : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.1.20,800-171|3.4.2,800-171|3.4.5,800-171|3.5.1,800-171|3.5.2,800-171|3.14.6,800-171|3.14.7,800-171r3|03.01.01,800-171r3|03.01.02,800-171r3|03.01.04,800-171r3|03.01.05a.,800-171r3|03.01.20,800-171r3|03.04.02,800-171r3|03.04.05,800-171r3|03.05.01a.,800-171r3|03.05.12,800-171r3|03.14.06,800-53|AC-2,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|AC-20,800-53|CM-5,800-53|CM-6,800-53|IA-2,800-53|IA-5,800-53|SI-4,800-53|SI-7,800-53r5|AC-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|AC-20,800-53r5|CM-5,800-53r5|CM-6,800-53r5|IA-2,800-53r5|IA-5,800-53r5|SI-4,800-53r5|SI-7,CISA_BOD|25-01_Required,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(d),CN-L3|7.1.3.2(g),CN-L3|7.1.3.5(a),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(a),CN-L3|8.1.10.6(f),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.AM-4,CSF|ID.RA-1,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.DS-6,CSF|PR.IP-1,CSF|PR.IP-8,CSF|PR.PT-3,CSF|RS.AN-1,CSF|RS.CO-3,CSF2.0|DE.AE-02,CSF2.0|DE.AE-03,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|DE.CM-06,CSF2.0|DE.CM-09,CSF2.0|ID.AM-02,CSF2.0|ID.AM-04,CSF2.0|ID.IM-01,CSF2.0|ID.IM-02,CSF2.0|ID.IM-03,CSF2.0|ID.RA-01,CSF2.0|ID.RA-09,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,CSF2.0|PR.AA-05,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,CSF2.0|PR.IR-01,CSF2.0|PR.PS-01,CSF2.0|PR.PS-02,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(b),HIPAA|164.312(c)(1),HIPAA|164.312(c)(2),HIPAA|164.312(d),HIPAA|164.312(e)(2)(i),ISO-27001-2022|A.5.3,ISO-27001-2022|A.5.14,ISO-27001-2022|A.5.15,ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.17,ISO-27001-2022|A.5.18,ISO-27001-2022|A.5.33,ISO-27001-2022|A.7.9,ISO-27001-2022|A.8.2,ISO-27001-2022|A.8.3,ISO-27001-2022|A.8.4,ISO-27001-2022|A.8.9,ISO-27001-2022|A.8.16,ISO-27001-2022|A.8.18,ISO-27001-2022|A.8.19,ISO-27001-2022|A.8.20,ISO-27001-2022|A.8.31,ISO-27001-2022|A.8.32,ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-2,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|AC-20,ITSG-33|CM-5,ITSG-33|CM-6,ITSG-33|IA-2,ITSG-33|IA-2a.,ITSG-33|IA-5,ITSG-33|SI-4,ITSG-33|SI-7,ITSG-33|SI-7a.,NESA|M1.2.2,NESA|M1.3.5,NESA|T1.2.3,NESA|T2.3.8,NESA|T3.2.3,NESA|T3.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.2.3,NESA|T5.3.1,NESA|T5.4.1,NESA|T5.4.2,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.3.2,NESA|T7.3.3,NESA|T7.5.1,NESA|T7.5.2,NESA|T7.5.3,NESA|T7.6.3,NIAv2|AM1,NIAv2|AM2,NIAv2|AM3,NIAv2|AM8,NIAv2|AM14b,NIAv2|AM23f,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS13c,NIAv2|SS14e,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv3.2.1|10.5.5,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|7.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://github.com/cisagov/ScubaGear/tree/v1.5.0/"
  name        : "MS.AAD.7.8v1"
</custom_item>

<custom_item>
  type        : POLICY
  description : "MS.AAD.7.9v1 - User activation of other highly privileged roles SHOULD trigger an alert."
  info        : "Closely monitor activation of high-risk roles for signs of compromise. Send activation alerts to enable the security monitoring team to detect compromise attempts. In some environments, activating privileged roles can generate a significant number of alerts."
  solution    : "1. Follow the same instructions as MS.AAD.7.8v1 for each of the highly privileged roles (other than Global Administrator) but enter a security monitoring mailbox different from the one used to monitor Global Administrator activations.

 2. For each of the highly privileged roles, if they have any PIM groups actively assigned to them, then also apply the same configurations per step 1 to each PIM group's Member settings."
  reference   : "800-171|3.1.1,800-171|3.1.3,800-171|3.1.4,800-171|3.1.5,800-171|3.1.20,800-171|3.4.2,800-171|3.4.5,800-171|3.4.6,800-171|3.4.7,800-171|3.5.1,800-171|3.5.2,800-171|3.13.1,800-171|3.13.5,800-171|3.14.6,800-171|3.14.7,800-171r3|03.01.01,800-171r3|03.01.02,800-171r3|03.01.03,800-171r3|03.01.04,800-171r3|03.01.05a.,800-171r3|03.01.20,800-171r3|03.04.02,800-171r3|03.04.05,800-171r3|03.04.06,800-171r3|03.05.01a.,800-171r3|03.05.12,800-171r3|03.13.01,800-171r3|03.14.06,800-53|AC-2,800-53|AC-3,800-53|AC-4,800-53|AC-5,800-53|AC-6,800-53|AC-20,800-53|CM-5,800-53|CM-6,800-53|CM-7,800-53|IA-2,800-53|IA-5,800-53|SC-7,800-53|SI-4,800-53|SI-7,800-53r5|AC-2,800-53r5|AC-3,800-53r5|AC-4,800-53r5|AC-5,800-53r5|AC-6,800-53r5|AC-20,800-53r5|CM-5,800-53r5|CM-6,800-53r5|CM-7,800-53r5|IA-2,800-53r5|IA-5,800-53r5|SC-7,800-53r5|SI-4,800-53r5|SI-7,CISA_BOD|25-01_Not_Required,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(d),CN-L3|7.1.3.2(g),CN-L3|7.1.3.5(a),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(a),CN-L3|8.1.10.6(f),CN-L3|8.1.10.6(j),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.AM-3,CSF|ID.AM-4,CSF|ID.RA-1,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.AC-4,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.DS-6,CSF|PR.IP-1,CSF|PR.IP-8,CSF|PR.PT-3,CSF|PR.PT-4,CSF|RS.AN-1,CSF|RS.CO-3,CSF2.0|DE.AE-02,CSF2.0|DE.AE-03,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|DE.CM-06,CSF2.0|DE.CM-09,CSF2.0|ID.AM-02,CSF2.0|ID.AM-03,CSF2.0|ID.AM-04,CSF2.0|ID.IM-01,CSF2.0|ID.IM-02,CSF2.0|ID.IM-03,CSF2.0|ID.RA-01,CSF2.0|ID.RA-09,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,CSF2.0|PR.AA-05,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,CSF2.0|PR.IR-01,CSF2.0|PR.PS-01,CSF2.0|PR.PS-02,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(b),HIPAA|164.312(c)(1),HIPAA|164.312(c)(2),HIPAA|164.312(d),HIPAA|164.312(e)(2)(i),ISO-27001-2022|A.5.3,ISO-27001-2022|A.5.14,ISO-27001-2022|A.5.15,ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.17,ISO-27001-2022|A.5.18,ISO-27001-2022|A.5.33,ISO-27001-2022|A.7.9,ISO-27001-2022|A.8.2,ISO-27001-2022|A.8.3,ISO-27001-2022|A.8.4,ISO-27001-2022|A.8.9,ISO-27001-2022|A.8.16,ISO-27001-2022|A.8.18,ISO-27001-2022|A.8.19,ISO-27001-2022|A.8.20,ISO-27001-2022|A.8.22,ISO-27001-2022|A.8.31,ISO-27001-2022|A.8.32,ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ISO/IEC-27001|A.13.1.3,ITSG-33|AC-2,ITSG-33|AC-3,ITSG-33|AC-4,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|AC-20,ITSG-33|CM-5,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|IA-2,ITSG-33|IA-2a.,ITSG-33|IA-5,ITSG-33|SC-7,ITSG-33|SI-4,ITSG-33|SI-7,ITSG-33|SI-7a.,NESA|M1.2.2,NESA|M1.3.5,NESA|T1.2.3,NESA|T2.3.8,NESA|T3.2.3,NESA|T3.4.1,NESA|T4.2.1,NESA|T4.5.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.2.3,NESA|T5.3.1,NESA|T5.4.1,NESA|T5.4.2,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.4.6,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NESA|T5.5.4,NESA|T5.6.1,NESA|T5.7.2,NESA|T7.3.2,NESA|T7.3.3,NESA|T7.5.1,NESA|T7.5.2,NESA|T7.5.3,NESA|T7.6.3,NESA|T7.6.4,NIAv2|AM1,NIAv2|AM2,NIAv2|AM3,NIAv2|AM8,NIAv2|AM14b,NIAv2|AM23f,NIAv2|AM28,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS11a,NIAv2|GS12a,NIAv2|GS14a,NIAv2|GS15a,NIAv2|GS16a,NIAv2|NS5j,NIAv2|NS13a,NIAv2|NS13b,NIAv2|NS13c,NIAv2|NS14,NIAv2|SS13c,NIAv2|SS14e,NIAv2|SS15a,NIAv2|SS15c,NIAv2|SS23,NIAv2|SS27a,NIAv2|SS27b,NIAv2|SS29,NIAv2|SS32,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.2,PCI-DSSv3.2.1|7.1.2,PCI-DSSv3.2.1|10.5.5,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|7.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.4,SWIFT-CSCv1|2.5,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,TBA-FIISB|35.1,TBA-FIISB|36.1,TBA-FIISB|43.1"
  see_also    : "https://github.com/cisagov/ScubaGear/tree/v1.5.0/"
  name        : "MS.AAD.7.9v1"
</custom_item>

<custom_item>
  type        : POLICY
  description : "MS.AAD.8.1v1 - Guest users SHOULD have limited or restricted access to Microsoft Entra ID directory objects."
  info        : "Limiting the amount of object information available to guest users in the tenant, reduces malicious reconnaissance exposure, should a guest account become compromised or be created by an adversary."
  solution    : "1. In Microsoft Entra admin center select External Identities > External collaboration settings.

2. Under Guest user access, select either Guest users have limited access to properties and memberships of directory objects or Guest user access is restricted to properties and memberships of their own directory objects (most restrictive).

3. Click Save."
  reference   : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.5.1,800-171r3|03.01.01,800-171r3|03.01.02,800-171r3|03.01.04,800-171r3|03.01.05a.,800-171r3|03.05.01a.,800-53|AC-2,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|IA-2,800-53|IA-8,800-53r5|AC-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|IA-2,800-53r5|IA-8,CISA_BOD|25-01_Not_Required,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(d),CN-L3|7.1.3.2(g),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-3,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,CSF2.0|PR.AA-05,CSF2.0|PR.DS-10,CSF2.0|PR.IR-01,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO-27001-2022|A.5.3,ISO-27001-2022|A.5.15,ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.18,ISO-27001-2022|A.5.33,ISO-27001-2022|A.8.2,ISO-27001-2022|A.8.3,ISO-27001-2022|A.8.18,ISO-27001-2022|A.8.20,ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-2,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|IA-2,ITSG-33|IA-2a.,ITSG-33|IA-8,ITSG-33|IA-8a.,NESA|T2.3.8,NESA|T4.2.1,NESA|T4.3.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.3.1,NESA|T5.4.1,NESA|T5.4.2,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM2,NIAv2|AM3,NIAv2|AM8,NIAv2|AM14b,NIAv2|AM23f,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS13c,NIAv2|SS14e,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|2.8,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://github.com/cisagov/ScubaGear/tree/v1.5.0/"
  name        : "MS.AAD.8.1v1"
</custom_item>

<custom_item>
  type        : POLICY
  description : "MS.AAD.8.2v1 - Only users with the Guest Inviter role SHOULD be able to invite guest users."
  info        : "By only allowing an authorized group of individuals to invite external users to create accounts in the tenant, an agency can enforce a guest user account approval process, reducing the risk of unauthorized account creation."
  solution    : "1. In Microsoft Entra admin center select External Identities > External collaboration settings.

2. Under Guest invite settings, select Only users assigned to specific admin roles can invite guest users.

3. Click Save."
  reference   : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.1.20,800-171|3.4.2,800-171|3.4.5,800-171|3.5.1,800-171|3.5.2,800-171|3.14.6,800-171|3.14.7,800-171r3|03.01.01,800-171r3|03.01.02,800-171r3|03.01.04,800-171r3|03.01.05a.,800-171r3|03.01.20,800-171r3|03.04.02,800-171r3|03.04.05,800-171r3|03.05.01a.,800-171r3|03.05.12,800-171r3|03.14.06,800-53|AC-2,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|AC-20,800-53|CM-5,800-53|CM-6,800-53|IA-2,800-53|IA-5,800-53|SI-4,800-53|SI-7,800-53r5|AC-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|AC-20,800-53r5|CM-5,800-53r5|CM-6,800-53r5|IA-2,800-53r5|IA-5,800-53r5|SI-4,800-53r5|SI-7,CISA_BOD|25-01_Not_Required,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(d),CN-L3|7.1.3.2(g),CN-L3|7.1.3.5(a),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(a),CN-L3|8.1.10.6(f),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.AM-4,CSF|ID.RA-1,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.DS-6,CSF|PR.IP-1,CSF|PR.IP-8,CSF|PR.PT-3,CSF|RS.AN-1,CSF|RS.CO-3,CSF2.0|DE.AE-02,CSF2.0|DE.AE-03,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|DE.CM-06,CSF2.0|DE.CM-09,CSF2.0|ID.AM-02,CSF2.0|ID.AM-04,CSF2.0|ID.IM-01,CSF2.0|ID.IM-02,CSF2.0|ID.IM-03,CSF2.0|ID.RA-01,CSF2.0|ID.RA-09,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,CSF2.0|PR.AA-05,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,CSF2.0|PR.IR-01,CSF2.0|PR.PS-01,CSF2.0|PR.PS-02,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(b),HIPAA|164.312(c)(1),HIPAA|164.312(c)(2),HIPAA|164.312(d),HIPAA|164.312(e)(2)(i),ISO-27001-2022|A.5.3,ISO-27001-2022|A.5.14,ISO-27001-2022|A.5.15,ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.17,ISO-27001-2022|A.5.18,ISO-27001-2022|A.5.33,ISO-27001-2022|A.7.9,ISO-27001-2022|A.8.2,ISO-27001-2022|A.8.3,ISO-27001-2022|A.8.4,ISO-27001-2022|A.8.9,ISO-27001-2022|A.8.16,ISO-27001-2022|A.8.18,ISO-27001-2022|A.8.19,ISO-27001-2022|A.8.20,ISO-27001-2022|A.8.31,ISO-27001-2022|A.8.32,ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-2,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|AC-20,ITSG-33|CM-5,ITSG-33|CM-6,ITSG-33|IA-2,ITSG-33|IA-2a.,ITSG-33|IA-5,ITSG-33|SI-4,ITSG-33|SI-7,ITSG-33|SI-7a.,NESA|M1.2.2,NESA|M1.3.5,NESA|T1.2.3,NESA|T2.3.8,NESA|T3.2.3,NESA|T3.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.2.3,NESA|T5.3.1,NESA|T5.4.1,NESA|T5.4.2,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.3.2,NESA|T7.3.3,NESA|T7.5.1,NESA|T7.5.2,NESA|T7.5.3,NESA|T7.6.3,NIAv2|AM1,NIAv2|AM2,NIAv2|AM3,NIAv2|AM8,NIAv2|AM14b,NIAv2|AM23f,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS13c,NIAv2|SS14e,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv3.2.1|10.5.5,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|7.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://github.com/cisagov/ScubaGear/tree/v1.5.0/"
  name        : "MS.AAD.8.2v1"
</custom_item>

<custom_item>
  type        : POLICY
  description : "MS.AAD.8.3v1 - Guest invites SHOULD only be allowed to specific external domains that have been authorized by the agency for legitimate business purposes."
  info        : "Limiting which domains can be invited to create guest accounts in the tenant helps reduce the risk of users from unauthorized external organizations getting access.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. In Microsoft Entra admin center select External Identities > External collaboration settings.

2. Under Collaboration restrictions, select Allow invitations only to the specified domains (most restrictive).

3. Select Target domains and enter the names of the external domains authorized by the agency for guest user access.

4. Click Save."
  reference   : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.12.3,800-171|3.13.1,800-171|3.13.2,800-171|3.13.16,800-171|3.14.6,800-171|3.14.7,800-171r3|03.01.01,800-171r3|03.01.04,800-171r3|03.01.05a.,800-171r3|03.12.03,800-171r3|03.13.08,800-171r3|03.14.06,800-171r3|03.16.01,800-53|AC-2,800-53|AC-5,800-53|AC-6,800-53|CA-7,800-53|SA-3,800-53|SA-4,800-53|SA-8,800-53|SA-10,800-53|SA-11,800-53|SA-15,800-53|SA-16,800-53|SA-17,800-53|SC-28,800-53|SI-4,800-53r5|AC-2,800-53r5|AC-5,800-53r5|AC-6,800-53r5|CA-7,800-53r5|SA-3,800-53r5|SA-4,800-53r5|SA-8,800-53r5|SA-10,800-53r5|SA-11,800-53r5|SA-15,800-53r5|SA-16,800-53r5|SA-17,800-53r5|SC-28,800-53r5|SI-4,CISA_BOD|25-01_Not_Required,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(d),CN-L3|7.1.3.2(g),CN-L3|7.1.3.5(a),CN-L3|8.1.4.2(d),CN-L3|8.1.4.7(b),CN-L3|8.1.4.8(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(a),CN-L3|8.1.10.6(f),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-2,CSF|DE.CM-3,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-1,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.DS-1,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.IP-7,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,CSF|RS.MI-3,CSF2.0|DE.AE-02,CSF2.0|DE.AE-03,CSF2.0|DE.CM-01,CSF2.0|DE.CM-02,CSF2.0|DE.CM-03,CSF2.0|DE.CM-06,CSF2.0|DE.CM-09,CSF2.0|GV.SC-05,CSF2.0|GV.SC-06,CSF2.0|GV.SC-07,CSF2.0|GV.SC-08,CSF2.0|GV.SC-09,CSF2.0|GV.SC-10,CSF2.0|ID.AM-08,CSF2.0|ID.IM-01,CSF2.0|ID.IM-02,CSF2.0|ID.IM-03,CSF2.0|ID.RA-01,CSF2.0|ID.RA-07,CSF2.0|ID.RA-09,CSF2.0|PR.AA-01,CSF2.0|PR.AA-05,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,CSF2.0|PR.IR-03,CSF2.0|PR.PS-06,GDPR|32.1.a,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(b),HIPAA|164.312(e)(2)(ii),ISO-27001-2022|A.5.2,ISO-27001-2022|A.5.3,ISO-27001-2022|A.5.8,ISO-27001-2022|A.5.10,ISO-27001-2022|A.5.15,ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.18,ISO-27001-2022|A.5.20,ISO-27001-2022|A.5.23,ISO-27001-2022|A.5.33,ISO-27001-2022|A.5.36,ISO-27001-2022|A.8.2,ISO-27001-2022|A.8.9,ISO-27001-2022|A.8.16,ISO-27001-2022|A.8.18,ISO-27001-2022|A.8.25,ISO-27001-2022|A.8.26,ISO-27001-2022|A.8.27,ISO-27001-2022|A.8.28,ISO-27001-2022|A.8.29,ISO-27001-2022|A.8.30,ISO-27001-2022|A.8.31,ISO-27001-2022|A.8.32,ISO-27001-2022|8.1,ISO-27001-2022|9.1,ISO-27001-2022|9.3.2,ISO-27001-2022|9.3.3,ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|CA-7,ITSG-33|SA-3,ITSG-33|SA-4,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,ITSG-33|SA-11,ITSG-33|SC-28,ITSG-33|SC-28a.,ITSG-33|SI-4,NESA|M1.2.2,NESA|M5.3.1,NESA|M5.4.1,NESA|M6.2.2,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.2.1,NESA|T7.2.2,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.5,NIAv2|AM1,NIAv2|AM23f,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS3,NIAv2|SS5,NIAv2|SS6a,NIAv2|SS6c,NIAv2|SS6d,NIAv2|SS13c,NIAv2|SS14e,NIAv2|SS15c,NIAv2|VL2,PCI-DSSv3.2.1|3.4,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|3.3.2,PCI-DSSv4.0|3.5.1,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
  see_also    : "https://github.com/cisagov/ScubaGear/tree/v1.5.0/"
  name        : "MS.AAD.8.3v1"
  severity    : MEDIUM
</custom_item>

</check_type>
