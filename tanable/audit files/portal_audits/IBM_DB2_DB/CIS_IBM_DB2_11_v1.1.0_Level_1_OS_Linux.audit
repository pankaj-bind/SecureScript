#TRUSTED 16149e29dc3d89ff964c4151464d624f4ff9970b0cf8c378e0fd4fdba83c981cf862f7e01d796fcc0e04d6ade0c8cddcd7fc896f8a0b60cca85699c1679dd1f178e5e77cc41ace249f592b9e30605bb6dd69e534c161010985a181ec31e20ec6afdb1cad95b5419792a7bdd08e1683a2ded8c9553a37d58efd2ce234c92a537ebf1e1dfbde1f5c8c0db3f2382997b6ddf923081e89dec5622386b3170652e330f3729dab17f8dd67a0344401ee6a08aeac59f2d02e5e41379bdaf368fe8f2751235673238a95101552c46a786de598e2771a5c7aca167651d4503668e9f54fceb93f1f2f094504668e7d23845cbd5098be613bd239c72125be5cf2ce72b6ce2f1a07721c467f29cb3cec0542b919d9e58f8a964abef560df728bf6850e74690bc800683039178ad079f1d3ffc77c3a41473704df271b351a7a3d6631e87ce03c7d570df647637161bfe19ad3180323afc55c3e7f339b970ad94935437fda2f3b589cc70c9bca0ee168ce8a54a471c3e928adfda6aa8a4841c6c66cde4b53c740f2339fd2aeaade25bbf8d8af99383858016f7d401ca1acd18ee3bff1ef20a3e3892e2626a7a3305301b486f4667e97fa461831f8c7a0aeca68b6c0cc00ff45edcb8644ae7fcc361b8e692f9a4ddfcae306a4fdb7b01f3a0e4266d902d06930d5d9e2a2a983269cbca77cece790892e29daaa8dc29e1a0d663acab34589db8d50
#TRUST-RSA-SHA256 78c7f67ca699a3f4993ea71474d47f52cf06c6c56254324d0e9aee5ec58838a51de2c289b8287e2d5e464ff620edd97ab0cd92e378420f372c824774855d229447b0299c1c4d34d8cc6dfc896cac8cdcb65bf03e8ae0a2583bb3b7e2167b112f5a897195b38ac59d90a485d0d647b9802b9f69aaa59ed11f2deb5d82839e42d3457b8f88fd1be2bf86f4a3580702fc936f3e3956ebc9bfafdb7d27223d68a8a4a60d52303b4276da4637db54c124dbf71d0bd8dbf56c36c9d908ac98845a7dfb2ecd38f902010b91c5304799613fbfe9b7aff28433974fde460d5f77f6529fd6e34a05b00fa335cfb66690012db7375454d2da929b854e4e738c99d164d97376425b64a309b2dbd4c2f1e062fdf0c8782bc0070ca4c3eab17abd60c79391939f89080ae37ab95e2fc1c6e9c743d95de32e23036cf2fc1513dc22ccda8b6b1efe7c9ba0772d150b3f57e5c7677f2fe704a9ba2ddb72b646ed0433f294a173f5f829589dcb91caaffe9bfb75b4e06604b76565a1825ae596294a30aa609a8773af39664242349f4b33e6511e8fb883bbe3f45f9fd58b020a8f5b829bd6ddaa721c43b14514fce339589ad31d2e595f0ed81bb09b54b23a48f0029c2d178b44bb33c369a4d5abe5eb101bd6ab7896067d504c286d758e0d8553f51226d49aec676853dd3970509ffb054792c8ebfeb66d9ab92cec48db109034100e0bdd7f98f2ed
#
# This script is Copyright (C) 2004-2024 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
#
# $Revision: 1.1 $
# $Date: 2024/06/17 $
#
# Description   : This document implements the security configuration as recommended by the CIS IBM DB2 11 Benchmark v1.1.0
#
#<ui_metadata>
#<display_name>CIS IBM DB2 11 v1.1.0 Linux OS Level 1</display_name>
#<spec>
#  <type>CIS</type>
#  <name>IBM DB2 11</name>
#  <profile>L1 OS Linux</profile>
#  <version>1.1.0</version>
#  <link>https://workbench.cisecurity.org/benchmarks/10752</link>
#</spec>
#<labels>database,cis,ibm,db2,distribution_independent_linux</labels>
#<benchmark_refs>CCE,CSCv6,CSCv7,CSCv8,LEVEL</benchmark_refs>
#<variables>
#  <variable>
#    <name>DB2_DATABASE</name>
#    <default>SAMPLE</default>
#    <description>DB2 Database to be scanned</description>
#    <info>The DB2 database being scanned.</info>
#    <value_type>SAFE_STRING</value_type>
#  </variable>
#  <variable>
#    <name>DB2_SQLDB_DIR</name>
#    <default>/home/db2inst1/sqldbdir</default>
#    <description>DB2 SQLDB Directory</description>
#    <info>The SQLLIB directory for the DB2 database being scanned.</info>
#    <value_type>UNIX_FILE_PATH</value_type>
#  </variable>
#  <variable>
#    <name>DB2_USER</name>
#    <default>db2inst1</default>
#    <description>DB2 User</description>
#    <info>The unique DB2 account for the database.</info>
#    <value_type>UNIX_ACCT</value_type>
#  </variable>
#  <variable>
#    <name>DB2_GROUP</name>
#    <default>db2iadm1</default>
#    <description>DB2 User Group</description>
#    <info>The unique DB2 group for the database.</info>
#    <value_type>UNIX_ACCT</value_type>
#  </variable>
#  <variable>
#    <name>DB2_BIN_PATH</name>
#    <default>/opt/ibm/db2/V11.5/bin</default>
#    <description>DB2 BIN path</description>
#    <info>The full path for the BIN folder for executables with no trailing slash.</info>
#    <value_type>UNIX_FILE_PATH</value_type>
#  </variable>
#  <variable>
#    <name>DB2_ALTDIAGPATH</name>
#    <default>/home/db2inst1/sqllib/db2dump</default>
#    <description>DB2 alternative diagnostic log directory</description>
#    <info>The full path for the alternative alternative DB2 diagnostic log directory.</info>
#    <value_type>UNIX_FILE_PATH</value_type>
#  </variable>
#  <variable>
#    <name>DB2_DBTDBPATH</name>
#    <default>/path/to/dbtdbpath</default>
#    <description>DB2 Default Database File Path</description>
#    <info>The full path for the Default Database File Path.</info>
#    <value_type>UNIX_FILE_PATH</value_type>
#  </variable>
#  <variable>
#    <name>DB2_JDK_PATH</name>
#    <default>/path/to/jdk</default>
#    <description>DB2 Java Development Kit Installation Path</description>
#    <info>The full path for the Java Development Kit Installation Path.</info>
#    <value_type>UNIX_FILE_PATH</value_type>
#  </variable>
#  <variable>
#    <name>DB2_OVERFLOWLOGPATH</name>
#    <default>/path/to/overflowlogpath</default>
#    <description>DB2 Log Overflow Location</description>
#    <info>The full path for the Log Overflow Location.</info>
#    <value_type>UNIX_FILE_PATH</value_type>
#  </variable>
#  <variable>
#    <name>DB2_PYTHON_PATH</name>
#    <default>/path/to/python</default>
#    <description>DB2 Python Runtime Path</description>
#    <info>The full path for the Python Runtime Path.</info>
#    <value_type>UNIX_FILE_PATH</value_type>
#  </variable>
#  <variable>
#    <name>DB2_R_PATH</name>
#    <default>/path/to/r</default>
#    <description>DB2 R Runtime Path</description>
#    <info>The full path for the R Runtime Path.</info>
#    <value_type>UNIX_FILE_PATH</value_type>
#  </variable>
#  <variable>
#    <name>DB2_DIAGPATH</name>
#    <default>/home/db2inst1/sqllib/db2dump</default>
#    <description>DB2 diagnostic log directory</description>
#    <info>The full path for the DB2 diagnostic log directory.</info>
#    <value_type>UNIX_FILE_PATH</value_type>
#  </variable>
#  <variable>
#    <name>DB2_LOGARCHMETH1</name>
#    <default>/home/db2inst1/db2inst1/NODE0000/SQL00001/LOGSTREAM0000/</default>
#    <description>DB2 Log Archive Method 1</description>
#    <info>The full path for the DB2 primary log archive method 1</info>
#    <value_type>UNIX_FILE_PATH</value_type>
#  </variable>
#  <variable>
#    <name>DB2_LOGARCHMETH2</name>
#    <default>/home/db2inst1/db2inst1/NODE0000/SQL00001/LOGSTREAM0000/</default>
#    <description>DB2 Log Archive Method 2</description>
#    <info>The full path for the DB2 primary log archive method 2.</info>
#    <value_type>UNIX_FILE_PATH</value_type>
#  </variable>
#  <variable>
#    <name>DB2_FAILARCHPATH</name>
#    <default>/path/to/archivefailures</default>
#    <description>DB2 Log Archive Failure Method</description>
#    <info>The full path for the DB2 archive log failure method.</info>
#    <value_type>UNIX_FILE_PATH</value_type>
#  </variable>
#  <variable>
#    <name>DB2_MIRRORLOGPATH</name>
#    <default>/path/to/mirrorlogs</default>
#    <description>DB2 Mirror Log Path</description>
#    <info>The full path for the DB2 mirror logs.</info>
#    <value_type>UNIX_FILE_PATH</value_type>
#  </variable>
#  <variable>
#    <name>DB2_PLUGIN_PATH</name>
#    <default>/opt/ibm/db2/V11.5/security64/</default>
#    <description>DB2 Plugin Path</description>
#    <info>The full path to the DB2 plugins.</info>
#    <value_type>UNIX_FILE_PATH</value_type>
#  </variable>
#</variables>
#</ui_metadata>

<check_type:"Unix">

<if>
  <condition type:"AND">
    <custom_item>
      type        : CMD_EXEC
      description : "Linux found"
      cmd         : "uname -a"
      expect      : "Linux"
    </custom_item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "CIS_IBM_DB2_11_v1.1.0_Level_1_OS_Linux.audit from CIS IBM DB2 11 v1.1.0 Benchmark"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
    </report>

    <custom_item>
      type        : CMD_EXEC
      description : "3.1.1 Require Explicit Authorization for Cataloging (CATALOG_NOAUTH)"
      info        : "Db2 can be configured to allow users that do not possess the SYSADM authority to catalog and uncatalog databases and nodes. It is recommended that the CATALOG_NOAUTH parameter be set to NO.

Rationale:

Cataloging a database is the process of registering a database from a remote client to allow remote call and access. Setting CATALOG_NOAUTH to YES bypasses all permissions checks and allows anyone to catalog and uncatalog databases."
      solution    : "Perform the following to require explicit authorization to catalog and uncatalog databases and nodes.

Attach to the Db2 instance

db2 => attach to <db2instance>

Run the following command:

db2 => update database manager configuration using catalog_noauth no"
      reference   : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      cmd         : "su - @DB2_USER@ -c '@DB2_BIN_PATH@/db2 get database manager configuration' | /bin/egrep '\\(CATALOG_NOAUTH\\)' | /bin/awk -F'= ' '{ print $2 }'"
      expect      : "^NO$"
    </custom_item>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          type        : FILE_CHECK
          description : "DFTDBPATH OS Permissions"
          file        : "@DB2_DBTDBPATH@"
          owner       : "@DB2_USER@"
          mask        : "022"
          group       : "@DB2_GROUP@"
        </custom_item>

        <custom_item>
          type        : CMD_EXEC
          description : "DFTDBPATH Setting"
          cmd         : "su - @DB2_USER@ -c '@DB2_BIN_PATH@/db2 get database manager configuration' | /bin/egrep '\\(DFTDBPATH\\) =' | /bin/awk -F'= ' '{ print $2 }'"
          expect      : "^.+$"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "3.1.2 Secure Permissions for Default Database File Path (DFTDBPATH)"
          info        : "The DFTDBPATH parameter contains the default file path used to create Db2 databases. It is recommended that the permissions for this directory be set to full access for Db2 administrators and read and execute access only for all other accounts. It is also recommended that this directory be owned by the Db2 Administrator.

Rationale:

Restricting access to the directory used as the default file path through permissions will help ensure that the confidentiality, integrity, and availability of the files there are protected."
          solution    : "For Windows and Linux:

Attach to the Db2 instance.

db2 => attach to <db2instance>

Run the following command to change the default file path, if necessary:

db2 => update database manager configuration using dftdbpath <valid directory>

Additional steps for Windows:

Connect to the Db2 host

Right-click over the directory used as the default file path

Choose Properties

Select the Security tab

Assign ownership of the directory to the Db2 Administrator

Grant all Db2 administrator accounts the Full Control authority

Grant only read and execute privileges to all other users (revoke all other privileges)

Additional steps for Linux:

Connect to the Db2 host

Change to the directory used as the default file path

Assign the Db2 Administrator to be the owner of the directory using the chown command

Change the permissions for the directory

$ chmod -R 755"
          reference   : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
          see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
          show_output : YES
        </report>
      </then>
    </if>

    <custom_item>
      type        : CMD_EXEC
      description : "3.1.3 Set Diagnostic Logging to Capture Errors and Warnings (DIAGLEVEL)"
      info        : "The DIAGLEVEL parameter specifies the type of diagnostic errors that will be recorded in the db2diag.log file. It is recommended that the DIAGLEVEL parameter be set to at least 3.

Rationale:

The recommended DIAGLEVEL setting is 3, but any value greater than 3 is also acceptable. A value of at least 3 will allow the Db2 instance to capture all errors and warnings that occur on the system."
      solution    : "Attach to the Db2 instance

db2 => attach to <db2instance>

Run the following command:

db2 => update database manager configuration using diaglevel 3"
      reference   : "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-3,800-53|AU-3(1),800-53|AU-7,800-53|AU-12,800-53r5|AU-3,800-53r5|AU-3(1),800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.2.3(c),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|8.1.4.3(b),CSCv7|6.3,CSCv8|8.5,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,ITSG-33|AU-3(1),ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1A,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      cmd         : "su - @DB2_USER@ -c '@DB2_BIN_PATH@/db2 get database manager configuration' | /bin/egrep '\\(DIAGLEVEL\\)' | /bin/awk -F'= ' '{ print $2 }'"
      expect      : "^[3|4]$"
    </custom_item>

    <custom_item>
      type        : FILE_CHECK
      description : "3.1.4 Secure Permissions for All Diagnostic Logs (DIAGPATH)"
      info        : "The DIAGPATH parameter specifies the location of the diagnostic files for the Db2 instance. The directory at this location should be secured so that users have read and execute privileges only (no write privileges). All Db2 administrators should have full access to the directory.

Rationale:

Securing the directory will ensure that the confidentiality, integrity, and availability of the diagnostic files contained in the directory are preserved."
      solution    : "For Windows and Linux
To change the directory for the diagnostic logs:

Attach to the Db2 instance

db2 => attach to <db2instance>

Run the following command:

db2 => update database manager configuration using diagpath <valid directory>

Additional steps for Windows:

Connect to the Db2 host

Right-click over the diagnostic log directory

Choose Properties

Select the Security tab

Grant the Full Control authority to all Db2 administrator accounts

Grant only read and execute privileges to all other accounts (revoke any other privileges)

Additional steps for Linux:

Connect to the Db2 host

Change to the diagnostic log directory

Change the permissions of the directory

$ chmod -R 3777 ."
      reference   : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      file        : "@DB2_DIAGPATH@"
      owner       : "@DB2_USER@"
      mask        : "022"
      group       : "@DB2_GROUP@"
    </custom_item>

    <custom_item>
      type        : FILE_CHECK
      description : "3.1.5 Secure Permissions for Alternate Diagnostic Log Path (ALT_DIAGPATH)"
      info        : "The ALT_DIAGPATH parameter specifies an alternative location of the diagnostic files for the Db2 instance if the primary location specified by DIAGPATH is unavailable. The directory at this location should be secured so that users have read and execute privileges only (no write privileges). All Db2 administrators should have full access to the directory.

Rationale:

Securing the directory will ensure that the confidentiality, integrity, and availability of the diagnostic files contained in the directory are preserved."
      solution    : "For Windows and Linux
To change the directory for the diagnostic logs:

Attach to the Db2 instance

db2 => attach to <db2instance>

Run the following command:

db2 => update database manager configuration using diagpath <valid directory>

Additional steps for Windows:

Connect to the Db2 host

Right-click over the diagnostic log directory

Choose Properties

Select the Security tab

Grant the Full Control authority to all Db2 administrator accounts

Grant only read and execute privileges to all other accounts (revoke any other privileges)

Additional steps for Linux:

Connect to the Db2 host

Change to the diagnostic log directory

Change the permissions of the directory

$ chmod -R 3777 ."
      reference   : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      file        : "@DB2_ALTDIAGPATH@"
      owner       : "@DB2_USER@"
      mask        : "022"
      group       : "@DB2_GROUP@"
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "3.1.6 Disable Client Discovery Requests (DISCOVER)"
      info        : "The DISCOVER parameter determines what kind of discovery requests, if any, the Db2 client can make. It is recommended that this is disabled.

Rationale:

Discovery capabilities may be used by a malicious entity to derive the names of and target Db2 instances. In this configuration, the client can not issue discovery requests."
      solution    : "Run the following command:

db2 => update database manager configuration using discover disable"
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1A,NESA|T3.2.1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      cmd         : "su - @DB2_USER@ -c '@DB2_BIN_PATH@/db2 get database manager configuration' | /bin/egrep '\\(DISCOVER\\)' | /bin/awk -F'= ' '{ print $2 }'"
      expect      : "^DISABLE$"
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "3.1.7 Disable Instance Discoverability (DISCOVER_INST)"
      info        : "The DISCOVER_INST parameter specifies whether the instance can be discovered in the network. It is recommended that instances not be discoverable.

Rationale:

Discovery capabilities may be used by a malicious entity to derive the names of and target Db2 instances."
      solution    : "Attach to the Db2 instance:

db2 => attach to <db2instance>

Run the following command:

db2 => update database manager configuration using discover_inst disable"
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      cmd         : "su - @DB2_USER@ -c '@DB2_BIN_PATH@/db2 get database manager configuration' | /bin/egrep '\\(DISCOVER_INST\\)' | /bin/awk -F'= ' '{ print $2 }'"
      expect      : "^DISABLE$"
    </custom_item>

    <if>
      <condition auto:"WARNING" type:"AND">
        <custom_item>
          type        : CMD_EXEC
          description : "MAX_CONNECTIONS"
          cmd         : "su - @DB2_USER@ -c '@DB2_BIN_PATH@/db2 get database manager configuration' | /bin/egrep '\\(MAX_CONNECTIONS\\) =' | /bin/awk -F'= ' '{ print $2 }'"
          expect      : "Manual Review Required"
          severity    : MEDIUM
        </custom_item>

        <custom_item>
          type        : CMD_EXEC
          description : "MAX_COORDAGENTS"
          cmd         : "su - @DB2_USER@ -c '@DB2_BIN_PATH@/db2 get database manager configuration' | /bin/egrep '\\(MAX_COORDAGENTS\\) =' | /bin/awk -F'= ' '{ print $2 }'"
          expect      : "Manual Review Required"
          severity    : MEDIUM
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "3.1.8 Set Maximum Connection Limits (MAX_CONNECTIONS and MAX_COORDAGENTS)"
          info        : "The MAX_CONNECTIONS parameter indicates the maximum number of client connections allowed per member. It is recommended that this parameter be set without the AUTOMATIC setting. The AUTOMATIC setting means for the value to grow unconstrained, and a value of -1 means to use the same value as MAX_COORDAGENTS.

The MAX_COORDAGENTS parameter equals the maximum number of agents needed to perform connections to the database or attachments to the instance. The AUTOMATIC setting means for the value to grow unconstrained.

The MAX_COORDAGENTS parameter should be set to a fixed value without the AUTOMATIC setting. The exact value is highly dependent on business requirements for simultaneous connections. For example, if only a single application with a connection pool of 10 connections will connect to the database server, a much smaller value may be appropriate than a database server that expects to have hundreds of simultaneous connections. These examples will use a value of 200.

Ensure that dependent parameters, such as MAXAPPLS, are set less than or equal to the MAX_CONNECTIONS parameter. As instance parameters, MAX_CONNECTIONS and MAX_COORDAGENTS govern all databases within the instance, and thus the summation of MAXAPPLS value for all databases must be considered.

Rationale:

By default, Db2 allows an unlimited number of users to access the Db2 instance. In addition to giving access to the Db2 instance to authorized users only, it is recommended to set a limit to the number of users allowed to access a Db2 instance. This helps prevent denial of service conditions should an authorized process malfunction and attempt many simultaneous connections.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
          solution    : "The default value for MAX_COORDAGENTS is AUTOMATIC(200). Allowable range is 1 to 64,000. The recommended value is 200, without the AUTOMATIC setting. The value of 200 is used as an example and is dependent on workload as discussed in the Description.
The default value for MAX_CONNECTIONS is set to AUTOMATIC(-1). Allowable range is 1 to 64,000, or -1 for matching the value of MAX_COORDAGENTS. The recommended value is -1 without AUTOMATIC. It is also acceptable to have a value for MAX_CONNECTIONS that is greater than MAX_COORDAGENTS, such as 300, in order to turn on the Concentrator feature.
Generally, both MAX_COORDAGENTS and MAX_CONNECTIONS should be configured within the same statement, otherwise the error SQL6112N may be encountered. The following command will set the MAX_COORDAGENTS to 200, as well as set the MAX_CONNECTIONS to -1.

Attach to the Db2 instance

db2 => attach to <db2instance>

Run the following command:

db2 => update database manager configuration using max_coordagents 200 max_connections -1"
          reference   : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
          see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
          show_output : YES
        </report>
      </then>
    </if>

    <custom_item>
      type        : CMD_EXEC
      description : "3.1.9 Set Administrative Notification Level (NOTIFYLEVEL)"
      info        : "The NOTIFYLEVEL parameter specifies the type of administration notification messages that are written to the administration notification log.

It is recommended that this parameter be set greater than or equal to 3.

A setting of 3, which includes settings 1 & 2, will log all fatal errors, failing services, system integrity, as well as system health.

Rationale:

The system should be monitoring all Health Monitor alarms, warnings, and attentions. This may give an indication of any malicious usage on the Db2 instance."
      solution    : "Attach to the Db2 instance

db2 => attach to <db2instance>

Run the following command:

db2 => update database manager configuration using notifylevel 3

Default Value:

The default value of NOTIFYLEVEL is 3."
      reference   : "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-2,800-53|AU-7,800-53|AU-12,800-53r5|AU-2,800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(c),CN-L3|8.1.4.3(a),CSCv7|6.2,CSCv8|8.2,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-2,ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1A,NESA|M1.2.2,NESA|M5.5.1,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|SS30,NIAv2|VL8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      cmd         : "su - @DB2_USER@ -c '@DB2_BIN_PATH@/db2 get database manager configuration' | /bin/egrep '\\(NOTIFYLEVEL\\) =' | /bin/awk -F'= ' '{ print $2 }'"
      expect      : "^[3|4]$"
    </custom_item>

    <custom_item>
      type        : FILE_CHECK
      description : "3.1.10 Secure the Java Development Kit Installation Path (JDK_PATH)"
      info        : "The JDK_PATH parameter contains the directory under which the Software Developer's Kit (SDK) for Java(TM) is installed. The Java SDK is used for running Java stored procedures and user-defined functions. It is recommended that the owner of this directory is bin on Linux and AIX, and a member of the Db2 administration group on Windows. The directory should have read and execute permission for all users, but only write permission for the owner.

Rationale:

Restricting access to the Java JDK will help ensure that only an authorized JDK is used for running Java routines within Db2."
      solution    : "For Windows and Linux:

Attach to the Db2 instance.

db2 => attach to <db2instance>

Run the following command to change the JDK path, if necessary:

db2 => update database manager configuration using
       jdk_path <valid directory>

Additional steps for Windows:

Connect to the Db2 host

Right-click over the directory used as the JDK path

Choose Properties

Select the Security tab

Assign ownership of the directory to the Db2 Administrator

Grant all Db2 administrator accounts the Full Control authority

Grant only read and execute privileges to all other users (revoke all other privileges)

Additional steps for Linux:

Connect to the Db2 host as root

Change to the directory used as the JDK path

Assign bin to be the owner of the directory using the chown command

Change the permissions for the directory

$ chmod -R 755"
      reference   : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      file        : "@DB2_JDK_PATH@"
      owner       : "@DB2_USER@"
      mask        : "022"
      group       : "@DB2_GROUP@"
    </custom_item>

    <custom_item>
      type        : FILE_CHECK
      description : "3.1.11 Secure the Python Runtime Path (PYTHON_PATH)"
      info        : "The PYTHON_PATH parameter contains the directory under which the Python runtime is installed. It is recommended that the owner of this directory is bin on Linux and AIX, and a member of the Db2 administration group on Windows. The directory should have read and execute permission for all users, but only write permission for the owner.

Rationale:

Restricting access to the python runtime will help ensure that only an authorized runtime is used for running Python routines within Db2."
      solution    : "For Windows and Linux:

Attach to the Db2 instance.

db2 => attach to <db2instance>

Run the following command to change the Python path, if necessary:

db2 => update database manager configuration using
       python_path <valid directory>

Additional steps for Windows:

Connect to the Db2 host

Right-click over the directory used as the Python path

Choose Properties

Select the Security tab

Assign ownership of the directory to the Db2 Administrator

Grant all Db2 administrator accounts the Full Control authority

Grant only read and execute privileges to all other users (revoke all other privileges)

Additional steps for Linux:

Connect to the Db2 host as root

Change to the directory used as the Python path

Assign bin to be the owner of the directory using the chown command

Change the permissions for the directory

$ chmod -R 755"
      reference   : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      file        : "@DB2_PYTHON_PATH@"
      owner       : "@DB2_USER@"
      mask        : "022"
      group       : "@DB2_GROUP@"
    </custom_item>

    <custom_item>
      type        : FILE_CHECK
      description : "3.1.12 Secure the R Runtime Path (R_PATH)"
      info        : "The R_PATH parameter contains the directory under which the R runtime is installed. The R runtime is used for running R stored procedures and user-defined functions. It is recommended that the owner of this directory is bin on Linux and AIX, and a member of the Db2 administration group on Windows. The directory should have read and execute permission for all users, but only write permission for the owner.

Rationale:

Restricting access to the R runtime will help ensure that only an authorized runtime is used for running R routines within Db2."
      solution    : "For Windows and Linux:

Attach to the Db2 instance.

db2 => attach to <db2instance>

Run the following command to change the R path, if necessary:

db2 => update database manager configuration using
       r_path <valid directory>

Additional steps for Windows:

Connect to the Db2 host

Right-click over the directory used as the R path

Choose Properties

Select the Security tab

Assign ownership of the directory to the Db2 Administrator

Grant all Db2 administrator accounts the Full Control authority

Grant only read and execute privileges to all other users (revoke all other privileges)

Additional steps for Linux:

Connect to the Db2 host as root

Change to the directory used as the R path

Assign bin to be the owner of the directory using the chown command

Change the permissions for the directory

$ chmod -R 755"
      reference   : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      file        : "@DB2_R_PATH@"
      owner       : "@DB2_USER@"
      mask        : "022"
      group       : "@DB2_GROUP@"
    </custom_item>

    <custom_item>
      type        : FILE_CHECK
      description : "3.1.13 Secure the Communication Buffer Exit Library (COMM_EXIT_LIST)"
      info        : "A communication exit library is a dynamically loaded library that vendor applications use to examine communication buffers. The COMM_EXIT_LIST parameter specifies the list of communication buffer exist libraries. The permissions on the libraries should be secured so that users other than the instance owner do not have write privileges.

Rationale:

If a malicious user has write access to a communication exit library, they can overwrite it with their own thereby receiving all of the communication buffers that Db2 receives over the network. Securing the libraries will prevent a loss of confidentiality of data."
      solution    : "To change permissions of a file on Linux:

chmod 755 <file>

To change permissions of a file on Windows:

Right-click on the file

Choose properties

Select the Security tab

Grant the Full Control authority to all Db2 administrator accounts

Grant only read and execute privileges to all other accounts (revoke any other privileges)"
      reference   : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      file        : "@DB2_PLUGIN_PATH@commexit"
      owner       : "@DB2_USER@"
      mask        : "022"
      group       : "@DB2_GROUP@"
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "3.2.1 Specify Secure Remote Shell Command (DB2RSHCMD)"
      info        : "The DB2RSHCMD registry varible specifies the remote shell command to use when starting remote database partitions and with the db2_all script to run utilities and commands on all database partitions. It is recommended that a value be used which encrypts the data sent between partitions, such as ssh.

Rationale:

The traditional rsh command sends all its data, including passwords, in plaintext between partitions. An attacker who can read network traffic may have access to these passwords and other data. Specifying a remote shell command, such as ssh encrypts the data sent over the network.

Impact:

Enabling this value without configuring public and private keys may result in an inability to start or stop Db2 across all partitions without manually issuing db2start/db2stop individually on each partition."
      solution    : "Follow the guidance on this page to create public and private keys for ssh:
https://www.ibm.com/docs/en/db2/11.5?topic=installation-enabling-execution-remote-commands

Run the following command to set the DB2_RSHCMD registry variable to ssh:

db2set DB2RSHCMD=ssh

Default Value:

In Db2 V11.5 Mod Pack 5 or earlier, the default value is rsh.

In Db2 V11.5 Mod Pack 6 or later, the default value is ssh."
      reference   : "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|14.4,CSCv8|3.10,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|1A,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      cmd         : "su - @DB2_USER@ -c 'db2set -all' | grep DB2RSHCMD"
      expect      : "DB2RSHCMD=ssh"
      required    : NO
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "3.2.2 Turn Off Remote Command Legacy Mode (DB2RCMD_LEGACY_MODE)"
      info        : "The DB2RCMD_LEGACY_MODE registry variable determines whether the Db2 Remote Command Service runs with enhanced security or not. It is recommended that legacy mode not be enabled.

This registry variable only applies to Db2 Servers running on Windows.

Rationale:

Legacy mode requires the Db2 service account to have privileges to impersonate the client account."
      solution    : "Run the following command to set the DB2RCMD_LEGACY_MODE registry variable to OFF:

db2set DB2RCMD_LEGACY_MODE=OFF

Default Value:

The default value of DB2RCMD_LEGACY_MODE is OFF."
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      cmd         : "su - @DB2_USER@ -c 'db2set -all' | grep DB2RCMD_LEGACY_MODE"
      expect      : "DB2RCMD_LEGACY_MODE=OFF"
      required    : NO
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "3.2.3 Disable Grants During Restore (DB2_RESTORE_GRANT_ADMIN_AUTHORITIES)"
      info        : "The DB2_RESTORE_GRANT_ADMIN_AUTHORITIES registry variable determines whether the authorization ID of the user performing a restore is granted administrative authorities (SECADM, DBADM, DATAACCESS, and ACCESSCTRL authorities) on the restored database. It is typically used when restoring a database on a server where the original database creator account does not exist. It is recommended that this variable not be set except when specifically performing a restore where you wish these privileges to be granted so they are not accidentally granted.

Rationale:

Use of this registry variable may grant administrative authorities accidentally if the value is left on during normal operations and a restore is run."
      solution    : "Run the following command to set the DB2_RESTORE_GRANT_ADMIN_AUTHORITIES registry variable to OFF:

db2set DB2_RESTORE_GRANT_ADMIN_AUTHORITIES=OFF

Default Value:

The default value of DB2_RESTORE_GRANT_ADMIN_AUTHORITIES is OFF."
      reference   : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      cmd         : "su - @DB2_USER@ -c 'db2set -all' | grep DB2_RESTORE_GRANT_ADMIN_AUTHORITIES"
      expect      : "DB2_RESTORE_GRANT_ADMIN_AUTHORITIES=OFF"
      required    : NO
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "3.2.4 Enable Extended Security (DB2_EXTSECURITY)"
      info        : "The DB2_EXTSECURITY registry variable determines whether extended security is enabled on Windows. Extended security enables file permissions for all Db2 objects so they can be accessed by users in DB2ADMNS and DB2USERS groups. It is recommended that extended security be enabled.

This registry variable only applies to Db2 Servers running on Windows.

Rationale:

Extended security provides file permission protection for Db2 objects when running in a multi-user environment.

Impact:

Before enabling extended security for an existing installation, you should ensure you have added users to the DB2ADMNS and DB2USERS groups so that you are able to access Db2 once the permission have been applied. Once extended security is enabled, it is not recommended to be directly disabled, instead a full re-install should be used."
      solution    : "Run the following command to enable extended security (consult documentation for additional options as appropriate):

db2extsec"
      reference   : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      cmd         : "su - @DB2_USER@ -c 'db2set -all' | grep DB2_EXTSECURITY"
      expect      : "DB2_EXTSECURITY=ON"
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "3.2.5 Limit OS Privileges of Fenced Mode Process (DB2_LIMIT_FENCED_GROUP)"
      info        : "The DB2_LIMIT_FENCED_GROUP registry variable allows restricting the operating system privileges of the fenced mode process (db2fmp) to the privileges assigned to the DB2USERS group.

This variable only has effect if extended security is enabled (DB2_EXTSEC) and the Db2 Service Account is not LocalSystem.

This registry variable only applies to Db2 Servers running on Windows.

Rationale:

By default, the fenced mode process has access to both the DB2ADMNS and DB2USERS groups."
      solution    : "Run the following command to set the DB2_LIMIT_FENCED_GROUP registry variable to ON:

db2set DB2_LIMIT_FENCED_GROUP=ON

Default Value:

The default value of DB2_LIMIT_FENCED_GROUP is OFF."
      reference   : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      cmd         : "su - @DB2_USER@ -c 'db2set -all' | grep DB2_LIMIT_FENCED_GROUP"
      expect      : "DB2_LIMIT_FENCED_GROUP=ON"
    </custom_item>

    <custom_item>
      type        : FILE_CHECK
      description : "3.3.1 Secure Db2 Runtime Library"
      info        : "A Db2 software installation will place all executables under the default <DB2PATH>\sqllib directory. This directory needs to be secured so it grants only the necessary access to authorized users and administrators.

Rationale:

The Db2 runtime is comprised of files that are executed as part of the Db2 service. If these resources are not secured, an attacker may alter them to execute arbitrary code."
      solution    : "For Windows:

Connect to the Db2 host

Right-click on the NODE000x\sqldbdir directory

Choose Properties

Select the Security tab

Select all DB administrator accounts and grant them the Full Control authority

Select all other accounts and revoke all privileges other than Read and Execute

For Linux:

Connect to the Db2 host

Change to the /NODE000x/sqldbdir directory

Change the permission level of the directory to this recommended value

$ chmod -R 755

Default Value:

Linux

$DB2PATH/NODE000x/sqldbdir is owned by the Db2 administrator with read, write, and execute access.

Windows

$DB2PATH\NODE000x\sqldbdir owned by the Db2 administrator with read, write, and execute access.

The database instance db2inst1 located in /home/NODE000x needs the following permissions:

drwxrwxr-x 11 db2inst1 db2grp1 4096 Aug 08 1:34 NODE0000

All lower directories need the same settings:

/db2,/db2/data, /db2/data/db2inst1, /db2/data/db2inst1/db2inst1 and /db2/data/db2inst1/db2inst1/NODE0000 would need the same settings drwxrwxr-x."
      reference   : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1M,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      file        : "@DB2_SQLDB_DIR@"
      owner       : "@DB2_USER@"
      mask        : "022"
      group       : "@DB2_GROUP@"
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "3.3.3 Set umask Value in the Db2 Instance Owner's .profile"
      info        : "The Db2 instance owner's .profile file in Linux sets the environment variables and the settings for the user. This file is specific to the Korn shell and BASH shell, and other shells may have a different file.

Rationale:

The umask value should be set to 022 for the owner of the Db2 software at all times to ensure files are not created with unnecessary privileges."
      solution    : "Add umask 022 to the .profile file."
      reference   : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      file        : "~/.profile"
      regex       : "^ *umask 022"
      expect      : "^ *umask 022"
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "4.1.2 Set Failed Archive Retry Delay (ARCHRETRYDELAY)"
      info        : "The ARCHRETRYDELAY parameter specifies the number of seconds the Db2 service will wait before it reattempts to archive log files after a failure. It is recommended that this parameter be set anywhere in the range of 10-30. You do not want the delay to be so short that the database ends up in a denial of service scenario, but you don't want the delay to be too long if an outside attack happens at the same time.

Rationale:

Ensure that the value is non-zero, otherwise archive logging will not retry after the first failure. A denial of service attack can render the database without an archive log if this setting is not set. An archive log will ensure that all transactions can safely be restored or logged for auditing."
      solution    : "Connect to the Db2 database

db2 => connect to <dbname>

To successfully set the ARCHRETRYDELAY within the 10-30 range, run the following command:

db2 => update database configuration using archretrydelay *nn* (where *nn* is a range between 10-30)

Default Value:

The default value for ARCHRETRYDELAY is 20."
      reference   : "800-53|AU-11,800-53r5|AU-11,CSCv8|8.10,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-11,LEVEL|1A,NESA|M5.2.3,NESA|T3.6.2,NIAv2|SM7,PCI-DSSv3.2.1|10.7,PCI-DSSv4.0|10.5.1,QCSC-v1|8.2.1,QCSC-v1|13.2"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      cmd         : "su - @DB2_USER@ -c '@DB2_BIN_PATH@/db2 get database configuration for @DB2_DATABASE@' | /bin/egrep '\\(ARCHRETRYDELAY\\) =' | /bin/awk -F'= ' '{ print $2 }'"
      expect      : "^1[0-9]|2[0-9]|30$"
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "4.1.3 Auto-restart After Abnormal Termination (AUTORESTART)"
      info        : "The AUTORESTART parameter specifies if the database manager will start a crash recovery automatically when the first user tries to connect to a database which has previously terminated abnormally.

If the parameter is set to OFF an explicit RESTART DATABASE command has to be issued to initiate a crash recovery.

It is recommended that this parameter is set to ON (which is also the default).

Rationale:

Setting the database to auto-restart will reduce the downtime of the database."
      solution    : "Connect to the Db2 database

db2 => connect to <dbname>

Run the following command:

db2 => update database configuration using autorestart on

Default Value:

The default value for AUTORESTART is ON."
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1A,NESA|T3.2.1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      cmd         : "su - @DB2_USER@ -c '@DB2_BIN_PATH@/db2 get database configuration for @DB2_DATABASE@' | /bin/egrep '\\(AUTORESTART\\) =' | /bin/awk -F'= ' '{ print $2 }'"
      expect      : "^ON$"
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "4.1.4 Disable Database Discovery (DISCOVER_DB)"
      info        : "The DISCOVER_DB parameter specifies if the database will respond to a discovery request from a client. It is recommended that this parameter be set to DISABLE.

Rationale:

Setting the database discovery to disabled can hide a database with sensitive data."
      solution    : "Connect to the Db2 database

db2 => connect to <dbname>

Run the following command:

db2 => update database configuration using discover_db disable"
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      cmd         : "su - @DB2_USER@ -c '@DB2_BIN_PATH@/db2 get database configuration for @DB2_DATABASE@' | /bin/egrep '\\(DISCOVER_DB\\) =' | /bin/awk -F'= ' '{ print $2 }'"
      expect      : "^DISABLE$"
    </custom_item>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          type        : CMD_EXEC
          description : "LOGARCHMETH1 Setting"
          cmd         : "su - @DB2_USER@ -c '@DB2_BIN_PATH@/db2 get database configuration for @DB2_DATABASE@' | /bin/egrep '\\(LOGARCHMETH1\\) =' | /bin/awk -F'= ' '{ print $2 }'"
          expect      : "^(DISK|DB2REMOTE|TSM|VENDOR):@DB2_LOGARCHMETH1@$"
        </custom_item>

        <custom_item>
          type        : FILE_CHECK
          description : "LOGARCHMETH1 OS Permissions"
          file        : "@DB2_LOGARCHMETH1@"
          owner       : "@DB2_USER@"
          mask        : "022"
          group       : "@DB2_GROUP@"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "4.1.5 Secure Permissions for the Primary Archive Log Location (LOGARCHMETH1)"
          info        : "The LOGARCHMETH1 parameter specifies the type of media and the location used as the primary destination of archived logs. It is recommended that the directory used for the archived logs be set to full access for Db2 administrator accounts and read and execute for all other accounts.

Rationale:

Restricting access to the contents of the primary archive log directory will help ensure that the confidentiality, integrity, and availability of archive logs are protected. Although there are many ways to ensure that your primary logs will be archived, we recommend using the value of DISK as part of the LOGARCHMETH1 parameter. This will properly ensure that the primary logs are archived. A finding of OFF is not acceptable."
          solution    : "For Windows and Linux:

Attach to the Db2 instance.

Run the following command to change the primary archive log directory, if necessary:

db2 => update database configuration using
       logarchmeth1 <valid directory>

Additional steps for Windows (assuming that the logarchmeth1 parameter includes DISK):

Connect to the Db2 host

Right-click on the primary archive log directory

Choose Properties

Select the Security tab

Grant all Db2 administrator accounts the Full Control authority

Grant all other accounts read and execute privileges only (revoke all other privileges)

Additional steps for Linux (assuming that the logarchmeth1 parameter includes DISK):

Connect to the Db2 host

Change to the primary archive log directory

Change the permissions for the directory

$ chmod -R 755"
          reference   : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
          see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
          show_output : YES
        </report>
      </then>
    </if>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          type        : CMD_EXEC
          description : "LOGARCHMETH2 Setting"
          cmd         : "su - @DB2_USER@ -c '@DB2_BIN_PATH@/db2 get database configuration for @DB2_DATABASE@' | /bin/egrep '\\(LOGARCHMETH2\\) =' | /bin/awk -F'= ' '{ print $2 }'"
          expect      : "^(DISK|DB2REMOTE|TSM|VENDOR):@DB2_LOGARCHMETH2@$"
        </custom_item>

        <custom_item>
          type        : FILE_CHECK
          description : "LOGARCHMETH2 OS Permission"
          file        : "@DB2_LOGARCHMETH2@"
          owner       : "@DB2_USER@"
          mask        : "022"
          group       : "@DB2_GROUP@"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "4.1.6 Secure Permissions for the Secondary Archive Log Location (LOGARCHMETH2)"
          info        : "The LOGARCHMETH2 parameter specifies the type of media and the location used as the secondary destination for archived logs. It is recommended that the directory used for the archived logs be set to full access for Db2 administrator accounts and read and execute only for all other accounts.

Rationale:

Restricting access to the contents of the secondary archive log directory will help ensure that the confidentiality, integrity, and availability of archive logs are protected. Although there are many ways to ensure that your logs will be archived, we recommend using the value of DISK as part of the LOGARCHMETH2 parameter. This will properly ensure that the logs are archived. A finding of OFF is not acceptable."
          solution    : "For Windows and Linux:

Attach to the Db2 instance.

Run the following command to change the secondary archive log directory, if necessary:

db2 => update database configuration using
       logarchmeth2 <valid directory>

Additional steps for Windows (assuming that the logarchmeth2 parameter includes DISK):

Connect to the Db2 host

Right-click on the secondary archive log directory

Choose Properties

Select the Security tab

Grant all Db2 administrator accounts the Full Control authority

Grant all other accounts read and execute privileges only (revoke all other privileges)

Additional steps for Linux (assuming that the logarchmeth2 parameter includes DISK):

Connect to the Db2 host

Change to the secondary archive log directory

Change the permissions for the directory

$ chmod -R 755"
          reference   : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
          see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
          show_output : YES
        </report>
      </then>
    </if>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          type        : CMD_EXEC
          description : "FAILARCHPATH Setting"
          cmd         : "su - @DB2_USER@ -c '@DB2_BIN_PATH@/db2 get database configuration for @DB2_DATABASE@' | /bin/egrep '\\(FAILARCHPATH\\) =' | /bin/awk -F'= ' '{ print $2 }'"
          expect      : "^@DB2_FAILARCHPATH@$"
        </custom_item>

        <custom_item>
          type        : FILE_CHECK
          description : "FAILARCHPATH OS Permission"
          file        : "@DB2_FAILARCHPATH@"
          owner       : "@DB2_USER@"
          mask        : "022"
          group       : "@DB2_GROUP@"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "4.1.7 Secure Permissions for the Tertiary Archive Log Location (FAILARCHPATH)"
          info        : "The FAILARCHPATH parameter specifies the type of media and the location used as the tertiary destination of archived logs. It is recommended that the directory used for the archived logs be set to full access for Db2 administrator accounts and read and execute only for all other accounts.

Rationale:

Restricting access to the contents of the tertiary archive log directory will help ensure that the confidentiality, integrity, and availability of archive logs are protected. Although there are many ways to ensure that your logs will be archived, we recommend using the value of DISK as part of the FAILARCHPATH parameter. This will properly ensure that the logs are archived. A finding of OFF is not acceptable."
          solution    : "For Windows and Linux:

Attach to the Db2 instance.

Run the following command to change the tertiary archive log directory, if necessary:

db2 => update database configuration using failarchpath

Additional steps for Windows (assuming that the failarchpath parameter includes DISK):

Connect to the Db2 host

Right-click on the tertiary archive log directory

Choose Properties

Select the Security tab

Grant all Db2 administrator accounts the Full Control authority

Grant all other accounts read and execute privileges only (revoke all other privileges)

For Linux (assuming that the failarchpath parameter includes DISK):

Connect to the Db2 host

Change to the tertiary archive log directory

Change the permissions for the directory

$ chmod -R 755"
          reference   : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
          see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
          show_output : YES
        </report>
      </then>
    </if>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          type        : CMD_EXEC
          description : "MIRRORLOGPATH Setting"
          cmd         : "su - @DB2_USER@ -c '@DB2_BIN_PATH@/db2 get database configuration for @DB2_DATABASE@' | /bin/egrep '\\(MIRRORLOGPATH\\) =' | /bin/awk -F'= ' '{ print $2 }'"
          expect      : "^@DB2_MIRRORLOGPATH@$"
        </custom_item>

        <custom_item>
          type        : FILE_CHECK
          description : "MIRROLOGPATH OS Permission"
          file        : "@DB2_MIRRORLOGPATH@"
          owner       : "@DB2_USER@"
          mask        : "022"
          group       : "@DB2_GROUP@"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "4.1.8 Secure Permissions for the Log Mirror Location (MIRRORLOGPATH)"
          info        : "The MIRRORLOGPATH parameter specifies the type of media and the location used to store the mirror copy of the logs. It is recommended that the directory used for the mirror copy of the logs be set to full access for Db2 administrator accounts and read and execute only for all other accounts.

Rationale:

A mirror log path should not be empty and it should be a valid path. The mirror log path stores a second copy of the active log files. Access to the directory pointed to by that path should be restricted through permissions to help ensure that the confidentiality, integrity, and availability of the mirror logs are protected."
          solution    : "For Windows and Linux:

Connect to the Db2 database

db2 => connect to <dbname>

Run the following command to change the mirror log directory, if necessary:

db2 => update database configuration using mirrorlogpath <valid directory>

Additional steps for Windows:

Connect to the Db2 host

Right-click on the mirror log directory

Choose Properties

Select the Security tab

Grant all Db2 administrator accounts the Full Control authority

Grant all other accounts read and execute privileges only (revoke all other privileges)

Additional steps for Linux:

Connect to the Db2 host

Change to the mirror log directory

Change the permissions for the directory

$ chmod -R 755"
          reference   : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
          see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
          show_output : YES
        </report>
      </then>
    </if>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          type        : CMD_EXEC
          description : "OVERFLOWLOGPATH Setting"
          cmd         : "su - @DB2_USER@ -c '@DB2_BIN_PATH@/db2 get database configuration for @DB2_DATABASE@' | /bin/egrep '\\(OVERFLOWLOGPATH\\) =' | /bin/awk -F'= ' '{ print $2 }'"
          expect      : "^@DB2_OVERFLOWLOGPATH@$"
        </custom_item>

        <custom_item>
          type        : FILE_CHECK
          description : "OVERFLOWLOGPATH OS Permission"
          file        : "@DB2_OVERFLOWLOGPATH@"
          owner       : "@DB2_USER@"
          mask        : "022"
          group       : "@DB2_GROUP@"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "4.1.9 Secure Permissions for the Log Overflow Location (OVERFLOWLOGPATH)"
          info        : "The OVERFLOWLOGPATH parameter specifies a location for Db2 databases to find log files needed for a rollforward operation, as well as where to store active log files retrieved from the archive. It also gives a location for finding and storing log files needed for using db2ReadLog API. It is recommended that the directory used be set to full access for Db2 administrator accounts and read and execute only for all other accounts.

Rationale:

The overflow log path can contain log files containing user data. Access to the directory pointed to by that path should be restricted through permissions to help ensure that the confidentiality, integrity, and availability of the logs are protected."
          solution    : "For Windows and Linux:

Connect to the Db2 database

db2 => connect to <dbname>

Run the following command to change the mirror log directory, if necessary:

db2 => update database configuration using overflowlogpath <valid directory>

Additional steps for Windows:

Connect to the Db2 host

Right-click on the overflow archive log directory

Choose Properties

Select the Security tab

Grant all Db2 administrator accounts the Full Control authority

Grant all other accounts read and execute privileges only (revoke all other privileges)

Additional steps for Linux:

Connect to the Db2 host

Change to the overflow log directory

Change the permissions for the directory

$ chmod -R 755"
          reference   : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1M,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
          see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
          show_output : YES
        </report>
      </then>
    </if>

    <custom_item>
      type        : CMD_EXEC
      description : "4.1.10 Establish Retention Set Size for Backups (NUM_DB_BACKUPS)"
      info        : "The NUM_DB_BACKUPS parameter specifies the number of backups to retain for a database before marking the oldest backup as deleted. It is recommended that this parameter be set to at least 12.

Rationale:

Retain multiple copies of the database backup to ensure that the database can recover from an unexpected failure. This parameter should not be set to 0. Multiple backups should be kept ensuring that all logs and transactions can be used for auditing."
      solution    : "Connect to the Db2 database

db2 => connect to <dbname>

Run the following command:

db2 => update database configuration using num_db_backups 12"
      reference   : "800-171|3.8.9,800-53|CP-9,800-53|CP-10,800-53r5|CP-9,800-53r5|CP-10,CSCv7|10.1,CSCv8|11.2,CSF|PR.IP-4,CSF|RC.RP-1,CSF|RS.RP-1,GDPR|32.1.b,GDPR|32.1.c,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(ii),ISO/IEC-27001|A.12.3.1,ITSG-33|CP-9,ITSG-33|CP-10,ITSG-33|CP-10a.,LEVEL|1M,NESA|M5.2.3,NESA|T2.2.4,QCSC-v1|5.2.3,QCSC-v1|10.2.1,QCSC-v1|11.2"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      cmd         : "su - @DB2_USER@ -c '@DB2_BIN_PATH@/db2 get database configuration for @DB2_DATABASE@' | /bin/egrep '\\(NUM_DB_BACKUPS\\) =' | /bin/awk -F'= ' '{ print $2 }'"
      expect      : "^1[2-9]|[1-9][0-9]+$"
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "4.1.11 Set Archive Log Failover Retry Limit (NUMARCHRETRY)"
      info        : "The NUMARCHRETRY parameter determines how many times a database will try to archive the log file to the primary or the secondary archive destination before trying the failover directory. It is recommended that this parameter be set to 5.

Rationale:

Establishing a failover retry time limit will ensure that the database will always have a means to recover from an abnormal termination. This parameter should not be set to 0."
      solution    : "Connect to the Db2 database

db2 => connect to <dbname>

Run the following command:

db2 => update database configuration using numarchretry 5"
      reference   : "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-3,800-53|AU-3(1),800-53|AU-4,800-53|AU-7,800-53|AU-12,800-53r5|AU-3,800-53r5|AU-3(1),800-53r5|AU-4,800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.2.3(c),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|8.1.4.3(b),CSCv7|6.3,CSCv7|6.4,CSCv8|8.3,CSCv8|8.5,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.DS-4,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,ITSG-33|AU-3(1),ITSG-33|AU-4,ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1A,NESA|T3.3.1,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      cmd         : "su - @DB2_USER@ -c '@DB2_BIN_PATH@/db2 get database configuration for @DB2_DATABASE@' | /bin/egrep '\\(NUMARCHRETRY\\) =' | /bin/awk -F'= ' '{ print $2 }'"
      expect      : "^5$"
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "4.1.12 Set Maximum Number of Applications (MAXAPPLS)"
      info        : "The MAXAPPLS parameter specifies the maximum number of concurrent applications that can be connected (both local and remote) to a database. In an instance with a single database, it is recommended that this value be set to AUTOMATIC. While this indicates that any number of connections should be allowed, an upper limit of MAX_CONNECTIONS database manager configuration parameter is still enforced. If there are multiple databases within the instance, then the sum of MAXAPPLS for each database should be less than or equal to MAX_CONNECTIONS.

When AUTOMATIC is used, MAXAPPLS can also have a parameter. The value is not used to determine the maximum number of connections, but rather for dependent parameters, such as PCKCACHESZ and CATALOG_CACHESZ that can derive their value from MAXAPPLS. In such a case the value specified with AUTOMATIC should represent the expected number of connections.

Rationale:

By default, Db2 allows an unlimited number of users to access the Db2 instance. In addition to giving access to the Db2 instance to authorized users only, it is recommended to set a limit to the number of users allowed to access a Db2 instance. This helps prevent denial of service conditions should an authorized process malfunction and attempt many simultaneous connections.

Impact:

Increasing the value of this parameter without lowering the MAXLOCKS parameter or increasing the LOCKLIST parameter could cause you to reach the database limit on locks (LOCKLIST) rather than the application limit and as a result cause pervasive lock escalation problems.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "Connect to the Db2 database

db2 => connect to <dbname>

If a single database is used in the instance, run the following command:

db2 => update database configuration using maxappls AUTOMATIC

If multiple databases are used in the instance, determine appropriate values for each database such that the sum of MAXAPPLS values equals the MAX_CONNECTIONS database manager configuration parameter value (for example 100 for each of 2 databases when MAX_CONNECTIONS is 200), and run the following command:

db2 => update database configuration using maxappls 200"
      reference   : "800-53|AC-10,800-53r5|AC-10,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-10,LEVEL|1A,NESA|T5.5.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      cmd         : "su - @DB2_USER@ -c '@DB2_BIN_PATH@/db2 get database configuration for @DB2_DATABASE@' | /bin/egrep '\\(MAXAPPLS\\) =' | /bin/awk -F'= ' '{ print $2 }'"
      expect      : "Manual Review Required"
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "4.1.13 Ensure a Secure Connect Procedure is Used (CONNECT_PROC)"
      info        : "The CONNECT_PROC stored procedure runs as part of every connection to the database and allows customization of the application environment, such as setting special registers. It could for example, set the CURRENT_PATH special register which controls the search path for finding functions and procedures to execute. Only an authorized procedure should be used.

Rationale:

The CONNECT_PROC procedure could be used to modify the application environment within the connection causing unexpected behavior.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "To turn off the connect proc, perform the following commands:

Connect to the Db2 database

db2 => connect to <dbname>

Run the following command:

db2 => update database configuration using
       connect_proc NULL IMMEDIATE"
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1M,NESA|T3.2.1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      cmd         : "su - @DB2_USER@ -c '@DB2_BIN_PATH@/db2 get database configuration for @DB2_DATABASE@' | /bin/egrep '\\(CONNECT_PROC\\) ='"
      expect      : "Manual Review Required"
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "4.1.14 Specify a Secure Location for External Tables (EXTBL_LOCATION)"
      info        : "The EXTBL_LOCATION database configuration parameter provides an allow list of paths that external tables may access for local files, for both reading and writing. It is recommended that this value be set to appropriate paths with the understanding that confidential data may reside in this directory. Specifying appropriate paths is part of an organizations standard operating procedures (SOP).

Rationale:

External tables can read and write data to the paths configured within the EXTBL_LOCATION configuration parameter. To avoid a loss of confidentiality of the data which may be reside in these paths, they should be examined to ensure they match the values specified by the SOP.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "To specify an external table location, perform the following commands:

Connect to the Db2 database

db2 => connect to <dbname>

Run the following command:

db2 => update database configuration using extbl_location <paths>"
      reference   : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1M,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      cmd         : "su - @DB2_USER@ -c '@DB2_BIN_PATH@/db2 get database configuration for @DB2_DATABASE@' | /bin/egrep '\\(EXTBL_LOCATION\\) =' | /bin/awk -F'= ' '{ print $2 }'"
      expect      : "Manual Review Required"
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "4.1.15 Disable Database Discoverability (DISCOVER_DB)"
      info        : "The DISCOVER_DB parameter specifies whether the database can be discovered in the network. It is recommended that databases not be discoverable.

Rationale:

Discovery capabilities may be used by a malicious entity to derive the names of and target Db2 databases."
      solution    : "Connect to the Db2 database.

db2 => connect to <dbname>

Run the following command:

db2 => update database configuration using discover_db disable"
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      cmd         : "su - @DB2_USER@ -c '@DB2_BIN_PATH@/db2 get database configuration for @DB2_DATABASE@' | /bin/egrep '\\(DISCOVER_DB\\) =' | /bin/awk -F'= ' '{ print $2 }'"
      expect      : "^DISABLE$"
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "5.1 Specify a Secure Connection Authentication Type (SRVCON_AUTH)"
      info        : "This parameter can take on any of the following values:

NOT_SPECIFIED

CLIENT

SERVER

SERVER_ENCRYPT

KERBEROS

KRB_SERVER_ENCRYPT

GSSPLUGIN

GSS_SERVER_ENCRYPT

SERVER_ENCRYPT_TOKEN

KERBEROS_TOKEN

GSSPLUGIN_TOKEN

KRB_SVR_ENC_TOKEN

GSS_SVR_ENC_TOKEN

If this parameter is set to NOT_SPECIFIED, then the type of authentication for connections is determined by the AUTHENTICATION parameter.

Recommendations:

Do not use CLIENT authentication type.

SERVER_ENCRYPT instead of SERVER is recommended as a compensating configuration if TLS cannot be used to encrypted client server communications.

Rationale:

When using CLIENT authentication type, the server trusts the client to authenticate the connecting user. A malicious user can connect to the database as any user including a database administrator by simply creating that user on the client system.

When using SERVER authentication type without SSL enabled, the user ID and password that are sent from the client to the server during a connect or an attach are in plaintext format. Therefore, these credentials are exposed when sent across an unsecure network and can be intercepted by a malicious user.

Impact:

It is important to be aware that the implementation of this recommendation results in a brief downtime. It is advisable to ensure that the setting is implemented during an approved maintenance window."
      solution    : "Attach to the Db2 instance

db2 => attach to <db2instance>

Run the following command:

db2 => update database manager configuration parameter
       using srvcon_auth <authentication type>

Restart the Db2 instance.

db2 => db2stop
db2 => db2start

Refer to the 'encryption of data in motion' section for more information about using SSL for client-server communication."
      reference   : "800-171|3.1.1,800-53|AC-2(1),800-53|AC-3,800-53r5|AC-2(1),800-53r5|AC-3,CN-L3|7.1.3.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|16.2,CSCv8|6.7,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-2(1),ITSG-33|AC-3,LEVEL|1M,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,TBA-FIISB|31.1"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      cmd         : "su - @DB2_USER@ -c '@DB2_BIN_PATH@/db2 get database manager configuration' | /bin/egrep '\\(SRVCON_AUTH\\) =' | /bin/awk -F'= ' '{ print $2 }'"
      expect      : "^SERVER$"
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "5.2 Specify a Secure Authentication Type (AUTHENTICATION)"
      info        : "The AUTHENTICATION database manager configuration parameter specifies how and where authentication takes place for incoming connections to the database as well as local authorization of commands run outside a connection or attachment, such as tools run from the command line. This parameter can be overridden by the SRVCON_AUTH parameter for incoming connections.

This parameter can take on any of the following values:

CLIENT

SERVER

SERVER_ENCRYPT

DATA_ENCRYPT

DATA_ENCRYPT_CMP

KERBEROS

KRB_SERVER_ENCRYPT

GSSPLUGIN

GSS_SERVER_ENCRYPT

Recommendations:

Do not use CLIENT, DATA_ENCRYPT or DATA_ENCRYPT_CMP authentication types.

SERVER_ENCRYPT instead of SERVER is recommended as a compensating configuration if TLS cannot be used to encrypted client server communications.

Rationale:

When using CLIENT authentication type, the server trusts the client to authenticate the connecting user. A malicious user can connect to the database as any user including a database administrator by simply creating that user on the client system.

DATA_ENCRYPT and DATA_ENCRYPT_CMP authentication types provide the ability to encrypt both user credentials and user data when sent from the client to the server. Since these authentication types use DES encryption algorithm which is cryptographically weak, they are deprecated in favor of SSL.

When using SERVER authentication type without SSL enabled, the user ID and password that are sent from the client to the server during a connect or an attach are in plaintext format. Therefore, these credentials are exposed when sent across an insecure network and can be intercepted by a malicious user.

Impact:

It is important to be aware that the implementation of this recommendation results in a brief downtime. It is therefore advisable to ensure that the setting is implemented during an approved maintenance window.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "Attach to the Db2 instance.

db2 => attach to <db2instance>

Run the following command:

db2 => update database manager configuration parameter
       using authentication <authentication type>

Restart the Db2 instance.

db2 => db2stop
db2 => db2start

Refer to the 'encryption of data in motion' section for more information about using SSL for client-server communication."
      reference   : "800-171|3.1.1,800-53|AC-2(1),800-53|AC-3,800-53r5|AC-2(1),800-53r5|AC-3,CN-L3|7.1.3.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|16.2,CSCv8|6.7,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-2(1),ITSG-33|AC-3,LEVEL|1M,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,TBA-FIISB|31.1"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      cmd         : "su - @DB2_USER@ -c '@DB2_BIN_PATH@/db2 get database manager configuration' | /bin/egrep '\\(AUTHENTICATION\\) =' | /bin/awk -F'= ' '{ print $2 }'"
      expect      : "Manual Review Required"
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "5.3 Database Manager Configuration Parameter: ALTERNATE_AUTH_ENC"
      info        : "The ALTERNATE_AUTH_ENC database manager configuration parameter specifies the encryption algorithm that is used to encrypt user ID and password that are sent from the client during a connect or attach. This parameter is in effect when the authentication method that is negotiated between the client and the server is SERVER_ENCRYPT.

It is recommended to set this parameter to AES_ONLY.

Rationale:

If this parameter is set to a value other than AES_ONLY, the server can accept the DES encryption algorithm to encrypt the user credentials and DES is cryptographically weak in comparison to AES.

Impact:

It is important to be aware that the implementation of this recommendation results in a brief downtime. It is therefore advisable to ensure that the setting is implemented during an approved maintenance window.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "Attach to the Db2 instance

db2 => attach to <db2instance>

Run the following command:

db2 => update database manager configuration parameter
       using alternate_auth_enc aes_only

Restart the Db2 instance.

db2 => db2stop
db2 => db2start"
      reference   : "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|14.4,CSCv8|3.10,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|1M,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      cmd         : "su - @DB2_USER@ -c '@DB2_BIN_PATH@/db2 get database manager configuration' | /bin/egrep '\\(ALTERNATE_AUTH_ENC\\) =' | /bin/awk -F'= ' '{ print $2 }'"
      expect      : "Manual Review Required"
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "5.4 Database Manager Configuration Parameter: TRUST_ALLCLNTS"
      info        : "This database manager configuration parameter is only active when the authentication parameter is set to CLIENT which is not a recommended setting as discussed in the [authentication parameter section](#specify-a-secure-authentication-type-authentication). If the parameter is set to YES, the server assumes that the client side is handling authentication to the database. If the parameter is set to NO, the client must provide authentication to the server on behalf of the user.

The recommended value for this parameter is NO.

Rationale:

If the server trusts the client to authenticate the connecting user, a malicious user can connect to the database as any user including a database administrator by simply creating that user on the client system.

Impact:

It is important to be aware that the implementation of this recommendation results in a brief downtime. It is therefore advisable to ensure that the setting is implemented during an approved maintenance window.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "Attach to the Db2 instance.

db2 => attach to <db2instance>

Run the following command:

db2 => update database manager configuration parameter
       using trust_allclnts no

Restart the Db2 instance.

db2 => db2stop
db2 => db2start"
      reference   : "800-171|3.1.1,800-53|AC-2(1),800-53|AC-3,800-53r5|AC-2(1),800-53r5|AC-3,CN-L3|7.1.3.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv8|6.7,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-2(1),ITSG-33|AC-3,LEVEL|1M,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,TBA-FIISB|31.1"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      cmd         : "su - @DB2_USER@ -c '@DB2_BIN_PATH@/db2 get database manager configuration' | /bin/egrep '\\(TRUST_ALLCLNTS\\) =' | /bin/awk -F'= ' '{ print $2 }'"
      expect      : "Manual Review Required"
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "5.5 Database Manager Configuration Parameter: TRUST_CLNTAUTH"
      info        : "This database manager configuration parameter is only active when the authentication parameter is set to CLIENT which is not a recommended setting as discussed in the [authentication parameter section](#specify-a-secure-authentication-type-authentication). If the parameter is set to CLIENT, the user ID and password are not needed, but if they are provided, authentication will occur at the client. If the parameter is set to SERVER, the user ID and password are needed and will be authenticated at the server.

The recommended value for this parameter is SERVER.

Rationale:

If the server trusts the client to authenticate the connecting user, a malicious user can connect to the database as any user including a database administrator by simply creating that user on the client system.

Impact:

It is important to be aware that the implementation of this recommendation results in a brief downtime. It is therefore advisable to ensure that the setting is implemented during an approved maintenance window.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "Attach to the Db2 instance.

db2 => attach to <db2instance>

Run the following command:

db2 => update database manager configuration parameter
       using trust_clntauth SERVER

Restart the Db2 instance.

db2 => db2stop
db2 => db2start"
      reference   : "800-171|3.1.1,800-53|AC-2(1),800-53|AC-3,800-53r5|AC-2(1),800-53r5|AC-3,CN-L3|7.1.3.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv8|6.7,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-2(1),ITSG-33|AC-3,LEVEL|1M,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,TBA-FIISB|31.1"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      cmd         : "su - @DB2_USER@ -c '@DB2_BIN_PATH@/db2 get database manager configuration' | /bin/egrep '\\(TRUST_CLNTAUTH\\) =' | /bin/awk -F'= ' '{ print $2 }'"
      expect      : "Manual Review Required"
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "5.6 Database Manager Configuration Parameter: FED_NOAUTH"
      info        : "The FED_NOAUTH database manager configuration parameter determines whether federated authentication will be bypassed at the instance. If this parameter is set to YES, the AUTHENTICATION parameter is set to SERVER or SERVER_ENCRYPT and the FEDERATED parameter is set to YES, then authentication at the instance is bypassed and is instead assumed to be performed at the data source.

It is recommended to set this parameter to NO.

Rationale:

Setting FED_NOAUTH to NO will ensure that authentication is not bypassed for any users that are connecting to the instance.

Impact:

It is important to be aware that the implementation of this recommendation results in a brief downtime. It is therefore advisable to ensure that the setting is implemented during an approved maintenance window.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "Attach to the Db2 instance

db2 => attach to <db2instance>

Run the following command:

db2 => update database manager configuration using fed_auth no

Restart the Db2 instance.

db2 => db2stop
db2 => db2start"
      reference   : "800-171|3.1.1,800-53|AC-2(1),800-53r5|AC-2(1),CN-L3|7.1.3.2(d),CSCv7|16.2,CSCv8|5.6,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(1),LEVEL|1M,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      cmd         : "su - @DB2_USER@ -c '@DB2_BIN_PATH@/db2 get database manager configuration' | /bin/egrep '\\(FED_NOAUTH\\) =' | /bin/awk -F'= ' '{ print $2 }'"
      expect      : "Manual Review Required"
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "5.10 DB2AUTH Registry Variable"
      info        : "The DB2AUTH registry variable is used to control various authentication related behaviors in Db2.

The following settings are recommended for this registry variable:

Use DISABLE_CHGPASS which disables the ability to change a user's password from the client.

Use JCC_ENFORCE_SECMEC which enforces that the Db2 server does not accept a clear text password security mechanism when using SERVER_ENCRYPT authentication type.

If CLIENT authentication is being used which is not recommended as discussed in section 6.2, it is also recommended to set this registry variable to TRUSTEDCLIENT_SRVENC and not TRUSTEDCLIENT_DATAENC. TRUSTEDCLIENT_SRVENC forces untrusted clients to use SERVER_ENCRYPT authentication type while TRUSTEDCLIENT_DATAENC forces them to use DATA_ENCRYPT.

If DB2AUTH is not set to DISABLE_CHGPASS, refer to the DB2CHGPWD_EEE registry variable section which specifies whether users are able to change passwords through Db2 in a partitioned database environment.

Rationale:

Allowing a client to change a user's password through Db2 commands is not recommended since Db2 may not enforce the expected password change rules. In addition, the password change requests going through Db2 may not be audited as expected.

Plain text passwords sent across an unsecure network are exposed and can be intercepted by a malicious user.

DATA_ENCRYPT is deprecated since it uses DES encryption algorithm which is cryptographically weak. Furthermore, enforcing SERVER_ENCRYPT ensures that the user ID and password are encrypted when sent from the client to the server.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "Run the following command to set the DB2AUTH registry variable to the appropriate values:

db2set DB2AUTH=<comma separated values>"
      reference   : "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|14.4,CSCv8|3.10,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|1M,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      cmd         : "su - @DB2_USER@ -c 'db2set -all'"
      expect      : "Manual Review Required"
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "5.11 DB2CHGPWD_EEE Registry Variable"
      info        : "The DB2CHGPWD_EEE registry variable specifies whether users are able to change passwords through Db2 in a partitioned database environment.

It is recommended to set this variable to NO.

Rationale:

If password management in the partitioned database environment is not centralized, then it could result in a situation where one partition has the updated password for a given user while the rest have the old password which is a security risk.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "Run the following command to set the DB2CHGPWD_EEE registry variable to NO:

db2set DB2CHGPWD_EEE=NO"
      reference   : "800-171|3.1.1,800-53|AC-2(1),800-53r5|AC-2(1),CN-L3|7.1.3.2(d),CSCv7|16.2,CSCv8|5.6,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(1),LEVEL|1M,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      cmd         : "su - @DB2_USER@ -c 'db2set -all'"
      expect      : "Manual Review Required"
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "6.1.1 Secure SYSADM Authority"
      info        : "The sysadm_group parameter defines the system administrator group (SYSADM) authority. It is recommended that the sysadm_group group contains authorized users only.

Rationale:

If an account that possesses this authority is compromised or used in a malicious manner, the confidentiality, integrity, and availability of data in the Db2 instance will be at increased risk.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "Define a valid group name for the SYSADM group.

Attach to the Db2 instance.

db2 => attach to <db2instance>

Run the following command:

db2 => update database manager configuration
       using sysadm_group <sys adm group name>

Default Value:

The default value for sysadm_group is NULL."
      reference   : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1M,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      cmd         : "su - @DB2_USER@ -c '@DB2_BIN_PATH@/db2 get database manager configuration' | /bin/egrep '\\(SYSADM_GROUP\\) =' | /bin/awk -F'= ' '{ print $2 }'"
      expect      : "Manual Review Required"
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "6.1.2 Secure SYSCTRL Authority"
      info        : "The sysctrl_group parameter defines the system administrator group with system control (SYSCTRL) authority. It is recommended that the sysctrl_group group contains authorized users only.

Rationale:

If an account that possesses this authority is compromised or used in a malicious manner, the confidentiality, integrity, and availability of data in the Db2 instance will be at increased risk.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "Define a valid group name for the SYSCTRL group.

Attach to the Db2 instance.

db2 => attach to <db2instance>

Run the following command:

db2 => update dbm cfg using sysctrl_group <sys control group name>

Default Value:

The default value for sysctrl_group is NULL."
      reference   : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1M,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      cmd         : "su - @DB2_USER@ -c '@DB2_BIN_PATH@/db2 get database manager configuration' | /bin/egrep '\\(SYSCTRL_GROUP\\) =' | /bin/awk -F'= ' '{ print $2 }'"
      expect      : "Manual Review Required"
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "6.1.3 Secure SYSMAINT Authority"
      info        : "The sysmaint_group parameter defines the system administrator group that possesses the system maintenance (SYSMAINT) authority. It is recommended that the sysmaint_group group contains authorized users only.

Rationale:

If an account that possesses this authority is compromised or used in a malicious manner, the confidentiality, integrity, and availability of data in the Db2 instance will be at increased risk.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "Define a valid group name for the SYSMAINT group.

Attach to the Db2 instance.

db2 => attach to <db2instance>

Run the following command:

db2 => update database manager configuration
       using sysmaint_group <sys maintenance group name>

Default Value:

The default value for sysmaint_group is NULL."
      reference   : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1M,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      cmd         : "su - @DB2_USER@ -c '@DB2_BIN_PATH@/db2 get database manager configuration' | /bin/egrep '\\(SYSMAINT_GROUP\\) =' | /bin/awk -F'= ' '{ print $2 }'"
      expect      : "Manual Review Required"
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "6.1.4 Secure SYSMON Authority"
      info        : "The sysmon_group parameter defines the operating system groups with system monitor (SYSMON) authority. It is recommended that the sysmon_group group contain authorized users only.

Rationale:

If an account that possesses this authority is compromised or used in a malicious manner, the confidentiality, integrity, and availability of data in the Db2 instance will be at increased risk.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "Define a valid group name for the SYSMON group.

Attach to the Db2 instance.

db2 => attach to <db2instance>

Run the following command:

db2 => update database manager configuration
       using sysmon_group <sys monitor group name>

Default Value:

The default value for sysmon_group is NULL."
      reference   : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1M,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      cmd         : "su - @DB2_USER@ -c '@DB2_BIN_PATH@/db2 get database manager configuration' | /bin/egrep '\\(SYSMON_GROUP\\) =' | /bin/awk -F'= ' '{ print $2 }'"
      expect      : "Manual Review Required"
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "7.1.1 Disable the Audit Buffer"
      info        : "Db2 can be configured to use an audit buffer where individual audit events are gathered into a large buffer to improve performance by reducing the number of writes to disk. It is recommended that the audit buffer be disabled by setting the size to 0.

Rationale:

Increasing the audit buffer size to greater than 0 will allocate space for the audit records generated by the audit facility. At scheduled intervals, or when the audit buffer is full, the db2auditd audit daemon empties the audit buffer to disk, writing the audit records asynchronously. As the events are held in memory for some time before being written to disk, if the database server happened to crash those event would be lost. Setting the buffer size to 0 ensure events are written directly to disk.

Impact:

Disabling the audit buffer may have noticeable impact on overall performance of the database server."
      solution    : "Perform the following to disable the audit buffer:

Attach to the Db2 instance

db2 => attach to <db2instance>

Run the following command:

db2 => update database manager configuration using audit_buf_sz 0"
      reference   : "800-53|AU-4,800-53r5|AU-4,CSCv7|6.4,CSCv8|8.3,CSF|PR.DS-4,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-4,LEVEL|1A,NESA|T3.3.1,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|13.2"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      cmd         : "su - @DB2_USER@ -c '@DB2_BIN_PATH@/db2 get database manager configuration' | /bin/egrep '\\(AUDIT_BUF_SZ\\)' | /bin/awk -F'= ' '{ print $2 }'"
      expect      : "^0$"
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "7.1.2 Disable Limited Audit of Applications (DB2_LIMIT_AUDIT_APPS)"
      info        : "The DB2_LIMIT_AUDIT_APPS registry variable contains a list of application names that should not be audited. It is recommended that this variable should not be set and all applications should be audited.

The DB2_LIMIT_AUDIT_APPS registry variable is not documented.

Rationale:

The application name not to be audited is determined by the client and not validated by the server. It is possible for a malicious user to change their application name to avoid being audited.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "Perform the following command to remove any applications from the list:

db2set DB2_LIMIT_AUDIT_APPS="
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-1,800-53|AU-2,800-53r5|AU-1,800-53r5|AU-2,CN-L3|8.1.4.3(a),CSCv8|8.1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-1,ITSG-33|AU-2,LEVEL|1M,NESA|M1.2.2,NESA|M5.5.1,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|SS30,NIAv2|VL8,PCI-DSSv3.2.1|10.8,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      cmd         : "su - @DB2_USER@ -c 'db2set -all' | grep DB2_LIMIT_AUDIT_APPS"
      expect      : "Manual Review Required"
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "7.1.4 Ensure Audit is Enabled Within the Instance"
      info        : "Auditing is crucial for securing and discovering issues within your databases.

Auditing can help trigger events for changes to data objects, table DML, and user access.

Rationale:

If instance auditing is not enabled, issues may go undiscovered, and compromises and other incidents may occur without being quickly detected. It may also not be possible to provide evidence of compliance with security laws, regulations, and other requirements."
      solution    : "Issue the following command to activate instance level auditing:

$ db2audit start"
      reference   : "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-2,800-53|AU-7,800-53|AU-12,800-53r5|AU-2,800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(c),CN-L3|8.1.4.3(a),CSCv7|6.2,CSCv8|8.2,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-2,ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1A,NESA|M1.2.2,NESA|M5.5.1,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|SS30,NIAv2|VL8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      cmd         : "su - @DB2_USER@ -c 'db2audit describe' | grep -i 'audit active'"
      expect      : "TRUE"
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "8.1.1 Configure a Server-side Key Store for TLS (SSL_SVR_KEYDB)"
      info        : "To enable TLS support in a Db2 server, it is necessary to configure a key store that will contain certificates to be used for secure TLS communication between a Db2 client and Db2 server.

Rationale:

On the server side, Db2 requires a key store to be configured. Otherwise, TLS support cannot be enabled.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "Perform the following to set SSL_SVR_KEYDB:

Attach to the Db2 instance.

db2 => attach to <db2instance>

Run the following command, where <path> is the fully qualified path to the keystore file:

db2 => update dbm cfg using SSL_SVR_KEYDB <path>

(Optional) To use the Microsoft certificate store on Windows, set SSL_SVR_KEYDB to GSK_MS_CERTIFICATE_STORE:

db2 => update dbm cfg using SSL_SVR_KEYDB GSK_MS_CERTIFICATE_STORE

If a keystore file is being used, ensure only the instance owner and administrators have access to the file. Do not grant world readable or world writable permissions on the keystore file."
      reference   : "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|14.4,CSCv8|3.10,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|1M,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      cmd         : "su - @DB2_USER@ -c '@DB2_BIN_PATH@/db2 get database manager configuration' | /bin/egrep '\\(SSL_SVR_KEYDB\\) =' | /bin/awk -F'= ' '{ print $2 }'"
      expect      : "Manual Review Required"
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "8.1.2 Configure a Server-side Stash File for TLS (SSL_SVR_STASH)"
      info        : "If a key store file is being used to configure TLS support in a Db2 instance, a stash file must also be configured to allow the Db2 server to be able to read certificates from the keystore. If the Microsoft certificate store is configured on a Windows platform, a stash file is not required.

Rationale:

Db2 does not have a method for an operator to enter a password for a server-side SSL key store, so a stash file must be used to provide the password to Db2. The Microsoft certificate store does not require a password, so a stash file is not required.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "Perform the following to set SSL_SVR_STASH:

Attach to the Db2 instance.

db2 => attach to <db2instance>

Run the following command, where <path> is the fully qualified path to the keystore file:

db2 => update dbm cfg using SSL_SVR_STASH <path>

If a stash file is being used, ensure only the instance owner and administrators have access to the file.

Do not grant world readable or world writable permissions on the stash file.
If the Microsoft certificate store is being used on Windows, it is not necessary to set SSL_SVR_STASH."
      reference   : "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|14.4,CSCv8|3.10,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|1M,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      cmd         : "su - @DB2_USER@ -c '@DB2_BIN_PATH@/db2 get database manager configuration' | /bin/egrep '\\(SSL_SVR_KEYDB\\) =' | /bin/awk -F'= ' '{ print $2 }'"
      expect      : "Manual Review Required"
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "8.1.3 Configure an Endpoint Certificate (SSL_SVR_LABEL)"
      info        : "The SSL_SVR_LABEL database manager configuration parameter controls which certificate Db2 will serve to clients. This certificate must have its associated certificate chain present in the server-side key store and must be associated with a private key.

Rationale:

It is highly recommended to set SSL_SVR_LABEL. Leaving this parameter blank and allowing Db2 to utilize a default certificate will only work with CMS(.KDB) format key stores, and the feature is deprecated.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "Perform the following to set SSL_SVR_LABEL:

Attach to the Db2 instance.

db2 => attach to <db2instance>

Run the following command, where <label> is the name of a certificate present in the server-side key store.

db2 => update dbm cfg using SSL_SVR_LABEL <label>

In Db2 11.5.4 and later, or Db2 11.1.4.5 and later with the DB2_DYNAMIC_SSL_LABEL registry variable set to ON, updating the value of SSL_SVR_LABEL while attached to the instance will cause the certificate served by Db2 to change while instance is running, with no effect on existing connections.

Prior releases of Db2 require an instance recycle (db2stop/db2start) for the change to take effect."
      reference   : "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-171|3.13.16,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53|SC-28,800-53|SC-28(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),800-53r5|SC-28,800-53r5|SC-28(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.7(b),CN-L3|8.1.4.8(a),CN-L3|8.1.4.8(b),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|16.4,CSCv7|16.5,CSCv8|3.10,CSCv8|3.11,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-1,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),HIPAA|164.312(e)(2)(ii),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),ITSG-33|SC-28,ITSG-33|SC-28a.,ITSG-33|SC-28(1),LEVEL|1M,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|3.4,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|3.3.2,PCI-DSSv4.0|3.5.1,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|28.1,TBA-FIISB|29.1"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      cmd         : "su - @DB2_USER@ -c '@DB2_BIN_PATH@/db2 get database manager configuration' | /bin/egrep '\\(SSL_SVR_LABEL\\) =' | /bin/awk -F'= ' '{ print $2 }'"
      expect      : "Manual Review Required"
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "8.1.4 Configure the Service Name for TLS (SSL_SVCENAME)"
      info        : "The SSL_SVCENAME database manager configuration parameter controls which port Db2 will listen on for TLS encrypted connections. SSL_SVCENAME can consist of one of the following:

A port number

Service name defined in /etc/services (UNIX/Linux) or %WINDIR%\system32\drivers\etc\services (windows)

Rationale:

Db2 must have a port number or service name defined to enable TLS communication. Db2 does not choose a default port number if SSL_SVCENAME is unset.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "Perform the following to set SSL_SVCENAME:

Attach to the Db2 instance.

db2 => attach to <db2instance>

Run the following command, where <service> is a port number or named service.

db2 => update dbm cfg using SSL_SVCENAME <service>

Db2 must be recycled (db2stop/db2start) for changes to SSL_SVCENAME to take effect."
      reference   : "800-171|3.13.1,800-171|3.13.2,800-53|PL-8,800-53|SA-8,800-53r5|PL-8,800-53r5|SA-8,CSCv7|9.2,CSCv8|16.10,CSF|ID.AM-3,CSF|PR.IP-2,GDPR|32.1.b,GDPR|32.1.d,HIPAA|164.306(a)(1),ITSG-33|SA-8,ITSG-33|SA-8a.,LEVEL|1M,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.6.5,NIAv2|SS3,NIAv2|VL2,QCSC-v1|4.2,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      cmd         : "su - @DB2_USER@ -c '@DB2_BIN_PATH@/db2 get database manager configuration' | /bin/egrep '\\(SSL_SVCENAME\\) =' | /bin/awk -F'= ' '{ print $2 }'"
      expect      : "Manual Review Required"
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "8.1.5 Configure a Secure TLS Version (SSL_VERSIONS)"
      info        : "The SSL_VERSIONS database manager configuration parameter controls which versions of the TLS protocol Db2 enables. In Db2 11.5 and earlier, TLS 1.0 and 1.1 are enabled by default if SSL_VERSIONS is not set.

Rationale:

TLS 1.0 and 1.1 are considered insecure and have been deprecated as of Db2 11.5. It is recommended to use TLS 1.2

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "Perform the following to set SSL_VERSIONS:

Attach to the Db2 instance.

db2 => attach to <db2instance>

Run the following command to enable TLS 1.2 within the Db2 server.

db2 => update dbm cfg using SSL_VERSIONS TLSV12

Db2 must be recycled (db2stop/db2start) for changes to SSL_VERSIONS to take effect."
      reference   : "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|14.4,CSCv8|3.10,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|1M,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      cmd         : "su - @DB2_USER@ -c '@DB2_BIN_PATH@/db2 get database manager configuration' | /bin/egrep '\\(SSL_VERSIONS\\) =' | /bin/awk -F'= ' '{ print $2 }'"
      expect      : "Manual Review Required"
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "8.1.6 Configure Secure TLS Cipher Suites (SSL_CIPHERSPECS)"
      info        : "The SSL_CIPHERSPECS database manager configuration parameter controls which cipher suites are enabled by Db2. If it is unset, Db2 will enable a default list of ciphers.

Rationale:

The default list of ciphers includes SHA1 ciphers, which are considered weak.

In addition, some cipher suites enabled by default do not support perfect forward secrecy. Depending on the security requirements of your organization, it may be necessary to restrict which ciphers are enabled by Db2.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "Perform the following to set SSL_CIPHERSPECS:

Attach to the Db2 instance.

db2 => attach to <db2instance>

Run the following command to enable a specific set of ciphers within
the Db2 server.

db2 => update dbm cfg using SSL_CIPHERSPECS <LIST>

Replace <LIST> with one or multiple of the following cipher suites. If multiple items are specified, separate them with a single comma and no spaces.

TLS_RSA_WITH_AES_256_GCM_SHA384

TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384

TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384

TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384

TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384

TLS_RSA_WITH_AES_256_CBC_SHA256

TLS_RSA_WITH_AES_128_GCM_SHA256

TLS_RSA_WITH_AES_128_CBC_SHA256

TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256

TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256

TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256

TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256"
      reference   : "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|14.4,CSCv8|3.10,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|1M,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      cmd         : "su - @DB2_USER@ -c '@DB2_BIN_PATH@/db2 get database manager configuration' | /bin/egrep '\\(SSL_CIPHERSPECS\\) =' | /bin/awk -F'= ' '{ print $2 }'"
      expect      : "Manual Review Required"
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "8.1.7 Unset the Service Name for Plaintext Communication (SVCENAME)"
      info        : "The SSVCENAME database manager configuration parameter controls which port Db2 will listen on for unencrypted connections.

Rationale:

To prevent unencrypted remote connections to the DB2 instance, it is good practice to unset the value of the SVCENAME DBM CFG parameter to prevent Db2 from starting the TCP listener, even if DB2COMM is set to TCPIP.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "Perform the following to unset SVCENAME:

Attach to the Db2 instance.

db2 => attach to <db2instance>

Run the following command, where <service> is a port number or named service.

db2 => update dbm cfg using SVCENAME NULL

Db2 must be recycled (db2stop/db2start) for changes to SSL_SVCENAME to take effect."
      reference   : "800-171|3.13.1,800-171|3.13.2,800-53|PL-8,800-53|SA-8,800-53r5|PL-8,800-53r5|SA-8,CSCv7|9.2,CSCv8|16.10,CSF|ID.AM-3,CSF|PR.IP-2,GDPR|32.1.b,GDPR|32.1.d,HIPAA|164.306(a)(1),ITSG-33|SA-8,ITSG-33|SA-8a.,LEVEL|1M,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.6.5,NIAv2|SS3,NIAv2|VL2,QCSC-v1|4.2,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      cmd         : "su - @DB2_USER@ -c '@DB2_BIN_PATH@/db2 get database manager configuration' | /bin/egrep '\\(SVCENAME\\) =' | /bin/awk -F'= ' '{ print $2 }'"
      expect      : "Manual Review Required"
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "8.1.8 Configure a Client-side Key Store for TLS (SSL_CLNT_KEYDB)"
      info        : "To enable TLS support in a Db2 client, it is possible to configure a key store in the database manager configuration that will contain root certificates to be used for secure TLS communication between a Db2 client and Db2 server.

Rationale:

On the client side, Db2 requires the root certificates for the server to be available. This can be achieved by configuring a client-side keystore. This parameter is optional and is not needed if clients use the SSLClientKeystoredb or SSLServerCertificate parameters in the db2cli.ini or db2dsdriver.cfg files, or in the connection string.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "Perform the following to set SSL_CLNT_KEYDB:

Run the following command, where <path> is the fully qualified path to the keystore file:

db2 => update dbm cfg using SSL_CLNT_KEYDB <path>

(Optional) To use the Microsoft certificate store on Windows, set SSL_CLNT_KEYDB to GSK_MS_CERTIFICATE_STORE:

db2 => update dbm cfg using SSL_CLNT_KEYDB GSK_MS_CERTIFICATE_STORE

Restart the client application. If the CLP is being used, run the following command to terminate the background process

db2 => terminate

If a client-side keystore file is being used, ensure that any users running client applications, and administrators have access to the file. Do not grant world readable or world writable permissions on the stash file."
      reference   : "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|14.4,CSCv8|3.10,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|1M,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      cmd         : "su - @DB2_USER@ -c '@DB2_BIN_PATH@/db2 get database manager configuration' | /bin/egrep '\\(SSL_CLNT_KEYDB\\) =' | /bin/awk -F'= ' '{ print $2 }'"
      expect      : "Manual Review Required"
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "8.1.9 Configure a Client-side Stash File for TLS (SSL_CLNT_STASH)"
      info        : "If a key store file is being used to configure client-side TLS support in a Db2 instance, a stash file should also be configured to allow the Db2 client to be able to read certificates from the keystore. If the Microsoft certificate store is configured on a Windows platform, a stash file is not required.

Rationale:

The database manager configuration does not provide a method for specifying a password for the client-side SSL key store. The Microsoft certificate store does not require a password, so a stash file is not required.

Impact:

Perform the following to determine if SSL_CLNT_STASH is required, and if it is set.

Attach to the Db2 instance.

db2 => attach to <db2instance>

Run the following command:

db2 => get database manager configuration

Locate the value of SSL_CLNT_KEYDB in the output:

SSL client keydb file (SSL_CLNT_KEYDB) =

If the value of SSL_CLNT_KEYDB is not GSK_MS_CERTIFICATE_STORE, locate the value of SSL_CLNT_STASH and ensure SSL_CLNT_STASH is not blank.

SSL client stash file (SSL_CLNT_STASH)=

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "Perform the following to set SSL_CLNT_STASH:

Run the following command, where is the fully qualified path to the keystore file:

db2 => update dbm cfg using SSL_CLNT_KEYDB <path>

Restart the client application.
If the CLP is being used, run the following command to terminate the background process

db2 => terminate

If a stash file is being used, ensure that any users running client applications, and administrators have access to the file. Do not grant world readable or world writable permissions on the stash file.

If the Microsoft certificate store is being used on Windows, it is not necessary to set SSL_CLNT_STASH."
      reference   : "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|14.4,CSCv8|3.10,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|1M,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      cmd         : "su - @DB2_USER@ -c '@DB2_BIN_PATH@/db2 get database manager configuration' | /bin/egrep '\\(SSL_CLNT_KEYDB\\) =' | /bin/awk -F'= ' '{ print $2 }'"
      expect      : "Manual Review Required"
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "8.1.10 Enable TLS Communication Between HADR Primary and Standby Instances (HADR_SSL_LABEL)"
      info        : "The HADR_SSL_LABEL database configuration parameter controls whether connections between HADR peers are encrypted, and which certificate is served to an HADR peer when establishing an HADR connection.

Rationale:

To protect database data and log records when they are sent from a primary database to a standby database, the HADR_SSL_LABEL database configuration should be set.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "Perform the following steps on both the primary and any standby databases to enable TLS encrypted HADR. A server side keystore and stash file (SSL_SVR_KEYDB/SSL_SVR_STASH) must be configured to enable TLS encrypted HADR communication:

Run the following command as the instance owner.

db2 => update db cfg for <database> using HADR_SSL_LABEL <label>

Replace <label> with the name of a certificate present in the server-side keystore (SSL_SVR_KEYDB).

If it is active, HADR must be recycled for changes to the HADR_SSL_LABEL registry variable to take effect."
      reference   : "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|14.4,CSCv8|3.10,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|1M,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      cmd         : "su - @DB2_USER@ -c '@DB2_BIN_PATH@/db2 get database manager configuration' | /bin/egrep '\\(HADR_SSL_LABEL\\) =' | /bin/awk -F'= ' '{ print $2 }'"
      expect      : "Manual Review Required"
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "8.1.11 Enable Remote TLS Connections to Db2 (DB2COMM)"
      info        : "The DB2COMM registry variable controls what types of remote connections Db2 will accept. It can be configured to enable plaintext communication, encrypted communication, or both.

Rationale:

For security, DB2COMM should be set to enable only TLS encrypted communications.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "Perform the following to set DB2COMM and enable TLS:

Run the following command as the instance owner.

db2set DB2COMM=SSL

Db2 must be recycled (db2stop/db2start) for changes to the DB2COMM registry variable to take effect."
      reference   : "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|14.4,CSCv8|3.10,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|1M,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
      cmd         : "su - @DB2_USER@ -c 'db2set -all DB2COMM'"
      expect      : "Manual Review Required"
      severity    : MEDIUM
    </custom_item>
  </then>

  <else>
    <report type:"WARNING">
      description : "CIS_IBM_DB2_11_v1.1.0_Level_1_OS_Linux.audit from CIS IBM DB2 11 v1.1.0 Benchmark"
      info        : "NOTE: Nessus has not identified that the chosen audit applies to the target device."
      see_also    : "https://workbench.cisecurity.org/benchmarks/10752"
    </report>
  </else>
</if>

</check_type>
