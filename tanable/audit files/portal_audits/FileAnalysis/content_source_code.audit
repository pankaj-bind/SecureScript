#TRUSTED 22370b2ba1e26f5c67b0d0845c04c3282db6e92513e474fe6c0dfc5c0fbe11e696a09a6c74cc2e197034ce003e3572ac35820c38f9b0aaf190bb2326b712327cf6386adad0fc11f1114793eefec4e0692efddd35157c8350b78b446739bc7fbbca3b5bb6b4cc592c4696501139a69f968f452e1768082f1f85a76f436fc002864122c96afe4effacc9149c51f0b621a812e3808264eb531a2097f097d1765e95feb0695775caf45340b03c3bc75f5b5dd0d67baccb55b41baa9388d7c3c5cf53f90fffaffe3bc54daa20d2d35034366459d5dda6fa0302508de4cb892a40cc39ebd3adb83d8d263b4cb7e7f9ae1f2d83dd1b03d02a7086fe0a9fa56ead25f310c767ae51efa7564e2d320a9823f7b62fc851221717728f6195863f025c9a6b89bcee88c1f6edcc597c3e02d8b8decb65fd54558910141197a737c0de60e386030ab102b61a2040e0ba0517be6902adf2ba85065de7a92d0dabd61efc187798edc7022ae406f2c7b9b19473dfdaa40111a43b7a1d451223ab261094cda91c7d8951bd4b7fe69751fdabba97e0e8dfa1a2dc5286b0b52c05bce9f04fbcd12fe71f1fdfc37dbcc04a5fc7b6342d62c6f5ab5b1732907ec93f67bb2236894ea2b094018cd180846119bf93179cb8985800641e0d8db41e8451188c3d65437f965e4818bd8983a8a30e5b900f185b50cb54c2c25b4ec919353082d43c7f4feec7782f
#TRUST-RSA-SHA256 2f47d67d8f6f0c0d3c2ce78a3b9f945028dc7362f56c4c9d2b9ff12a7bbcd5776152469d881ef8cb5a4efee5bb4955cba5f13883efc8ac3147395dc1d0ff9fae9230e62920ddfd0951a6348df23f783e4c9ac7c3401148d18c8d5ce4659cd9f5171adc9fadf5dffcc38c865185fb744ba908d2fa0256be736856ba3ab8a3643d95b1de18f14bf140a4583f053cdcf8e938d532a548bc3cba5261d1dc042ee9cab0ff6bebfc02ca0f582c6aa29dc5a87bf3fc1b464ed42723fd19ac15bf9dae65a1ecb561d21091dfcb04221cdbfa760eb1bde6fc696a65bf9b33f81b011fa51b1b2becec1963a5a50d2b79f4ed82bd48f746a5ffcccd9a644b403f828b9a0058074c58c88bbe3990a5fd528fc9375a3903618e8187fd4f283a1bcabdc376f21f0c8228bbd8fc3ae32ed9ddc5d5b69dec5ec20bb3f68c2c8040bf545e1f564f29f2db2958676db4018d00acfe1c212b7bac1c67711dd07110419e6fd275e66ee7a1bb0c1f49a886de3c052290a5e0dbbce31140635e2966186ac843f14babd025f26c1210c086d892fd23f3995f095b163789c8588a708d0cfea12ecbc1717d3edb9011a9818699ca7408c5ac6702c6e59c1521c0dff25a28cebc5f426ff2951a1a1610c41254f56b7a919a6e6e7ae13168b7b10a8f943a04e2d3ce9d3ec24322b5ee433210c309aa930756d51ac4d0c1859352251e4e1642cec5df82eb03f0a5
#
# This script is Copyright (C) 2004-2025 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
# $Revision: 1.11 $
# $Date: 2025/01/06 $
#
# This .audit file looks for source code.
#
# The first rule searches C, C++ and header files that have
# certain words in them such as your company's copyright, a
# project name or even a developer's name. The second rule
# is an example of how to search for a certain specific line
# of source code.
#
# Note that neither of these rules makes use of a regex and
# rely totally on basic pattern matching. Also note that since
# the second example is searching a majority of the data, it
# has a max_size value of 1M.
#
# This file should be customized for your local environment
# with keywords that identify your source code.
#
#<ui_metadata>
#<display_name>TNS File Analysis - Source Code Leakage</display_name>
#<spec>
#  <type>TNS</type>
#  <name>File Analysis - Source Code Leakage</name>
#  <version>1.0.0</version>
#</spec>
#<labels>filecontent,content,source,code,agent</labels>
#</ui_metadata>

<check_type:"FileContent">

<item>
  type           : FILE_CONTENT_CHECK
  description    : "DLP - Determine if a file is company source code by metadata"
  file_extension : "h" | "c" | "cpp" | "cs" | "sql" | "xlst" | "inc"
  expect         : "Copyright YourCompany" | "Project X" | "By John Doe"
  max_size       : "500K"
</item>

<item>
  type           : FILE_CONTENT_CHECK
  description    : "DLP - Determine if a file is company source code by code"
  file_extension : "c" | "cpp"
  expect         : "data->temperature = (u_short *) (fdb + 44);" | "cName = CompanyDBLookup(iUserID);"
  max_size       : "1M"
</item>

</check_type>
