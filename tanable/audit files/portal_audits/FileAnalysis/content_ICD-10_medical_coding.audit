#TRUSTED 4f10ee8b622793c8d4e4a48d4cb4d88280322393ac478485e8b8227550264a17edf0fd79d0107dd6228ff7cf7cd29efbdb8a361a1ab5d953baca3a6c83ad5e47a038fc1e15b9285a57e38a83973e375e7e80d60f949c3b51314e9b95e9056879c9a175f8388c828430dac4f852c46ed613bdca31ee7d82137792e28232a7c0f7410c7740541413673301850bf9bfc1fd20adbb4194be8720ac924e441c84a4f95c7728e4b538a589438188179790dde217b00b9a8c96e5e44cd4af80ad9dd1d0704c229aa328efc8eadf4272108c08665f4d8cbfcb5c0a45d7d4f9f4afb6cf7b47cbc4127c4032248d70ef08e874e4f6c9f508d8b0ef04c2bd65356412f71ea046aa9b02c3468219393375c0eb51bd6f4b6381dd03f1fdf8b3d089153aa719419a2e087a4789a0990ceea288580773cf9fa8c87a7bad9952741f5b37873aa411062e2e94d72009cf67d9523c212f2e954d3b2cf3c37ae7f24817d8d2b332c26e9fbf63c5683bea7f4224a6e33b72dd555cf033afaa07a6549371b69c2a931eca56a4d34d9065cf4fac0f96a833d39d1a3b1ddef8fd4b989bc337a1d18479e319646a695c9254abe7206af78b06053c73249f24caaf7050fc8077987c0c6a0d57fcb2457670661b491285d0b4e27c6f878bb7c2cff030d2c482c535bad7b0525df0d2b7aa825a17ee1499bb5d8fb34c5afdddddfea1ba2829e31acfde38f10295
#TRUST-RSA-SHA256 28fe07e806f01a50dcb81ff89c13b3cc12e54e0bb27de0dcb66198363be056491162717c4f65cd998e62dfd350d0edd7f897e9a870339983a4b188dc99f84aba033d4f9c2ac85b80cca5dc334adf35e4b24c6f4c686fc4aa02f142b6548eb6b576267b9e7bc87cdd460100364935cb450e05482d4f08f5a8d2b3046c28a8cbe9a912bdbb9ac07dcde77a844efa8d22d59419d0d680fe97763bfe8a1de680c6214c5edb3f6a49eb9f895c264c35a0cd79a0505f653b30e460506176f6b2bc2c52bb44040a83605d88ee18ca75439813da772dab3b7de8fe545315fcd6945386953cd035b3e41631a88e1022726250332f0105320a0b1ee7f5e970c45393fbc3691f14a26bfec04259704cd855fea51c6c2e6a2579078ad19190c4746d8be7d6196d73717d7aff2da0b9bcce4717b96ef49ea948603ddc2828b3f4d9baa7ed196f71f94b6afb1fe0f3beb413d8edc8a34ae6fd6f0cb75f34cffcbba658294e04bcb3e1c914c9953617c068d4310b2fe31fa05a5cc60f25de9e569719be7d837ec9c7a21d0140e2c69a475eb49197c9f501b9ae76bf6b43200abd7b00e0c5484c1f16f1cf01c16bd1b75a4d3c90546c2c8efe15c99fe62ba43a1875c1dea783f10294d883ee41f859211bec4e21dc4429badac183c72a383d7c649d01fbf811cfa009d2fdd5bf944bb25a624f201a769be5984cf6bce1382f2a50f3778784e453a2
#
# This script is Copyright (C) 2004-2025 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
# $Revision: 1.5 $
# $Date: 2025/01/06 $
#
# Description    : This .audit file searches the first 50k bytes of all text, Word, Excel
#                  and PDF files for evidence of an IDC-10 Medical Code.
#
# NOTE           : References:
#                   - https://www.cms.gov/Medicare/Coding/ICD10/2016-ICD-10-CM-and-GEMs.html
#                   - https://www.cms.gov/Medicare/Coding/ICD10/2016-ICD-10-PCS-and-GEMs.html
#
#<ui_metadata>
#<display_name>TNS File Analysis - ICD-10 Medical Coding</display_name>
#<spec>
#  <type>TNS</type>
#  <name>File Analysis - ICD-10 Medical Coding</name>
#  <version>1.0.0</version>
#</spec>
#<labels>filecontent,content,icd10,medical,coding,agent</labels>
#</ui_metadata>

<check_type:"FileContent">

<item>
  type           : FILE_CONTENT_CHECK
  description    : "File contains a ICD-10-CM Diagnostic Codes"
  file_extension : "txt" | "doc" | "xls" | "pdf"
  regex          : "([^0-9A-Z\.]|^)([A-TV-Z][0-9][0-9AB]\.([0-9A-CZ]|[0-9A-KXZ][0-9A]|[0-9A-CX][0-9X-Z][0-9]|[0-9ABXZ][0-9X][0-9X][0-59A-HJKMNP-S]))([^0-9A-Z\.]|$)"
#only_show      : "4"
#expect         : "ICD-10" || "ICD10"
#include_paths  : "/home"
  max_size       : "50K"
</item>

<item>
  type           : FILE_CONTENT_CHECK
  description    : "File contains a ICD-10-PCS Procedural Codes"
  file_extension : "txt" | "doc" | "xls" | "pdf"
  regex          : "([^0-9A-Z]|^)([0-68B-DF-H][02-9A-HL-NP-Z][0-9A-HJMNP-Y][0-9A-HJ-NP-Z][0-8CDFHJKX-Z][0-9B-HJ-NQS-WYZ][0-9A-DF-HJ-MQTWXZ])([^0-9A-Z]|$)"
#only_show      : "4"
#expect         : "ICD-10" || "ICD10"
#include_paths  : "/home"
  max_size       : "50K"
</item>

</check_type>
