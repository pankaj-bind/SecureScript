#TRUSTED 9bbb461e8b92865bf9b5ad8e3c6bcbfb6e199d3f4a378a0612a89d4f08cb22dc19d76981e705c3bb29db15a6d02ab3644680e7717c4dd0ab2ef02b3b7588257909ccd8a3d9264222f5d6bd27d039afb54c352cf7f045159b46afcf775fc569c257c537d975a4588b0d932eeede54a5a7d8e2b97d5989f2c87a87a7eda191c9198471a1e560931634b783f3500a85add50a11c50f4251aad7042d1a3a3338099979ed73cb83b25a41cafbff2206a9d621fbcd252f7d7cd19ab52ebad95dce62a8270e0aadedf7afadc1a1dbd4c7b71e7db894b5b5a0dc6cf257affd42764b5e379df90d2f79b8f57ce8573be5de6699a4e75289c8932a5dd5854e0ee7a9563079d2a428acd750286be4b897f8e3678d49b9cdbe07afae2938d5c218b8f2e899b5c288df1b96bffa805500a1fd8e229921eed07e830edf0bda6d16f340d6fe1b18e87ceda18355c6634f15825699ee913da09d4d741f37f726a8f74d3ed7b117eef23d6334735c45bf9f60716b60734fc3efb915bd5df9046f6afa5d96b1a08bc205f1d08e0a008a141408962d3ec7d347a3c2226f7db79b1a3aa6ad77f29272d596ada6408ad468362463af289912e277cb907c51fbf93124589af7936e7306a3c3647e9d53c19b3f7dd4385c7e37f5c7bbacd98568d43cf2fbd6a5d909aa39d15e97c542dd23b521e00f752265ac3ce38e88b2958f59208e87cc3f8be60aa988
#TRUST-RSA-SHA256 84cb3c11616c6370971610d56cd5f6a9e029c133c8d83258fb26c2fc1b1e5d748ff582edca20fe206258fe80f4c4e41054a9682b50a15bdf72b819132cb18b1b6f5076c6de2a521b1f9928ee2bd04b326201f4c6355900d74800289565e4ee5ef32f6c1fbc7e7379ddfc9d09b00d58897da095af2cf443a30da890e1494651965d5d8d1378d626035991f3086ee3f8bfb1b4bbf23fde4e2bfd500b55cb235026d0c7e09336f3e81aaf746f3211bd7b6642cd55e6c769ed13ba558a1a728fb17857e459eda8352059214bd902addf14884c3577064ebe09af73c068dd1fb8bf3fb0178ab28ada3919102a3326fe3c8109117eaddf1a555f140459a905a9736d77fc65c119327f4ef32c93b574e0e18e25d4b8fea904aa6cf70dbdf32201affd484112244064dfba56c33d108a61c31b6c4f3d600321d0e10907732890d4e34b989ce56e08b065b7daaa5a27942ec7dca948f1b54bd2623cc16b58e1fd6488c53c0a7bf0245614b234a820538ba35b252a683d13e3e2d43c70681b6980b278ab792ce55e90e0d4f3c70b7a75376b7ce22c943a041f6470765e284d1c84dcfd805bc8ed754e1844a2719e1b998ba2ba160f4341fbce84bc437fb121d73e3f4276f6fef8c1bf6a8025050f4e1755289f34af359f51b5fc771d38d81c7b401be9dbdb2592e3636f17e795a510f093eb5f0f931b1b8e5537dbba1104c14881cbf87d10
#
# This script is Copyright (C) 2004-2024 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
# $Revision: 1.1 $
# $Date: 2024/06/17 $
#
# description : This .audit is designed against the CIS Cisco IOS XR 7.x v1.0.0
#
#<ui_metadata>
#<display_name>CIS Cisco IOS XR 7.x v1.0.0 L2</display_name>
#<spec>
#  <type>CIS</type>
#  <name>Cisco IOS XR 7.x</name>
#  <profile>L2</profile>
#  <version>1.0.0</version>
#  <link>https://workbench.cisecurity.org/benchmarks/10473</link>
#</spec>
#<labels>cis,cisco_ios_xr_7.x</labels>
#<benchmark_refs>CSCv6,CSCv7,CSCv8,LEVEL</benchmark_refs>
#<variables>
#  <variable>
#    <name>AAA_SERVER_1</name>
#    <default>192.168.0.253</default>
#    <description>1.1.1.x primary authentication server address</description>
#    <info>The address for the TACACS+ or RADIUS Server</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>AAA_SERVER_2</name>
#    <default>192.168.0.254</default>
#    <description>1.1.1.x secondary authentication server address</description>
#    <info>The address for the TACACS+ or RADIUS Server</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>AAA_GROUP</name>
#    <default>CIS-Auth-Group</default>
#    <description>1.1.x auth group name</description>
#    <info>The name of the AAA auth group</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>LINE_TEMPLATE</name>
#    <default>default</default>
#    <description>1.1.x line template</description>
#    <info>The line-template to be referenced for vty-pool AAA</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>AUTHORIZATION_LIST</name>
#    <default>default</default>
#    <description>1.1.3.1 authorization list</description>
#    <info>The authorization list to be referenced for AAA</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>TASKGROUP</name>
#    <default>CISTASK</default>
#    <description>1.1.5 name of taskgroup</description>
#    <info>info</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>USERGROUP</name>
#    <default>CISUSER</default>
#    <description>1.1.5 name of usergroup</description>
#    <info>info</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>PASSWD_MIN_LEN</name>
#    <default>18</default>
#    <description>1.8.3 minimum password length</description>
#    <info>Value of min-length</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>PASSWD_MAX_LEN</name>
#    <default>25</default>
#    <description>1.8.3 maximum password length</description>
#    <info>Value of max-length</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>PASSWD_LIFETIME</name>
#    <default>months 3</default>
#    <description>1.8.3 password lifetime</description>
#    <info>Value of lifetime</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>PASSWD_MIN_CHANGE</name>
#    <default>5</default>
#    <description>1.8.3 minimum number of characters to change</description>
#    <info>Value of min-char-change</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>PASSWD_LOCKOUT_TIME</name>
#    <default>days 1</default>
#    <description>1.8.3 account lockout time</description>
#    <info>Value of lockout-time</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>PASSWD_MAX_ATTEMPTS</name>
#    <default>3</default>
#    <description>1.8.3 Maximum number of attempts</description>
#    <info>Value of authen-max-attempts</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>KEY_CHAIN</name>
#    <default>CIS-testing-keychain</default>
#    <description>2.1.x routing protocols authentication key chain</description>
#    <info>The name of the key chain used for authenticating routing protocols.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>NTP_SERVER_1</name>
#    <default>192.168.1.1</default>
#    <description>2.2.x primary NTP server</description>
#    <info>The IP address for the primary NTP server used by the target device.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>NTP_SERVER_2</name>
#    <default>192.168.1.2</default>
#    <description>2.2.x secondary NTP server</description>
#    <info>The IP address for the secondary NTP server used by the target device.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>NTP_SERVER_3</name>
#    <default>192.168.1.3</default>
#    <description>2.2.x tertiary NTP server</description>
#    <info>The IP address for the tertiary NTP server used by the target device.</info>
#    <value_type>STRING</value_type>
#  </variable>
#</variables>
#</ui_metadata>

<check_type:"Cisco">

<if>
  <condition type:"AND">
    <item>
      type        : CONFIG_CHECK
      description : "check if TACACS is defined"
      item        : "tacacs-server"
    </item>
  </condition>

  <then>
    <if>
      <condition auto:"FAILED" type:"AND">
        <item>
          type        : CONFIG_CHECK
          description : "check for correct TACACS+ server 1/2"
          item        : "tacacs-server host @AAA_SERVER_1@"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "check for correct TACACS+ server 2/2"
          item        : "tacacs-server host @AAA_SERVER_2@"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "check for defined TACACS+ group"
          regex       : "aaa group server tacacs\+ @AAA_GROUP@"
          item        : "aaa group server tacacs\+"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "check for server 1 in group"
          context     : "aaa group server tacacs\+ @AAA_GROUP@"
          item        : "server @AAA_SERVER_1@"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "check for server 2 in group"
          context     : "aaa group server tacacs\+ @AAA_GROUP@"
          item        : "server @AAA_SERVER_2@"
        </item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "1.1.1.1 TACACS+"
          info        : "Cisco IOS XR devices can use the TACACS+ protocol to communicate with a central AAA server. Using a central authentication store ensures that all administrative actions are tied to named users, making the tracking of changes much easier. It also makes tracking compromised accounts and malicious activities much easier.

Central authentication is key as it minimizes the effort in managing named user accounts. Keeping local admin accounts opens the door to all the issues inherent in shared accounts, namely:

 - Errors in implementation being done by generic admin accounts, which can then be denied by all.
 - Shared credentials staying unchanged when administrative staff leave the organization or change roles.
 - Giving malicious actors the ability to recover shared credentials from saved device backups"
          solution    : "For complete instructions how to configure AAA please refer to the

configuration guide

. Below you can find some minimum config snippets to implement a radius or tacacs+ server group.

IOSXR(config)#tacacs-server host {tacacs_ip_address} port 49
IOSXR(config-tacacs-host)#key {tacacs_key}

IOSXR(config)#aaa group server tacacs+ {tacacs_group_name}
IOSXR(config-sg-tacacs)#server {tacacs_ip_address}

Impact:

Implementing TACACS+ (or any central authentication solution) ensures that only named users are allowed to gain an administrative session to the device. This allows:

 - Tracking of all changes to named users
 - Simplification of reconciling changes to a change management process
 - Off-loading password change cycles and password complexity requirements to that central authentication store
 - Simplification of removing admin access as administrators leave the organization or change their roles in the organization"
          reference   : "800-171|3.1.1,800-53|AC-2(1),800-53r5|AC-2(1),CN-L3|7.1.3.2(d),CSCv7|16.2,CSCv8|12.5,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(1),LEVEL|2A,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2"
          see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
          show_output : YES
        </report>
      </then>
    </if>
  </then>

  <else>
    <report type:"PASSED">
      description : "1.1.1.1 TACACS+"
      info        : "Cisco IOS XR devices can use the TACACS+ protocol to communicate with a central AAA server. Using a central authentication store ensures that all administrative actions are tied to named users, making the tracking of changes much easier. It also makes tracking compromised accounts and malicious activities much easier.

Central authentication is key as it minimizes the effort in managing named user accounts. Keeping local admin accounts opens the door to all the issues inherent in shared accounts, namely:

 - Errors in implementation being done by generic admin accounts, which can then be denied by all.
 - Shared credentials staying unchanged when administrative staff leave the organization or change roles.
 - Giving malicious actors the ability to recover shared credentials from saved device backups"
      solution    : "For complete instructions how to configure AAA please refer to the

configuration guide

. Below you can find some minimum config snippets to implement a radius or tacacs+ server group.

IOSXR(config)#tacacs-server host {tacacs_ip_address} port 49
IOSXR(config-tacacs-host)#key {tacacs_key}

IOSXR(config)#aaa group server tacacs+ {tacacs_group_name}
IOSXR(config-sg-tacacs)#server {tacacs_ip_address}

Impact:

Implementing TACACS+ (or any central authentication solution) ensures that only named users are allowed to gain an administrative session to the device. This allows:

 - Tracking of all changes to named users
 - Simplification of reconciling changes to a change management process
 - Off-loading password change cycles and password complexity requirements to that central authentication store
 - Simplification of removing admin access as administrators leave the organization or change their roles in the organization"
      reference   : "800-171|3.1.1,800-53|AC-2(1),800-53r5|AC-2(1),CN-L3|7.1.3.2(d),CSCv7|16.2,CSCv8|12.5,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(1),LEVEL|2A,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
    </report>
  </else>
</if>

<if>
  <condition type:"AND">
    <item>
      type        : CONFIG_CHECK
      description : "check if radius is defined"
      item        : "radius-server"
    </item>
  </condition>

  <then>
    <if>
      <condition auto:"FAILED" type:"AND">
        <item>
          type        : CONFIG_CHECK
          description : "check for correct radius server 1/2"
          item        : "radius-server host @AAA_SERVER_1@"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "check for correct radius server 2/2"
          item        : "radius-server host @AAA_SERVER_2@"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "check for defined radius group"
          regex       : "aaa group server radius @AAA_GROUP@"
          item        : "aaa group server radius"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "check for server 1 in group"
          context     : "aaa group server radius @AAA_GROUP@"
          item        : "server @AAA_SERVER_1@"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "check for server 2 in group"
          context     : "aaa group server radius @AAA_GROUP@"
          item        : "server @AAA_SERVER_2@"
        </item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "1.1.1.2 RADIUS"
          info        : "Cisco IOS XR devices can use the RADIUS protocol to communicate with a central AAA server. Using a central authentication store ensures that all administrative actions are tied to named users, making the tracking of changes much easier. It also makes tracking compromised accounts and malicious activities much easier.

Central authentication is key as it minimizes the effort in managing named user accounts. Keeping local admin accounts opens the door to all the issues inherent in shared accounts, namely:

 - Errors in implementation being done by generic admin accounts, which can then be denied by all.
 - Shared credentials staying unchanged when administrative staff leave the organization or change roles.
 - Giving malicious actors the ability to recover shared credentials from saved device backups"
          solution    : "For complete instructions how to configure AAA please refer to the

configuration guide

. Below you can find some minimum config snippets to implement a radius or tacacs+ server group.

radius-server host {radius_ip_address}
 key {radius_key}

aaa group server radius {radius_group_name}
 server radius_ip_address}

Impact:

Implementing RADIUS (or any central authentication solution) ensures that only named users are allowed to gain an administrative session to the device. This allows:

 - Tracking of all changes to named users
 - Simplification of reconciling changes to a change management process
 - Off-loading password change cycles and password complexity requirements to that central authentication store
 - Simplification of removing admin access as administrators leave the organization or change their roles in the organization"
          reference   : "800-171|3.1.1,800-53|AC-2(1),800-53r5|AC-2(1),CN-L3|7.1.3.2(d),CSCv7|16.2,CSCv8|12.5,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(1),LEVEL|2A,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2"
          see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
          show_output : YES
        </report>
      </then>
    </if>
  </then>

  <else>
    <report type:"PASSED">
      description : "1.1.1.2 RADIUS"
      info        : "Cisco IOS XR devices can use the RADIUS protocol to communicate with a central AAA server. Using a central authentication store ensures that all administrative actions are tied to named users, making the tracking of changes much easier. It also makes tracking compromised accounts and malicious activities much easier.

Central authentication is key as it minimizes the effort in managing named user accounts. Keeping local admin accounts opens the door to all the issues inherent in shared accounts, namely:

 - Errors in implementation being done by generic admin accounts, which can then be denied by all.
 - Shared credentials staying unchanged when administrative staff leave the organization or change roles.
 - Giving malicious actors the ability to recover shared credentials from saved device backups"
      solution    : "For complete instructions how to configure AAA please refer to the

configuration guide

. Below you can find some minimum config snippets to implement a radius or tacacs+ server group.

radius-server host {radius_ip_address}
 key {radius_key}

aaa group server radius {radius_group_name}
 server radius_ip_address}

Impact:

Implementing RADIUS (or any central authentication solution) ensures that only named users are allowed to gain an administrative session to the device. This allows:

 - Tracking of all changes to named users
 - Simplification of reconciling changes to a change management process
 - Off-loading password change cycles and password complexity requirements to that central authentication store
 - Simplification of removing admin access as administrators leave the organization or change their roles in the organization"
      reference   : "800-171|3.1.1,800-53|AC-2(1),800-53r5|AC-2(1),CN-L3|7.1.3.2(d),CSCv7|16.2,CSCv8|12.5,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(1),LEVEL|2A,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
    </report>
  </else>
</if>

<if>
  <condition auto:"FAILED" type:"AND">
    <item>
      type        : CONFIG_CHECK
      description : "check for vty-pool"
      item        : "vty-pool default .+ line-template @LINE_TEMPLATE@"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "check for line console authorization"
      cmd         : "show running-config formal | include authorization"
      item        : "line console authorization commands @LINE_TEMPLATE@"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "check for line default authorization"
      cmd         : "show running-config formal | include authorization"
      item        : "line default authorization commands @LINE_TEMPLATE@"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "check for aaa auth commands"
      item        : "aaa authorization commands @AUTHORIZATION_LIST@ group @AAA_GROUP@"
    </item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "1.1.3.1 Configure Authorization"
      info        : "Command authorization allows restricting specific users to specific command sets that they can use on the device. Command authorization is a complex endeavor and is very rarely implemented. Usually, the TACACS+ protocol is used with a central AAA server.

Command authorization allows the implementation of fine-grained role-based access control concepts."
      solution    : "Currently CIS makes no recommendations how to implement command authorization. Roles and access-privileges should be defined in collaboration with your operations and security teams.

Impact:

Prevent users from issuing certain commands."
      reference   : "800-171|3.1.1,800-53|AC-3,800-53r5|AC-3,CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,LEVEL|2M,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|31.1"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
      show_output : YES
    </report>
  </then>
</if>

<if>
  <condition auto:"FAILED" type:"AND">
    <item>
      type        : CONFIG_CHECK
      description : "check for taskgroup"
      item        : "taskgroup @TASKGROUP@"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "check for usergroup"
      item        : "usergroup @USERGROUP@"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "check that usergroups are in use"
      context     : "username"
      item        : "group"
    </item>
  </condition>

  <then>
    <report type:"WARNING">
      description : "1.1.5 Local users, groups and tasks"
      info        : "To provide controlled access to the XR and System Admin configurations on the router, user profiles are created with assigned privileges. The privileges are specified using command rules and data rules. The authentication, authorization, and accounting (aaa) commands are used for the creation of users, groups, command rules, and data rules. The aaa commands are also used for changing the disaster-recovery password.

IOS-XR has a very strong embedded mechanism to do user authentication and authorization. While XR does not have the concept of privilege-levels as what IOS had, the embedded user task group management is extremely strong allow for the creation of different task groups.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "The commands below will enable authorizarion for a user.

IOSXR(config)#taskgroup {task_group} task read {task}
IOSXR(config)#usergroup {user_group} taskgroup {task_group}
IOSXR(config)#username {username}
IOSXR(config-un)#secret {password}
IOSXR(config-un)#group {user_group}

Impact:

Default task-groups

The following task-groups are predefined in IOS-XR

root-system: Root system users

root-lr: Root logical router users

netadmin: Network administrators

sysadmin: System administrators

operator: Operators performing day-to-day activities

cisco-support: highest level of privilege allowing lowest level access"
      reference   : "800-171|3.1.1,800-53|AC-2(1),800-53r5|AC-2(1),CN-L3|7.1.3.2(d),CSCv7|16.2,CSCv8|12.5,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(1),LEVEL|2A,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
      show_output : YES
    </report>
  </then>
</if>

<if>
  <condition type:"AND">
    <item>
      type        : CONFIG_CHECK
      description : "Check to see if any snmp v3 groups are enabled"
      item        : "snmp-server group .* v3"
    </item>
  </condition>

  <then>
    <item>
      type        : CONFIG_CHECK
      description : "1.5.7 Set 'priv' for each 'snmp-server group' using SNMPv3"
      info        : "Specifies authentication of a packet with encryption when using SNMPv3

SNMPv3 provides much improved security over previous versions by offering options for Authentication and Encryption of messages. When configuring a user for SNMPv3 you have the option of using a range of encryption schemes, or no encryption at all, to protect messages in transit. AES128 is the minimum strength encryption method that should be deployed."
      solution    : "For each SNMPv3 group created on your router add privacy options by issuing the following command...

IOSXR(config)#snmp-server group {snmp_group_name} v3 priv IPv4 {snmp_access-list}

Impact:

Organizations using SNMP can significantly reduce the risks of unauthorized access by using the 'snmp-server group v3 priv' setting to encrypt messages in transit."
      reference   : "800-171|3.5.3,800-53|IA-2(1),800-53r5|IA-2(1),CN-L3|7.1.2.7(b),CSCv7|4.5,CSCv8|6.5,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2(1),LEVEL|2A,NESA|T5.4.2,NIAv2|AM36,NIAv2|VL3c,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|1.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
      regex       : "snmp-server group .* v3 priv .*?"
      item        : "snmp-server group"
    </item>
  </then>

  <else>
    <report type:"PASSED">
      description : "1.5.7 Set 'priv' for each 'snmp-server group' using SNMPv3"
      info        : "Specifies authentication of a packet with encryption when using SNMPv3

SNMPv3 provides much improved security over previous versions by offering options for Authentication and Encryption of messages. When configuring a user for SNMPv3 you have the option of using a range of encryption schemes, or no encryption at all, to protect messages in transit. AES128 is the minimum strength encryption method that should be deployed."
      solution    : "For each SNMPv3 group created on your router add privacy options by issuing the following command...

IOSXR(config)#snmp-server group {snmp_group_name} v3 priv IPv4 {snmp_access-list}

Impact:

Organizations using SNMP can significantly reduce the risks of unauthorized access by using the 'snmp-server group v3 priv' setting to encrypt messages in transit."
      reference   : "800-171|3.5.3,800-53|IA-2(1),800-53r5|IA-2(1),CN-L3|7.1.2.7(b),CSCv7|4.5,CSCv8|6.5,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2(1),LEVEL|2A,NESA|T5.4.2,NIAv2|AM36,NIAv2|VL3c,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|1.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
    </report>
  </else>
</if>

<if>
  <condition type:"AND">
    <item>
      type        : CONFIG_CHECK
      description : "Check to see if any snmp v3 groups are enabled"
      item        : "snmp-server group .* v3"
    </item>
  </condition>

  <then>
    <item>
      type        : CONFIG_CHECK
      description : "1.5.8 Require 'aes 128' as minimum for 'snmp-server user' when using SNMPv3"
      info        : "Specify the use of a minimum of 128-bit AES algorithm for encryption when using SNMPv3.

SNMPv3 provides much improved security over previous versions by offering options for Authentication and Encryption of messages. When configuring a user for SNMPv3 you have the option of using a range of encryption schemes, or no encryption at all, to protect messages in transit. AES128 is the minimum strength encryption method that should be deployed."
      solution    : "For each SNMPv3 user created on your router add privacy options by issuing the following command.

hostname(config)#snmp-server user {snmp_user_name} {snmp_group_name} v3 auth sha {snmp_auth_password} priv aes 128 {snmp_priv_password} ipv4 {snmp_access-list}

Impact:

Organizations using SNMP can significantly reduce the risks of unauthorized access by using the 'snmp-server user' setting with appropriate authentication and privacy protocols to encrypt messages in transit."
      reference   : "800-171|3.5.3,800-53|IA-2(1),800-53r5|IA-2(1),CN-L3|7.1.2.7(b),CSCv7|4.5,CSCv8|6.5,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2(1),LEVEL|2A,NESA|T5.4.2,NIAv2|AM36,NIAv2|VL3c,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|1.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
      regex       : "snmp-server user .* priv aes 128 .*?"
      item        : "snmp-server user"
    </item>
  </then>

  <else>
    <report type:"PASSED">
      description : "1.5.8 Require 'aes 128' as minimum for 'snmp-server user' when using SNMPv3"
      info        : "Specify the use of a minimum of 128-bit AES algorithm for encryption when using SNMPv3.

SNMPv3 provides much improved security over previous versions by offering options for Authentication and Encryption of messages. When configuring a user for SNMPv3 you have the option of using a range of encryption schemes, or no encryption at all, to protect messages in transit. AES128 is the minimum strength encryption method that should be deployed."
      solution    : "For each SNMPv3 user created on your router add privacy options by issuing the following command.

hostname(config)#snmp-server user {snmp_user_name} {snmp_group_name} v3 auth sha {snmp_auth_password} priv aes 128 {snmp_priv_password} ipv4 {snmp_access-list}

Impact:

Organizations using SNMP can significantly reduce the risks of unauthorized access by using the 'snmp-server user' setting with appropriate authentication and privacy protocols to encrypt messages in transit."
      reference   : "800-171|3.5.3,800-53|IA-2(1),800-53r5|IA-2(1),CN-L3|7.1.2.7(b),CSCv7|4.5,CSCv8|6.5,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2(1),LEVEL|2A,NESA|T5.4.2,NIAv2|AM36,NIAv2|VL3c,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|1.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
    </report>
  </else>
</if>

<if>
  <condition auto:"FAILED" type:"AND">
    <item>
      type        : CONFIG_CHECK
      description : "aes password encryption enabled"
      item        : "password6 encryption aes"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "AES config state"
      cmd         : "show type6 server"
      regex       : "AES config State[\s]+:[\s]+Enabled$"
      item        : "AES config State"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "Masterkey config state"
      cmd         : "show type6 server"
      regex       : "Masterkey config State[\s]+:[\s]+Enabled$"
      item        : "Masterkey config State"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "Type6 feature state"
      cmd         : "show type6 server"
      regex       : "Type6 feature State[\s]+:[\s]+Enabled$"
      item        : "Type6 feature State"
    </item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "1.8.1 Enable AES Password Encryption"
      info        : "You can enable strong, reversible 128-bit Advanced Encryption Standard (AES) password encryption, also known as type-6 encryption. To start using type-6 encryption, you must enable the AES password encryption feature and configure a master encryption key, which is used to encrypt and decrypt passwords. After you enable AES password encryption and configure a master key, all existing and newly created clear-text passwords for supported applications are stored in type-6 encrypted format

Encryption of passwords is used to protect it from being sent over the wire cleartext or being accidentally exposed when sharing device configurations with third parties. By applying encryption you are making it more difficult for an adversary to gain access to your device/network."
      solution    : "Define a password encryption key

IOSXR#key config-key password-encryption

New password Requirements: Min-length 6, Max-length 64
Characters restricted to [A-Z][a-z][0-9]
Enter new key :
Enter confirm key :
Master key operation is started in background

Enable aes config password encryption

/* Enable Type 6 password encryption */
IOSXR# configure
IOSXR(config)#password6 encryption aes
IOSXR(config)#commit

Impact:

Make sure to store your master in a secure place and test your emergency backup/restore procedures. Without the masterkey all passwords of supported type6 applications will need to be re-entered manually upon config restore from backup."
      reference   : "800-171|3.5.10,800-53|IA-5(1)(c),800-53r5|IA-5(1)(c),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1)(c),LEVEL|2M,NESA|T5.2.3,NIAv2|CY6,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.1"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
      show_output : YES
    </report>
  </then>
</if>

<if>
  <condition type:"AND">
    <item>
      type        : CONFIG_CHECK
      description : "check to see if any passwords are in use"
      item        : ".*password [0-7] .*"
    </item>
  </condition>

  <then>
    <if>
      <condition auto:"FAILED" type:"AND">
        <item>
          type        : CONFIG_CHECK
          description : "password policy - min-length"
          context     : "aaa password-policy"
          item        : "min-length @PASSWD_MIN_LEN@"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "password policy - max-length"
          context     : "aaa password-policy"
          item        : "max-length @PASSWD_MAX_LEN@"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "password policy - lifetime"
          context     : "aaa password-policy"
          item        : "lifetime @PASSWD_LIFETIME@"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "password policy - min-char-change"
          context     : "aaa password-policy"
          item        : "min-char-change @PASSWD_MIN_CHANGE@"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "password policy - lockout-time"
          context     : "aaa password-policy"
          item        : "lockout-time @PASSWD_LOCKOUT_TIME@"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "password policy - authen-max-attempts"
          context     : "aaa password-policy"
          item        : "authen-max-attempts @PASSWD_MAX_ATTEMPTS@"
        </item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "1.8.3 Configure a Password Policy"
          info        : "Because passwords are stored only in revertible type 7 format, please consider not applying this recommendation and using secrets instead.

This only applies if you absolutely need to configure \"password\" instead of \"secret\" for local users.

Cisco IOS XR Software introduces advanced AAA password strengthening policy and security mechanism to store, retrieve and provide rules or policy to specify user passwords. This password policy is applicable only for local users, and not for remote users whose profile information are stored in a third party AAA server.

Strong passwords are important because they help prevent unauthorized access to devices and the network.Even if a central authentication source is used, if that service is not available the fall-back authentication is often to local credentials. At least one local administrator user must be present on the device."
          solution    : "Use the following configuration to enable a password policy. Choose values according to established guidelines of your organization.

IOSXR# configure
IOSXR(config)#aaa password-policy {password_policy}
IOSXR(config-aaa)#min-length 8
IOSXR(config-aaa)#max-length 25
IOSXR(config-aaa)#lifetime months 3
IOSXR(config-aaa)#min-char-change 5
IOSXR(config-aaa)#authen-max-attempts 3
IOSXR(config-aaa)#lockout-time days 1
IOSXR(config)#username {local_username} password-policy {password_policy} password 0 {local_password}
IOSXR(config)#commit

Impact:

This policy is not applicable to secrets of the user. If both secret and password are configured for a user, then secret takes precedence, and password security policy does not have any effect on authentication or change of password for such users."
          reference   : "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|2M,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1"
          see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
          show_output : YES
        </report>
      </then>
    </if>
  </then>

  <else>
    <report type:"PASSED">
      description : "1.8.3 Configure a Password Policy"
      info        : "Because passwords are stored only in revertible type 7 format, please consider not applying this recommendation and using secrets instead.

This only applies if you absolutely need to configure \"password\" instead of \"secret\" for local users.

Cisco IOS XR Software introduces advanced AAA password strengthening policy and security mechanism to store, retrieve and provide rules or policy to specify user passwords. This password policy is applicable only for local users, and not for remote users whose profile information are stored in a third party AAA server.

Strong passwords are important because they help prevent unauthorized access to devices and the network.Even if a central authentication source is used, if that service is not available the fall-back authentication is often to local credentials. At least one local administrator user must be present on the device."
      solution    : "Use the following configuration to enable a password policy. Choose values according to established guidelines of your organization.

IOSXR# configure
IOSXR(config)#aaa password-policy {password_policy}
IOSXR(config-aaa)#min-length 8
IOSXR(config-aaa)#max-length 25
IOSXR(config-aaa)#lifetime months 3
IOSXR(config-aaa)#min-char-change 5
IOSXR(config-aaa)#authen-max-attempts 3
IOSXR(config-aaa)#lockout-time days 1
IOSXR(config)#username {local_username} password-policy {password_policy} password 0 {local_password}
IOSXR(config)#commit

Impact:

This policy is not applicable to secrets of the user. If both secret and password are configured for a user, then secret takes precedence, and password security policy does not have any effect on authentication or change of password for such users."
      reference   : "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|2M,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
    </report>
  </else>
</if>

<if>
  <condition auto:"FAILED" type:"AND">
    <item>
      type        : CONFIG_CHECK
      description : "check for inband control plane management"
      context     : "control-plane"
      item        : "inband"
      severity    : MEDIUM
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "check for out-of-band control plane management"
      context     : "control-plane"
      item        : "out-of-band"
      severity    : MEDIUM
    </item>
  </condition>

  <then>
    <report type:"WARNING">
      description : "1.9 Management plane protection"
      info        : "The Management Plane Protection (MPP) feature provides the capability to restrict the interfaces on which network management packets are allowed to enter a device. The MPP feature allows a network operator to designate one or more router interfaces as management interfaces.

The MPP protection feature, as well as all the management protocols under MPP, are disabled by default. When you configure an interface as either out-of-band or inband, it automatically enables MPP. Consequently, this enablement extends to all the protocols under MPP. If MPP is disabled and a protocol is activated, all interfaces can pass traffic.

When MPP is enabled with an activated protocol, the only default management interfaces allowing management traffic are the route processor (RP) and standby route processor (SRP) Ethernet interfaces. You must manually configure any other interface for which you want to enable MPP as a management interface.

This is part of the MPP setup.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Configure the management plane so that only certain protocols connectced to certain interfaces can access this IOS-XR device.

IOSXR(config)#control-plane
IOSXR(config-ctrl)#management-plane
IOSXR(config-mpp)#inband
IOSXR(config-mpp-inband)#interface {interface} allow {protocol} peer address ipv4 {IP_address}
IOSXR(config-mpp)#out-of-band
IOSXR(config-mpp-outband)#interface {interface} allow {protocol} peer address ipv4 {IP_address}

Impact:

The following restrictions are listed for implementing Management Plane Protection (MPP):

Currently, MPP does not keep track of the denied or dropped protocol requests.

MPP configuration does not enable the protocol services. MPP is responsible only for making the services available on different interfaces. The protocols are enabled explicitly.

Management requests that are received on inband interfaces are not necessarily acknowledged there.

Both Route Processor (RP) and distributed route processor (DRP) Ethernet interfaces are by default out-of-band interfaces and can be configured under MPP.

The changes made for the MPP configuration do not affect the active sessions that are established before the changes.

Currently, MPP controls only the incoming management requests for protocols, such as TFTP, Telnet, Simple Network Management Protocol (SNMP), Secure Shell (SSH), XML , HTTP and Netconf.

MPP does not support MIB."
      reference   : "800-171|3.1.1,800-171|3.1.2,800-53|AC-17,800-53r5|AC-17,CN-L3|8.1.4.4(c),CN-L3|8.1.10.6(i),CSF|PR.AC-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17,LEVEL|2A,NESA|T5.4.5,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,SWIFT-CSCv1|2.6"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
      show_output : YES
    </report>
  </then>
</if>

<if>
  <condition type:"AND">
    <item>
      type        : CONFIG_CHECK
      description : "check if eigrp is in use"
      item        : "router eigrp"
    </item>
  </condition>

  <then>
    <if>
      <condition auto:"FAILED" type:"AND">
        <item>
          type        : CONFIG_CHECK
          description : "eigrp - check that keychain exists"
          context     : "key chain @KEY_CHAIN@"
          item        : "key-string password"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "eigrp - check that interface is defined"
          context     : "router eigrp"
          item        : "address-family ipv(4|6)"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "eigrp - check for authentication using keychain"
          context     : "router eigrp"
          item        : "authentication keychain @KEY_CHAIN@"
        </item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "2.1.1.1 Authentication"
          info        : "Configure the EIGRP address family.

Rationale: EIGRP is a true multi-protocol routing protocol and the 'address-family' feature enables restriction of exchanges with specific neighbors"
          solution    : "Configure the EIGRP address family.

IOSXR(config)#router eigrp {AS_number}
IOSXR(config-eigrp)# address-family ipv4
IOSXR(config-eigrp-af)# interface {interface}
IOSXR(config-eigrp-af-if)#authentication keychain {key_chain_name}

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using 'address-family' for EIGRP enforces these policies by restricting the exchanges between predefined network devices."
          reference   : "800-171|3.1.16,800-171|3.1.17,800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|AC-18,800-53|AC-18(1),800-53|AC-18(3),800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53r5|AC-18,800-53r5|AC-18(1),800-53r5|AC-18(3),800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,CSCv8|4.2,CSF|DE.AE-1,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-18,ITSG-33|AC-18(1),ITSG-33|AC-18(3),ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,LEVEL|2A,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T5.4.2,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NIAv2|NS33,NIAv2|NS34,NIAv2|NS38,NIAv2|SS15a,NIAv2|SS16,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3"
          see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
          show_output : YES
        </report>
      </then>
    </if>
  </then>

  <else>
    <report type:"PASSED">
      description : "2.1.1.1 Authentication"
      info        : "Configure the EIGRP address family.

Rationale: EIGRP is a true multi-protocol routing protocol and the 'address-family' feature enables restriction of exchanges with specific neighbors"
      solution    : "Configure the EIGRP address family.

IOSXR(config)#router eigrp {AS_number}
IOSXR(config-eigrp)# address-family ipv4
IOSXR(config-eigrp-af)# interface {interface}
IOSXR(config-eigrp-af-if)#authentication keychain {key_chain_name}

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using 'address-family' for EIGRP enforces these policies by restricting the exchanges between predefined network devices."
      reference   : "800-171|3.1.16,800-171|3.1.17,800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|AC-18,800-53|AC-18(1),800-53|AC-18(3),800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53r5|AC-18,800-53r5|AC-18(1),800-53r5|AC-18(3),800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,CSCv8|4.2,CSF|DE.AE-1,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-18,ITSG-33|AC-18(1),ITSG-33|AC-18(3),ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,LEVEL|2A,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T5.4.2,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NIAv2|NS33,NIAv2|NS34,NIAv2|NS38,NIAv2|SS15a,NIAv2|SS16,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
    </report>
  </else>
</if>

<if>
  <condition type:"AND">
    <item>
      type        : CONFIG_CHECK
      description : "check if ospf is in use"
      item        : "router ospf"
    </item>
  </condition>

  <then>
    <if>
      <condition auto:"FAILED" type:"AND">
        <item>
          type        : CONFIG_CHECK
          description : "ospf - check that keychain exists"
          context     : "key chain @KEY_CHAIN@"
          item        : "key-string password"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "ospf - check that interface is defined"
          context     : "router ospf"
          item        : "address-family ipv4"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "ospf - check for authentication using keychain"
          context     : "router ospf"
          item        : "authentication keychain @KEY_CHAIN@"
        </item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "2.1.2.1 Authentication"
          info        : "Enable Open Shortest Path First (OSPF) Message Digest 5 (MD5) authentication.

This is part of the OSPF authentication setup"
          solution    : "Configure the appropriate interface(s) for Message Digest authentication

IOSXR(config)#router ospf {process_id}
IOSXR(config-ospf)# address-family ipv4
IOSXR(config-ospf)#area 0 authentication keychain {key_chain_name}

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Configuring the proper interface(s) for 'ip ospf message-digest-key md5' enforces these policies by restricting exchanges between network devices."
          reference   : "800-171|3.5.2,800-53|IA-5,800-53r5|IA-5,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,LEVEL|2A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2"
          see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
          show_output : YES
        </report>
      </then>
    </if>
  </then>

  <else>
    <report type:"PASSED">
      description : "2.1.2.1 Authentication"
      info        : "Enable Open Shortest Path First (OSPF) Message Digest 5 (MD5) authentication.

This is part of the OSPF authentication setup"
      solution    : "Configure the appropriate interface(s) for Message Digest authentication

IOSXR(config)#router ospf {process_id}
IOSXR(config-ospf)# address-family ipv4
IOSXR(config-ospf)#area 0 authentication keychain {key_chain_name}

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Configuring the proper interface(s) for 'ip ospf message-digest-key md5' enforces these policies by restricting exchanges between network devices."
      reference   : "800-171|3.5.2,800-53|IA-5,800-53r5|IA-5,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,LEVEL|2A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
    </report>
  </else>
</if>

<if>
  <condition type:"AND">
    <item>
      type        : CONFIG_CHECK
      description : "check if bgp is in use"
      item        : "router bgp"
    </item>
  </condition>

  <then>
    <if>
      <condition auto:"FAILED" type:"AND">
        <item>
          type        : CONFIG_CHECK
          description : "bgp - check that at least one neighbor is defined"
          context     : "router bgp"
          item        : "neighbor"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "bgp - check for neighbor password"
          context     : "router bgp"
          item        : "password encrypted"
        </item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "2.1.3.1 Authentication"
          info        : "Enable message digest5 (MD5) authentication on a TCP connection between two BGP peers

Enforcing routing authentication reduces the likelihood of routing poisoning and unauthorized routers from joining BGP routing."
          solution    : "Configure BGP neighbor authentication where feasible.

IOSXR(config)#router bgp {local_AS_number}
IOSXR(config-bgp)#neighbor {neighbor_IP_address} remote-as {remote_AS_number}
IOSXR(config-bgp)#neighbor {neighbor_IP_address} password clear {BGP_password}

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using the 'neighbor password' for BGP enforces these policies by restricting the type of authentication between network devices."
          reference   : "800-171|3.5.2,800-53|IA-5,800-53r5|IA-5,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,LEVEL|2A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2"
          see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
          show_output : YES
        </report>
      </then>
    </if>
  </then>

  <else>
    <report type:"PASSED">
      description : "2.1.3.1 Authentication"
      info        : "Enable message digest5 (MD5) authentication on a TCP connection between two BGP peers

Enforcing routing authentication reduces the likelihood of routing poisoning and unauthorized routers from joining BGP routing."
      solution    : "Configure BGP neighbor authentication where feasible.

IOSXR(config)#router bgp {local_AS_number}
IOSXR(config-bgp)#neighbor {neighbor_IP_address} remote-as {remote_AS_number}
IOSXR(config-bgp)#neighbor {neighbor_IP_address} password clear {BGP_password}

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using the 'neighbor password' for BGP enforces these policies by restricting the type of authentication between network devices."
      reference   : "800-171|3.5.2,800-53|IA-5,800-53r5|IA-5,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,LEVEL|2A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
    </report>
  </else>
</if>

<if>
  <condition type:"AND">
    <item>
      type        : CONFIG_CHECK
      description : "check if isis is in use"
      item        : "router isis"
    </item>
  </condition>

  <then>
    <if>
      <condition auto:"FAILED" type:"AND">
        <item>
          type        : CONFIG_CHECK
          description : "isis - check that keychain exists"
          context     : "key chain @KEY_CHAIN@"
          item        : "key-string password"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "isis - check for lsp-password using keychain"
          context     : "router isis"
          item        : "lsp-password keychain @KEY_CHAIN@"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "isis - check for hello-password using keychain"
          context     : "router isis"
          item        : "hello-password keychain @KEY_CHAIN@"
        </item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "2.1.4.1 Authentication"
          info        : "Enable authentication for ISIS packets and to specify the set of keys that can be used on an interface.

This is part of the ISIS authentication setup"
          solution    : "Configure the Interface with the RIPv2 key chain.

IOSXR(config)#router isis {process_id}
IOSXR(config-isis)#lsp-password keychain {key_chain_name}
IOSXR(config-isis)#interface {interface}
IOSXR(config-isis-if)#hello-password keychain {key_chain_name}

Impact:

TBCTBC"
          reference   : "800-171|3.5.2,800-53|IA-5,800-53r5|IA-5,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,LEVEL|2A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2"
          see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
          show_output : YES
        </report>
      </then>
    </if>
  </then>

  <else>
    <report type:"PASSED">
      description : "2.1.4.1 Authentication"
      info        : "Enable authentication for ISIS packets and to specify the set of keys that can be used on an interface.

This is part of the ISIS authentication setup"
      solution    : "Configure the Interface with the RIPv2 key chain.

IOSXR(config)#router isis {process_id}
IOSXR(config-isis)#lsp-password keychain {key_chain_name}
IOSXR(config-isis)#interface {interface}
IOSXR(config-isis-if)#hello-password keychain {key_chain_name}

Impact:

TBCTBC"
      reference   : "800-171|3.5.2,800-53|IA-5,800-53r5|IA-5,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,LEVEL|2A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
    </report>
  </else>
</if>

<if>
  <condition type:"AND">
    <item>
      type        : CONFIG_CHECK
      description : "check if rip is in use"
      item        : "router rip"
    </item>
  </condition>

  <then>
    <if>
      <condition auto:"FAILED" type:"AND">
        <item>
          type        : CONFIG_CHECK
          description : "rip - check that keychain exists"
          context     : "key chain @KEY_CHAIN@"
          item        : "key-string password"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "rip - check that interface is defined"
          context     : "router rip"
          item        : "interface"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "rip - check for authentication using keychain"
          context     : "router rip"
          item        : "authentication keychain @KEY_CHAIN@ mode md5"
        </item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "2.1.5.1 Authentication"
          info        : "Enable authentication for Routing Information Protocol (RIP) Version 2 packets and to specify the set of keys that can be used.

This is part of the RIPv2 authentication setup"
          solution    : "Configure the Interface with the RIPv2 key chain.

IOSXR(config)#router rip
IOSXR(config-rip)#interface {interface}
IOSXR(config-rip-if)#authentication keychain {key_chain_name} mode md5

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols, RIP v2 is no exception."
          reference   : "800-171|3.5.2,800-53|IA-5,800-53r5|IA-5,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,LEVEL|2A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2"
          see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
          show_output : YES
        </report>
      </then>
    </if>
  </then>

  <else>
    <report type:"PASSED">
      description : "2.1.5.1 Authentication"
      info        : "Enable authentication for Routing Information Protocol (RIP) Version 2 packets and to specify the set of keys that can be used.

This is part of the RIPv2 authentication setup"
      solution    : "Configure the Interface with the RIPv2 key chain.

IOSXR(config)#router rip
IOSXR(config-rip)#interface {interface}
IOSXR(config-rip-if)#authentication keychain {key_chain_name} mode md5

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols, RIP v2 is no exception."
      reference   : "800-171|3.5.2,800-53|IA-5,800-53r5|IA-5,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,LEVEL|2A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
    </report>
  </else>
</if>

<item>
  type        : CONFIG_CHECK
  description : "2.1.6 Key chains"
  info        : "Keychain management is a common method of authentication to configure shared secrets on all entities that exchange secrets such as keys, before establishing trust with each other. Routing protocols and network management applications on Cisco IOS XR software often use authentication to enhance security while communicating with peers.

The keychain by itself has no relevance; therefore, it must be used by an application that needs to communicate by using the keys (for authentication) with its peers. The keychain provides a secure mechanism to handle the keys and rollover based on the lifetime. Border Gateway Protocol (BGP), Open Shortest Path First (OSPF), and Intermediate System-to-Intermediate System (IS-IS) use the keychain to implement a hitless key rollover for authentication. BGP uses TCP authentication, which enables the authentication option and sends the Message Authentication Code (MAC) based on the cryptographic algorithm configured for the keychain."
  solution    : "IOSXR(config)#key chain {key_chain_name}
IOSXR(config-CHAIN)#key {key_id}
IOSXR(config-CHAIN-1)#key-string {key_string}

Impact:

This allows the configuration of routing protocol authentication to be made earier."
  reference   : "800-171|3.1.1,800-53|AC-2(1),800-53r5|AC-2(1),CN-L3|7.1.3.2(d),CSCv7|16.2,CSCv8|12.5,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(1),LEVEL|2A,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2"
  see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
  item        : "key chain @KEY_CHAIN@"
</item>

<item>
  type        : CONFIG_CHECK
  description : "2.2.1.1 Set 'ntp authenticate'"
  info        : "Enable NTP authentication.

Using authenticated NTP ensures the Cisco device only permits time updates from authorized NTP servers."
  solution    : "Configure NTP authentication:

IOSXR(config)#ntp authenticate

Impact:

Organizations should establish three Network Time Protocol (NTP) hosts to set consistent time across the enterprise. Enabling the 'ntp authenticate' command enforces authentication between NTP hosts."
  reference   : "800-171|3.3.6,800-171|3.3.7,800-53|AU-7,800-53|AU-8,800-53r5|AU-7,800-53r5|AU-8,CN-L3|7.1.2.3(c),CN-L3|8.1.4.3(b),CSCv7|6.1,CSCv8|8.4,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-7,ITSG-33|AU-8,LEVEL|2A,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4,TBA-FIISB|37.4"
  see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
  context     : "ntp"
  item        : "authenticate"
</item>

<item>
  type            : CONFIG_CHECK
  description     : "2.2.1.2 Set 'ntp authentication-key'"
  info            : "Define an authentication key for Network Time Protocol (NTP).

Using an authentication key provides a higher degree of security as only authenticated NTP servers will be able to update time for the Cisco device."
  solution        : "Configure at the NTP key ring and encryption key using the following command

IOSXR(config)#ntp authentication-key {ntp_key_id} md5 {ntp_key}

Impact:

Organizations should establish three Network Time Protocol (NTP) hosts to set consistent time across the enterprise. Enabling the 'ntp authentication-key' command enforces encrypted authentication between NTP hosts."
  reference       : "800-171|3.3.6,800-171|3.3.7,800-53|AU-7,800-53|AU-8,800-53r5|AU-7,800-53r5|AU-8,CN-L3|7.1.2.3(c),CN-L3|8.1.4.3(b),CSCv7|6.1,CSCv8|8.4,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-7,ITSG-33|AU-8,LEVEL|2A,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4,TBA-FIISB|37.4"
  see_also        : "https://workbench.cisecurity.org/benchmarks/10473"
  context         : "ntp"
  item            : "authentication-key .+ md5 encrypted .+$"
  min_occurrences : "1"
</item>

<item>
  type        : CONFIG_CHECK
  description : "2.2.1.3 Set the 'ntp trusted-key'"
  info        : "Ensure you authenticate the identity of a system to which Network Time Protocol (NTP) will synchronize

This authentication function provides protection against accidentally synchronizing the system to another system that is not trusted, because the other system must know the correct authentication key."
  solution    : "Configure the NTP trusted key using the following command

IOSXR(config)#ntp trusted-key {ntp_key_id}

Impact:

Organizations should establish three Network Time Protocol (NTP) hosts to set consistent time across the enterprise. Enabling the 'ntp trusted-key' command enforces encrypted authentication between NTP hosts."
  reference   : "800-171|3.3.6,800-171|3.3.7,800-53|AU-7,800-53|AU-8,800-53r5|AU-7,800-53r5|AU-8,CN-L3|7.1.2.3(c),CN-L3|8.1.4.3(b),CSCv7|6.1,CSCv8|8.4,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-7,ITSG-33|AU-8,LEVEL|2A,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4,TBA-FIISB|37.4"
  see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
  context     : "ntp"
  item        : "trusted-key"
</item>

<if>
  <condition auto:"FAILED" type:"AND">
    <item>
      type        : CONFIG_CHECK
      description : "check for key on primary ntp server'"
      context     : "ntp"
      item        : "server @NTP_SERVER_1@ key"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "check for key on secondary ntp server"
      context     : "ntp"
      item        : "server @NTP_SERVER_2@ key"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "check for key on tertiary ntp server"
      context     : "ntp"
      item        : "server @NTP_SERVER_3@ key"
    </item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "2.2.1.4 Set 'key' for each 'ntp server'"
      info        : "Specifies the authentication key for NTP.

This authentication feature provides protection against accidentally synchronizing the ntp system to another system that is not trusted, because the other system must know the correct authentication key."
      solution    : "Configure each NTP Server to use a key ring using the following command.

IOSXR(config)#ntp server {ntp-server_ip_address} key {ntp_key_id}

Impact:

Organizations should establish three Network Time Protocol (NTP) hosts to set consistent time across the enterprise. Enabling the 'ntp server key' command enforces encrypted authentication between NTP hosts."
      reference   : "800-171|3.3.6,800-171|3.3.7,800-53|AU-7,800-53|AU-8,800-53r5|AU-7,800-53r5|AU-8,CN-L3|7.1.2.3(c),CN-L3|8.1.4.3(b),CSCv7|6.1,CSCv8|8.4,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-7,ITSG-33|AU-8,LEVEL|2A,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4,TBA-FIISB|37.4"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
      show_output : YES
    </report>
  </then>
</if>

<item>
  type        : CONFIG_CHECK
  description : "2.3.1 Authentication"
  info        : "You can ensure that VRRP messages received from VRRP routers that comprise a virtual router are authenticated by configuring a simple text password.

This is part of the VRRP authentication setup"
  solution    : "Configure VRRP with the appropriate password.

IOSXR(config)#router vrrp
IOSXR(config-vrrp)#interface {interface}
IOSXR(config-vrrp-if)#address-family ipv4
IOSXR(config-vrrp-address-family)#vrrp {virtual_router_id}
IOSXR(config-vrrp-virtual-router)#text-authentication {password}

Impact:

An important aspect of the VRRP redundancy scheme is VRRP router priority. Priority determines the role that each VRRP router plays and what happens if the master virtual router fails.

If a VRRP router owns the IP address of the virtual router and the IP address of the physical interface, this router functions as a master virtual router.

Priority also determines if a VRRP router functions as a backup virtual router and determines the order of ascendancy to becoming a master virtual router if the master virtual router fails. You can configure the priority of each backup virtual router with a value of 1 through 254, using the vrrp priority command.

For example, if Router A, the master virtual router in a LAN topology, fails, an election process takes place to determine if backup virtual Routers B or C should take over. If Routers B and C are configured with the priorities of 101 and 100, respectively, Router B is elected to become master virtual router because it has the higher priority. If Routers B and C are both configured with the priority of 100, the backup virtual router with the higher IP address is elected to become the master virtual router.

By default, a preemptive scheme is enabled whereby a higher-priority backup virtual router that becomes available takes over for the backup virtual router that was elected to become master virtual router. You can disable this preemptive scheme using the no vrrp preempt command. If preemption is disabled, the backup virtual router that is elected to become master virtual router remains the master until the original master virtual router recovers and becomes master again."
  reference   : "800-171|3.13.1,800-171|3.13.5,800-53|SC-7,800-53r5|SC-7,CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,LEVEL|2A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1"
  see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
  context     : "router vrrp"
  item        : "text-authentication"
</item>

<item>
  type        : CONFIG_CHECK
  description : "2.4.1 Authentication"
  info        : "Enable authentication for HSRP packets and to specify the set of keys that can be used on an interface.

This is part of the HSRP authentication setup"
  solution    : "Configure HSRP with the appropriate password.

IOSXR(config)#router hsrp
IOSXR(config-hsrp)#interface {interface}
IOSXR(config-hsrp-if)#address-family ipv4 hsrp {hsrp_group_number} authentication {hsrp_password}

Impact:

The Hot Standby Router Protocol (HSRP) is an IP routing redundancy protocol designed to allow for transparent failover at the first-hop IP router. HSRP provides high network availability, because it routes IP traffic from hosts on networks without relying on the availability of any single router. HSRP is used in a group of routers for selecting an active router and a standby router. (An active router is the router of choice for routing packets; a standby router is a router that takes over the routing duties when an active router fails, or when preset conditions are met."
  reference   : "800-171|3.13.1,800-171|3.13.5,800-53|SC-7,800-53r5|SC-7,CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,LEVEL|2A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1"
  see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
  context     : "router hsrp"
  item        : "authentication"
</item>

<item>
  type            : CONFIG_CHECK
  description     : "3.1 URPF"
  info            : "Enable Unicast reverse path forwarding to prevent IP speeofing attacks.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution        : "Configure the Interface with the RIPv2 key chain.

IOSXR(config)#int {interface}
IOSXR(config-if)#ipv4 verify unicast source reachable-via rx

Impact:

Unicast Reverse Path Forwarding (URPF) is a mechanism for validating the source IP address of packets received on a router. A router configured with URPF performs a reverse path lookup in the FIB table tovalidate the presence of the source IP address. If the source IP address is listed in the table, then it indicatesthat the source is reachable and valid. If source IP address cannot be located in the FIB table, the packet istreated as malicious by the router and discarded."
  reference       : "800-171|3.14.6,800-171|3.14.7,800-53|SI-4,800-53r5|SI-4,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|SI-4,LEVEL|2A,NESA|M1.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2"
  see_also        : "https://workbench.cisecurity.org/benchmarks/10473"
  context         : "interface"
  item            : "ipv4 verify unicast source reachable-via rx"
  min_occurrences : "1"
  severity        : MEDIUM
</item>

</check_type>
