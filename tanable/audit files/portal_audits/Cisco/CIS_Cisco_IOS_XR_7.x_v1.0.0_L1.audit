#TRUSTED 4debbb4f0766e7216853a538c504bfcac610ff5d0e41c8843347ba71af6eebd18f8360d8d3702cc168e9f44a5cbd15a96717ad9a695ed5961258111b37179effabed72340a0fec20f12e00c40e1cc933b51238290714afd45d8e6e363701f376a739bf99ade2b1dc488c3e99f9193402813c7e0a9dcec5dcfee55fab66a3f2906c8a1cc10d01ec760e046d4a62169aab57b1966dd799639f7056291919de797c4cfa1f39b05ec62da50fb37f2dd7847e57a12a8f1461cb2cee3f711f00167cba32fc7e06dad4da4b658c4e577e683bf1a6f325dffadda94a3475011eabf9872117b47d865a87bfe6ac5b498230fbe8bd048abd6c839929fd2a146184bd3b43584296e0ec7aaa9cdcecc4adba2e2948dfc40d37bfcde4aefa841105b63799818dee417c54abf36647a9f2481a5dbf4f1543cc0ba61966436380e3495c1061df862af86a742966f417c522c587897c98a984c5974deb46034d1727fd2d0bb97fe5d145f0ebb4c40aea074e1dbf1eb508dbf78f8e6c3056021087e6faf6c0627d65abba00d69e1c1d91c01937f4340897e28bf23a6a0ee53566c6dfb7644e3031fadbb8481e51fa2ae5f519438be55ffb8c3a2b9307ef3c4bfdefe2a71837592cd73a79b878b30d98c2720673bcfc4c5e13fb8df922d3e6681371c0405501c2c7235c99b26d6981c0ee527af39015bcc98dff2a16991d588fb4d0eef8cbb9ea31a4
#TRUST-RSA-SHA256 9d420bb160145ca3aebf128d8a43cc729c64890889a62b787b32e18fbd73506c48d4904e36d2c44fac8a6888b00604ab742db3af1028af11549feef75bb7a8fb8c3da2ae42a0b5d306ae6391fa3f560026effa88d28f0a2c487ead8c50986bcc8b73e401e309e097fe01042b909e9502168de19e9667179e3b5d7d269008acab073dc397b575fb51407fa78701d1b4f0aa0cf4cb91c718350d3562a652e0e9afc96e31c51dd54fcabbb9a00a789f61d3203412f3d1a7f0ad5ab0c63d87220d3e595985988f97e7ab035ad063ddd460c3bb6236c3b7439e0188dce96360c7c0817ee3e9e1f1728e90c3684599c96b755881f939624dac9e709737a30a87f8156c2d2c74fb8cf11dda43cc9f42d42c379927383666191eac15009c29265c571e3638a40b4fd5c925d3a42ee7c05fe02b1013554fcb0c65621c5b42be50891df94499aae19cf0102d2f7d7110147ce2c2b0147980e579bd664d39278e1af91574f27edf8b0323d2a10d5e9ed8ce25b36002af64c5036d9e444beab4cec76173f97ce41d7fdbf96eb5ad5501d2c5aff46b303c4a6a49545fd30a7bd27444a49749bfa59b5c1fea33208ddb9735a4e9ce954b7d00b97d71549cbdd9f94be126ad1e5f3ce74ef4e2fab80a007a8b59ed110b4e861169df916333eeee30100c7ab23ea883912c0afa13bbaba9b5d1532afb26ae5de0f27bad34ac22eca6da7fefa59905
#
# This script is Copyright (C) 2004-2024 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
# $Revision: 1.1 $
# $Date: 2024/06/17 $
#
# description : This .audit is designed against the CIS Cisco IOS XR 7.x v1.0.0
#
#<ui_metadata>
#<display_name>CIS Cisco IOS XR 7.x v1.0.0 L1</display_name>
#<spec>
#  <type>CIS</type>
#  <name>Cisco IOS XR 7.x</name>
#  <profile>L1</profile>
#  <version>1.0.0</version>
#  <link>https://workbench.cisecurity.org/benchmarks/10473</link>
#</spec>
#<labels>cis,cisco_ios_xr_7.x</labels>
#<benchmark_refs>CSCv6,CSCv7,CSCv8,LEVEL</benchmark_refs>
#<variables>
#  <variable>
#    <name>AAA_GROUP</name>
#    <default>CIS-Auth-Group</default>
#    <description>1.1.x auth group name</description>
#    <info>The name of the AAA auth group</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>AUTHENTICATION_LIST</name>
#    <default>default</default>
#    <description>1.1.2.x authentication list</description>
#    <info>The authentication list to be referenced for AAA</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>ACCOUNTING_LIST</name>
#    <default>default</default>
#    <description>1.1.4.x accounting list</description>
#    <info>The accounting list to be referenced for AAA</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>LINE_TEMPLATE</name>
#    <default>default</default>
#    <description>1.1.2.2 line template</description>
#    <info>The line-template to be referenced for vty-pool AAA</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>KEY_MODULUS</name>
#    <default>2048</default>
#    <description>1.2.2 RSA key modulus size</description>
#    <info>The desired modulus size for the RSA key</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>LOG_BUFFER_SIZE</name>
#    <default>3000000</default>
#    <description>1.4.2 Log Buffer Size</description>
#    <info>Size in bytes of the internal log memory buffer.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>LOG_HOST</name>
#    <default>192.168.0.100</default>
#    <description>1.4.4 Logging host</description>
#    <info>The address of the syslog server for log forwarding.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>LOG_SOURCE_INTERFACE</name>
#    <default>MgmtEth0/RP0/CPU0/0</default>
#    <description>1.4.7 Logging Source Interface</description>
#    <info>The name of the interface port from which log forwarding traffic should originate.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>VTY_ACL</name>
#    <default>ACL-VTY-IN</default>
#    <description>1.6.2 SSH access list</description>
#    <info>list of addresses that are allowed access via vty</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>EXEC_TIMEOUT</name>
#    <default>10</default>
#    <description>1.6.3 Exec timeout for console sessions</description>
#    <info>The length of time in minutes after which console sessions will time out.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>BANNER_LOGIN</name>
#    <default>All unauthorized activity is monitored and logged.</default>
#    <description>1.7.1 Pre-authentication Banner</description>
#    <info>The banner displayed from the 'banner login' configuration option.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>BANNER_EXEC</name>
#    <default>All unauthorized activity is monitored and logged.</default>
#    <description>1.7.2 Post-authentication banner</description>
#    <info>The banner displayed from the 'banner exec' configuration option.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>NTP_SERVER_1</name>
#    <default>192.168.1.1</default>
#    <description>2.2.2 primary NTP server</description>
#    <info>The IP address for the primary NTP server used by the target device.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>NTP_SERVER_2</name>
#    <default>192.168.1.2</default>
#    <description>2.2.2 secondary NTP server</description>
#    <info>The IP address for the secondary NTP server used by the target device.</info>
#    <value_type>STRING</value_type>
#  </variable>
#</variables>
#</ui_metadata>

<check_type:"Cisco">

<if>
  <condition auto:"FAILED" type:"AND">
    <item>
      type        : CONFIG_CHECK
      description : "check for line console login"
      cmd         : "show running-config formal | include login authentication"
      item        : "line console login authentication @AUTHENTICATION_LIST@"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "check for aaa auth login default group"
      item        : "aaa authentication login @AUTHENTICATION_LIST@ group @AAA_GROUP@"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "check for defined RADIUS/TACACS+ group"
      regex       : "aaa group server (radius|tacacs\+) @AAA_GROUP@"
      item        : "aaa group server"
    </item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "1.1.2.1 console authentication"
      info        : "Authenticate management access to the network devices. Typically a central authentication store combined with a fallback mechanism should be implemented to allow emergency access, in case the central authentication servers are not available.

Management access to network devices must be authenticated. The default under AAA (local or network) is to require users to log in using a valid user name and password. This rule applies for both local and network AAA. Fallback mode should also be enabled to allow emergency access to the router or switch in the event that the AAA server was unreachable."
      solution    : "Configure an authentication list that references the AAA group that was created in the prerequisites. AAA lists are prioritized list of databases. If the system is unable to use a database, it automatically rolls over to the next database on the list. If the authentication, authorization, or accounting request is rejected by any database, the rollover does not occur and the request is rejected.

It is common to include \"local\" as the last entry in the list, to allow access to manage the device even if all servers from the AAA group are unavailable. Note that it also means that if an attacker can DoS the AAA Servers, they can start to try authenticate locally as well. Hence, always ensure to use strong passwords for local users.

IOSXR(config)#aaa authentication login default group {tacacs_group|radius_group} local

Above configuration authenticates first against a central aaa group and uses local user accounts as fallback.

Ensure the above list is referenced under the line templates:

IOSXR(config)#line console login authentication default

Ensure the vty pool references the above line template:

IOSXR(config)#vty-pool default 0 4 line-template default

Impact:

If no authentication is implemented, any user with network reachability to the management interface can access network devices and change their configuration."
      reference   : "800-171|3.1.1,800-53|AC-2(1),800-53r5|AC-2(1),CN-L3|7.1.3.2(d),CSCv7|16.2,CSCv8|5.6,CSCv8|12.5,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(1),LEVEL|1A,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
      show_output : YES
    </report>
  </then>
</if>

<if>
  <condition auto:"FAILED" type:"AND">
    <item>
      type        : CONFIG_CHECK
      description : "check for vty-pool default"
      item        : "vty-pool default .+ line-template @LINE_TEMPLATE@"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "check for line console login"
      cmd         : "show running-config formal | include login authentication"
      item        : "line console login authentication @LINE_TEMPLATE@"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "check for line default login"
      cmd         : "show running-config formal | include login authentication"
      item        : "line default login authentication @LINE_TEMPLATE@"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "check for aaa auth login"
      item        : "aaa authentication login @AUTHENTICATION_LIST@ group @AAA_GROUP@"
    </item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "1.1.2.2 vty line authentication"
      info        : "Authenticate management access to the network devices. Typically a central authentication store combined with a fallback mechanism should be implemented to allow emergency access, in case the central authentication servers are not available.

Management access to network devices must be authenticated. The default under AAA (local or network) is to require users to log in using a valid user name and password. This rule applies for both local and network AAA. Fallback mode should also be enabled to allow emergency access to the router or switch in the event that the AAA server was unreachable."
      solution    : "Configure an authentication list that references the AAA group that was created in the prerequisites. AAA lists are prioritized list of databases. If the system is unable to use a database, it automatically rolls over to the next database on the list. If the authentication, authorization, or accounting request is rejected by any database, the rollover does not occur and the request is rejected.

It is common to include \"local\" as the last entry in the list, to allow access to manage the device even if all servers from the AAA group are unavailable. Note that it also means that if an attacker can DoS the AAA Servers, they can start to try authenticate locally as well. Hence, always ensure to use strong passwords for local users.

IOSXR(config)#aaa authentication login default group {tacacs_group|radius_group} local

Above configuration authenticates first against a central aaa group and uses local user accounts as fallback.

Ensure the above list is referenced under the line templates:

IOSXR(config)#line console login authentication default
IOSXR(config)#line default login authentication default

Ensure the vty pool references the above line template:

IOSXR(config)#vty-pool default 0 4 line-template default

Impact:

If no authentication is implemented, any user with network reachability to the management interface can access network devices and change their configuration."
      reference   : "800-171|3.1.1,800-53|AC-2(1),800-53r5|AC-2(1),CN-L3|7.1.3.2(d),CSCv7|16.2,CSCv8|5.6,CSCv8|12.5,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(1),LEVEL|1A,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
      show_output : YES
    </report>
  </then>
</if>

<if>
  <condition auto:"FAILED" type:"AND">
    <item>
      type        : CONFIG_CHECK
      description : "check for aaa accounting exec"
      item        : "aaa accounting exec @ACCOUNTING_LIST@ start-stop group @AAA_GROUP@"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "check for line console accounting"
      cmd         : "show running-config formal | include accounting"
      item        : "line console accounting exec @ACCOUNTING_LIST@"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "check for line default accounting"
      cmd         : "show running-config formal | include accounting"
      item        : "line default accounting exec @ACCOUNTING_LIST@"
    </item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "1.1.4.1 exec accounting"
      info        : "The router reports user activity to the TACACS+ or RADIUS security server in the form of accounting records. Each accounting record contains accounting AV pairs and is stored on the security server.

Authentication, authorization and accounting (AAA) systems provide an authoritative source for managing and monitoring access for devices. Centralizing control improves consistency of access control, the services that may be accessed once authenticated and accountability by tracking services accessed. Additionally, centralizing access control simplifies and reduces administrative costs of account provisioning and de-provisioning, especially when managing a large number of devices. AAA Accounting provides a management and audit trail for user and administrative sessions through TACACS+."
      solution    : "Configure an accounting list which for example includes the tacacs+ or radius server group, which was defined in the prerequisites or local or both:

IOSXR(config)#aaa accounting exec default start-stop group {tacacs_group|radius_group}
IOSXR(config)#line console accounting exec default
IOSXR(config)#line default accounting exec default

Note: exec accounting doesn't support the \"local\" / syslog target.

Impact:

Enabling 'aaa accounting exec' records each new exec session on the router and sends it to the accounting servers and enables organizations to monitor and analyze the activity.

Command accounting is not supported for commands that are executed using Netconf, XML or GRPC."
      reference   : "800-171|3.1.1,800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AC-2(1),800-53|AU-2,800-53|AU-7,800-53|AU-12,800-53r5|AC-2(1),800-53r5|AU-2,800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(c),CN-L3|7.1.3.2(d),CN-L3|8.1.4.3(a),CSCv8|8.2,CSCv8|12.5,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(1),ITSG-33|AU-2,ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1A,NESA|M1.2.2,NESA|M5.5.1,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,NIAv2|SS30,NIAv2|VL8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|6.4"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
      show_output : YES
    </report>
  </then>
</if>

<if>
  <condition auto:"FAILED" type:"AND">
    <item>
      type        : CONFIG_CHECK
      description : "check for aaa accounting commands"
      item        : "aaa accounting commands @ACCOUNTING_LIST@ start-stop group @AAA_GROUP@"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "check for line console accounting"
      cmd         : "show running-config formal | include accounting"
      item        : "line console accounting commands @ACCOUNTING_LIST@"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "check for line default accounting"
      cmd         : "show running-config formal | include accounting"
      item        : "line default accounting commands @ACCOUNTING_LIST@"
    </item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "1.1.4.2 command accounting"
      info        : "The router reports user activity to the TACACS+ or RADIUS security server in the form of accounting records. Each accounting record contains accounting AV pairs and is stored on the security server.

Authentication, authorization and accounting (AAA) systems provide an authoritative source for managing and monitoring access for devices. Centralizing control improves consistency of access control, the services that may be accessed once authenticated and accountability by tracking services accessed. Additionally, centralizing access control simplifies and reduces administrative costs of account provisioning and de-provisioning, especially when managing a large number of devices. AAA Accounting provides a management and audit trail for user and administrative sessions through TACACS+."
      solution    : "Configure an accounting list which for example includes the tacacs+ or radius server group, which was defined in the prerequisites or local or both:

IOSXR(config)#aaa accounting commands default start-stop group {tacacs_group|radius_group} local
IOSXR(config)#line console accounting commands default
IOSXR(config)#line default accounting commands default

Impact:

Enabling 'aaa accounting commands' records and sends any user entered command to the accounting servers and enables organizations to monitor and analyze the activity.

Command accounting is not supported for commands that are executed using Netconf, XML or GRPC."
      reference   : "800-171|3.1.1,800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AC-2(1),800-53|AU-2,800-53|AU-7,800-53|AU-12,800-53r5|AC-2(1),800-53r5|AU-2,800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(c),CN-L3|7.1.3.2(d),CN-L3|8.1.4.3(a),CSCv8|8.2,CSCv8|12.5,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(1),ITSG-33|AU-2,ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1A,NESA|M1.2.2,NESA|M5.5.1,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,NIAv2|SS30,NIAv2|VL8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|6.4"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
      show_output : YES
    </report>
  </then>
</if>

<item>
  type        : CONFIG_CHECK
  description : "1.1.4.3 network accounting"
  info        : "The router reports user activity to the TACACS+ or RADIUS security server in the form of accounting records. Each accounting record contains accounting AV pairs and is stored on the security server.

Authentication, authorization and accounting (AAA) systems provide an authoritative source for managing and monitoring access for devices. Centralizing control improves consistency of access control, the services that may be accessed once authenticated and accountability by tracking services accessed. Additionally, centralizing access control simplifies and reduces administrative costs of account provisioning and de-provisioning, especially when managing a large number of devices. AAA Accounting provides a management and audit trail for user and administrative sessions through TACACS+."
  solution    : "Configure an accounting list which includes the tacacs+ or radius server group, that was defined in the prerequisites or local or both:

aaa accounting network default start-stop group {tacacs_group|radius_group}

Impact:

Enabling 'aaa accounting network' records all network-related service requests, such as Internet Key Exchange (IKE) and Point-to-Point Protocol (PPP) to the accounting servers and enables organizations to monitor and analyze the activity."
  reference   : "800-171|3.1.1,800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AC-2(1),800-53|AU-2,800-53|AU-7,800-53|AU-12,800-53r5|AC-2(1),800-53r5|AU-2,800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(c),CN-L3|7.1.3.2(d),CN-L3|8.1.4.3(a),CSCv8|8.2,CSCv8|12.5,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(1),ITSG-33|AU-2,ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1A,NESA|M1.2.2,NESA|M5.5.1,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,NIAv2|SS30,NIAv2|VL8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|6.4"
  see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
  item        : "aaa accounting network @ACCOUNTING_LIST@ start-stop group @AAA_GROUP@"
</item>

<item>
  type        : CONFIG_CHECK
  description : "1.1.4.4 system accounting"
  info        : "The router reports user activity to the TACACS+ or RADIUS security server in the form of accounting records. Each accounting record contains accounting AV pairs and is stored on the security server.

Authentication, authorization and accounting (AAA) systems provide an authoritative source for managing and monitoring access for devices. Centralizing control improves consistency of access control, the services that may be accessed once authenticated and accountability by tracking services accessed. Additionally, centralizing access control simplifies and reduces administrative costs of account provisioning and de-provisioning, especially when managing a large number of devices. AAA Accounting provides a management and audit trail for user and administrative sessions through TACACS+."
  solution    : "Configure an accounting list which includes the tacacs+ or radius server group, that was defined in the prerequisites or local or both:

aaa accounting system default start-stop group {tacacs_group|radius_group}

Impact:

Enabling 'aaa accounting system' records all system-related events to the accounting servers and enables organizations to monitor and analyze the activity."
  reference   : "800-171|3.1.1,800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AC-2(1),800-53|AU-2,800-53|AU-7,800-53|AU-12,800-53r5|AC-2(1),800-53r5|AU-2,800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(c),CN-L3|7.1.3.2(d),CN-L3|8.1.4.3(a),CSCv8|8.2,CSCv8|12.5,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(1),ITSG-33|AU-2,ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1A,NESA|M1.2.2,NESA|M5.5.1,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,NIAv2|SS30,NIAv2|VL8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|6.4"
  see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
  item        : "aaa accounting system @ACCOUNTING_LIST@ start-stop group @AAA_GROUP@"
</item>

<item>
  type        : CONFIG_CHECK
  description : "1.2.1 Set the 'hostname'"
  info        : "The hostname is used in prompts and default configuration filenames.

The domain name is prerequisite for setting up SSH."
  solution    : "Configure an appropriate host name for the router.

IOSXR(config)#hostname {hostname}

Impact:

Organizations should plan the enterprise network and identify an appropriate host name for each router."
  reference   : "800-171|3.5.3,800-53|IA-2(1),800-53r5|IA-2(1),CN-L3|7.1.2.7(b),CSCv7|4.5,CSCv8|6.5,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2(1),LEVEL|1A,NESA|T5.4.2,NIAv2|AM36,NIAv2|VL3c,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|1.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
  regex       : "hostname (?!Router).+"
  item        : "hostname .+"
</item>

<item>
  type        : CONFIG_CHECK
  description : "1.2.2 Set 'modulus' to greater than or equal to 2048 for 'crypto key generate rsa'"
  info        : "Use this command to generate RSA key pairs for your Cisco device.

RSA keys are generated in pairs--one public RSA key and one private RSA key.

An RSA key pair is a prerequisite for setting up SSH and should be at least 2048 bits.

NOTE: IOS does NOT display the modulus bit value in the Audit Procedure."
  solution    : "Generate an RSA key pair for the router.

IOSXR#crypto key generate rsa general-keys
Wed Jul 19 18:10:51.633 UTC
The name for the keys will be: the_default
% You already have keys defined for the_default
Do you really want to replace them? [yes/no]: yes

Choose the size of the key modulus in the range of 512 to 4096 for your General Purpose Keypair. Choosing a key modulus greater than 512 may take a few minutes.

How many bits in the modulus [2048]:
Generating RSA keys ...
Done w/ crypto generate keypair
[OK]

Impact:

Organizations should plan and implement enterprise network cryptography and generate an appropriate RSA key pairs, such as 'modulus', greater than or equal to 2048."
  reference   : "800-171|3.5.3,800-53|IA-2(1),800-53r5|IA-2(1),CN-L3|7.1.2.7(b),CSCv7|4.5,CSCv8|6.5,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2(1),LEVEL|1A,NESA|T5.4.2,NIAv2|AM36,NIAv2|VL3c,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|1.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
  cmd         : "show crypto key mypubkey rsa"
  regex       : "Size[ ]+:[ ]+@KEY_MODULUS@$"
  item        : "Size[ ]+:"
</item>

<item>
  type        : CONFIG_CHECK
  description : "1.2.3 Set 'seconds' for 'ssh timeout' for 60 seconds or less"
  info        : "The time interval that the router waits for the SSH client to respond before disconnecting an uncompleted login attempt.

This reduces the risk of an administrator leaving an authenticated session logged in for an extended period of time."
  solution    : "Configure the SSH timeout

IOSXR(config)#ssh timeout {ssh_timeout}

Impact:

Organizations should implement a security policy requiring minimum timeout settings for all network administrators and enforce the policy through the 'ip ssh timeout' command."
  reference   : "800-171|3.5.3,800-53|IA-2(1),800-53r5|IA-2(1),CN-L3|7.1.2.7(b),CSCv7|4.5,CSCv8|6.5,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2(1),LEVEL|1A,NESA|T5.4.2,NIAv2|AM36,NIAv2|VL3c,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|1.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
  regex       : "ssh timeout ([1-9]|[1-5][0-9]|60)$"
  item        : "ssh timeout"
  required    : NO
</item>

<item>
  type        : CONFIG_CHECK_NOT
  description : "1.3.1 Disable CDP"
  info        : "Disable Cisco Discovery Protocol (CDP) service at device level.

The Cisco Discovery Protocol is a proprietary protocol that Cisco devices use to identify each other on a LAN segment. It is useful only in network monitoring and troubleshooting situations but is considered a security risk because of the amount of information provided from queries. In addition, there have been published denial-of-service (DoS) attacks that use CDP. CDP should be completely disabled unless necessary."
  solution    : "Disable Cisco Discovery Protocol (CDP) service globally.

IOSXR(config)#no cdp

Impact:

To reduce the risk of unauthorized access, organizations should implement a security policy restricting network protocols and explicitly require disabling all insecure or unnecessary protocols."
  reference   : "800-171|3.13.1,800-171|3.13.5,800-171|3.13.6,800-53|CA-9,800-53|SC-7,800-53|SC-7(5),800-53r5|CA-9,800-53r5|SC-7,800-53r5|SC-7(5),CN-L3|7.1.2.2(c),CN-L3|8.1.10.6(j),CSCv7|9.2,CSCv8|4.4,CSCv8|4.5,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,ITSG-33|SC-7(5),LEVEL|1A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.1,TBA-FIISB|43.1"
  see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
  item        : "cdp"
</item>

<item>
  type        : CONFIG_CHECK_NOT
  description : "1.3.2 Disable TCP and UDP small servers"
  info        : "TCP and UDP small servers are servers (daemons, in Unix parlance) that run in the router which are useful for diagnostics.

TCP Small ServersThe TCP small servers are:

Echo: Echoes back whatever you type through the telnet x.x.x.x echo command.

Chargen: Generates a stream of ASCII data. Use the telnet x.x.x.x chargen command.

Discard: Throws away whatever you type. Use the telnet x.x.x.x discard command.

Daytime: Returns system date and time, if it is correct. It is correct if you run Network Time Protocol (NTP), or have set the date and time manually from the exec level. Use the telnet x.x.x.x daytime command.

Replace x.x.x.x with the IP address of your router. Most routers inside Cisco run the small servers.

UDP Small ServersThe UDP small servers are:

Echo: Echoes the payload of the datagram you send.

Discard: Silently pitches the datagram you send.

Chargen: Pitches the datagram you send, and responds with a 72-character string of ASCII characters terminated with a CR+LF.

Notes:

Almost all Unix boxes support the small servers listed above.

The router also offers finger service and async line bootp service, which you can independently turn off with the configuration global commands no service finger and no ip bootp server, respectively."
  solution    : "Disable TCp and UDP small services

IOSXR(config)#no service ipv4 tcp-small-servers max-servers 10
IOSXR(config)#no service ipv4 udp-small-servers max-servers 10
IOSXR(config)#commit

Impact:

TBC"
  reference   : "800-171|3.13.1,800-171|3.13.5,800-171|3.13.6,800-53|CA-9,800-53|SC-7,800-53|SC-7(5),800-53r5|CA-9,800-53r5|SC-7,800-53r5|SC-7(5),CN-L3|7.1.2.2(c),CN-L3|8.1.10.6(j),CSCv7|9.2,CSCv8|4.4,CSCv8|4.5,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,ITSG-33|SC-7(5),LEVEL|1A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.1,TBA-FIISB|43.1"
  see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
  item        : "service ipv4 (tcp|udp)-small-servers.*?"
</item>

<item>
  type        : CONFIG_CHECK
  description : "1.4.1 Enable logging"
  info        : "Enable logging of system messages.

Logging provides a chronological record of activities on the Cisco device and allows monitoring of both operational and security related events."
  solution    : "Enable system logging.

IOSXR(config)#logging trap {severity_level}

Impact:

TBC"
  reference   : "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-3,800-53|AU-3(1),800-53|AU-7,800-53|AU-12,800-53r5|AU-3,800-53r5|AU-3(1),800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.2.3(c),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|8.1.4.3(b),CSCv7|6.3,CSCv8|8.5,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,ITSG-33|AU-3(1),ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1A,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4"
  see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
  item        : "logging"
</item>

<item>
  type        : CONFIG_CHECK
  description : "1.4.2 Set 'buffer size'"
  info        : "Enable system message logging to a local buffer.

The device can copy and store log messages to an internal memory buffer. The buffered data is available only from a router exec or enabled exec session. This form of logging is useful for debugging and monitoring when logged in to a router."
  solution    : "Configure buffered logging (with minimum size). Recommended size is 64000.

IOSXR(config)#logging buffered {logging_buffer_size}

Impact:

Data forensics is effective for managing technology risks and an organization can enforce such policies by enabling the 'logging buffered' command."
  reference   : "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-3,800-53|AU-3(1),800-53|AU-7,800-53|AU-12,800-53r5|AU-3,800-53r5|AU-3(1),800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.2.3(c),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|8.1.4.3(b),CSCv7|6.3,CSCv8|8.5,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,ITSG-33|AU-3(1),ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1A,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4"
  see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
  item        : "logging buffered @LOG_BUFFER_SIZE@"
</item>

<item>
  type        : CONFIG_CHECK
  description : "1.4.3 Set 'logging console critical'"
  info        : "Verify logging to device console is enabled and limited to a rational severity level to avoid impacting system performance and management.

This configuration determines the severity of messages that will generate console messages. Logging to console should be limited only to those messages required for immediate troubleshooting while logged into the device. This form of logging is not persistent; messages printed to the console are not stored by the router. Console logging is handy for operators when they use the console."
  solution    : "Configure console logging level.

IOSXR(config)#logging console critical

Impact:

Logging critical messages at the console is important for an organization managing technology risk. The 'logging console' command should capture appropriate severity messages to be effective."
  reference   : "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-3,800-53|AU-3(1),800-53|AU-7,800-53|AU-12,800-53r5|AU-3,800-53r5|AU-3(1),800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.2.3(c),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|8.1.4.3(b),CSCv7|6.3,CSCv8|8.5,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,ITSG-33|AU-3(1),ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1A,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4"
  see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
  item        : "logging console critical"
</item>

<item>
  type        : CONFIG_CHECK
  description : "1.4.4 Set IP address for 'logging host'"
  info        : "Log system messages and debug output to a remote host.

Cisco routers can send their log messages to a Unix-style Syslog service. A syslog service simply accepts messages and stores them in files or prints them according to a simple configuration file. This form of logging is best because it can provide protected long-term storage for logs (the devices internal logging buffer has limited capacity to store events.) In addition, logging to an external system is highly recommended or required by most security standards. If desired or required by policy, law and/or regulation, enable a second syslog server for redundancy."
  solution    : "Designate one or more syslog servers by IP address.

hostname(config)#logging host {syslog_server}

Impact:

Logging is an important process for an organization managing technology risk. The 'logging host' command sets the IP address of the logging host and enforces the logging process."
  reference   : "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-171|3.6.1,800-171|3.14.6,800-171|3.14.7,800-53|AU-6(1),800-53|AU-7,800-53|IR-4(1),800-53|SI-4,800-53|SI-4(2),800-53|SI-4(5),800-53r5|AU-6(1),800-53r5|AU-7,800-53r5|IR-4(1),800-53r5|SI-4,800-53r5|SI-4(2),800-53r5|SI-4(5),CN-L3|7.1.2.3(c),CN-L3|7.1.3.3(d),CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSCv7|6.6,CSCv7|6.8,CSCv8|13.1,CSCv8|13.11,CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.AE-5,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|PR.PT-1,CSF|RC.RP-1,CSF|RS.AN-1,CSF|RS.AN-3,CSF|RS.CO-2,CSF|RS.CO-3,CSF|RS.RP-1,GDPR|32.1.b,GDPR|32.1.d,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-6(1),ITSG-33|AU-7,ITSG-33|IR-4(1),ITSG-33|SI-4,ITSG-33|SI-4(2),ITSG-33|SI-4(5),LEVEL|1A,NESA|M1.2.2,NESA|M5.2.5,NESA|T8.2.8,NESA|T8.2.9,PCI-DSSv4.0|10.4.1.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4,TBA-FIISB|45.2.5"
  see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
  regex       : "logging @LOG_HOST@ .*$"
  item        : "logging @LOG_HOST@"
</item>

<item>
  type        : CONFIG_CHECK
  description : "1.4.5 Set 'logging trap informational'"
  info        : "Limit messages logged to the syslog servers based on severity level informational.

This determines the severity of messages that will generate simple network management protocol (SNMP) trap and or syslog messages. This setting should be set to either \"debugging\" (7) or \"informational\" (6), but no lower."
  solution    : "Configure SNMP trap and syslog logging level.

IOSXR(config)#logging trap informational

Impact:

Logging is an important process for an organization managing technology risk. The 'logging trap' command sets the severity of messages and enforces the logging process."
  reference   : "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-3,800-53|AU-3(1),800-53|AU-7,800-53|AU-12,800-53r5|AU-3,800-53r5|AU-3(1),800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.2.3(c),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|8.1.4.3(b),CSCv7|6.3,CSCv8|8.5,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,ITSG-33|AU-3(1),ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1A,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4"
  see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
  item        : "logging trap (informational|debugging)"
</item>

<item>
  type        : CONFIG_CHECK
  description : "1.4.6 Set logging timestamps"
  info        : "Configure the system to apply a time stamp to debugging messages or system logging messages

Including timestamps in log messages allows correlating events and tracing network attacks across multiple devices. Enabling service timestamp to mark the time log messages were generated simplifies obtaining a holistic view of events enabling faster troubleshooting of issues or attacks."
  solution    : "Configure debug messages to include timestamps.

IOSXR(config)#service timestamps log datetime msec

Impact:

Logging is an important process for an organization managing technology risk and establishing a timeline of events is critical. The 'service timestamps' command sets the date and time on entries sent to the logging host and enforces the logging process."
  reference   : "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-3,800-53|AU-3(1),800-53|AU-7,800-53|AU-12,800-53r5|AU-3,800-53r5|AU-3(1),800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.2.3(c),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|8.1.4.3(b),CSCv7|6.3,CSCv8|8.5,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,ITSG-33|AU-3(1),ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1A,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4"
  see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
  regex       : "service timestamps log datetime (?=.*msec.*)"
  item        : "service timestamps log datetime"
</item>

<item>
  type        : CONFIG_CHECK
  description : "1.4.7 Set 'logging source interface'"
  info        : "Specify the source IPv4 or IPv6 address of system logging packets

This is required so that the router sends log messages to the logging server from a consistent IP address."
  solution    : "Bind logging to the loopback interface.

IOSXR(config)#logging source-interface {logging_source_interface}

Impact:

Logging is an important process for an organization managing technology risk and establishing a consistent source of messages for the logging host is critical. The 'logging source interface loopback' command sets a consistent IP address to send messages to the logging host and enforces the logging process."
  reference   : "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-3,800-53|AU-3(1),800-53|AU-7,800-53|AU-12,800-53r5|AU-3,800-53r5|AU-3(1),800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.2.3(c),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|8.1.4.3(b),CSCv7|6.3,CSCv8|8.5,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,ITSG-33|AU-3(1),ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1A,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4"
  see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
  item        : "logging source-interface @LOG_SOURCE_INTERFACE@"
</item>

<item>
  type        : CONFIG_CHECK_NOT
  description : "1.5.1 Unset 'private' for 'snmp-server community'"
  info        : "An SNMP community string permits read-only access to all objects.

The default community string \"private\" is well known. Using easy to guess, well known community string poses a threat that an attacker can effortlessly gain unauthorized access to the device."
  solution    : "Disable the default SNMP community string private

IOSXR(config)#no snmp-server community {community_string}

Impact:

To reduce the risk of unauthorized access, Organizations should disable default, easy to guess, settings such as the 'private' setting for snmp-server community."
  reference   : "800-171|3.13.1,800-171|3.13.5,800-171|3.13.6,800-53|CA-9,800-53|SC-7,800-53|SC-7(5),800-53r5|CA-9,800-53r5|SC-7,800-53r5|SC-7(5),CN-L3|7.1.2.2(c),CN-L3|8.1.10.6(j),CSCv7|9.2,CSCv8|4.4,CSCv8|4.5,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,ITSG-33|SC-7(5),LEVEL|1A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.1,TBA-FIISB|43.1"
  see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
  item        : "snmp-server community private"
</item>

<item>
  type        : CONFIG_CHECK_NOT
  description : "1.5.2 Unset 'public' for 'snmp-server community'"
  info        : "An SNMP community string permits read-only access to all objects.

The default community string \"public\" is well known. Using easy to guess, well known community string poses a threat that an attacker can effortlessly gain unauthorized access to the device."
  solution    : "Disable the default SNMP community string \"public\"

IOSXR(config)#no snmp-server community {community_string}

Impact:

To reduce the risk of unauthorized access, Organizations should disable default, easy to guess, settings such as the 'public' setting for snmp-server community."
  reference   : "800-171|3.13.1,800-171|3.13.5,800-171|3.13.6,800-53|CA-9,800-53|SC-7,800-53|SC-7(5),800-53r5|CA-9,800-53r5|SC-7,800-53r5|SC-7(5),CN-L3|7.1.2.2(c),CN-L3|8.1.10.6(j),CSCv7|9.2,CSCv8|4.4,CSCv8|4.5,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,ITSG-33|SC-7(5),LEVEL|1A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.1,TBA-FIISB|43.1"
  see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
  item        : "snmp-server community public"
</item>

<item>
  type        : CONFIG_CHECK_NOT
  description : "1.5.3 Do not set 'RW' for any 'snmp-server community'"
  info        : "Specifies read-write access. Authorized management stations can both retrieve and modify MIB objects.

Enabling SNMP read-write enables remote management of the device. Unless absolutely necessary, do not allow simple network management protocol (SNMP) write access."
  solution    : "Disable SNMP write access.

IOSXR(config)#no snmp-server community {community_string}

Impact:

To reduce the risk of unauthorized access, Organizations should disable the SNMP 'write' access for snmp-server community."
  reference   : "800-171|3.13.1,800-171|3.13.5,800-171|3.13.6,800-53|CA-9,800-53|SC-7,800-53|SC-7(5),800-53r5|CA-9,800-53r5|SC-7,800-53r5|SC-7(5),CN-L3|7.1.2.2(c),CN-L3|8.1.10.6(j),CSCv7|9.2,CSCv8|4.4,CSCv8|4.5,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,ITSG-33|SC-7(5),LEVEL|1A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.1,TBA-FIISB|43.1"
  see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
  item        : "snmp-server community .*? RW"
</item>

<if>
  <condition type:"AND">
    <item>
      type        : CONFIG_CHECK
      description : "check if snmp-server is in use"
      item        : "snmp-server"
    </item>
  </condition>

  <then>
    <item>
      type        : CONFIG_CHECK
      description : "1.5.4 Set the ACL for each 'snmp-server community'"
      info        : "This feature specifies a list of IP addresses that are allowed to use the community string to gain access to the SNMP agent.

If ACLs are not applied, then anyone with a valid SNMP community string can potentially monitor and manage the router. An ACL should be defined and applied for all SNMP access to limit access to a small number of authorized management stations segmented in a trusted management zone. If possible, use SNMPv3 which uses authentication, authorization, and data privatization (encryption)."
      solution    : "Configure authorized SNMP community string and restrict access to authorized management systems.

IOSXR(config)#snmp-server community {community_string} RO IPv4 {snmp_access-list}

Impact:

To reduce the risk of unauthorized access, Organizations should enable access control lists for all snmp-server communities and restrict the access to appropriate trusted management zones. If possible, implement SNMPv3 to apply authentication, authorization, and data privatization (encryption) for additional benefits to the organization."
      reference   : "800-171|3.1.14,800-53|AC-17(3),800-53|SI-7,800-53r5|AC-17(3),800-53r5|SI-7,CN-L3|8.1.4.4(c),CN-L3|8.1.10.6(i),CSCv7|11.7,CSCv8|12.8,CSF|PR.AC-3,CSF|PR.DS-6,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(c)(1),HIPAA|164.312(c)(2),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17(3),ITSG-33|SI-7,ITSG-33|SI-7a.,LEVEL|1A,NESA|T3.4.1,NESA|T5.4.6,NESA|T7.3.2,NESA|T7.3.3,PCI-DSSv3.2.1|10.5.5,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
      regex       : "snmp-server community .* IPv4 .+$"
      item        : "snmp-server community"
    </item>
  </then>

  <else>
    <report type:"PASSED">
      description : "1.5.4 Set the ACL for each 'snmp-server community'"
      info        : "This feature specifies a list of IP addresses that are allowed to use the community string to gain access to the SNMP agent.

If ACLs are not applied, then anyone with a valid SNMP community string can potentially monitor and manage the router. An ACL should be defined and applied for all SNMP access to limit access to a small number of authorized management stations segmented in a trusted management zone. If possible, use SNMPv3 which uses authentication, authorization, and data privatization (encryption)."
      solution    : "Configure authorized SNMP community string and restrict access to authorized management systems.

IOSXR(config)#snmp-server community {community_string} RO IPv4 {snmp_access-list}

Impact:

To reduce the risk of unauthorized access, Organizations should enable access control lists for all snmp-server communities and restrict the access to appropriate trusted management zones. If possible, implement SNMPv3 to apply authentication, authorization, and data privatization (encryption) for additional benefits to the organization."
      reference   : "800-171|3.1.14,800-53|AC-17(3),800-53|SI-7,800-53r5|AC-17(3),800-53r5|SI-7,CN-L3|8.1.4.4(c),CN-L3|8.1.10.6(i),CSCv7|11.7,CSCv8|12.8,CSF|PR.AC-3,CSF|PR.DS-6,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(c)(1),HIPAA|164.312(c)(2),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17(3),ITSG-33|SI-7,ITSG-33|SI-7a.,LEVEL|1A,NESA|T3.4.1,NESA|T5.4.6,NESA|T7.3.2,NESA|T7.3.3,PCI-DSSv3.2.1|10.5.5,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
    </report>
  </else>
</if>

<if>
  <condition type:"AND">
    <item>
      type        : CONFIG_CHECK
      description : "check if snmp-server is in use"
      item        : "snmp-server"
    </item>
  </condition>

  <then>
    <item>
      type        : CONFIG_CHECK
      description : "1.5.5 Set 'snmp-server host' when using SNMP"
      info        : "SNMP notifications can be sent as traps to authorized management systems.

If SNMP is enabled for device management and device alerts are required, then ensure the device is configured to submit traps only to authorize management systems."
      solution    : "Configure authorized SNMP trap community string and restrict sending messages to authorized management systems.

IOSXR(config)#snmp-server host {ip_address} version {snmp_version} {encryption-type} {trap_community_string}

Impact:

Organizations using SNMP should restrict sending SNMP messages only to explicitly named systems to reduce unauthorized access."
      reference   : "800-171|3.1.14,800-53|AC-17(3),800-53|SI-7,800-53r5|AC-17(3),800-53r5|SI-7,CN-L3|8.1.4.4(c),CN-L3|8.1.10.6(i),CSCv7|11.7,CSCv8|12.8,CSF|PR.AC-3,CSF|PR.DS-6,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(c)(1),HIPAA|164.312(c)(2),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17(3),ITSG-33|SI-7,ITSG-33|SI-7a.,LEVEL|1A,NESA|T3.4.1,NESA|T5.4.6,NESA|T7.3.2,NESA|T7.3.3,PCI-DSSv3.2.1|10.5.5,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
      item        : "snmp-server host"
    </item>
  </then>

  <else>
    <report type:"PASSED">
      description : "1.5.5 Set 'snmp-server host' when using SNMP"
      info        : "SNMP notifications can be sent as traps to authorized management systems.

If SNMP is enabled for device management and device alerts are required, then ensure the device is configured to submit traps only to authorize management systems."
      solution    : "Configure authorized SNMP trap community string and restrict sending messages to authorized management systems.

IOSXR(config)#snmp-server host {ip_address} version {snmp_version} {encryption-type} {trap_community_string}

Impact:

Organizations using SNMP should restrict sending SNMP messages only to explicitly named systems to reduce unauthorized access."
      reference   : "800-171|3.1.14,800-53|AC-17(3),800-53|SI-7,800-53r5|AC-17(3),800-53r5|SI-7,CN-L3|8.1.4.4(c),CN-L3|8.1.10.6(i),CSCv7|11.7,CSCv8|12.8,CSF|PR.AC-3,CSF|PR.DS-6,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(c)(1),HIPAA|164.312(c)(2),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17(3),ITSG-33|SI-7,ITSG-33|SI-7a.,LEVEL|1A,NESA|T3.4.1,NESA|T5.4.6,NESA|T7.3.2,NESA|T7.3.3,PCI-DSSv3.2.1|10.5.5,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
    </report>
  </else>
</if>

<if>
  <condition type:"AND">
    <item>
      type        : CONFIG_CHECK
      description : "Check to see if snmp-server is enabled"
      item        : "snmp-server"
    </item>
  </condition>

  <then>
    <item>
      type        : CONFIG_CHECK
      description : "1.5.6 Set 'snmp-server enable traps snmp'"
      info        : "SNMP notifications can be sent as traps to authorized management systems.

SNMP has the ability to submit traps ."
      solution    : "Enable SNMP traps.

IOSXR(config)#snmp-server traps snmp authentication

Impact:

Organizations using SNMP should restrict trap types only to explicitly named traps to reduce unintended traffic. Enabling SNMP traps without specifying trap type will enable all SNMP trap types."
      reference   : "800-171|3.1.14,800-53|AC-17(3),800-53|SI-7,800-53r5|AC-17(3),800-53r5|SI-7,CN-L3|8.1.4.4(c),CN-L3|8.1.10.6(i),CSCv7|11.7,CSCv8|12.8,CSF|PR.AC-3,CSF|PR.DS-6,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(c)(1),HIPAA|164.312(c)(2),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17(3),ITSG-33|SI-7,ITSG-33|SI-7a.,LEVEL|1A,NESA|T3.4.1,NESA|T5.4.6,NESA|T7.3.2,NESA|T7.3.3,PCI-DSSv3.2.1|10.5.5,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
      item        : "snmp-server traps snmp"
    </item>
  </then>

  <else>
    <report type:"PASSED">
      description : "1.5.6 Set 'snmp-server enable traps snmp'"
      info        : "SNMP notifications can be sent as traps to authorized management systems.

SNMP has the ability to submit traps ."
      solution    : "Enable SNMP traps.

IOSXR(config)#snmp-server traps snmp authentication

Impact:

Organizations using SNMP should restrict trap types only to explicitly named traps to reduce unintended traffic. Enabling SNMP traps without specifying trap type will enable all SNMP trap types."
      reference   : "800-171|3.1.14,800-53|AC-17(3),800-53|SI-7,800-53r5|AC-17(3),800-53r5|SI-7,CN-L3|8.1.4.4(c),CN-L3|8.1.10.6(i),CSCv7|11.7,CSCv8|12.8,CSF|PR.AC-3,CSF|PR.DS-6,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(c)(1),HIPAA|164.312(c)(2),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17(3),ITSG-33|SI-7,ITSG-33|SI-7a.,LEVEL|1A,NESA|T3.4.1,NESA|T5.4.6,NESA|T7.3.2,NESA|T7.3.3,PCI-DSSv3.2.1|10.5.5,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
    </report>
  </else>
</if>

<item>
  type        : CONFIG_CHECK
  description : "1.6.1 Disable Telnet Access"
  info        : "Telnet is a clear-text administrative protocol. As such, both the credentials used to establish the session and all commands and data within the session are readable in clear-text, so can be intercepted or modified by an attacker

Telnet doesn't natively support encryption or message integrity checks. Hence, any transmitted information (including credentials) is exposed to an attacker that gains access to the communication. Furthermore communication could be intercepted and modified by a man-in-the-middle attacker."
  solution    : "It's recommended to restrict VTYs to SSH for management access and not allow this device to SSH to other devices:

vty-pool default 0 4 line-template default
line default
 transport input ssh
 transport output none

Impact:

Ensure you have already configured an alternative management access to the device before disabling telnet access. Otherwise you might be locked out of the device with no management access."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-171|3.7.5,800-53|CM-7,800-53|MA-4,800-53r5|CM-7,800-53r5|MA-4,CSCv8|4.6,CSF|PR.IP-1,CSF|PR.MA-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,ITSG-33|MA-4,LEVEL|1A,NESA|T2.3.4,NESA|T5.4.4,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3,TBA-FIISB|45.2.3"
  see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
  context     : "line default"
  item        : "transport input (ssh|none)"
</item>

<if>
  <condition auto:"FAILED" type:"AND">
    <item>
      type        : CONFIG_CHECK
      description : "check for vty-pool use"
      item        : "vty-pool"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "check for ACL use"
      context     : "line default"
      item        : "access-class ingress @VTY_ACL@"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "check for ACL definition"
      item        : "ipv4 access-list @VTY_ACL@"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "check whether acls are applied to ssh server"
      item        : "ssh server .* ipv4 access-list @VTY_ACL@"
    </item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "1.6.2 Restrict VTY Access"
      info        : "VTY access can be restricted via access-lists to limit from which the source addresses a management session to the device can be established.

VTY ACLs control what addresses may attempt to log in to the router. Configuring VTY lines to use an ACL, restricts the sources where a user can manage the device. You should limit the specific host(s) and or network(s) authorized to connect to and configure the device, via an approved protocol, to those individuals or systems authorized to administer the device. For example, you could limit access to specific hosts, so that only network managers can configure the devices only by using specific network management workstations. Make sure you configure all VTY lines to use the same ACL."
      solution    : "Define ACLs which match the allowed sources. To restrict access of incoming or outgoing connections over IPv4 and IPv6, the IPv4 access list and IPv6 access list must share the same name:

ipv4 access-list ACL-VTY-IN
 10 permit ipv4 192.168.1.0/24 any
 1000 deny ipv4 any any log icmp-off
ipv6 access-list ACL-VTY-IN
 10 permit ipv6 2001:db8::/64 any
 1000 deny any any log icmp-off

Apply the ACL on the line template:

vty-pool default 0 4 line-template default
line default
 access-class ingress ACL-VTY-IN

Alternatively you can implement restrictions on the SSH Server which allows both IPv4 and IPv6. Note that SSH could be also used for Netconf, so the ACL might need to include additional sources which do not apply for VTY access only.

ssh server ipv4 access-list ACL-VTY-IN ipv6 access-list ACL-VTY-IN

Impact:

You can potentially lock yourself out, we recommend using commit confirmed when implementing the changes.

Using VTY lines without access-lists opens up the attack surface because any source IP can establish a connection to the device. This could be exploited by an attacker to create DoS condition."
      reference   : "800-171|3.1.14,800-53|AC-17(3),800-53|SI-7,800-53r5|AC-17(3),800-53r5|SI-7,CN-L3|8.1.4.4(c),CN-L3|8.1.10.6(i),CSCv7|11.7,CSCv8|12.8,CSF|PR.AC-3,CSF|PR.DS-6,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(c)(1),HIPAA|164.312(c)(2),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17(3),ITSG-33|SI-7,ITSG-33|SI-7a.,LEVEL|1A,NESA|T3.4.1,NESA|T5.4.6,NESA|T7.3.2,NESA|T7.3.3,PCI-DSSv3.2.1|10.5.5,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
      show_output : YES
    </report>
  </then>
</if>

<item>
  type        : CONFIG_CHECK
  description : "1.6.3 Ensure Exec Timeout for Console Sessions is set"
  info        : "Verify device is configured to automatically disconnect console sessions after a defined maximum session time, set in minutes.

Note there are 3 different timeout values:

 -

absolute-timeout: terminate the connection after the specified time has elapsed, regardless of whether the connection is being used at the time of termination.

 -

exec-timeout: If no user input is detected during the interval, the EXEC facility returns the terminal to the idle state and disconnects the incoming session

 -

session-timeout: Traditionally the VTY can be used for other features than EXEC (CLI), e.g. terminal server, PAD, async lines etc. The session-timeout applies to any sessions running to/through the router on VTY. Use the session-timeout command to set the interval that the Cisco IOS XR software waits for traffic before closing the connection to a remote device and returning the terminal to an idle state.

For management access we need to configure the exec-timeout.

This prevents unauthorized users from misusing abandoned sessions. For example, if the network administrator disconnects leaving a console session open, that session will remain open (in the same state and privilege level) for the next person who connects a console cable to the device.

A shorter timeout is usually desired, but this can be extended for longer-running operations such as debug sessions or software upgrades."
  solution    : "vty-pool default 0 4 line-template default
line default
 exec-timeout 10 0

Impact:

10 minutes is the default exec-timeout for many Cisco Network Operating systems. You should determine the best value for your organization and your work habits."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-171|3.7.5,800-53|CM-7,800-53|MA-4,800-53r5|CM-7,800-53r5|MA-4,CSCv8|4.6,CSF|PR.IP-1,CSF|PR.MA-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,ITSG-33|MA-4,LEVEL|1A,NESA|T2.3.4,NESA|T5.4.4,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3,TBA-FIISB|45.2.3"
  see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
  context     : "line default"
  item        : "exec-timeout @EXEC_TIMEOUT@ 0"
</item>

<item>
  type        : BANNER_CHECK
  description : "1.7.1 Pre-authentication Banner"
  info        : "A pre-authentication banner is displayed when a terminal connects, before a login occurs. This banner is useful for sending messages that affect all users (such as impending system shutdowns). This banner can also be used to notify unauthorized users of any penalties to accessing the device, or any logging that may be configured.

Network banners are electronic messages that provide notice of legal rights to users of computer networks. From a legal standpoint, banners have following primary functions.

 - Banners may be used to generate consent to real-time monitoring under

ECPA

Title III.
 - Banners may be used to generate consent to the retrieval of stored files and records pursuant to

ECPA

.
 - in the case of government networks, banners may eliminate any Fourth Amendment \"reasonable expectation of privacy\" that government employees or other users might otherwise retain in their use of the government's network under O'Connor v. Ortega, 480 U.S. 709 (1987).
 - In the case of a non-government network, banners may establish a system administrator's \"common authority\" to consent to a law enforcement search pursuant to United States v. Matlock, 415 U.S. 164 (1974).\" (US Department of Justice APPENDIX A: Sample Network Banner Language)

In your country different laws might apply. Please consult with your corporate legal team to assess the exact legal context and rules for banners."
  solution    : "Configure a login banner as shown below. The delimiter character shown is a \"^\", but any character can serve as a delimiter.

IOSXR(config)# banner login ^ {login_banner} ^

Impact:

Organizations provide appropriate legal notice(s) and warning(s) to persons accessing their networks by using a 'banner-text'."
  reference   : "800-171|3.1.16,800-171|3.1.17,800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|AC-18,800-53|AC-18(1),800-53|AC-18(3),800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53r5|AC-18,800-53r5|AC-18(1),800-53r5|AC-18(3),800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,CSCv7|5.1,CSCv7|11.1,CSCv8|4.2,CSF|DE.AE-1,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-18,ITSG-33|AC-18(1),ITSG-33|AC-18(3),ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,LEVEL|1A,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T5.4.2,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NIAv2|NS33,NIAv2|NS34,NIAv2|NS38,NIAv2|SS15a,NIAv2|SS16,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3"
  see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
  item        : "banner login"
  content     : "@BANNER_LOGIN@"
</item>

<item>
  type        : BANNER_CHECK
  description : "1.7.2 Post-authentication Banner"
  info        : "A post-authentication banner is displayed to the user after a successful login. It can also serve as a legal notice to authorized users of the equipment to notify them of any logging that may be configured.

This banner is not appropriate to notify unauthorized users of any penalties to accessing the device, because after successful login corresponding laws might have already been violated.

A post-authentication banner can often also hold asset-specific information, such as:

 - The primary technical contacts for the equipment
 - Location or environment information - for instance the street address or rack number or production / test / lab environment
 - The purchase date
 - The asset tag information for the device
 - Any upstream circuit numbers
 - Carrier or ISP support phone numbers
 - Any other asset-specific information that may be important to the organization

Post-authentication banners can be used to reduce the risk of human error. For example by highlighting the current environment (Production or Lab)."
  solution    : "Configure an exec banner as shown below. The delimiter character shown is a \"^\", but any character can serve as a delimiter.

IOSXR(config)# banner exec ^ {exec_banner} ^

Impact:

Organizations provide appropriate notice(s) and warning(s) to persons accessing their networks by using a 'banner-text'."
  reference   : "800-171|3.1.16,800-171|3.1.17,800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|AC-18,800-53|AC-18(1),800-53|AC-18(3),800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53r5|AC-18,800-53r5|AC-18(1),800-53r5|AC-18(3),800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,CSCv7|5.1,CSCv7|11.1,CSCv8|4.2,CSF|DE.AE-1,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-18,ITSG-33|AC-18(1),ITSG-33|AC-18(3),ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,LEVEL|1A,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T5.4.2,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NIAv2|NS33,NIAv2|NS34,NIAv2|NS38,NIAv2|SS15a,NIAv2|SS16,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3"
  see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
  item        : "banner exec"
  content     : "@BANNER_EXEC@"
</item>

<item>
  type        : CONFIG_CHECK
  description : "1.8.2 Set username secret for all local users"
  info        : "A root-system user with a normal password will not be authenticated because the normal password is two-way encrypted and poses a security risk because the password information is stored in the flash disk, which can be easily decrypted.Secrets are one-way encrypted and cannot be easily reverted without brute-forcing.

If both secret and password are configured for a user, then secret takes precedence, and password security policy does not have any effect on authentication or change of password for such users.

Secrets use a one-way cryptographic hash."
  solution    : "IOSXR# configure
IOSXR(config)#username {local_username}
IOSXR(config)#secret {local_password}

commit

Impact:

Typically the username and secret are defined during initial setup. Make sure to use strong passwords or update it later accordingly."
  reference   : "800-171|3.1.5,800-171|3.1.6,800-53|AC-6(2),800-53|AC-6(5),800-53r5|AC-6(2),800-53r5|AC-6(5),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSCv8|5.4,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.3,ITSG-33|AC-6(2),ITSG-33|AC-6(5),LEVEL|1M,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.6.1,NIAv2|AM1,NIAv2|AM23f,NIAv2|AM32,NIAv2|AM33,NIAv2|SS13c,NIAv2|SS15c,NIAv2|VL3a,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
  see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
  context     : "username .*"
  item        : "secret .*"
</item>

<if>
  <condition auto:"FAILED" type:"AND">
    <item>
      type        : CONFIG_CHECK
      description : "check for ntp server 1"
      context     : "ntp"
      item        : "server @NTP_SERVER_1@"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "check for ntp server 2"
      context     : "ntp"
      item        : "server @NTP_SERVER_2@"
    </item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "2.2.2 Set 'ip address' for 'ntp server'"
      info        : "Use this command if you want to allow the system to synchronize the system software clock with the specified NTP server.

To ensure that the time on your Cisco router is consistent with other devices in your network, at least two (and preferably at least three) NTP Server/s external to the router should be configured.

Ensure you also configure consistent timezone and daylight savings time setting for all devices. For simplicity, the default of Coordinated Universal Time (UTC)."
      solution    : "Configure theexternal NTP Server using the following commands

IOSXR(config)#ntp server {ntp-server_ip_address} key {ntp_key_id}

Impact:

Organizations should establish multiple Network Time Protocol (NTP) hosts to set consistent time across the enterprise. Enabling the 'ntp server ip address' enforces encrypted authentication between NTP hosts."
      reference   : "800-171|3.3.6,800-171|3.3.7,800-53|AU-7,800-53|AU-8,800-53r5|AU-7,800-53r5|AU-8,CN-L3|7.1.2.3(c),CN-L3|8.1.4.3(b),CSCv7|6.1,CSCv8|8.4,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-7,ITSG-33|AU-8,LEVEL|1A,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4,TBA-FIISB|37.4"
      see_also    : "https://workbench.cisecurity.org/benchmarks/10473"
      show_output : YES
    </report>
  </then>
</if>

</check_type>
