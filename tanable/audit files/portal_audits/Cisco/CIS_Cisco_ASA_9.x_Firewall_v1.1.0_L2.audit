#TRUSTED 8d844289a8ed0338685c624aa0add3d35e09ddefbb357f3c40c79be23b06ee2c45ab0ff145e2e7c03c2857267e9cc192f0247561f354547c87e62b3cfdb2b90854b020a061637cc7e6cb32642e7b4a65856da8e8fa61747d7937b4ebda96aba4ff72bf9ea781669aca8722e1e2e8f86b6fc7af45a7ee6ea11824b6d32f5ba69f9256c38fd5e77c6958b4eff37624e3257448199adfcb99325d63b1e7700380f3fed350584e9525b401a5df6ee944a03a7ac26ddc3ee28bff488ff8ece70c46f5696b6b60f5b73f78577976fd50034cc709981993ba678fd3c5399422f4b0ad04d12f382f80d08273037b399c5294ec7a256e3a74ebfa887d34272bfd9217da31f063276b15896a500fbdc6fce466be2720b07a99ebd358bbf33714abde63fb8ca100c638259a1a43138affe88a7d1d374cec9e21e89baf8db0ddd0fb3524bf6dc85ef2010ce53f54c027f771154f7674442d4cbdb3b2c274dc88600810e00a72da50a238151a19dd30f2aed29979fb64e9c18cc77e4b6ebf16fe9a837ee4640038fe4a3e853adec7c4831863427c1431864c54b2fcfe120925712c6d0b38203d12dec5e52f68ef6f6d9b2125b3dffb2a2e6daf9573069d0ec01b211ff167ac0d268db59d3f378b938b14c42ea3b745a12b80bd1dc81de9760aad19d9642f6a52424b13241adb42366e4248321b74d0490b758c66f3629bd73d21bf7b29c4c9e1
#TRUST-RSA-SHA256 391fbda30d78bbbbda7de95228b0fde8d073bab0813fad77f70a12e9959053efdecb9ebf982e9c36d712cc093f440a3fdc5df37d9633968f2bdd433baa02e6615c2912b46bd39ed9abf7f4dcc9fea7d14a3d0f33f1c78e1dcfa4c26c7700a067cada05e434dafcda6ca6750a19912a89f6576ac96a1bbe8773f75b2aa8142fceafe54b18b6e532aa6c50b312357ae0b8f44380942c03d8e223dc4d984a0bd9d3453546e578dbc5999395d7bf2bbc4618653bf5a347f247ca9fd8c92a74408ed7d39a2248aeef0adf870373a41c998dfb12c10e913ace8512a048ca5fc14552199db702741fbe5db5287bf63ae8e30766abdf271bb7a0f73bde9b5ec4990fff70140b5a749f100dccbcc939955f8fd5e8a655822b3b24476d22bb7a02e47bc642a91aa24c4a495b4164eae86fd1582562477667feef61cf8864f91b1bea60d23a691b09cf1a02549892c6abb68daecabfa05ef34fabadb99e138036a8ed2420401e3827b354eb02ac062fd86355cb6e8c3f6f9a298c760a521a3fa0a6da2d5e06225a51daeead0d20513e856f01761114c85b5d6701f2c096f1c26e7032714704d5f86486f2270e9bee7a8a8f051e7ca59274087bf67fe00a21c160a06950cc10bd6015b8f73cf935122b7e4689ef30080d88f8a106921ba99ece6f59292068024df4286e31db45891930cd0707c8bafde80faa20287754018c53002c16e83162
#
# This script is Copyright (C) 2004-2024 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
#
# $Revision: 1.0 $
# $Date: 2024/06/17 $
#
# Description   : This .audit is designed against the CIS Benchmark for Cisco ASA 9.x Firewall Benchmark v1.1.0.
#
#<ui_metadata>
#<display_name>CIS Cisco ASA 9.x Firewall L2 v1.1.0</display_name>
#<spec>
#  <type>CIS</type>
#  <name>Cisco Firewall ASA 9</name>
#  <profile>L2</profile>
#  <version>1.1.0</version>
#  <link>https://workbench.cisecurity.org/benchmarks/7194</link>
#</spec>
#<labels>cisco,cis,firewall</labels>
#<benchmark_refs>CCE,CSCv6,CSCv7,CSCv8,LEVEL</benchmark_refs>
#<variables>
#  <variable>
#    <name>PLATFORM_VERSION</name>
#    <default>9</default>
#    <description>Cisco ASA version</description>
#    <info>The Cisco ASA found on the target host.</info>
#    <value_type>STRING</value_type>
#  </variable>
#</variables>
#</ui_metadata>

<check_type:"Cisco">

<if>
  <condition type:"AND">
    <item>
      type        : CONFIG_CHECK
      description : "Check if Cisco ASA 9 is installed"
      item        : "^ASA Version @PLATFORM_VERSION@"
    </item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "CIS_Cisco_ASA_9.x_Firewall_v1.1.0_L2.audit from CIS Cisco ASA 9.x Firewall Benchmark v1.1.0"
      see_also    : "https://workbench.cisecurity.org/benchmarks/7194"
    </report>

    <if>
      <condition auto:"FAILED" type:"AND">
        <item>
          type        : CONFIG_CHECK
          description : "protocol"
          item        : "aaa-server [^ ]+ protocol [^ ]+"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "host"
          item        : "aaa-server [^ ]+ host [^ ]+"
        </item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "1.4.2.1 Ensure 'TACACS+/RADIUS' is configured correctly"
          info        : "Specifies the AAA server-group and each individual server using the TACACS+ or RADIUS protocol

Rationale:

Authentication, authorization and accounting (AAA) scheme provide an authoritative source for managing and monitoring access for devices. Many protocols are supported for the communication between the systems and the AAA servers: http-form, kerberos, ldap, nt, radius, sdi, tacacs+."
          solution    : "Step 1: Acquire the enterprise standard protocol (protocol_name) for authentication (TACACS+ or RADIUS)

Step 2: Run the following to configure the AAA server-group for the required protocol

hostname(config)#aaa-server <server-group_name> protocol <protocol_name>

Step 3: Run the following to configure the AAA server:

hostname(config)#aaa-server <server-group_name> (<interface_name>) host <aaa-server_ip> <shared_key>

server-group_name: the above server-group configured
interface_name: the network interface from which the AAA server will be accessed
aaa-server_ip: the IP address of the AAA server
shared_key: the TACACS+ or RADIUS shared key

Default Value:

The AAA server configuraton is by default disabled"
          reference   : "800-171|3.1.16,800-171|3.1.17,800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|AC-18,800-53|AC-18(1),800-53|AC-18(3),800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53r5|AC-18,800-53r5|AC-18(1),800-53r5|AC-18(3),800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,CSCv7|4.3,CSCv8|4.2,CSF|DE.AE-1,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-18,ITSG-33|AC-18(1),ITSG-33|AC-18(3),ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,LEVEL|2A,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T5.4.2,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NIAv2|NS33,NIAv2|NS34,NIAv2|NS38,NIAv2|SS15a,NIAv2|SS16,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3"
          see_also    : "https://workbench.cisecurity.org/benchmarks/7194"
          show_output : YES
        </report>
      </then>
    </if>

    <item>
      type        : CONFIG_CHECK
      description : "1.6.3 Ensure 'RSA key pair' is greater than or equal to 2048 bits"
      info        : "Generates an RSA key pair used by SSH protocol of at least 2048 bits

Rationale:

Secure Shell (SSH) is a secure remote-login protocol. The ASA allows SSH connections to the ASA for management purposes and supports the SSH DES and 3DES ciphers. SSH uses a key-exchange method based on Rivest-Shamir-Adleman (RSA) public-key. Since RSA 1024-bit keys are likely to become crackable, it is recommended to have RSA keys of at least 2048 bits."
      solution    : "Step 1: Acquire the enterprise standard RSA key size greater or equal than 2048 bits

Step 2: If the audit procedure revealed existing non-compliant key pairs, run the following to remove them:

hostname(config)#crypto key zeroize rsa

Step 3: Run the following to generate compliant RSA key pair:

hostname(config)# crypto key generate rsa modulus <enterprise_RSA_key_size>

Step 4: Run the following to save the RSA keys to persistent Flash memory

hostname(config)#write memory"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-171|3.13.5,800-53|CM-7,800-53|CP-6,800-53|CP-7,800-53|PL-8,800-53|PM-7,800-53|SA-8,800-53|SC-7,800-53r5|CM-7,800-53r5|CP-6,800-53r5|CP-7,800-53r5|PL-8,800-53r5|PM-7,800-53r5|SA-8,800-53r5|SC-7,CN-L3|8.1.10.6(j),CSCv7|11.1,CSCv8|12.2,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-4,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.c,GDPR|32.1.d,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|CM-7,ITSG-33|CP-6,ITSG-33|CP-7,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SC-7,LEVEL|2A,NESA|T2.2.4,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.6.5,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|SS3,NIAv2|SS15a,NIAv2|VL2,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,SWIFT-CSCv1|2.3,TBA-FIISB|43.1"
      see_also    : "https://workbench.cisecurity.org/benchmarks/7194"
      cmd         : "show crypto key mypubkey rsa | include _Modulus_Size_.bits"
      item        : "Modulus Size \\(bits\\): 2048"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "1.6.4 Ensure 'SCP protocol' is set to Enable for files transfers"
      info        : "Enables Secure Copy protocol

Rationale:

FTP and TFTP are protocols that transfer data in clear text across the network and thus are vulnerable to packet sniffing. Files and mostly configuration files should be transferred using secure protocols such as HTTPS or SCP."
      solution    : "Run the following command to enable secure copy

hostname(config)# ssh scopy enable"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-171|3.7.5,800-53|CM-7,800-53|MA-4,800-53r5|CM-7,800-53r5|MA-4,CSCv7|11.1,CSCv8|4.6,CSF|PR.IP-1,CSF|PR.MA-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,ITSG-33|MA-4,LEVEL|2A,NESA|T2.3.4,NESA|T5.4.4,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3,TBA-FIISB|45.2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/7194"
      item        : "ssh scopy enable"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "1.7.1 Ensure 'HTTP source restriction' is set to an authorized IP address"
      info        : "Determines the client IP addresses that are allowed to connect to the security appliance through HTTP

Rationale:

One key element of securing the network is the security of management access to the infrastructure devices. It is critical to establish the appropriate controls in order to prevent unauthorized access to infrastructure devices. One of them is permitting only authorized originators to attempt device management access. This ensures that the processing of access requests is restricted to an authorized source IP address, thus reducing the risk of unauthorized access and the exposure to other attacks, such as brute force, dictionary, or DoS attacks."
      solution    : "Run the following to enable HTTP access source restriction

hostname(config)#http <source_ip> <source_netmask> <interface_name>"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-171|3.7.5,800-53|CM-7,800-53|MA-4,800-53r5|CM-7,800-53r5|MA-4,CSCv7|11.1,CSCv8|4.6,CSF|PR.IP-1,CSF|PR.MA-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,ITSG-33|MA-4,LEVEL|2A,NESA|T2.3.4,NESA|T5.4.4,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3,TBA-FIISB|45.2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/7194"
      item        : "http [0-9]+.*"
    </item>

    <if>
      <condition type:"AND">
        <item>
          type        : CONFIG_CHECK
          description : "Check if OSPF is enabled"
          item        : "router ospf"
        </item>
      </condition>

      <then>
        <item>
          type        : CONFIG_CHECK
          description : "2.1.1 Ensure 'OSPF authentication' is enabled"
          info        : "Enables the authentication of OSPF neighbor before routing information is received from the neighbor

Rationale:

Enabling the routing protocol authentication prevents against attackers who can send wrong routing information in order to redirect traffic to their network or send malformed packets in order to saturate and to exhaust the control plane."
          solution    : "Step 1: Acquire the interface <interface_name> used by the firewall to receive OSPF routing updates and the area ID <area_id>

Step 2: Agree with the neighbor device on the authencation key <key_value> and determine an authentication key ID <key_id>

Step 3: Run the following to enable OSPF authentication

hostname(config)#interface <interface_name>
hostname(config-if)#ospf authentication message-digest
hostname(config-if)#ospf message-digest-key <key_id> md5 <key_value>
hostname(config-if)#exit
hostname(config)#area <area_id> authentication message-digest

Default Value:

Disabled by default"
          reference   : "800-171|3.1.1,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-171|3.13.5,800-53|AC-2(1),800-53|CM-7,800-53|CP-6,800-53|CP-7,800-53|PL-8,800-53|PM-7,800-53|SA-8,800-53|SC-7,800-53r5|AC-2(1),800-53r5|CM-7,800-53r5|CP-6,800-53r5|CP-7,800-53r5|PL-8,800-53r5|PM-7,800-53r5|SA-8,800-53r5|SC-7,CN-L3|7.1.3.2(d),CN-L3|8.1.10.6(j),CSCv7|11.1,CSCv8|12.2,CSCv8|12.5,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-4,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.c,GDPR|32.1.d,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.13.1.3,ITSG-33|AC-2(1),ITSG-33|CM-7,ITSG-33|CP-6,ITSG-33|CP-7,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SC-7,LEVEL|2A,NESA|T2.2.4,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.6.5,NIAv2|AM28,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|NS5j,NIAv2|SS3,NIAv2|SS14e,NIAv2|SS15a,NIAv2|VL2,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|2.3,TBA-FIISB|43.1"
          see_also    : "https://workbench.cisecurity.org/benchmarks/7194"
          item        : "ospf message-digest-key .+"
        </item>
      </then>

      <else>
        <item>
          type        : CONFIG_CHECK_NOT
          description : "2.1.1 Ensure 'OSPF authentication' is enabled"
          info        : "Enables the authentication of OSPF neighbor before routing information is received from the neighbor

Rationale:

Enabling the routing protocol authentication prevents against attackers who can send wrong routing information in order to redirect traffic to their network or send malformed packets in order to saturate and to exhaust the control plane."
          solution    : "Step 1: Acquire the interface <interface_name> used by the firewall to receive OSPF routing updates and the area ID <area_id>

Step 2: Agree with the neighbor device on the authencation key <key_value> and determine an authentication key ID <key_id>

Step 3: Run the following to enable OSPF authentication

hostname(config)#interface <interface_name>
hostname(config-if)#ospf authentication message-digest
hostname(config-if)#ospf message-digest-key <key_id> md5 <key_value>
hostname(config-if)#exit
hostname(config)#area <area_id> authentication message-digest

Default Value:

Disabled by default"
          reference   : "800-171|3.1.1,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-171|3.13.5,800-53|AC-2(1),800-53|CM-7,800-53|CP-6,800-53|CP-7,800-53|PL-8,800-53|PM-7,800-53|SA-8,800-53|SC-7,800-53r5|AC-2(1),800-53r5|CM-7,800-53r5|CP-6,800-53r5|CP-7,800-53r5|PL-8,800-53r5|PM-7,800-53r5|SA-8,800-53r5|SC-7,CN-L3|7.1.3.2(d),CN-L3|8.1.10.6(j),CSCv7|11.1,CSCv8|12.2,CSCv8|12.5,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-4,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.c,GDPR|32.1.d,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.13.1.3,ITSG-33|AC-2(1),ITSG-33|CM-7,ITSG-33|CP-6,ITSG-33|CP-7,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SC-7,LEVEL|2A,NESA|T2.2.4,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.6.5,NIAv2|AM28,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|NS5j,NIAv2|SS3,NIAv2|SS14e,NIAv2|SS15a,NIAv2|VL2,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|2.3,TBA-FIISB|43.1"
          see_also    : "https://workbench.cisecurity.org/benchmarks/7194"
          item        : "router ospf"
        </item>
      </else>
    </if>

    <if>
      <condition type:"AND">
        <item>
          type        : CONFIG_CHECK
          description : "Check if EIGRP is enabled"
          item        : "router eigrp"
        </item>
      </condition>

      <then>
        <item>
          type        : CONFIG_CHECK
          description : "2.1.2 Ensure 'EIGRP authentication' is enabled"
          info        : "Enables the authentication of EIGRP neighbor before routing information is received from the neighbor

Rationale:

Enabling the routing protocol authentication prevents against attackers who can send wrong routing information in order to redirect traffic to their network or send malformed packets in order to saturate and to exhaust the control plane."
          solution    : "Step 1: Acquire the interface <interface_name> used by the firewall to receive EIGRP routing updates and the EIGRP Autonomous System number <as_number>

Step 2: Agree with the neighbor device on the authencation key <key_value> and determine an authentication key ID <key_id>

Step 3: Run the following to enable RIP authentication

hostname(config)#interface <interface_name>
hostname(config-if)#authentication mode eigrp <as_number> md5
hostname(config-if)#authentication key eigrp <as_number> <key_value> key-id <key_id>

Default Value:

Disabled by default"
          reference   : "800-171|3.1.1,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-171|3.13.5,800-53|AC-2(1),800-53|CM-7,800-53|CP-6,800-53|CP-7,800-53|PL-8,800-53|PM-7,800-53|SA-8,800-53|SC-7,800-53r5|AC-2(1),800-53r5|CM-7,800-53r5|CP-6,800-53r5|CP-7,800-53r5|PL-8,800-53r5|PM-7,800-53r5|SA-8,800-53r5|SC-7,CN-L3|7.1.3.2(d),CN-L3|8.1.10.6(j),CSCv7|11.1,CSCv8|12.2,CSCv8|12.5,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-4,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.c,GDPR|32.1.d,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.13.1.3,ITSG-33|AC-2(1),ITSG-33|CM-7,ITSG-33|CP-6,ITSG-33|CP-7,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SC-7,LEVEL|2A,NESA|T2.2.4,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.6.5,NIAv2|AM28,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|NS5j,NIAv2|SS3,NIAv2|SS14e,NIAv2|SS15a,NIAv2|VL2,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|2.3,TBA-FIISB|43.1"
          see_also    : "https://workbench.cisecurity.org/benchmarks/7194"
          item        : "authentication key eigrp .+"
        </item>
      </then>

      <else>
        <item>
          type        : CONFIG_CHECK_NOT
          description : "2.1.2 Ensure 'EIGRP authentication' is enabled"
          info        : "Enables the authentication of EIGRP neighbor before routing information is received from the neighbor

Rationale:

Enabling the routing protocol authentication prevents against attackers who can send wrong routing information in order to redirect traffic to their network or send malformed packets in order to saturate and to exhaust the control plane."
          solution    : "Step 1: Acquire the interface <interface_name> used by the firewall to receive EIGRP routing updates and the EIGRP Autonomous System number <as_number>

Step 2: Agree with the neighbor device on the authencation key <key_value> and determine an authentication key ID <key_id>

Step 3: Run the following to enable RIP authentication

hostname(config)#interface <interface_name>
hostname(config-if)#authentication mode eigrp <as_number> md5
hostname(config-if)#authentication key eigrp <as_number> <key_value> key-id <key_id>

Default Value:

Disabled by default"
          reference   : "800-171|3.1.1,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-171|3.13.5,800-53|AC-2(1),800-53|CM-7,800-53|CP-6,800-53|CP-7,800-53|PL-8,800-53|PM-7,800-53|SA-8,800-53|SC-7,800-53r5|AC-2(1),800-53r5|CM-7,800-53r5|CP-6,800-53r5|CP-7,800-53r5|PL-8,800-53r5|PM-7,800-53r5|SA-8,800-53r5|SC-7,CN-L3|7.1.3.2(d),CN-L3|8.1.10.6(j),CSCv7|11.1,CSCv8|12.2,CSCv8|12.5,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-4,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.c,GDPR|32.1.d,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.13.1.3,ITSG-33|AC-2(1),ITSG-33|CM-7,ITSG-33|CP-6,ITSG-33|CP-7,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SC-7,LEVEL|2A,NESA|T2.2.4,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.6.5,NIAv2|AM28,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|NS5j,NIAv2|SS3,NIAv2|SS14e,NIAv2|SS15a,NIAv2|VL2,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|2.3,TBA-FIISB|43.1"
          see_also    : "https://workbench.cisecurity.org/benchmarks/7194"
          item        : "router eigrp"
        </item>
      </else>
    </if>

    <item>
      type        : CONFIG_CHECK
      description : "2.1.3 Ensure 'BGP authentication' is enabled"
      info        : "BGP is an inter and intra autonomous system routing protocol. An autonomous system is a network or group of networks under a common administration and with common routing policies. BGP is used to exchange routing information for the Internet and is the protocol used between Internet service providers (ISP).

Rationale:

Customer networks, such as universities and corporations, usually employ an Interior Gateway Protocol (IGP) such as OSPF for the exchange of routing information within their networks. Customers connect to ISPs, and ISPs use BGP to exchange customer and ISP routes. When BGP is used between autonomous systems (AS), the protocol is referred to as External BGP (EBGP). If a service provider is using BGP to exchange routes within an AS, then the protocol is referred to as Interior BGP (IBGP).

BGP can also be used for carrying routing information for IPv6 prefix over IPv6 networks"
      solution    : "Step 1
Enable BGP.
Step 2
Define the Best Path for a BGP Routing Process.
Step 3
Configure Policy Lists.
Step 4
Configure AS Path Filters.
Step 5
Configure Community Rules.
Step 6
Configure IPv4 Address Family Settings.
Step 7
Configure IPv6 Address Family Settings.

ciscoasa#(config)router bgp 2
ciscoasa(config-router)# bgp default local-preference 500
ciscoasa(config)# policy-list Example-policy-list1 permit
ciscoasa(config)# as-path access-list 35 permit testaspath
ciscoasa(config)# community-list standard excomm1 permit 100 internet no-advertise no-export
ciscoasa(config-router-af)# bgp router-id 10.86.118.3
ciscoasa(config-router-af) aggregate-address 10.86.118.0 255.255.255.0 as-set summary-only suppress-map example1 advertise-map example1 attribute-map example1

Default Value:

not enabled"
      reference   : "800-171|3.1.1,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-171|3.13.5,800-53|AC-2(1),800-53|CM-7,800-53|CP-6,800-53|CP-7,800-53|PL-8,800-53|PM-7,800-53|SA-8,800-53|SC-7,800-53r5|AC-2(1),800-53r5|CM-7,800-53r5|CP-6,800-53r5|CP-7,800-53r5|PL-8,800-53r5|PM-7,800-53r5|SA-8,800-53r5|SC-7,CN-L3|7.1.3.2(d),CN-L3|8.1.10.6(j),CSCv7|11.1,CSCv8|12.2,CSCv8|12.5,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-4,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.c,GDPR|32.1.d,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.13.1.3,ITSG-33|AC-2(1),ITSG-33|CM-7,ITSG-33|CP-6,ITSG-33|CP-7,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SC-7,LEVEL|2A,NESA|T2.2.4,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.6.5,NIAv2|AM28,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|NS5j,NIAv2|SS3,NIAv2|SS14e,NIAv2|SS15a,NIAv2|VL2,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|2.3,TBA-FIISB|43.1"
      see_also    : "https://workbench.cisecurity.org/benchmarks/7194"
      item        : "router bgp .+"
      required    : NO
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "2.2 Ensure 'noproxyarp' is enabled for untrusted interfaces"
      info        : "Disables the Proxy-ARP function on untrusted interfaces

Rationale:

The ASA replies to ARP requests performed to IP addresses belonging to its interfaces' subnets and also to global IP addresses in some NAT configurations. Where the appliance is not asked to be a proxy for ARP requests, the Proxy-ARP function should be disabled especially on untrusted interfaces since attackers can act as legitimate devices by spoofing their IP addresses, perform ARP requests thus receiving packets intended to them."
      solution    : "Step 1: Acquire the name of the untrusted interface <untrusted_interface_name>

Step 2: Run the following command to disable the Proxy-ARP on the untrusted interface.

hostname(config)# sysopt noproxyarp <untrusted_interface_name>

Default Value:

Proxy-ARP is enabled by default"
      reference   : "800-171|3.1.1,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-171|3.13.5,800-53|AC-2(1),800-53|CM-7,800-53|CP-6,800-53|CP-7,800-53|PL-8,800-53|PM-7,800-53|SA-8,800-53|SC-7,800-53r5|AC-2(1),800-53r5|CM-7,800-53r5|CP-6,800-53r5|CP-7,800-53r5|PL-8,800-53r5|PM-7,800-53r5|SA-8,800-53r5|SC-7,CN-L3|7.1.3.2(d),CN-L3|8.1.10.6(j),CSCv7|11.1,CSCv8|12.2,CSCv8|12.5,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-4,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.c,GDPR|32.1.d,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.13.1.3,ITSG-33|AC-2(1),ITSG-33|CM-7,ITSG-33|CP-6,ITSG-33|CP-7,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SC-7,LEVEL|2A,NESA|T2.2.4,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.6.5,NIAv2|AM28,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|NS5j,NIAv2|SS3,NIAv2|SS14e,NIAv2|SS15a,NIAv2|VL2,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|2.3,TBA-FIISB|43.1"
      see_also    : "https://workbench.cisecurity.org/benchmarks/7194"
      item        : "sysopt noproxyarp .+"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "2.3 Ensure 'DNS Guard' is enabled"
      info        : "Enables the protection against DNS cache poisoning attacks

Rationale:

A DNS cache is poisoned when it contains incorrect entries that redirect traffic to an attacker website. When the DNS queries performed towards legitimate DNS servers, attackers can spoof the Identifier of the DNS header along with the DNS caching server UDP port in order to provide a reply as from an authoritative DNS server. The DNS Guard function helps eliminating subsequent replies coming after the authoritative server reply."
      solution    : "Run the following command to enable the DNS Guard function.

hostname(config)# dns-guard

Default Value:

The function is disabled for the related software versions"
      reference   : "800-171|3.1.1,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-171|3.13.5,800-53|AC-2(1),800-53|CM-7,800-53|CP-6,800-53|CP-7,800-53|PL-8,800-53|PM-7,800-53|SA-8,800-53|SC-7,800-53r5|AC-2(1),800-53r5|CM-7,800-53r5|CP-6,800-53r5|CP-7,800-53r5|PL-8,800-53r5|PM-7,800-53r5|SA-8,800-53r5|SC-7,CN-L3|7.1.3.2(d),CN-L3|8.1.10.6(j),CSCv7|11.1,CSCv8|12.2,CSCv8|12.5,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-4,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.c,GDPR|32.1.d,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.13.1.3,ITSG-33|AC-2(1),ITSG-33|CM-7,ITSG-33|CP-6,ITSG-33|CP-7,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SC-7,LEVEL|2A,NESA|T2.2.4,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.6.5,NIAv2|AM28,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|NS5j,NIAv2|SS3,NIAv2|SS14e,NIAv2|SS15a,NIAv2|VL2,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|2.3,TBA-FIISB|43.1"
      see_also    : "https://workbench.cisecurity.org/benchmarks/7194"
      item        : "dns-guard"
    </item>

    <report type:"WARNING">
      description : "3.9 Ensure Botnet protection is enabled for untrusted interfaces"
      info        : "Filters Botnet traffic on the untrusted interface

Rationale:

In a Botnet condition, many computers in the Enterprise network after being infected with malware and mostly trojans will collect data without the knowledge of the users owning them and send it to the attacker network. In other cases, the infected computers are remotely controlled to forward the same viruses that infected them to many other computers on the Internet. The Botnet protection enables the security appliance to filter and drop the botnet traffic

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Step 1: Run the following command to ensure that the DNS server is available.

hostname#sh run | i name-server

If there is no DNS server, configure the DNS server according to the related recommendation.

Step 2: Run the following commands to enable the security appliance to download and use for inspection the lists of known malware websites

hostname(config)#dynamic-filter updater-client enable
hostname(config)#dynamic-filter use-database

Step 3: Run the following command to create a class map for the security appliance to match the DNS traffic

hostname(config)#class-map <dns_class_map_name>
hostname(config-cmap)#match port udp eq domain

Step 4: Run the following to create the policy-map in order to ask the appliance to inspect the matched DNS traffic and to compare the domain name in the DNS traffic with the list of known malware related domain names.

hostname(config)#policy-map <dns_policy_map_name>
hostname(config-pmap)# class <dns_class_map_name>
hostname(config-pmap-c)# inspect dns preset_dns_map dynamic-filter-snoop

Step 5: Run the following for the inspection to be applied on the untrusted interface

hostname(config)# service-policy <dns_policy_map_name> interface <untrusted_interface_name>

Step 6: Run the following to monitor the Botnet traffic crossing the untrusted interface

hostname(config)# dynamic-filter enable interface <untrusted_interface_name>

Step 7: Run the following to drop any identified Botnet traffic on the untrusted interface

hostname(config)# dynamic-filter drop blacklist interface <untrusted_interface_name>

Default Value:

Disabled by default"
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-171|3.13.5,800-171|3.13.15,800-53|CM-6,800-53|CM-7,800-53|CP-6,800-53|CP-7,800-53|PL-8,800-53|PM-7,800-53|SA-8,800-53|SC-7,800-53|SC-23,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CP-6,800-53r5|CP-7,800-53r5|PL-8,800-53r5|PM-7,800-53r5|SA-8,800-53r5|SC-7,800-53r5|SC-23,CN-L3|8.1.10.6(j),CSCv7|11.1,CSCv8|12.2,CSCv8|12.3,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-4,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.c,GDPR|32.1.d,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CP-6,ITSG-33|CP-7,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SC-7,ITSG-33|SC-23,ITSG-33|SC-23a.,LEVEL|2A,NESA|T2.2.4,NESA|T3.4.1,NESA|T4.5.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.6.5,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|SS3,NIAv2|SS15a,NIAv2|VL2,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,SWIFT-CSCv1|2.3,TBA-FIISB|43.1"
      see_also    : "https://workbench.cisecurity.org/benchmarks/7194"
    </report>

    <item>
      type        : CONFIG_CHECK
      description : "3.10 Ensure ActiveX filtering is enabled"
      info        : "Removes ActiveX controls from the HTTP reply traffic received on the security appliance.

Rationale:

ActiveX controls are used to provide a rich users' browsing experience. Because the ActiveX control is a written program that is executed in the users' computers, it can be used by attackers to perform malicious tasks on the machines of their victims.

Impact:

Activex support has been deprecated by Microsoft, and activex support is disabled by default in modern browsers from Microsoft. However, activex support remains a viable attack platform against organizations that have it enabled for legacy applications.

recommended configuration should at a minimum be: filter activex 80 0.0.0.0 0.0.0.0 0.0.0.0 0.0.0.0

Additional ports may be required depending on your environment.

Filtering activex on https traffic is not possible, as activex filtering works by commenting out the 'object' references in the live data stream - replacing and , and and tags with comments. Since the native ASA does not have traffic decryption as a feature, this configuration will not work for https traffic, and is why this feature is deprecated on the ASA platform."
      solution    : "Step 1: Acquire the TCP port used for the HTTP traffic containing ActiveX objects, the IP address <internal_users_ip> and mask <internal_users_mask> of internal users generating the HTTP traffic, and the IP address <external_servers_ip> and mask <external_servers_mask> of the external servers to which the internal users connect and that are source of ActiveX objects.

Step 2: Run the following command to filter ActiveX applets.

hostname(config)# filter activex <port> <internal_users_ip> <internal_users_mask> <external_servers_ip> <external_servers_mask>

Default Value:

ActiveX control filtering is disabled by default."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-171|3.13.5,800-53|CM-7,800-53|CP-6,800-53|CP-7,800-53|PL-8,800-53|PM-7,800-53|SA-8,800-53|SC-7,800-53r5|CM-7,800-53r5|CP-6,800-53r5|CP-7,800-53r5|PL-8,800-53r5|PM-7,800-53r5|SA-8,800-53r5|SC-7,CN-L3|8.1.10.6(j),CSCv7|11.1,CSCv8|12.2,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-4,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.c,GDPR|32.1.d,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|CM-7,ITSG-33|CP-6,ITSG-33|CP-7,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SC-7,LEVEL|2A,NESA|T2.2.4,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.6.5,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|SS3,NIAv2|SS15a,NIAv2|VL2,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,SWIFT-CSCv1|2.3,TBA-FIISB|43.1"
      see_also    : "https://workbench.cisecurity.org/benchmarks/7194"
      item        : "^filter activex.*"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "3.11 Ensure Java applet filtering is enabled"
      info        : "Removes Java applets from the HTTP reply traffic crossing the security appliance.

Rationale:

Java applets enhance users' Web experience with more interactivity. Because the applet is a code that is downloaded and executed on the users' machines, it can be used by attackers to perform malicious activities on the systems visiting untrusted websites."
      solution    : "Step 1: Acquire the TCP port used for the HTTP traffic containing Java objects, the IP address <internal_users_ip> and mask <internal_users_mask> of internal users generating the HTTP traffic, and the IP address <external_servers_ip> and mask <external_servers_mask> of the external servers to which the internal users connect and that are source of Java objects.

Step 2: Run the following command to filter Java applets.

hostname(config)# filter java <port> <internal_users_ip> <internal_users_mask> <external_servers_ip> <external_servers_mask>

Default Value:

Java applet filtering is disabled by default."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-171|3.13.5,800-53|CM-7,800-53|CP-6,800-53|CP-7,800-53|PL-8,800-53|PM-7,800-53|SA-8,800-53|SC-7,800-53r5|CM-7,800-53r5|CP-6,800-53r5|CP-7,800-53r5|PL-8,800-53r5|PM-7,800-53r5|SA-8,800-53r5|SC-7,CN-L3|8.1.10.6(j),CSCv7|11.1,CSCv8|12.2,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-4,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.c,GDPR|32.1.d,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|CM-7,ITSG-33|CP-6,ITSG-33|CP-7,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SC-7,LEVEL|2A,NESA|T2.2.4,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.6.5,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|SS3,NIAv2|SS15a,NIAv2|VL2,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,SWIFT-CSCv1|2.3,TBA-FIISB|43.1"
      see_also    : "https://workbench.cisecurity.org/benchmarks/7194"
      item        : "^filter java.*"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "3.13 Ensure VPN traffic goes through the relevant ACL"
      info        : "By default, the traffic going through IPSEC tunnel (policy-based) bypasses the ACL of the interface the VPN terminates on, often the outside ACL.

Rationale:

VPN are used to interconnect sites, whether intra or inter companies. In many cases, these are seen to extensions of the local network and very little filtering is applied. It is important to consider that a remote site should not be seen automatically as fully trusted but that some level of filtering should be applied, for example to prevent access to local management ports."
      solution    : "Summary

Step 1: determine on which interface(s) the IPSEC tunnel ends

Step 2: determine the ACL applied to the interface

Step 3: add an ACE to the ACL to permit the traffic temporarily

Step 4: disable the bypass

Step 1

hostname# show run full | grep crypto.map..*.interface.
crypto map my_remote_sites interface outside

In this example, the crypto map my_remote_sites is applied to the interface outside: the IPSEC tunnel terminates on the interface outside.

Step 2

hostname# sh run access-group | grep interface.outside
access-group outside_acl in interface outside

The ACL outside_acl is applied to the interface outside.

Step 3


Note: this considers that the remote site networks are defined in an object called obj-remote-site and the local site networks in an object called obj-local-site. The ACE is added as the first entry in this case but could be after an initial series of denies to known 'bad' destinations.

hostname(config)# access-list outside_acl line 1 permit ip object obj-remote-site object obj-local-site log notifications
hostname(config)# access-list outside_acl line 2 remark Temporary permit from remote site. Restrict as soon as possible.

Step 4

hostname(config)# no sysopt connection permit-vpn

Default Value:

Disabled by default"
      reference   : "800-171|3.4.1,800-171|3.4.6,800-171|3.4.7,800-53|CA-3,800-53|CA-9,800-53|CM-2,800-53|CM-7b.,800-53r5|CA-3,800-53r5|CA-9,800-53r5|CM-2,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv7|9,CSCv7|11.1,CSCv7|11.2,CSF|DE.AE-1,CSF|ID.AM-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),ITSG-33|CA-3,ITSG-33|CM-2,ITSG-33|CM-7a.,LEVEL|2M,NESA|M1.3.5,NESA|M1.3.6,NESA|T3.2.5,NESA|T7.5.1,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS16,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5"
      see_also    : "https://workbench.cisecurity.org/benchmarks/7194"
      item        : "no sysopt connection permit-vpn"
    </item>
  </then>

  <else>
    <report type:"WARNING">
      description : "CIS_Cisco_ASA_9.x_Firewall_v1.1.0_L2.audit from CIS Cisco ASA 9.x Firewall Benchmark v1.1.0"
      info        : " NOTE: Nessus has not identified that the chosen audit applies to the target device."
      see_also    : "https://workbench.cisecurity.org/benchmarks/7194"
    </report>
  </else>
</if>

</check_type>
