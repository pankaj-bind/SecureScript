#TRUSTED 81d65412f6eb067d4ac3b806e80531961254af7be8bce118a53d834366ea8ac4c4d4931bc4ca7895f8653dcabaf31ff1015a1624460bd8d83a01aedc6a5659ea7c434684d38299cc4680ac086e6af9a5d9ca237a940ec4d86e0cab34768515da3366db686cb03b16b34aca9448a15c2c1babc73de3730003f8e4a4697545d2a5da6b7c10054e51a14352746a8a0aedb75401ad35668fb5d1cdec7eb5a9e88b2f5dd4fad671a250b3e5391f32ea211e4ed0de380f7746f5fecdf1deea1e5b72b0fad1c4d5c680395e7371ad6fa14e826e3fb20dc98a53d2daac4c9c030bd10c5e72fb12f47275dc70c0ec2053a25feebbb84ccf7be4c13f152baa7e34571d8f07bf1143ba16a53a84518f4ce5b3b2cd8d85a9c14bea596ff50bac62100b406f9414f6cdc363a425109035ca7cedcf9ccc42f294d23eeb81e8106a95208ba049620ca2fc9e95d32d4ee63316db2661e659570d42327a68883fb3844368e77443dbbd4a7152b7c2731c9ca695278dd1e96a5bd582ce3a64cf89696d6f5810a2440199a818a99e79b95a0aa56517f8d007c7520c63a8c0b8088a346e963c17777facd53050cc80a4a96d3906023f8180c88d1937e9c6fb23b6f44d59723bc2f6f648d3d53048659e965871c634145ced526c237de608870394cc1e43fe647df5bab7416ddacec078da6678cbc9735eaecac4627f46def9889a74a8097b4093dcfb72
#TRUST-RSA-SHA256 02129561599e0959b6638cf65cc0e11da8ee672a8f5a6ce507b53361c0202e90e0e3a6b7eccb280b8a49f0ea1284f234dca4583f7e45215b128d3b8857c34478cbe0b3c4abb3ea0f71494a78f4d390b616edcdd0e0f2175123fd79a215bd100068252f67e7c2f65a352d4f8c8fbad9d6864cc92bb04836ebee7c08fd49986e41a92e40883034fa6eff10bbf80876278e4fb9e2cdeee0dd0128c75eb53cb2aefce2ed787b0801ddec468d009ee619261c864c8743d2b3841d2ce78e7ec1b11ca2f9d987f5b0043ac27a57b4edee86cfb04dee9c990de0ca27bfc6814b2b1af7a049fe12be76cafd0558455b70886eeb361a18329c44edbb9cb2686c0cdd775f4394735142e98aa7aed716d9e47a7d1a4dcac63cef91aa516262ce79e50dd18d677219e3803f76c29d71fd8a36eb006c3f10bf04a0ecb78b8d5a1eb25f588b3ae7644c315113d94371382239bb1b3e86e9ca59ed8217169d57f623a6c41213be2b81323d9f73d1c08b0ceb445dc419f495d415ea0c226a5844814f9de5e2fa06411d786728c9de9d8e2f4f77997b5c33dec201c1ed78791e9fe3d62e6a24a4eea81167fef850f1e63599f92c309bc11914a81b602dd5a07db98de614d79b23328e9a9ce6fc4ae3b932d1aae2c193e0e1ab99c5be911485e52abea0a0f2f2de29b49f8638452060ecd03c68c69f868ed0bc0a174e2f1fec5961eec26454682ef3ee
#
# This script is Copyright (C) 2004-2024 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
# $Revision: 1.0 $
# $Date: 2024/08/28 $
#
# Description : This document implements the security configuration as recommended by the
#               DISA Apple iOS/iPadOS 17 BYOAD v1r1 STIG.
#
#<ui_metadata>
#<display_name>AirWatch - DISA Apple iOS/iPadOS 17 BYOAD v1r1</display_name>
#<spec>
#  <type>DISA STIG</type>
#  <name>Apple iOS/iPadOS 17 BYOAD</name>
#  <profile>AirWatch</profile>
#  <version>1.1.0</version>
#  <link>https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS-iPadOS_17_BYOAD_Y24M02_STIG.zip</link>
#</spec>
#<labels>mdm,disa,airwatch,ios</labels>
#<benchmark_refs>CAT,CCE,CCI,DISA_Benchmark,Group-ID,Rule-ID,STIG-ID,STIG-Legacy,Vuln-ID</benchmark_refs>
#</ui_metadata>

<check_type:"MDM" mdm_type:AIRWATCH>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "AIOS-17-706500 - Apple iOS/iPadOS 17 must be configured to enforce a minimum password length of six characters."
  info           : "Password strength is a measure of the effectiveness of a password in resisting guessing and brute force attacks. The ability to crack a password is a function of how many attempts an adversary is permitted, how quickly an adversary can do each attempt, and the size of the password space. The longer the minimum length of the password is, the larger the password space. Having a too-short minimum password length significantly reduces password strength, increasing the chance of password compromise and resulting device and data compromise.

SFR ID: FMT_SMF_EXT.1.1 #1a"
  solution       : "Install a configuration profile to enforce a minimum passcode length value of six or greater."
  reference      : "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(a),CAT|II,CCI|CCI-000205,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|Apple_iOS_iPadOS_17_MDFPP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-259763r943614_rule,STIG-ID|AIOS-17-706500,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-259763"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS-iPadOS_17_BYOAD_Y24M02_STIG.zip"
  json_transform : '.[] | select((.type == "Apple") and (.General.IsActive == "true")) | "Policy: " + .General.Name + " - Minimum Passcode Length = \(.Passcode.MinimumPasscodeLength // "not defined")"'
  regex          : "Minimum Passcode Length ="
  expect         : "Minimum Passcode Length = ([6-9]|[1-9][0-9])"
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "AIOS-17-706600 - Apple iOS/iPadOS 17 must be configured to not allow passwords that include more than four repeating or sequential characters."
  info           : "Password strength is a measure of the effectiveness of a password in resisting guessing and brute force attacks. Passwords that contain repeating or sequential characters are significantly easier to guess than those that do not contain repeating or sequential characters. Therefore, disallowing repeating or sequential characters increases password strength and decreases risk.

SFR ID: FMT_SMF_EXT.1.1 #1b"
  solution       : "Install a configuration profile to disallow more than four sequential or repeating numbers or letters in the device unlock password."
  reference      : "800-171|3.5.7,800-53|IA-5(1)(b),800-53r5|IA-5(1)(b),CAT|II,CCI|CCI-000195,CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|Apple_iOS_iPadOS_17_MDFPP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(b),NESA|T5.2.3,NIAv2|AM22d,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-259764r943617_rule,STIG-ID|AIOS-17-706600,SWIFT-CSCv1|4.1,Vuln-ID|V-259764"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS-iPadOS_17_BYOAD_Y24M02_STIG.zip"
  json_transform : '.[] | select((.type == "Apple") and (.General.IsActive == "true")) | "Policy: " + .General.Name + " - Allow Simple Value = \(.Passcode.AllowSimpleValue // "not defined")"'
  regex          : "Allow Simple Value ="
  expect         : "Allow Simple Value = false"
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "AIOS-17-706700 - Apple iOS/iPadOS 17 must be configured to enable a screen-lock policy that will lock the display after a period of inactivity."
  info           : "The screen-lock timeout helps protect the device from unauthorized access. Devices without a screen-lock timeout provide an opportunity for adversaries who gain physical access to the mobile device through loss, theft, etc. Such devices are much more likely to be in an unlocked state when acquired by an adversary, thus granting immediate access to the data on the mobile device and possibly access to DOD networks.

SFR ID: FMT_SMF_EXT.1.1 #2a

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution       : "Install a configuration profile to lock the device display after 15 minutes (or less) of inactivity. This is done by setting 'Maximum Auto-Lock time' and 'Grace Period for device lock' so the sum of their values is between 1 and 15 minutes."
  reference      : "800-171|3.1.10,800-53|AC-11a.,800-53r5|AC-11a.,CAT|II,CCI|CCI-000057,CN-L3|8.1.4.1(b),DISA_Benchmark|Apple_iOS_iPadOS_17_MDFPP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11a.,NESA|T2.3.8,NESA|T2.3.9,NIAv2|AM23a,NIAv2|AM23b,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,Rule-ID|SV-259765r943620_rule,STIG-ID|AIOS-17-706700,Vuln-ID|V-259765"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS-iPadOS_17_BYOAD_Y24M02_STIG.zip"
  json_transform : '.[] | select((.type == "Apple") and (.General.IsActive == "true")) | "Policy: " + .General.Name + " - Auto Lock = \(.Passcode.AutoLock // "not defined"), Grace Period = \(.Passcode.GracePeriodForDeviceLock)"'
  regex          : ".*"
  expect         : "Manual Review"
  severity       : MEDIUM
</custom_item>

<report type:"WARNING">
  description : "AIOS-17-706800 - Apple iOS/iPadOS 17 must be configured to lock the display after 15 minutes (or less) of inactivity - or less of inactivity."
  info        : "The screen lock timeout must be set to a value that helps protect the device from unauthorized access. Having a too-long timeout would increase the window of opportunity for adversaries who gain physical access to the mobile device through loss, theft, etc. Such devices are much more likely to be in an unlocked state when acquired by an adversary, thus granting immediate access to the data on the mobile device. The maximum timeout period of 15 minutes has been selected to balance functionality and security; shorter timeout periods may be appropriate depending on the risks posed to the mobile device.

SFR ID: FMT_SMF_EXT.1.1 #2b

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Install a configuration profile to lock the device display after 15 minutes (or less) of inactivity. This is done by setting 'Maximum Auto-Lock time' and 'Grace Period for device lock' so the sum of their values is between 1 and 15 minutes."
  reference   : "800-171|3.1.10,800-53|AC-11a.,800-53r5|AC-11a.,CAT|II,CCI|CCI-000057,CN-L3|8.1.4.1(b),DISA_Benchmark|Apple_iOS_iPadOS_17_MDFPP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11a.,NESA|T2.3.8,NESA|T2.3.9,NIAv2|AM23a,NIAv2|AM23b,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,Rule-ID|SV-259766r943623_rule,STIG-ID|AIOS-17-706800,Vuln-ID|V-259766"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS-iPadOS_17_BYOAD_Y24M02_STIG.zip"
</report>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "AIOS-17-706900 - Apple iOS/iPadOS 17 must be configured to not allow more than 10 consecutive failed authentication attempts."
  info           : "The more attempts an adversary has to guess a password, the more likely the adversary will enter the correct password and gain access to resources on the device. Setting a limit on the number of attempts mitigates this risk. Setting the limit at 10 or less gives authorized users the ability to make a few mistakes when entering the password but still provides adequate protection against dictionary or brute force attacks on the password.

SFR ID: FMT_SMF_EXT.1.1 #2c, FIA_AFL_EXT.1.5"
  solution       : "Install a configuration profile to allow only 10 or fewer consecutive failed authentication attempts."
  reference      : "800-171|3.1.8,800-53|AC-7a.,800-53r5|AC-7a.,CAT|II,CCI|CCI-000044,CN-L3|8.1.4.1(b),CSF2.0|PR.AA-03,DISA_Benchmark|Apple_iOS_iPadOS_17_MDFPP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-7a.,NESA|T5.5.1,NIAv2|AM24,PCI-DSSv3.2.1|8.1.6,PCI-DSSv4.0|8.3.4,Rule-ID|SV-259767r943626_rule,STIG-ID|AIOS-17-706900,TBA-FIISB|45.1.2,TBA-FIISB|45.2.1,TBA-FIISB|45.2.2,Vuln-ID|V-259767"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS-iPadOS_17_BYOAD_Y24M02_STIG.zip"
  json_transform : '.[] | select((.type == "Apple") and (.General.IsActive == "true")) | "Policy: " + .General.Name + " - Maximum Number Of Failed Attempts = \(.Passcode.MaximumNumberOfFailedAttempts // "not defined")"'
  regex          : "Maximum Number Of Failed Attempts ="
  expect         : "Maximum Number Of Failed Attempts = ([1-9]|10)[^0-9]"
</custom_item>

<report type:"WARNING">
  description : "AIOS-17-706950 - Apple iOS/iPadOS 17 must be configured to enforce a passcode reuse prohibition of at least two generations."
  info        : "iOS/iPadOS 17 includes a new feature that allows the previous passcode to be valid for 72 hours after a passcode change. If the previous passcode has been compromised and the attacker has access to it and the Apple device, enterprise data and the enterprise network can be compromised. Currently there is no MDM control to force the old passcode to expire immediately after passcode change. The previous passcode will expire immediately after a passcode change if the MDM password history control is implemented.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Install a configuration profile to enforce a passcode reuse prohibition of at least two generations (passcode history)."
  reference   : "800-171|3.5.8,800-53|IA-5(1)(e),800-53r5|IA-5(1)(e),CAT|I,CCI|CCI-000200,CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|Apple_iOS_iPadOS_17_MDFPP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(e),NESA|T5.2.3,NIAv2|AM22c,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-259768r943629_rule,STIG-ID|AIOS-17-706950,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.3,Vuln-ID|V-259768"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS-iPadOS_17_BYOAD_Y24M02_STIG.zip"
</report>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "AIOS-17-701000 - Apple iOS/iPadOS 17 must allow the administrator (MDM) to perform the following management function: enable/disable VPN protection across the device - MDM to perform the following management function: enable/disable VPN protection across the device and [selection: other methods]."
  info           : "The system administrator must have the capability to configure VPN access to meet organization-specific policies based on mission needs. Otherwise, a user could inadvertently or maliciously set up a VPN and connect to a network that poses unacceptable risk to DOD information systems. An adversary could exploit vulnerabilities created by the weaker configuration to compromise DOD sensitive information.

SFR ID: FMT_SMF_EXT.1.1 #3"
  solution       : "If a third-party unmanaged VPN app is installed on the iOS 17 device, do not configure the VPN app with a DOD network VPN profile."
  reference      : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Apple_iOS_iPadOS_17_MDFPP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-259760r943605_rule,STIG-ID|AIOS-17-701000,SWIFT-CSCv1|2.3,Vuln-ID|V-259760"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS-iPadOS_17_BYOAD_Y24M02_STIG.zip"
  json_transform : '.[] | select((.type == "Apple") and (.General.IsActive == "true")) | "Policy: " + .General.Name + " - Allow Only Secure VPN Connections = \(.Restriction.AllowOnlySecureVPNConnections // "not defined")"'
  regex          : "Allow Only Secure VPN Connections ="
  expect         : "Allow Only Secure VPN Connections = true"
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "AIOS-17-707000 - Apple iOS/iPadOS 17 must be configured to enforce an application installation policy by specifying one or more authorized application repositories, including [selection: DOD-approved commercial app repository, MDM server, mobile application store]."
  info           : "Forcing all applications to be installed from authorized application repositories can prevent unauthorized and malicious applications from being installed and executed on mobile devices. Allowing such installations and executions could cause a compromise of DOD data accessible by these unauthorized/malicious applications.

SFR ID: FMT_SMF_EXT.1.1 #8a"
  solution       : "Install a configuration profile to disable 'Allow Trusting New Enterprise App Authors'."
  reference      : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Apple_iOS_iPadOS_17_MDFPP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-259769r943632_rule,STIG-ID|AIOS-17-707000,SWIFT-CSCv1|2.3,Vuln-ID|V-259769"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS-iPadOS_17_BYOAD_Y24M02_STIG.zip"
  json_transform : '.[] | select((.type == "Apple") and (.General.IsActive == "true")) | "Policy: " + .General.Name + " - Allow User to Trust Unmanaged Enterprise Apps = \(.Restriction.Allowusertotrustunmanagedenterpriseapps // "not defined")"'
  regex          : "Allow User to Trust Unmanaged Enterprise Apps ="
  expect         : "Allow User to Trust Unmanaged Enterprise Apps = false"
</custom_item>

<report type:"WARNING">
  description : "AIOS-17-707400 - Apple iOS/iPadOS 17 allow list must be configured to not include applications with the following characteristics:"
  info        : "- backs up MD data to non-DOD cloud servers (including user and application access to cloud backup services);
- transmits MD diagnostic data to non-DOD servers;
- allows synchronization of data or applications between devices associated with user; and
- allows unencrypted (or encrypted but not FIPS 140-2/FIPS 140-3 validated) data sharing with other MDs or printers.

Requiring all authorized applications to be in an application allow list prevents the execution of any applications (e.g., unauthorized, malicious) that are not part of the allow list. Failure to configure an application allow list properly could allow unauthorized and malicious applications to be downloaded, installed, and executed on the mobile device, causing a compromise of DOD data accessible by these applications. Applications with the listed characteristics have features that can cause the compromise of sensitive DOD data or have features with no known application in the DOD environment.

Application note: The application allow list, in addition to controlling the installation of applications on the MD, must control user access/execution of all core and preinstalled applications, or the MD must provide an alternate method of restricting user access/execution to core and preinstalled applications.

Core application: Any application integrated into the OS by the OS or MD vendors.

Preinstalled application: Additional noncore applications included in the OS build by the OS vendor, MD vendor, or wireless carrier.

SFR ID: FMT_SMF_EXT.1.1 #8b

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Install a configuration profile with an allow list of approved apps (allowlistedAppBundleIDs). Ensure the allow list does not include apps with the following characteristics:

- Backs up MD data to non-DOD cloud servers (including user and application access to cloud backup services).
- Transmits MD diagnostic data to non-DOD servers.
- Allows synchronization of data or applications between devices associated with user.
- Allows unencrypted (or encrypted but not FIPS 140-2/FIPS 140-3 validated) data sharing with other MDs or printers."
  reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Apple_iOS_iPadOS_17_MDFPP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-259770r943635_rule,STIG-ID|AIOS-17-707400,SWIFT-CSCv1|2.3,Vuln-ID|V-259770"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS-iPadOS_17_BYOAD_Y24M02_STIG.zip"
</report>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "AIOS-17-707500 - Apple iOS/iPadOS 17 must be configured to not display notifications when the device is locked."
  info           : "Many mobile devices display notifications on the lock screen so users can obtain relevant information in a timely manner without having to frequently unlock the phone to determine if there are new notifications. However, in many cases, these notifications can contain sensitive information. When they are available on the lock screen, an adversary can see them merely by being in close physical proximity to the device. Configuring the mobile operating system to not send notifications to the lock screen mitigates this risk.

SFR ID: FMT_SMF_EXT.1.1 #18"
  solution       : "Install a configuration profile to disable the display of notifications when the device is locked. There are two acceptable methods. The first method is preferred.

Method 1:
Install a configuration profile to disable notifications for each managed app if device screen is locked. This method is not supported by all MDM servers.

Method 2:
Install a configuration profile to disable Notification Center from the device Lock screen."
  reference      : "800-171|3.1.10,800-53|AC-11(1),800-53r5|AC-11(1),CAT|II,CCI|CCI-000060,CN-L3|8.1.4.1(b),DISA_Benchmark|Apple_iOS_iPadOS_17_MDFPP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11(1),NIAv2|AM23c,NIAv2|AM23d,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,Rule-ID|SV-259771r943638_rule,STIG-ID|AIOS-17-707500,Vuln-ID|V-259771"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS-iPadOS_17_BYOAD_Y24M02_STIG.zip"
  json_transform : '.[] | select((.type == "Apple") and (.General.IsActive == "true")) | "Policy: " + .General.Name + " - Show Notifications View On Lock Screen = \(.Restriction.ShowNotificationsViewOnLockScreen // "not defined")"'
  regex          : "Show Notifications View On Lock Screen ="
  expect         : "Show Notifications View On Lock Screen = false"
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "AIOS-17-707600 - Apple iOS/iPadOS 17 must not display notifications (calendar information) when the device is locked - calendar information when the device is locked."
  info           : "Many mobile devices display notifications on the lock screen so users can obtain relevant information in a timely manner without having to frequently unlock the phone to determine if there are new notifications. However, in many cases, these notifications can contain sensitive information. When they are available on the lock screen, an adversary can see them merely by being in close physical proximity to the device. Configuring the mobile operating system to not send notifications to the lock screen mitigates this risk.

SFR ID: FMT_SMF_EXT.1.1 #18"
  solution       : "Install a configuration profile to disable 'Show Today view in Lock screen' from the device lock screen."
  reference      : "800-171|3.1.10,800-53|AC-11(1),800-53r5|AC-11(1),CAT|II,CCI|CCI-000060,CN-L3|8.1.4.1(b),DISA_Benchmark|Apple_iOS_iPadOS_17_MDFPP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11(1),NIAv2|AM23c,NIAv2|AM23d,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,Rule-ID|SV-259772r943641_rule,STIG-ID|AIOS-17-707600,Vuln-ID|V-259772"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS-iPadOS_17_BYOAD_Y24M02_STIG.zip"
  json_transform : '.[] | select((.type == "Apple") and (.General.IsActive == "true")) | "Policy: " + .General.Name + " - Show Today View On Lock Screen = \(.Restriction.ShowTodayViewOnLockScreen // "not defined")"'
  regex          : "Show Today View On Lock Screen ="
  expect         : "Show Today View On Lock Screen = false"
</custom_item>

<report type:"WARNING">
  description : "AIOS-17-708400 - Apple iOS/iPadOS 17 must be configured to display the DOD advisory warning message at startup or each time the user unlocks the device."
  info        : "Before granting access to the system, the mobile operating system is required to display the DOD-approved system use notification message or banner that provides privacy and security notices consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance. Required banners help ensure the DOD can audit and monitor the activities of mobile device users without legal restriction.

System use notification messages can be displayed when individuals first access or unlock the mobile device. The banner must be implemented as a 'click-through' banner at device unlock (to the extent permitted by the operating system). A 'click-through' banner prevents further activity on the information system unless and until the user executes a positive action to manifest agreement by clicking on a box indicating 'OK'.

The approved DOD text must be used exactly as required in the Knowledge Service referenced in DODI 8500.01. For devices accommodating banners of 1300 characters, the banner text is:

You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.
By using this IS (which includes any device attached to this IS), you consent to the following conditions:
-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.
-At any time, the USG may inspect and seize data stored on this IS.
-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.
-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.
-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. Refer to User Agreement for details.

For devices with severe character limitations, the banner text is:

I've read & consent to terms in IS user agreem't.

The administrator must configure the banner text exactly as written without any changes.

SFR ID: FMT_SMF_EXT.1.1 #36

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the DOD warning banner by either of the following methods (required text is found in the Vulnerability Discussion):

Method 1:
By placing the DOD warning banner text in the user agreement signed by each iOS device user.

Method 2:
By installing a Lock Screen Message payload with the required text (preferred method)."
  reference   : "800-171|3.1.9,800-53|AC-8a.,800-53r5|AC-8a.,CAT|III,CCI|CCI-000048,DISA_Benchmark|Apple_iOS_iPadOS_17_MDFPP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-8a.,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,Rule-ID|SV-259773r943644_rule,STIG-ID|AIOS-17-708400,TBA-FIISB|45.2.4,Vuln-ID|V-259773"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS-iPadOS_17_BYOAD_Y24M02_STIG.zip"
</report>

<report type:"WARNING">
  description : "AIOS-17-709200 - Apple iOS/iPadOS 17 must be configured to not allow backup of [all applications, configuration data] to locally connected systems."
  info        : "Data on mobile devices is protected by numerous mechanisms, including user authentication, access control, and cryptography. When the data is backed up to an external system (either locally connected or cloud based), many if not all of these mechanisms are no longer present. This leaves the backed-up data vulnerable to attack. Disabling backup to external systems mitigates this risk.

SFR ID: FMT_SMF_EXT.1.1 #40

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Install a configuration profile to disable backup of managed apps."
  reference   : "800-171|3.13.4,800-53|SC-4,800-53r5|SC-4,CAT|II,CCI|CCI-001090,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,CSF2.0|PR.IR-01,DISA_Benchmark|Apple_iOS_iPadOS_17_MDFPP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-4,ITSG-33|SC-4a.,Rule-ID|SV-259774r943647_rule,STIG-ID|AIOS-17-709200,Vuln-ID|V-259774"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS-iPadOS_17_BYOAD_Y24M02_STIG.zip"
</report>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "AIOS-17-703600 - Apple iOS/iPadOS 17 must not allow backup to remote systems (managed applications data stored in iCloud) - managed applications data stored in iCloud."
  info           : "If a user is able to configure the security setting, the user could inadvertently or maliciously set it to a value that poses unacceptable risk to DOD information systems. An adversary could exploit vulnerabilities created by the weaker configuration to compromise DOD sensitive information.

SFR ID: FMT_MOF_EXT.1.2 #40"
  solution       : "Install a configuration profile to prevent DOD applications from storing data in iCloud."
  reference      : "800-171|3.1.21,800-171|3.4.2,800-53|AC-20(2),800-53|CM-6b.,800-53r5|AC-20(2),800-53r5|CM-6b.,CAT|II,CCI|CCI-000097,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|ID.AM-4,CSF|PR.AC-3,CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|ID.AM-02,CSF2.0|ID.AM-04,CSF2.0|PR.PS-01,DISA_Benchmark|Apple_iOS_iPadOS_17_MDFPP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-20(2),ITSG-33|CM-6b.,NESA|M1.3.5,NESA|T1.2.3,NESA|T3.2.1,QCSC-v1|3.2,QCSC-v1|5.2.2,Rule-ID|SV-259761r943608_rule,STIG-ID|AIOS-17-703600,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,Vuln-ID|V-259761"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS-iPadOS_17_BYOAD_Y24M02_STIG.zip"
  json_transform : '.[] | select((.type == "Apple") and (.General.IsActive == "true")) | "Policy: " + .General.Name + " - Allow Managed Apps To Store Data = \(.Restriction.Allowmanagedappstostoredata // "not defined")"'
  regex          : "Allow Managed Apps To Store Data ="
  expect         : "Allow Managed Apps To Store Data = false"
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "AIOS-17-703700 - Apple iOS/iPadOS 17 must not allow backup to remote systems (enterprise books) - enterprise books."
  info           : "If a user is able to configure the security setting, the user could inadvertently or maliciously set it to a value that poses unacceptable risk to DOD information systems. An adversary could exploit vulnerabilities created by the weaker configuration to compromise DOD sensitive information.

SFR ID: FMT_MOF_EXT.1.2 #40"
  solution       : "Install a configuration profile to prevent backup of enterprise books that could contain DOD sensitive information."
  reference      : "800-171|3.1.1,800-171|3.4.2,800-53|AC-2a.,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CCI|CCI-002110,CN-L3|7.1.3.2(d),CN-L3|8.1.10.6(d),CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.IP-1,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|DE.CM-09,CSF2.0|PR.AA-01,CSF2.0|PR.AA-05,CSF2.0|PR.DS-10,CSF2.0|PR.PS-01,DISA_Benchmark|Apple_iOS_iPadOS_17_MDFPP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2a.,ITSG-33|CM-6b.,NESA|T3.2.1,NESA|T5.2.1,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,PCI-DSSv3.2.1|1.1.5,PCI-DSSv4.0|1.1.2,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,Rule-ID|SV-259762r943611_rule,STIG-ID|AIOS-17-703700,SWIFT-CSCv1|2.3,Vuln-ID|V-259762"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS-iPadOS_17_BYOAD_Y24M02_STIG.zip"
  json_transform : '.[] | select((.type == "Apple") and (.General.IsActive == "true")) | "Policy: " + .General.Name + " - Allow backing up Enterprise Books = \(.Restriction.AllowbackingupEnterpriseBooks // "not defined")"'
  regex          : "Allow backing up Enterprise Books ="
  expect         : "Allow backing up Enterprise Books = false"
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "AIOS-17-709700 - Apple iOS/iPadOS 17 must not allow non-DOD applications to access DOD data."
  info           : "App data sharing gives apps the ability to access the data of other apps for enhanced user functionality. However, sharing also poses a significant risk that unauthorized users or apps will obtain access to sensitive DOD information. To mitigate this risk, there are data sharing restrictions. If a user is allowed to make exceptions to the data sharing restriction policy, the user could enable unauthorized sharing of data, leaving it vulnerable to breach. Limiting the granting of exceptions to either the administrator or common application developer mitigates this risk.

Copy/paste of data between applications in different application processes or groups of application processes is considered an exception to the access control policy; therefore, the administrator must be able to enable/disable the feature. Other exceptions include allowing any data or application sharing between process groups.

SFR ID: FMT_SMF_EXT.1.1 #42, FDP_ACF_EXT.1.2"
  solution       : "Install a configuration profile to prevent non-DOD applications from accessing DOD data."
  reference      : "800-171|3.1.5,800-53|AC-6(8),800-53|SC-39,800-53r5|AC-6(8),800-53r5|SC-39,CAT|II,CCI|CCI-002233,CCI|CCI-002530,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,CSF2.0|PR.AA-05,CSF2.0|PR.DS-01,CSF2.0|PR.DS-10,CSF2.0|PR.IR-03,DISA_Benchmark|Apple_iOS_iPadOS_17_MDFPP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,Rule-ID|SV-259775r943650_rule,STIG-ID|AIOS-17-709700,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,Vuln-ID|V-259775"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS-iPadOS_17_BYOAD_Y24M02_STIG.zip"
  json_transform : '.[] | select((.type == "Apple") and (.General.IsActive == "true")) | "Policy: " + .General.Name + " - Allow Opening Managed App Documents In Unmanaged Apps = \(.Restriction.AllowOpeningManagedAppDocumentsInUnmanagedApps // "not defined")"'
  regex          : "Allow Opening Managed App Documents In Unmanaged Apps ="
  expect         : "Allow Opening Managed App Documents In Unmanaged Apps = false"
</custom_item>

<report type:"WARNING">
  description : "AIOS-17-709900 - Apple iOS/iPadOS 17 must be configured to [selection: wipe protected data, wipe sensitive data] upon unenrollment from MDM."
  info        : "When a mobile device is no longer going to be managed by MDM technologies, its protected/sensitive data must be sanitized because it will no longer be protected by the MDM software, putting it at much greater risk of unauthorized access and disclosure. At least one of the two options must be selected.

SFR ID: FMT_SMF_EXT.2.1

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Install a configuration profile to delete all managed apps upon device unenrollment."
  reference   : "800-171|3.4.2,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|CM-6b.,800-53|MP-6(3),800-53r5|CM-6b.,800-53r5|MP-6(3),CAT|II,CCI|CCI-000366,CCI|CCI-001033,CN-L3|8.1.10.6(d),CSF|PR.DS-3,CSF|PR.IP-1,CSF|PR.IP-6,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Apple_iOS_iPadOS_17_MDFPP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.8.3.2,ITSG-33|CM-6b.,ITSG-33|MP-6(3),NESA|T1.4.1,NESA|T3.2.1,NIAv2|MS5b,NIAv2|MS6,NIAv2|MS9,NIAv2|MS10a,NIAv2|MS10b,NIAv2|MS10c,NIAv2|MS10d,NIAv2|MS10e,NIAv2|MS10f,NIAv2|MS11a,NIAv2|MS11b,NIAv2|MS12a,NIAv2|MS12b,NIAv2|MS12c,NIAv2|MS13,NIAv2|MS14,NIAv2|MS17,NIAv2|MS18a,NIAv2|MS18b,NIAv2|MS18c,NIAv2|MS20,NIAv2|MS21,NIAv2|NS16,QCSC-v1|3.2,QCSC-v1|6.2,Rule-ID|SV-259776r943653_rule,STIG-ID|AIOS-17-709900,SWIFT-CSCv1|2.3,Vuln-ID|V-259776"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS-iPadOS_17_BYOAD_Y24M02_STIG.zip"
</report>

<report type:"WARNING">
  description : "AIOS-17-710000 - Apple iOS/iPadOS 17 must be configured to [selection: remove Enterprise applications, remove all noncore applications (any nonfactory installed application)] upon unenrollment from MDM."
  info        : "When a mobile device will no longer be managed by MDM technologies, its protected/sensitive data must be sanitized because it will no longer be protected by the MDM software, putting it at much greater risk of unauthorized access and disclosure. At least one of the two options must be selected.

SFR ID: FMT_SMF_EXT.2.1

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Install a configuration profile to delete all managed apps upon device unenrollment."
  reference   : "800-171|3.4.2,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|CM-6b.,800-53|MP-6(3),800-53r5|CM-6b.,800-53r5|MP-6(3),CAT|II,CCI|CCI-000366,CCI|CCI-001033,CN-L3|8.1.10.6(d),CSF|PR.DS-3,CSF|PR.IP-1,CSF|PR.IP-6,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Apple_iOS_iPadOS_17_MDFPP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.8.3.2,ITSG-33|CM-6b.,ITSG-33|MP-6(3),NESA|T1.4.1,NESA|T3.2.1,NIAv2|MS5b,NIAv2|MS6,NIAv2|MS9,NIAv2|MS10a,NIAv2|MS10b,NIAv2|MS10c,NIAv2|MS10d,NIAv2|MS10e,NIAv2|MS10f,NIAv2|MS11a,NIAv2|MS11b,NIAv2|MS12a,NIAv2|MS12b,NIAv2|MS12c,NIAv2|MS13,NIAv2|MS14,NIAv2|MS17,NIAv2|MS18a,NIAv2|MS18b,NIAv2|MS18c,NIAv2|MS20,NIAv2|MS21,NIAv2|NS16,QCSC-v1|3.2,QCSC-v1|6.2,Rule-ID|SV-259777r943656_rule,STIG-ID|AIOS-17-710000,SWIFT-CSCv1|2.3,Vuln-ID|V-259777"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS-iPadOS_17_BYOAD_Y24M02_STIG.zip"
</report>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "AIOS-17-710400 - Apple iOS/iPadOS 17 must require a valid password be successfully entered before the mobile device data is unencrypted."
  info           : "Passwords provide a form of access control that prevents unauthorized individuals from accessing computing resources and sensitive data. Passwords may also be a source of entropy for generation of key encryption or data encryption keys. If a password is not required to access data, this data is accessible to any adversary who obtains physical possession of the device. Requiring that a password be successfully entered before the mobile device data is unencrypted mitigates this risk.

Note: MDF PP requires a Password Authentication Factor and requires management of its length and complexity. It leaves open whether the existence of a password is subject to management. This requirement addresses the configuration to require a password, which is critical to the cybersecurity posture of the device.

SFR ID: FIA_UAU_EXT.1.1"
  solution       : "Install a configuration profile to require a password to unlock the device."
  reference      : "800-171|3.13.16,800-53|SC-28,800-53r5|SC-28,CAT|I,CCI|CCI-001199,CN-L3|8.1.4.7(b),CN-L3|8.1.4.8(b),CSF|PR.DS-1,CSF2.0|PR.DS-01,DISA_Benchmark|Apple_iOS_iPadOS_17_MDFPP_3-3_BYOAD_STIG,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ITSG-33|SC-28,ITSG-33|SC-28a.,PCI-DSSv3.2.1|3.4,PCI-DSSv4.0|3.3.2,PCI-DSSv4.0|3.5.1,QCSC-v1|5.2.2,QCSC-v1|6.2,Rule-ID|SV-259778r943659_rule,STIG-ID|AIOS-17-710400,Vuln-ID|V-259778"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS-iPadOS_17_BYOAD_Y24M02_STIG.zip"
  json_transform : '.[] | select((.type == "Apple") and (.General.IsActive == "true")) | "Policy: " + .General.Name + " - Require Passcode On Device = \(.Passcode.RequirePasscodeOnDevice // "not defined")"'
  regex          : "Require Passcode On Device ="
  expect         : "Require Passcode On Device = true"
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "AIOS-17-710700 - Apple iOS/iPadOS 17 must implement the management setting: Encrypt backups/Encrypt local backup."
  info           : "If iCloud backups are not encrypted, this could lead to the unauthorized disclosure of DOD sensitive information if non-DOD personnel are able to access that machine. Forcing the backup to be encrypted greatly mitigates the risk of compromising sensitive data. Work data iCloud backup and USB connections to computers are not authorized, but this control provides defense-in-depth for cases in which a user violates policy either intentionally or inadvertently.

SFR ID: FMT_SMF_EXT.1.1 #47"
  solution       : "Install a configuration profile to force encrypted backups to iCloud."
  reference      : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6b.,800-53|CM-7a.,800-53r5|CM-6b.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000366,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Apple_iOS_iPadOS_17_MDFPP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,ITSG-33|CM-7a.,NESA|T3.2.1,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-259779r943662_rule,STIG-ID|AIOS-17-710700,SWIFT-CSCv1|2.3,Vuln-ID|V-259779"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS-iPadOS_17_BYOAD_Y24M02_STIG.zip"
  json_transform : '.[] | select((.type == "Apple") and (.General.IsActive == "true")) | "Policy: " + .General.Name + " - Force Encrypted Backups = \(.Restriction.ForceEncryptedBackups // "not defined")"'
  regex          : "Force Encrypted Backups ="
  expect         : "Force Encrypted Backups = true"
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "AIOS-17-710900 - Apple iOS/iPadOS 17 must implement the management setting: require the user to enter a password when connecting to an AirPlay-enabled device."
  info           : "When a user is allowed to use AirPlay without a password, it may mistakenly associate the iPhone and iPad with an AirPlay-enabled device other than the one intended (i.e., by choosing the wrong one from the AirPlay list displayed). This creates the potential for someone in control of a mistakenly associated device to obtain DOD sensitive information without authorization. Requiring a password before such an association mitigates this risk. Passwords do not require any administration and are not required to comply with any complexity requirements.

SFR ID: FMT_SMF_EXT.1.1 #40"
  solution       : "Install a configuration profile to require the user to enter a password when connecting to an AirPlay-enabled device."
  reference      : "800-171|3.1.1,800-171|3.1.2,800-53|AC-17a.,800-53r5|AC-17a.,CAT|III,CCI|CCI-000063,CN-L3|7.1.2.2(h),CN-L3|7.1.3.7(a),CSF|PR.AC-3,CSF|PR.PT-4,CSF2.0|PR.AA-05,DISA_Benchmark|Apple_iOS_iPadOS_17_MDFPP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17a.,ITSG-33|AC-17b.,NESA|T4.2.1,NESA|T4.5.1,NESA|T5.1.1,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.7.1,NESA|T5.7.2,NIAv2|AM40,NIAv2|AM41,NIAv2|NS5g,NIAv2|NS5h,NIAv2|NS48,NIAv2|NS51,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,Rule-ID|SV-259780r943665_rule,STIG-ID|AIOS-17-710900,SWIFT-CSCv1|2.6,Vuln-ID|V-259780"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS-iPadOS_17_BYOAD_Y24M02_STIG.zip"
  json_transform : '.[] | select((.type == "Apple") and (.General.IsActive == "true")) | "Policy: " + .General.Name + " - Require passcode on first AirPlay pairing = \(.Restriction.RequirepasscodeonfirstAirPlaypairing // "not defined")"'
  regex          : "Require passcode on first AirPlay pairing ="
  expect         : "Require passcode on first AirPlay pairing = true"
</custom_item>

<report type:"WARNING">
  description : "AIOS-17-711200 - iPhone and iPad must have the latest available iOS/iPadOS operating system installed."
  info        : "Required security features are not available in earlier OS versions. In addition, earlier versions may have known vulnerabilities.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Install the latest release version of Apple iOS/iPadOS on all managed iOS devices."
  reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6b.,800-53|CM-7a.,800-53r5|CM-6b.,800-53r5|CM-7a.,CAT|I,CCI|CCI-000366,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Apple_iOS_iPadOS_17_MDFPP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,ITSG-33|CM-7a.,NESA|T3.2.1,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-259782r943671_rule,STIG-ID|AIOS-17-711200,SWIFT-CSCv1|2.3,Vuln-ID|V-259782"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS-iPadOS_17_BYOAD_Y24M02_STIG.zip"
</report>

<report type:"WARNING">
  description : "AIOS-17-711300 - Apple iOS/iPadOS 17 must implement the management setting: use SSL for Exchange ActiveSync."
  info        : "Exchange email messages are a form of data in transit and thus are vulnerable to eavesdropping and man-in-the-middle attacks. Secure Sockets Layer (SSL), also referred to as Transport Layer Security (TLS), provides encryption and authentication services that mitigate the risk of breach.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Install a configuration profile to use SSL for Exchange ActiveSync incoming mail."
  reference   : "800-171|3.5.1,800-53|IA-2,800-53r5|IA-2,CAT|II,CCI|CCI-000764,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|Apple_iOS_iPadOS_17_MDFPP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-259783r943674_rule,STIG-ID|AIOS-17-711300,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-259783"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS-iPadOS_17_BYOAD_Y24M02_STIG.zip"
</report>

<report type:"WARNING">
  description : "AIOS-17-711400 - Apple iOS/iPadOS 17 must implement the management setting: not allow messages in an ActiveSync Exchange account to be forwarded or moved to other accounts in the Apple iOS/iPadOS 17 Mail app."
  info        : "The Apple iOS/iPadOS Mail app can be configured to support multiple email accounts concurrently. These email accounts are likely to involve content of varying degrees of sensitivity (e.g., both personal and enterprise messages). To prevent the unauthorized and undetected forwarding or moving of messages from one account to another, Mail ActiveSync Exchange accounts can be configured to block such behavior. While users may still send a message from the Exchange account to another account, these transactions must involve an Exchange server, enabling audit records of the transaction, filtering of mail content, and subsequent forensic analysis.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Install a configuration profile to prevent Exchange messages from being moved or forwarded between email accounts."
  reference   : "800-171|3.4.2,800-171|3.5.1,800-53|CM-6b.,800-53|IA-2,800-53r5|CM-6b.,800-53r5|IA-2,CAT|II,CCI|CCI-000366,CCI|CCI-000764,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.1.10.6(d),CN-L3|8.5.4.1(a),CSF|PR.AC-1,CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,CSF2.0|PR.PS-01,DISA_Benchmark|Apple_iOS_iPadOS_17_MDFPP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|CM-6b.,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T3.2.1,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-259784r943677_rule,STIG-ID|AIOS-17-711400,SWIFT-CSCv1|2.3,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-259784"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS-iPadOS_17_BYOAD_Y24M02_STIG.zip"
</report>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "AIOS-17-711500 - Apple iOS/iPadOS 17 must implement the management setting: Treat AirDrop as an unmanaged destination."
  info           : "AirDrop is a way to send contact information or photos to other users with AirDrop enabled. This feature enables a possible attack vector for adversaries to exploit. Once the attacker has gained access to the information broadcast by this feature, the attacker may distribute this sensitive information very quickly and without DOD's control or awareness. By disabling this feature, the risk of mass data exfiltration will be mitigated.

Note: If the site uses Apple's optional Automatic Device Enrollment, this control is available as a supervised MDM control.

SFR ID: FMT_SMF_EXT.1.1 #47"
  solution       : "Install a configuration profile to treat AirDrop as an unmanaged destination."
  reference      : "800-171|3.4.2,800-171|3.5.2,800-53|CM-6b.,800-53|IA-5(14),800-53r5|CM-6b.,800-53r5|IA-5(14),CAT|II,CCI|CCI-000366,CCI|CCI-002008,CN-L3|8.1.10.6(d),CSF|PR.AC-1,CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,CSF2.0|PR.PS-01,DISA_Benchmark|Apple_iOS_iPadOS_17_MDFPP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|CM-6b.,ITSG-33|IA-5,NESA|T3.2.1,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-259785r943680_rule,STIG-ID|AIOS-17-711500,SWIFT-CSCv1|2.3,Vuln-ID|V-259785"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS-iPadOS_17_BYOAD_Y24M02_STIG.zip"
  json_transform : '.[] | select((.type == "Apple") and (.General.IsActive == "true")) | "Policy: " + .General.Name + " - Enforce AirDrop as an Unmanaged Drop Destination = \(.Restriction.EnforceAirDropasanunmanageddropdestination // "not defined")"'
  regex          : "Enforce AirDrop as an Unmanaged Drop Destination ="
  expect         : "Enforce AirDrop as an Unmanaged Drop Destination = true"
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "AIOS-17-711800 - Apple iOS/iPadOS 17 must implement the management setting: force Apple Watch wrist detection."
  info           : "Because Apple Watch is a personal device, it is key that any sensitive DOD data displayed on the Apple Watch cannot be viewed when the watch is not in the immediate possession of the user. This control ensures the Apple Watch screen locks when the user takes the watch off, thereby protecting sensitive DOD data from possible exposure.

SFR ID: FMT_SMF_EXT.1.1 #47"
  solution       : "Install a configuration profile to force Apple Watch wrist detection."
  reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|III,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|PR.PS-01,DISA_Benchmark|Apple_iOS_iPadOS_17_MDFPP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-259786r943683_rule,STIG-ID|AIOS-17-711800,SWIFT-CSCv1|2.3,Vuln-ID|V-259786"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS-iPadOS_17_BYOAD_Y24M02_STIG.zip"
  json_transform : '.[] | select((.type == "Apple") and (.General.IsActive == "true")) | "Policy: " + .General.Name + " - Enforce Wrist Detection on Apple Watch = \(.Restriction.EnforceWristDetectiononAppleWatch // "not defined")"'
  regex          : "Enforce Wrist Detection on Apple Watch ="
  expect         : "Enforce Wrist Detection on Apple Watch = true"
</custom_item>

<report type:"WARNING">
  description : "AIOS-17-711900 - Apple iOS/iPadOS 17 users must complete required training."
  info        : "The security posture on iOS devices requires the device user to configure several required policy rules on their device. User-Based Enforcement (UBE) is required for these controls. In addition, if the authorizing official (AO) has approved users' full access to the Apple App Store, users must receive training on risks. If a user is not aware of their responsibilities and does not comply with UBE requirements, the security posture of the iOS mobile device and DOD sensitive data may become compromised.

SFR ID: NA

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Have all iPhone and iPad users complete training on the following topics. Users must acknowledge receipt of training via a signed User Agreement or similar written record.

Training topics:
- How to ensure 'USB Restricted Mode' is disabled on Apple device.
- Operational security concerns introduced by unmanaged applications, including applications using global positioning system (GPS) tracking.
- Must ensure no DOD data is saved in an unmanaged app or transmitted from a personal app (for example, from personal email).
- If the Purebred key management app is used, users are responsible for maintaining positive control of their credentialed device at all times. The DOD PKI certificate policy requires subscribers to maintain positive control of the devices that contain private keys and report any loss of control so the credentials can be revoked. Upon device retirement, turn in, or reassignment, ensure a factory data reset is performed prior to device handoff. Follow mobility service provider decommissioning procedures as applicable.
- Screenshots will not be taken of any work-related managed data.

For User Enrollment sites:
- How to configure inactivity timeout.
- How to configure force device erase after 10 incorrect password attempts."
  reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6b.,800-53|CM-7a.,800-53r5|CM-6b.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000366,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Apple_iOS_iPadOS_17_MDFPP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,ITSG-33|CM-7a.,NESA|T3.2.1,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-259787r943686_rule,STIG-ID|AIOS-17-711900,SWIFT-CSCv1|2.3,Vuln-ID|V-259787"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS-iPadOS_17_BYOAD_Y24M02_STIG.zip"
</report>

<report type:"WARNING">
  description : "AIOS-17-710950 - Apple iOS/iPadOS 17 must implement the management setting: require passcode for incoming Airplay connection requests."
  info        : "When an incoming AirPlay request is allowed without a password, it may mistakenly associate the iPhone and iPad with an AirPlay-enabled device other than the one intended (i.e., by choosing the wrong one from the AirPlay list displayed). This creates the potential for someone in control of a mistakenly associated device to obtain DOD sensitive information without authorization. Requiring a password before such an association mitigates this risk. Passwords do not require any administration and are not required to comply with any complexity requirements.

SFR ID: FMT_SMF_EXT.1.1 #40

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Install a configuration profile to require that incoming AirPlay connection requests enter a password when connecting to a DOD iOS/iPadOS device."
  reference   : "800-171|3.1.1,800-171|3.1.2,800-53|AC-17a.,800-53r5|AC-17a.,CAT|III,CCI|CCI-000063,CN-L3|7.1.2.2(h),CN-L3|7.1.3.7(a),CSF|PR.AC-3,CSF|PR.PT-4,CSF2.0|PR.AA-05,DISA_Benchmark|Apple_iOS_iPadOS_17_MDFPP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17a.,ITSG-33|AC-17b.,NESA|T4.2.1,NESA|T4.5.1,NESA|T5.1.1,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.7.1,NESA|T5.7.2,NIAv2|AM40,NIAv2|AM41,NIAv2|NS5g,NIAv2|NS5h,NIAv2|NS48,NIAv2|NS51,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,Rule-ID|SV-259781r943668_rule,STIG-ID|AIOS-17-710950,SWIFT-CSCv1|2.6,Vuln-ID|V-259781"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS-iPadOS_17_BYOAD_Y24M02_STIG.zip"
</report>

<report type:"WARNING">
  description : "AIOS-17-712000 - A managed photo app must be used to take and store work-related photos."
  info        : "The iOS Photos app is unmanaged and may sync photos with a device user's personal iCloud account. Therefore, work-related photos must not be taken via the iOS camera app or stored in the Photos app. A managed photo app must be used to take and manage work-related photos.

SFR ID: NA

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Install a managed photos app to take and manage work-related photos."
  reference   : "800-171|3.1.21,800-53|AC-20(2),800-53r5|AC-20(2),CAT|II,CCI|CCI-000097,CSF|ID.AM-4,CSF|PR.AC-3,CSF2.0|ID.AM-02,CSF2.0|ID.AM-04,DISA_Benchmark|Apple_iOS_iPadOS_17_MDFPP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-20(2),NESA|M1.3.5,NESA|T1.2.3,QCSC-v1|3.2,QCSC-v1|5.2.2,Rule-ID|SV-259788r943689_rule,STIG-ID|AIOS-17-712000,SWIFT-CSCv1|2.5,Vuln-ID|V-259788"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS-iPadOS_17_BYOAD_Y24M02_STIG.zip"
</report>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "AIOS-17-712300 - Apple iOS/iPadOS 17 must not allow managed apps to write contacts to unmanaged contacts accounts."
  info           : "Managed apps have been approved for the handling of DOD sensitive information. Unmanaged apps are provided for productivity and morale purposes but are not approved to handle DOD sensitive information. Examples of unmanaged apps include those for news services, travel guides, maps, and social networking. If a document were to be viewed in a managed app and the user had the ability to open this same document in an unmanaged app, this could lead to the compromise of sensitive DOD data. In some cases, the unmanaged apps are connected to cloud backup or social networks that would permit dissemination of DOD sensitive information to unauthorized individuals. Not allowing data to be opened within unmanaged apps mitigates the risk of compromising sensitive data.

SFR ID: FMT_SMF_EXT.1.1 #42, FDP_ACF_EXT.1.2"
  solution       : "Install a configuration profile to prevent managed apps from writing contacts to unmanaged contacts accounts."
  reference      : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Apple_iOS_iPadOS_17_MDFPP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-259789r943692_rule,STIG-ID|AIOS-17-712300,SWIFT-CSCv1|2.3,Vuln-ID|V-259789"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS-iPadOS_17_BYOAD_Y24M02_STIG.zip"
  json_transform : '.[] | select((.type == "Apple") and (.General.IsActive == "true")) | "Policy: " + .General.Name + " - Enforce managed apps to write to unmanaged contacts = \(.Restriction.AllowManagedToWriteUnmanagedContacts // "not defined")"'
  regex          : "Enforce managed apps to write to unmanaged contacts ="
  expect         : "Enforce managed apps to write to unmanaged contacts = true"
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "AIOS-17-712400 - Apple iOS/iPadOS 17 must not allow unmanaged apps to read contacts from managed contacts accounts."
  info           : "Managed apps have been approved for the handling of DOD sensitive information. Unmanaged apps are provided for productivity and morale purposes but are not approved to handle DOD sensitive information. Examples of unmanaged apps include those for news services, travel guides, maps, and social networking. If a document were to be viewed in a managed app and the user had the ability to open this same document in an unmanaged app, this could lead to the compromise of sensitive DOD data. In some cases, the unmanaged apps are connected to cloud backup or social networks that would permit dissemination of DOD sensitive information to unauthorized individuals. Not allowing data to be opened within unmanaged apps mitigates the risk of compromising sensitive data.

SFR ID: FMT_SMF_EXT.1.1 #42, FDP_ACF_EXT.1.2"
  solution       : "Install a configuration profile to prevent unmanaged apps from reading contacts from managed contacts accounts."
  reference      : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Apple_iOS_iPadOS_17_MDFPP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-259790r943695_rule,STIG-ID|AIOS-17-712400,SWIFT-CSCv1|2.3,Vuln-ID|V-259790"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS-iPadOS_17_BYOAD_Y24M02_STIG.zip"
  json_transform : '.[] | select((.type == "Apple") and (.General.IsActive == "true")) | "Policy: " + .General.Name + " - Enforce unmanaged apps to write to managed contacts = \(.Restriction.AllowUnmanagedToReadManagedContacts // "not defined")"'
  regex          : "Enforce unmanaged apps to write to managed contacts ="
  expect         : "Enforce unmanaged apps to write to managed contacts = true"
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "AIOS-17-713400 - The Apple iOS must be configured to disable automatic transfer of diagnostic data to an external device other than an MDM service with which the device has enrolled."
  info           : "Many software systems automatically send diagnostic data to the manufacturer or a third party. This data enables the developers to understand real-world field behavior and improve the product based on that information. Unfortunately, it can also reveal information about what DOD users are doing with the systems and what causes them to fail. An adversary embedded within the software development team or elsewhere could use the information acquired to breach mobile operating system security. Disabling automatic transfer of such information mitigates this risk.

SFR ID: FMT_SMF_EXT.1.1 #47a"
  solution       : "Install a configuration profile to disable sending diagnostic data to an organization other than DOD."
  reference      : "800-171|3.13.16,800-53|SC-28,800-53r5|SC-28,CAT|III,CCI|CCI-001199,CN-L3|8.1.4.7(b),CN-L3|8.1.4.8(b),CSF|PR.DS-1,CSF2.0|PR.DS-01,DISA_Benchmark|Apple_iOS_iPadOS_17_MDFPP_3-3_BYOAD_STIG,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ITSG-33|SC-28,ITSG-33|SC-28a.,PCI-DSSv3.2.1|3.4,PCI-DSSv4.0|3.3.2,PCI-DSSv4.0|3.5.1,QCSC-v1|5.2.2,QCSC-v1|6.2,Rule-ID|SV-259791r943698_rule,STIG-ID|AIOS-17-713400,Vuln-ID|V-259791"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS-iPadOS_17_BYOAD_Y24M02_STIG.zip"
  json_transform : '.[] | select((.type == "Apple") and (.General.IsActive == "true")) | "Policy: " + .General.Name + " - Allow Diagnostic Data To Be Sent To Apple = \(.Restriction.AllowDiagnosticDataToBeSentToApple // "not defined")"'
  regex          : "Allow Diagnostic Data To Be Sent To Apple ="
  expect         : "Allow Diagnostic Data To Be Sent To Apple = false"
</custom_item>

<report type:"WARNING">
  description : "AIOS-17-714600 - Apple iOS/iPadOS 17 must disable copy/paste of data from managed to unmanaged applications."
  info        : "If a user is able to configure the security setting, the user could inadvertently or maliciously set it to a value that poses unacceptable risk to DOD information systems. An adversary could exploit vulnerabilities created by the weaker configuration to compromise DOD sensitive information.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the Apple iOS configuration profile to disable copy/paste of data from managed to unmanaged applications.

The procedure for implementing this control will vary depending on the MDM/EMM used by the mobile service provider.

In the MDM console, set 'Require managed pasteboard' to 'True'."
  reference   : "800-171|3.1.21,800-171|3.4.2,800-53|AC-20(2),800-53|CM-6b.,800-53r5|AC-20(2),800-53r5|CM-6b.,CAT|II,CCI|CCI-000097,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|ID.AM-4,CSF|PR.AC-3,CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|ID.AM-02,CSF2.0|ID.AM-04,CSF2.0|PR.PS-01,DISA_Benchmark|Apple_iOS_iPadOS_17_MDFPP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-20(2),ITSG-33|CM-6b.,NESA|M1.3.5,NESA|T1.2.3,NESA|T3.2.1,QCSC-v1|3.2,QCSC-v1|5.2.2,Rule-ID|SV-259792r943701_rule,STIG-ID|AIOS-17-714600,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,Vuln-ID|V-259792"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS-iPadOS_17_BYOAD_Y24M02_STIG.zip"
</report>

<report type:"WARNING">
  description : "AIOS-17-714700 - Apple iOS/iPadOS 17 must have DOD root and intermediate PKI certificates installed."
  info        : "DOD root and intermediate PKI certificates are used to verify the authenticity of PKI certificates of users and web services. If the user is allowed to remove root and intermediate certificates, the user could allow an adversary to falsely sign a certificate in such a way that it could not be detected. Restricting the ability to remove DOD root and intermediate PKI certificates to the administrator mitigates this risk.

SFR ID: FMT_MOF_EXT.1.2 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Install DOD intermediate and root certificates on managed mobile devices using the MDM."
  reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Apple_iOS_iPadOS_17_MDFPP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-259793r943704_rule,STIG-ID|AIOS-17-714700,SWIFT-CSCv1|2.3,Vuln-ID|V-259793"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS-iPadOS_17_BYOAD_Y24M02_STIG.zip"
</report>

<report type:"WARNING">
  description : "AIOS-17-714900 - Apple iOS/iPadOS 17 must not allow DOD applications to access non-DOD data."
  info        : "App data sharing gives apps the ability to access the data of other apps for enhanced user functionality. However, sharing also poses a significant risk that unauthorized users or apps will obtain access to sensitive DOD information. To mitigate this risk, there are data sharing restrictions. If a user is allowed to make exceptions to the data sharing restriction policy, the user could enable unauthorized sharing of data, leaving it vulnerable to breach. Limiting the granting of exceptions to either the administrator or common application developer mitigates this risk.

Copy/paste of data between applications in different application processes or groups of application processes is considered an exception to the access control policy; therefore, the administrator must be able to enable/disable the feature. Other exceptions include allowing any data or application sharing between process groups.

SFR ID: FMT_SMF_EXT.1.1 #42, FDP_ACF_EXT.1.2

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Install a configuration profile to prevent DOD applications from accessing non-DOD data."
  reference   : "800-171|3.1.5,800-53|AC-6(8),800-53|SC-39,800-53r5|AC-6(8),800-53r5|SC-39,CAT|II,CCI|CCI-002233,CCI|CCI-002530,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,CSF2.0|PR.AA-05,CSF2.0|PR.DS-01,CSF2.0|PR.DS-10,CSF2.0|PR.IR-03,DISA_Benchmark|Apple_iOS_iPadOS_17_MDFPP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,Rule-ID|SV-259794r943707_rule,STIG-ID|AIOS-17-714900,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,Vuln-ID|V-259794"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS-iPadOS_17_BYOAD_Y24M02_STIG.zip"
</report>

</check_type>
