#TRUSTED 19a3a9632a7f7c24be8acf231ec619c471ef9579ad77988b90f6ab0f8807dbaf5b5c8f7c77de4efef5594e5bfcf1f741db41f8bfd1cee639f2e6fe66d33918bed58d8a97fb947dd8ef7e1c626366f5d9d836a69613ddf8614c5eaf747f2bce6978bc6872c8a5bf188bfdf67d9760c96edec72ffcae299611095562e8385bfc8d46708c24f2b1179696b66af8ce9e3381aca3e80e17f37c2fee506787fe2fad8e905ba68ef765b0980052cddcf13074fa2f04c76ecfa91ebf24ab75c89f0209f46446dbbacf9a842518076e56f4cb92bd8f2cdbfadbd7594d361c41c2586f149a6cd1a82a5c1dcdd7bd4f86c492ca2ae5bd6d23b340b872763815614be1b22256d002fec5fccab4ec961977c7dca93d23e964d3902738b03b6f0a4fe5242142612a21882196b6dc6bcbe435fb52898b4cce4c760ed755ac2a3fb65cd4bb9e2cd90a8b5bb77f3bc5ab5202cc4eb2f7a310052fe6dfecaf1a4ac25f9061e6af1695b8621f7d00e54d94d0e98653d34e302a1069a0adb307a2c00c31ee62ac2b20a023f81a3f400c16ab97559fbc0de3ec115c978a4cfce9ab8113776deed51a8ff879e082e0ec343cc9aa070d189f2f8ba883efc74562d0268a5b7fe2f541a1a2806e70f375e952c582f81a7feebf3496cda9eb37af213a9be74899f31a3dfd3ce6b1ad4ce11eea61de4661c5412d1993bac4818cff0971374c458879f3b620a771
#TRUST-RSA-SHA256 7f7d10bfe53144b5f9a2143e85e9b1f47ff7361024f711fc4c20ed329d88118dc2ac95f08442a21aa786ddcee6acfe549a9c62a269ed23bc60f92dff5b0e3e6bd3b58f69f32040f7caa5071248d60c299840f8fa591a23c30d27575bd81569b18dbc09fb3c8c5c54e0e7186bcbe1bb8f6b821a08cd1baed14d5eb865a4f7550ab12f5af7531eb2ab053dc4d1c3a1c2d813f4a7622f1ba2193c3172a9d19d38b84c0b3df7f50128cc4e6e18ebd58fd5af266a1e0fe7613d6318a177d64cb244cf2bae40d4fe8e38231d43ce31debee841931fe6e463272831613c3d3f9459d0b9259dfda0e553efb485af00b8e2a632a5963790b3ce8d27a0edf4c42705afd0ae9bc53f0e4c418e437073ff2e6cadee6930421dda15191e3456edd32f2be4bfcbbf187a44e95c2e3cd5d11f7ec1feb9cdc7ff6defa5af6fa8ba67329d0a161a689f27aa03b34c67a6f3245f007b2e669b4a005edd5474f7471439a35b5809d258e6cb9b61ea2448994d23a4212dc0fae80b1cab79be255df95035bc62ad00a4d80d022f1c2fd4177e01f75f243d6d14d5dbfc09bd1cddadbaaae87cf27c314dd9326b05f2dc6db93708d1ebeaa2bbe77713cfe34f624a81974dc9ad65e28d644d072a76776cdfa228671b33df6ea3f81eba6848a8c6d8232cdd8545c8c6c5c74ef58171e5e37cc628e297cb47cd19df99af457485c06644c32e2e2b765b28f31b
#
# This script is Copyright (C) 2004-2024 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
# $Revision: 1.0 $
# $Date: 2024/08/19 $
#
# Description : This document implements the security configuration as recommended by the
#               DISA Honeywell Android 9.x COBO v1r2 STIG.
#
#<ui_metadata>
#<display_name>AirWatch - DISA Honeywell Android 9.x COBO v1r2</display_name>
#<spec>
#  <type>DISA STIG</type>
#  <name>Honeywell Android 9.x</name>
#  <profile>COBO Airwatch</profile>
#  <version>1.2.0</version>
#  <link>https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_HW_Android_9-x_Y24M01_STIG.zip</link>
#</spec>
#<labels>mdm,airwatch,android,honeywell,update_20230227</labels>
#<benchmark_refs>CAT,CCE,CCI,DISA_Benchmark,Group-ID,Rule-ID,STIG-ID,STIG-Legacy,Vuln-ID</benchmark_refs>
#<variables>
#  <variable>
#    <name>WHITELIST</name>
#    <default>.*</default>
#    <description>Device Application Whitelist</description>
#    <info>This is a comma separated whitelist of applications. Only these applications may be present on the device. Use a variable value of '.*' if this check is N/A for your organization, otherwise use a format like 'application_name1,application_name2,etc'.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>BLACKLIST</name>
#    <default>!@#$%$#@!</default>
#    <description>Device Application Blacklist</description>
#    <info>This is a comma separated blacklist of applications. None of these applications may be present on the device. Use a variable value of !@#$%$#@!' if this check is N/A for your organization, otherwise use a format like 'application_name1,application_name2,etc'.</info>
#    <value_type>STRING</value_type>
#  </variable>
#</variables>
#</ui_metadata>

<check_type:"MDM" mdm_type:AIRWATCH>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "HONW-09-000100 - The Honeywell Mobility Edge Android Pie device must be configured to enforce a minimum password length of six characters."
  info           : "Password strength is a measure of the effectiveness of a password in resisting guessing and brute force attacks. The ability to crack a password is a function of how many attempts an adversary is permitted, how quickly an adversary can do each attempt, and the size of the password space. The longer the minimum length of the password is, the larger the password space. Having a too-short minimum password length significantly reduces password strength, increasing the chance of password compromise, and resulting device and data compromise.

SFR ID: FMT_SMF_EXT.1.1 #1a"
  solution       : "Configure the Honeywell Android device to enforce a minimum password length of six characters.

On the MDM console:
1. Open password requirements.
2. Open device password section.
3. Enter in the number of characters as '6'."
  reference      : "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(a),CAT|II,CCI|CCI-000205,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|HW_Android_9-x_COBO_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-235035r626530_rule,STIG-ID|HONW-09-000100,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-235035"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_HW_Android_9-x_Y24M01_STIG.zip"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                  "Profile: " + .General.Name + " - Passcode Length = \(.Passcode.MinimumPasscodeLength? // "Not Defined")"'
  regex          : "Passcode Length ="
  expect         : "Passcode Length = ([6-9]|[1-8][0-9]|9[0-9])"
  match_all      : YES
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "HONW-09-000200 - The Honeywell Mobility Edge Android Pie device must be configured to not allow passwords that include more than two repeating or sequential characters - Characters"
  info           : "Password strength is a measure of the effectiveness of a password in resisting guessing and brute force attacks. Passwords that contain repeating or sequential characters are significantly easier to guess than those that do not contain repeating or sequential characters. Therefore, disallowing repeating or sequential characters increases password strength and decreases risk.

SFR ID: FMT_SMF_EXT.1.1 #1b"
  solution       : "Configure the Honeywell Android device to prevent passwords from containing more than two repeating or sequential characters.

On the MDM console:
1. Open password requirements.
2. Open device password section.
3. Set password quality to 'Numeric (Complex)'.

NOTE: Alphabetic, Alphanumeric, and Complex are also acceptable selections, but these will cause the user to select a complex password, which is not required by the STIG."
  reference      : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|HW_Android_9-x_COBO_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-235036r626530_rule,STIG-ID|HONW-09-000200,SWIFT-CSCv1|2.3,Vuln-ID|V-235036"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_HW_Android_9-x_Y24M01_STIG.zip"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                  "Profile: " + .General.Name + " - Maximum Repeating Characters = \(.Passcode.MaximumRepeatCharacters? // "Not Defined")"'
  regex          : "Maximum Repeating Characters ="
  expect         : "Maximum Repeating Characters = [1-2]"
  match_all      : YES
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "HONW-09-000200 - The Honeywell Mobility Edge Android Pie device must be configured to not allow passwords that include more than two repeating or sequential characters - Numbers"
  info           : "Password strength is a measure of the effectiveness of a password in resisting guessing and brute force attacks. Passwords that contain repeating or sequential characters are significantly easier to guess than those that do not contain repeating or sequential characters. Therefore, disallowing repeating or sequential characters increases password strength and decreases risk.

SFR ID: FMT_SMF_EXT.1.1 #1b"
  solution       : "Configure the Honeywell Android device to prevent passwords from containing more than two repeating or sequential characters.

On the MDM console:
1. Open password requirements.
2. Open device password section.
3. Set password quality to 'Numeric (Complex)'.

NOTE: Alphabetic, Alphanumeric, and Complex are also acceptable selections, but these will cause the user to select a complex password, which is not required by the STIG."
  reference      : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|HW_Android_9-x_COBO_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-235036r626530_rule,STIG-ID|HONW-09-000200,SWIFT-CSCv1|2.3,Vuln-ID|V-235036"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_HW_Android_9-x_Y24M01_STIG.zip"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                  "Profile: " + .General.Name + " - Maximum Repeating Numbers = \(.Passcode.MaximumLengthOfNumericSequences? // "Not Defined")"'
  regex          : "Maximum Repeating Numbers ="
  expect         : "Maximum Repeating Numbers = [1-2]"
  match_all      : YES
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "HONW-09-000300 - The Honeywell Mobility Edge Android Pie device must be configured to enable a screen-lock policy that will lock the display after a period of inactivity."
  info           : "The screen-lock timeout helps protect the device from unauthorized access. Devices without a screen-lock timeout provide an opportunity for adversaries who gain physical access to the mobile device through loss, theft, etc. Such devices are much more likely to be in an unlocked state when acquired by an adversary, thus granting immediate access to the data on the mobile device, and possibly access to DoD networks.

SFR ID: FMT_SMF_EXT.1.1 #2a"
  solution       : "Configure the Honeywell Android device to enable a screen-lock policy that will lock the display after a period of inactivity.

On the MDM console:
1. Open password requirements.
2. Open device password section.
3. Set 'Device Lock Timeout' to any number desired. Units are in minutes."
  reference      : "800-171|3.1.10,800-53|AC-11a.,800-53r5|AC-11a.,CAT|II,CCI|CCI-000057,CN-L3|8.1.4.1(b),DISA_Benchmark|HW_Android_9-x_COBO_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11a.,NESA|T2.3.8,NESA|T2.3.9,NIAv2|AM23a,NIAv2|AM23b,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,Rule-ID|SV-235037r626530_rule,STIG-ID|HONW-09-000300,Vuln-ID|V-235037"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_HW_Android_9-x_Y24M01_STIG.zip"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                  "Profile: " + .General.Name + " - Security Inactivity Timeout = \(.Passcode.DeviceLockTimeoutInMinutes? // "Not Defined")"'
  regex          : "Security Inactivity Timeout ="
  expect         : "Security Inactivity Timeout = [0-9]+"
  match_all      : YES
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "HONW-09-000400 - The Honeywell Mobility Edge Android Pie device must be configured to lock the display after 15 minutes (or less) of inactivity - or less of inactivity."
  info           : "The screen lock timeout must be set to a value that helps protect the device from unauthorized access. Having a too-long timeout would increase the window of opportunity for adversaries who gain physical access to the mobile device through loss, theft, etc. Such devices are much more likely to be in an unlocked state when acquired by an adversary, thus granting immediate access to the data on the mobile device. The maximum timeout period of 15 minutes has been selected to balance functionality and security; shorter timeout periods may be appropriate depending on the risks posed to the mobile device.

SFR ID: FMT_SMF_EXT.1.1 #2b"
  solution       : "Configure the Honeywell Android device to lock the device display after 15 minutes (or less) of inactivity.

On the MDM console:
1. Open password requirements.
2. Open device password section.
3. Set 'Device Lock Timeout' to any number between 1 and 15."
  reference      : "800-171|3.1.10,800-53|AC-11a.,800-53r5|AC-11a.,CAT|II,CCI|CCI-000057,CN-L3|8.1.4.1(b),DISA_Benchmark|HW_Android_9-x_COBO_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11a.,NESA|T2.3.8,NESA|T2.3.9,NIAv2|AM23a,NIAv2|AM23b,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,Rule-ID|SV-235038r626530_rule,STIG-ID|HONW-09-000400,Vuln-ID|V-235038"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_HW_Android_9-x_Y24M01_STIG.zip"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                  "Profile: " + .General.Name + " - Security Inactivity Timeout = \(.Passcode.DeviceLockTimeoutInMinutes? // "Not Defined")"'
  regex          : "Security Inactivity Timeout ="
  expect         : "Security Inactivity Timeout = ([1-9]|[1-8][0-9]|9[0-9]|[1-8][0-9]{2}|900)"
  match_all      : YES
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "HONW-09-000500 - The Honeywell Mobility Edge Android Pie device must be configured to not allow more than 10 consecutive failed authentication attempts."
  info           : "The more attempts an adversary has to guess a password, the more likely the adversary will enter the correct password and gain access to resources on the device. Setting a limit on the number of attempts mitigates this risk. Setting the limit at 10 or less gives authorized users the ability to make a few mistakes when entering the password but still provides adequate protection against dictionary or brute force attacks on the password.

SFR ID: FMT_SMF_EXT.1.1 #2c, FIA_AFL_EXT.1.5"
  solution       : "Configure the Honeywell Android device to allow only 10 or fewer consecutive failed authentication attempts.

On the MDM console:
1. Open password requirements.
2. Open device password section.
3. Set 'Maximum Number of Failed Attempts' to a number between 1 and 10."
  reference      : "800-171|3.1.8,800-53|AC-7a.,800-53r5|AC-7a.,CAT|III,CCI|CCI-000044,CN-L3|8.1.4.1(b),CSF2.0|PR.AA-03,DISA_Benchmark|HW_Android_9-x_COBO_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-7a.,NESA|T5.5.1,NIAv2|AM24,PCI-DSSv3.2.1|8.1.6,PCI-DSSv4.0|8.3.4,Rule-ID|SV-235039r626530_rule,STIG-ID|HONW-09-000500,TBA-FIISB|45.1.2,TBA-FIISB|45.2.1,TBA-FIISB|45.2.2,Vuln-ID|V-235039"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_HW_Android_9-x_Y24M01_STIG.zip"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                  "Profile: " + .General.Name + " - Failed Authentication Attempts = \(.Passcode.MaximumNumberOfFailedAttempts? // "Not Defined")"'
  regex          : "Failed Authentication Attempts ="
  expect         : "Failed Authentication Attempts = ([1-9]|10)"
  match_all      : YES
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "HONW-09-000800 - The Honeywell Mobility Edge Android Pie device must be configured to enforce an application installation policy by specifying one or more authorized application repositories, including [selection: DoD-approved commercial app repository, MDM server, mobile application store] - Unknown Sources"
  info           : "Forcing all applications to be installed from authorized application repositories can prevent unauthorized and malicious applications from being installed and executed on mobile devices. Allowing such installations and executions could cause a compromise of DoD data accessible by these unauthorized/malicious applications.

SFR ID: FMT_SMF_EXT.1.1 #8a"
  solution       : "Configure the Honeywell Android device to disable unauthorized application repositories.

On the MDM console:
1. Open Restrictions section.
2. Set Allow 'Honeywell Play' (Uses only Managed Honeywell Play).
3. Set Disallow 'Install unknown sources'."
  reference      : "800-171|3.4.2,800-171|3.4.9,800-53|CM-6b.,800-53|CM-11b.,800-53r5|CM-6b.,800-53r5|CM-11b.,CAT|II,CCI|CCI-000366,CCI|CCI-001806,CN-L3|8.1.10.6(d),CSF|DE.CM-3,CSF|PR.IP-1,CSF2.0|DE.CM-03,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,CSF2.0|PR.PS-02,DISA_Benchmark|HW_Android_9-x_COBO_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.6.2,ITSG-33|CM-6b.,NESA|T3.2.1,QCSC-v1|8.2.1,Rule-ID|SV-235040r852700_rule,STIG-ID|HONW-09-000800,SWIFT-CSCv1|2.3,SWIFT-CSCv1|5.1,Vuln-ID|V-235040"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_HW_Android_9-x_Y24M01_STIG.zip"
  json_transform : '.[] | select((.type == "Android") and (.General.IsActive == "true")) | "Policy: " + .General.Name + " - Allow Non Market App Installation = \(if (.Restriction.Restriction) then "not defined" else (.Restriction.AllowNonMarketAppInstallation // "not defined") end)"'
  regex          : "Allow Non Market App Installation ="
  expect         : "Allow Non Market App Installation = false"
  match_all      : YES
</custom_item>

<custom_item>
  type           : APP_INFO_BY_DEVICE
  description    : "HONW-09-001000 - The Honeywell Mobility Edge Android Pie device must be configured to enforce an application installation policy by specifying an application whitelist that restricts applications by the following characteristics: [selection: list of digital signatures, cryptographic hash values, names, application version]."
  info           : "The application whitelist, in addition to controlling the installation of applications on the MD, must control user access/execution of all core and preinstalled applications, or the MD must provide an alternate method of restricting user access/execution to core and pre-installed applications.

Core application: Any application integrated into the OS by the OS or MD vendors.

Pre-installed application: Additional non-core applications included in the OS build by the OS vendor, MD vendor, or wireless carrier.

Requiring all authorized applications to be in an application whitelist prevents the execution of any applications (e.g., unauthorized, malicious) that are not part of the whitelist. Failure to configure an application whitelist properly could allow unauthorized and malicious applications to be downloaded, installed, and executed on the mobile device, causing a compromise of DoD data accessible by these applications.

The application whitelist, in addition to controlling the installation of applications on the MD, must control user access/execution of all core applications (included in the OS by the OS vendor) and pre-installed applications (provided by the MD vendor and wireless carrier), or the MD must provide an alternate method of restricting user access/execution to core and pre-installed applications.

SFR ID: FMT_SMF_EXT.1.1 #8b"
  solution       : "Configure the Honeywell Android device to use an application whitelist.

On the MDM console:
1. Go to the Android app catalog for managed Honeywell Play.
2. Select apps to be available (only approved apps).
3. Push updated policy to the device.

NOTE: Managed Honeywell Play is always a Whitelisted App Store."
  reference      : "800-171|3.4.2,800-171|3.4.9,800-53|CM-6b.,800-53|CM-11b.,800-53r5|CM-6b.,800-53r5|CM-11b.,CAT|II,CCI|CCI-000366,CCI|CCI-001806,CN-L3|8.1.10.6(d),CSF|DE.CM-3,CSF|PR.IP-1,CSF2.0|DE.CM-03,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,CSF2.0|PR.PS-02,DISA_Benchmark|HW_Android_9-x_COBO_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.6.2,ITSG-33|CM-6b.,NESA|T3.2.1,QCSC-v1|8.2.1,Rule-ID|SV-235041r852701_rule,STIG-ID|HONW-09-001000,SWIFT-CSCv1|2.3,SWIFT-CSCv1|5.1,Vuln-ID|V-235041"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_HW_Android_9-x_Y24M01_STIG.zip"
  json_transform : '(.apps | map(.ApplicationName + " " + .Version)) | whitelist |
                if (length > 0) then
                   hostname + " has one or more non-whitelisted item(s):\n  - " + join("\n  - ")
                else
                   hostname + " All items were whitelisted."
                end'
  regex          : ''
  expect         : 'All items were whitelisted.'
  bw_list        : "@WHITELIST@"
</custom_item>

<custom_item>
  type           : APP_INFO_BY_DEVICE
  description    : "HONW-09-001100 - The Honeywell Mobility Edge Android Pie device whitelist must be configured to not include applications with the following characteristics:"
  info           : "- back up MD data to non-DoD cloud servers (including user and application access to cloud backup services);
- transmit MD diagnostic data to non-DoD servers;
- voice assistant application if available when MD is locked;
- voice dialing application if available when MD is locked;
- allows synchronization of data or applications between devices associated with user; and
- allows unencrypted (or encrypted but not FIPS 140-2 validated) data sharing with other MDs or printers - allows unencrypted (or encrypted but not FIPS 140-2 validated) data sharing with other MDs or printers.

Requiring all authorized applications to be in an application whitelist prevents the execution of any applications (e.g., unauthorized, malicious) that are not part of the whitelist. Failure to configure an application whitelist properly could allow unauthorized and malicious applications to be downloaded, installed, and executed on the mobile device, causing a compromise of DoD data accessible by these applications. Applications with the listed characteristics have features that can cause the compromise of sensitive DoD data or have features with no known application in the DoD environment.

Application note: The application whitelist, in addition to controlling the installation of applications on the MD, must control user access/execution of all core and preinstalled applications, or the MD must provide an alternate method of restricting user access/execution to core and pre-installed applications.

Core application: Any application integrated into the OS by the OS or MD vendors.

Pre-installed application: Additional non-core applications included in the OS build by the OS vendor, MD vendor, or wireless carrier.

SFR ID: FMT_SMF_EXT.1.1 #8b"
  solution       : "Configure the Honeywell Android device application whitelist to exclude applications with the following characteristics:

- back up MD data to non-DoD cloud servers (including user and application access to cloud backup services);
- transmit MD diagnostic data to non-DoD servers;
- voice assistant application if available when MD is locked;
- voice dialing application if available when MD is locked;
- allows synchronization of data or applications between devices associated with user;
- payment processing; and
- allows unencrypted (or encrypted but not FIPS 140-2 validated) data sharing with other MDs, display screens (screen mirroring), or printers.

On the MDM console:
1. Go to the Android app catalog for managed Honeywell Play.
2. Before selecting an app, review the app details and privacy policy to ensure the app does not include prohibited characteristics."
  reference      : "800-171|3.4.2,800-171|3.4.9,800-53|CM-6b.,800-53|CM-11b.,800-53r5|CM-6b.,800-53r5|CM-11b.,CAT|II,CCI|CCI-000366,CCI|CCI-001806,CN-L3|8.1.10.6(d),CSF|DE.CM-3,CSF|PR.IP-1,CSF2.0|DE.CM-03,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,CSF2.0|PR.PS-02,DISA_Benchmark|HW_Android_9-x_COBO_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.6.2,ITSG-33|CM-6b.,NESA|T3.2.1,QCSC-v1|8.2.1,Rule-ID|SV-235042r852702_rule,STIG-ID|HONW-09-001100,SWIFT-CSCv1|2.3,SWIFT-CSCv1|5.1,Vuln-ID|V-235042"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_HW_Android_9-x_Y24M01_STIG.zip"
  json_transform : '(.apps | map(.ApplicationName + " " + .Version)) | blacklist |
                if (length > 0) then
                   hostname + " has one or more blacklisted item(s):\n  - " + join("\n  - ")
                else
                   hostname + " No blacklisted items found."
                end'
  regex          : ''
  expect         : 'No blacklisted items found.'
  bw_list        : "@BLACKLIST@"
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "HONW-09-001400 - The Honeywell Mobility Edge Android Pie device must be configured to disable Bluetooth or configured via User Based Enforcement (UBE) to allow Bluetooth for only HSP (Headset Profile), HFP (HandsFree Profile), or SPP (Serial Port Profile) capable devices - Serial Port Profile capable devices."
  info           : "Some Bluetooth profiles provide the capability for remote transfer of sensitive DoD data without encryption or otherwise do not meet DoD IT security policies and therefore should be disabled.

SFR ID: FMT_SMF_EXT.1.1 #18h

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution       : "Configure the Honeywell Android device to disable Bluetooth or if the AO has approved the use of Bluetooth (for example, for car handsfree use), train the user to connect to only authorized Bluetooth devices using only HSP, HFP, or SPP Bluetooth capable devices (User Based Enforcement [UBE]).

To disable Bluetooth use the following procedure:

On the MDM console:
1. Open Restrictions section.
2. Toggle 'Disallow Bluetooth' to 'On'.

The user training requirement is satisfied in requirement HONW-09-008700."
  reference      : "800-171|3.4.2,800-171|3.4.7,800-53|CM-6b.,800-53|CM-7(1)(b),800-53r5|CM-6b.,800-53r5|CM-7(1)(b),CAT|III,CCI|CCI-000366,CCI|CCI-001761,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|HW_Android_9-x_COBO_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,ITSG-33|CM-7(1),NESA|T3.2.1,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,Rule-ID|SV-235043r852703_rule,STIG-ID|HONW-09-001400,SWIFT-CSCv1|2.3,Vuln-ID|V-235043"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_HW_Android_9-x_Y24M01_STIG.zip"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
              "Profile: " + .General.Name + " - Allow Bluetooth = \(.Restriction.AllowBluetooth? // "Not Defined")"'
  regex          : "Allow Bluetooth ="
  expect         : "Allow Bluetooth = False"
  severity       : MEDIUM
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "HONW-09-002300 - The Honeywell Mobility Edge Android Pie device must be configured to disable trust agents."
  info           : "NOTE: This requirement is not applicable (NA) for specific biometric authentication factors included in the product's Common Criteria evaluation.

Trust agents allow a user to unlock a mobile device without entering a passcode when the mobile device is, for example, connected to a user-selected Bluetooth device or in a user-selected location. This technology would allow unauthorized users to have access to DoD sensitive data if compromised. By not permitting the use of non-password authentication mechanisms, users are forced to use passcodes that meet DoD passcode requirements.

SFR ID: FMT_SMF_EXT.1.1 #23, FIA_UAU.5.1"
  solution       : "Configure Honeywell Android Pie to disable trust agents.

On the MDM console:
1. Open Lock screen restrictions section.
2. Set 'Disable trust agents' to on."
  reference      : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6b.,800-53|CM-6(1),800-53|CM-7a.,800-53r5|CM-6b.,800-53r5|CM-6(1),800-53r5|CM-7a.,CAT|II,CCI|CCI-000366,CCI|CCI-000370,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|HW_Android_9-x_COBO_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,ITSG-33|CM-6(1),ITSG-33|CM-7a.,NESA|T3.2.1,NIAv2|NS5f,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-235044r626530_rule,STIG-ID|HONW-09-002300,SWIFT-CSCv1|2.3,Vuln-ID|V-235044"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_HW_Android_9-x_Y24M01_STIG.zip"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                  "Profile: " + .General.Name + " - Keyguard Trust Agent = \(.Restriction.AllowKeyguardTrustAgent? // "Not Defined")"'
  regex          : "Keyguard Trust Agent ="
  expect         : "Keyguard Trust Agent = false"
  match_all      : YES
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "HONW-09-002800 - The Honeywell Mobility Edge Android Pie device must be configured to disable developer modes."
  info           : "Developer modes expose features of the Honeywell Android device that are not available during standard operation. An adversary may leverage a vulnerability inherent in a developer mode to compromise the confidentiality, integrity, and availability of DoD sensitive information. Disabling developer modes mitigates this risk.

SFR ID: FMT_SMF_EXT.1.1 #26"
  solution       : "Configure the Honeywell Android device to disable developer modes.

On the MDM console:
1. Open Restrictions section.
2. Set 'Debugging Features' to 'Disallow'."
  reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|PR.PS-01,DISA_Benchmark|HW_Android_9-x_COBO_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-235045r626530_rule,STIG-ID|HONW-09-002800,SWIFT-CSCv1|2.3,Vuln-ID|V-235045"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_HW_Android_9-x_Y24M01_STIG.zip"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                    "Profile: " + .General.Name + " - Allow Developer Options = \(.Restriction.AllowDeveloperOptions? // "Not Defined")"'
  regex          : "Allow Developer Options ="
  expect         : "Allow Developer Options = False"
  match_all      : YES
</custom_item>

<report type:"WARNING">
  description : "HONW-09-003400 - The Honeywell Mobility Edge Android Pie device must be configured to display the DoD advisory warning message at start-up or each time the user unlocks the device."
  info        : "The Honeywell Mobility Edge Android Pie device is required to display the DoD-approved system use notification message or banner before granting access to the system that provides privacy and security notices consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance. Required banners help ensure that DoD can audit and monitor the activities of mobile device users without legal restriction.

System use notification messages can be displayed when individuals first access or unlock the mobile device. The banner must be implemented as a 'click-through' banner at device unlock (to the extent permitted by the operating system). A 'click-through' banner prevents further activity on the information system unless and until the user executes a positive action to manifest agreement by clicking on a box indicating 'OK.'

The approved DoD text must be used exactly as required in the KS referenced in DoDI 8500.01. For devices accommodating banners of 1300 characters, the banner text is:

You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.
By using this IS (which includes any device attached to this IS), you consent to the following conditions:
-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.
-At any time, the USG may inspect and seize data stored on this IS.
-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.
-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.
-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.

For devices with severe character limitations, the banner text is:

I've read & consent to terms in IS user agreem't.

The administrator must configure the banner text exactly as written without any changes.

SFR ID: FMT_SMF_EXT.1.1 #36

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the DoD warning banner by either of the following methods (required text is found in the Vulnerability Description):
1. By placing the DoD warning banner text in the user agreement signed by each Honeywell Android device user (preferred method).
2. By configuring the warning banner text on the MDM console and installing the banner on each managed mobile device.

On the MDM console:
Enable 'Lock Screen Message' and enter the banner text."
  reference   : "800-171|3.1.9,800-53|AC-8a.,800-53r5|AC-8a.,CAT|III,CCI|CCI-000048,DISA_Benchmark|HW_Android_9-x_COBO_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-8a.,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,Rule-ID|SV-235046r626530_rule,STIG-ID|HONW-09-003400,TBA-FIISB|45.2.4,Vuln-ID|V-235046"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_HW_Android_9-x_Y24M01_STIG.zip"
</report>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "HONW-09-003500 - The Honeywell Mobility Edge Android Pie device must be configured to disable USB mass storage mode."
  info           : "USB mass storage mode enables the transfer of data and software from one device to another. This software can include malware. When USB mass storage is enabled on a mobile device, it becomes a potential vector for malware and unauthorized data exfiltration. Prohibiting USB mass storage mode mitigates this risk.

SFR ID: FMT_SMF_EXT.1.1 #39a"
  solution       : "Configure the Honeywell Android device to disable USB mass storage mode.

On the MDM console:
1. Open Device Restrictions.
2. Open Restrictions settings.
3. Select 'Disallow usb file transfer'."
  reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|PR.PS-01,DISA_Benchmark|HW_Android_9-x_COBO_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-235047r626530_rule,STIG-ID|HONW-09-003500,SWIFT-CSCv1|2.3,Vuln-ID|V-235047"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_HW_Android_9-x_Y24M01_STIG.zip"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                  "Profile: " + .General.Name + " - Allow USB Mass Storage = \(.Restriction.AllowUSBMassStorage? // "Not Defined")"'
  regex          : "Allow USB Mass Storage ="
  expect         : "Allow USB Mass Storage = False"
  match_all      : YES
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "HONW-09-003700 - The Honeywell Mobility Edge Android Pie device must be configured to not allow backup of [all applications, configuration data] to locally connected systems."
  info           : "Data on mobile devices is protected by numerous mechanisms, including user authentication, access control, and cryptography. When the data is backed up to an external system (either locally connected or cloud-based), many if not all of these mechanisms are no longer present. This leaves the backed-up data vulnerable to attack. Disabling backup to external systems mitigates this risk.

SFR ID: FMT_SMF_EXT.1.1 #40"
  solution       : "Configure the Honeywell Android device to disable backup to locally connected systems.

NOTE: On Restrictions, the backup features for Honeywell are not in the framework.

On the MDM console:
1. Open Device Restrictions.
2. Open Restrictions settings.
3. Select 'Disallow usb file transfer'."
  reference      : "800-171|3.1.21,800-53|AC-20(2),800-53r5|AC-20(2),CAT|II,CCI|CCI-000097,CSF|ID.AM-4,CSF|PR.AC-3,CSF2.0|ID.AM-02,CSF2.0|ID.AM-04,DISA_Benchmark|HW_Android_9-x_COBO_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-20(2),NESA|M1.3.5,NESA|T1.2.3,QCSC-v1|3.2,QCSC-v1|5.2.2,Rule-ID|SV-235048r626530_rule,STIG-ID|HONW-09-003700,SWIFT-CSCv1|2.5,Vuln-ID|V-235048"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_HW_Android_9-x_Y24M01_STIG.zip"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                  "Profile: " + .General.Name + " - Allow USB Mass Storage = \(.Restriction.AllowUSBMassStorage? // "Not Defined")"'
  regex          : "Allow USB Mass Storage ="
  expect         : "Allow USB Mass Storage = False"
  match_all      : YES
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "HONW-09-003900 - The Honeywell Mobility Edge Android Pie device must be configured to not allow backup of all applications and configuration data to remote systems."
  info           : "Backups to remote systems (including cloud backup) can leave data vulnerable to breach on the external systems, which often offer less protection than the Honeywell Android device. Where the remote backup involves a cloud-based solution, the backup capability is often used to synchronize data across multiple devices. In this case, DoD devices may synchronize DoD sensitive information to a user's personal device or other unauthorized computers that are vulnerable to breach. Disallowing remote backup mitigates this risk.

SFR ID: FMT_SMF_EXT.1.1 #40"
  solution       : "Configure the Honeywell Android device to disable backup to remote systems (including commercial clouds).

NOTE: On Restrictions, data in the work profile cannot be backed up by default.

On the MDM console:
1. Open Device Restrictions.
2. Open Restrictions settings.
3. Ensure 'Enable backup service' is not selected."
  reference      : "800-171|3.1.20,800-53|AC-20(3),800-53r5|AC-20(3),CAT|II,CCI|CCI-002338,CSF|ID.AM-4,CSF|PR.AC-3,CSF2.0|ID.AM-02,CSF2.0|ID.AM-04,DISA_Benchmark|HW_Android_9-x_COBO_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-20,NESA|M1.3.5,NESA|M4.2.2,NIAv2|OS7,NIAv2|OS8,QCSC-v1|3.2,QCSC-v1|5.2.2,Rule-ID|SV-235049r852704_rule,STIG-ID|HONW-09-003900,SWIFT-CSCv1|2.5,Vuln-ID|V-235049"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_HW_Android_9-x_Y24M01_STIG.zip"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                  "Profile: " + .General.Name + " - Allow Google Backup = \(.Restriction.AllowGoogleBackup? // "Not Defined")"'
  regex          : "Allow Google Backup ="
  expect         : "Allow Google Backup = False"
  match_all      : YES
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "HONW-09-004700 - The Honeywell Mobility Edge Android Pie device must be configured to disable multi-user modes."
  info           : "Multi-user mode allows multiple users to share a mobile device by providing a degree of separation between user data. To date, no mobile device with multi-user mode features meets DoD requirements for access control, data separation, and non-repudiation for user accounts. In addition, the MDFPP does not include design requirements for multi-user account services. Disabling multi-user mode mitigates the risk of not meeting DoD multi-user account security policies.

SFR ID: FMT_SMF_EXT.1.1 #47b"
  solution       : "Configure the Honeywell Android Pie to disable multi-user modes.

On the MDM console:
1. Open the Restrictions settings.
2. Open User Settings.
3. Select 'Disallow Add User'."
  reference      : "800-171|3.1.1,800-171|3.4.2,800-53|AC-2a.,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CCI|CCI-002110,CN-L3|7.1.3.2(d),CN-L3|8.1.10.6(d),CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.IP-1,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|DE.CM-09,CSF2.0|PR.AA-01,CSF2.0|PR.AA-05,CSF2.0|PR.DS-10,CSF2.0|PR.PS-01,DISA_Benchmark|HW_Android_9-x_COBO_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2a.,ITSG-33|CM-6b.,NESA|T3.2.1,NESA|T5.2.1,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,PCI-DSSv3.2.1|1.1.5,PCI-DSSv4.0|1.1.2,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,Rule-ID|SV-235050r852705_rule,STIG-ID|HONW-09-004700,SWIFT-CSCv1|2.3,Vuln-ID|V-235050"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_HW_Android_9-x_Y24M01_STIG.zip"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                  "Profile: " + .General.Name + " - Allow Multi-User Mode = \(.Restriction.AllowMultipleUsers? // "Not Defined")"'
  regex          : "Allow Multi-User Mode ="
  expect         : "Allow Multi-User Mode = false"
  match_all      : YES
</custom_item>

<report type:"WARNING">
  description : "HONW-09-005505 - The Honeywell Mobility Edge Android Pie device must be configured to enable audit logging."
  info        : "Audit logs enable monitoring of security-relevant events and subsequent forensics when breaches occur. To be useful, Administrators must have the ability to view the audit logs.

SFR ID: FMT_SMF_EXT.1.1 #32

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the Honeywell Android Pie to enable audit logging.

On the MDM console:
1. Open the Restrictions settings.
2. Open User Settings.
3. Select 'Enable security logging'.
4. Select 'Enable network logging'."
  reference   : "800-171|3.4.2,800-53|AU-4(1),800-53|CM-6b.,800-53|CM-6(1),800-53r5|AU-4(1),800-53r5|CM-6b.,800-53r5|CM-6(1),CAT|II,CCI|CCI-000366,CCI|CCI-000370,CCI|CCI-001851,CN-L3|8.1.10.6(d),CSF|PR.DS-4,CSF|PR.IP-1,CSF|PR.PT-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|HW_Android_9-x_COBO_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-4,ITSG-33|CM-6b.,ITSG-33|CM-6(1),NESA|T3.2.1,NESA|T3.3.1,NESA|T3.6.2,NIAv2|NS5f,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-235051r852706_rule,STIG-ID|HONW-09-005505,SWIFT-CSCv1|2.3,Vuln-ID|V-235051"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_HW_Android_9-x_Y24M01_STIG.zip"
</report>

<report type:"WARNING">
  description : "HONW-09-006100 - The Honeywell Mobility Edge Android Pie device must be configured to generate audit records for the following auditable events: detected integrity violations."
  info        : "Audit logs enable monitoring of security-relevant events and subsequent forensics when breaches occur. They help identify attacks so that breaches can either be prevented or limited in their scope. They facilitate analysis to improve performance and security. The Requirement Statement lists key events the system must generate in an audit record.

Application note: Requirement applies only to integrity violation detections that can be logged by the audit logging component.

SFR ID: FMT_SMF_EXT.1.1 #37

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the Honeywell Android device to generate audit records for the following auditable events: detected integrity violations.

On the MDM console:
1. Go to Policy management.
2. Enable Security Logging."
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12a.,800-53r5|AU-12a.,CAT|III,CCI|CCI-000169,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|DE.CM-09,CSF2.0|PR.PS-04,DISA_Benchmark|HW_Android_9-x_COBO_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-12a.,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-235052r626530_rule,STIG-ID|HONW-09-006100,SWIFT-CSCv1|6.4,Vuln-ID|V-235052"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_HW_Android_9-x_Y24M01_STIG.zip"
</report>

<report type:"WARNING">
  description : "HONW-09-007150 - The Honeywell Android Pie must wipe all data upon unenrollment from MDM."
  info        : "When a mobile device is no longer going to be managed by MDM technologies, its protected/sensitive data must be sanitized because it will no longer be protected by the MDM software, so it is at much greater risk of unauthorized access and disclosure. At least one of the two options must be selected.

SFR ID: FMT_SMF_EXT.2.1

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "On the MDM console:
Enable 'Disallow remove managed profile'.

Prior to unenrollment, the MDM administrator should issue a factory reset to ensure all data is wiped by doing the following in the MDM console:
Wipe data."
  reference   : "800-171|3.4.2,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|CM-6b.,800-53|CM-6(1),800-53|MP-6(3),800-53r5|CM-6b.,800-53r5|CM-6(1),800-53r5|MP-6(3),CAT|II,CCI|CCI-000366,CCI|CCI-000370,CCI|CCI-001033,CN-L3|8.1.10.6(d),CSF|PR.DS-3,CSF|PR.IP-1,CSF|PR.IP-6,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|HW_Android_9-x_COBO_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.8.3.2,ITSG-33|CM-6b.,ITSG-33|CM-6(1),ITSG-33|MP-6(3),NESA|T1.4.1,NESA|T3.2.1,NIAv2|MS5b,NIAv2|MS6,NIAv2|MS9,NIAv2|MS10a,NIAv2|MS10b,NIAv2|MS10c,NIAv2|MS10d,NIAv2|MS10e,NIAv2|MS10f,NIAv2|MS11a,NIAv2|MS11b,NIAv2|MS12a,NIAv2|MS12b,NIAv2|MS12c,NIAv2|MS13,NIAv2|MS14,NIAv2|MS17,NIAv2|MS18a,NIAv2|MS18b,NIAv2|MS18c,NIAv2|MS20,NIAv2|MS21,NIAv2|NS5f,NIAv2|NS16,QCSC-v1|3.2,QCSC-v1|6.2,Rule-ID|SV-235053r626530_rule,STIG-ID|HONW-09-007150,SWIFT-CSCv1|2.3,Vuln-ID|V-235053"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_HW_Android_9-x_Y24M01_STIG.zip"
</report>

<report type:"WARNING">
  description : "HONW-09-008400 - On all Honeywell Mobility Edge Android Pie devices, cryptography must be configured to be in FIPS 140-2 validated mode."
  info        : "Unapproved cryptographic algorithms cannot be relied upon to provide confidentiality or integrity, and DoD data could be compromised as a result. The Honeywell Android devices common vulnerabilities with cryptographic modules are those associated with poor implementation. FIPS 140-2 validation provides assurance that the relevant cryptography has been implemented correctly. FIPS 140-2 validation is also a strict requirement for use of cryptography in the Federal Government for protecting unclassified data.

SFR ID: FCS

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the Honeywell Android device to enable FIPS mode.

On the MDM console:
1. Ask the MDM Administrator to edit the following item in DeviceConfig.xml:
 Modify item: DeviceConfig >> HoneywellSetting >> EnforceOSFipsMode
 Value sample: 1: Enable OS FIPS mode; 0: Disable OS FIPS mode
2. In MDM console, the MDM Administrator will package this DeviceConfig.xml and push this package to the CN80G device.

On the Honeywell Android Pie device:
1. Open Settings >> Honeywell Settings >> FIPS Enforce Mode.
2. Enable FIPS Enforce mode."
  reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|I,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|HW_Android_9-x_COBO_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-235093r626530_rule,STIG-ID|HONW-09-008400,SWIFT-CSCv1|2.3,Vuln-ID|V-235093"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_HW_Android_9-x_Y24M01_STIG.zip"
</report>

<report type:"WARNING">
  description : "HONW-09-008700 - Honeywell Mobility Edge Android Pie devices users must complete required training."
  info        : "The security posture of Honeywell devices requires the device user to configure several required policy rules on their device. User-Based Enforcement (UBE) is required for these controls. In addition, if the Authorizing Official (AO) has approved the use of an unmanaged personal space, the user must receive training on risks. If a user is not aware of their responsibilities and does not comply with UBE requirements, the security posture of the Honeywell mobile device may become compromised and DoD sensitive data may become compromised.

SFR ID: NA

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Have all Honeywell device users complete training on the following topics. Users should acknowledge that they have reviewed training via a signed User Agreement or similar written record.

Training topics:

- Operational security concerns introduced by unmanaged applications/unmanaged personal space, including applications using global positioning system (GPS) tracking.
- Need to ensure no DoD data is saved to the personal space or transmitted from a personal app (for example, from personal email).
- If the Purebred key management app is used, users are responsible for maintaining positive control of their credentialed device at all times. The DoD PKI certificate policy requires subscribers to maintain positive control of the devices that contain private keys and to report any loss of control so the credentials can be revoked. Upon device retirement, turn-in, or reassignment, ensure that a factory data reset is performed prior to device hand-off. Follow mobility service provider decommissioning procedures as applicable.
- How to configure the following UBE controls (users must configure the control) on the Honeywell device:
 **Secure use of Calendar Alarm
 **Local screen mirroring and Mirroring procedures (authorized/not authorized for use)
 **Do not upload DoD contacts via smart call and caller ID services
 **Do not remove DoD intermediate and root PKI digital certificates
 **Disable Wi-Fi Sharing
 **Do not configure a DoD network (work) VPN profile on any third-party VPN client installed in the personal space
 **If Bluetooth connections are approved for mobile device, types of allowed connections (for example car handsfree, but not Bluetooth wireless keyboard)
- AO guidance on acceptable use and restrictions, if any, on downloading and installing personal apps and data (music, photos, etc.) in the Honeywell device personal space."
  reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|HW_Android_9-x_COBO_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-235054r626530_rule,STIG-ID|HONW-09-008700,SWIFT-CSCv1|2.3,Vuln-ID|V-235054"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_HW_Android_9-x_Y24M01_STIG.zip"
</report>

<report type:"WARNING">
  description : "HONW-09-009000 - Honeywell Mobility Edge Android Pie devices must have the DoD root and intermediate PKI certificates installed."
  info        : "DoD root and intermediate PKI certificates are used to verify the authenticity of PKI certificates of users and web services. If the root and intermediate certificates are not available, an adversary could falsely sign a certificate in such a way that it could not be detected. Providing access to the DoD root and intermediate PKI certificates greatly diminishes the risk of this attack.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure Honeywell Android Pie devices to install DoD root and intermediate certificates.

On the MDM console, upload DoD root and intermediate certificates as part of a device and/or work profile.

The current DoD root and intermediate PKI certificates may be obtained in self-extracting zip files at http://cyber.mil/pki-pke (for NIPRNet)."
  reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|HW_Android_9-x_COBO_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-235055r626530_rule,STIG-ID|HONW-09-009000,SWIFT-CSCv1|2.3,Vuln-ID|V-235055"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_HW_Android_9-x_Y24M01_STIG.zip"
</report>

<report type:"WARNING">
  description : "HONW-09-009100 - The Honeywell Mobility Edge Android Pie must allow only the administrator (MDM) to install/remove DoD root and intermediate PKI certificates - MDM to install/remove DoD root and intermediate PKI certificates."
  info        : "DoD root and intermediate PKI certificates are used to verify the authenticity of PKI certificates of users and web services. If the user is allowed to remove root and intermediate certificates, the user could allow an adversary to falsely sign a certificate in such a way that it could not be detected. Restricting the ability to remove DoD root and intermediate PKI certificates to the Administrator mitigates this risk.

SFR ID: FMT_MOF_EXT.1.2 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure Honeywell Mobility Edge Android Pie devices to prevent a user from removing DoD root and intermediate PKI certificates.

On the MDM console:
1. Open the User restrictions setting.
2. Set 'Disallow config credentials' to 'on' for the work profile."
  reference   : "800-171|3.4.2,800-53|CM-6b.,800-53|CM-6(1),800-53r5|CM-6b.,800-53r5|CM-6(1),CAT|II,CCI|CCI-000366,CCI|CCI-000370,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|HW_Android_9-x_COBO_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,ITSG-33|CM-6(1),NESA|T3.2.1,NIAv2|NS5f,Rule-ID|SV-235056r626530_rule,STIG-ID|HONW-09-009100,SWIFT-CSCv1|2.3,Vuln-ID|V-235056"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_HW_Android_9-x_Y24M01_STIG.zip"
</report>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "HONW-09-009800 - Honeywell Mobility Edge Android Pie devices work profile must be configured to disable automatic completion of workspace internet browser text input."
  info           : "The autofill functionality in the web browser allows the user to complete a form that contains sensitive information, such as personally identifiable information (PII), without previous knowledge of the information. By allowing the use of autofill functionality, an adversary who learns a user's Honeywell Mobility Edge Android Pie devices' password, or who otherwise is able to unlock the device, may be able to further breach other systems by relying on the autofill feature to provide information unknown to the adversary. By disabling the autofill functionality, the risk of an adversary gaining further information about the device's user or compromising other systems is significantly mitigated.

SFR ID: FMT_SMF_EXT.1.1 #47"
  solution       : "Configure Chrome Browser in Honeywell Mobility Edge Android Pie devices Work Profile to disable autofill.

On the MDM console, for the Work Profile:
1. Open the Chrome Browser Settings.
2. Set 'Enable autofill' to 'off'.

Refer to the MDM documentation to determine how to configure Chrome Browser Settings."
  reference      : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|HW_Android_9-x_COBO_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-235057r626530_rule,STIG-ID|HONW-09-009800,SWIFT-CSCv1|2.3,Vuln-ID|V-235057"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_HW_Android_9-x_Y24M01_STIG.zip"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                  "Profile: " + .General.Name + " - Enable Autofill = \(.Restriction.EnableAutofill? // "Not Defined")"'
  regex          : "Enable Autofill ="
  expect         : "Enable Autofill = False"
  match_all      : YES
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "HONW-09-010000 - Honeywell Mobility Edge Android Pie devices Work Profile must be configured to disable the autofill services."
  info           : "The autofill services allow the user to complete text inputs that could contain sensitive information, such as personally identifiable information (PII), without previous knowledge of the information. By allowing the use of autofill services, an adversary who learns a user's Honeywell Android Pie device password, or who otherwise is able to unlock the device, may be able to further breach other systems by relying on the autofill services to provide information unknown to the adversary. By disabling the autofill services, the risk of an adversary gaining further information about the device's user or compromising other systems is significantly mitigated.

Examples of apps that offer autofill services include Samsung Pass, Honeywell, Dashlane, LastPass, and 1Password.

SFR ID: FMT_SMF_EXT.1.1 #47"
  solution       : "Configure Honeywell Mobility Edge Android Pie devices Workspace to disable the autofill services.

On the MDM console, in the Android work profile restrictions, select 'disallow autofill'."
  reference      : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|HW_Android_9-x_COBO_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-235058r626530_rule,STIG-ID|HONW-09-010000,SWIFT-CSCv1|2.3,Vuln-ID|V-235058"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_HW_Android_9-x_Y24M01_STIG.zip"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                  "Profile: " + .General.Name + " - Enable Autofill = \(.Restriction.EnableAutofill? // "Not Defined")"'
  regex          : "Enable Autofill ="
  expect         : "Enable Autofill = False"
  match_all      : YES
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "HONW-09-010200 - Honeywell Mobility Edge Android Pie devices must be configured to disallow configuration of date and time."
  info           : "Determining the correct time a particular application event occurred on a system is critical when conducting forensic analysis and investigating system events.

Periodically synchronizing internal clocks with an authoritative time source is necessary to correctly correlate the timing of events that occur across the enterprise. The three authoritative time sources for Honeywell Mobility Edge Android Pie devices are an authoritative time server that is synchronized with redundant United States Naval Observatory (USNO) time servers as designated for the appropriate DoD network (NIPRNet or SIPRNet), or the Global Positioning System (GPS), or the wireless carrier.

Time stamps generated by the audit system in Honeywell Mobility Edge Android Pie devices must include both date and time. The time may be expressed in Coordinated Universal Time (UTC), a modern continuation of Greenwich Mean Time (GMT), or local time with an offset from UTC.

SFR ID: FMT_SMF_EXT.1.1 #47"
  solution       : "Configure Honeywell Android Pie Work Profile to set auto network time.

On the MDM console, in the Android user restrictions section, set 'Set auto (network) time required' to 'On'."
  reference      : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|HW_Android_9-x_COBO_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-235059r626530_rule,STIG-ID|HONW-09-010200,SWIFT-CSCv1|2.3,Vuln-ID|V-235059"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_HW_Android_9-x_Y24M01_STIG.zip"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                  "Profile: " + .General.Name + " - Force Automatic Date And Time = \(.Restriction.ForceAutomaticDateAndTime? // "Not Defined")"'
  regex          : "Force Automatic Date And Time ="
  expect         : "Force Automatic Date And Time = True"
  match_all      : YES
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "HONW-09-010400 - Honeywell Mobility Edge Android Pie devices must configured to disallow outgoing beam."
  info           : "Outgoing beam allows transfer of data through near field communication (NFC) and Bluetooth by touching two unlocked devices together. If it were enabled, sensitive DoD data could be transmitted.

Because of the security risks of sharing sensitive DoD data, users must not be able to allow outgoing beam.

SFR ID: FMT_MOF_EXT.1.2 #47"
  solution       : "Configure the Honeywell Android Pie device to disallow outgoing beam.

On the MDM console, in the Android user restrictions section, set 'Disallow outgoing beam' to 'On'."
  reference      : "800-171|3.4.2,800-53|CM-6b.,800-53|CM-6(1),800-53r5|CM-6b.,800-53r5|CM-6(1),CAT|II,CCI|CCI-000366,CCI|CCI-000370,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|HW_Android_9-x_COBO_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,ITSG-33|CM-6(1),NESA|T3.2.1,NIAv2|NS5f,Rule-ID|SV-235060r626547_rule,STIG-ID|HONW-09-010400,SWIFT-CSCv1|2.3,Vuln-ID|V-235060"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_HW_Android_9-x_Y24M01_STIG.zip"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                  "Profile: " + .General.Name + " - Allow Android Beam = \(.Restriction.AllowAndroidBeam? // "Not Defined")"'
  regex          : "Allow Android Beam ="
  expect         : "Allow Android Beam = False"
  match_all      : YES
</custom_item>

<report type:"WARNING">
  description : "HONW-09-010900 - Honeywell Mobility Edge Android Pie devices must have a NIAP validated Honeywell Mobility Edge Android Pie devices operating system installed."
  info        : "Required security features are not available in earlier operating system versions. In addition, there may be known vulnerabilities in earlier versions.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Install the latest released version of the Honeywell Android Pie operating system on all managed Honeywell devices. For Honeywell Android Pie devices, version HON660-P-88.00.12 must be installed (it is the NIAP-approved version). NOTE: This version of Android can only be installed on devices purchased directly from Honeywell.

NOTE: In Honeywell Android devices, operating system updates are released by the wireless carrier (for example, Sprint, T-Mobile, Verizon Wireless, and ATT)."
  reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|I,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|HW_Android_9-x_COBO_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-235061r626530_rule,STIG-ID|HONW-09-010900,SWIFT-CSCv1|2.3,Vuln-ID|V-235061"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_HW_Android_9-x_Y24M01_STIG.zip"
</report>

<report type:"WARNING">
  description : "HONW-09-999999 - All Honeywell Android 9 installations must be removed."
  info        : "Honeywell Android 9 is no longer supported by Honeywell and therefore may contain security vulnerabilities.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Remove all installations of Honeywell Android 9."
  reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|I,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|HW_Android_9-x_COBO_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-259207r942500_rule,STIG-ID|HONW-09-999999,SWIFT-CSCv1|2.3,Vuln-ID|V-259207"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_HW_Android_9-x_Y24M01_STIG.zip"
</report>

</check_type>
