#TRUSTED 1d5b3b695f804558abcbe6218cecdb8e19a7855cc9a6c5c42fb0bdfcce02fa89701856e09f27dbde87be67a5804ea4c9ddbfa027745862ad53355f31946f0f7bb4a38a04a7dfb90c50ee4217cd2c9e3ed22df2fd0db263946bc85c4575fefc16b7e83109818fbd1de4d60963f06e4f97deb4a09018a3a6c5a2c2e941cd9e5a48f0b49552197de9684b997014eb678913160ad03f243b52847da6da13577227ed6762dde301c98a98f890f4e226c8f7cd48abd585accc655789d5a10e60b09b4a7c9e2cf602031b1d50ebe6b881cb839516054ca5be3e8ccd80a44783d92e16b84040f1d17e4b3f1103b21574ba51be1b0748202263b2d55362b3d73088b94cccdfdd0effb09d79ac9b47bfb9815638aa7f045efd6fbcabc544fefa06b940bcddbab18d9c3e3a1fd5a45900f4a9d0fcde0e297e66806193c8b08798706c2c69036da84fcd9630eafad5d91985b0487c2905f1c435837da28ef3a5a94d3380613fe27aa50eb7d8dd6629d17797f1bdec49ac102819699f03773d8af1308b9a7641eadc55017c535819d19cd006c170408c980cb80bf26a55f2c2b230e24c5786c7dee561cf07efb45f1f404eab3d629921668821ae1f00aecbc9c873b301aa119b256eeb5c77d95c99b5f495fb3077c43c93ebc09e282e3130851e2e8cafbd7b4307a02c3205a8d89ca49f358279fa090857de2b68317e4e7148336e98ff371b47
#TRUST-RSA-SHA256 85c1841c24ce47946c754150b7842ffe68fb1a90166e8ea093729e6098d95276ace525a5cc61534f01bf4eea7b348b9822548f7afb3ecbb7e726e715fa2931fb5983abc2e325ded90757709d7d6d69a68f077179922df22c062f6544d65ecb20ab99e9ef2318cf08d2f7ab5f9eb8dc5b4b2047174ea70099aafdf6adb3e66b5a21770b16c98c697d5cb76aeaed33fcde723d4f1062c37dd72076dab65bdd311823d80d1fb4229c33af1b8a8dc09149e245843549c1e89549b5c485dca94321bc4b5e71ff746e5f982ae7fb21b6d36870b2db7f7b25b0ed5617187d263626a519c9bb79e158e7b5ff04f786188ab475446d8759629d3a7bc8b4d9b5900caa814345f4e38ad713628e1678e222bd3f40969731956ce13963b1380c2380f64988f4b6f2b4ccff43b233dcd6bd3c772572c4c70873c92025944fc6f1b51ce1809fd6414e8ae2faf6668b0f416ea78986dc36757f307b5a1fbcc99db2dda866db502c6cd818aebe5e231362f5e1fce6679b7960ef2b45ef5e05121b0cd9626ebeabc25ca8c3bc84c0959bf0e8caedd710138b335e8eaa2b1646af401ca926499d28dc327ce9168ab3d9867ae4c3e8d31645bace2be851e1333040f7a6b10d227e4b8f3a41fccbc5982f89e33056ee132dbd46c7030814cd1f0dda1453425d0a4a589fe17ff60e380b546440270c19748bf04c25e134e267bb0d17af1ab0e654380cb6
#
# This script is Copyright (C) 2004-2024 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
# $Revision: 1.0 $
# $Date: 2024/07/08 $
#
# description : This document implements the security configuration as recommended by the
#               CIS Apple iPadOS 17 Benchmark v1.1.0
#
#<ui_metadata>
#<display_name>MobileIron - CIS Apple iPadOS 17 Institutionally Owned L1</display_name>
#<spec>
#  <type>CIS</type>
#  <name>Apple iPadOS 17</name>
#  <profile>L1 Institutionally Owned MobileIron</profile>
#  <version>1.1.0</version>
#  <link>https://workbench.cisecurity.org/benchmarks/6168</link>
#</spec>
#<labels>mdm,cis,mobileiron,ios</labels>
#<benchmark_refs>CCE,CSCv6,CSCv7,CSCv8,LEVEL</benchmark_refs>
#</ui_metadata>

<check_type:"MDM" mdm_type:MOBILEIRON>

<report type:"WARNING">
  description : "2.2.1.12 Ensure 'Allow sending diagnostic and usage data to Apple' is set to 'Disabled'"
  info        : "Apple provides a mechanism to send diagnostic and analytics data back to them in order help improve the platform. This information sent to Apple may contain internal organizational information that should not be disclosed to third parties.

Rationale:

Organizations should have knowledge of what is shared with vendors and other third parties, and should also be in full control of what is disclosed.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Open Apple Configurator.

Open the Configuration Profile.

In the left window pane, click on the Restrictions tab.

In the right window pane, under the tab Functionality, uncheck the checkbox for Allow sending diagnostic and usage data to Apple.

Deploy the Configuration Profile."
  reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1M,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
  see_also    : "https://workbench.cisecurity.org/benchmarks/6168"
</report>

<custom_item>
  type           : CONFIGURATION_INFO
  description    : "3.1.1 Ensure 'Controls when the profile can be removed' is set to 'Never'"
  info           : "This recommendation pertains to the removal of a given configuration profile.

Typically, the enrollment of devices into a Mobile Device Management (MDM) does not allow a user to remove any managed configurations.

Rationale:

In this section of the benchmark, recommendations are for devices that are owned by the institution. Removal of the configuration profile should be at the discretion of the institution, not the end user, in order to prevent weakening the device's security and exposing its data."
  solution       : "Open Apple Configurator.

Open the Configuration Profile.

In the left window pane, click on the General tab.

In the right window pane, under the heading Security, set the menu Controls when the profile can be removed to Never.

Deploy the Configuration Profile."
  reference      : "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3"
  see_also       : "https://workbench.cisecurity.org/benchmarks/6168"
  json_transform : '.[] | select(.appType=="GENERAL") | "Policy: " + .name + " - Profile Removal = " + (.properties.PROFILEREMOVAL // "Not Defined" )'
  regex          : "Profile Removal ="
  expect         : "Profile Removal = Never"
</custom_item>

<report type:"WARNING">
  description : "3.2.1.2 Ensure 'Allow voice dialing while device is locked' is set to 'Disabled'"
  info        : "This recommendation pertains to initiating phone calls while a device is locked. Voice dialing is handled separately from Siri.

Rationale:

Allowing calls from a locked device may allow for the impersonation of the device owner.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Open Apple Configurator.

Open the Configuration Profile.

In the left window pane, click on the Restrictions tab.

In the right window pane, under the tab Functionality, uncheck the checkbox for Allow voice dialing while device is locked.

Deploy the Configuration Profile."
  reference   : "800-171|3.1.1,800-171|3.1.10,800-171|3.1.11,800-53|AC-2(5),800-53|AC-11,800-53|AC-11(1),800-53|AC-12,800-53r5|AC-2(5),800-53r5|AC-11,800-53r5|AC-11(1),800-53r5|AC-12,CN-L3|7.1.2.2(d),CN-L3|7.1.3.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSCv7|16.11,CSCv8|4.3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-2(5),ITSG-33|AC-11,ITSG-33|AC-11(1),ITSG-33|AC-12,LEVEL|1A,NIAv2|AM23c,NIAv2|AM23d,NIAv2|AM28,NIAv2|NS5j,NIAv2|NS49,NIAv2|SS14e,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,TBA-FIISB|36.2.1,TBA-FIISB|37.1.4"
  see_also    : "https://workbench.cisecurity.org/benchmarks/6168"
</report>

<custom_item>
  type           : CONFIGURATION_INFO
  description    : "3.2.1.3 Ensure 'Allow Siri while device is locked' is set to 'Disabled'"
  info           : "This recommendation pertains to access to Siri while the device is locked.

Rationale:

Accessing Siri on a locked device may allow unauthorized users to access information otherwise not available to them, such as messaging, contacts, and a variety of other data.

Impact:

The end user must unlock the device before interacting with Siri."
  solution       : "Open Apple Configurator.

Open the Configuration Profile.

In the left window pane, click on the Restrictions tab.

In the right window pane, under the tab Functionality, uncheck the checkbox for Allow Siri while device is locked.

Deploy the Configuration Profile."
  reference      : "800-171|3.1.1,800-171|3.1.10,800-171|3.1.11,800-53|AC-2(5),800-53|AC-11,800-53|AC-11(1),800-53|AC-12,800-53r5|AC-2(5),800-53r5|AC-11,800-53r5|AC-11(1),800-53r5|AC-12,CN-L3|7.1.2.2(d),CN-L3|7.1.3.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSCv7|16.11,CSCv8|4.3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-2(5),ITSG-33|AC-11,ITSG-33|AC-11(1),ITSG-33|AC-12,LEVEL|1A,NIAv2|AM23c,NIAv2|AM23d,NIAv2|AM28,NIAv2|NS5j,NIAv2|NS49,NIAv2|SS14e,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,TBA-FIISB|36.2.1,TBA-FIISB|37.1.4"
  see_also       : "https://workbench.cisecurity.org/benchmarks/6168"
  json_transform : '.[] | select(.appType=="RESTRICTION") | "Policy: " + .name + " - Allow Assistant While Locked = " + (.properties.ALLOW_ASSISTANT_WHILE_LOCKED // "not defined" )'
  regex          : "Allow Assistant While Locked ="
  expect         : "Allow Assistant While Locked = false"
</custom_item>

<custom_item>
  type           : CONFIGURATION_INFO
  description    : "3.2.1.4 Ensure 'Allow iCloud backup' is set to 'Disabled'"
  info           : "This recommendation pertains to allowing iCloud backup.

This recommendation does block educational institutions from being able to use iCloud backup with devices issued to students. Because of this, we do not recommend educational institutions enable this recommendation for those devices.

Rationale:

iCloud backups are encrypted in transit and at rest within Apple's infrastructure, but there is no protection against restoring a backup to an unmanaged device. This potentially allows for data leakage.

Use of back-ups is strongly advised as they allow to create a copy of data that can be recovered in the event of failures, such as hardware or software failure, data corruption, or a human-caused event, or accidental deletion of data. Back-up copies allow data to be restored from an earlier point in time to help recovering from an unexpected event."
  solution       : "Open Apple Configurator.

Open the Configuration Profile.

In the left window pane, click on the Restrictions tab.

In the right window pane, under the tab Functionality, uncheck the checkbox for Allow iCloud backup.

Deploy the Configuration Profile.

Additional Information:

This recommendation is exclusively for institutionally-owned devices. If an institution is relying on Bring Your Own Device (BYOD), those devices should not contain sensitive material necessary to protect at this level."
  reference      : "800-171|3.4.1,800-171|3.4.7,800-171|3.4.9,800-53|CM-7(2),800-53|CM-8(3),800-53|CM-10,800-53|CM-11,800-53r5|CM-7(2),800-53r5|CM-8(3),800-53r5|CM-10,800-53r5|CM-11,CN-L3|8.1.10.2(a),CN-L3|8.1.10.2(b),CSCv7|13.4,CSCv8|2.3,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.6.2,ITSG-33|CM-7(2),ITSG-33|CM-8(3),LEVEL|1A,NESA|T1.2.1,NESA|T1.2.2,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.3,SWIFT-CSCv1|5.1"
  see_also       : "https://workbench.cisecurity.org/benchmarks/6168"
  json_transform : '.[] | select(.appType=="RESTRICTION") | "Policy: " + .name + " - Allow Cloud Backup = " + (.properties.ALLOW_CLOUD_BACKUP // "not defined" )'
  regex          : "Allow Cloud Backup ="
  expect         : "Allow Cloud Backup = false"
</custom_item>

<custom_item>
  type           : CONFIGURATION_INFO
  description    : "3.2.1.5 Ensure 'Allow iCloud documents & data' is set to 'Disabled'"
  info           : "This recommendation pertains to the storage and syncing of data through iCloud from institutionally-owned devices.

Rationale:

Institutionally-owned devices are often connected to personal iCloud accounts. This is expected and normal. The data from institutionally-owned devices, however, should not co-mingle with the end-user's personal data. This creates a potential avenue for data leakage."
  solution       : "Open Apple Configurator.

Open the Configuration Profile.

In the left window pane, click on the Restrictions tab.

In the right window pane, under the tab Functionality, uncheck the checkbox for Allow iCloud documents & data.

Deploy the Configuration Profile."
  reference      : "800-171|3.4.1,800-171|3.4.7,800-171|3.4.9,800-53|CM-7(2),800-53|CM-8(3),800-53|CM-10,800-53|CM-11,800-53r5|CM-7(2),800-53r5|CM-8(3),800-53r5|CM-10,800-53r5|CM-11,CN-L3|8.1.10.2(a),CN-L3|8.1.10.2(b),CSCv7|13.4,CSCv8|2.3,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.6.2,ITSG-33|CM-7(2),ITSG-33|CM-8(3),LEVEL|1A,NESA|T1.2.1,NESA|T1.2.2,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.3,SWIFT-CSCv1|5.1"
  see_also       : "https://workbench.cisecurity.org/benchmarks/6168"
  json_transform : '.[] | select(.appType=="RESTRICTION") | "Policy: " + .name + " - Allow Cloud Document Sync = " + (.properties.ALLOW_CLOUD_DOCUMENT_SYNC // "not defined" )'
  regex          : "Allow Cloud Document Sync ="
  expect         : "Allow Cloud Document Sync = false"
</custom_item>

<report type:"WARNING">
  description : "3.2.1.6 Review 'Allow iCloud Keychain' settings"
  info        : "iCloud Keychain allows passwords associated with an Apple ID to be available for unencrypted use to the authenticated user for the Apple account. Organizations should review whether enterprise accounts might be stored unauthorized in Apple's personal cloud.

Rationale:

It is normal and expected for end users to configure their personal iCloud account on an institutionally-owned device. Because of this, disabling iCloud Keychain prevents OS-automated credential transfer to devices outside organizational control, thus reducing the risk for misuse of those credentials from unauthorized devices.

Impact:

Several risk aspects should be reviewed prior to disabling iCloud Keychain:

At this point, iCloud Keychain only stores passwords. Where Multi-Factor Authentication, Single-Sign-On, or device-based profiles are used, those credentials will not make use of iCloud Keychain synchronization. Mature enterprises should no longer be solely using password authentication, and thus should not be at risk through the use of iCloud Keychain.

iCloud Keychain synchronizes user passwords. A user presumably already knows these passwords and periodically changes them. They might also use passwords from an unauthorized device without iCloud synchronization. Ideally the institutionally-issued device has greater access than an unauthorized or public device to the authentication server. If the personal device cannot logically engage with the authentication service, then the risk of password synchronization is also greatly reduced.

Blocking the use of iCloud Keychain also blocks synchronization of non-enterprise-managed accounts that the user may need for their regular work. This also blocks the use of strong, unique password suggestions made available by Apple.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Open Apple Configurator.

Open the Configuration Profile.

In the left window pane, click on the Restrictions tab.

In the right window pane, under the tab Functionality, uncheck the checkbox for Allow iCloud Keychain.

Deploy the Configuration Profile.

Additional Information:

This recommendation is not intended as advice against using the Keychain locally on an institutionally-owned device, nor is it intended to be taken as a recommendation to prevent iCloud Keychain from being used on end user-owned devices."
  reference   : "800-171|3.1.20,800-171|3.1.21,800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|AC-20(1),800-53|AC-20(2),800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|AC-20(1),800-53r5|AC-20(2),800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv7|9.2,CSCv8|4.1,CSCv8|4.8,CSCv8|15.3,CSF|DE.AE-1,CSF|ID.AM-4,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.AC-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|AC-20(1),ITSG-33|AC-20(2),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|M1.3.5,NESA|M4.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T1.2.3,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5"
  see_also    : "https://workbench.cisecurity.org/benchmarks/6168"
</report>

<report type:"WARNING">
  description : "3.2.1.7 Ensure 'Allow managed apps to store data in iCloud' is set to 'Disabled'"
  info        : "This recommendation pertains to managed applications storing and syncing data through iCloud.

Rationale:

This recommendation addresses data leakage. It prevents a user from installing an application that is managed by the organization on a personal device and allowing iCloud to sync the managed application's data to the personal, non-managed application.

Impact:

Data created on the device may be lost if the end user has not transferred it to another device.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Open Apple Configurator.

Open the Configuration Profile.

In the left window pane, click on the Restrictions tab.

In the right window pane, under the tab Functionality, uncheck the checkbox for Allow managed apps to store data in iCloud.

Deploy the Configuration Profile."
  reference   : "800-171|3.4.1,800-171|3.4.7,800-171|3.4.9,800-53|CM-7(2),800-53|CM-8(3),800-53|CM-10,800-53|CM-11,800-53r5|CM-7(2),800-53r5|CM-8(3),800-53r5|CM-10,800-53r5|CM-11,CN-L3|8.1.10.2(a),CN-L3|8.1.10.2(b),CSCv7|13.4,CSCv8|2.3,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.6.2,ITSG-33|CM-7(2),ITSG-33|CM-8(3),LEVEL|1A,NESA|T1.2.1,NESA|T1.2.2,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.3,SWIFT-CSCv1|5.1"
  see_also    : "https://workbench.cisecurity.org/benchmarks/6168"
</report>

<custom_item>
  type           : CONFIGURATION_INFO
  description    : "3.2.1.10 Ensure 'Force encrypted backups' is set to 'Enabled'"
  info           : "This recommendation pertains to iTunes backup encryption of iOS and iPadOS devices.

Rationale:

Data that are stored securely on an iOS or iPadOS device may be trivially accessed from a local computer. Forcing the encryption of backups significantly reduces the likelihood of sensitive data being compromised if the local host computer is compromised.

Impact:

End users must configure a password for the encrypted backup, the complexity of which is not managed."
  solution       : "Open Apple Configurator.

Open the Configuration Profile.

In the left window pane, click on the Restrictions tab.

In the right window pane, under the tab Functionality, check the checkbox for Force encrypted backups.

Deploy the Configuration Profile."
  reference      : "800-171|3.8.9,800-171|3.13.16,800-53|CP-9,800-53|SC-28,800-53r5|CP-9,800-53r5|SC-28,CN-L3|8.1.4.7(b),CN-L3|8.1.4.8(b),CSCv7|10.4,CSCv8|11.3,CSF|PR.DS-1,CSF|PR.IP-4,GDPR|32.1.a,GDPR|32.1.b,GDPR|32.1.c,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ISO/IEC-27001|A.12.3.1,ITSG-33|CP-9,ITSG-33|SC-28,ITSG-33|SC-28a.,LEVEL|1A,NESA|M5.2.3,NESA|T2.2.4,PCI-DSSv3.2.1|3.4,PCI-DSSv4.0|3.3.2,PCI-DSSv4.0|3.5.1,QCSC-v1|5.2.2,QCSC-v1|6.2"
  see_also       : "https://workbench.cisecurity.org/benchmarks/6168"
  json_transform : '.[] | select(.appType=="RESTRICTION") | "Policy: " + .name + " - Force Encrypted Backup = " + (.properties.LOCKDOWN_FORCEENCRYPTEDBACKUP // "not defined" )'
  regex          : "Force Encrypted Backup ="
  expect         : "Force Encrypted Backup = true"
</custom_item>

<report type:"WARNING">
  description : "3.2.1.11 Ensure 'Allow personalized ads delivered by Apple' is set to 'Disabled'"
  info        : "Apple provides a framework that allows advertisers to target Apple users with advertisements relevant to them and their interests by means of a unique identifier. For such personalized advertisements to be delivered, however, detailed information is collected, correlated, and made available to advertisers. This information is valuable to both advertisers and attackers and has been used with other metadata to reveal users' identities.

Rationale:

Disabling the use of a unique identifier helps hinder the tracking of users, which in turn supports protection of user data.

Impact:

Users will see generic advertising rather than targeted advertising. Apple warns that this will reduce the number of relevant ads.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Open Apple Configurator.

Open the Configuration Profile.

In the left window pane, click on the Restrictions tab.

In the right window pane, under the tab Functionality, uncheck the checkbox for Allow personalized ads delivered by Apple.

Deploy the Configuration Profile."
  reference   : "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv7|9.2,CSCv8|4.1,CSCv8|4.8,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1M,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3"
  see_also    : "https://workbench.cisecurity.org/benchmarks/6168"
</report>

<report type:"WARNING">
  description : "3.2.1.12 Ensure 'Allow Erase All Content and Settings' is set to 'Disabled'"
  info        : "This recommendation pertains to the factory reset functionality of iOS and iPadOS devices.

Rationale:

An institutionally-owned device should not allow an end user to destroy data.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Open Apple Configurator.

Open the Configuration Profile.

In the left window pane, click on the Restrictions tab.

In the right window pane, under the tab Functionality, uncheck the checkbox for Allow Erase All Content and Settings.

Deploy the Configuration Profile.

Additional Information:

An end-user may still employ Apple's Find My iPhone/iPad service to perform an Erase All Content and Settings. This also sets an activation lock on the device. Activation lock may be blocked using a Mobile Device Management (MDM) solution, but not via configuration profile.

For more information, see https://support.apple.com/en-us/HT202804"
  reference   : "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3"
  see_also    : "https://workbench.cisecurity.org/benchmarks/6168"
</report>

<report type:"WARNING">
  description : "3.2.1.14 Ensure 'Allow trusting new enterprise app authors' is set to 'Disabled'"
  info        : "This recommendation pertains to permitting application installation by end users from outside the Apple App Store or Mobile Device Management (MDM) deployment.

Rationale:

Allowing application installation by end users from outside of the Apple App Store or Mobile Device Management (MDM) may permit a user to install a malicious application.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Open Apple Configurator.

Open the Configuration Profile.

In the left window pane, click on the Restrictions tab.

In the right window pane, under the tab Functionality, uncheck the checkbox for Allow trusting new enterprise app authors.

Deploy the Configuration Profile."
  reference   : "800-171|3.4.1,800-171|3.4.7,800-171|3.4.9,800-53|CM-7(2),800-53|CM-8(3),800-53|CM-10,800-53|CM-11,800-53r5|CM-7(2),800-53r5|CM-8(3),800-53r5|CM-10,800-53r5|CM-11,CN-L3|8.1.10.2(a),CN-L3|8.1.10.2(b),CSCv7|2.6,CSCv8|2.3,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.6.2,ITSG-33|CM-7(2),ITSG-33|CM-8(3),LEVEL|1M,NESA|T1.2.1,NESA|T1.2.2,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.3,SWIFT-CSCv1|5.1"
  see_also    : "https://workbench.cisecurity.org/benchmarks/6168"
</report>

<custom_item>
  type           : CONFIGURATION_INFO
  description    : "3.2.1.15 Ensure 'Allow installing configuration profiles' is set to 'Disabled'"
  info           : "This recommendation pertains to the installation of additional configuration profiles.

Rationale:

This recommendation allows an institution to ensure that only the configuration profiles they provide are loaded onto the device.

Impact:

Some services, such as WiFi hotspot networks, may be prevented from working by blocking their configuration profiles."
  solution       : "Open Apple Configurator.

Open the Configuration Profile.

In the left window pane, click on the Restrictions tab.

In the right window pane, under the tab Functionality, uncheck the checkbox for Allow installing configuration profiles.

Deploy the Configuration Profile."
  reference      : "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3"
  see_also       : "https://workbench.cisecurity.org/benchmarks/6168"
  json_transform : '.[] | select(.appType=="RESTRICTION") | "Policy: " + .name + " - Allow Config Profile Install = " + (.properties.ALLOW_UI_CONFIG_PROFILE_INSTALL // "not defined" )'
  regex          : "Allow Config Profile Install ="
  expect         : "Allow Config Profile Install = false"
</custom_item>

<report type:"WARNING">
  description : "3.2.1.16 Ensure 'Allow adding VPN configurations' is set to 'Disabled'"
  info        : "This recommendation pertains to the addition of user-defined VPN configurations.

Rationale:

This recommendation allows an institution to ensure that only the VPN configurations they provide are loaded onto the device.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Open Apple Configurator.

Open the Configuration Profile.

In the left window pane, click on the Restrictions tab.

In the right window pane, under the tab Functionality, uncheck the checkbox for Allow adding VPN configurations.

Deploy the Configuration Profile."
  reference   : "800-171|3.1.1,800-171|3.1.2,800-171|3.1.12,800-171|3.1.14,800-53|AC-17,800-53|AC-17(1),800-53|AC-17(3),800-53r5|AC-17,800-53r5|AC-17(1),800-53r5|AC-17(3),CN-L3|8.1.4.4(c),CN-L3|8.1.10.6(i),CSCv7|9.2,CSCv8|12.7,CSF|PR.AC-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17,ITSG-33|AC-17(1),ITSG-33|AC-17(3),LEVEL|1A,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.4.6,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.6"
  see_also    : "https://workbench.cisecurity.org/benchmarks/6168"
</report>

<report type:"WARNING">
  description : "3.2.1.17 Ensure 'Force automatic date and time' is set to 'Enabled'"
  info        : "It is possible to automatically set the date and time on devices running iOS 12 and later. The time zone updates only when the device can determine its location, such as when a device has a cellular connection or a Wi-Fi connection with location services enabled.

Rationale:

Correct date and time settings are required for authentication protocols, file creation, modification dates, and log entries.

Impact:

When this option is enabled, users can't turn off Set Automatically under General > Date & Time

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Open Apple Configurator.

Open the Configuration Profile.

In the left window pane, click on the Restrictions tab.

In the right window pane, under the tab Functionality, check the checkbox for Force automatic date and time.

Deploy the Configuration Profile."
  reference   : "800-171|3.3.6,800-171|3.3.7,800-53|AU-7,800-53|AU-8,800-53r5|AU-7,800-53r5|AU-8,CN-L3|7.1.2.3(c),CN-L3|8.1.4.3(b),CSCv7|6.1,CSCv8|8.4,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-7,ITSG-33|AU-8,LEVEL|1M,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4,TBA-FIISB|37.4"
  see_also    : "https://workbench.cisecurity.org/benchmarks/6168"
</report>

<report type:"WARNING">
  description : "3.2.1.19 Ensure 'Allow USB accessories while the device is locked' is set to 'Disabled'"
  info        : "This recommendation pertains to allowing USB devices communicate with a locked device.

Rationale:

Physical attacks against iOS and iPadOS devices have been developed that exploit the trust of physically-connected accessories. This has led to proof-of-concept data extraction and even commercially available hardware designed to perform such attacks. By requiring the device to be unlocked in order to remove data, this control reduces the probability of a successful data extraction.

Impact:

An end user will not be able to connect their device to a USB accessory while the device is locked.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Open Apple Configurator.

Open the Configuration Profile.

In the left window pane, click on the Restrictions tab.

In the right window pane, under the tab Functionality, uncheck the checkbox for Allow USB accessories while the device is locked.

Deploy the Configuration Profile."
  reference   : "800-171|3.4.1,800-53|CM-8(3),800-53r5|CM-8(3),CN-L3|8.1.10.2(a),CN-L3|8.1.10.2(b),CSCv7|13.7,CSCv8|1.2,CSF|DE.CM-7,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-8(3),LEVEL|1A,NESA|T1.2.1,NESA|T1.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1"
  see_also    : "https://workbench.cisecurity.org/benchmarks/6168"
</report>

<custom_item>
  type           : CONFIGURATION_INFO
  description    : "3.2.1.21 Ensure 'Allow documents from managed sources in unmanaged destinations' is set to 'Disabled'"
  info           : "This recommendation pertains to Apple's managed application implementation.

The terms 'managed' and 'unmanaged' refer to app classifications made through Managed Open In, a feature introduced in iOS 7. Managed Open In provides for data containerization. Institutionally-provisioned apps are designated managed. Apps elected by the end user are designated unmanaged.

Rationale:

Limiting data transfer from the managed institutional application space to the user space may prevent data leakage."
  solution       : "Open Apple Configurator.

Open the Configuration Profile.

In the left window pane, click on the Restrictions tab.

In the right window pane, under the tab Functionality, uncheck the checkbox for Allow documents from managed sources in unmanaged destinations.

Deploy the Configuration Profile."
  reference      : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
  see_also       : "https://workbench.cisecurity.org/benchmarks/6168"
  json_transform : '.[] | select(.appType=="RESTRICTION") | "Policy: " + .name + " - Allow Open from Managed to Unmanaged = " + (.properties.ALLOW_OPEN_FROM_MANAGED_TO_UNMANAGED // "not defined" )'
  regex          : "Allow Open from Managed to Unmanaged ="
  expect         : "Allow Open from Managed to Unmanaged = false"
</custom_item>

<custom_item>
  type           : CONFIGURATION_INFO
  description    : "3.2.1.22 Ensure 'Allow documents from unmanaged sources in managed destinations' is set to 'Disabled'"
  info           : "This recommendation pertains to Apple's managed application implementation.

The terms 'managed' and 'unmanaged' refer to application classifications made through Managed Open In, a feature introduced in iOS 7. Managed Open In provides for data containerization. Institutionally-provisioned applications are designated as managed. Applications elected by the end user are designated as unmanaged.

Rationale:

Limiting data transfer from the unmanaged user application space to the managed institutional space limits institutional resources from being employed for personal use."
  solution       : "Open Apple Configurator.

Open the Configuration Profile.

In the left window pane, click on the Restrictions tab.

In the right window pane, under the tab Functionality, uncheck the checkbox for Allow documents from unmanaged sources in managed destinations.

Deploy the Configuration Profile."
  reference      : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
  see_also       : "https://workbench.cisecurity.org/benchmarks/6168"
  json_transform : '.[] | select(.appType=="RESTRICTION") | "Policy: " + .name + " - Allow Open from Unmanaged to Managed = " + (.properties.ALLOW_OPEN_FROM_UNMANAGED_TO_MANAGED // "not defined" )'
  regex          : "Allow Open from Unmanaged to Managed ="
  expect         : "Allow Open from Unmanaged to Managed = false"
</custom_item>

<report type:"WARNING">
  description : "3.2.1.23 Ensure 'Treat AirDrop as unmanaged destination' is set to 'Enabled'"
  info        : "This recommendation pertains to AirDrop in the context of Apple's managed app implementation.

The terms 'managed' and 'unmanaged' refer to application classifications made through Managed Open In, a feature introduced in iOS 7. Managed Open In provides for data containerization. Institutionally-provisioned applications are designated as managed. Applications elected by the end user are designated as unmanaged.

Rationale:

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Open Apple Configurator.

Open the Configuration Profile.

In the left window pane, click on the Restrictions tab.

In the right window pane, under the tab Functionality, check the checkbox for Treat AirDrop as unmanaged destination.

Deploy the Configuration Profile."
  reference   : "800-171|3.1.1,800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|AC-2(1),800-53|AC-3,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|AC-2(1),800-53r5|AC-3,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CN-L3|7.1.3.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|4.8,CSCv7|5.1,CSCv7|15.4,CSCv8|4.1,CSCv8|6.7,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-2(1),ITSG-33|AC-3,ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.2.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.2,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|AM3,NIAv2|AM28,NIAv2|GS8b,NIAv2|NS5j,NIAv2|SS3,NIAv2|SS14e,NIAv2|SS15a,NIAv2|SS16,NIAv2|SS29,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|2.3,TBA-FIISB|31.1"
  see_also    : "https://workbench.cisecurity.org/benchmarks/6168"
</report>

<report type:"WARNING">
  description : "3.2.1.24 Ensure 'Allow Handoff' is set to 'Disabled'"
  info        : "This recommendation pertains to Apple's Handoff data-sharing mechanism.

Rationale:

Handoff does not enforce managed application boundaries. This allows managed application data to be moved to the unmanaged application space on another device, which may result in data leakage.

Impact:

End users may be inconvenienced by disabling Handoff on their personal devices.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Open Apple Configurator.

Open the Configuration Profile.

In the left window pane, click on the Restrictions tab.

In the right window pane, under the tab Functionality, uncheck the checkbox for Allow Handoff.

Deploy the Configuration Profile."
  reference   : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
  see_also    : "https://workbench.cisecurity.org/benchmarks/6168"
</report>

<report type:"WARNING">
  description : "3.2.1.25 Ensure 'Allow sending diagnostic and usage data to Apple' is set to 'Disabled'"
  info        : "Apple provides a mechanism to send diagnostic and analytics data back to them in order help improve the platform. This information sent to Apple may contain internal organizational information that should not be disclosed to third parties.

Rationale:

Organizations should have knowledge of what is shared with vendors and other third parties, and should also be in full control of what is disclosed.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Open Apple Configurator.

Open the Configuration Profile.

In the left window pane, click on the Restrictions tab.

In the right window pane, under the tab Functionality, uncheck the checkbox for Allow sending diagnostic and usage data to Apple.

Deploy the Configuration Profile."
  reference   : "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv7|9.2,CSCv8|4.1,CSCv8|4.8,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1M,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3"
  see_also    : "https://workbench.cisecurity.org/benchmarks/6168"
</report>

<report type:"WARNING">
  description : "3.2.1.26 Ensure 'Require Touch ID / Face ID authentication before AutoFill' is set to 'Enabled'"
  info        : "This recommendation pertains to forcing re-authentication at each AutoFill operation.

Rationale:

A device may be accessed by an unauthorized user while unlocked. This recommendation provides defense-in-depth by forcing re-authentication before credentials will be populated by AutoFill.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Open Apple Configurator.

Open the Configuration Profile.

In the left window pane, click on the Restrictions tab.

In the right window pane, under the tab Functionality, check the checkbox for Require Touch ID / Face ID authentication before AutoFill.

Deploy the Configuration Profile.

Additional Information:

The benchmark remains intentionally silent on permitting the use of the local Apple Keychain, deferring to each institution to consider its own circumstances and associated risk."
  reference   : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
  see_also    : "https://workbench.cisecurity.org/benchmarks/6168"
</report>

<report type:"WARNING">
  description : "3.2.1.27 Ensure 'Force Apple Watch wrist detection' is set to 'Enabled'"
  info        : "This recommendation pertains to configuring wrist detection on paired Apple Watches.

Rationale:

Wrist detection prevents a removed Apple Watch from providing access to information not otherwise available.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Open Apple Configurator.

Open the Configuration Profile.

In the left window pane, click on the Restrictions tab.

In the right window pane, under the tab Functionality, check the checkbox for Force Apple Watch wrist detection.

Deploy the Configuration Profile."
  reference   : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
  see_also    : "https://workbench.cisecurity.org/benchmarks/6168"
</report>

<report type:"WARNING">
  description : "3.2.1.28 Ensure 'Allow setting up new nearby devices' is set to 'Disabled'"
  info        : "This recommendation pertains to Apple's Quick Start setup feature.

Rationale:

This recommendation prevents an institutionally-owned device from transferring configurations or content to another device.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Open Apple Configurator.

Open the Configuration Profile.

In the left window pane, click on the Restrictions tab.

In the right window pane, under the tab Functionality, uncheck the checkbox for Allow setting up new nearby devices.

Deploy the Configuration Profile.

Additional Information:

For more information on Quick Start, see: https://support.apple.com/en-us/HT201269"
  reference   : "800-171|3.12.3,800-171|3.13.4,800-53|CA-7,800-53|SC-4,800-53r5|CA-7,800-53r5|SC-4,CSCv7|13.3,CSCv8|3.13,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-2,CSF|DE.CM-3,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-1,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.IP-7,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,CSF|RS.MI-3,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|CA-7,ITSG-33|SC-4,ITSG-33|SC-4a.,LEVEL|1A,NESA|M1.2.2,NESA|M5.3.1,NESA|M5.4.1,NESA|M6.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2"
  see_also    : "https://workbench.cisecurity.org/benchmarks/6168"
</report>

<report type:"WARNING">
  description : "3.2.1.29 Ensure 'Allow proximity based password sharing requests' is set to 'Disabled'"
  info        : "This recommendation pertains to preventing proximity-based password sharing from institutionally-owned devices.

Rationale:

In an organizational context, access to systems and applications should be provisioned by role, with credentials only being transferred through supported credential management systems. Additionally, credential sharing requests may be exploited through a social engineering scheme.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Open Apple Configurator.

Open the Configuration Profile.

In the left window pane, click on the Restrictions tab.

In the right window pane, under the tab Functionality, uncheck the checkbox for Allow proximity based password sharing requests.

Deploy the Configuration Profile."
  reference   : "800-171|3.1.1,800-171|3.1.2,800-171|3.1.12,800-171|3.13.1,800-171|3.13.5,800-171|3.14.6,800-171|3.14.7,800-53|AC-17,800-53|AC-17(1),800-53|SC-7,800-53|SI-4,800-53r5|AC-17,800-53r5|AC-17(1),800-53r5|SC-7,800-53r5|SI-4,CN-L3|7.1.3.5(a),CN-L3|8.1.4.4(c),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CN-L3|8.1.10.6(i),CN-L3|8.1.10.6(j),CSCv7|12.12,CSCv8|13.5,CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.AC-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-8,CSF|PR.PT-4,CSF|RS.AN-1,CSF|RS.CO-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.13.1.3,ITSG-33|AC-17,ITSG-33|AC-17(1),ITSG-33|SC-7,ITSG-33|SI-4,LEVEL|1A,NESA|M1.2.2,NESA|T4.5.4,NESA|T5.4.4,NESA|T5.4.5,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,SWIFT-CSCv1|2.6,TBA-FIISB|43.1"
  see_also    : "https://workbench.cisecurity.org/benchmarks/6168"
</report>

<report type:"WARNING">
  description : "3.2.1.30 Ensure 'Allow password sharing (supervised only)' is set to 'Disabled'"
  info        : "This recommendation pertains to sharing credentials between devices, such as through AirDrop.

Rationale:

Allowing password sharing may increase the likelihood of an institutionally related credential being moved to a non-institutionally controlled device.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Open Apple Configurator.

Open the Configuration Profile.

In the left window pane, click on the Restrictions tab.

In the right window pane, under the tab Functionality, uncheck the checkbox for Allow password sharing (supervised only).

Deploy the Configuration Profile."
  reference   : "800-171|3.1.1,800-171|3.1.2,800-171|3.1.12,800-171|3.2.1,800-171|3.2.2,800-171|3.13.1,800-171|3.13.5,800-171|3.14.6,800-171|3.14.7,800-53|AC-17,800-53|AC-17(1),800-53|AT-2,800-53|SC-7,800-53|SI-4,800-53r5|AC-17,800-53r5|AC-17(1),800-53r5|AT-2,800-53r5|SC-7,800-53r5|SI-4,CN-L3|7.1.3.5(a),CN-L3|8.1.4.4(c),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CN-L3|8.1.10.6(i),CN-L3|8.1.10.6(j),CSCv7|12.12,CSCv7|17.5,CSCv8|13.5,CSCv8|14.3,CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.AC-3,CSF|PR.AC-5,CSF|PR.AT-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|PR.PT-4,CSF|RS.AN-1,CSF|RS.CO-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.13.1.3,ITSG-33|AC-17,ITSG-33|AC-17(1),ITSG-33|AT-2,ITSG-33|SC-7,ITSG-33|SI-4,LEVEL|1M,NESA|M1.2.2,NESA|M1.3.6,NESA|M3.4.1,NESA|T3.4.1,NESA|T4.5.4,NESA|T5.4.4,NESA|T5.4.5,NIAv2|AM13,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,SWIFT-CSCv1|2.6,SWIFT-CSCv1|7.2,TBA-FIISB|43.1"
  see_also    : "https://workbench.cisecurity.org/benchmarks/6168"
</report>

<custom_item>
  type           : CONFIGURATION_INFO
  description    : "3.2.1.31 Ensure 'Show Control Center in Lock screen' is set to 'Disabled'"
  info           : "This recommendation pertains to the display of Control Center on the lock screen.

Rationale:

When a device is lost or stolen, the Control Center may be used to enable airplane mode, thus preventing locating or erasing the device. It forces a malicious actor to power down the device, which then discards the encryption key in memory. This makes other attacks based on physical possession more difficult."
  solution       : "Open Apple Configurator.

Open the Configuration Profile.

In the left window pane, click on the Restrictions tab.

In the right window pane, under the tab Functionality, uncheck the checkbox for Show Control Center in Lock screen.

Deploy the Configuration Profile."
  reference      : "800-171|3.1.1,800-171|3.1.10,800-171|3.1.11,800-53|AC-2(5),800-53|AC-11,800-53|AC-11(1),800-53|AC-12,800-53r5|AC-2(5),800-53r5|AC-11,800-53r5|AC-11(1),800-53r5|AC-12,CN-L3|7.1.2.2(d),CN-L3|7.1.3.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSCv7|16.11,CSCv8|4.3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-2(5),ITSG-33|AC-11,ITSG-33|AC-11(1),ITSG-33|AC-12,LEVEL|1A,NIAv2|AM23c,NIAv2|AM23d,NIAv2|AM28,NIAv2|NS5j,NIAv2|NS49,NIAv2|SS14e,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,TBA-FIISB|36.2.1,TBA-FIISB|37.1.4"
  see_also       : "https://workbench.cisecurity.org/benchmarks/6168"
  json_transform : '.[] | select(.appType=="RESTRICTION") | "Policy: " + .name + " - Allow Lock Screen Control Center = " + (.properties.ALLOW_LOCKSCREENCONTOLCENTER // "not defined" )'
  regex          : "Allow Lock Screen Control Center ="
  expect         : "Allow Lock Screen Control Center = false"
</custom_item>

<custom_item>
  type           : CONFIGURATION_INFO
  description    : "3.2.1.32 Ensure 'Show Notification Center in Lock screen' is set to 'Disabled'"
  info           : "This recommendation pertains to the display of Notification Center on the lock screen.

Rationale:

Communications between the operating system and applications to a user should be controlled to prevent data leakage or exploitation. For example, some two-factor authentication applications will present the option to allow a login from a new device in notification center on the lock screen."
  solution       : "Open Apple Configurator.

Open the Configuration Profile.

In the left window pane, click on the Restrictions tab.

In the right window pane, under the tab Functionality, uncheck the checkbox for Show Notification Center in Lock screen.

Deploy the Configuration Profile.

Additional Information:

The per-application notification settings described later in the benchmark can be used in lieu of disabling Notification Center at the lock screen. This should only be done if there is confidence that all applications producing sensitive notifications can be managed."
  reference      : "800-171|3.1.1,800-171|3.1.10,800-171|3.1.11,800-53|AC-2(5),800-53|AC-11,800-53|AC-11(1),800-53|AC-12,800-53r5|AC-2(5),800-53r5|AC-11,800-53r5|AC-11(1),800-53r5|AC-12,CN-L3|7.1.2.2(d),CN-L3|7.1.3.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSCv7|16.11,CSCv8|4.3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-2(5),ITSG-33|AC-11,ITSG-33|AC-11(1),ITSG-33|AC-12,LEVEL|1A,NIAv2|AM23c,NIAv2|AM23d,NIAv2|AM28,NIAv2|NS5j,NIAv2|NS49,NIAv2|SS14e,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,TBA-FIISB|36.2.1,TBA-FIISB|37.1.4"
  see_also       : "https://workbench.cisecurity.org/benchmarks/6168"
  json_transform : '.[] | select(.appType=="RESTRICTION") | "Policy: " + .name + " - Allow Lock Screen Notification View = " + (.properties.ALLOW_LOCKSCREENNOTIFICATIONVIEW // "not defined" )'
  regex          : "Allow Lock Screen Notification View ="
  expect         : "Allow Lock Screen Notification View = false"
</custom_item>

<custom_item>
  type           : CONFIGURATION_INFO
  description    : "3.2.2.1 Ensure 'Force fraud warning' is set to 'Enabled'"
  info           : "This recommendation pertains to the Safari feature which warns end users about visiting suspected fraudulent websites.

Rationale:

Enabling a warning may help users avoid accidentally visiting known phishing or other fraudulent sites covered by this feature."
  solution       : "Open Apple Configurator.

Open the Configuration Profile.

In the left window pane, click on the Restrictions tab.

In the right window pane, under the tab Apps, check the checkbox for Force fraud warning.

Deploy the Configuration Profile."
  reference      : "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3"
  see_also       : "https://workbench.cisecurity.org/benchmarks/6168"
  json_transform : '.[] | select(.appType=="RESTRICTION") | "Policy: " + .name + " - Fraud Warning = " + (.properties.LOCKDOWN_SAFARIFORCEFRAUDWARNING // "not defined" )'
  regex          : "Fraud Warning ="
  expect         : "Fraud Warning = true"
</custom_item>

<custom_item>
  type           : CONFIGURATION_INFO
  description    : "3.2.2.2 Ensure 'Accept cookies' is set to 'From websites I visit' or 'From current website only'"
  info           : "This recommendation pertains to the acceptance of third-party cookies.

Rationale:

The HEIST cookie exploit allows for retrieving data from cookies stored on a device. Cookies often follow poor coding practices and often include authentication properties. Limiting acceptance of cookies to only those from sites intentionally visited reduces the likelihood of exploitation."
  solution       : "Open Apple Configurator.

Open the Configuration Profile.

In the left window pane, click on the Restrictions tab.

In the right window pane, under the tab Apps, set the Accept cookies menu to From websites I visit or From current website only.

Deploy the Configuration Profile.

Additional Information:

From websites I visit accepts cookies from the current domain and any other domain you've visited. From current website only only accepts cookies from the current domain."
  reference      : "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3"
  see_also       : "https://workbench.cisecurity.org/benchmarks/6168"
  json_transform : '.[] | select(.appType=="RESTRICTION") | "Policy: " + .name + " - Accept Cookies = " + (.properties.LOCKDOWN_SAFARIACCEPTCOOKIES // "not defined" )'
  regex          : "Accept Cookies ="
  expect         : "Accept Cookies = 1"
</custom_item>

<report type:"WARNING">
  description : "3.3.1 Ensure 'Managed Safari Web Domains' is 'Configured'"
  info        : "This recommendation pertains to whether Safari, as well as Mobile Device Management (MDM) deployed browsers, will consider certain URL patterns for managed application spaces only.

Rationale:

Sensitive files available from a website may be downloaded into the unmanaged application spaces by default. By configuring specific domains that Safari should consider managed, an institution may support the secure containerization of their data.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "From the Configuration Profile:

Open Apple Configurator.

Open the Configuration Profile.

In the left windowpane, click on the Domains tab.

In the right windowpane, under Managed Safari Web Domains enter the appropriate URL pattern(s).

Deploy the Configuration Profile.

Additional Information:

For improved effectiveness, this recommendation should be paired with the blacklisting of web browsers not deployed through the MDM."
  reference   : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1M,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
  see_also    : "https://workbench.cisecurity.org/benchmarks/6168"
</report>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "3.4.1 Ensure 'Allow simple value' is set to 'Disabled'"
  info           : "This recommendation pertains to passcode requirements. A simple passcode is defined as containing repeated characters, or increasing/decreasing characters (such as 123 or CBA).

Rationale:

Simple passcodes such as those with repeating, ascending, or descending character sequences are easily guessed. Preventing the selection of passwords containing such sequences increases the complexity of the passcode and reduces the ease with which an attacker may attempt to guess the passcode in order to gain access to the device."
  solution       : "Open Apple Configurator.

Open the Configuration Profile.

In the left window pane, click on the Passcode tab.

In the right window pane, uncheck the checkbox for Allow simple value.

Deploy the Configuration Profile."
  reference      : "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1"
  see_also       : "https://workbench.cisecurity.org/benchmarks/6168"
  json_transform : '.[] | select(.active=="true") | "Policy: " + .policyName + " - Password Type = " + (.policyRules.SECURITY_PWD_TYPE // "not defined" )'
  regex          : "Password Type ="
  expect         : "Password Type = alphanumeric"
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "3.4.3 Ensure 'Minimum passcode length' is set to a value of '6' or greater"
  info           : "This recommendation pertains to minimum passcode length.

Rationale:

Requiring at least six character minimum length provides reasonable assurance against passcode attacks."
  solution       : "Open Apple Configurator.

Open the Configuration Profile.

In the left window pane, click on the Passcode tab.

In the right window pane, set the Minimum passcode length to 6, or greater.

Deploy the Configuration Profile."
  reference      : "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1"
  see_also       : "https://workbench.cisecurity.org/benchmarks/6168"
  json_transform : '.[] | select(.active=="true") | "Policy: " + .policyName + " - Password Length = \(.policyRules.SECURITY_PWD_LENGTH // "not defined" )"'
  regex          : "Password Length ="
  expect         : "Password Length = ([6-9]|[1-9][0-9])"
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "3.4.4 Ensure 'Maximum Auto-Lock' is set to '2 minutes' or less"
  info           : "This recommendation pertains to the maximum number of minutes a device may remain inactive before auto-locking.

Note: This recommendation refers to maximum auto-lock, consistent with the interface language, but iOS and iPadOS devices treat the auto-lock function as equaling exactly 2 minutes.

Rationale:

Automatically locking the device after a short period of inactivity reduces the probability of an attacker accessing the device without entering a password.

Impact:

This is not enforced during certain activities, such as watching movies."
  solution       : "Open Apple Configurator.

Open the Configuration Profile.

In the left window pane, click on the Passcode tab.

In the right window pane, set the Maximum Auto-Lock to 2.

Deploy the Configuration Profile."
  reference      : "800-171|3.1.1,800-171|3.1.10,800-171|3.1.11,800-53|AC-2(5),800-53|AC-11,800-53|AC-11(1),800-53|AC-12,800-53r5|AC-2(5),800-53r5|AC-11,800-53r5|AC-11(1),800-53r5|AC-12,CN-L3|7.1.2.2(d),CN-L3|7.1.3.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSCv7|16.11,CSCv8|4.3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-2(5),ITSG-33|AC-11,ITSG-33|AC-11(1),ITSG-33|AC-12,LEVEL|1A,NIAv2|AM23c,NIAv2|AM23d,NIAv2|AM28,NIAv2|NS5j,NIAv2|NS49,NIAv2|SS14e,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,TBA-FIISB|36.2.1,TBA-FIISB|37.1.4"
  see_also       : "https://workbench.cisecurity.org/benchmarks/6168"
  json_transform : '.[] | select(.active=="true") | "Policy: " + .policyName + " - Inactivity Timeout = " + (.policyRules.SECURITY_INACTIVITY_TIMEOUT // "not defined" )'
  regex          : "Inactivity Timeout ="
  expect         : "Inactivity Timeout = [1-2] minute"
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "3.4.5 Ensure 'Maximum grace period for device lock' is set to 'Immediately'"
  info           : "This recommendation pertains to the amount of time a device may be unlocked without entering a passcode after that device has been locked. Devices with TouchID enabled do not allow a grace period.

Rationale:

Configuring the Maximum grace period for device lock to Immediately precludes unauthenticated access when waking the device."
  solution       : "Open Apple Configurator.

Open the Configuration Profile.

In the left window pane, click on the Passcode tab.

In the right window pane, set the Maximum grace period for device lock to Immediately.

Deploy the Configuration Profile."
  reference      : "800-171|3.1.1,800-171|3.1.10,800-171|3.1.11,800-53|AC-2(5),800-53|AC-11,800-53|AC-11(1),800-53|AC-12,800-53r5|AC-2(5),800-53r5|AC-11,800-53r5|AC-11(1),800-53r5|AC-12,CN-L3|7.1.2.2(d),CN-L3|7.1.3.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSCv7|16.11,CSCv8|4.3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-2(5),ITSG-33|AC-11,ITSG-33|AC-11(1),ITSG-33|AC-12,LEVEL|1A,NIAv2|AM23c,NIAv2|AM23d,NIAv2|AM28,NIAv2|NS5j,NIAv2|NS49,NIAv2|SS14e,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,TBA-FIISB|36.2.1,TBA-FIISB|37.1.4"
  see_also       : "https://workbench.cisecurity.org/benchmarks/6168"
  json_transform : '.[] | select(.active=="true") | "Policy: " + .policyName + " - Grace Period = \(.policyRules.SECURITY_GRACE_PERIOD // "not defined" )"'
  regex          : "Grace Period ="
  expect         : "Grace Period = 0"
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "3.4.6 Ensure 'Maximum number of failed attempts' is set to '6'"
  info           : "This recommendation pertains to the number of attempted logins before automatic deletion of a device's cryptographic key.

Rationale:

Excessive incorrect passcode attempts typically indicate that the owner has lost physical control of the device. In the event of such an incident, erasing the encryption key will help to ensure confidentiality of information stored on the device."
  solution       : "Open Apple Configurator.

Open the Configuration Profile.

In the left window pane, click on the Passcode tab.

In the right window pane, set the Maximum number of failed attempts to 6.

Deploy the Configuration Profile."
  reference      : "800-171|3.1.1,800-171|3.1.10,800-171|3.1.11,800-53|AC-2(5),800-53|AC-11,800-53|AC-11(1),800-53|AC-12,800-53r5|AC-2(5),800-53r5|AC-11,800-53r5|AC-11(1),800-53r5|AC-12,CN-L3|7.1.2.2(d),CN-L3|7.1.3.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSCv7|16.11,CSCv8|4.3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-2(5),ITSG-33|AC-11,ITSG-33|AC-11(1),ITSG-33|AC-12,LEVEL|1A,NIAv2|AM23c,NIAv2|AM23d,NIAv2|AM28,NIAv2|NS5j,NIAv2|NS49,NIAv2|SS14e,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,TBA-FIISB|36.2.1,TBA-FIISB|37.1.4"
  see_also       : "https://workbench.cisecurity.org/benchmarks/6168"
  json_transform : '.[] | select(.active=="true") | "Policy: " + .policyName + " - Maximum Failed Attempts = \(.policyRules.SECURITY_PWD_MAX_FAILED_ATTEMPTS // "not defined" )"'
  regex          : "Maximum Failed Attempts ="
  expect         : "Maximum Failed Attempts = [1-6][^0-9]"
</custom_item>

<report type:"WARNING">
  description : "3.5.1 Ensure 'Disable Association MAC Randomization' is 'Configured'"
  info        : "This recommendation pertains to disabling MAC randomization as needed.

Rationale:

MAC randomization is a feature available from iOS 14 onward and is enabled by default. Although this feature enhances privacy for individuals by using random and different addresses for each Wi-Fi network, it can lead to problems in some circumstances, such as captive portals, MAC-based Access Control Lists, etc. In such cases, disabling this feature may be necessary. This is a per-network setting, meaning it can be turned off for specific networks only.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "This remediation procedure cannot be accomplished with a checkbox, it needs to be applied on a per-network basis as appropriate.
From the Configuration Profile:

Open Apple Configurator.

Open the Configuration Profile.

In the left window pane, click on the Wi-Fi tab.

In the right window pane, select the relevant Wi-Fi configuration.

In the right window pane, check the checkbox for Disable Association MAC Randomization.

Deploy the Configuration Profile.

From the device:

Tap Settings.

Tap Wi-Fi.

Tap the relevant network.

Disable the option Private Address."
  reference   : "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1M,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3"
  see_also    : "https://workbench.cisecurity.org/benchmarks/6168"
</report>

<custom_item>
  type           : CONFIGURATION_INFO
  description    : "3.6.1 Ensure 'VPN' is 'Configured'"
  info           : "This recommendation pertains to establishing a virtual private network (VPN) connection as needed.

Rationale:

The network to which a device connects provides important services that may be exploited by a malicious actor. Establishing a VPN mitigates the associated risks by encrypting data in transit and using known good network services, such as DNS."
  solution       : "This remediation procedure cannot be accomplished with a checkbox. As mentioned below, a per-application VPN configuration is the preferred solution, but a system-wide VPN is also acceptable. An appropriate solution will need to be determined and implemented.
From the Configuration Profile:

Open Apple Configurator.

Open the Configuration Profile.

In the left window pane, click on the VPN tab.

In the right window pane, enter an appropriate VPN configuration.

Deploy the Configuration Profile.

From the device,

Tap Settings.

Tap General.

Tap VPN.

Enter an appropriate VPN configuration."
  reference      : "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|14.4,CSCv8|3.10,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|1M,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1"
  see_also       : "https://workbench.cisecurity.org/benchmarks/6168"
  json_transform : '.[] | select(.appType=="VPN") | "VPN Configuration: " + .name'
  regex          : "VPN Configuration:"
  expect         : "VPN Configuration: "
</custom_item>

<custom_item>
  type           : CONFIGURATION_INFO
  description    : "3.7.1 Ensure 'Allow user to move messages from this account' is set to 'Disabled'"
  info           : "This recommendation pertains to whether a message can be moved from an institutionally-configured mail account to an end user-configured mail account. It also limits forwarding or replying from a different account than the one from which the message originated.

Note: This recommendation only applies if an institutionally-configured mail account resides on the device.

Rationale:

Allowing the movement of messages from a managed email account to an unmanaged email account may result in data leakage."
  solution       : "From the Configuration Profile:

Open Apple Configurator.

Open the Configuration Profile.

In the left window pane, click on the Mail tab.

In the right window pane, uncheck the checkbox for Allow user to move messages from this account."
  reference      : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
  see_also       : "https://workbench.cisecurity.org/benchmarks/6168"
  json_transform : '.[] | select((.appType=="EMAIL") or (.appType=="EXCHANGE")) | "Policy: " + .name + " - Block Message Move Forward = " + (.properties.BLOCK_MESSAGEMOVEFORWARD // "not defined" )'
  regex          : "Block Message Move Forward ="
  expect         : "Block Message Move Forward = true"
  match_all      : YES
</custom_item>

<report type:"WARNING">
  description : "3.8.1 Ensure 'Notification Settings' are configured for all 'Managed Apps'"
  info        : "This recommendation pertains to the configuration of notification settings on a per-application basis.

Rationale:

Notifications may include sensitive data or might allow for privileged actions to take place. All managed applications must include explicit notification settings in order to address these concerns.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Open Apple Configurator.

Open the Configuration Profile.

In the left window pane, click on the Notifications tab.

In the right window pane, click Configure and/or click the + to add notification settings on a per-app basis.

Deploy the Configuration Profile."
  reference   : "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1M,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3"
  see_also    : "https://workbench.cisecurity.org/benchmarks/6168"
</report>

<report type:"WARNING">
  description : "3.9.1 Ensure 'If Lost, Return to...' Message is 'Configured'"
  info        : "This recommendation pertains to configuring a lock screen message.

Rationale:

A lock screen message will allow an honest bystander to more easily return a lost device.

This message need not identify the owner by name, but should reference a phone number or email address to contact (for example, the help desk of an organization).

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Open Apple Configurator.

Open the Configuration Profile.

In the left window pane, click on the Lock Screen Message tab.

In the right window pane, in the 'If Lost, Return to...' Message field, configure an appropriate message.

Deploy the Configuration Profile."
  reference   : "800-171|3.1.1,800-171|3.1.10,800-171|3.1.11,800-53|AC-2(5),800-53|AC-11,800-53|AC-11(1),800-53|AC-12,800-53r5|AC-2(5),800-53r5|AC-11,800-53r5|AC-11(1),800-53r5|AC-12,CN-L3|7.1.2.2(d),CN-L3|7.1.3.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSCv7|16.11,CSCv8|4.3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-2(5),ITSG-33|AC-11,ITSG-33|AC-11(1),ITSG-33|AC-12,LEVEL|1M,NIAv2|AM23c,NIAv2|AM23d,NIAv2|AM28,NIAv2|NS5j,NIAv2|NS49,NIAv2|SS14e,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,TBA-FIISB|36.2.1,TBA-FIISB|37.1.4"
  see_also    : "https://workbench.cisecurity.org/benchmarks/6168"
</report>

<report type:"WARNING">
  description : "4.1.1 Review Manage Sharing & Access"
  info        : "Managing Sharing & Access is a new feature available with iOS 16, which allows via a wizard to review what is being shared with people and apps to determine if current settings are adequate or if some access needs to be revoked. It also allows to review the settings related to a user's Apple ID.

Rationale:

By regularly reviewing what is being shared with apps and people, and by reviewing the Apple ID settings, users can ensure sharing settings are accurate and fit for purpose as well as their Apple ID is kept safe.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "From the device:

Tap Settings.

Tap Privacy & Secuurity.

Tap Safety Check.

Tap Manage Sharing & Access.

Tap Continue.

Remove sharing from any applications or people that are outside your organization's requirements

Tap Done at the end of the procedure."
  reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1M,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
  see_also    : "https://workbench.cisecurity.org/benchmarks/6168"
</report>

<report type:"WARNING">
  description : "4.2 Ensure device is not obviously jailbroken or compromised"
  info        : "This recommendation pertains to inspecting a device for the presence of the most common jailbreak indicator.

Rationale:

Apple imposes certain restrictions on which apps can be installed on a device. Further, no app can gain access to information and data on the device or another app without being given authorization. This restricts the potential risk of unauthorized access by an app due to the limited administrative rights allowed by Apple. A compromised iOS device, both unintentionally in the event of a malicious actor and willingly as for jailbroken devices, may circumvent the above restrictions and in doing so may execute arbitrary code, compromise configuration profile requirements, or open the device to exploits that are otherwise not possible.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Restore the iOS to a known good state from a trusted computer:

Open iTunes.

Connect the iOS device to the computer with a USB cable.

Select your iOS device within iTunes.

Select Restore iPhone/iPad.

After restoration, set up as a new device or restore from a known good backup."
  reference   : "800-53|SA-22,800-53r5|SA-22,CSCv7|2.2,CSCv8|2.2,GDPR|32.1.b,HIPAA|164.306(a)(1),LEVEL|1M"
  see_also    : "https://workbench.cisecurity.org/benchmarks/6168"
</report>

<report type:"WARNING">
  description : "4.3 Ensure 'Install iOS Updates' of 'Automatic Updates' is set to 'Enabled'"
  info        : "This recommendation pertains to the automatic installation of operating system updates.

Rationale:

System updates may patch software vulnerabilities, therefore it is important that devices are kept up-to-date.

Impact:

In the following circumstances automatic updates should be kept disabled:

If the organization leverages third-party tools to manage software updates for Apple devices,

If the organization has a strict patch management process, which involves testing the software updates on pilot devices before an exhaustive roll-out.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "From the device:

Tap Settings.

Tap General.

Tap Software Updates

Tap Automatic Updates.

Enable Download iOS Updates and Install iOS Updates."
  reference   : "800-171|3.11.2,800-171|3.11.3,800-171|3.14.1,800-53|RA-5,800-53|SI-2,800-53|SI-2(2),800-53r5|RA-5,800-53r5|SI-2,800-53r5|SI-2(2),CN-L3|8.1.4.4(e),CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSCv7|3.4,CSCv8|7.3,CSF|DE.CM-8,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.IP-12,CSF|RS.CO-3,CSF|RS.MI-3,GDPR|32.1.b,GDPR|32.1.d,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.6.1,ITSG-33|RA-5,ITSG-33|SI-2,ITSG-33|SI-2(2),LEVEL|1M,NESA|M1.2.2,NESA|M5.4.1,NESA|T7.6.2,NESA|T7.7.1,NIAv2|PR9,PCI-DSSv3.2.1|6.1,PCI-DSSv3.2.1|6.2,PCI-DSSv4.0|6.3,PCI-DSSv4.0|6.3.1,PCI-DSSv4.0|6.3.3,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,SWIFT-CSCv1|2.2,SWIFT-CSCv1|2.7"
  see_also    : "https://workbench.cisecurity.org/benchmarks/6168"
</report>

<report type:"WARNING">
  description : "4.4 Ensure 'Software Update' returns 'Your software is up to date.'"
  info        : "This recommendation pertains to updating and upgrading the operating system of a given device.

Rationale:

An up-to-date operating system provides the best possible protection against the execution of malicious code.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "From the device:

Tap Settings.

Tap General.

Tap Software Update.

Tap Install or Download and Install and then allow device to complete the installation."
  reference   : "800-171|3.11.2,800-171|3.11.3,800-171|3.14.1,800-53|RA-5,800-53|SI-2,800-53|SI-2(2),800-53r5|RA-5,800-53r5|SI-2,800-53r5|SI-2(2),CN-L3|8.1.4.4(e),CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSCv7|3.4,CSCv7|3.5,CSCv8|7.3,CSCv8|7.4,CSF|DE.CM-8,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.IP-12,CSF|RS.CO-3,CSF|RS.MI-3,GDPR|32.1.b,GDPR|32.1.d,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.6.1,ITSG-33|RA-5,ITSG-33|SI-2,ITSG-33|SI-2(2),LEVEL|1M,NESA|M1.2.2,NESA|M5.4.1,NESA|T7.6.2,NESA|T7.7.1,NIAv2|PR9,PCI-DSSv3.2.1|6.1,PCI-DSSv3.2.1|6.2,PCI-DSSv4.0|6.3,PCI-DSSv4.0|6.3.1,PCI-DSSv4.0|6.3.3,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,SWIFT-CSCv1|2.2,SWIFT-CSCv1|2.7"
  see_also    : "https://workbench.cisecurity.org/benchmarks/6168"
</report>

<report type:"WARNING">
  description : "4.5 Review 'iCloud Private Relay' settings"
  info        : "iCloud Private Relay is a service offered by Apple as part of an iCloud+ subscription. It allows users on iOS 15, iPadOS 15, and macOS Monterey to browse the Web more privately by hiding the user's actual IP address.

The service makes use of a multi-hop architecture whereby a user's requests are sent through two separate internet relays, operated by different entities, that replace a user's original IP address.

The user's IP address is visible to the network provider and to the first relay, which is operated by Apple. The DNS records are encrypted, so neither party can see the address of the website the user is trying to visit. The second relay, which is operated by a third-party content provider, generates a temporary IP address, decrypts the name of the website, and connects to the site. By doing so, no single party - including Apple - can view or collect the details of a user's browsing activity or unencrypted activity in applications.

Rationale:

While browsing the Web, information contained in the Web traffic, such as DNS records and IP address, can be seen by a network provider and by any websites visited. This information could be used to determine a user's identity and build a profile of their location and browsing history.

Hiding this information prevents the tracking and profiling of users, resulting in an increased level of privacy while browsing the Web.

Impact:

iCloud Private Relay only protects connections on public internet servers, instructing the device to try to access the servers directly over the local network. Some entities or enterprises, however, might be required to audit all network traffic by policy. In this case, it is possible to block access to Private Relay. Should iCloud Private Relay be blocked, the user will be alerted that they need to either disable the feature or choose another network. In this scenario, users will still be able to use the service when they are not connected to their corporate network.

The fastest and most reliable way to do this is to return a negative answer from the network's DNS resolver, preventing DNS resolution for the mask.icloud.com and mask-h2.icloud.com hostnames necessary for Private Relay traffic.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "From the device:

Tap Settings.

Tap <_The User's Name_> where Apple ID, iCloud, iTunes & App Store is displayed beneath.

Tap iCloud.

Tap Private Relay.

Enable Private Relay."
  reference   : "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv7|9.2,CSCv8|4.1,CSCv8|4.8,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1M,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3"
  see_also    : "https://workbench.cisecurity.org/benchmarks/6168"
</report>

<report type:"WARNING">
  description : "4.6 Review 'Mail Privacy Protection' settings"
  info        : "Mail Privacy Protection helps protect user privacy by preventing email senders from learning information about the activity they engage with using the Mail application. When turned on, this feature hides user IP addresses.

Rationale:

By enabling Mail Privacy, senders cannot build a profile of a user's online activity or determine their location. Such a feature also prevents senders from seeing if users have opened the email they sent.

Hiding user IP addresses prevents user tracking and profiling, which results in an increased level of privacy while using the Mail app.

Impact:

Some entities or enterprises might be required to audit all network traffic by policy. In this case, it is possible to block access to Mail Privacy Protection. The fastest and most reliable way to do this is to return a negative answer from the network's DNS resolver, preventing DNS resolution for the mask.icloud.com and mask-h2.icloud.com hostnames necessary for Mail Privacy Protection traffic.

In this scenario, users will still be able to use the service when they are not connected to their corporate network.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "From the device:

Tap Settings.

Tap Mail.

Tap Privacy Protection.

Enable Protect Mail Activity."
  reference   : "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv7|9.2,CSCv8|4.1,CSCv8|4.8,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1M,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3"
  see_also    : "https://workbench.cisecurity.org/benchmarks/6168"
</report>

<report type:"WARNING">
  description : "4.7 Ensure 'Automatic Downloads' of 'App Updates' is set to 'Enabled'"
  info        : "This recommendation pertains to the automatic installation of application updates.

Rationale:

Application updates may patch software vulnerabilities.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "From the device:

Tap Settings.

Tap iTunes & App Store.

Under AUTOMATIC DOWNLOADS, enable App Updates."
  reference   : "800-171|3.11.2,800-171|3.11.3,800-171|3.14.1,800-53|RA-5,800-53|SI-2,800-53|SI-2(2),800-53r5|RA-5,800-53r5|SI-2,800-53r5|SI-2(2),CN-L3|8.1.4.4(e),CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSCv7|3.5,CSCv8|7.4,CSF|DE.CM-8,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.IP-12,CSF|RS.CO-3,CSF|RS.MI-3,GDPR|32.1.b,GDPR|32.1.d,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.6.1,ITSG-33|RA-5,ITSG-33|SI-2,ITSG-33|SI-2(2),LEVEL|1M,NESA|M1.2.2,NESA|M5.4.1,NESA|T7.6.2,NESA|T7.7.1,NIAv2|PR9,PCI-DSSv3.2.1|6.1,PCI-DSSv3.2.1|6.2,PCI-DSSv4.0|6.3,PCI-DSSv4.0|6.3.1,PCI-DSSv4.0|6.3.3,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,SWIFT-CSCv1|2.2,SWIFT-CSCv1|2.7"
  see_also    : "https://workbench.cisecurity.org/benchmarks/6168"
</report>

</check_type>
