#TRUSTED 856ea9696cae2b0d4b7d6788a196850b8d944e8ea444dda77f6c1bca223a40c0d1f156f7ebd659c3e0a1dd8f64052b2c3e756b584b5fb6e5af712dd18f0ecc75006f39a6c80058fc32d08b6b777404f144ef214e8d1fb94f39f839d6a70afe1a61159adb84646ed27e8c0dfde1b46aa5a6b70f08e9516c75f708c243f0ec5580d3a6abcbda50d9f8cad0d6700c665c482b2bc02f2bd6e430dde4a8f57501deec926c9f29280b4c2da5bb5c7bb48a12c8f47a93137de8bdfd058a437491775e26b52cd54e202ecb92bad6c064ccc24b88751cd1f8f4820a29e97340ef6138d94982607d4caa9194d55ef5be54fa093389cc89d0bb009ec6842bf980f73392ad19962b9c8ccd5c761c597a0708babdeb136878ed0056be25730d024104ca921080c11f017daac799651c57450e2a30ba63e305d611d2a650da61fcd1b4712a2fff7d6bb926c2f74f70d5b28438349d3dc4a0fb4b77e1422749fa31050b71a318fb36f8624b759266fc52f165c203c85d4a430ddfb8c86ce4a5c271f230f31858a487f71c9bad109176787d66edcefe08901a25d1ad7da91418bc532061f28d87ade128466fab93faa45e720567f141aa10c47db692bf710b56d3c844f1fbfadcbeb92175c3ae64ff9c633370fc3fc9674436580839f362a5a63b3dc89a483988242b5bdc9e787fb62c3c161be828fbc1d518a4de67217682e338fa31eaf6e02839
#TRUST-RSA-SHA256 3b43a320ca7a01594210eeb63a7547c76813d1e0b443f90c70730faa7f64ab32a5089db193947df6fe442e51144af269c0b866c082b3c738dad62e3089170a7ed5a1f82538472ace8123649aff2a6901ea6ae321f8b563d872bd1f0edfbb47606f42194f410abfb38b96536317120f192afc9136f824b22316f0fd24fdf1279ff3546d87f96b5bcb0be07c2b040d1c7bf04bb35d7d44e2ef3202389c19b14df195d61e7800e8111fd5764aa8a57d11e09d44d181a45e626c4e5a1dfbd1b18e657aed88c969292846020e9ce88eb3bdb58b75273a8c22dcab418beaa1f5c7292a0bea613f8dfdac02180d6b32ca1449db407b1b94620f6a764a079c21866392470dd813c4c96d95cabb6447cb4220ffdc88618ae30d4f6055df9ee5e51e2b577f470988ece59f3f91e7cf2b85317bb4c9e874e3fdbd09b5d8fd1ea29e5017f3a7f23c796587756a43973984556446acca697a2fa2c88e65272a4da4980b023980b712affe51b9bf9ea0696b7b0a6e2fb6035ec39122f93c9bf8a218d2addadeea9dbf0bac99879df395e348c37d4a92596911c988bdc758b550928169778700b2b5ce0d989812d60546befa833ae2a621d3ebdecb3b1b46f8af8e6dfa150b25a02942ffb7e94df601cfdf7fa9862b98fb1bf3f67120d49e5c3b636acb4011b79797c01298b9dce93ecda98e4d03e4aaa60211fca041a346e40f0145b8d1975868
#
# This script is Copyright (C) 2004-2024 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
#
# $Revision: 1.15 $
# $Date: 2024/06/17 $
#
# Description : This audit file implements the Level 2 checks from the CIS Apple iOS 9 Benchmark v. 1.0.0.
#
#               https://workbench.cisecurity.org/files/1678
#
# NOTE        : Some queries in this .audit require site-specific data to be known to the query in order to function properly.
#               Please note the following queries and edit their values accordingly.
#
#<ui_metadata>
#<display_name>MobileIron - CIS Apple iOS 9 v1.0.0 L2</display_name>
#<spec>
#  <type>CIS</type>
#  <name>Apple iOS 9</name>
#  <profile>L2 MobileIron</profile>
#  <version>1.0.0</version>
#  <link>https://workbench.cisecurity.org/files/1678</link>
#</spec>
#<labels>mdm,mobileiron,cis,ios,update_20230227</labels>
#<benchmark_refs>CCE,CIS_Recommendation,CSCv6,CSCv7,CSCv8,LEVEL</benchmark_refs>
#</ui_metadata>

<check_type:"MDM" mdm_type:MOBILEIRON>

<report type:"PASSED">
  description : "MobileIron - CIS Apple iOS 9 v1.0.0 L2"
  reference   : "800-171|3.1.18,800-53|AC-19,800-53r5|AC-19,CSF|PR.AC-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2"
  see_also    : "https://workbench.cisecurity.org/files/1678"
</report>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "1.1.3 - MobileIron - Disallow Simple Passcode"
  info           : "This control determines whether passcodes other than 4-digit numbers are permitted for the passcode protecting access to the device via the touch screen. It is recommended that the device be configured to permit the use of passcodes longer than 4 characters and containing alphanumeric characters."
  solution       : "From the MobileIron console, open the Policies and Configs -> Policies view. Under the Security Policy verify that Password Type is set to Alphanumeric."
  reference      : "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(a),CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),LEVEL|2NS,NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4"
  see_also       : "https://workbench.cisecurity.org/files/1678"
  json_transform : '.[]|select(.active=="true")|select(.profileType=="SECURITY")|
                "Policy: " + .policyName + " - Passcode Type = \(.policyRules.SECURITY_PWD_TYPE // "Not Defined")"'
  regex          : "Passcode Type ="
  expect         : "Passcode Type = Alphanumeric"
  match_all      : YES
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "1.1.5 - MobileIron - Enable Erase Data"
  info           : "This configuration item determines whether the device will automatically wipe its contents after excessive (10) failed passcode attempts. It is recommended that this feature be enabled."
  solution       : "On the iOS device,
1. Tap Settings.
2. Tap 'Passcode' or 'Touch ID & Passcode.'
3. Enter current passcode as prompted.
4. Tap Done.
5. Turn on Erase Data.
6. Tap Enable on confirmation dialog."
  reference      : "800-171|3.1.8,800-53|AC-7(2),800-53r5|AC-7(2),CN-L3|8.1.4.1(b),GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-7(2),LEVEL|2NS,NIAv2|OS10,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2"
  see_also       : "https://workbench.cisecurity.org/files/1678"
  json_transform : '.[]|select(.active=="true")|select(.profileType=="SECURITY")|
                "Policy: " + .policyName + " - Maximum Failed Passcode Attempts = \(.policyRules.SECURITY_PWD_MAX_FAILED_ATTEMPTS // "Not Defined")"'
  regex          : "Maximum Failed Passcode Attempts ="
  expect         : "Maximum Failed Passcode Attempts = ([6-9]|10)"
  match_all      : YES
</custom_item>

<custom_item>
  type           : CONFIGURATION_INFO
  description    : "1.1.6 - MobileIron - Disable Access to Control Center on Lock Screen"
  info           : "This control disables access to the Control Center on the Lock Screen."
  solution       : "From the MobileIron console, open the Policies and Configs -> iOS and OSX view. Under the Restrictions Policy verify that Show Control Center in lock screen is not checked."
  reference      : "800-171|3.1.18,800-53|AC-19,800-53r5|AC-19,CSCv6|9.1,CSF|PR.AC-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,LEVEL|2NS,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2"
  see_also       : "https://workbench.cisecurity.org/files/1678"
  json_transform : '.[]| select (.appType == "RESTRICTION")|
                "Configuration: " + .name + " - Allow Control Center On Lock Screen = \(.properties.ALLOW_LOCKSCREENCONTOLCENTER // "Not Defined")"'
  regex          : "Allow Control Center On Lock Screen ="
  expect         : "Allow Control Center On Lock Screen = False"
  match_all      : YES
</custom_item>

<if>
  <condition type:"AND">
    <custom_item>
      type           : CONFIGURATION_INFO
      description    : "iOS - WIFI Configurations Exist"
      json_transform : '"WIFI Configuration : \([.[]|select (.appType=="WIFI")] | length | . > 0 )"'
      regex          : "WIFI Configuration :"
      expect         : "WIFI Configuration : True"
    </custom_item>
  </condition>

  <then>
    <custom_item>
      type           : CONFIGURATION_INFO
      description    : "1.1.7 - MobileIron - Forget Wi-Fi networks to prevent automatic rejoin"
      info           : "This configuration causes an iOS device to forget Wi-Fi networks with which it has previously associated. It is recommended that networks be forgotten after each use in use cases where security is paramount.

      NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution       : "From the MobileIron console, open the Policies and Configs -> Configuration view. Under the WiFi Policy verify that all configured SSIDs are authorized."
      reference      : "800-171|3.1.18,800-53|AC-19,800-53r5|AC-19,CSF|PR.AC-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,LEVEL|2NS,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2"
      see_also       : "https://workbench.cisecurity.org/files/1678"
      json_transform : '.[] | select (.appType =="WIFI") |
                  "SSID: \(.name // "None")"'
      regex          : "SSID:"
      expect         : "SSID: None"
      match_all      : YES
      severity       : MEDIUM
    </custom_item>
  </then>

  <else>
    <report type:"PASSED">
      description : "1.1.7 - MobileIron - Forget Wi-Fi networks to prevent automatic rejoin"
      info        : "This configuration causes an iOS device to forget Wi-Fi networks with which it has previously associated. It is recommended that networks be forgotten after each use in use cases where security is paramount.

No WIFI Configuration policies were found."
      solution    : "From the MobileIron console, open the Policies and Configs -> Configuration view. Under the WiFi Policy verify that all configured SSIDs are authorized."
      reference   : "800-171|3.1.18,800-53|AC-19,800-53r5|AC-19,CSF|PR.AC-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,LEVEL|2NS,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2"
      see_also    : "https://workbench.cisecurity.org/files/1678"
    </report>
  </else>
</if>

<if>
  <condition type:"AND">
    <custom_item>
      type           : CONFIGURATION_INFO
      description    : "iOS - WIFI Configurations Exist"
      json_transform : '"WIFI Configuration : \([.[]|select (.appType=="WIFI")] | length | . > 0 )"'
      regex          : "WIFI Configuration :"
      expect         : "WIFI Configuration : True"
    </custom_item>
  </condition>

  <then>
    <report type:"WARNING">
      description : "1.1.8 - MobileIron - Turn off Ask to Join Networks"
      info        : "This option configures the device to look for another network and display a list of all available Wi-Fi networks that the user can choose from when the device is trying to access the Internet and is not in range of a Wi-Fi network it has previously used. It is recommended that 'Ask to Join Networks' be turned off.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "On the iOS device,
1. Tap Settings.
2. Tap Wi-Fi.
3. Turn off Ask to Join Networks (see note below).
Note: Wi-Fi must be turned on for the above Wi -Fi configuration option to appear."
      reference   : "800-171|3.1.18,800-53|AC-19,800-53r5|AC-19,CSF|PR.AC-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,LEVEL|2NS,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2"
      see_also    : "https://workbench.cisecurity.org/files/1678"
    </report>
  </then>

  <else>
    <report type:"PASSED">
      description : "1.1.8 - MobileIron - Turn off Ask to Join Networks"
      info        : "This option configures the device to look for another network and display a list of all available Wi-Fi networks that the user can choose from when the device is trying to access the Internet and is not in range of a Wi-Fi network it has previously used. It is recommended that 'Ask to Join Networks' be turned off.

No WIFI Configuration policies were found."
      solution    : "On the iOS device,
1. Tap Settings.
2. Tap Wi-Fi.
3. Turn off Ask to Join Networks (see note below).
Note: Wi-Fi must be turned on for the above Wi -Fi configuration option to appear."
      reference   : "800-171|3.1.18,800-53|AC-19,800-53r5|AC-19,CSF|PR.AC-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,LEVEL|2NS,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2"
      see_also    : "https://workbench.cisecurity.org/files/1678"
    </report>
  </else>
</if>

<if>
  <condition type:"AND">
    <custom_item>
      type           : CONFIGURATION_INFO
      description    : "iOS - WIFI Configurations Exist"
      json_transform : '"WIFI Configuration : \([.[]|select (.appType=="WIFI")] | length | . > 0 )"'
      regex          : "WIFI Configuration :"
      expect         : "WIFI Configuration : True"
    </custom_item>
  </condition>

  <then>
    <custom_item>
      type           : CONFIGURATION_INFO
      description    : "1.1.9 - MobileIron - Turn off Auto-Join for all Wi-Fi networks"
      info           : "Enabling Wi-Fi Auto-Join for a Wi-Fi network configures the device to remember the network and login information and automatically reconnect to that Wi-Fi network whenever the device is in range. It is recommended that Wi-Fi Auto-Join be turned off for all network connections where security is paramount."
      solution       : "From the MobileIron console, open the Policies and Configs -> Configuration view. Under the WiFi Policy verify that Auto Join is not checked for any configured SSIDs."
      reference      : "800-171|3.1.18,800-53|AC-19,800-53r5|AC-19,CSCv6|9.1,CSF|PR.AC-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,LEVEL|2NS,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2"
      see_also       : "https://workbench.cisecurity.org/files/1678"
      json_transform : '.[] | select (.appType =="WIFI") |
                  "SSID: " + .name + " AutoJoin = " + .properties.AUTOJOIN'
      regex          : "AutoJoin ="
      expect         : "AutoJoin = False"
      match_all      : YES
    </custom_item>
  </then>

  <else>
    <report type:"PASSED">
      description : "1.1.9 - MobileIron - Turn off Auto-Join for all Wi-Fi networks"
      info        : "Enabling Wi-Fi Auto-Join for a Wi-Fi network configures the device to remember the network and login information and automatically reconnect to that Wi-Fi network whenever the device is in range. It is recommended that Wi-Fi Auto-Join be turned off for all network connections where security is paramount.

No WIFI Configuration policies were found."
      solution    : "From the MobileIron console, open the Policies and Configs -> Configuration view. Under the WiFi Policy verify that Auto Join is not checked for any configured SSIDs."
      reference   : "800-171|3.1.18,800-53|AC-19,800-53r5|AC-19,CSCv6|9.1,CSF|PR.AC-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,LEVEL|2NS,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2"
      see_also    : "https://workbench.cisecurity.org/files/1678"
    </report>
  </else>
</if>

<custom_item>
  type           : CONFIGURATION_INFO
  description    : "1.1.10 - MobileIron - Turn Off AirDrop Discoverability"
  info           : "This setting keeps your device from being discoverable to everyone, including contacts.
This setting only applies to the following devices:
- iPhone 5 or later
- iPad (4th generation)
- iPad mini
- iPad Air
- iPod Touch (5th generation)"
  solution       : "From the MobileIron console, open the Policies and Configs -> iOS and OSX view. Under the Restrictions Policy verify that Allow AirDrop is not checked."
  reference      : "800-171|3.1.18,800-53|AC-19,800-53r5|AC-19,CSCv6|9.1,CSF|PR.AC-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,LEVEL|2NS,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2"
  see_also       : "https://workbench.cisecurity.org/files/1678"
  json_transform : '.[]| select (.appType == "RESTRICTION")|
                "Configuration: " + .name + " - Allow AirDrop = \(.properties.LOCKDOWN_AIRDROP // "Not Defined")"'
  regex          : "Allow AirDrop ="
  expect         : "Allow AirDrop = False"
  match_all      : YES
</custom_item>

<report type:"WARNING">
  description : "1.1.11 - MobileIron - Turn off Wi-Fi when not needed"
  info        : "This configuration item determines whether the iOS device uses local Wi-Fi networks to connect to the Internet and other networks. It is recommended that Wi-Fi be disabled when not needed or when security is paramount.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "On the iOS device,
1. Tap Settings.
2. Tap Wi-Fi.
3. Turn off Wi-Fi."
  reference   : "800-171|3.1.18,800-53|AC-19,800-53r5|AC-19,CSF|PR.AC-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,LEVEL|2NS,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2"
  see_also    : "https://workbench.cisecurity.org/files/1678"
</report>

<report type:"WARNING">
  description : "1.1.14 - MobileIron - Turn off Personal Hotspot when not needed"
  info        : "Personal Hotspot allows certain iOS 7 devices with cellular data connections to be configured to share an active Cellular Data connection via Wi-Fi, Bluetooth, or USB (see Note). It is recommended that Personal Hotspot be disabled when not needed or where security is paramount.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "On the iOS device,
1. Tap Settings.
2. Tap Cellular or Cellular Data, as applicable.
3. Tap Personal Hotspot.
4. Turn off Personal Hotspot."
  reference   : "800-171|3.1.18,800-53|AC-19,800-53r5|AC-19,CSF|PR.AC-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,LEVEL|2NS,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2"
  see_also    : "https://workbench.cisecurity.org/files/1678"
</report>

<report type:"WARNING">
  description : "1.1.15 - MobileIron - Turn off Location Services"
  info        : "Location Services allows applications such as Maps, Internet, and Camera to gather and use data indicating the user's location. It is recommended that Location Services be disabled in environments where security is paramount.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "On the iOS device,
1. Tap Settings.
2. Tap Privacy.
3. Tap Location Services.
4. Turn off Location Services.
5. Tap Turn off on confirmation dialog.
Note: Location services can also be disabled/enabled on a per-app basis within the Location Services configuration menu referenced above."
  reference   : "800-171|3.1.18,800-53|AC-19,800-53r5|AC-19,CSF|PR.AC-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,LEVEL|2NS,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2"
  see_also    : "https://workbench.cisecurity.org/files/1678"
</report>

<custom_item>
  type           : CONFIGURATION_INFO
  description    : "1.1.16 - MobileIron - Disable View in Lock Screen for apps when device is locked"
  info           : "This setting prevents notifications from any source from being displayed when the iOS device is passcode locked. It is recommended that View in Lock Screen be disabled for all apps for which message confidentiality is desired and in environments where security is paramount."
  solution       : "From the MobileIron console, open the Policies and Configs -> iOS and OSX view. Under the Restrictions Policy verify that Show Notification Center in lock screen is not checked."
  reference      : "800-171|3.1.18,800-53|AC-19,800-53r5|AC-19,CSCv6|9.1,CSF|PR.AC-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,LEVEL|2NS,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2"
  see_also       : "https://workbench.cisecurity.org/files/1678"
  json_transform : '.[]| select (.appType == "RESTRICTION")|
                "Configuration: " + .name + " - Allow Notification Center On Lock Screen = \(.properties.ALLOW_LOCKSCREENNOTIFICATIONVIEW // "Not Defined")"'
  regex          : "Allow Notification Center On Lock Screen ="
  expect         : "Allow Notification Center On Lock Screen = False"
  match_all      : YES
</custom_item>

<report type:"WARNING">
  description : "1.1.18 - MobileIron - Enable Find My iPhone/iPad"
  info        : "This control enables the remote tracking, remote wiping, remote custom message display, and Activation Lock features of the iOS device.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "On the iOS device,
1. Tap Settings.
2. Tap iCloud.
3. Turn on Find My iPhone or Find my iPad, as applicable.
4. Tap OK on confirmation dialog."
  reference   : "800-171|3.1.18,800-53|AC-19,800-53r5|AC-19,CSF|PR.AC-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,LEVEL|2NS,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2"
  see_also    : "https://workbench.cisecurity.org/files/1678"
</report>

<report type:"WARNING">
  description : "1.1.20 - MobileIron - Enable SIM Password"
  info        : "This control protects from the user from having a SIM card stolen and used on another device without their knowledge.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "On the iOS device,
1. Tap Settings.
2. Tap Phone.
3. Tap SIM PIN.
4. Turn on SIM PIN.
5. Enter in PIN."
  reference   : "800-171|3.1.18,800-53|AC-19,800-53r5|AC-19,CSF|PR.AC-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,LEVEL|2NS,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2"
  see_also    : "https://workbench.cisecurity.org/files/1678"
</report>

<if>
  <condition type:"AND">
    <custom_item>
      type           : CONFIGURATION_INFO
      description    : "iOS - Enable Safari"
      json_transform : '.[]| select (.appType == "RESTRICTION")|
                "Configuration: " + .name + " - Allow Safari = \(.properties.LOCKDOWN_SAFARI // "Not Defined")"'
      regex          : "Allow Safari ="
      expect         : "Allow Safari = True"
    </custom_item>
  </condition>

  <then>
    <custom_item>
      type           : CONFIGURATION_INFO
      description    : "1.2.1 - MobileIron - Disable JavaScript"
      info           : "This control disables JavaScript functionality which lets web programmers control elements of the page-for example, a page that uses JavaScript might display the current date and time or cause a linked page to appear in a new pop-up page. It is recommended that JavaScript be disabled in environments where security is paramount."
      solution       : "From the MobileIron console, open the Policies and Configs -> iOS and OSX view. Under the Restrictions Policy verify that Enable Javascript is not checked.
NOTE: This item will only be configurable if Allow use of Safari is enabled."
      reference      : "800-171|3.1.18,800-171|3.4.6,800-171|3.4.7,800-53|AC-19,800-53|CM-7b.,800-53r5|AC-19,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|CM-7a.,LEVEL|2NS,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/1678"
      json_transform : '.[]| select (.appType == "RESTRICTION")| select (.properties.LOCKDOWN_SAFARI == "true")|
                "Configuration: " + .name + " - Allow Safari Javascript = \(.properties.LOCKDOWN_SAFARIALLOWJAVASCRIPT // "Not Defined")"'
      regex          : "Allow Safari Javascript ="
      expect         : "Allow Safari Javascript = False"
      match_all      : YES
    </custom_item>
  </then>

  <else>
    <report type:"PASSED">
      description : "1.2.1 - MobileIron - Disable JavaScript"
      info        : "This control disables JavaScript functionality which lets web programmers control elements of the page-for example, a page that uses JavaScript might display the current date and time or cause a linked page to appear in a new pop-up page. It is recommended that JavaScript be disabled in environments where security is paramount.

Note: No Configurations were found that enabled Safari."
      solution    : "From the MobileIron console, open the Policies and Configs -> iOS and OSX view. Under the Restrictions Policy verify that Enable Javascript is not checked.
NOTE: This item will only be configurable if Allow use of Safari is enabled."
      reference   : "800-171|3.1.18,800-171|3.4.6,800-171|3.4.7,800-53|AC-19,800-53|CM-7b.,800-53r5|AC-19,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|CM-7a.,LEVEL|2NS,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/1678"
    </report>
  </else>
</if>

<if>
  <condition type:"AND">
    <custom_item>
      type           : CONFIGURATION_INFO
      description    : "iOS - Enable Safari"
      json_transform : '.[]| select (.appType == "RESTRICTION")|
                "Configuration: " + .name + " - Allow Safari = \(.properties.LOCKDOWN_SAFARI // "Not Defined")"'
      regex          : "Allow Safari ="
      expect         : "Allow Safari = True"
    </custom_item>
  </condition>

  <then>
    <custom_item>
      type           : CONFIGURATION_INFO
      description    : "1.2.3 - MobileIron - Disable Auto Fill for Contact Information"
      info           : "Auto Fill configures the browser to remember information entered into common forms in order to automate the completion of later forms."
      solution       : "From the MobileIron console, open the Policies and Configs -> iOS and OSX view. Under the Restrictions Policy verify that Enable autofill is not checked.
NOTE: This item will only be configurable if Allow use of Safari is enabled."
      reference      : "800-171|3.1.18,800-171|3.4.6,800-171|3.4.7,800-53|AC-19,800-53|CM-7b.,800-53r5|AC-19,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|CM-7a.,LEVEL|2NS,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/1678"
      json_transform : '.[]| select (.appType == "RESTRICTION")| select (.properties.LOCKDOWN_SAFARI == "true")|
                "Configuration: " + .name + " - Allow Safari Autofill = \(.properties.LOCKDOWN_SAFARIALLOWAUTOFILL // "Not Defined")"'
      regex          : "Allow Safari Autofill ="
      expect         : "Allow Safari Autofill = False"
      match_all      : YES
    </custom_item>
  </then>

  <else>
    <report type:"PASSED">
      description : "1.2.3 - MobileIron - Disable Auto Fill for Contact Information"
      info        : "Auto Fill configures the browser to remember information entered into common forms in order to automate the completion of later forms.

Note: No Configurations were found that enabled Safari."
      solution    : "From the MobileIron console, open the Policies and Configs -> iOS and OSX view. Under the Restrictions Policy verify that Enable autofill is not checked.
NOTE: This item will only be configurable if Allow use of Safari is enabled."
      reference   : "800-171|3.1.18,800-171|3.4.6,800-171|3.4.7,800-53|AC-19,800-53|CM-7b.,800-53r5|AC-19,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|CM-7a.,LEVEL|2NS,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/1678"
    </report>
  </else>
</if>

<if>
  <condition type:"AND">
    <custom_item>
      type           : CONFIGURATION_INFO
      description    : "iOS - Enable Safari"
      json_transform : '.[]| select (.appType == "RESTRICTION")|
                "Configuration: " + .name + " - Allow Safari = \(.properties.LOCKDOWN_SAFARI // "Not Defined")"'
      regex          : "Allow Safari ="
      expect         : "Allow Safari = True"
    </custom_item>
  </condition>

  <then>
    <custom_item>
      type           : CONFIGURATION_INFO
      description    : "1.2.4 - MobileIron - Disable Auto Fill for Names and Passwords"
      info           : "Auto Fill configures the browser to remember information entered into common forms in order to automate the completion of later forms."
      solution       : "From the MobileIron console, open the Policies and Configs -> iOS and OSX view. Under the Restrictions Policy verify that Enable autofill is not checked.
NOTE: This item will only be configurable if Allow use of Safari is enabled."
      reference      : "800-171|3.1.18,800-171|3.4.6,800-171|3.4.7,800-53|AC-19,800-53|CM-7b.,800-53r5|AC-19,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|CM-7a.,LEVEL|2NS,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/1678"
      json_transform : '.[]| select (.appType == "RESTRICTION")| select (.properties.LOCKDOWN_SAFARI == "true")|
                "Configuration: " + .name + " - Allow Safari Autofill = \(.properties.LOCKDOWN_SAFARIALLOWAUTOFILL // "Not Defined")"'
      regex          : "Allow Safari Autofill ="
      expect         : "Allow Safari Autofill = False"
      match_all      : YES
    </custom_item>
  </then>

  <else>
    <report type:"PASSED">
      description : "1.2.4 - MobileIron - Disable Auto Fill for Names and Passwords"
      info        : "Auto Fill configures the browser to remember information entered into common forms in order to automate the completion of later forms.

Note: No Configurations were found that enabled Safari."
      solution    : "From the MobileIron console, open the Policies and Configs -> iOS and OSX view. Under the Restrictions Policy verify that Enable autofill is not checked.
NOTE: This item will only be configurable if Allow use of Safari is enabled."
      reference   : "800-171|3.1.18,800-171|3.4.6,800-171|3.4.7,800-53|AC-19,800-53|CM-7b.,800-53r5|AC-19,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|CM-7a.,LEVEL|2NS,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/1678"
    </report>
  </else>
</if>

<if>
  <condition type:"AND">
    <custom_item>
      type           : CONFIGURATION_INFO
      description    : "iOS - Enable Safari"
      json_transform : '.[]| select (.appType == "RESTRICTION")|
                "Configuration: " + .name + " - Allow Safari = \(.properties.LOCKDOWN_SAFARI // "Not Defined")"'
      regex          : "Allow Safari ="
      expect         : "Allow Safari = True"
    </custom_item>
  </condition>

  <then>
    <custom_item>
      type           : CONFIGURATION_INFO
      description    : "1.2.5 - MobileIron - Disable Auto Fill for Credit Card Information"
      info           : "Auto Fill configures the browser to remember information entered into common forms in order to automate the completion of later forms."
      solution       : "From the MobileIron console, open the Policies and Configs -> iOS and OSX view. Under the Restrictions Policy verify that Enable autofill is not checked.
NOTE: This item will only be configurable if Allow use of Safari is enabled."
      reference      : "800-171|3.1.18,800-171|3.4.6,800-171|3.4.7,800-53|AC-19,800-53|CM-7b.,800-53r5|AC-19,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|CM-7a.,LEVEL|2NS,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/1678"
      json_transform : '.[]| select (.appType == "RESTRICTION")| select (.properties.LOCKDOWN_SAFARI == "true")|
                "Configuration: " + .name + " - Allow Safari Autofill = \(.properties.LOCKDOWN_SAFARIALLOWAUTOFILL // "Not Defined")"'
      regex          : "Allow Safari Autofill ="
      expect         : "Allow Safari Autofill = False"
      match_all      : YES
    </custom_item>
  </then>

  <else>
    <report type:"PASSED">
      description : "1.2.5 - MobileIron - Disable Auto Fill for Credit Card Information"
      info        : "Auto Fill configures the browser to remember information entered into common forms in order to automate the completion of later forms.

Note: No Configurations were found that enabled Safari."
      solution    : "From the MobileIron console, open the Policies and Configs -> iOS and OSX view. Under the Restrictions Policy verify that Enable autofill is not checked.
NOTE: This item will only be configurable if Allow use of Safari is enabled."
      reference   : "800-171|3.1.18,800-171|3.4.6,800-171|3.4.7,800-53|AC-19,800-53|CM-7b.,800-53r5|AC-19,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|CM-7a.,LEVEL|2NS,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/1678"
    </report>
  </else>
</if>

<report type:"WARNING">
  description : "1.2.6 - MobileIron - Delete Saved Password Information"
  info        : "The Safari configuration provides a repository to store information, including website username and password details, that can be to support Safari Auto Fill capability. Saved password information is stored in the device keychain and/or iCloud keychain. The Safari configuration interface requires the input of the device passcode prior to granting access to stored website password details; website and user name details can be viewed without the additional passcode prompt.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  info        : "Note: No Configurations were found that enabled Safari."
  solution    : "From the MobileIron console, open the Policies and Configs -> iOS and OSX view. Under the Restrictions Policy verify that Enable autofill is not checked.
NOTE: This item will only be configurable if Allow use of Safari is enabled."
  reference   : "800-171|3.1.18,800-53|AC-19,800-53r5|AC-19,CSF|PR.AC-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,LEVEL|2NS,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2"
  see_also    : "https://workbench.cisecurity.org/files/1678"
</report>

<report type:"WARNING">
  description : "1.2.7 - MobileIron - Delete Saved Credit Card Information"
  info        : "The Safari configuration provides a repository to store information, including Credit Card details, that can be to support Safari Auto Fill capability. Saved credit card information is stored in the device keychain and/or iCloud keychain. The Safari configuration interface requires the input of the device passcode prior to granting access to stored Credit Card details.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "From the MobileIron console, open the Policies and Configs -> iOS and OSX view. Under the Restrictions Policy verify that Enable autofill is not checked.
NOTE: This item will only be configurable if Allow use of Safari is enabled."
  reference   : "800-171|3.1.18,800-53|AC-19,800-53r5|AC-19,CSF|PR.AC-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,LEVEL|2NS,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2"
  see_also    : "https://workbench.cisecurity.org/files/1678"
</report>

<if>
  <condition type:"AND">
    <custom_item>
      type           : CONFIGURATION_INFO
      description    : "iOS - Enable Safari"
      json_transform : '.[]| select (.appType == "RESTRICTION")|
                "Configuration: " + .name + " - Allow Safari = \(.properties.LOCKDOWN_SAFARI // "Not Defined")"'
      regex          : "Allow Safari ="
      expect         : "Allow Safari = True"
    </custom_item>
  </condition>

  <then>
    <report type:"WARNING">
      description : "1.2.8 - MobileIron - Turn On Private Browsing When Needed"
      info        : "Enabling Private Browsing for a browser session prevents tracking of history of web pages visited, searches performed, and (if configured) certain AutoFill information.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "On the iOS device,
1. Tap the Safari app to launch it.
2. Tap the Safari tab button at the lower right of the screen.
3. Tap Private.
4. Select 'Close All' or 'Keep All' on the 'Close All Pages?' dialog box."
      reference   : "800-171|3.1.18,800-53|AC-19,800-53r5|AC-19,CSF|PR.AC-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,LEVEL|2NS,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2"
      see_also    : "https://workbench.cisecurity.org/files/1678"
    </report>
  </then>

  <else>
    <report type:"PASSED">
      description : "1.2.8 - MobileIron - Turn On Private Browsing When Needed"
      info        : "Enabling Private Browsing for a browser session prevents tracking of history of web pages visited, searches performed, and (if configured) certain AutoFill information.

Note: No Configurations were found that enabled Safari."
      solution    : "On the iOS device,
1. Tap the Safari app to launch it.
2. Tap the Safari tab button at the lower right of the screen.
3. Tap Private.
4. Select 'Close All' or 'Keep All' on the 'Close All Pages?' dialog box."
      reference   : "800-171|3.1.18,800-53|AC-19,800-53r5|AC-19,CSF|PR.AC-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,LEVEL|2NS,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2"
      see_also    : "https://workbench.cisecurity.org/files/1678"
    </report>
  </else>
</if>

<custom_item>
  type           : CONFIGURATION_INFO
  description    : "1.2.9 - MobileIron - Turn On Do Not Track"
  info           : "This setting instructs Safari to communicate the preference not to be tracked to websites to which it connects."
  solution       : "From the MobileIron console, open the Policies and Configs -> iOS and OSX view. Under the Restrictions Policy verify that Force limited ad tracking is checked."
  reference      : "800-171|3.1.18,800-53|AC-19,800-53r5|AC-19,CSCv6|9.1,CSF|PR.AC-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,LEVEL|2NS,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2"
  see_also       : "https://workbench.cisecurity.org/files/1678"
  json_transform : '.[]| select (.appType == "RESTRICTION")|
                "Configuration: " + .name + " - Limit Ad Tracking = \(.properties.ALLOW_ADTRACKING // "Not Defined")"'
  regex          : "Limit Ad Tracking ="
  expect         : "Limit Ad Tracking = True"
  match_all      : YES
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "2.2.3 - MobileIron - Require alphanumeric value"
  info           : "This control determines whether alphanumeric characters (alphabetic and non-alphanumeric values in addition to numerals) are required for the passcode that protects access to the device via the touch screen."
  solution       : "From the MobileIron console, open the Policies and Configs -> Policies view. Under the Security Policy verify that Password Type is set to Alphanumeric."
  reference      : "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(a),CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),LEVEL|2S,NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4"
  see_also       : "https://workbench.cisecurity.org/files/1678"
  json_transform : '.[]|select(.active=="true")|select(.profileType=="SECURITY")|
                "Policy: " + .policyName + " - Passcode Type = \(.policyRules.SECURITY_PWD_TYPE // "Not Defined")"'
  regex          : "Passcode Type ="
  expect         : "Passcode Type = Alphanumeric"
  match_all      : YES
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "2.2.5 - MobileIron - Set Minimum number of complex characters"
  info           : "This configuration item specifies the minimum number of non-alphanumeric characters (such as $, &, and !) that the passcode must contain. It is recommended that at least one non-alphanumeric character be required in the passcode."
  solution       : "From the MobileIron console, open the Policies and Configs -> Policies view. Under the Security Policy verify that Minimum Number of Complex Characters is set to 1 or more."
  reference      : "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(a),CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),LEVEL|2S,NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4"
  see_also       : "https://workbench.cisecurity.org/files/1678"
  json_transform : '.[]|select(.active=="true")|select(.profileType=="SECURITY")|
                "Policy: " + .policyName + " - Minimum Complex Characters = \(.policyRules.SECURITY_PWD_MIN_COMPLEX_CHAR // "Not Defined")"'
  regex          : "Minimum Complex Characters ="
  expect         : "Minimum Complex Characters = [1-9]"
  match_all      : YES
</custom_item>

<if>
  <condition type:"AND">
    <custom_item>
      type           : CONFIGURATION_INFO
      description    : "iOS - EXCHANGE Configurations Exist"
      json_transform : '"EXCHANGE Configuration : \([.[]|select (.appType=="EXCHANGE")] | length | . > 0 )"'
      regex          : "EXCHANGE Configuration :"
      expect         : "EXCHANGE Configuration : True"
    </custom_item>
  </condition>

  <then>
    <custom_item>
      type           : CONFIGURATION_INFO
      description    : "2.3.1 - MobileIron - Enable Prevent Move for Sensitive Mail Accounts - EXCHANGE Configurations"
      info           : "This control determines whether a message can be moved from one mail account configured on the device to another account."
      solution       : "From the MobileIron console, open the Policies and Configs -> Configuration view. Under the Exchange Policy verify that Move/Forward Messages to Other Email Accounts is checked."
      reference      : "800-171|3.1.18,800-53|AC-19,800-53r5|AC-19,CSCv6|3.1,CSF|PR.AC-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,LEVEL|2S,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2"
      see_also       : "https://workbench.cisecurity.org/files/1678"
      json_transform : '.[]|select (.appType=="EXCHANGE") |
                    "Configuration: " + .name + " - Block Move Messages = " + .properties.BLOCK_MESSAGEMOVEFORWARD'
      regex          : "Block Move Messages ="
      expect         : "Block Move Messages = True"
      match_all      : YES
    </custom_item>

    <custom_item>
      type           : CONFIGURATION_INFO
      description    : "2.3.2 - MobileIron - Require Use Only in Mail for Sensitive Mail Accounts - EXCHANGE Configurations"
      info           : "This control determines whether a mail account can be used for sending messages from iOS apps other than the Mail app."
      solution       : "From the MobileIron console, open the Policies and Configs -> Configuration view. Under the Exchange Policy verify that Email access to Third-Party apps is checked."
      reference      : "800-171|3.1.18,800-53|AC-19,800-53r5|AC-19,CSCv6|3.1,CSF|PR.AC-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,LEVEL|2S,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2"
      see_also       : "https://workbench.cisecurity.org/files/1678"
      json_transform : '.[]|select (.appType=="EXCHANGE") |
                    "Configuration: " + .name + " - Block Third Party Apps = " + .properties.BLOCK_THIRDPARTYAPPS'
      regex          : "Block Third Party Apps ="
      expect         : "Block Third Party Apps = True"
      match_all      : YES
    </custom_item>
  </then>
</if>

<if>
  <condition type:"AND">
    <custom_item>
      type           : CONFIGURATION_INFO
      description    : "iOS - EMAIL Configurations Exist"
      json_transform : '"EMAIL Configuration : \([.[]|select (.appType=="EMAIL")] | length | . > 0 )"'
      regex          : "EMAIL Configuration :"
      expect         : "EMAIL Configuration : True"
    </custom_item>
  </condition>

  <then>
    <custom_item>
      type           : CONFIGURATION_INFO
      description    : "2.3.1 - MobileIron - Enable Prevent Move for Sensitive Mail Accounts - EMAIL Configurations"
      info           : "This control determines whether a message can be moved from one mail account configured on the device to another account."
      solution       : "From the MobileIron console, open the Policies and Configs -> Configuration view. Under the Email Policy verify that Block move/forward messages to other mail accounts is checked."
      reference      : "800-171|3.1.18,800-53|AC-19,800-53r5|AC-19,CSCv6|3.1,CSF|PR.AC-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,LEVEL|2S,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2"
      see_also       : "https://workbench.cisecurity.org/files/1678"
      json_transform : '.[]|select (.appType=="EMAIL") |
                    "Configuration: " + .name + " - Block Move Messages = " + .properties.BLOCK_MESSAGEMOVEFORWARD'
      regex          : "Block Move Messages ="
      expect         : "Block Move Messages = True"
      match_all      : YES
    </custom_item>

    <custom_item>
      type           : CONFIGURATION_INFO
      description    : "2.3.2 - MobileIron - Require Use Only in Mail for Sensitive Mail Accounts - EMAIL Configurations"
      info           : "This control determines whether a mail account can be used for sending messages from iOS apps other than the Mail app."
      solution       : "From the MobileIron console, open the Policies and Configs -> Configuration view. Under the Email Policy verify that Block mail access to 3rd party apps is checked."
      reference      : "800-171|3.1.18,800-53|AC-19,800-53r5|AC-19,CSCv6|3.1,CSF|PR.AC-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,LEVEL|2S,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2"
      see_also       : "https://workbench.cisecurity.org/files/1678"
      json_transform : '.[]|select (.appType=="EMAIL") |
                    "Configuration: " + .name + " - Block Third Party Apps = " + .properties.BLOCK_THIRDPARTYAPPS'
      regex          : "Block Third Party Apps ="
      expect         : "Block Third Party Apps = True"
      match_all      : YES
    </custom_item>
  </then>
</if>

<if>
  <condition type:"AND">
    <custom_item>
      type           : CONFIGURATION_INFO
      description    : "iOS - EXCHANGE Configurations Exist"
      json_transform : '"EXCHANGE Configuration : \([.[]|select (.appType=="EXCHANGE")] | length | . > 0 )"'
      regex          : "EXCHANGE Configuration :"
      expect         : "EXCHANGE Configuration : False"
    </custom_item>

    <custom_item>
      type           : CONFIGURATION_INFO
      description    : "iOS - EMAIL Configurations Exist"
      json_transform : '"EMAIL Configuration : \([.[]|select (.appType=="EMAIL")] | length | . > 0 )"'
      regex          : "EMAIL Configuration :"
      expect         : "EMAIL Configuration : False"
    </custom_item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "2.3.1 - MobileIron - Enable Prevent Move for Sensitive Mail Accounts"
      info        : "This control determines whether a message can be moved from one mail account configured on the device to another account.

NOTE: No Exchange or Email configuration policies were found."
      solution    : "For Exchange Active Sync Configurations:
From the MobileIron console, open the Policies and Configs -> Exchange view. Verify that Move/Forward Messages to Other Email Accounts is checked.

For Email Configurations:
From the MobileIron console, open the Policies and Configs -> Email view. Verify that Block move/forward messages to other mail accounts is checked."
      reference   : "800-171|3.1.18,800-53|AC-19,800-53r5|AC-19,CSF|PR.AC-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,LEVEL|2S,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2"
      see_also    : "https://workbench.cisecurity.org/files/1678"
    </report>

    <report type:"PASSED">
      description : "2.3.2 - MobileIron - Require Use Only in Mail for Sensitive Mail Accounts"
      info        : "This control determines whether a mail account can be used for sending messages from iOS apps other than the Mail app.

NOTE: No Exchange or Email configuration policies were found."
      solution    : "For Exchange Active Sync Configurations:
From the MobileIron console, open the Policies and Configs -> Exchange view. Verify that Email access to Third-Party apps is checked.

For Email Configurations:
From the MobileIron console, open the Policies and Configs -> Email view. Verify that Block mail access to 3rd party apps is checked."
      reference   : "800-171|3.1.18,800-53|AC-19,800-53r5|AC-19,CSF|PR.AC-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,LEVEL|2S,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2"
      see_also    : "https://workbench.cisecurity.org/files/1678"
    </report>
  </then>
</if>

<report type:"WARNING">
  description : "2.3.3 - MobileIron - Mark Company Mail Domain"
  info        : "This control determines whether a message originated from a company email domain, and causes the message 'From' section to appear in blue if so, or red if not.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "This item is N/A for MobileIron"
  reference   : "800-171|3.1.18,800-53|AC-19,800-53r5|AC-19,CSF|PR.AC-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,LEVEL|2S,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2"
  see_also    : "https://workbench.cisecurity.org/files/1678"
</report>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "3.1.2 - MobileIron - Enable 'Require alphanumeric value'"
  info           : "This control determines if new passwords are required to satisfy a certain level of complexity. By default, iOS devices do not enforce a passcode complexity policy, and the default Exchange ActiveSync policy setting applied for users not assigned to a mailbox policy does not require an alphanumeric passcode. The recommended settings are enable alpha-numeric device password."
  solution       : "From the MobileIron console, open the Policies and Configs -> Policies view. Under the Security Policy verify that Password Type is set to Alphanumeric."
  reference      : "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(a),CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),LEVEL|2S,NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4"
  see_also       : "https://workbench.cisecurity.org/files/1678"
  json_transform : '.[]|select(.active=="true")|select(.profileType=="SECURITY")|
                "Policy: " + .policyName + " - Passcode Type = \(.policyRules.SECURITY_PWD_TYPE // "Not Defined")"'
  regex          : "Passcode Type ="
  expect         : "Passcode Type = Alphanumeric"
  match_all      : YES
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "3.1.4 - MobileIron - Set the 'minimum number of character sets'"
  info           : "This control determines if new passwords are required to satisfy a certain level of complexity. By default, iOS devices do not require such complex characters in the passcode, and the default minimum value Exchange ActiveSync policy applies for users not assigned to a mailbox policy is zero (0). The recommended setting is the minimum device password complexity is set to 1 or more characters.
Note: iOS devices implement the MinDeviceComplexCharacters configuration items as the number of special characters required in a passcode. This is an important distinction from some non-iOS EAS profile setting implementations in which this value specifies the number of character groups that are required to be present in the password (e.g., lower case alphabetical characters, upper case alphabetical characters, numerals, and non-alphanumeric characters; see MSDN Library topic on 2.2.2.36 MinDevicePasswordComplexCharacters at http://msdn.microsoft.com/en-us/library/ee201726%28v=exchg.80%29.aspx)."
  solution       : "From the MobileIron console, open the Policies and Configs -> Policies view. Under the Security Policy verify that Minimum Number of Complex Characters is set to 1 or more."
  reference      : "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(a),CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),LEVEL|2S,NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4"
  see_also       : "https://workbench.cisecurity.org/files/1678"
  json_transform : '.[]|select(.active=="true")|select(.profileType=="SECURITY")|
                "Policy: " + .policyName + " - Minimum Complex Characters = \(.policyRules.SECURITY_PWD_MIN_COMPLEX_CHAR // "Not Defined")"'
  regex          : "Minimum Complex Characters ="
  expect         : "Minimum Complex Characters = [1-9]"
  match_all      : YES
</custom_item>

</check_type>
