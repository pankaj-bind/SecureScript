#TRUSTED 445019fa05c5c128370a9b9a528776d93118c4b3037e66ecaa002ee1dc28224f612639c2927c5471828097364773d50f2718c71affb4fdce58ab8a13d5b1e25672e78a3d234046d7b3123950f814f35befbf5a496d53c1e4e4df0bc5a4b4d558e9d3bafd11911bdd2b68a07e2d06f3d19b9764845f95328e0da3f8954d8687849ed0c3339e6e782bcfc001d00808ffa2c27a06628b1faea03c0c33244cb2e9841c90909756e03e7c9296b683ae9b6c9d90cb2991db764c674072d28a69f1a440e1f1a530729934b5c32d59ed8042685e6876288814809defb6fa89233e825dc85e5e9076617078d767b91dbf3a1709b3f4e3eb95d82ee98a5564b093a85b8c300108f0ce56545c0b86fe8dbcd9fec8fc03933e521cf51d1d76d69685a4a4b2b3998bbfe489a8ed98603d326b9ae5c5f6af7cb0fe2eb3486184fd5c6a099dbf3eae1d22f1fd18279978eaa23631b03db91719331b63e350c87c337f7acc186b09e768792518af64a3e7aafdefdfa0cb1d5b95f96a6e61dcb61bad8f88c4d8550e6674aae96cdd664be7fca7c75283374650c11cebf666898c111bf9cce72d2b316759638d5edc523bf5d9ee51a88a1fdaa309320310de3a2738425e5b3e3038cfa33f5801a988b73044d679944dfc0d0b9b699b38cc17ff57090b9fd3f8ee3ff0583d7e08b56c7f7c0135ba88f661a8e913efc9e16c060e40edf7d5fcdb546e3c
#TRUST-RSA-SHA256 9d42537cb05a6dcd517d1c9651721fe29bbc0c7902741cb9a8715f945887465b0758b28b16b74ef5ac2050659b6b9403b0ac8eff14e80ede3b5c490981a4db9b62c88609bbaf94191446babd97d70c7ebf5eb52f1e8c9f81588bec267994a3f4b4f527705c64d7f25d897a2f7dfaff351448719a884aa394340754d8ac86092095f2e576989d55bb9bb28e394f284c9469e4014ee8235e98ecc232ae4b089cc91c0b653865ab88f4800bdbb0f6ae83194c2929ffc74d007c38876e5cbdb35303bb019a970c2629ec7276eafa45a92909e8c00ae3725752c2607442ab000e1beab0bad8bcca7f1e1caa6db88957a47ae85e812995ed86b1922d9e26e12e1d06febe41ebba3f76d06094a07a8453dc769da94e971dc8bd9b1aedc1dfd20ebdeacced23d111b55ecc4aa36ed64aad7db960d723db6d70613674b46cb021959c834e68141bcf4581dbc29b5d47479c7d8dd23b6a0cebf92248ac07da373d46258e21039ef25d577a64ff9a9c57ceca06fbb805a9bfb0f44a1f00eb9e4a4029390f686693910a5c16601f6eea994ff8af10c0fa2c66ddb41c71f534ea7eb9ced1ba042c85fed5f8e822cdbd04776169bcd17867a54f40a3839db1d8c0bc6b1d8c6141881603dfa94e824b1407d840f6d42057ca330e33f8b9032be1c56dcb6042ded8fa306a9869e2ec9f324e2699bec9382d9bf1ccd1ad348ccc9d033911d010e05b
#
# This script is Copyright (C) 2004-2024 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
# $Revision: 1.1 $
# $Date: 2024/06/17 $
#
# Description : This document implements the security configuration as recommended by the
#               DISA Apple iOS/iPadOS 14 v1r3 STIG.
#
#<ui_metadata>
#<display_name>MobileIron - DISA Apple iOS/iPadOS 14 v1r3</display_name>
#<spec>
#  <type>DISA STIG</type>
#  <name>Apple iOS/iPadOS 14</name>
#  <profile>MobileIron</profile>
#  <version>1.3.0</version>
#  <link>https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip</link>
#</spec>
#<labels>mdm,disa,mobileiron,ios</labels>
#<benchmark_refs>CAT,CCE,CCI,DISA_Benchmark,Group-ID,Rule-ID,STIG-ID,STIG-Legacy,Vuln-ID</benchmark_refs>
#</ui_metadata>

<check_type:"MDM" mdm_type:MOBILEIRON>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "AIOS-14-000100 - The mobile operating system must be configured to enforce a minimum password length of six characters."
  info           : "Password strength is a measure of the effectiveness of a password in resisting guessing and brute force attacks. The ability to crack a password is a function of how many attempts an adversary is permitted, how quickly an adversary can do each attempt, and the size of the password space. The longer the minimum length of the password is, the larger the password space. Having a too-short minimum password length significantly reduces password strength, increasing the chance of password compromise and resulting device and data compromise.

SFR ID: FMT_SMF_EXT.1.1 #1a"
  solution       : "Install a configuration profile to enforce a minimum passcode length value of six or greater."
  reference      : "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(a),CAT|II,CCI|CCI-000205,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-228729r561031_rule,STIG-ID|AIOS-14-000100,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-228729"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
  json_transform : '.[] | select(.active=="true") | "Policy: " + .policyName + " - Password Length = " + (.policyRules.SECURITY_PWD_LENGTH // "not defined" )'
  regex          : "Password Length ="
  expect         : "Password Length = ([6-9]|[1-9][0-9])"
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "AIOS-14-000200 - The mobile operating system must be configured to not allow passwords that include more than two repeating or sequential characters."
  info           : "Password strength is a measure of the effectiveness of a password in resisting guessing and brute force attacks. Passwords that contain repeating or sequential characters are significantly easier to guess than those that do not contain repeating or sequential characters. Therefore, disallowing repeating or sequential characters increases password strength and decreases risk.

SFR ID: FMT_SMF_EXT.1.1 #1b"
  solution       : "Install a configuration profile to disallow more than two sequential or repeating numbers or letters in the device unlock password."
  reference      : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-228730r561031_rule,STIG-ID|AIOS-14-000200,SWIFT-CSCv1|2.3,Vuln-ID|V-228730"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
  json_transform : '.[] | select(.active=="true") | "Policy: " + .policyName + " - Password Type = " + (.policyRules.SECURITY_PWD_TYPE // "not defined" )'
  regex          : "Password Type ="
  expect         : "Password Type = alphanumeric"
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "AIOS-14-000300 - The mobile operating system must be configured to enable a screen-lock policy that will lock the display after a period of inactivity."
  info           : "The screen-lock timeout helps protect the device from unauthorized access. Devices without a screen-lock timeout provide an opportunity for adversaries who gain physical access to the mobile device through loss, theft, etc. Such devices are much more likely to be in an unlocked state when acquired by an adversary, thus granting immediate access to the data on the mobile device and possibly access to DoD networks.

Satisfies: PP-MDF-301030, PP-MDF-301040

SFR ID: FMT_SMF_EXT.1.1 #2a & #2b

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution       : "Install a configuration profile to lock the device display after 15 minutes (or less) of inactivity. This is done by setting 'Maximum Auto-Lock time' and 'Grace Period for device lock' so the sum of their values is between 1 and 15 minutes."
  reference      : "800-171|3.1.10,800-53|AC-11a.,800-53r5|AC-11a.,CAT|II,CCI|CCI-000057,CN-L3|8.1.4.1(b),DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11a.,NESA|T2.3.8,NESA|T2.3.9,NIAv2|AM23a,NIAv2|AM23b,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,Rule-ID|SV-228731r561031_rule,STIG-ID|AIOS-14-000300,Vuln-ID|V-228731"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
  json_transform : '.[] | select(.active=="true") | "Policy: " + .policyName + " - Inactivity Timeout = " + (.policyRules.SECURITY_INACTIVITY_TIMEOUT // "not defined" ) + ", Grace Period = " + (.policyRules.SECURITY_GRACE_PERIOD // "not defined" )'
  regex          : ".*"
  expect         : "Manual Review"
  severity       : MEDIUM
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "AIOS-14-000400 - The mobile operating system must be configured to not allow more than ten consecutive failed authentication attempts."
  info           : "The more attempts an adversary has to guess a password, the more likely the adversary will enter the correct password and gain access to resources on the device. Setting a limit on the number of attempts mitigates this risk. Setting the limit at ten or less gives authorized users the ability to make a few mistakes when entering the password but still provides adequate protection against dictionary or brute force attacks on the password.

SFR ID: FMT_SMF_EXT.1.1 #2c, FIA_AFL_EXT.1.5"
  solution       : "Install a configuration profile to allow only ten or fewer consecutive failed authentication attempts."
  reference      : "800-171|3.1.8,800-53|AC-7a.,800-53r5|AC-7a.,CAT|II,CCI|CCI-000044,CN-L3|8.1.4.1(b),DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-7a.,NESA|T5.5.1,NIAv2|AM24,PCI-DSSv3.2.1|8.1.6,PCI-DSSv4.0|8.3.4,Rule-ID|SV-228732r561031_rule,STIG-ID|AIOS-14-000400,TBA-FIISB|45.1.2,TBA-FIISB|45.2.1,TBA-FIISB|45.2.2,Vuln-ID|V-228732"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
  json_transform : '.[] | select(.active=="true") | "Policy: " + .policyName + " - Maximum Failed Attempts = " + (.policyRules.SECURITY_PWD_MAX_FAILED_ATTEMPTS // "not defined" )'
  regex          : "Maximum Failed Attempts ="
  expect         : "Maximum Failed Attempts = ([1-9]|10)[^0-9]"
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "AIOS-14-000500 - The mobile operating system must provide the capability for the Administrator (MDM) to perform the following management function: enable/disable VPN protection across the device and [selection: other methods]."
  info           : "If a user is able to configure the security setting, the user could inadvertently or maliciously set it to a value that poses unacceptable risk to DoD information systems. An adversary could exploit vulnerabilities created by the weaker configuration to compromise DoD-sensitive Information.

SFR ID: FMT_SMF_EXT.1.1 #3

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution       : "If a third-party unmanaged VPN app is installed on the iOS 14 device, do not configure the VPN app with a DoD network VPN profile."
  reference      : "800-171|3.1.1,800-171|3.1.2,800-171|3.4.2,800-53|AC-17b.,800-53|CM-6b.,800-53|CM-6(1),800-53r5|AC-17b.,800-53r5|CM-6b.,800-53r5|CM-6(1),CAT|III,CCI|CCI-000066,CCI|CCI-000366,CCI|CCI-000370,CN-L3|8.1.4.4(c),CN-L3|8.1.10.6(d),CN-L3|8.1.10.6(i),CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-4,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17d.,ITSG-33|CM-6b.,ITSG-33|CM-6(1),NESA|T3.2.1,NESA|T4.5.1,NESA|T5.1.1,NESA|T5.4.2,NESA|T5.4.4,NESA|T5.7.1,NESA|T5.7.2,NIAv2|AM35,NIAv2|NS5f,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,Rule-ID|SV-228733r561031_rule,STIG-ID|AIOS-14-000500,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.6,Vuln-ID|V-228733"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
  json_transform : '.[] | select(.active=="true") | "Policy: " + .policyName + " - VPN Profile = " + (.policyRules.SECURITY_VPN_PROFILE // "not defined" )'
  regex          : ".*"
  expect         : "Manual Review"
  severity       : MEDIUM
</custom_item>

<report type:"WARNING">
  description : "AIOS-14-000700 - The mobile operating system must be configured to enforce an application installation policy by specifying one or more authorized application repositories, including [selection: DoD-approved commercial app repository, MDM server, mobile application store]."
  info        : "Forcing all applications to be installed from authorized application repositories can prevent unauthorized and malicious applications from being installed and executed on mobile devices. Allowing such installations and executions could cause a compromise of DoD data accessible by these unauthorized/malicious applications.

SFR ID: FMT_SMF_EXT.1.1 #8a

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Install a configuration profile to disable 'Allow Trusting New Enterprise App Authors'."
  reference   : "800-171|3.4.2,800-171|3.4.9,800-53|CM-6b.,800-53|CM-11b.,800-53r5|CM-6b.,800-53r5|CM-11b.,CAT|II,CCI|CCI-000366,CCI|CCI-001806,CN-L3|8.1.10.6(d),CSF|DE.CM-3,CSF|PR.IP-1,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.6.2,ITSG-33|CM-6b.,NESA|T3.2.1,QCSC-v1|8.2.1,Rule-ID|SV-228734r852627_rule,STIG-ID|AIOS-14-000700,SWIFT-CSCv1|2.3,SWIFT-CSCv1|5.1,Vuln-ID|V-228734"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
</report>

<report type:"WARNING">
  description : "AIOS-14-001000 - Apple iOS/iPadOS must not include applications with the following characteristics: access to Siri when the device is locked."
  info        : "On iPhone and iPad, users can access the device's contact database or calendar to obtain phone numbers and other information using a human voice even when the mobile device is locked. Often this information is Personally Identifiable Information (PII), which is considered sensitive. It could also be used by an adversary to profile the user or engage in social engineering to obtain further information from other unsuspecting users. Disabling access to the contact database and calendar in these situations mitigates the risk of this attack. The AO may waive this requirement with written notice if the operational environment requires this capability.

SFR ID: FMT_SMF_EXT.1.1 #8b

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Install a configuration profile to disable Siri while the device is locked."
  reference   : "800-171|3.1.13,800-53|AC-17(2),800-53r5|AC-17(2),CAT|II,CCI|CCI-000068,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,PCI-DSSv3.2.1|2.3,PCI-DSSv4.0|2.2.7,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,Rule-ID|SV-228735r561031_rule,STIG-ID|AIOS-14-001000,SWIFT-CSCv1|2.6,Vuln-ID|V-228735"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
</report>

<report type:"WARNING">
  description : "AIOS-14-001100 - The mobile operating system whitelist must be configured to not include applications with the following characteristics: voice dialing application if available when MD is locked."
  info        : "Requiring all authorized applications to be in an application whitelist prevents the execution of any applications (e.g., unauthorized, malicious) that are not part of the whitelist. Failure to configure an application whitelist properly could allow unauthorized and malicious applications to be downloaded, installed, and executed on the mobile device, causing a compromise of DoD data accessible by these applications. Applications with the listed characteristics have features that can cause the compromise of sensitive DoD data or have features with no known application in the DoD environment.

Application note: The application whitelist, in addition to controlling the installation of applications on the MD, must control user access/execution of all core and preinstalled applications, or the MD must provide an alternate method of restricting user access/execution to core and pre-installed applications.

Core application: Any application integrated into the OS by the OS or MD vendors.

Pre-installed application: Additional non-core applications included in the OS build by the OS vendor, MD vendor, or wireless carrier.

SFR ID: FMT_SMF_EXT.1.1 #8b

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Install a configuration profile to disable Voice Control while the device is locked."
  reference   : "800-171|3.4.2,800-171|3.4.9,800-53|CM-6b.,800-53|CM-11b.,800-53r5|CM-6b.,800-53r5|CM-11b.,CAT|II,CCI|CCI-000366,CCI|CCI-001806,CN-L3|8.1.10.6(d),CSF|DE.CM-3,CSF|PR.IP-1,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.6.2,ITSG-33|CM-6b.,NESA|T3.2.1,QCSC-v1|8.2.1,Rule-ID|SV-228736r852628_rule,STIG-ID|AIOS-14-001100,SWIFT-CSCv1|2.3,SWIFT-CSCv1|5.1,Vuln-ID|V-228736"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
</report>

<custom_item>
  type           : CONFIGURATION_INFO
  description    : "AIOS-14-001500 - The mobile operating system must be configured to not display notifications when the device is locked."
  info           : "Many mobile devices display notifications on the lock screen so that users can obtain relevant information in a timely manner without having to frequently unlock the phone to determine if there are new notifications. However, in many cases, these notifications can contain sensitive information. When they are available on the lock screen, an adversary can see them merely by being in close physical proximity to the device. Configuring the MOS to not send notifications to the lock screen mitigates this risk.

SFR ID: FMT_SMF_EXT.1.1 #19"
  solution       : "Install a configuration profile to disable Notification Center from the device Lock screen."
  reference      : "800-171|3.1.9,800-171|3.4.2,800-53|AC-8a.,800-53|CM-6b.,800-53r5|AC-8a.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000051,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-8a.,ITSG-33|CM-6b.,NESA|M5.2.5,NESA|T3.2.1,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,Rule-ID|SV-228737r561040_rule,STIG-ID|AIOS-14-001500,SWIFT-CSCv1|2.3,TBA-FIISB|45.2.4,Vuln-ID|V-228737"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
  json_transform : '.[] | select(.appType=="RESTRICTION") | "Policy: " + .name + " - Allow Lock Screen Notification View = " + (.properties.ALLOW_LOCKSCREENNOTIFICATIONVIEW // "not defined" )'
  regex          : "Allow Lock Screen Notification View ="
  expect         : "Allow Lock Screen Notification View = false"
</custom_item>

<custom_item>
  type           : CONFIGURATION_INFO
  description    : "AIOS-14-001600 - Apple iOS/iPadOS must not display notifications (calendar information) when the device is locked."
  info           : "Many mobile devices display notifications on the lock screen so that users can obtain relevant information in a timely manner without having to frequently unlock the phone to determine if there are new notifications. However, in many cases, these notifications can contain sensitive information. Notifications on the lock screen can be viewed by an adversary merely by being in close physical proximity to the device. Configuring the MOS to not send notifications to the lock screen mitigates this risk.

SFR ID: FMT_SMF_EXT.1.1 #19"
  solution       : "Install a configuration profile to disable Notification Center from the device Lock screen."
  reference      : "800-171|3.1.9,800-171|3.4.2,800-53|AC-8a.,800-53|CM-6b.,800-53r5|AC-8a.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000051,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-8a.,ITSG-33|CM-6b.,NESA|M5.2.5,NESA|T3.2.1,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,Rule-ID|SV-228738r561104_rule,STIG-ID|AIOS-14-001600,SWIFT-CSCv1|2.3,TBA-FIISB|45.2.4,Vuln-ID|V-228738"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
  json_transform : '.[] | select(.appType=="RESTRICTION") | "Policy: " + .name + " - Allow Lock Screen Today View = " + (.properties.ALLOW_LOCKSCREENTODAYVIEW // "not defined" )'
  regex          : "Allow Lock Screen Today View ="
  expect         : "Allow Lock Screen Today View = false"
</custom_item>

<report type:"WARNING">
  description : "AIOS-14-003300 - The mobile operating system must be configured to display the DoD advisory warning message at start-up or each time the user unlocks the device."
  info        : "The mobile operating system is required to display the DoD-approved system use notification message or banner before granting access to the system that provides privacy and security notices consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance. Required banners help ensure that DoD can audit and monitor the activities of mobile device users without legal restriction.

System use notification messages can be displayed when individuals first access or unlock the mobile device. The banner must be implemented as a 'click-through' banner at device unlock (to the extent permitted by the operating system). A 'click-through' banner prevents further activity on the information system unless and until the user executes a positive action to manifest agreement by clicking on a box indicating 'OK.'

The approved DoD text must be used exactly as required in the KS referenced in DoDI 8500.01. For devices accommodating banners of 1300 characters, the banner text is:

You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.

By using this IS (which includes any device attached to this IS), you consent to the following conditions:

-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.

-At any time, the USG may inspect and seize data stored on this IS.

-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.

-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.

-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.

For devices with severe character limitations, the banner text is:

I've read & consent to terms in IS user agreem't.

The administrator must configure the banner text exactly as written without any changes.

SFR ID: FMT_SMF_EXT.1.1 #36

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the DoD warning banner by either of the following methods (required text is found in the Vulnerability Discussion):

1. By placing the DoD warning banner text in the user agreement signed by each iOS device user (preferred method).
2. By creating a background picture with the relevant information and configuring that picture as the background for the lock screen via the Apple iOS/iPadOS management tool."
  reference   : "800-171|3.1.9,800-53|AC-8a.,800-53r5|AC-8a.,CAT|III,CCI|CCI-000048,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-8a.,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,Rule-ID|SV-228739r561044_rule,STIG-ID|AIOS-14-003300,TBA-FIISB|45.2.4,Vuln-ID|V-228739"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
</report>

<report type:"WARNING">
  description : "AIOS-14-003600 - The mobile operating system must be configured to not allow backup of [all applications, configuration data] to locally connected systems."
  info        : "Data on mobile devices is protected by numerous mechanisms, including user authentication, access control, and cryptography. When the data is backed up to an external system (either locally connected or cloud-based), many if not all of these mechanisms are no longer present. This leaves the backed-up data vulnerable to attack. Disabling backup to external systems mitigates this risk.

SFR ID: FMT_SMF_EXT.1.1 #40

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Install a configuration profile to disable backup of managed apps."
  reference   : "800-171|3.1.21,800-53|AC-20(2),800-53r5|AC-20(2),CAT|II,CCI|CCI-000097,CSF|ID.AM-4,CSF|PR.AC-3,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-20(2),NESA|M1.3.5,NESA|T1.2.3,QCSC-v1|3.2,QCSC-v1|5.2.2,Rule-ID|SV-228740r561031_rule,STIG-ID|AIOS-14-003600,SWIFT-CSCv1|2.5,Vuln-ID|V-228740"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
</report>

<custom_item>
  type           : CONFIGURATION_INFO
  description    : "AIOS-14-003700 - Apple iOS/iPadOS must not allow backup to remote systems (iCloud)."
  info           : "If a user is able to configure the security setting, the user could inadvertently or maliciously set it to a value that poses unacceptable risk to DoD information systems. An adversary could exploit vulnerabilities created by the weaker configuration to compromise DoD-sensitive Information.

SFR ID: FMT_MOF_EXT.1.2 #40"
  solution       : "Install a configuration profile to disable iCloud Backup."
  reference      : "800-171|3.1.21,800-171|3.4.2,800-53|AC-20(2),800-53|CM-6b.,800-53|CM-6(1),800-53r5|AC-20(2),800-53r5|CM-6b.,800-53r5|CM-6(1),CAT|II,CCI|CCI-000097,CCI|CCI-000366,CCI|CCI-000370,CN-L3|8.1.10.6(d),CSF|ID.AM-4,CSF|PR.AC-3,CSF|PR.IP-1,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-20(2),ITSG-33|CM-6b.,ITSG-33|CM-6(1),NESA|M1.3.5,NESA|T1.2.3,NESA|T3.2.1,NIAv2|NS5f,QCSC-v1|3.2,QCSC-v1|5.2.2,Rule-ID|SV-228741r561031_rule,STIG-ID|AIOS-14-003700,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,Vuln-ID|V-228741"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
  json_transform : '.[] | select(.appType=="RESTRICTION") | "Policy: " + .name + " - Allow Cloud Backup = " + (.properties.ALLOW_CLOUD_BACKUP // "not defined" )'
  regex          : "Allow Cloud Backup ="
  expect         : "Allow Cloud Backup = false"
</custom_item>

<custom_item>
  type           : CONFIGURATION_INFO
  description    : "AIOS-14-003800 - Apple iOS/iPadOS must not allow backup to remote systems (iCloud document and data synchronization)."
  info           : "If a user is able to configure the security setting, the user could inadvertently or maliciously set it to a value that poses unacceptable risk to DoD information systems. An adversary could exploit vulnerabilities created by the weaker configuration to compromise DoD-sensitive Information.

SFR ID: FMT_MOF_EXT.1.2 #40"
  solution       : "Install a configuration profile to disable iCloud documents and data."
  reference      : "800-171|3.1.21,800-171|3.4.2,800-53|AC-20(2),800-53|CM-6b.,800-53|CM-6(1),800-53r5|AC-20(2),800-53r5|CM-6b.,800-53r5|CM-6(1),CAT|II,CCI|CCI-000097,CCI|CCI-000366,CCI|CCI-000370,CN-L3|8.1.10.6(d),CSF|ID.AM-4,CSF|PR.AC-3,CSF|PR.IP-1,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-20(2),ITSG-33|CM-6b.,ITSG-33|CM-6(1),NESA|M1.3.5,NESA|T1.2.3,NESA|T3.2.1,NIAv2|NS5f,QCSC-v1|3.2,QCSC-v1|5.2.2,Rule-ID|SV-228742r561031_rule,STIG-ID|AIOS-14-003800,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,Vuln-ID|V-228742"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
  json_transform : '.[] | select(.appType=="RESTRICTION") | "Policy: " + .name + " - Allow Cloud Document Sync = " + (.properties.ALLOW_CLOUD_DOCUMENT_SYNC // "not defined" )'
  regex          : "Allow Cloud Document Sync ="
  expect         : "Allow Cloud Document Sync = false"
</custom_item>

<report type:"WARNING">
  description : "AIOS-14-003900 - Apple iOS/iPadOS must not allow backup to remote systems (iCloud Keychain)."
  info        : "If a user is able to configure the security setting, the user could inadvertently or maliciously set it to a value that poses unacceptable risk to DoD information systems. An adversary could exploit vulnerabilities created by the weaker configuration to compromise DoD-sensitive Information.

SFR ID: FMT_MOF_EXT.1.2 #40

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Install a configuration profile to disable iCloud keychain."
  reference   : "800-171|3.1.21,800-171|3.4.2,800-53|AC-20(2),800-53|CM-6b.,800-53|CM-6(1),800-53r5|AC-20(2),800-53r5|CM-6b.,800-53r5|CM-6(1),CAT|II,CCI|CCI-000097,CCI|CCI-000366,CCI|CCI-000370,CN-L3|8.1.10.6(d),CSF|ID.AM-4,CSF|PR.AC-3,CSF|PR.IP-1,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-20(2),ITSG-33|CM-6b.,ITSG-33|CM-6(1),NESA|M1.3.5,NESA|T1.2.3,NESA|T3.2.1,NIAv2|NS5f,QCSC-v1|3.2,QCSC-v1|5.2.2,Rule-ID|SV-228743r561031_rule,STIG-ID|AIOS-14-003900,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,Vuln-ID|V-228743"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
</report>

<custom_item>
  type           : CONFIGURATION_INFO
  description    : "AIOS-14-004000 - Apple iOS/iPadOS must not allow backup to remote systems (My Photo Stream)."
  info           : "If a user is able to configure the security setting, the user could inadvertently or maliciously set it to a value that poses unacceptable risk to DoD information systems. An adversary could exploit vulnerabilities created by the weaker configuration to compromise DoD-sensitive Information.

SFR ID: FMT_MOF_EXT.1.2 #40"
  solution       : "Install a configuration profile to disable My Photo Stream."
  reference      : "800-171|3.1.21,800-171|3.4.2,800-53|AC-20(2),800-53|CM-6b.,800-53|CM-6(1),800-53r5|AC-20(2),800-53r5|CM-6b.,800-53r5|CM-6(1),CAT|II,CCI|CCI-000097,CCI|CCI-000366,CCI|CCI-000370,CN-L3|8.1.10.6(d),CSF|ID.AM-4,CSF|PR.AC-3,CSF|PR.IP-1,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-20(2),ITSG-33|CM-6b.,ITSG-33|CM-6(1),NESA|M1.3.5,NESA|T1.2.3,NESA|T3.2.1,NIAv2|NS5f,QCSC-v1|3.2,QCSC-v1|5.2.2,Rule-ID|SV-228744r561031_rule,STIG-ID|AIOS-14-004000,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,Vuln-ID|V-228744"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
  json_transform : '.[] | select(.appType=="RESTRICTION") | "Policy: " + .name + " - Allow Photo Stream = " + (.properties.ALLOW_PHOTO_STREAM // "not defined" )'
  regex          : "Allow Photo Stream ="
  expect         : "Allow Photo Stream = false"
</custom_item>

<custom_item>
  type           : CONFIGURATION_INFO
  description    : "AIOS-14-004100 - Apple iOS/iPadOS must not allow backup to remote systems (iCloud Photo Sharing, also known as Shared Photo Streams)."
  info           : "If a user is able to configure the security setting, the user could inadvertently or maliciously set it to a value that poses unacceptable risk to DoD information systems. An adversary could exploit vulnerabilities created by the weaker configuration to compromise DoD-sensitive Information.

SFR ID: FMT_MOF_EXT.1.2 #40"
  solution       : "Install a configuration profile to disable 'Allow iCloud Photos'."
  reference      : "800-171|3.1.21,800-171|3.4.2,800-53|AC-20(2),800-53|CM-6b.,800-53|CM-6(1),800-53r5|AC-20(2),800-53r5|CM-6b.,800-53r5|CM-6(1),CAT|II,CCI|CCI-000097,CCI|CCI-000366,CCI|CCI-000370,CN-L3|8.1.10.6(d),CSF|ID.AM-4,CSF|PR.AC-3,CSF|PR.IP-1,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-20(2),ITSG-33|CM-6b.,ITSG-33|CM-6(1),NESA|M1.3.5,NESA|T1.2.3,NESA|T3.2.1,NIAv2|NS5f,QCSC-v1|3.2,QCSC-v1|5.2.2,Rule-ID|SV-228745r561031_rule,STIG-ID|AIOS-14-004100,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,Vuln-ID|V-228745"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
  json_transform : '.[] | select(.appType=="RESTRICTION") | "Policy: " + .name + " - Allow Shared Stream = " + (.properties.ALLOW_SHARED_STREAM // "not defined" )'
  regex          : "Allow Shared Stream ="
  expect         : "Allow Shared Stream = false"
</custom_item>

<report type:"WARNING">
  description : "AIOS-14-004200 - Apple iOS/iPadOS must not allow backup to remote systems (managed applications data stored in iCloud)."
  info        : "If a user is able to configure the security setting, the user could inadvertently or maliciously set it to a value that poses unacceptable risk to DoD information systems. An adversary could exploit vulnerabilities created by the weaker configuration to compromise DoD-sensitive Information.

SFR ID: FMT_MOF_EXT.1.2 #40

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Install a configuration profile to prevent DoD applications from storing data in iCloud."
  reference   : "800-171|3.1.21,800-171|3.4.2,800-53|AC-20(2),800-53|CM-6b.,800-53|CM-6(1),800-53r5|AC-20(2),800-53r5|CM-6b.,800-53r5|CM-6(1),CAT|II,CCI|CCI-000097,CCI|CCI-000366,CCI|CCI-000370,CN-L3|8.1.10.6(d),CSF|ID.AM-4,CSF|PR.AC-3,CSF|PR.IP-1,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-20(2),ITSG-33|CM-6b.,ITSG-33|CM-6(1),NESA|M1.3.5,NESA|T1.2.3,NESA|T3.2.1,NIAv2|NS5f,QCSC-v1|3.2,QCSC-v1|5.2.2,Rule-ID|SV-228746r561031_rule,STIG-ID|AIOS-14-004200,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,Vuln-ID|V-228746"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
</report>

<report type:"WARNING">
  description : "AIOS-14-004300 - Apple iOS/iPadOS must not allow backup to remote systems (enterprise books)."
  info        : "If a user is able to configure the security setting, the user could inadvertently or maliciously set it to a value that poses unacceptable risk to DoD information systems. An adversary could exploit vulnerabilities created by the weaker configuration to compromise DoD-sensitive Information.

SFR ID: FMT_MOF_EXT.1.2 #40

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Install a configuration profile to prevent backup of enterprise books that could contain DoD-sensitive information."
  reference   : "800-171|3.1.21,800-171|3.4.2,800-53|AC-20(2),800-53|CM-6b.,800-53|CM-6(1),800-53r5|AC-20(2),800-53r5|CM-6b.,800-53r5|CM-6(1),CAT|II,CCI|CCI-000097,CCI|CCI-000366,CCI|CCI-000370,CN-L3|8.1.10.6(d),CSF|ID.AM-4,CSF|PR.AC-3,CSF|PR.IP-1,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-20(2),ITSG-33|CM-6b.,ITSG-33|CM-6(1),NESA|M1.3.5,NESA|T1.2.3,NESA|T3.2.1,NIAv2|NS5f,QCSC-v1|3.2,QCSC-v1|5.2.2,Rule-ID|SV-228747r561031_rule,STIG-ID|AIOS-14-004300,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,Vuln-ID|V-228747"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
</report>

<custom_item>
  type           : CONFIGURATION_INFO
  description    : "AIOS-14-005200 - Apple iOS/iPadOS must not allow non-DoD applications to access DoD data."
  info           : "App data sharing gives apps the ability to access the data of other apps for enhanced user functionality. However, sharing also poses a significant risk that unauthorized users or apps will obtain access to DoD-sensitive information. To mitigate this risk, there are data sharing restrictions. If a user is allowed to make exceptions to the data sharing restriction policy, the user could enable unauthorized sharing of data, leaving it vulnerable to breach. Limiting the granting of exceptions to either the Administrator or common application developer mitigates this risk.

Copy/paste of data between applications in different application processes or groups of application processes is considered an exception to the access control policy; and therefore, the Administrator must be able to enable/disable the feature. Other exceptions include allowing any data or application sharing between process groups.

SFR ID: FMT_SMF_EXT.1.1 #42, FDP_ACF_EXT.1.2"
  solution       : "Install a configuration profile to prevent non-DoD applications from accessing DoD data."
  reference      : "800-171|3.1.3,800-171|3.4.2,800-53|AC-4(2),800-53|CM-6b.,800-53r5|AC-4(2),800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CCI|CCI-002191,CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(d),CSF|DE.AE-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.IP-1,CSF|PR.PT-4,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-4(2),ITSG-33|CM-6b.,NESA|T3.2.1,NESA|T7.5.2,NIAv2|GS11a,NIAv2|GS12a,NIAv2|GS14a,NIAv2|GS15a,NIAv2|GS16a,NIAv2|NS13a,NIAv2|NS13b,NIAv2|NS13c,NIAv2|NS14,NIAv2|SS23,NIAv2|SS27a,NIAv2|SS27b,NIAv2|SS32,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,Rule-ID|SV-228748r852629_rule,STIG-ID|AIOS-14-005200,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.4,Vuln-ID|V-228748"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
  json_transform : '.[] | select(.appType=="RESTRICTION") | "Policy: " + .name + " - Allow Open From Managed To Unmanaged = " + (.properties.ALLOW_OPEN_FROM_MANAGED_TO_UNMANAGED // "not defined" )'
  regex          : "Allow Open From Managed To Unmanaged ="
  expect         : "Allow Open From Managed To Unmanaged = false"
</custom_item>

<report type:"WARNING">
  description : "AIOS-14-007600 - Apple iOS/iPadOS must implement the management setting: remove managed applications upon unenrollment from MDM (including sensitive and protected data)."
  info        : "When a device is unenrolled from MDM, it is possible to relax the security policies that the MDM had implemented on the device. This may cause apps and data to be more vulnerable than prior to enrollment. Removing managed apps (and consequently the data maintained within) upon unenrollment mitigates this risk because on appropriately configured iPhone and iPads, DoD-sensitive information exists only within managed apps.

Satisfies: PP-MDF-301500, MDF-PP-302500

SFR ID: FMT_SMF_EXT.2.1, FMT_SMF_EXT.1.1 #47h

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Install a configuration profile to delete all managed apps upon device unenrollment."
  reference   : "800-171|3.4.2,800-171|3.13.16,800-53|CM-6b.,800-53|CM-6(1),800-53|SC-28,800-53r5|CM-6b.,800-53r5|CM-6(1),800-53r5|SC-28,CAT|II,CCI|CCI-000366,CCI|CCI-000370,CCI|CCI-001199,CN-L3|8.1.4.7(b),CN-L3|8.1.4.8(b),CN-L3|8.1.10.6(d),CSF|PR.DS-1,CSF|PR.IP-1,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ITSG-33|CM-6b.,ITSG-33|CM-6(1),ITSG-33|SC-28,ITSG-33|SC-28a.,NESA|T3.2.1,NIAv2|NS5f,PCI-DSSv3.2.1|3.4,PCI-DSSv4.0|3.3.2,PCI-DSSv4.0|3.5.1,QCSC-v1|5.2.2,QCSC-v1|6.2,Rule-ID|SV-244559r734148_rule,STIG-ID|AIOS-14-007600,SWIFT-CSCv1|2.3,Vuln-ID|V-244559"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
</report>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "AIOS-14-008800 - Apple iOS/iPadOS must require a valid password be successfully entered before the mobile device data is unencrypted."
  info           : "Passwords provide a form of access control that prevents unauthorized individuals from accessing computing resources and sensitive data. Passwords may also be a source of entropy for generation of key encryption or data encryption keys. If a password is not required to access data, this data is accessible to any adversary who obtains physical possession of the device. Requiring that a password be successfully entered before the mobile device data is unencrypted mitigates this risk.

Note: MDF PP v2.0 requires a Password Authentication Factor and requires management of its length and complexity. It leaves open whether the existence of a password is subject to management. This requirement addresses the configuration to require a password, which is critical to the cybersecurity posture of the device.

SFR ID: FIA_UAU_EXT.1.1"
  solution       : "Install a configuration profile to require a password to unlock the device."
  reference      : "800-171|3.13.16,800-53|SC-28,800-53r5|SC-28,CAT|I,CCI|CCI-001199,CN-L3|8.1.4.7(b),CN-L3|8.1.4.8(b),CSF|PR.DS-1,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ITSG-33|SC-28,ITSG-33|SC-28a.,PCI-DSSv3.2.1|3.4,PCI-DSSv4.0|3.3.2,PCI-DSSv4.0|3.5.1,QCSC-v1|5.2.2,QCSC-v1|6.2,Rule-ID|SV-228750r561031_rule,STIG-ID|AIOS-14-008800,Vuln-ID|V-228750"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
  json_transform : '.[] | select(.active=="true") | "Policy: " + .policyName + " - Require Password = " + (.policyRules.SECURITY_REQUIRE_PWD // "not defined" )'
  regex          : "Require Password ="
  expect         : "Require Password = on"
</custom_item>

<custom_item>
  type           : CONFIGURATION_INFO
  description    : "AIOS-14-008900 - Apple iOS/iPadOS must implement the management setting: limit Ad Tracking."
  info           : "Ad Tracking refers to the advertisers' ability to categorize the device and spam the user with ads that are most relevant to the user's preferences. By not 'Force limiting ad tracking', advertising companies are able to gather information about the user and device's browsing habits. If 'Limit Ad Tracking' is not limited, a database of browsing habits of DoD devices can be gathered and stored under no supervision of the DoD. By limiting ad tracking, this setting does not completely mitigate the risk, but it limits the amount of information gathering.

SFR ID: FMT_SMF_EXT.1.1 #47"
  solution       : "Install a configuration profile to limit advertisers' ability to track the user's web browsing preferences."
  reference      : "800-171|3.4.2,800-171|3.13.16,800-53|CM-6b.,800-53|CM-6(1),800-53|SC-28,800-53r5|CM-6b.,800-53r5|CM-6(1),800-53r5|SC-28,CAT|III,CCI|CCI-000366,CCI|CCI-000370,CCI|CCI-001199,CN-L3|8.1.4.7(b),CN-L3|8.1.4.8(b),CN-L3|8.1.10.6(d),CSF|PR.DS-1,CSF|PR.IP-1,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ITSG-33|CM-6b.,ITSG-33|CM-6(1),ITSG-33|SC-28,ITSG-33|SC-28a.,NESA|T3.2.1,NIAv2|NS5f,PCI-DSSv3.2.1|3.4,PCI-DSSv4.0|3.3.2,PCI-DSSv4.0|3.5.1,QCSC-v1|5.2.2,QCSC-v1|6.2,Rule-ID|SV-228751r561031_rule,STIG-ID|AIOS-14-008900,SWIFT-CSCv1|2.3,Vuln-ID|V-228751"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
  json_transform : '.[] | select(.appType=="RESTRICTION") | "Policy: " + .name + " - Allow Ad Tracking = " + (.properties.ALLOW_ADTRACKING // "not defined" )'
  regex          : "Allow Ad Tracking ="
  expect         : "Allow Ad Tracking = false"
</custom_item>

<custom_item>
  type           : CONFIGURATION_INFO
  description    : "AIOS-14-009000 - Apple iOS/iPadOS must implement the management setting: not allow automatic completion of Safari browser passcodes."
  info           : "The AutoFill functionality in the Safari web browser allows the user to complete a form that contains sensitive information, such as PII, without previous knowledge of the information. By allowing the use of the AutoFill functionality, an adversary who learns a user's iPhone or iPad passcode, or who otherwise is able to unlock the device, may be able to further breach other systems by relying on the AutoFill feature to provide information unknown to the adversary. By disabling the AutoFill functionality, the risk of an adversary gaining further information about the device's user or compromising other systems is significantly mitigated.

SFR ID: FMT_SMF_EXT.1.1 #47"
  solution       : "Install a configuration profile to disable the AutoFill capability in the Safari app."
  reference      : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6b.,800-53|CM-6(1),800-53|CM-7a.,800-53r5|CM-6b.,800-53r5|CM-6(1),800-53r5|CM-7a.,CAT|III,CCI|CCI-000366,CCI|CCI-000370,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,ITSG-33|CM-6(1),ITSG-33|CM-7a.,NESA|T3.2.1,NIAv2|NS5f,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-228752r561031_rule,STIG-ID|AIOS-14-009000,SWIFT-CSCv1|2.3,Vuln-ID|V-228752"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
  json_transform : '.[] | select(.appType=="RESTRICTION") | "Policy: " + .name + " - Safari Allow Autofill = " + (.properties.LOCKDOWN_SAFARIALLOWAUTOFILL // "not defined" )'
  regex          : "Safari Allow Autofill ="
  expect         : "Safari Allow Autofill = false"
</custom_item>

<custom_item>
  type           : CONFIGURATION_INFO
  description    : "AIOS-14-009100 - Apple iOS/iPadOS must implement the management setting: Encrypt iTunes backups/Encrypt local backup."
  info           : "When syncing an iPhone and iPad to a computer running iTunes, iTunes will prompt the user to back up the iPhone and iPad. If the performed backup is not encrypted, this could lead to the unauthorized disclosure of DoD-sensitive information if non-DoD personnel are able to access that machine. By forcing the backup to be encrypted, this greatly mitigates the risk of compromising sensitive data. iTunes backup and USB connections to computers are not authorized, but this control provides defense-in-depth for cases in which a user violates policy either intentionally or inadvertently.

SFR ID: FMT_SMF_EXT.1.1 #47"
  solution       : "Install a configuration profile to force encrypted backups to iTunes."
  reference      : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6b.,800-53|CM-6(1),800-53|CM-7a.,800-53r5|CM-6b.,800-53r5|CM-6(1),800-53r5|CM-7a.,CAT|II,CCI|CCI-000366,CCI|CCI-000370,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,ITSG-33|CM-6(1),ITSG-33|CM-7a.,NESA|T3.2.1,NIAv2|NS5f,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-228753r561031_rule,STIG-ID|AIOS-14-009100,SWIFT-CSCv1|2.3,Vuln-ID|V-228753"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
  json_transform : '.[] | select(.appType=="RESTRICTION") | "Policy: " + .name + " - Force Encrypted Backup = " + (.properties.LOCKDOWN_FORCEENCRYPTEDBACKUP // "not defined" )'
  regex          : "Force Encrypted Backup ="
  expect         : "Force Encrypted Backup = true"
</custom_item>

<report type:"WARNING">
  description : "AIOS-14-009200 - Apple iOS/iPadOS must implement the management setting: not allow use of Handoff."
  info        : "Handoff permits a user of an iPhone and iPad to transition user activities from one device to another. Handoff passes sufficient information between the devices to describe the activity, but app data synchronization associated with the activity is handled though iCloud, which should be disabled on a compliant iPhone and iPad. If a user associates both DoD and personal devices to the same Apple ID, the user may improperly reveal information about the nature of the user's activities on an unprotected device. Disabling Handoff mitigates this risk.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Install a configuration profile to disable continuation of activities among devices and workstations."
  reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6b.,800-53|CM-6(1),800-53|CM-7a.,800-53r5|CM-6b.,800-53r5|CM-6(1),800-53r5|CM-7a.,CAT|III,CCI|CCI-000366,CCI|CCI-000370,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,ITSG-33|CM-6(1),ITSG-33|CM-7a.,NESA|T3.2.1,NIAv2|NS5f,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-228754r561031_rule,STIG-ID|AIOS-14-009200,SWIFT-CSCv1|2.3,Vuln-ID|V-228754"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
</report>

<report type:"WARNING">
  description : "AIOS-14-009300 - Apple iOS/iPadOS must implement the management setting: require the user to enter a password when connecting to an AirPlay-enabled device for the first time."
  info        : "When a user is allowed to use AirPlay without a password, there is the potential that it may mistakenly associate the iPhone and iPad with an AirPlay-enabled device other than the one intended (i.e., by choosing the wrong one from the AirPlay list displayed). This creates the potential that someone in control of a mistakenly associated device may obtain DoD-sensitive information without authorization. Requiring a password before such an association mitigates this risk. Passwords do not require any administration, and are not required to comply with any complexity requirements.

SFR ID: FMT_SMF_EXT.1.1 #40

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Install a configuration profile to require the user to enter a password when connecting to an AirPlay-enabled device for the first time."
  reference   : "800-171|3.1.1,800-171|3.1.2,800-53|AC-17a.,800-53r5|AC-17a.,CAT|III,CCI|CCI-000063,CN-L3|7.1.2.2(h),CN-L3|7.1.3.7(a),CSF|PR.AC-3,CSF|PR.PT-4,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17a.,ITSG-33|AC-17b.,NESA|T4.2.1,NESA|T4.5.1,NESA|T5.1.1,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.7.1,NESA|T5.7.2,NIAv2|AM40,NIAv2|AM41,NIAv2|NS5g,NIAv2|NS5h,NIAv2|NS48,NIAv2|NS51,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,Rule-ID|SV-228755r561031_rule,STIG-ID|AIOS-14-009300,SWIFT-CSCv1|2.6,Vuln-ID|V-228755"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
</report>

<report type:"WARNING">
  description : "AIOS-14-009400 - Apple iOS/iPadOS must implement the management setting: Disable Allow MailDrop."
  info        : "MailDrop allows users to send large attachments (up to 5 GB) in size via iCloud. Storing data with a non-DoD cloud provider may leave the data vulnerable to breach. Disabling non-DoD cloud services mitigates this risk.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the Apple iOS/iPadOS configuration profile to disable 'Allow MailDrop'."
  reference   : "800-171|3.1.12,800-171|3.4.2,800-53|AC-17(1),800-53|CM-6b.,800-53|CM-6(1),800-53r5|AC-17(1),800-53r5|CM-6b.,800-53r5|CM-6(1),CAT|II,CCI|CCI-000366,CCI|CCI-000370,CCI|CCI-002314,CN-L3|8.1.4.4(c),CN-L3|8.1.10.6(d),CN-L3|8.1.10.6(i),CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-4,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17(1),ITSG-33|CM-6b.,ITSG-33|CM-6(1),NESA|T3.2.1,NESA|T5.4.4,NIAv2|NS5f,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,Rule-ID|SV-228756r852630_rule,STIG-ID|AIOS-14-009400,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.6,Vuln-ID|V-228756"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
</report>

<report type:"WARNING">
  description : "AIOS-14-009500 - Apple iOS/iPadOS must implement the management setting: Disable Allow Shared Albums."
  info        : "Storing data with a non-DoD cloud provider may leave the data vulnerable to breach. Disabling non-DoD cloud services mitigates this risk.

Note: If the AO has approved the use/storage of DoD data in one or more personal (unmanaged) apps, allowing unrestricted activity by the user in downloading and installing personal (unmanaged) apps on the iOS 14 device may not be warranted due to the risk of possible loss of or unauthorized access to DoD data.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the Apple iOS/iPadOS configuration profile to disable 'Allow Shared Albums'."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-228757r561031_rule,STIG-ID|AIOS-14-009500,SWIFT-CSCv1|2.3,Vuln-ID|V-228757"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
</report>

<report type:"WARNING">
  description : "AIOS-14-009600 - iPhone and iPad must have the latest available iOS/iPadOS operating system installed."
  info        : "Required security features are not available in earlier OS versions. In addition, there may be known vulnerabilities in earlier versions.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Install the latest release version of Apple iOS/iPadOS on all managed iOS devices."
  reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6b.,800-53|CM-6(1),800-53|CM-7a.,800-53r5|CM-6b.,800-53r5|CM-6(1),800-53r5|CM-7a.,CAT|I,CCI|CCI-000366,CCI|CCI-000370,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,ITSG-33|CM-6(1),ITSG-33|CM-7a.,NESA|T3.2.1,NIAv2|NS5f,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-228758r561031_rule,STIG-ID|AIOS-14-009600,SWIFT-CSCv1|2.3,Vuln-ID|V-228758"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
</report>

<custom_item>
  type           : CONFIGURATION_INFO
  description    : "AIOS-14-009700 - Apple iOS/iPadOS must implement the management setting: use SSL for Exchange ActiveSync."
  info           : "Exchange email messages are a form of data in transit and thus are vulnerable to eavesdropping and man-in-the-middle attacks. Secure Sockets Layer (SSL), also referred to as Transport Layer Security (TLS), provides encryption and authentication services that mitigate the risk of breach.

SFR ID: FMT_SMF_EXT.1.1 #47"
  solution       : "Install a configuration profile to use SSL for Exchange ActiveSync."
  reference      : "800-171|3.5.1,800-53|IA-2,800-53r5|IA-2,CAT|II,CCI|CCI-000764,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-228759r561031_rule,STIG-ID|AIOS-14-009700,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-228759"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
  json_transform : '.[] | select(.appType=="EXCHANGE") | "Policy: " + .name + " - Use SSL = " + (.properties.USESSL // "not defined" )'
  regex          : "Use SSL ="
  expect         : "Use SSL = true"
</custom_item>

<custom_item>
  type           : CONFIGURATION_INFO
  description    : "AIOS-14-009800 - Apple iOS/iPadOS must implement the management setting: not allow messages in an ActiveSync Exchange account to be forwarded or moved to other accounts in the Apple iOS/iPadOS Mail app."
  info           : "The Apple iOS/iPadOS Mail app can be configured to support multiple email accounts concurrently. These email accounts are likely to involve content of varying degrees of sensitivity (e.g., both personal and enterprise messages). To prevent the unauthorized and undetected forwarding or moving of messages from one account to another, Mail ActiveSync Exchange accounts can be configured to block such behavior. While users may still send a message from the Exchange account to another account, these transactions must involve an Exchange server, enabling audit records of the transaction, filtering of mail content, and subsequent forensic analysis.

SFR ID: FMT_SMF_EXT.1.1 #47"
  solution       : "Install a configuration profile to prevent Exchange messages from being moved or forwarded between email accounts."
  reference      : "800-171|3.4.2,800-171|3.5.1,800-53|CM-6b.,800-53|CM-6(1),800-53|IA-2,800-53r5|CM-6b.,800-53r5|CM-6(1),800-53r5|IA-2,CAT|II,CCI|CCI-000366,CCI|CCI-000370,CCI|CCI-000764,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.1.10.6(d),CN-L3|8.5.4.1(a),CSF|PR.AC-1,CSF|PR.IP-1,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|CM-6b.,ITSG-33|CM-6(1),ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T3.2.1,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,NIAv2|NS5f,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-228760r561031_rule,STIG-ID|AIOS-14-009800,SWIFT-CSCv1|2.3,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-228760"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
  json_transform : '.[] | select(.appType=="EXCHANGE") | "Policy: " + .name + " - Block Message Move Forward = " + (.properties.BLOCK_MESSAGEMOVEFORWARD // "not defined" )'
  regex          : "Block Message Move Forward ="
  expect         : "Block Message Move Forward = true"
</custom_item>

<report type:"WARNING">
  description : "AIOS-14-009900 - Apple iOS/iPadOS must implement the management setting: Treat AirDrop as an unmanaged destination."
  info        : "An airdrop feature is a way to send contact information or photos to other users with this same feature enabled. This feature enables a possible attack vector for adversaries to exploit. Once the attacker has gained access to the information broadcast by this feature, he/she may distribute this sensitive information very quickly and without DoD's control or awareness. By disabling this feature, the risk of mass data exfiltration will be mitigated.

Note: If the site uses Apple's optional Device Enrollment Program (DEP), this control is available as a supervised MDM control.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Install a configuration profile to treat AirDrop as an unmanaged destination."
  reference   : "800-171|3.4.2,800-171|3.5.2,800-53|CM-6b.,800-53|IA-5(14),800-53r5|CM-6b.,800-53r5|IA-5(14),CAT|II,CCI|CCI-000366,CCI|CCI-002008,CN-L3|8.1.10.6(d),CSF|PR.AC-1,CSF|PR.IP-1,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|CM-6b.,ITSG-33|IA-5,NESA|T3.2.1,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-228761r852631_rule,STIG-ID|AIOS-14-009900,SWIFT-CSCv1|2.3,Vuln-ID|V-228761"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
</report>

<report type:"WARNING">
  description : "AIOS-14-010000 - Apple iOS/iPadOS must implement the management setting: not have any Family Members in Family Sharing."
  info        : "Apple's Family Sharing service allows Apple iOS/iPadOS users to create a Family Group whose members have several shared capabilities, including the ability to lock, wipe, play a sound on, or locate the iPhone and iPads of other members. Each member of the group must be invited to the group and accept that invitation. A DoD user's iPhone and iPad may be inadvertently or maliciously wiped by another member of the Family Group. This poses a risk that the user could be without a mobile device for a period of time or lose sensitive information that has not been backed up to other storage media. Configuring iPhone and iPads so their associated Apple IDs are not members of Family Groups mitigates this risk.

Note: If the site uses Apple's optional Device Enrollment Program (DEP), this control is available as a supervised MDM control.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "The user must either remove all members from the Family Group on the iPhone and iPad or associate the device with an Apple ID that is not a member of a Family Group."
  reference   : "800-171|3.4.2,800-171|3.5.2,800-53|CM-6b.,800-53|CM-6(1),800-53|IA-5(14),800-53r5|CM-6b.,800-53r5|CM-6(1),800-53r5|IA-5(14),CAT|III,CCI|CCI-000366,CCI|CCI-000370,CCI|CCI-002008,CN-L3|8.1.10.6(d),CSF|PR.AC-1,CSF|PR.IP-1,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|CM-6b.,ITSG-33|CM-6(1),ITSG-33|IA-5,NESA|T3.2.1,NESA|T5.2.3,NIAv2|NS5f,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-228762r852632_rule,STIG-ID|AIOS-14-010000,SWIFT-CSCv1|2.3,Vuln-ID|V-228762"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
</report>

<report type:"WARNING">
  description : "AIOS-14-010100 - Apple iOS/iPadOS must implement the management setting: not share location data through iCloud."
  info        : "Sharing of location data is an operations security (OPSEC) risk because it potentially allows an adversary to determine a DoD user's location, movements, and patterns in those movements over time. An adversary could use this information to target the user or to gather intelligence on the user's likely activities. Using commercial cloud services to store and handle location data could leave the data vulnerable to breach, particularly by sophisticated adversaries. Disabling the use of such services mitigates this risk.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "The user must configure Apple iOS/iPadOS to disable location sharing through iCloud."
  reference   : "800-171|3.1.9,800-53|AC-8a.,800-53r5|AC-8a.,CAT|II,CCI|CCI-000048,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-8a.,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,Rule-ID|SV-228763r561046_rule,STIG-ID|AIOS-14-010100,TBA-FIISB|45.2.4,Vuln-ID|V-228763"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
</report>

<report type:"WARNING">
  description : "AIOS-14-010200 - Apple iOS/iPadOS must implement the management setting: force Apple Watch wrist detection."
  info        : "Because Apple Watch is a personal device, it is key that any sensitive DoD data displayed on the Apple Watch not be viewable when the watch is not in the immediate possession of the user. This control ensures the Apple Watch screen locks when the user takes the watch off, thereby protecting sensitive DoD data from possible exposure.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Install a configuration profile to force Apple Watch wrist detection."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|III,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-228764r561031_rule,STIG-ID|AIOS-14-010200,SWIFT-CSCv1|2.3,Vuln-ID|V-228764"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
</report>

<report type:"WARNING">
  description : "AIOS-14-010300 - Apple iOS/iPadOS users must complete required training."
  info        : "The security posture on iOS devices requires the device user to configure several required policy rules on their device. User Based Enforcement (UBE) is required for these controls. In addition, if the AO has approved users' full access to the Apple App Store, then users must receive training on risks. If a user is not aware of their responsibilities and does not comply with UBE requirements, the security posture of the iOS mobile device and DoD-sensitive data may become compromised.

SFR ID: NA

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Have all iPhone and iPad users complete training on the following topics. Users must acknowledge receipt of training via a signed User Agreement or similar written record.

Training Topics:
-Operational security concerns introduced by unmanaged applications including applications utilizing global positioning system (GPS) tracking
-Must ensure no DoD data is saved in an unmanaged app or transmitted from a personal app (for example, from personal email)
-If the Purebred key management app is used, users are responsible for maintaining positive control of their credentialed device at all times. The DoD PKI certificate policy requires subscribers to maintain positive control of the devices that contain private keys, and to report any loss of control so the credentials can be revoked. Upon device retirement, turn in, or reassignment, ensure a factory data reset is performed prior to device hand off. Follow mobility service provider decommissioning procedures as applicable.
-How to configure the following User Based Enforcement (UBE) controls (users must configure the control) and other controls on the iPhone and iPad:
**Remove Family Sharing
**Disable Shared Location
**Disable Wi-Fi Assist
**Use AirPrint only with AO-approved printers and print servers (see the Multifunction Device STIG for requirements)
**Turn off 'Apps' under 'AUTOMATIC DOWNLOADS' in the 'iTunes & App Store' section of the Settings app on the iPhone and iPad
**Secure use of Calendar Alarm
**Do not configure a DoD network (work) VPN profile on any third-party unmanaged VPN app
**iPhone and iPad radios should be disabled using controls under 'Settings' instead of 'Control Center'
-AO guidance on acceptable use and restrictions, if any, on downloading and installing personal apps and data (music, photos, etc.)"
  reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6b.,800-53|CM-6(1),800-53|CM-7a.,800-53r5|CM-6b.,800-53r5|CM-6(1),800-53r5|CM-7a.,CAT|II,CCI|CCI-000366,CCI|CCI-000370,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,ITSG-33|CM-6(1),ITSG-33|CM-7a.,NESA|T3.2.1,NIAv2|NS5f,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-228765r561031_rule,STIG-ID|AIOS-14-010300,SWIFT-CSCv1|2.3,Vuln-ID|V-228765"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
</report>

<report type:"WARNING">
  description : "AIOS-14-010400 - A managed photo app must be used to take and store work-related photos."
  info        : "The iOS Photos app is unmanaged and may sync photos with a device user's personal iCloud account. Therefore, work-related photos should not be taken via the iOS camera app or stored in the Photos app. A managed photo app should be used to take and manage work-related photos.

SFR ID: NA

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Install a managed photos app to take and manage work-related photos."
  reference   : "800-171|3.1.21,800-53|AC-20(2),800-53r5|AC-20(2),CAT|II,CCI|CCI-000097,CSF|ID.AM-4,CSF|PR.AC-3,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-20(2),NESA|M1.3.5,NESA|T1.2.3,QCSC-v1|3.2,QCSC-v1|5.2.2,Rule-ID|SV-228766r561031_rule,STIG-ID|AIOS-14-010400,SWIFT-CSCv1|2.5,Vuln-ID|V-228766"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
</report>

<report type:"WARNING">
  description : "AIOS-14-010600 - Apple iOS/iPadOS must implement the management setting: enable USB Restricted Mode."
  info        : "The USB lightning port on an iOS device can be used to access data on the device. The required settings ensure the Apple device password is entered before a previously trusted USB accessory can connect to the device.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Install a configuration profile to disable the allow USB Restricted Mode in the management tool. This a supervised-only control.

Note: This control is called 'Allow USB accessories while device is locked' in Apple Configurator and the control logic is opposite to what is listed here. Make sure the MDM policy rule is set correctly (to disable USB accessory connections when the device is locked)."
  reference   : "800-171|3.1.21,800-171|3.4.2,800-53|AC-20(2),800-53|CM-6b.,800-53|CM-6(1),800-53r5|AC-20(2),800-53r5|CM-6b.,800-53r5|CM-6(1),CAT|II,CCI|CCI-000097,CCI|CCI-000366,CCI|CCI-000370,CN-L3|8.1.10.6(d),CSF|ID.AM-4,CSF|PR.AC-3,CSF|PR.IP-1,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-20(2),ITSG-33|CM-6b.,ITSG-33|CM-6(1),NESA|M1.3.5,NESA|T1.2.3,NESA|T3.2.1,NIAv2|NS5f,QCSC-v1|3.2,QCSC-v1|5.2.2,Rule-ID|SV-228767r561031_rule,STIG-ID|AIOS-14-010600,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,Vuln-ID|V-228767"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
</report>

<report type:"WARNING">
  description : "AIOS-14-010700 - Apple iOS/iPadOS must not allow managed apps to write contacts to unmanaged contacts accounts."
  info        : "Managed apps have been approved for the handling of DoD-sensitive information. Unmanaged apps are provided for productivity and morale purposes but are not approved to handle DoD-sensitive information. Examples of unmanaged apps include apps for news services, travel guides, maps, and social networking. If a document were to be viewed in a managed app and the user had the ability to open this same document in an unmanaged app, this could lead to the compromise of sensitive DoD data. In some cases, the unmanaged apps are connected to cloud backup or social networks that would permit dissemination of DoD-sensitive information to unauthorized individuals. Not allowing data to be opened within unmanaged apps mitigates the risk of compromising sensitive data.

SFR ID: FMT_SMF_EXT.1.1 #42, FDP_ACF_EXT.1.2

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Install a configuration profile to prevent managed apps writing contacts to unmanaged contacts."
  reference   : "800-171|3.1.9,800-171|3.4.2,800-53|AC-8a.,800-53|CM-6b.,800-53|CM-6(1),800-53r5|AC-8a.,800-53r5|CM-6b.,800-53r5|CM-6(1),CAT|III,CCI|CCI-000051,CCI|CCI-000366,CCI|CCI-000370,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-8a.,ITSG-33|CM-6b.,ITSG-33|CM-6(1),NESA|M5.2.5,NESA|T3.2.1,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,NIAv2|NS5f,Rule-ID|SV-228768r561031_rule,STIG-ID|AIOS-14-010700,SWIFT-CSCv1|2.3,TBA-FIISB|45.2.4,Vuln-ID|V-228768"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
</report>

<report type:"WARNING">
  description : "AIOS-14-010800 - Apple iOS/iPadOS must not allow unmanaged apps to read contacts from managed contacts accounts."
  info        : "Managed apps have been approved for the handling of DoD-sensitive information. Unmanaged apps are provided for productivity and morale purposes but are not approved to handle DoD-sensitive information. Examples of unmanaged apps include apps for news services, travel guides, maps, and social networking. If a document were to be viewed in a managed app and the user had the ability to open this same document in an unmanaged app, this could lead to the compromise of sensitive DoD data. In some cases, the unmanaged apps are connected to cloud backup or social networks that would permit dissemination of DoD-sensitive information to unauthorized individuals. Not allowing data to be opened within unmanaged apps mitigates the risk of compromising sensitive data.

SFR ID: FMT_SMF_EXT.1.1 #42, FDP_ACF_EXT.1.2

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Install a configuration profile to prevent unmanaged apps to read contacts from managed contacts accounts."
  reference   : "800-171|3.1.9,800-171|3.4.2,800-53|AC-8a.,800-53|CM-6b.,800-53|CM-6(1),800-53r5|AC-8a.,800-53r5|CM-6b.,800-53r5|CM-6(1),CAT|III,CCI|CCI-000051,CCI|CCI-000366,CCI|CCI-000370,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-8a.,ITSG-33|CM-6b.,ITSG-33|CM-6(1),NESA|M5.2.5,NESA|T3.2.1,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,NIAv2|NS5f,Rule-ID|SV-228769r561031_rule,STIG-ID|AIOS-14-010800,SWIFT-CSCv1|2.3,TBA-FIISB|45.2.4,Vuln-ID|V-228769"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
</report>

<custom_item>
  type           : CONFIGURATION_INFO
  description    : "AIOS-14-010900 - Apple iOS/iPadOS must implement the management setting: disable AirDrop."
  info           : "An Airdrop feature is a way to send contact information or photos to other users with this same feature enabled. This feature enables a possible attack vector for adversaries to exploit. Once the attacker has gained access to the information broadcast by this feature, he/she may distribute this sensitive information very quickly and without DoD's control or awareness. By disabling this feature, the risk of mass data exfiltration will be mitigated.

Note: If the site uses Apple's optional Device Enrollment Program (DEP), this control is available as a supervised MDM control.

SFR ID: FMT_SMF_EXT.1.1 #47"
  solution       : "If the AO has not approved the use of AirDrop for unmanaged data transfer, install a configuration profile to disable the AllowAirDrop control in the management tool. This a supervised-only control."
  reference      : "800-171|3.1.21,800-171|3.4.2,800-53|AC-20(2),800-53|CM-6b.,800-53|CM-6(1),800-53r5|AC-20(2),800-53r5|CM-6b.,800-53r5|CM-6(1),CAT|III,CCI|CCI-000097,CCI|CCI-000366,CCI|CCI-000370,CN-L3|8.1.10.6(d),CSF|ID.AM-4,CSF|PR.AC-3,CSF|PR.IP-1,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-20(2),ITSG-33|CM-6b.,ITSG-33|CM-6(1),NESA|M1.3.5,NESA|T1.2.3,NESA|T3.2.1,NIAv2|NS5f,QCSC-v1|3.2,QCSC-v1|5.2.2,Rule-ID|SV-228770r561031_rule,STIG-ID|AIOS-14-010900,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,Vuln-ID|V-228770"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
  json_transform : '.[] | select(.appType=="RESTRICTION") | "Restriction: " + .name + " - Allow AirDrop = \(.properties.LOCKDOWN_AIRDROP // "Not Defined")"'
  regex          : "Allow AirDrop ="
  expect         : "Allow AirDrop = False"
</custom_item>

<report type:"WARNING">
  description : "AIOS-14-011000 - Apple iOS/iPadOS must implement the management setting: disable paired Apple Watch."
  info        : "The STIG requires AO approval before an Apple Watch (DoD-owned or personally owned) can be paired with a DoD-owned iPhone to insure the AO has evaluated the risk in having sensitive DoD data transferred to and stored on an Apple Watch in their operational environment.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "If the AO has not approved the use of Apple Watch with DoD-owned iPhones, install a configuration profile to disable the Apple Watch control in the management tool. This a supervised-only control."
  reference   : "800-171|3.1.21,800-171|3.4.2,800-53|AC-20(2),800-53|CM-6b.,800-53|CM-6(1),800-53r5|AC-20(2),800-53r5|CM-6b.,800-53r5|CM-6(1),CAT|II,CCI|CCI-000097,CCI|CCI-000366,CCI|CCI-000370,CN-L3|8.1.10.6(d),CSF|ID.AM-4,CSF|PR.AC-3,CSF|PR.IP-1,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-20(2),ITSG-33|CM-6b.,ITSG-33|CM-6(1),NESA|M1.3.5,NESA|T1.2.3,NESA|T3.2.1,NIAv2|NS5f,QCSC-v1|3.2,QCSC-v1|5.2.2,Rule-ID|SV-228771r561031_rule,STIG-ID|AIOS-14-011000,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,Vuln-ID|V-228771"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
</report>

<report type:"WARNING">
  description : "AIOS-14-011100 - Apple iOS/iPadOS must disable Password AutoFill in browsers and applications."
  info        : "The AutoFill functionality in browsers and applications allows the user to complete a form that contains sensitive information, such as PII, without previous knowledge of the information. By allowing the use of the AutoFill functionality, an adversary who learns a user's iPhone and iPad passcode, or who otherwise is able to unlock the device, may be able to further breach other systems by relying on the AutoFill feature to provide information unknown to the adversary. By disabling the AutoFill functionality, the risk of an adversary gaining further information about the device's user or compromising other systems is significantly mitigated.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Install a configuration profile to disable the allow Password AutoFill in the management tool. This a supervised-only control."
  reference   : "800-171|3.1.21,800-171|3.4.2,800-53|AC-20(2),800-53|CM-6b.,800-53|CM-6(1),800-53r5|AC-20(2),800-53r5|CM-6b.,800-53r5|CM-6(1),CAT|II,CCI|CCI-000097,CCI|CCI-000366,CCI|CCI-000370,CN-L3|8.1.10.6(d),CSF|ID.AM-4,CSF|PR.AC-3,CSF|PR.IP-1,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-20(2),ITSG-33|CM-6b.,ITSG-33|CM-6(1),NESA|M1.3.5,NESA|T1.2.3,NESA|T3.2.1,NIAv2|NS5f,QCSC-v1|3.2,QCSC-v1|5.2.2,Rule-ID|SV-228772r561031_rule,STIG-ID|AIOS-14-011100,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,Vuln-ID|V-228772"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
</report>

<report type:"WARNING">
  description : "AIOS-14-011200 - Apple iOS/iPadOS must disable allow setting up new nearby devices."
  info        : "This control allows Apple device users to request passwords from nearby devices. This could lead to a compromise of the device password with an unauthorized person or device. DoD Apple device passwords should not be shared.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Install a configuration profile to disable the allow setting up new nearby devices in the management tool. This a supervised-only control."
  reference   : "800-171|3.1.21,800-171|3.4.2,800-53|AC-20(2),800-53|CM-6b.,800-53|CM-6(1),800-53r5|AC-20(2),800-53r5|CM-6b.,800-53r5|CM-6(1),CAT|II,CCI|CCI-000097,CCI|CCI-000366,CCI|CCI-000370,CN-L3|8.1.10.6(d),CSF|ID.AM-4,CSF|PR.AC-3,CSF|PR.IP-1,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-20(2),ITSG-33|CM-6b.,ITSG-33|CM-6(1),NESA|M1.3.5,NESA|T1.2.3,NESA|T3.2.1,NIAv2|NS5f,QCSC-v1|3.2,QCSC-v1|5.2.2,Rule-ID|SV-228773r561031_rule,STIG-ID|AIOS-14-011200,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,Vuln-ID|V-228773"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
</report>

<report type:"WARNING">
  description : "AIOS-14-011300 - Apple iOS/iPadOS must disable password proximity requests."
  info        : "This control allows one Apple device to be notified to share its password with a nearby device. This could lead to a compromise of the device password with an unauthorized person or device. DoD Apple device passwords should not be shared.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Install a configuration profile to disable the allow password proximity requests in the management tool. This a supervised-only control."
  reference   : "800-171|3.1.21,800-171|3.4.2,800-53|AC-20(2),800-53|CM-6b.,800-53|CM-6(1),800-53r5|AC-20(2),800-53r5|CM-6b.,800-53r5|CM-6(1),CAT|II,CCI|CCI-000097,CCI|CCI-000366,CCI|CCI-000370,CN-L3|8.1.10.6(d),CSF|ID.AM-4,CSF|PR.AC-3,CSF|PR.IP-1,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-20(2),ITSG-33|CM-6b.,ITSG-33|CM-6(1),NESA|M1.3.5,NESA|T1.2.3,NESA|T3.2.1,NIAv2|NS5f,QCSC-v1|3.2,QCSC-v1|5.2.2,Rule-ID|SV-228774r561031_rule,STIG-ID|AIOS-14-011300,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,Vuln-ID|V-228774"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
</report>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "AIOS-14-011400 - Apple iOS/iPadOS must disable password sharing."
  info           : "This control allows sharing passwords between Apple devices using AirDrop. This could lead to a compromise of the device password with an unauthorized person or device. DoD Apple device passwords should not be shared.

SFR ID: FMT_SMF_EXT.1.1 #47"
  solution       : "Install a configuration profile to disable the allow password proximity sharing in the management tool. This a supervised-only control."
  reference      : "800-171|3.1.21,800-171|3.4.2,800-53|AC-20(2),800-53|CM-6b.,800-53|CM-6(1),800-53r5|AC-20(2),800-53r5|CM-6b.,800-53r5|CM-6(1),CAT|II,CCI|CCI-000097,CCI|CCI-000366,CCI|CCI-000370,CN-L3|8.1.10.6(d),CSF|ID.AM-4,CSF|PR.AC-3,CSF|PR.IP-1,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-20(2),ITSG-33|CM-6b.,ITSG-33|CM-6(1),NESA|M1.3.5,NESA|T1.2.3,NESA|T3.2.1,NIAv2|NS5f,QCSC-v1|3.2,QCSC-v1|5.2.2,Rule-ID|SV-228775r561031_rule,STIG-ID|AIOS-14-011400,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,Vuln-ID|V-228775"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
  json_transform : '.[] | select((.type == "Apple") and (.General.IsActive == "true")) | "Policy: " + .General.Name + " - Enable Allow Password Sharing = \(.Restriction.AllowPasswordSharing // "not defined")"'
  regex          : "Enable Allow Password Sharing ="
  expect         : "Enable Allow Password Sharing = false"
</custom_item>

<report type:"WARNING">
  description : "AIOS-14-011500 - Apple iOS/iPadOS must disable Find My Friends in the Find My app."
  info        : "This control does not share a DoD user's location, but encourages location sharing between DoD mobile device users, which can lead to OPSEC risks. Sharing the location of a DoD mobile device is a violation of AIOS-13-011900.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Install a configuration profile to disable 'Find My Friends'  in the Find My app and 'Allow modifying Find My Friends' in the management tool. This a supervised-only control."
  reference   : "800-171|3.1.21,800-171|3.4.2,800-53|AC-20(2),800-53|CM-6b.,800-53|CM-6(1),800-53r5|AC-20(2),800-53r5|CM-6b.,800-53r5|CM-6(1),CAT|III,CCI|CCI-000097,CCI|CCI-000366,CCI|CCI-000370,CN-L3|8.1.10.6(d),CSF|ID.AM-4,CSF|PR.AC-3,CSF|PR.IP-1,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-20(2),ITSG-33|CM-6b.,ITSG-33|CM-6(1),NESA|M1.3.5,NESA|T1.2.3,NESA|T3.2.1,NIAv2|NS5f,QCSC-v1|3.2,QCSC-v1|5.2.2,Rule-ID|SV-228776r561031_rule,STIG-ID|AIOS-14-011500,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,Vuln-ID|V-228776"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
</report>

<report type:"WARNING">
  description : "AIOS-14-011600 - The Apple iOS/iPadOS must be supervised by the MDM."
  info        : "When an iOS/iPadOS is not supervised, the DoD mobile service provider cannot control when new iOS/iPadOS updates are installed on site managed devices. Most updates should be installed immediately to mitigate new security vulnerabilities, while some sites need to test each update prior to installation to insure critical missions are not adversely impacted by the update.

Also, several password and data protection controls can only be implemented when an Apple device is supervised.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Use one of the following methods to supervise iOS and iPadOS devices managed by the DoD mobile service provider.

Method 1:
-Register all current and new iOS and iPadOS devices in the DoD mobile service provider's Device Enrollment Program (DEP)/Apple Business Manager (ABM) account.
-Enable Supervision of managed iOS/iPadOS devices in the MDM.

Method 2:
-Configure each iOS/iPadOS device using the Apple Configurator tool for Supervision. This method is usually only appropriate when MDM management of the DoD Apple device is not appropriate or an older device cannot be registered in DEP/ABM."
  reference   : "800-171|3.1.21,800-171|3.4.2,800-53|AC-20(2),800-53|CM-6b.,800-53|CM-6(1),800-53r5|AC-20(2),800-53r5|CM-6b.,800-53r5|CM-6(1),CAT|II,CCI|CCI-000097,CCI|CCI-000366,CCI|CCI-000370,CN-L3|8.1.10.6(d),CSF|ID.AM-4,CSF|PR.AC-3,CSF|PR.IP-1,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-20(2),ITSG-33|CM-6b.,ITSG-33|CM-6(1),NESA|M1.3.5,NESA|T1.2.3,NESA|T3.2.1,NIAv2|NS5f,QCSC-v1|3.2,QCSC-v1|5.2.2,Rule-ID|SV-228777r561031_rule,STIG-ID|AIOS-14-011600,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,Vuln-ID|V-228777"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
</report>

<report type:"WARNING">
  description : "AIOS-14-011700 - Apple iOS/iPadOS must disable 'Allow USB drive access in Files app' if the AO has not approved the use of DoD-approved USB storage drives with iOS/iPadOS devices - Allow USB drive access in Files app if the AO has not approved the use of DoD-approved USB storage drives with iOS/iPadOS devices."
  info        : "Unauthorized use of USB storage drives could lead to the introduction of malware or unauthorized software into the DoD IT infrastructure and compromise of sensitive DoD information and systems.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "If the AO has not approved the use of USB drives to load files to Apple devices, install a configuration profile to disable 'Allow USB drive access in Files app'."
  reference   : "800-171|3.1.21,800-171|3.4.2,800-53|AC-20(2),800-53|CM-6b.,800-53|CM-6(1),800-53r5|AC-20(2),800-53r5|CM-6b.,800-53r5|CM-6(1),CAT|II,CCI|CCI-000097,CCI|CCI-000366,CCI|CCI-000370,CN-L3|8.1.10.6(d),CSF|ID.AM-4,CSF|PR.AC-3,CSF|PR.IP-1,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-20(2),ITSG-33|CM-6b.,ITSG-33|CM-6(1),NESA|M1.3.5,NESA|T1.2.3,NESA|T3.2.1,NIAv2|NS5f,QCSC-v1|3.2,QCSC-v1|5.2.2,Rule-ID|SV-228778r561031_rule,STIG-ID|AIOS-14-011700,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,Vuln-ID|V-228778"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
</report>

<custom_item>
  type           : CONFIGURATION_INFO
  description    : "AIOS-14-011800 - Apple iOS must be configured to disable automatic transfer of diagnostic data to an external device other than an MDM service with which the device has enrolled."
  info           : "Many software systems automatically send diagnostic data to the manufacturer or a third party. This data enables the developers to understand real-world field behavior and improve the product based on that information. Unfortunately, it can also reveal information about what DoD users are doing with the systems and what causes them to fail. An adversary embedded within the software development team or elsewhere could use the information acquired to breach mobile operating system security. Disabling automatic transfer of such information mitigates this risk.

SFR ID: FMT_SMF_EXT.1.1 #47a"
  solution       : "Install a configuration profile to disable sending diagnostic data to an organization other than DoD."
  reference      : "800-171|3.13.16,800-53|SC-28,800-53r5|SC-28,CAT|III,CCI|CCI-001199,CN-L3|8.1.4.7(b),CN-L3|8.1.4.8(b),CSF|PR.DS-1,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ITSG-33|SC-28,ITSG-33|SC-28a.,PCI-DSSv3.2.1|3.4,PCI-DSSv4.0|3.3.2,PCI-DSSv4.0|3.5.1,QCSC-v1|5.2.2,QCSC-v1|6.2,Rule-ID|SV-228779r561031_rule,STIG-ID|AIOS-14-011800,Vuln-ID|V-228779"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
  json_transform : '.[] | select(.appType=="RESTRICTION") | "Policy: " + .name + " - Allow Diagnostic Data To Sent To Apple = " + (.properties.ALLOW_DIAGNOSTICDATATOSENTTOAPPLE // "not defined" )'
  regex          : "Allow Diagnostic Data To Sent To Apple ="
  expect         : "Allow Diagnostic Data To Sent To Apple = false"
</custom_item>

<custom_item>
  type           : CONFIGURATION_INFO
  description    : "AIOS-14-011900 - Apple iOS must implement the management setting: not allow a user to remove Apple iOS configuration profiles that enforce DoD security requirements."
  info           : "Configuration profiles define security policies on Apple iOS devices. If a user is able to remove a configuration profile, the user can then change the configuration that had been enforced by that policy. Relaxing security policies may introduce vulnerabilities that the profiles had mitigated. Configuring a profile to never be removed mitigates this risk.

SFR ID: FMT_SMF_EXT.1.1 #47"
  solution       : "Configure the Apple iOS configuration profile such that it can never be removed.

The procedure for implementing this control will vary depending on the MDM/EMM used by the mobile service provider.

When using Apple Configurator, under 'General Security', configure 'Security' to 'Never' and 'Automatically Remove Profile' to 'Never'."
  reference      : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-228780r561031_rule,STIG-ID|AIOS-14-011900,SWIFT-CSCv1|2.3,Vuln-ID|V-228780"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
  json_transform : '.[] | select(.appType=="RESTRICTION") | "Policy: " + .name + " - Allow Config Profile Install = " + (.properties.ALLOW_UI_CONFIG_PROFILE_INSTALL // "not defined" )'
  regex          : "Allow Config Profile Install ="
  expect         : "Allow Config Profile Install = false"
</custom_item>

<report type:"WARNING">
  description : "AIOS-14-012700 - Apple iOS/iPadOS must disable [Allow network drive access in Files access]."
  info        : "Allowing network drive access by the Files app could lead to the introduction of malware or unauthorized software into the DoD IT infrastructure and compromise of sensitive DoD information and systems.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Install a configuration profile to disable 'Allow network drive access in Files access'."
  reference   : "800-171|3.1.21,800-171|3.4.2,800-53|AC-20(2),800-53|CM-6b.,800-53|CM-6(1),800-53r5|AC-20(2),800-53r5|CM-6b.,800-53r5|CM-6(1),CAT|II,CCI|CCI-000097,CCI|CCI-000366,CCI|CCI-000370,CN-L3|8.1.10.6(d),CSF|ID.AM-4,CSF|PR.AC-3,CSF|PR.IP-1,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-20(2),ITSG-33|CM-6b.,ITSG-33|CM-6(1),NESA|M1.3.5,NESA|T1.2.3,NESA|T3.2.1,NIAv2|NS5f,QCSC-v1|3.2,QCSC-v1|5.2.2,Rule-ID|SV-228781r561031_rule,STIG-ID|AIOS-14-012700,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,Vuln-ID|V-228781"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
</report>

<report type:"WARNING">
  description : "AIOS-14-999999 - All Apple iOS/iPadOS 14 installations must be removed."
  info        : "Apple iOS/iPadOS 14 is no longer supported by Apple and therefore, may contain security vulnerabilities.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Remove all installations of Apple iOS/iPadOS 14."
  reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|I,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_iOS_iPadOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-254529r859304_rule,STIG-ID|AIOS-14-999999,SWIFT-CSCv1|2.3,Vuln-ID|V-254529"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_iOS_iPadOS_14_V1R3_STIG.zip"
</report>

</check_type>
