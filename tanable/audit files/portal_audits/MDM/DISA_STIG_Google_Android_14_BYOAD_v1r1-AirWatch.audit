#TRUSTED 6215b582df76a5162fca42bdedbd2b814c245493fe1ccb259ba630e80711fcb0b4c48410a89dfc31ef807a0e6557c02a24c7c4dfcdc4f028104f7c3e9f8705c7bcac2de28552e3c49f20bb64a52b572184ef0480d7f68ada4beddd22680a21556e4082bc8379504528916732cfeefb04d243562b52fd8b7b2a656a895d3f216cfa9b39f86841c30601c3d8551d05f548a883947968b766efa8e5496099be25b5d226597c3897b6318206c446b00e91bd3bff89d0c610e3b65765a296dba40b8668e41e13d12d30dd1053eb39a1bb4cb49f09bbec9a0a684d0eeedcdf090888973cf4509e7f685b92aca03dae20b5fce495506ef89de997866a35036af81d859eb243b6f9082f57c8f58c39db838eef81e1f969466587e3b35f8b025a8f4773a41fab316bc44fc57b5d4343ffc3fb89de87b1488633be7bad72f8b4ae3bcd0dc63734730878790ada748ff54c16f077c19beb4fd7178068ccad45fae7ecba5befd86eb5c5eae7bb83f7f1d0f481167deac32318448ceecddc299a4f18de61aa4fdea8bf28f31548a57879cb815d47d19a2f6a8bdb6937ee019301b8badc03d40d0116d0790136be7f58cb565bfa263fe8f21f6f22c84c834a39a3e93d7d124a3c4e9dab19b088a3fe9a0973021eea9b06716d7b767c8eadaf31f5c79220526228d777e19e737caf46b3c162cd4ad4d12008deea9465ca6e7cd2f2657c26e91a41
#TRUST-RSA-SHA256 16256f423a314b26cc9edd6306b9245102b66235c68d2a0caacef84eb6f0935e7ad6dc6e600cff6183269dfefcd5165a3a549dc4982fc9b3c3736e51ceff053233e1837474d9f60fe9a428df60aa84a6f0d04f3eeadb0292a71dbf6c7e78438e3db3b3ba496572ed494c3f9097a5674c0427dd7c2f3a72a571335fd4024fd18b1bb9b44f09ab576b6664c8c0e672ca56e161b39d81922254b3feb2b1ac2c0823b511df422dff10c62d7682ff9ed67022f1456f7a8d2568f043d867ded7e408c72ee9b4bc234369dcd0964262843a0161c79120c8fc5d68f37460614064934042962bd5e013fae823e7534e98c6f1d034bda8e92b54678e6fc71b44522c03fb694e438cb69dbaf3c6cec02833376f009eea4c8378bd9ab2e7fbb5849c099f51c5313e940d4463694dacf82f98d045d8b880feabf8953eba7e4ea18e5712713f23e789f6511d1e86417b060c1e030d28ce4c17b4bed27b275c75ca47d224e70e65b438ab45c61e89ec2ab6526eb37e1dd765aeac75fe1ab70bfd7c45aac455bc78e314fa765048e28dbfc4c932e08d0152371d048785449406857d19fdf116b1e2f37b832725b38ab69b9ca8f219987b5e3dd4cc0b5a0b3f6d98d27f778451c2fe1970de234abb1417d45ec335380ad6529164fd4256f2166046da53ca3ec0d51415df6c7437f930808441033ee5c59d6d1a1903cb70d9e29bc51265967a0ac4ab
#
# This script is Copyright (C) 2004-2024 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
# $Revision: 1.0 $
# $Date: 2024/09/03 $
#
# Description : This document implements the security configuration as recommended by the
#               DISA Google Android 14 MDFPP 3.3 BYOAD v1r1 STIG.
#
#<ui_metadata>
#<display_name>AirWatch - DISA Google Android 14 BYOAD v1r1</display_name>
#<spec>
#  <type>DISA STIG</type>
#  <name>Google Android 14 BYOAD</name>
#  <profile>AirWatch</profile>
#  <version>1.1.0</version>
#  <link>https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Google_Android_14_BYOAD_Y24M03_STIG.zip</link>
#</spec>
#<labels>mdm,airwatch,android,google</labels>
#<benchmark_refs>CAT,CCE,CCI,DISA_Benchmark,Group-ID,Rule-ID,STIG-ID,STIG-Legacy,Vuln-ID</benchmark_refs>
#<variables>
#  <variable>
#    <name>WHITELIST</name>
#    <default>.*</default>
#    <description>Device Application Whitelist</description>
#    <info>This is a comma separated whitelist of applications. Only these applications may be present on the device. Use a variable value of '.*' if this check is N/A for your organization, otherwise use a format like 'application_name1,application_name2,etc'.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>BLACKLIST</name>
#    <default>!@#$%$#@!</default>
#    <description>Device Application Blacklist</description>
#    <info>This is a comma separated blacklist of applications. None of these applications may be present on the device. Use a variable value of !@#$%$#@!' if this check is N/A for your organization, otherwise use a format like 'application_name1,application_name2,etc'.</info>
#    <value_type>STRING</value_type>
#  </variable>
#</variables>
#</ui_metadata>

<check_type:"MDM" mdm_type:AIRWATCH>

<report type:"WARNING">
  description : "GOOG-14-701100 - Google Android 14 must prohibit DOD VPN profiles in the Personal Profile."
  info        : "If DOD VPN profiles are configured in the Personal Profile DOD sensitive data world be at risk of compromise and the DOD network could be at risk of being attacked by malware installed on the device.

SFR ID: FMT_SMF_EXT.1.1 #3

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Do not configure DOD VPN profiles in the Personal Profile. If there is a DOD VPN profile configured in the Personal Profile, remove it."
  reference   : "800-171|3.4.2,800-53|CM-6b.,800-53|CM-6(1),800-53r5|CM-6b.,800-53r5|CM-6(1),CAT|II,CCI|CCI-000366,CCI|CCI-000370,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Google_Android_14_MDF_PP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,ITSG-33|CM-6(1),NESA|T3.2.1,NIAv2|NS5f,Rule-ID|SV-260082r948451_rule,STIG-ID|GOOG-14-701100,SWIFT-CSCv1|2.3,Vuln-ID|V-260082"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Google_Android_14_BYOAD_Y24M03_STIG.zip"
</report>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "GOOG-14-706000 - Google Android 14 must be configured to enforce a minimum password length of six characters and not allow passwords that include more than four repeating or sequential characters."
  info           : "Password strength is a measure of the effectiveness of a password in resisting guessing and brute force attacks. The ability to crack a password is a function of how many attempts an adversary is permitted, how quickly an adversary can do each attempt, and the size of the password space. The longer the minimum length of the password is, the larger the password space. Having a too-short minimum password length significantly reduces password strength, increasing the chance of password compromise and resulting device and data compromise.

Satisfies: PP-MDF-333024,PP-MDF-333025

SFR ID: FMT_SMF_EXT.1.1 #1a"
  solution       : "Configure the Google Android 14 device to enforce high password quality for the device and standard DOD password complexity rules for the Work Profile (at least six-character length and prevent passwords from containing more than four repeating or sequential characters). In addition, enable OneLock so the user only must enter their device password to unlock the Work Profile. Note: enabling OneLock is optional and is a two-step process: configuration on the EMM and configuration by the user on the phone. If OneLock is not used, the user will always need to enter separate passwords to unlock the device and to unlock the Work Profile.

1. Set the password on the whole device:
Set device password complexity to 'HIGH' (requires (at minimum) an eight numeric character password, or six alphabetic character password, or a six alphanumeric character password).

On the EMM console, do the following:

a. Open 'Lock screen' settings.
b. Open 'Set required password complexity on parent'.
c. Select 'High'.

2. Set DOD password for the Work Profile.

On the EMM console, do the following:
a. Open 'Lock screen' settings.
b. Open 'Password constraints'.
c. Open 'Minimum password quality'.
d. Choose Numeric Complex, Alphabetic, Alphanumeric, or Complex.
e. Open 'Minimum password length'.
f. Enter in the number of characters as '6'.

3. Enable OneLock on the EMM.

On the MDM console, do the following:
a. Disable the following Android API: 'DISALLOW_UNIFIED_PASSWORD'. The exact procedure will depend on the EMM product.
Note: this control may be called 'Require separate challenge'.

4. Train users to implement OneLock with the following User Based Enforcement (UBE): procedure:

a. Open Settings >> Security & privacy >> More security settings.
b. Enable 'Use one lock'."
  reference      : "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(a),CAT|II,CCI|CCI-000205,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|Google_Android_14_MDF_PP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-260126r953765_rule,STIG-ID|GOOG-14-706000,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-260126"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Google_Android_14_BYOAD_Y24M03_STIG.zip"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                  "Profile: " + .General.Name + " - Passcode Length = \(.Passcode.MinimumPasscodeLength? // "Not Defined")"'
  regex          : "Passcode Length ="
  expect         : "Passcode Length = ([6-9]|[1-8][0-9]|9[0-9])"
  match_all      : YES
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "GOOG-14-706200 - Google Android 14 must be configured to enable a screen-lock policy that will lock the display after a period of inactivity."
  info           : "The screen-lock timeout helps protect the device from unauthorized access. Devices without a screen-lock timeout provide an opportunity for adversaries who gain physical access to the mobile device through loss, theft, etc. Such devices are much more likely to be in an unlocked state when acquired by an adversary, thus granting immediate access to the data on the mobile device and possibly access to DOD networks.

SFR ID: FMT_SMF_EXT.1.1 #2a"
  solution       : "Configure the Google Android 14 device to enable a screen-lock policy that will lock the display after a period of inactivity.

On the EMM Console:

1. Open 'Lock screen' settings.
2. Open 'Lock screen restrictions'.
3. Set 'Max time to screen lock' to any number desired.
Note: The units are in seconds."
  reference      : "800-171|3.1.10,800-53|AC-11a.,800-53r5|AC-11a.,CAT|II,CCI|CCI-000057,CN-L3|8.1.4.1(b),DISA_Benchmark|Google_Android_14_MDF_PP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11a.,NESA|T2.3.8,NESA|T2.3.9,NIAv2|AM23a,NIAv2|AM23b,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,Rule-ID|SV-260127r948586_rule,STIG-ID|GOOG-14-706200,Vuln-ID|V-260127"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Google_Android_14_BYOAD_Y24M03_STIG.zip"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                  "Profile: " + .General.Name + " - Security Inactivity Timeout = \(.Passcode.DeviceLockTimeoutInMinutes? // "Not Defined")"'
  regex          : "Security Inactivity Timeout ="
  expect         : "Security Inactivity Timeout = [0-9]+"
  match_all      : YES
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "GOOG-14-706300 - Google Android 14 must be configured to lock the display after 15 minutes (or less) of inactivity - or less of inactivity."
  info           : "The screen lock timeout must be set to a value that helps protect the device from unauthorized access. Having a too-long timeout would increase the window of opportunity for adversaries who gain physical access to the mobile device through loss, theft, etc. Such devices are much more likely to be in an unlocked state when acquired by an adversary, thus granting immediate access to the data on the mobile device. The maximum timeout period of 15 minutes has been selected to balance functionality and security; shorter timeout periods may be appropriate depending on the risks posed to the mobile device.

SFR ID: FMT_SMF_EXT.1.1 #2b"
  solution       : "Configure the Google Android 14 device to enable a screen-lock policy of 15 minutes for the max period of inactivity.

Note: Google Android 14 does not support the 15 minute increment. The available allowable selection is 10 minutes, then increases to 30 minutes. Therefore, the control will be set to 10 minutes.

On the EMM Console:

1. Open 'Lock screen restrictions'.
2. Set 'Max time to screen lock' to '600'.
Note: The units are in seconds."
  reference      : "800-171|3.1.10,800-53|AC-11a.,800-53r5|AC-11a.,CAT|II,CCI|CCI-000057,CN-L3|8.1.4.1(b),DISA_Benchmark|Google_Android_14_MDF_PP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11a.,NESA|T2.3.8,NESA|T2.3.9,NIAv2|AM23a,NIAv2|AM23b,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,Rule-ID|SV-260128r948589_rule,STIG-ID|GOOG-14-706300,Vuln-ID|V-260128"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Google_Android_14_BYOAD_Y24M03_STIG.zip"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                  "Profile: " + .General.Name + " - Security Inactivity Timeout = \(.Passcode.DeviceLockTimeoutInMinutes? // "Not Defined")"'
  regex          : "Security Inactivity Timeout ="
  expect         : "Security Inactivity Timeout = 600"
  match_all      : YES
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "GOOG-14-706400 - Google Android 14 must be configured to not allow more than 10 consecutive failed authentication attempts."
  info           : "The more attempts an adversary makes to guess a password, the more likely the adversary will enter the correct password and gain access to resources on the device. Setting a limit on the number of attempts mitigates this risk. Setting the limit at 10 or less gives authorized users the ability to make a few mistakes when entering the password but still provides adequate protection against dictionary or brute force attacks on the password.

SFR ID: FMT_SMF_EXT.1.1 #2c, FIA_AFL_EXT.1.5"
  solution       : "Configure the Google Android 14 device to allow only 10 or fewer consecutive failed authentication attempts.
Note: Work Profile will be wiped.

On the EMM Console:

1. Open 'Lock screen' settings.
2. Open 'Lock screen restrictions'.
3. Set 'Max password failures for local wipe' to a number between 1 and 10."
  reference      : "800-171|3.1.8,800-53|AC-7a.,800-53r5|AC-7a.,CAT|II,CCI|CCI-000044,CN-L3|8.1.4.1(b),CSF2.0|PR.AA-03,DISA_Benchmark|Google_Android_14_MDF_PP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-7a.,NESA|T5.5.1,NIAv2|AM24,PCI-DSSv3.2.1|8.1.6,PCI-DSSv4.0|8.3.4,Rule-ID|SV-260129r948592_rule,STIG-ID|GOOG-14-706400,TBA-FIISB|45.1.2,TBA-FIISB|45.2.1,TBA-FIISB|45.2.2,Vuln-ID|V-260129"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Google_Android_14_BYOAD_Y24M03_STIG.zip"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                  "Profile: " + .General.Name + " - Failed Authentication Attempts = \(.Passcode.MaximumNumberOfFailedAttempts? // "Not Defined")"'
  regex          : "Failed Authentication Attempts ="
  expect         : "Failed Authentication Attempts = ([1-9]|10)"
  match_all      : YES
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "GOOG-14-706500 - Google Android 14 must be configured to enforce an application installation policy by specifying one or more authorized application repositories."
  info           : "Forcing all applications to be installed from authorized application repositories can prevent unauthorized and malicious applications from being installed and executed on mobile devices. Allowing such installations and executions could cause a compromise of DOD data accessible by these unauthorized/malicious applications.

SFR ID: FMT_SMF_EXT.1.1 #8a"
  solution       : "Configure the Google Android 14 device to disable unauthorized application repositories.

On the EMM Console:

1. Open 'Set user restrictions'.
2. Toggle 'Disallow install unknown sources' to 'ON'.
3. Toggle 'Disallow installs from unknown sources globally' to 'ON'."
  reference      : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Google_Android_14_MDF_PP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-260130r948595_rule,STIG-ID|GOOG-14-706500,SWIFT-CSCv1|2.3,Vuln-ID|V-260130"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Google_Android_14_BYOAD_Y24M03_STIG.zip"
  json_transform : '.[] | select((.type == "Android") and (.General.IsActive == "true")) | "Policy: " + .General.Name + " - Allow Non Market App Installation = \(if (.Restriction.Restriction) then "not defined" else (.Restriction.AllowNonMarketAppInstallation // "not defined") end)"'
  regex          : "Allow Non Market App Installation ="
  expect         : "Allow Non Market App Installation = false"
  match_all      : YES
</custom_item>

<custom_item>
  type           : APP_INFO_BY_DEVICE
  description    : "GOOG-14-706600 - Google Android 14 must be configured to enforce an application installation policy by specifying an application allowlist that restricts applications by the following characteristics: [selection: list of digital signatures, cryptographic hash values, names, application version]."
  info           : "The application allowlist, in addition to controlling the installation of applications on the MD, must control user access/execution of all core and preinstalled applications, or the MD must provide an alternate method of restricting user access/execution to core and preinstalled applications.

Core application: Any application integrated into the OS by the OS or MD vendors.

Preinstalled application: Additional noncore applications included in the OS build by the OS vendor, MD vendor, or wireless carrier.

Requiring all authorized applications to be in an application allowlist prevents the execution of any applications (e.g., unauthorized, malicious) that are not part of the allowlist. Failure to configure an application allowlist properly could allow unauthorized and malicious applications to be downloaded, installed, and executed on the mobile device, causing a compromise of DOD data accessible by these applications.

The application allowlist, in addition to controlling the installation of applications on the MD, must control user access/execution of all core applications (included in the OS by the OS vendor) and preinstalled applications (provided by the MD vendor and wireless carrier), or the MD must provide an alternate method of restricting user access/execution to core and preinstalled applications.

SFR ID: FMT_SMF_EXT.1.1 #8b"
  solution       : "Configure the Google Android 14 device to use an application allowlist.

On the EMM Console:

1. Go to the Android app catalog for managed Google Play.
2. Select apps to be available (only approved apps).
3. Push updated policy to the device.

Note: Managed Google Play is an allowed App Store."
  reference      : "800-171|3.4.7,800-53|CM-7(2),800-53r5|CM-7(2),CAT|II,CCI|CCI-001764,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|PR.PS-01,DISA_Benchmark|Google_Android_14_MDF_PP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7(2),NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,Rule-ID|SV-260131r948598_rule,STIG-ID|GOOG-14-706600,SWIFT-CSCv1|2.3,Vuln-ID|V-260131"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Google_Android_14_BYOAD_Y24M03_STIG.zip"
  json_transform : '(.apps | map(.ApplicationName + " " + .Version)) | whitelist |
                if (length > 0) then
                   hostname + " has one or more non-whitelisted item(s):\n  - " + join("\n  - ")
                else
                   hostname + " All items were whitelisted."
                end'
  regex          : ''
  expect         : 'All items were whitelisted.'
  bw_list        : "@WHITELIST@"
</custom_item>

<custom_item>
  type           : APP_INFO_BY_DEVICE
  description    : "GOOG-14-706700 - Google Android 14 allowlist must be configured to not include applications with the following characteristics (work profile only):"
  info           : "1. Back up mobile device (MD) data to non-DOD cloud servers (including user and application access to cloud backup services);
2. Transmit MD diagnostic data to non-DOD servers;
3. Voice assistant application if available when MD is locked;
4. Voice dialing application if available when MD is locked;
5. Allows synchronization of data or applications between devices associated with user; and
6. Allows unencrypted (or encrypted but not FIPS 140-3 validated) data sharing with other MDs or printers.
7. Apps which backup their own data to a remote system - work profile only:

Requiring all authorized applications to be in an application allowlist prevents the execution of any applications (e.g., unauthorized, malicious) that are not part of the allowlist. Failure to configure an application allowlist properly could allow unauthorized and malicious applications to be downloaded, installed, and executed on the mobile device, causing a compromise of DOD data accessible by these applications. Applications with the listed characteristics have features that can cause the compromise of sensitive DOD data or have features with no known application in the DOD environment.

Application Note: The application allowlist, in addition to controlling the installation of applications on the MD, must control user access/execution of all core and preinstalled applications, or the MD must provide an alternate method of restricting user access/execution to core and preinstalled applications.

Core application: Any application integrated into the OS by the OS or MD vendors.

Preinstalled application: Additional noncore applications included in the OS build by the OS vendor, MD vendor, or wireless carrier.

SFR ID: FMT_SMF_EXT.1.1 #8b"
  solution       : "Configure the Google Android 14 device application allowlist to exclude applications with the following characteristics:

- Back up MD data to non-DOD cloud servers (including user and application access to cloud backup services);
- Transmit MD diagnostic data to non-DOD servers;
- Voice assistant application if available when MD is locked;
- Voice dialing application if available when MD is locked;
- Allows synchronization of data or applications between devices associated with user;
- Payment processing;
- Allows unencrypted (or encrypted but not FIPS 140-3 validated) data sharing with other MDs, display screens (screen mirroring), or printers; and
- Apps which backup their own data to a remote system.

On the EMM Console:

1. Go to the Android app catalog for managed Google Play.
2. Before selecting an app, review the app details and privacy policy to ensure the app does not include prohibited characteristics."
  reference      : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Google_Android_14_MDF_PP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-260132r948601_rule,STIG-ID|GOOG-14-706700,SWIFT-CSCv1|2.3,Vuln-ID|V-260132"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Google_Android_14_BYOAD_Y24M03_STIG.zip"
  json_transform : '(.apps | map(.ApplicationName + " " + .Version)) | blacklist |
                if (length > 0) then
                   hostname + " has one or more blacklisted item(s):\n  - " + join("\n  - ")
                else
                   hostname + " No blacklisted items found."
                end'
  regex          : ''
  expect         : 'No blacklisted items found.'
  bw_list        : "@BLACKLIST@"
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "GOOG-14-706800 - Google Android 14 must be configured to not display the following (work profile) notifications when the device is locked:"
  info           : "[selection:
a. email notifications
b. calendar appointments
c. contact associated with phone call notification
d. text message notification
e. other application-based notifications
f. all notifications] - work profile notifications when the device is locked:

Many mobile devices display notifications on the lock screen so that users can obtain relevant information in a timely manner without having to frequently unlock the phone to determine if there are new notifications. However, in many cases, these notifications can contain sensitive information. When they are available on the lock screen, an adversary can see them merely by being in close physical proximity to the device. Configuring the mobile operating system (MOS) to not send notifications to the lock screen mitigates this risk.

SFR ID: FMT_SMF_EXT.1.1 #18"
  solution       : "Configure the Google Android 14 device to not display (work profile) notifications when the device is locked.

On the EMM console:

1. Open 'Lock screen' settings.
2. Open 'Lock screen restrictions'.
3. Toggle 'Disable unredacted notifications'."
  reference      : "800-171|3.1.10,800-53|AC-11(1),800-53r5|AC-11(1),CAT|II,CCI|CCI-000060,CN-L3|8.1.4.1(b),DISA_Benchmark|Google_Android_14_MDF_PP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11(1),NIAv2|AM23c,NIAv2|AM23d,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,Rule-ID|SV-260133r948604_rule,STIG-ID|GOOG-14-706800,Vuln-ID|V-260133"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Google_Android_14_BYOAD_Y24M03_STIG.zip"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                "Profile: " + .General.Name + " - Unredacted Notifications = \(.Restriction.AllowKeyguardUnredacted? // "Not Defined")"'
  regex          : "Unredacted Notifications ="
  expect         : "Unredacted Notifications = False"
  match_all      : YES
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "GOOG-14-707200 - Google Android 14 must be configured to disable trust agents - NOTE: This requirement is not applicable (NA) for specific biometric authentication factors included in the product's Common Criteria evaluation."
  info           : "Trust agents allow a user to unlock a mobile device without entering a passcode when the mobile device is, for example, connected to a user-selected Bluetooth device or in a user-selected location. This technology would allow unauthorized users to have access to DOD sensitive data if compromised. By not permitting the use of nonpassword authentication mechanisms, users are forced to use passcodes that meet DOD passcode requirements.

SFR ID: FMT_SMF_EXT.1.1 #22, FIA_UAU.5.1"
  solution       : "Configure the Google Android 14 device to disable trust agents at the same location where the DOD password is implemented (device or work profile).

On the EMM console:

1. Open 'Lock screen restrictions'.
2. Select 'Personal Profile'.
3. Toggle 'Disable trust agents' to 'ON'.
4. Open 'Lock screen restrictions'.
5. Select 'Work Profile'.
6. Toggle 'Disable trust agents' to 'ON'."
  reference      : "800-171|3.5.3,800-53|IA-2(3),800-53r5|IA-2(1),CAT|II,CCI|CCI-000767,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|Google_Android_14_MDF_PP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2(3),NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-260137r948616_rule,STIG-ID|GOOG-14-707200,SWIFT-CSCv1|1.2,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-260137"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Google_Android_14_BYOAD_Y24M03_STIG.zip"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                  "Profile: " + .General.Name + " - Keyguard Trust Agent = \(.Restriction.AllowKeyguardTrustAgent? // "Not Defined")"'
  regex          : "Keyguard Trust Agent ="
  expect         : "Keyguard Trust Agent = false"
  match_all      : YES
</custom_item>

<report type:"WARNING">
  description : "GOOG-14-707700 - Google Android 14 must be configured to display the DOD advisory warning message at startup or each time the user unlocks the Work Profile."
  info        : "Before granting access to the system, the mobile operating system is required to display the DOD-approved system use notification message or banner that provides privacy and security notices consistent with applicable Federal laws, Executive Orders, directives, policies, regulations, standards, and guidance. Required banners help ensure that DOD can audit and monitor the activities of mobile device users without legal restriction.

System use notification messages can be displayed when individuals first access or unlock the mobile device. The banner must be implemented as a 'click-through' banner at device unlock (to the extent permitted by the operating system). A 'click-through' banner prevents further activity on the information system unless and until the user executes a positive action to manifest agreement by clicking on a box indicating 'OK'.

The approved DOD text must be used exactly as required in the Knowledge Service referenced in DODI 8500.01. For devices accommodating banners of 1300 characters, the banner text is:

You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.
By using this IS (which includes any device attached to this IS), you consent to the following conditions:
-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.
-At any time, the USG may inspect and seize data stored on this IS.
-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.
-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.
-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.

For devices with severe character limitations, the banner text is:

I've read & consent to terms in IS user agreem't.

The administrator must configure the banner text exactly as written without any changes.

SFR ID: FMT_SMF_EXT.1.1 #36

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the DOD warning banner by the following method (required text is found in the Vulnerability Discussion):

Place the DOD warning banner text in the user agreement signed by each Google Android 14 device user (preferred method).

Note: It is not possible for the EMM to force a warning banner be placed on the device screen when using 'work profile for employee-owned devices (BYOD)' deployment mode."
  reference   : "800-171|3.1.9,800-53|AC-8a.,800-53r5|AC-8a.,CAT|II,CCI|CCI-000048,DISA_Benchmark|Google_Android_14_MDF_PP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-8a.,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,Rule-ID|SV-260142r948631_rule,STIG-ID|GOOG-14-707700,TBA-FIISB|45.2.4,Vuln-ID|V-260142"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Google_Android_14_BYOAD_Y24M03_STIG.zip"
</report>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "GOOG-14-708600 - Google Android 14 must be configured to not allow backup of all work profile applications to remote systems."
  info           : "Backups to remote systems (including cloud backup) can leave data vulnerable to breach on the external systems, which often offer less protection than the mobile operating system (MOS). Where the remote backup involves a cloud-based solution, the backup capability is often used to synchronize data across multiple devices. In this case, DOD devices may synchronize DOD sensitive information to a user's personal device or other unauthorized computers that are vulnerable to breach. Disallowing remote backup mitigates this risk.

SFR ID: FMT_SMF_EXT.1.1 #40"
  solution       : "Configure the Google Android 14 device to disable backup to remote systems (including commercial clouds).

On the EMM console:

1. Open 'Device owner management'.
2. Toggle 'Enable backup service' to 'OFF'."
  reference      : "800-171|3.13.4,800-53|SC-4,800-53r5|SC-4,CAT|II,CCI|CCI-001090,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,CSF2.0|PR.IR-01,DISA_Benchmark|Google_Android_14_MDF_PP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-4,ITSG-33|SC-4a.,Rule-ID|SV-260149r948652_rule,STIG-ID|GOOG-14-708600,Vuln-ID|V-260149"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Google_Android_14_BYOAD_Y24M03_STIG.zip"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                  "Profile: " + .General.Name + " - Allow Google Backup = \(.Restriction.AllowGoogleBackup? // "Not Defined")"'
  regex          : "Allow Google Backup ="
  expect         : "Allow Google Backup = False"
  match_all      : YES
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "GOOG-14-708900 - Google Android 14 must be configured to disable exceptions to the access control policy that prevent [selection: application processes, groups of application processes] from accessing [selection: all, private] data stored by other [selection: application processes, groups of application processes]."
  info           : "App data sharing gives apps the ability to access the data of other apps for enhanced user functionality. However, sharing also poses a significant risk that unauthorized users or apps will obtain access to DOD sensitive information. To mitigate this risk, there are data sharing restrictions, primarily from sharing data from personal (unmanaged) apps and work (managed) apps. If a user is allowed to make exceptions to the data sharing restriction policy, the user could enable unauthorized sharing of data, leaving it vulnerable to breach. Limiting the granting of exceptions to either the Administrator or common application developer mitigates this risk.

Copy/paste of data between applications in different application processes or groups of application processes is considered an exception to the access control policy and therefore, the Administrator must be able to enable/disable the feature. Other exceptions include allowing any data or application sharing between process groups.

SFR ID: FMT_SMF_EXT.1.1 #42, FDP_ACF_EXT.1.2"
  solution       : "Configure the Google Android 14 device to enable the access control policy that prevents [selection: application processes, groups of application processes] from accessing [selection: all, private] data stored by other [selection: application processes, groups of application processes].

Note: All application data is inherently sandboxed and isolated from other applications. To disable copy/paste on the EMM Console:

1. Open 'User restrictions'.
2. Open 'Set user restrictions'.
3. Toggle 'Disallow cross profile copy/paste' to 'ON'.
4. Toggle 'Disallow sharing data into the profile' to 'ON'."
  reference      : "800-171|3.1.5,800-53|AC-6(8),800-53|SC-39,800-53r5|AC-6(8),800-53r5|SC-39,CAT|II,CCI|CCI-002233,CCI|CCI-002530,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,CSF2.0|PR.AA-05,CSF2.0|PR.DS-01,CSF2.0|PR.DS-10,CSF2.0|PR.IR-03,DISA_Benchmark|Google_Android_14_MDF_PP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,Rule-ID|SV-260152r948661_rule,STIG-ID|GOOG-14-708900,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,Vuln-ID|V-260152"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Google_Android_14_BYOAD_Y24M03_STIG.zip"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                  "Profile: " + .General.Name + " - Allow Copy Paste Between Different Applications = \(.Restriction.AllowCopyPasteBetweenDifferentApplications? // "Not Defined")"'
  regex          : "Allow Copy Paste Between Different Applications ="
  expect         : "Allow Copy Paste Between Different Applications = False"
  match_all      : YES
</custom_item>

<report type:"WARNING">
  description : "GOOG-14-709800 - Google Android 14 users must complete required training."
  info        : "The security posture of Google devices requires the device user to configure several required policy rules on their device. User-Based Enforcement (UBE) is required for these controls. In addition, if the Authorizing Official (AO) has approved the use of an unmanaged personal space, the user must receive training on risks. If a user is not aware of their responsibilities and does not comply with UBE requirements, the security posture of the Google mobile device and DOD sensitive data may become compromised.

SFR ID: NA

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "All Google Android 14 device users must complete training on the following training topics (users must acknowledge that they have reviewed training via a signed User Agreement or similar written record):
- Operational security concerns introduced by unmanaged applications/unmanaged personal space, including applications using global positioning system (GPS) tracking.
- The need to ensure no DOD data is saved to the personal space or transmitted from a personal app (for example, from personal email).
- If the Purebred key management app is used, users are responsible for always maintaining positive control of their credentialed device. The DOD PKI certificate policy requires subscribers to maintain positive control of the devices that contain private keys and to report any loss of control so the credentials can be revoked. Upon device retirement, turn-in, or reassignment, ensure that a factory data reset is performed prior to device hand-off. Follow mobility service provider decommissioning procedures as applicable.
- How to configure the following UBE controls (users must configure the control) on the Google device:
**Do not remove DOD intermediate and root PKI digital certificates.
**Do not configure a DOD network (work) VPN profile on any third-party VPN client installed in the personal space.
-How to implement OneLock.
-Screenshots will not be taken of any 'work'-related managed data.
-Screenshots will not be taken of any 'work'-related managed data."
  reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Google_Android_14_MDF_PP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-260160r948685_rule,STIG-ID|GOOG-14-709800,SWIFT-CSCv1|2.3,Vuln-ID|V-260160"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Google_Android_14_BYOAD_Y24M03_STIG.zip"
</report>

<report type:"WARNING">
  description : "GOOG-14-710000 - Google Android 14 must have the DOD root and intermediate PKI certificates installed (work profile only) - work profile only."
  info        : "DOD root and intermediate PKI certificates are used to verify the authenticity of PKI certificates of users and web services. If the root and intermediate certificates are not available, an adversary could falsely sign a certificate in such a way that it could not be detected. Providing access to the DOD root and intermediate PKI certificates greatly diminishes the risk of this attack.

SFR ID: FMT_SMF_EXT.1.1 #11

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the Google Android 14 device to install DOD root and intermediate certificates (work profile only).

On the EMM console upload DOD root and intermediate certificates as part of the work profile.

The current DOD root and intermediate PKI certificates may be obtained in self-extracting zip files at http://cyber.mil/pki-pke (for NIPRNet)."
  reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Google_Android_14_MDF_PP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-260162r948691_rule,STIG-ID|GOOG-14-710000,SWIFT-CSCv1|2.3,Vuln-ID|V-260162"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Google_Android_14_BYOAD_Y24M03_STIG.zip"
</report>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "GOOG-14-710100 - The Google Android 14 work profile must be configured to prevent users from adding personal email accounts to the work email app."
  info           : "If the user can add a personal email account (POP3, IMAP, EAS) to the work email app, it could be used to forward sensitive DOD data to unauthorized recipients. Restricting email account addition to the administrator or restricting email account addition to allowlisted accounts mitigates this vulnerability.

SFR ID: FMT_SMF_EXT.1.1 #47"
  solution       : "Configure the Google Android 14 device to prevent users from adding personal email accounts to the work email app.

On the EMM console:

1. Open 'Set user restrictions'.
2. Toggle 'Disallow modify accounts' to 'ON'.

Refer to the EMM documentation to determine how to provision users' work email accounts for the work email app."
  reference      : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Google_Android_14_MDF_PP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-260163r948694_rule,STIG-ID|GOOG-14-710100,SWIFT-CSCv1|2.3,Vuln-ID|V-260163"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Google_Android_14_BYOAD_Y24M03_STIG.zip"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                  "Profile: " + .General.Name + " - Allow Email Account Addition = \(.Restriction.AllowEmailAccountAddition? // "Not Defined")"'
  regex          : "Allow Email Account Addition ="
  expect         : "Allow Email Account Addition = True"
  match_all      : YES
</custom_item>

<custom_item>
  type           : APP_INFO_BY_DEVICE
  description    : "GOOG-14-710200 - The Google Android 14 work profile must be configured to enforce the system application disable list (work profile only) - work profile only."
  info           : "The system application disables list controls user access to/execution of all core and preinstalled applications.

Core application: Any application integrated into Google Android 14 by Google.

Preinstalled application: Additional noncore applications included in the Google Android 14 build by Google or the wireless carrier.

Some system applications can compromise DOD data or upload users' information to non-DOD-approved servers. A user must be blocked from using such applications that exhibit behavior that can result in compromise of DOD data or DOD user information.

The site administrator must analyze all preinstalled applications on the device and disable all applications not approved for DOD use by configuring the system application disable list.

SFR ID: FMT_SMF_EXT.1.1 #47"
  solution       : "Configure the Google Android 14 device to enforce the system application disable list (work profile only).

The required configuration is the default configuration when the device is enrolled. If the device configuration is changed, use the following procedure to bring the device back into compliance:

On the EMM console:

1. Open 'Apps management' section.
2. Select 'Hide apps on parent'.
3. Enter package names of apps to hide.

Configure a list of approved Google core and preinstalled apps in the core app allowlist."
  reference      : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Google_Android_14_MDF_PP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-260164r948697_rule,STIG-ID|GOOG-14-710200,SWIFT-CSCv1|2.3,Vuln-ID|V-260164"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Google_Android_14_BYOAD_Y24M03_STIG.zip"
  json_transform : '(.apps | map(.ApplicationName + " " + .Version)) | blacklist |
                if (length > 0) then
                   hostname + " has one or more blacklisted item(s):\n  - " + join("\n  - ")
                else
                   hostname + " No blacklisted items found."
                end'
  regex          : ''
  expect         : 'No blacklisted items found.'
  bw_list        : "@BLACKLIST@"
</custom_item>

<report type:"WARNING">
  description : "GOOG-14-710300 - Google Android 14 must be provisioned as a BYOAD device (Android work profile for employee-owned devices [BYOD]) - Android work profile for employee-owned devices [BYOD]."
  info        : "The Android work profile for employee-owned devices (BYOD) is the designated application group for the BYOAD use case.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the Google Android 14 device for BYOD (work profile for employee-owned devices [BYOD]).

On the EMM console, configure the default enrollment as work profile for employee-owned devices (BYOD).

Refer to the EMM documentation to determine how to configure the device."
  reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Google_Android_14_MDF_PP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-260165r948700_rule,STIG-ID|GOOG-14-710300,SWIFT-CSCv1|2.3,Vuln-ID|V-260165"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Google_Android_14_BYOAD_Y24M03_STIG.zip"
</report>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "GOOG-14-710400 - The Google Android 14 work profile must be configured to disable automatic completion of workspace internet browser text input."
  info           : "The autofill functionality in the web browser allows the user to complete a form that contains sensitive information, such as personally identifiable information (PII), without previous knowledge of the information. By allowing the use of autofill functionality, an adversary who learns a user's Android 14 device password, or who otherwise can unlock the device, may be able to further breach other systems by relying on the autofill feature to provide information unknown to the adversary. By disabling the autofill functionality, the risk of an adversary gaining further information about the device's user or compromising other systems is significantly mitigated.

SFR ID: FMT_SMF_EXT.1.1 #47"
  solution       : "Configure the Chrome browser on the Google Android 14 device work profile to disable autofill.

On the EMM console:

1. Open 'Managed Configurations' section.
2. Select the Chrome Browser version from the work profile.
3. Ensure 'SearchSuggestEnabled' is turned 'OFF'.

Refer to the EMM documentation to determine how to configure Chrome Browser Settings."
  reference      : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Google_Android_14_MDF_PP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-260166r948703_rule,STIG-ID|GOOG-14-710400,SWIFT-CSCv1|2.3,Vuln-ID|V-260166"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Google_Android_14_BYOAD_Y24M03_STIG.zip"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                  "Profile: " + .General.Name + " - Enable Autofill = \(.Restriction.EnableAutofill? // "Not Defined")"'
  regex          : "Enable Autofill ="
  expect         : "Enable Autofill = False"
  match_all      : YES
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "GOOG-14-710500 - The Google Android 14 work profile must be configured to disable the autofill services."
  info           : "The autofill services allow the user to complete text inputs that could contain sensitive information, such as personally identifiable information (PII), without previous knowledge of the information. By allowing the use of autofill services, an adversary who learns a user's Android 14 device password, or who otherwise can unlock the device, may be able to further breach other systems by relying on the autofill services to provide information unknown to the adversary. By disabling the autofill services, the risk of an adversary gaining further information about the device's user or compromising other systems is significantly mitigated.

Examples of apps that offer autofill services include Samsung Pass, Google, Dashlane, LastPass, and 1Password.

SFR ID: FMT_SMF_EXT.1.1 #47"
  solution       : "Configure the Google Android 14 device work profile to disable the autofill services.

On the EMM console:

1. Open 'Set user restrictions'.
2. Toggle 'Disallow autofill' to 'ON'."
  reference      : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Google_Android_14_MDF_PP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-260167r948706_rule,STIG-ID|GOOG-14-710500,SWIFT-CSCv1|2.3,Vuln-ID|V-260167"
  see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Google_Android_14_BYOAD_Y24M03_STIG.zip"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                  "Profile: " + .General.Name + " - Enable Autofill = \(.Restriction.EnableAutofill? // "Not Defined")"'
  regex          : "Enable Autofill ="
  expect         : "Enable Autofill = False"
  match_all      : YES
</custom_item>

<report type:"WARNING">
  description : "GOOG-14-710800 - Android 14 devices must have the latest available Google Android 14 operating system installed."
  info        : "Required security features are not available in earlier operating system versions. In addition, there may be known vulnerabilities in earlier versions.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Install the latest released version of the Google Android 14 operating system on all managed Google devices.

Note: Google Android device operating system updates are released directly by Google or can be distributed via the EMM. Check each device manufacturer and/or carriers for current updates."
  reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Google_Android_14_MDF_PP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-260170r948715_rule,STIG-ID|GOOG-14-710800,SWIFT-CSCv1|2.3,Vuln-ID|V-260170"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Google_Android_14_BYOAD_Y24M03_STIG.zip"
</report>

<report type:"WARNING">
  description : "GOOG-14-710900 - Android 14 devices must be configured to disable the use of third-party keyboards (work profile only) - work profile only."
  info        : "Many third-party keyboard applications are known to contain malware.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the Google Android 14 device to disallow the use of third-party keyboards (work profile only).

On the EMM console:

1. Open 'Input methods'.
2. Tap 'Set input methods'.
3. Select only the approved keyboards.

Additionally, admins can configure application allowlists for Google Play so no third-party keyboards are available for user installation."
  reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Google_Android_14_MDF_PP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-260171r948718_rule,STIG-ID|GOOG-14-710900,SWIFT-CSCv1|2.3,Vuln-ID|V-260171"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Google_Android_14_BYOAD_Y24M03_STIG.zip"
</report>

<report type:"WARNING">
  description : "GOOG-14-712300 - The Google Android 14 must allow only the administrator (EMM) to install/remove DOD root and intermediate PKI certificates (work profile) - EMM to install/remove DOD root and intermediate PKI certificates."
  info        : "DOD root and intermediate PKI certificates are used to verify the authenticity of PKI certificates of users and web services. If the user is allowed to remove root and intermediate certificates, the user could allow an adversary to falsely sign a certificate in such a way that it could not be detected. Restricting the ability to remove DOD root and intermediate PKI certificates to the Administrator mitigates this risk.

SFR ID: FMT_MOF_EXT.1.2 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure Google Android 14 device to prevent a user from removing DOD root and intermediate PKI certificates (work profile).

On the EMM console:
1. Open 'Set user restrictions'.
2. Toggle 'Disallow config credentials' to 'ON'."
  reference   : "800-171|3.4.2,800-53|CM-6b.,800-53|CM-6(1),800-53r5|CM-6b.,800-53r5|CM-6(1),CAT|II,CCI|CCI-000366,CCI|CCI-000370,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Google_Android_14_MDF_PP_3-3_BYOAD_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,ITSG-33|CM-6(1),NESA|T3.2.1,NIAv2|NS5f,Rule-ID|SV-260174r948727_rule,STIG-ID|GOOG-14-712300,SWIFT-CSCv1|2.3,Vuln-ID|V-260174"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Google_Android_14_BYOAD_Y24M03_STIG.zip"
</report>

</check_type>
