#TRUSTED 8be932370e249666f7e52c2934bbeb24ffdc08a338e58b336d4bf8a3946afbeecc1ef6965e491bd87de8f7a1ab777d71d7b18feb707d7c5d5a47a3c24cbf76e1f095386371d76eadcdf50a1967fe0edf609040e7fa9046278298aed300c60128b20ec672d16b24ad254d0b01ca263c4d8140e41387bb72d124f358d24ff13f55412d05d57d956e2148d279b4910ca5066c82199d2c1c6196cfd52c1d1a5e96d4093ed67dcdb124c027e305f9b8199235862cbaa680043e8e5e83eaed73943ef18c1e423e4305c028204985fa7e0385a18d5d1e9807e3ce7a369db32eccac488483eac4ffea3e36dc8d3efaea7cd44f0e630bdfe65dc822c48431d5b069b580bbe916792a18f92c7394bcc7c60417b9d40748df3a432e5eff94e08a58a159d8b2ae0f038cc6c8d4bfaa134c1c93e4e3abc196fbe6fc571305b7594474c6ab0cf7e70a32870068ba6e08ae7ef2b1e19700a9801bd44cb8e49e1342a2a42b9fbdfe69acf28c418a0dc53be5461017f5cd12a827231639e853a1d905f5e640cf23ae626f74f5112ca47683355dd3e8f24c5154d856fd65d18240c4ea73162ecd48015b09bee7ff191e1e979b7bd5bd1f03de856d0d0a3a6493f252f0bce40228032ba47ee530c16b20a6985628b4b2364a4396b21748f7af7f85a176e75bd7c8b1965a262bcb28971766e4e7b60ef22abc51e319bf89c1fc4fc5032a9f8e8e2d0c69
#TRUST-RSA-SHA256 929c5cfac647299e5d2ce718b4cfa2424da33865ae1a98e5dfa67c65c8b27e4f4b05c22f8cbe9fbe597f31ab23bac135654a299666fecc4fee3a4a7532009d4b5cbe7cba7f3adc607f10bd3a078cd9c7dc07295df100d592e78341a77921b83df69557dc14f288c6a4627e3c5889276ff3f2378a879bd575bc2d45d1ca79aecf9e54cbf610c7ae098a00df3e07ba8db5476b366edbcb90632ffb3c27a4b8cbad3d5075fc381def74aeb72020c46c02f9b1dd76371fa10aea02ad6e0b168a6120e47e1f3422b48b68548d2973300e9dc07a99ab30d522052a86a59b1f352bd68a9c49d7131b7e94aa8c0f3f990746ca2a24953d60f16865db2a55238b4dee31d93d534fc1c5b2bdafc5168da19e53674618299c47a0bc6d7436754e99f1ec7dabb33c7e0d6fb9592e4e397c30036b9f2ee2f5c2d10a643f8bf4ede58035bc7194000688a1e7ce12acb3c68d0407d065e2656d3f8b1ead43cd910c2d3698b9614c8830517b27d3c604a0c9b01ad745333624b44e27e9744a731b2a424630e2282f1fd8269d2eadb994dcdfc6354fe58bbc781969c2733bfd6235449e684eb398a7d7869c6b5c39f71d8d23876a8d8e73af7e58764fcf431926dcf5ffbd279f3aaa0f65f00d1239f7e7835d81450ad9cc0d21eefd30d417ea0d2c1f028fa466f30a6fc708ddf011975a36cc39f7fca01e1f38943cdeb42b8cf894d0ed6d1ba48d4f
#
# This script is Copyright (C) 2004-2025 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
# $Revision: 1.0 $
# $Date: 2025/04/29 $
#
# Description : This document implements the security configuration as recommended by the
#               DISA MariaDB Enterprise 10.x v2r3 STIG.
#
#<ui_metadata>
#<display_name>DISA MariaDB Enterprise 10.x v2r3 OS Linux</display_name>
#<spec>
#  <type>DISA STIG</type>
#  <name>MariaDB Enterprise 10.x</name>
#  <profile>OS Linux</profile>
#  <version>2.3.0</version>
#  <link>https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MariaDB_Enterprise_10-x_V2R3_STIG.zip</link>
#</spec>
#<labels>unix,disa,mariadb,distribution_independent_linux</labels>
#<benchmark_refs>CAT,CCE,CCI,DISA_Benchmark,Group-ID,Rule-ID,STIG-ID,STIG-Legacy,Vuln-ID</benchmark_refs>
#<variables>
#  <variable>
#    <name>SSL_CERT</name>
#    <default>/etc/my.cnf.d/certificates/server-cert.pem</default>
#    <description>MariaDB Certificate File</description>
#    <info>This is your MariaDB Certificate variable.</info>
#    <value_type>UNIX_FILE_PATH</value_type>
#  </variable>
#  <variable>
#    <name>SSL_CA</name>
#    <default>/etc/my.cnf.d/certificates/ca.pem</default>
#    <description>MariaDB Certificate Authority File</description>
#    <info>This is your MariaDB Certificate Authority variable.</info>
#    <value_type>UNIX_FILE_PATH</value_type>
#  </variable>
#</variables>
#</ui_metadata>

<check_type:"Unix">

<if>
  <condition type:"OR">
    <custom_item>
      type        : CMD_EXEC
      description : "Linux found"
      cmd         : "uname -a"
      expect      : "Linux"
    </custom_item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "DISA_STIG_MariaDB_Enterprise_10.x_v2r3_OS_Linux.audit from DISA MariaDB Enterprise 10.x v2r3 STIG"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MariaDB_Enterprise_10-x_V2R3_STIG.zip"
    </report>

    <if>
      <condition auto:"WARNING" type:"AND">
        <custom_item>
          type        : CMD_EXEC
          description : "openssl"
          cmd         : "openssl version"
          expect      : "((?i)openssl(?-i) 3|fips)"
        </custom_item>

        <custom_item>
          type        : CMD_EXEC
          description : "fips_enabled"
          cmd         : "sysctl crypto.fips_enabled"
          expect      : "crypto.fips_enabled = 1"
        </custom_item>

        <custom_item>
          type        : CMD_EXEC
          description : "Review benchmark guidance."
          cmd         : "echo \"Examine the application's code to ensure is does not make calls using libmysqlclient.\""
          expect      : "^Manual Review Required$"
          severity    : MEDIUM
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "MADB-10-004400 - MariaDB must use NIST FIPS 140-2 validated cryptographic modules for cryptographic operations."
          info        : "Use of weak or not validated cryptographic algorithms undermines the purposes of utilizing encryption and digital signatures to protect data. Weak algorithms can be easily broken and not validated cryptographic modules may not implement algorithms correctly. Unapproved cryptographic modules or algorithms should not be relied on for authentication, confidentiality, or integrity. Weak cryptography could allow an attacker to gain access to and modify data stored in the database as well as the administration settings of the DBMS.

Applications, including DBMSs, utilizing cryptography are required to use approved NIST FIPS 140-2 validated cryptographic modules that meet the requirements of applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.

The security functions validated as part of FIPS 140-2 for cryptographic modules are described in FIPS 140-2 Annex A.

NSA Type-X (where X=1, 2, 3, 4) products are NSA-certified, hardware-based encryption modules.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
          solution    : "If crypto.fips_enabled = 0, for Red Hat Linux, configure the operating system to implement DoD-approved encryption by following the steps below:

To enable strict FIPS compliance, the fips=1 kernel option must be added to the kernel command line during system installation so key generation is done with FIPS-approved algorithms and continuous monitoring tests in place.

Enable FIPS mode with the following command:
# sudo fips-mode-setup --enable

Modify the kernel command line of the current kernel in the 'grub.cfg' file by adding the following option to the GRUB_CMDLINE_LINUX key in the '/etc/default/grub' file and then rebuild the 'grub.cfg' file:
fips=1

Changes to '/etc/default/grub' require rebuilding the 'grub.cfg' file as follows:
On BIOS-based machines, use the following command:
# sudo grub2-mkconfig -o /boot/grub2/grub.cfg

On UEFI-based machines, use the following command:
# sudo grub2-mkconfig -o /boot/efi/EFI/redhat/grub.cfg

If /boot or /boot/efi reside on separate partitions, the kernel parameter 'boot=<partition of /boot or /boot/efi>' must be added to the kernel command line. Identify a partition by running the df /boot or df /boot/efi command:
# sudo df /boot

Filesystem 1K-blocks Used Available Use% Mounted on
/dev/sda1 495844 53780 416464 12% /boot

To ensure the 'boot=' configuration option will work even if device naming changes occur between boots, identify the universally unique identifier (UUID) of the partition with the following command:
# sudo blkid /dev/sda1
/dev/sda1: UUID='05c000f1-a213-759e-c7a2-f11b7424c797' TYPE='ext4'

For the example above, append the following string to the kernel command line:
boot=UUID=05c000f1-a213-759e-c7a2-f11b7424c797

Reboot the system for the changes to take effect.

More information can be found here:
RedHat: https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/security_guide/chap-federal_standards_and_regulations
Ubuntu: https://security-certs.docs.ubuntu.com/en/fips"
          reference   : "800-53|IA-7,800-53r5|IA-7,CAT|I,CCI|CCI-000803,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|MariaDB_Enterprise_10-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(d),ITSG-33|IA-7,ITSG-33|IA-7a.,NESA|M5.2.1,NESA|M5.2.6,NESA|M5.3.1,NESA|T7.4.1,QCSC-v1|13.2,Rule-ID|SV-253703r961050_rule,STIG-ID|MADB-10-004400,Vuln-ID|V-253703"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MariaDB_Enterprise_10-x_V2R3_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <custom_item>
      type        : CMD_EXEC
      description : "MADB-10-009200 - When updates are applied to the MariaDB software, any software components that have been replaced or made unnecessary must be removed."
      info        : "Previous versions of MariaDB components that are not removed from the information system after updates have been installed may be exploited by adversaries.

MariaDB may remove older versions of software automatically from the information system. In other cases, manual review and removal will be required. In planning installations and upgrades, organizations must include steps (automated, manual, or both) to identify and remove the outdated modules.

A transition period may be necessary when both the old and the new software are required. This should be taken into account in the planning.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "If after the upgrade outdated packages remain, update them if needed or remove. Example:

$ sudo yum remove package_name"
      reference   : "800-171|3.14.1,800-171r3|03.14.01,800-53|SI-2(6),800-53r5|SI-2(6),CAT|II,CCI|CCI-002617,CN-L3|8.1.4.4(e),CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSF|ID.RA-1,CSF|PR.IP-12,CSF2.0|ID.IM-01,CSF2.0|ID.IM-02,CSF2.0|ID.IM-03,CSF2.0|PR.PS-02,DISA_Benchmark|MariaDB_Enterprise_10-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.6.8,ISO-27001-2022|A.8.8,ISO-27001-2022|A.8.32,ITSG-33|SI-2,NESA|T7.6.2,NESA|T7.7.1,NIAv2|PR9,PCI-DSSv3.2.1|6.2,PCI-DSSv4.0|6.3,PCI-DSSv4.0|6.3.3,QCSC-v1|11.2,Rule-ID|SV-253744r961677_rule,STIG-ID|MADB-10-009200,SWIFT-CSCv1|2.2,Vuln-ID|V-253744"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MariaDB_Enterprise_10-x_V2R3_STIG.zip"
      cmd         : "yum list installed | grep -i mariadb"
      expect      : "^Manual Review Required$"
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "MADB-10-009300 - Security-relevant software updates to MariaDB must be installed within the time period directed by an authoritative source (e.g., IAVM, CTOs, DTMs, and STIGs)."
      info        : "Security flaws with software applications, including database management systems, are discovered daily. Vendors are constantly updating and patching their products to address newly discovered security vulnerabilities. Organizations (including any contractor to the organization) are required to promptly install security-relevant software updates (e.g., patches, service packs, and hot fixes). Flaws discovered during security assessments, continuous monitoring, incident response activities, or information system error handling must also be addressed expeditiously.

Organization-defined time periods for updating security-relevant software may vary based on a variety of factors including, for example, the security category of the information system or the criticality of the update (i.e., severity of the vulnerability related to the discovered flaw).

This requirement will apply to software patch management solutions that are used to install patches across the enclave and also to applications themselves that are not part of that patch management solution. For example, many browsers today provide the capability to install their own patch software. Patch criticality, as well as system criticality, will vary. Therefore, the tactical situations regarding the patch management process will also vary. This means that the time period utilized must be a configurable parameter. Time frames for application of security-relevant software updates may be dependent upon the Information Assurance Vulnerability Management (IAVM) process.

The application will be configured to check for and install security-relevant software updates within an identified time period from the availability of the update. The specific time period will be defined by an authoritative source (e.g., IAVM, CTOs, DTMs, and STIGs).

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "Institute and adhere to policies and procedures to ensure that patches are consistently applied to MariaDB within the time allowed."
      reference   : "800-171|3.14.1,800-171r3|03.14.01b.,800-53|SI-2c.,800-53r5|SI-2c.,CAT|II,CCI|CCI-002605,CN-L3|8.1.4.4(e),CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSF|ID.RA-1,CSF|PR.IP-12,CSF2.0|ID.IM-01,CSF2.0|ID.IM-02,CSF2.0|ID.IM-03,CSF2.0|PR.PS-02,DISA_Benchmark|MariaDB_Enterprise_10-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.6.8,ISO-27001-2022|A.8.8,ISO-27001-2022|A.8.32,ITSG-33|SI-2,NESA|T7.6.2,NESA|T7.7.1,NIAv2|AM38,NIAv2|AM39,NIAv2|SS14b,PCI-DSSv3.2.1|6.2,PCI-DSSv4.0|6.3,PCI-DSSv4.0|6.3.3,QCSC-v1|11.2,Rule-ID|SV-253745r1001008_rule,STIG-ID|MADB-10-009300,SWIFT-CSCv1|2.2,Vuln-ID|V-253745"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MariaDB_Enterprise_10-x_V2R3_STIG.zip"
      cmd         : "yum list installed | grep -i mariadb"
      expect      : "^Manual Review Required$"
      severity    : MEDIUM
    </custom_item>

    <if>
      <condition auto:"WARNING" type:"AND">
        <custom_item>
          type        : CMD_EXEC
          description : "openssl"
          cmd         : "openssl version"
          expect      : "((?i)openssl(?-i) 3|fips)"
        </custom_item>

        <custom_item>
          type        : CMD_EXEC
          description : "fips_enabled"
          cmd         : "sysctl crypto.fips_enabled"
          expect      : "crypto.fips_enabled = 1"
        </custom_item>

        <custom_item>
          type        : CMD_EXEC
          description : "Review benchmark guidance."
          cmd         : "echo \"Examine the application's code to ensure is does not make calls using libmysqlclient.\""
          expect      : "^Manual Review Required$"
          severity    : MEDIUM
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "MADB-10-012100 - MariaDB must implement NIST FIPS 140-2 validated cryptographic modules to provision digital signatures."
          info        : "Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data. The application must implement cryptographic modules adhering to the higher standards approved by the federal government since this provides assurance they have been tested and validated.

For detailed information, refer to NIST FIPS Publication 140-2, Security Requirements For Cryptographic Modules. Note that the product's cryptographic modules must be validated and certified by NIST as FIPS-compliant.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
          solution    : "If crypto.fips_enabled = 0, configure operating system per operating system documentation:
RedHat: https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/security_guide/chap-federal_standards_and_regulations
Ubuntu: https://security-certs.docs.ubuntu.com/en/fips"
          reference   : "800-171|3.13.11,800-171r3|03.13.11,800-53|SC-13,800-53r5|SC-13b.,CAT|II,CCI|CCI-002450,CSF|PR.DS-5,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,DISA_Benchmark|MariaDB_Enterprise_10-x_STIG,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ISO-27001-2022|A.8.24,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2,Rule-ID|SV-253773r961857_rule,STIG-ID|MADB-10-012100,Vuln-ID|V-253773"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MariaDB_Enterprise_10-x_V2R3_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <if>
      <condition auto:"WARNING" type:"AND">
        <custom_item>
          type        : CMD_EXEC
          description : "openssl"
          cmd         : "openssl version"
          expect      : "((?i)openssl(?-i) 3|fips)"
        </custom_item>

        <custom_item>
          type        : CMD_EXEC
          description : "fips_enabled"
          cmd         : "sysctl crypto.fips_enabled"
          expect      : "crypto.fips_enabled = 1"
        </custom_item>

        <custom_item>
          type        : CMD_EXEC
          description : "Review benchmark guidance."
          cmd         : "echo \"Examine the application's code to ensure is does not make calls using libmysqlclient.\""
          expect      : "^Manual Review Required$"
          severity    : MEDIUM
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "MADB-10-012200 - MariaDB must implement NIST FIPS 140-2 validated cryptographic modules to generate and validate cryptographic hashes."
          info        : "Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data. The application must implement cryptographic modules adhering to the higher standards approved by the federal government since this provides assurance they have been tested and validated.

For detailed information, refer to NIST FIPS Publication 140-2, Security Requirements For Cryptographic Modules. Note that the product's cryptographic modules must be validated and certified by NIST as FIPS-compliant.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
          solution    : "If crypto.fips_enabled = 0, configure operating system per operating system documentation:
RedHat: https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/security_guide/chap-federal_standards_and_regulations
Ubuntu: https://security-certs.docs.ubuntu.com/en/fips"
          reference   : "800-171|3.13.11,800-171r3|03.13.11,800-53|SC-13,800-53r5|SC-13b.,CAT|II,CCI|CCI-002450,CSF|PR.DS-5,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,DISA_Benchmark|MariaDB_Enterprise_10-x_STIG,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ISO-27001-2022|A.8.24,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2,Rule-ID|SV-253774r961857_rule,STIG-ID|MADB-10-012200,Vuln-ID|V-253774"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MariaDB_Enterprise_10-x_V2R3_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <if>
      <condition auto:"WARNING" type:"AND">
        <custom_item>
          type        : CMD_EXEC
          description : "openssl"
          cmd         : "openssl version"
          expect      : "((?i)openssl(?-i) 3|fips)"
        </custom_item>

        <custom_item>
          type        : CMD_EXEC
          description : "fips_enabled"
          cmd         : "sysctl crypto.fips_enabled"
          expect      : "crypto.fips_enabled = 1"
        </custom_item>

        <custom_item>
          type        : CMD_EXEC
          description : "Review benchmark guidance."
          cmd         : "echo \"Examine the application's code to ensure is does not make calls using libmysqlclient.\""
          expect      : "^Manual Review Required$"
          severity    : MEDIUM
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "MADB-10-012300 - MariaDB must implement NIST FIPS 140-2 validated cryptographic modules to protect unclassified information requiring confidentiality and cryptographic protection, in accordance with the data owners requirements."
          info        : "Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data. The application must implement cryptographic modules adhering to the higher standards approved by the federal government since this provides assurance they have been tested and validated.

It is the responsibility of the data owner to assess the cryptography requirements in light of applicable federal laws, Executive Orders, directives, policies, regulations, and standards.

For detailed information, refer to NIST FIPS Publication 140-2, Security Requirements For Cryptographic Modules. Note that the product's cryptographic modules must be validated and certified by NIST as FIPS-compliant.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
          solution    : "If crypto.fips_enabled = 0, configure operating system per operating system documentation:
RedHat: https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/security_guide/chap-federal_standards_and_regulations
Ubuntu: https://security-certs.docs.ubuntu.com/en/fips"
          reference   : "800-171|3.13.11,800-171r3|03.13.11,800-53|SC-13,800-53r5|SC-13b.,CAT|II,CCI|CCI-002450,CSF|PR.DS-5,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,DISA_Benchmark|MariaDB_Enterprise_10-x_STIG,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ISO-27001-2022|A.8.24,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2,Rule-ID|SV-253775r961857_rule,STIG-ID|MADB-10-012300,Vuln-ID|V-253775"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MariaDB_Enterprise_10-x_V2R3_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <if>
      <condition auto:"WARNING" type:"AND">
        <custom_item>
          type        : CMD_EXEC
          description : "cert ca"
          cmd         : "openssl x509 -in @SSL_CA@ -noout -issuer"
          expect      : "^Manual Review Required$"
          severity    : MEDIUM
        </custom_item>

        <custom_item>
          type        : CMD_EXEC
          description : "cert"
          cmd         : "openssl x509 -in @SSL_CERT@ -noout -issuer"
          expect      : "^Manual Review Required$"
          severity    : MEDIUM
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "MADB-10-008500 - MariaDB must only accept end entity certificates issued by DoD PKI or DoD-approved PKI Certification Authorities (CAs) for the establishment of all encrypted sessions."
          info        : "Only DoD-approved external PKIs have been evaluated to ensure that they have security controls and identity vetting procedures in place that are sufficient for DoD systems to rely on the identity asserted in the certificate. PKIs lacking sufficient security controls and identity vetting procedures risk being compromised and issuing certificates that enable adversaries to impersonate legitimate users.

The authoritative list of DoD-approved PKIs is published at https://dl.dod.cyber.mil/wp-content/uploads/pki-pke/pdf/unclass-ss_using_commercial_pki_certificates.pdf.

This requirement focuses on communications protection for the MariaDB session rather than for the network packet.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
          solution    : "Revoke trust in any certificates not issued by a DoD-approved certificate authority.

Configure MariaDB to accept only DoD and DoD-approved PKI end-entity certificates."
          reference   : "800-171|3.13.15,800-171r3|03.13.15,800-53|SC-23(5),800-53r5|SC-23(5),CAT|II,CCI|CCI-002470,DISA_Benchmark|MariaDB_Enterprise_10-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-23,ITSG-33|SC-23a.,NESA|T4.5.1,QCSC-v1|5.2.1,Rule-ID|SV-253738r961596_rule,STIG-ID|MADB-10-008500,Vuln-ID|V-253738"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MariaDB_Enterprise_10-x_V2R3_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>
  </then>

  <else>
    <report type:"WARNING">
      description : "DISA_STIG_MariaDB_Enterprise_10.x_v2r3_OS_Linux.audit from DISA MariaDB Enterprise 10.x v2r3 STIG"
      info        : "NOTE: Nessus has not identified that the chosen audit applies to the target device."
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MariaDB_Enterprise_10-x_V2R3_STIG.zip"
    </report>
  </else>
</if>

</check_type>
