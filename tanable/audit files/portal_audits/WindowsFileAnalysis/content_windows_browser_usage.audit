#TRUSTED 7dbac637ee6b47a14647a51baecc90a10ed216ac35cb56343d44f341fb342569790af1e3a4e0846d7e9ebcab5e163b3ce10c7fbf393774e5c79c3d89723badd3c84cdefc40e717141fa888265941da596fbb25d19767d805e44f6fb430add5b90c67cd06ba8bd3d0e1691f26cc51fa5cc7502e5ebc1ef618f78f3b849683917c5af2bd4233463c8de0b239a652e21d74d04ff1eda54a295357ebbaf316f4200c42270895ba386bcc7d8307ef73f2f2f6cdd7c58015c25331c9a802bc3b8ee479dceb79392c343baafef891c75bc00bf779669d084619988227a68615aa570012867f5ce9ca12a37bde8d5a176dc96087caa8381c3330355f98375c889d32239bd6ea20c6a17d613ef4a3c0b9831e8c3c83fdf28d984327fdbf08ffa33ff95eecbf8012cb7ad91b60ee7578bac7b2abb2d092bc6cebe5b9f3813d42b694b2cbcd70957126d45fc857ebe18c3353ac3abc2b3f3e3829c1dcc154b33e2fb73df08399d29108875b622c105482e3c23bc14aa21c89b85a7bfced4b028c1ed65babf3e4969a95db08a1c251bdc283cc1bca039ceef521ecd0fda8946817bbdffd01856ad9aab3d40794d23459686c153c25ca254651685f76a738a9c3d6d46da533c261574df48d0268cb525e4715e8ac6c04ccbf91f32644576a0a24717a9bc406ca641aa32e8a74a80aa1c7a5eff67cadec01d63da61e661cb2ca34b735ccc372b6
#TRUST-RSA-SHA256 7fd718d69fbcc425be80570dceb4567232210d48251504fca056e8ec60a36353f84766dcf8fbf75535a0291a82da6888891f27425002cd3acf30f3ad1df3b69b3469ca8676eea7f74db0f8bd5fa33b91912021b16ee75898d25419cf657c4b603b2010ad9e61e61e23f251a035f37d4f37d7c87435116baf1461686ff0bf8f973ff6076bd00a85a37d5812aef9bc51f17cc2417e57280507f088a49685fbece0e2eef34d4ef6b249fcc17505e7787b346d7b5f186ad2f0df127aadd20cbaa3f5b2861aa0dd5ac7dc5d115cb4fe7ca79fcb3034cd4689fe430a3d7f4d70c8d09145802bbdd88aa063c3909ebd5783387a960f3db43529d0ab487929c085889a2c33a55b06a67868b45417e414b62651d20d6d113956383b311d707ae9eedf1e9ac0240e3d0cb3dc5d527cae79c5832a62f65d3bae13907821ea532b208049af997d2de7f3fee8d6c767eae13314311672c2909aeff411b9f8ffb850dc4af6aed68c6a0a56fcf86cd5aa2a42ea058210529ee7f538fbfa3604e476018089832628cf26412d0d951928f026cfaf4367c05cbcc0c9622c3c1f4c08e6b72f34b265129814a8999dbce5a7064212a9a6718009012f4d2652455d6b594c599f224af7d460b55aad9a9fe0b5bce28d64f628ae77d89e0bf5a85658dfe41bd916902db5b972f2495fd9c97a796bb9cd0608038f3aec85623ce4712f2c83ec25649b146244
#
# This script is Copyright (C) 2004-2025 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
# $Revision: 1.8 $
# $Date: 2025/01/06 $
#
# Description	: This .audit is designed to look at IE browser history for words
# 			  or URLs which may indicate that a user has been visiting sites which
# 			  may be prohibited by corporate policy.
#
# 			  An audit has been included for Mozilla Firefox, auditing data files
# 			  used for logging sites which have passwords saved for them (or explicitly
# 			  not saved).
#
#<ui_metadata>
#<display_name>TNS File Analysis - Adult Media Browser Usage</display_name>
#<spec>
#  <type>TNS</type>
#  <name>File Analysis - Adult Media Browser Usage</name>
#  <version>1.0.0</version>
#</spec>
#<labels>filecontent,content,windows,browser,usage,agent</labels>
#</ui_metadata>

<check_type:"FileContent">

#
# IE History explicit content

<item>
  type           : FILE_CONTENT_CHECK
  description    : "Determine if host has browsed adult content with Internet Explorer."
  reference      : "800-171|3.1.3,800-53|AC-4(8),800-53r5|AC-4(8),CN-L3|8.1.10.2(c),CSF|DE.AE-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.PT-4,CSF2.0|DE.CM-09,CSF2.0|ID.AM-03,CSF2.0|PR.DS-10,CSF2.0|PR.IR-01,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-4(8),NESA|T4.2.1,NESA|T4.5.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.4.6,NESA|T5.7.2,NESA|T7.5.2,NESA|T7.6.4,NIAv2|GS10a,NIAv2|GS10d,NIAv2|NS12a,NIAv2|NS12b,NIAv2|NS12c,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.4"
  file_extension : "dat"
  regex          : "hustler|playboy|porn|nude|video|lesbian|facial|nude|kink|orgy|babes|threesome|young|fantasy"
  expect         : "UrlCache"
  file_name      : "\\documents and settings\\.*\\local settings\\history\\history.ie5\\.*\\index"
  max_size       : "1M"
</item>

#
# IE Bookmarks explicit content

<item>
  type           : FILE_CONTENT_CHECK
  description    : "Determine if host has bookmarked adult content with Internet Explorer."
  reference      : "800-171|3.1.3,800-53|AC-4(8),800-53r5|AC-4(8),CN-L3|8.1.10.2(c),CSF|DE.AE-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.PT-4,CSF2.0|DE.CM-09,CSF2.0|ID.AM-03,CSF2.0|PR.DS-10,CSF2.0|PR.IR-01,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-4(8),NESA|T4.2.1,NESA|T4.5.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.4.6,NESA|T5.7.2,NESA|T7.5.2,NESA|T7.6.4,NIAv2|GS10a,NIAv2|GS10d,NIAv2|NS12a,NIAv2|NS12b,NIAv2|NS12c,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.4"
  file_extension : "url"
  regex          : "hustler|playboy|porn|nude|video|lesbian|facial|nude|kink|orgy|babes|threesome|young|fantasy"
  expect         : "BASEURL"
  file_name      : "\\documents and settings\\.*\\favorites"
  max_size       : "1M"
</item>

#
# IE Bookmarks, other content
#<item>
# type			: FILE_CONTENT_CHECK
# description		: "Determine if server has bookmarked specific content with Internet Explorer."
# file_extension	: "url"
# file_name		: "\\documents and settings\\.*\\favorites"
# expect			: "BASEURL"
# regex			: "maps.google.com|ebay\.com"
# max_size		: "1M"
#</item>
#
# FFOX log of site w/w saved passwords.

<item>
  type           : FILE_CONTENT_CHECK
  description    : "Determine if a host has passwords saved or not saved for specific sites with Mozilla Firefox."
  reference      : "800-171|3.1.3,800-53|AC-4(8),800-53r5|AC-4(8),CN-L3|8.1.10.2(c),CSF|DE.AE-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.PT-4,CSF2.0|DE.CM-09,CSF2.0|ID.AM-03,CSF2.0|PR.DS-10,CSF2.0|PR.IR-01,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-4(8),NESA|T4.2.1,NESA|T4.5.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.4.6,NESA|T5.7.2,NESA|T7.5.2,NESA|T7.6.4,NIAv2|GS10a,NIAv2|GS10d,NIAv2|NS12a,NIAv2|NS12b,NIAv2|NS12c,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.4"
  file_extension : "txt"
  regex          : "hustler|playboy|porn|nude|video|lesbian|facial|nude|kink|orgy|babes|threesome|young|fantasy|gambling|chat|ebay|flickr|twitter|myspace|livejournal|facebook|blog|share|torrent|proxy"
  expect         : "http"
  file_name      : "\\documents and settings\\.*\\Application Data\\Mozilla\\Firefox\\Profiles\\.*\\signons[0-9]"
  max_size       : "1M"
</item>

</check_type>
