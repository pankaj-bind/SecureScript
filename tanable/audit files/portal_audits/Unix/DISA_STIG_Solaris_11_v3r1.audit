#TRUSTED 045b4f061889df631a04b4734dc398e10a6450b1cf6862445bb12a80cf4ea9daa2deb648b1fe38d84a229b0aeb604ad8e5126d0bb761f04db5a22bcb0538ed1432ad905c5939b224149225218af0acd7bdfd5f939f9d7ce1172717e467996eb6ddc70658da7262157396ab349cd6e6b5d23dcd92330f1d6efedffcfeaeb8a9274ddf83f3133e0c285a744a744207ef2ae9406080e33ae71f242a8d0a20ed6c4aa3a7dde45e224dfdd713515686edf1f87c17855fa52dec8997e4b5a4cdcce83eb76ad0a4c9f49d3d3aba257b98b6707ed4ec44db69a33a7994fe5647d913cf2da7f74c7323964fea517787470e45f0b9ce08d1fd54f33572875837d9abd6f682b5a6dbeafdac82c2417eb05844cca7a923a41411d2dd243868f506887515824265e94ea23a875b4d4915a6cc4bdf24c6b0ef5b913971725afb5264cb629cb8ac7303958dea295ffc9399fc5092b18a9d129100fd2119b191bd26862a7e824082bc4eed153fd25224026f9eb4f025496494ee93ff77a9bfc3a5e829c7a0501a44078a925a2373b3537b8563a72d6934257f78a2808d9f51b38b445de0eb8ff2b5fc090932ce9acd23c21a2ba12fed35db5690ce8706e8aaf6d984477a8303047ba690002f5a9d70b870c6e4e01080b7e8800dc738db730b2b2ad2e9ffcc5e3712f2fe9f5a1ade192cb275c1a29e94f875cdd16ce4d2d6a8b8c056e1b6a04a3770
#TRUST-RSA-SHA256 9149db2380c4b0260dd7e0f30f3609470e39bf560ca6c892bb174bb4d1f9d9e952fc1baf642a6201cdee3d6155bc3196931f85e47d4be5776f9ff8db93cc4a0d00fb56f1292d58e965501f708c20f2e83f6b1f80253c4c0893229f99f8fa83ae8b4ae0119d9cbba8323d72a67c7c3cddded17b75781c335d4dd929177e2174247ba60b2ea3332fe32c4d3fc8e76a82a72b1a0390c7408b4e0321fcb0821df2dcb821f2b45c9af21489452239d6d6d20d9b378dcbe772345069779b2d6033600388e157b4076c1095899fe9ec418fc39ac983dce22c6e1e5c6193cd1549c0658b34a766b2031fb1c59b0feb5f84762c9d62ad2195cd69675db052cc61dfe6ab106ec547c36513533e6fb34e94c1d0ddbb46a1e7e7da2d962950a5144da258ff215e216054a30291e25f74874e99ef11e8a30faaa9dd9c7ba6c68ff7ab3e710b74f387d66dddd08463e013b74d896a1f37db85ce80507d444f1a0f93cccb8a0922e31e5b41aa2ea12e04536ac922ca6af048b9bd3afb6b476e18522cf8225fd68e93519d2b1835273c3f7c0731b85cfc0f334349dee8a8ae9ffff9dbdb1a42c037220bc27ebcd684485aac7a1596451d4c1a3c0e7654512e93f1e38f830fafd0a80b0f04a1b0f86bb7ceeba547097ef2ed9481b11caa042b87bb24208a5c240e00db4d8c8f4942f73b92982714604157a271bad50634bba1640fb0f592bb2a0596
#
# This script is Copyright (C) 2004-2024 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
# $Revision: 1.2 $
# $Date: 2024/11/06 $
#
# Description : This document implements the security configuration as recommended by the
#               DISA Solaris 11 X86 v3r1 STIG.
#
#<ui_metadata>
#<display_name>DISA STIG Solaris 11 X86 v3r1</display_name>
#<spec>
#  <type>DISA STIG</type>
#  <name>Solaris 11</name>
#  <profile>x86</profile>
#  <version>3.1.0</version>
#  <link>https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip</link>
#</spec>
#<labels>disa,solaris_11</labels>
#<benchmark_refs>CAT,CCE,CCI,DISA_Benchmark,Group-ID,Rule-ID,STIG-ID,STIG-Legacy,Vuln-ID</benchmark_refs>
#<variables>
#  <variable>
#    <name>SYSLOG_SERVER</name>
#    <default>192.0.2.1</default>
#    <description>Remote syslog server</description>
#    <info>The IP address of the remote syslog server.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>SMTP_AUDIT_WARN_USERS</name>
#    <default>user1,user2</default>
#    <description>SMTP audit_warn user list</description>
#    <info>Comma separated list of users for SMTP audit warnings.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>ETC_HOSTS_ALLOW_LIST</name>
#    <default>192.168.1.0/255.255.255.0</default>
#    <description>/etc/hosts.allow subnet</description>
#    <info>Comma separated list of network addresses and their subnet blocks for /etc/hosts.allow</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>BANNER_TEXT</name>
#    <default>You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.\nBy using this IS (which includes any device attached to this IS), you consent to the following conditions:\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\n-At any time, the USG may inspect and seize data stored on this IS.\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.</default>
#    <description>Banner Text</description>
#    <info>This is the text for the warning a user receives when logging onto the system.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>GRUB_SUPERUSER</name>
#    <default>root</default>
#    <description>GRUB superuser</description>
#    <info>Superuser for GRUB authentication.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>AUDIT_FILES</name>
#    <default>/var/audit/*</default>
#    <description>SOL-11.1-070250 - Audit Files</description>
#    <info>SOL-11.1-070250 - Audit Files</info>
#    <value_type>UNIX_FILE_PATH</value_type>
#  </variable>
#  <variable>
#    <name>AUDIT_FILE_DIR</name>
#    <default>/var/audit</default>
#    <description>SOL-11.1-070250 - Audit File Dir</description>
#    <info>SOL-11.1-070250 - Audit File Dir</info>
#    <value_type>UNIX_FILE_PATH</value_type>
#  </variable>
#  <variable>
#    <name>CORE_FILE_DIR</name>
#    <default>/var/core</default>
#    <description>SOL-11.1-080050/60/70 - Core Dump Data Directory</description>
#    <info>SOL-11.1-080050/60/70 - Core Dump Data Directory</info>
#    <value_type>UNIX_FILE_PATH</value_type>
#  </variable>
#  <variable>
#    <name>NTP_SERVER</name>
#    <default>192\.168\.0\.1</default>
#    <description>SOL-11.1-090020 - NTP Server IP</description>
#    <info>SOL-11.1-090020 - The IP address of the NTP server for your organization.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>PLATFORM_VERSION</name>
#    <default>11</default>
#    <description>Solaris Version</description>
#    <info>Solaris Version</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>PASSWORD_MINUPPER</name>
#    <default>[1-9]</default>
#    <description>Password Minupper</description>
#    <info>Password minupper value set in /etc/default/passwd</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>PASSWORD_MINLOWER</name>
#    <default>[1-9]</default>
#    <description>Password Minlower</description>
#    <info>Password minlower value set in /etc/default/passwd</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>PASSWORD_DICTIONDBDIR</name>
#    <default>\\/var\\/passwd</default>
#    <description>Password Dictiondbdi</description>
#    <info>Password Dictiondbdi value set in /etc/default/passwd</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>PASSWORD_DICTIONLIST</name>
#    <default>\\/usr\\/share\\/lib\\/dict\\/words</default>
#    <description>Password Dictionlist</description>
#    <info>Password Dictionlist value set in /etc/default/passwd</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>PASSWORD_MAXWEEKS</name>
#    <default>[1-8]</default>
#    <description>Password Maxweeks</description>
#    <info>Password maxweeks value set in /etc/default/passwd</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>PASSWORD_MIN_WEEKS</name>
#    <default>[1-9]([0-9]+)?</default>
#    <description>Password Expiration - Minimum Weeks</description>
#    <info>Password expiration - Minimum Weeks set in /etc/default/passwd</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>PASSWORD_MIN_DAYS</name>
#    <default>[1-9]([0-9]+)?</default>
#    <description>Password minimum days</description>
#    <info>Minimum days between password changes parameter found in /etc/login.defs</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>PASSWORD_MINIMUM_LENGTH</name>
#    <default>(1[4-9]|[2-9][0-9])</default>
#    <description>Password Minimum Length</description>
#    <info>Password Minimum Length found in /etc/login.defs</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>PASSWORD_MINDIFF</name>
#    <default>([8-9]|[1-9][0-9]+)</default>
#    <description>Password Mindiff</description>
#    <info>Password Mindiff value set in /etc/default/passwd</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>PASSWORD_MINDIGIT</name>
#    <default>[1-9]</default>
#    <description>Password Mindigit</description>
#    <info>Password Mindigit value set in /etc/default/passwd</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>PASSWORD_MINSPECIAL</name>
#    <default>[1-9]</default>
#    <description>Password Minspecial</description>
#    <info>Password Minspecial value set in /etc/default/passwd</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>PASSWORD_MAXREPEATS</name>
#    <default>[0-3]</default>
#    <description>Password Maxrepeats</description>
#    <info>Password maxrepeats value set in /etc/default/passwd</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>FIND_TIMEOUT</name>
#    <default>7200</default>
#    <description>Timeout for checks that search for files</description>
#    <info>Timeout, in seconds, for checks that search for files. Range of 1-7200.</info>
#    <value_type>INTEGER</value_type>
#  </variable>
#</variables>
#</ui_metadata>

<check_type:"Unix">

<if>
  <condition type:"AND">
    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "Solaris 11 is installed"
      file        : "/etc/release"
      regex       : "^[\\s]+Oracle[\\s]+Solaris[\\s]"
      expect      : "^[\\s]+Oracle[\\s]+Solaris[\\s]+@PLATFORM_VERSION@"
    </custom_item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "DISA_STIG_Solaris_11_v3r1.audit from DISA Solaris 11 X86 v3r1 STIG"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
    </report>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : CMD_EXEC
          description : "Global zone auditing is configured."
          cmd         : "/usr/bin/zonename"
          expect      : "^global$"
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "SOL-11.1-010040 - The audit system must produce records containing sufficient information to establish the identity of any user/subject associated with the event."
          info        : "Enabling the audit system will produce records with accurate time stamps, source, user, and activity information. Without this information malicious activity cannot be accurately tracked."
          solution    : "The Audit Control profile is required.

This action applies to the global zone only. Determine the zone to be secured.

# zonename

If the command output is 'global', this action applies.

If auditing has been disabled, it must be enabled with the following command:

# pfexec audit -s"
          reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-3,800-53r5|AU-3f.,800-53r5|MA-3(5),CAT|II,CCI|CCI-001487,CCI|CCI-004188,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.3.3(a),CN-L3|8.1.4.3(b),CSF|PR.PT-1,CSF2.0|PR.PS-04,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-216011r986460_rule,STIG-ID|SOL-11.1-010040,STIG-Legacy|SV-60657,STIG-Legacy|V-47781,SWIFT-CSCv1|6.4,Vuln-ID|V-216011"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getcond"
          expect      : "audit condition[\\s]*=[\\s]*auditing"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "SOL-11.1-010060 - The audit system must support an audit reduction capability."
          info        : "Using the audit system will utilize the audit reduction capability. Without an audit reduction capability, users find it difficult to identify specific patterns of attack."
          solution    : "The Audit Control profile is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

If auditing has been disabled, it must be enabled with the following command:

# pfexec audit -s"
          reference   : "800-171|3.3.6,800-53|AU-7a.,800-53r5|AU-7a.,CAT|II,CCI|CCI-001877,CN-L3|7.1.2.3(c),CSF|PR.PT-1,CSF|RS.AN-3,CSF2.0|PR.PS-04,CSF2.0|RS.AN-03,CSF2.0|RS.AN-06,CSF2.0|RS.AN-07,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-7,NESA|T3.6.3,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,Rule-ID|SV-219988r958768_rule,STIG-ID|SOL-11.1-010060,STIG-Legacy|SV-60659,STIG-Legacy|V-47783,SWIFT-CSCv1|6.4,Vuln-ID|V-219988"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getcond"
          expect      : "audit condition[\\s]*=[\\s]*auditing"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "SOL-11.1-010070 - The audit system records must be able to be used by a report generation capability."
          info        : "Enabling the audit system will produce records for use in report generation.  Without an audit reporting capability, users find it difficult to identify specific patterns of attack."
          solution    : "The Audit Control profile is required.

This action applies to the global zone only.  Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

If auditing has been disabled, it must be enabled with the following command:

# pfexec audit -s"
          reference   : "800-171|3.3.6,800-53|AU-7a.,800-53r5|AU-7a.,CAT|II,CCI|CCI-001880,CN-L3|7.1.2.3(c),CSF|PR.PT-1,CSF|RS.AN-3,CSF2.0|PR.PS-04,CSF2.0|RS.AN-03,CSF2.0|RS.AN-06,CSF2.0|RS.AN-07,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-7,NESA|T3.6.3,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,Rule-ID|SV-219989r958774_rule,STIG-ID|SOL-11.1-010070,STIG-Legacy|SV-60661,STIG-Legacy|V-47785,SWIFT-CSCv1|6.4,Vuln-ID|V-219989"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getcond"
          expect      : "audit condition[\\s]*=[\\s]*auditing"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "SOL-11.1-010080 - The operating system must provide the capability to automatically process audit records for events of interest based upon selectable, event criteria."
          info        : "Without an audit reporting capability, users find it difficult to identify specific patterns of attack."
          solution    : "The Audit Control profile is required.

This action applies to the global zone only.  Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

If auditing has been disabled, it must be enabled with the following command:

# pfexec audit -s"
          reference   : "800-171|3.3.6,800-53|AU-7(1),800-53r5|AU-7(1),CAT|II,CCI|CCI-000158,CN-L3|7.1.2.3(c),CSF|PR.PT-1,CSF|RS.AN-3,CSF2.0|PR.PS-04,CSF2.0|RS.AN-03,CSF2.0|RS.AN-06,CSF2.0|RS.AN-07,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-7(1),QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,Rule-ID|SV-216014r958430_rule,STIG-ID|SOL-11.1-010080,STIG-Legacy|SV-60663,STIG-Legacy|V-47787,SWIFT-CSCv1|6.4,Vuln-ID|V-216014"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getcond"
          expect      : "audit condition[\\s]*=[\\s]*auditing"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "SOL-11.1-010100 - The audit records must provide data for all auditable events defined at the organizational level for the organization-defined information system components."
          info        : "Without auditing, individual system accesses cannot be tracked, and malicious activity cannot be detected and traced back to an individual account.

Without accurate time stamps, source, user, and activity information, malicious activity cannot be accurately tracked.

Without an audit reduction and reporting capability, users find it difficult to identify specific patterns of attack."
          solution    : "The Audit Control profile is required.

This action applies to the global zone only.  Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

If auditing has been disabled, it must be enabled with the following command:

# pfexec audit -s"
          reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12a.,800-53r5|AU-12a.,CAT|II,CCI|CCI-000169,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|DE.CM-09,CSF2.0|PR.PS-04,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-12a.,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-216015r958442_rule,STIG-ID|SOL-11.1-010100,STIG-Legacy|SV-60665,STIG-Legacy|V-47789,SWIFT-CSCv1|6.4,Vuln-ID|V-216015"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getcond"
          expect      : "audit condition[\\s]*=[\\s]*auditing"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "SOL-11.1-010120 - The operating system must generate audit records for the selected list of auditable events as defined in DoD list of events."
          info        : "Without auditing, individual system accesses cannot be tracked, and malicious activity cannot be detected and traced back to an individual account.

Without accurate time stamps, source, user, and activity information, malicious activity cannot be accurately tracked.

Without an audit reduction and reporting capability, users find it difficult to identify specific patterns of attack."
          solution    : "The Audit Control profile is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

If auditing has been disabled, it must be enabled with the following command:

# pfexec audit -s"
          reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,800-53r5|AU-12c.,CAT|II,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|DE.CM-09,CSF2.0|PR.PS-04,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-216016r958446_rule,STIG-ID|SOL-11.1-010120,STIG-Legacy|SV-60667,STIG-Legacy|V-47791,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-216016"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getcond"
          expect      : "audit condition[\\s]*=[\\s]*auditing"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "SOL-11.1-010130 - The operating system must support the capability to compile audit records from multiple components within the system into a system-wide (logical or physical) audit trail that is time-correlated to within organization-defined level of tolerance."
          info        : "Without auditing, individual system accesses cannot be tracked, and malicious activity cannot be detected and traced back to an individual account.

Without accurate time stamps, source, user, and activity information, malicious activity cannot be accurately tracked.

Without an audit reduction and reporting capability, users find it difficult to identify specific patterns of attack."
          solution    : "The Audit Control profile is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

If auditing has been disabled, it must be enabled with the following command:

# pfexec audit -s"
          reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12a.,800-53r5|AU-12a.,CAT|II,CCI|CCI-000169,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|DE.CM-09,CSF2.0|PR.PS-04,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-12a.,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-219990r958442_rule,STIG-ID|SOL-11.1-010130,STIG-Legacy|SV-60669,STIG-Legacy|V-47793,SWIFT-CSCv1|6.4,Vuln-ID|V-219990"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getcond"
          expect      : "audit condition[\\s]*=[\\s]*auditing"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "SOL-11.1-010140 - Audit records must include what type of events occurred."
          info        : "Without proper system auditing, individual system accesses cannot be tracked, and malicious activity cannot be detected and traced back to an individual account."
          solution    : "The Audit Control profile is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

If auditing has been disabled, it must be enabled with the following command:

# pfexec audit -s"
          reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-3,800-53r5|AU-3a.,CAT|II,CCI|CCI-000130,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.3.3(a),CN-L3|8.1.4.3(b),CSF|PR.PT-1,CSF2.0|PR.PS-04,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-216018r958412_rule,STIG-ID|SOL-11.1-010140,STIG-Legacy|SV-60671,STIG-Legacy|V-47795,SWIFT-CSCv1|6.4,Vuln-ID|V-216018"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getcond"
          expect      : "audit condition[\\s]*=[\\s]*auditing"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "SOL-11.1-010150 - Audit records must include when (date and time) the events occurred."
          info        : "Without accurate time stamps malicious activity cannot be accurately tracked."
          solution    : "The Audit Control profile is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

If auditing has been disabled, it must be enabled with the following command:

# pfexec audit -s"
          reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-3,800-53r5|AU-3b.,CAT|II,CCI|CCI-000131,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.3.3(a),CN-L3|8.1.4.3(b),CSF|PR.PT-1,CSF2.0|PR.PS-04,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-216019r958414_rule,STIG-ID|SOL-11.1-010150,STIG-Legacy|SV-60673,STIG-Legacy|V-47797,SWIFT-CSCv1|6.4,Vuln-ID|V-216019"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getcond"
          expect      : "audit condition[\\s]*=[\\s]*auditing"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "SOL-11.1-010160 - Audit records must include where the events occurred."
          info        : "Without auditing, individual system accesses cannot be tracked, and malicious activity cannot be detected and traced back to an individual account.

Without accurate time stamps, source, user, and activity information, malicious activity cannot be accurately tracked.

Without an audit reduction and reporting capability, users find it difficult to identify specific patterns of attack."
          solution    : "The Audit Control profile is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

If auditing has been disabled, it must be enabled with the following command:

# pfexec audit -s"
          reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-3,800-53r5|AU-3c.,CAT|II,CCI|CCI-000132,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.3.3(a),CN-L3|8.1.4.3(b),CSF|PR.PT-1,CSF2.0|PR.PS-04,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-216020r958416_rule,STIG-ID|SOL-11.1-010160,STIG-Legacy|SV-60675,STIG-Legacy|V-47799,SWIFT-CSCv1|6.4,Vuln-ID|V-216020"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getcond"
          expect      : "audit condition[\\s]*=[\\s]*auditing"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "SOL-11.1-010170 - Audit records must include the sources of the events that occurred."
          info        : "Without accurate source information malicious activity cannot be accurately tracked."
          solution    : "The Audit Control profile is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

If auditing has been disabled, it must be enabled with the following command:

# pfexec audit -s"
          reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-3,800-53r5|AU-3d.,CAT|II,CCI|CCI-000133,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.3.3(a),CN-L3|8.1.4.3(b),CSF|PR.PT-1,CSF2.0|PR.PS-04,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-216021r958418_rule,STIG-ID|SOL-11.1-010170,STIG-Legacy|SV-60677,STIG-Legacy|V-47801,SWIFT-CSCv1|6.4,Vuln-ID|V-216021"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getcond"
          expect      : "audit condition[\\s]*=[\\s]*auditing"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "SOL-11.1-010180 - Audit records must include the outcome (success or failure) of the events that occurred."
          info        : "Tracking both the successful and unsuccessful attempts aids in identifying threats to the system."
          solution    : "The Audit Control profile is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

If auditing has been disabled, it must be enabled with the following command:

# pfexec audit -s"
          reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-3,800-53r5|AU-3e.,CAT|II,CCI|CCI-000134,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.3.3(a),CN-L3|8.1.4.3(b),CSF|PR.PT-1,CSF2.0|PR.PS-04,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-216022r958420_rule,STIG-ID|SOL-11.1-010180,STIG-Legacy|SV-60679,STIG-Legacy|V-47803,SWIFT-CSCv1|6.4,Vuln-ID|V-216022"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getcond"
          expect      : "audit condition[\\s]*=[\\s]*auditing"
        </custom_item>

        <if>
          <condition type:"AND">
            <custom_item>
              type        : CMD_EXEC
              description : "Check for Solaris 11.0 - 11.3."
              cmd         : "uname -v"
              expect      : "^[\\s]*11\\.[0-3]"
            </custom_item>
          </condition>

          <then>
            <if>
              <condition auto:"FAILED" type:"AND">
                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getflags fd"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getflags | /usr/bin/grep active | /usr/bin/sed s/\'active user default audit flags =\'// | /usr/bin/grep fd | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>

                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getpolicy"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getpolicy | /usr/bin/grep active | /usr/bin/grep argv | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>
              </condition>

              <then>
                <report type:"PASSED">
                  description : "SOL-11.1-010220 - The audit system must be configured to audit file deletions."
                  info        : "Without auditing, malicious activity cannot be detected."
                  solution    : "The Audit Configuration profile is required. All audit flags must be enabled in a single command.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

For Solaris 11, 11.1, 11.2, and 11.3:
# pfexec auditconfig -setflags cusa,-ps,fd,-fa,fm

For Solaris 11.4 or newer:
# pfexec auditconfig -setflags cusa,-fa,-ex,-ps,fd,fm

Enable the audit policy to collect command line arguments.

# pfexec auditconfig -setpolicy +argv

These changes will not affect users that are currently logged in."
                  reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216023r959010_rule,STIG-ID|SOL-11.1-010220,STIG-Legacy|SV-60681,STIG-Legacy|V-47805,SWIFT-CSCv1|2.3,Vuln-ID|V-216023"
                  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
                  show_output : YES
                </report>
              </then>
            </if>
          </then>

          <else>
            <if>
              <condition auto:"FAILED" type:"AND">
                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getflags fd"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -t -getflags | /usr/bin/grep active | /usr/bin/sed s/\'active user default audit flags =\'// | /usr/bin/grep fd | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>

                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getpolicy"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getpolicy | /usr/bin/grep active | /usr/bin/grep argv | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>
              </condition>

              <then>
                <report type:"PASSED">
                  description : "SOL-11.1-010220 - The audit system must be configured to audit file deletions."
                  info        : "Without auditing, malicious activity cannot be detected."
                  solution    : "The Audit Configuration profile is required. All audit flags must be enabled in a single command.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

For Solaris 11, 11.1, 11.2, and 11.3:
# pfexec auditconfig -setflags cusa,-ps,fd,-fa,fm

For Solaris 11.4 or newer:
# pfexec auditconfig -setflags cusa,-fa,-ex,-ps,fd,fm

Enable the audit policy to collect command line arguments.

# pfexec auditconfig -setpolicy +argv

These changes will not affect users that are currently logged in."
                  reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216023r959010_rule,STIG-ID|SOL-11.1-010220,STIG-Legacy|SV-60681,STIG-Legacy|V-47805,SWIFT-CSCv1|2.3,Vuln-ID|V-216023"
                  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
                  show_output : YES
                </report>
              </then>
            </if>
          </else>
        </if>

        <if>
          <condition type:"AND">
            <custom_item>
              type        : CMD_EXEC
              description : "Check for Solaris 11.0 - 11.3."
              cmd         : "uname -v"
              expect      : "^[\\s]*11\\.[0-3]"
            </custom_item>
          </condition>

          <then>
            <if>
              <condition auto:"FAILED" type:"AND">
                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getflags"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getflags | /usr/bin/grep active | /usr/bin/sed s/\'active user default audit flags =\'// | /usr/bin/grep ps | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>

                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getpolicy"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getpolicy | /usr/bin/grep active | /usr/bin/grep argv | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>
              </condition>

              <then>
                <report type:"PASSED">
                  description : "SOL-11.1-010230 - The audit system must be configured to audit account creation."
                  info        : "Without auditing, malicious activity cannot be detected."
                  solution    : "The Audit Configuration profile is required. All audit flags must be enabled in a single command.

This action applies to the global zone only. Determine the zone currently being secured.

# zonename

If the command output is  'global ', this action applies.

For Solaris 11, 11.1, 11.2, and 11.3:
# pfexec auditconfig -setflags cusa,-ps,fd,-fa,fm

For Solaris 11.4 or newer:
# pfexec auditconfig -setflags cusa,-fa,-ex,-ps,fd,fm

Enable the audit policy to collect command line arguments.

# pfexec auditconfig -setpolicy +argv

These changes will not affect users that are currently logged in."
                  reference   : "800-171|3.1.1,800-53|AC-2(4),800-53r5|AC-2(4),CAT|II,CCI|CCI-000018,CN-L3|7.1.3.2(d),CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|PR.AA-01,CSF2.0|PR.AA-05,CSF2.0|PR.DS-10,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(4),NESA|T5.2.2,NIAv2|AM9a,NIAv2|AM9b,NIAv2|AM9c,NIAv2|AM9d,NIAv2|AM9e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,Rule-ID|SV-216024r958368_rule,STIG-ID|SOL-11.1-010230,STIG-Legacy|SV-60683,STIG-Legacy|V-47807,TBA-FIISB|36.2.3,Vuln-ID|V-216024"
                  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
                  show_output : YES
                </report>
              </then>
            </if>
          </then>

          <else>
            <if>
              <condition auto:"FAILED" type:"AND">
                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getflags"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -t -getflags | /usr/bin/grep active | /usr/bin/sed s/\'active user default audit flags =\'// | /usr/bin/grep 'cusa,fm,fd,-fa,-ps,-ex' | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>

                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getpolicy"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getpolicy | /usr/bin/grep active | /usr/bin/grep argv | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>
              </condition>

              <then>
                <report type:"PASSED">
                  description : "SOL-11.1-010230 - The audit system must be configured to audit account creation."
                  info        : "Without auditing, malicious activity cannot be detected."
                  solution    : "The Audit Configuration profile is required. All audit flags must be enabled in a single command.

This action applies to the global zone only. Determine the zone currently being secured.

# zonename

If the command output is  'global ', this action applies.

For Solaris 11, 11.1, 11.2, and 11.3:
# pfexec auditconfig -setflags cusa,-ps,fd,-fa,fm

For Solaris 11.4 or newer:
# pfexec auditconfig -setflags cusa,-fa,-ex,-ps,fd,fm

Enable the audit policy to collect command line arguments.

# pfexec auditconfig -setpolicy +argv

These changes will not affect users that are currently logged in."
                  reference   : "800-171|3.1.1,800-53|AC-2(4),800-53r5|AC-2(4),CAT|II,CCI|CCI-000018,CN-L3|7.1.3.2(d),CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|PR.AA-01,CSF2.0|PR.AA-05,CSF2.0|PR.DS-10,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(4),NESA|T5.2.2,NIAv2|AM9a,NIAv2|AM9b,NIAv2|AM9c,NIAv2|AM9d,NIAv2|AM9e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,Rule-ID|SV-216024r958368_rule,STIG-ID|SOL-11.1-010230,STIG-Legacy|SV-60683,STIG-Legacy|V-47807,TBA-FIISB|36.2.3,Vuln-ID|V-216024"
                  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
                  show_output : YES
                </report>
              </then>
            </if>
          </else>
        </if>

        <if>
          <condition type:"AND">
            <custom_item>
              type        : CMD_EXEC
              description : "Check for Solaris 11.0 - 11.3."
              cmd         : "uname -v"
              expect      : "^[\\s]*11\\.[0-3]"
            </custom_item>
          </condition>

          <then>
            <if>
              <condition auto:"FAILED" type:"AND">
                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getflags"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getflags | /usr/bin/grep active | /usr/bin/sed s/\'active user default audit flags =\'// | /usr/bin/grep ps | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>

                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getpolicy"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getpolicy | /usr/bin/grep active | /usr/bin/grep argv | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>
              </condition>

              <then>
                <report type:"PASSED">
                  description : "SOL-11.1-010250 - The audit system must be configured to audit account modification."
                  info        : "Without auditing, malicious activity cannot be detected."
                  solution    : "The Audit Configuration profile is required. All audit flags must be enabled in a single command.

This action applies to the global zone only. Determine the zone currently being secured.

# zonename

If the command output is  'global ', this action applies.

For Solaris 11, 11.1, 11.2, and 11.3:
# pfexec auditconfig -setflags cusa,-ps,fd,-fa,fm

For Solaris 11.4 or newer:
# pfexec auditconfig -setflags cusa,-fa,-ex,-ps,fd,fm

Enable the audit policy to collect command line arguments.

# pfexec auditconfig -setpolicy +argv

These changes will not affect users that are currently logged in."
                  reference   : "800-171|3.1.1,800-53|AC-2(4),800-53r5|AC-2(4),CAT|II,CCI|CCI-001403,CN-L3|7.1.3.2(d),CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|PR.AA-01,CSF2.0|PR.AA-05,CSF2.0|PR.DS-10,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(4),NESA|T5.2.2,NIAv2|AM9a,NIAv2|AM9b,NIAv2|AM9c,NIAv2|AM9d,NIAv2|AM9e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,Rule-ID|SV-216025r958590_rule,STIG-ID|SOL-11.1-010250,STIG-Legacy|SV-60685,STIG-Legacy|V-47809,TBA-FIISB|36.2.3,Vuln-ID|V-216025"
                  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
                  show_output : YES
                </report>
              </then>
            </if>
          </then>

          <else>
            <if>
              <condition auto:"FAILED" type:"AND">
                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getflags"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -t -getflags | /usr/bin/grep active | /usr/bin/sed s/\'active user default audit flags =\'// | /usr/bin/grep 'cusa,fm,fd,-fa,-ps,-ex' | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>

                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getpolicy"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getpolicy | /usr/bin/grep active | /usr/bin/grep argv | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>
              </condition>

              <then>
                <report type:"PASSED">
                  description : "SOL-11.1-010250 - The audit system must be configured to audit account modification."
                  info        : "Without auditing, malicious activity cannot be detected."
                  solution    : "The Audit Configuration profile is required. All audit flags must be enabled in a single command.

This action applies to the global zone only. Determine the zone currently being secured.

# zonename

If the command output is  'global ', this action applies.

For Solaris 11, 11.1, 11.2, and 11.3:
# pfexec auditconfig -setflags cusa,-ps,fd,-fa,fm

For Solaris 11.4 or newer:
# pfexec auditconfig -setflags cusa,-fa,-ex,-ps,fd,fm

Enable the audit policy to collect command line arguments.

# pfexec auditconfig -setpolicy +argv

These changes will not affect users that are currently logged in."
                  reference   : "800-171|3.1.1,800-53|AC-2(4),800-53r5|AC-2(4),CAT|II,CCI|CCI-001403,CN-L3|7.1.3.2(d),CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|PR.AA-01,CSF2.0|PR.AA-05,CSF2.0|PR.DS-10,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(4),NESA|T5.2.2,NIAv2|AM9a,NIAv2|AM9b,NIAv2|AM9c,NIAv2|AM9d,NIAv2|AM9e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,Rule-ID|SV-216025r958590_rule,STIG-ID|SOL-11.1-010250,STIG-Legacy|SV-60685,STIG-Legacy|V-47809,TBA-FIISB|36.2.3,Vuln-ID|V-216025"
                  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
                  show_output : YES
                </report>
              </then>
            </if>
          </else>
        </if>

        <if>
          <condition type:"AND">
            <custom_item>
              type        : CMD_EXEC
              description : "Check for Solaris 11.0 - 11.3."
              cmd         : "uname -v"
              expect      : "^[\\s]*11\\.[0-3]"
            </custom_item>
          </condition>

          <then>
            <if>
              <condition auto:"FAILED" type:"AND">
                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getflags"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getflags | /usr/bin/grep active | /usr/bin/sed s/\'active user default audit flags =\'// | /usr/bin/grep ps | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>

                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getpolicy"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getpolicy | /usr/bin/grep active | /usr/bin/grep argv | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>
              </condition>

              <then>
                <report type:"PASSED">
                  description : "SOL-11.1-010260 - The operating system must automatically audit account disabling actions."
                  info        : "Without auditing, malicious activity cannot be detected."
                  solution    : "The Audit Configuration profile is required. All audit flags must be enabled in a single command.

This action applies to the global zone only. Determine the zone currently being secured.

# zonename

If the command output is  'global ', this action applies.

For Solaris 11, 11.1, 11.2, and 11.3:
# pfexec auditconfig -setflags cusa,-ps,fd,-fa,fm

For Solaris 11.4 or newer:
# pfexec auditconfig -setflags cusa,-fa,-ex,-ps,fd,fm

Enable the audit policy to collect command line arguments.

# pfexec auditconfig -setpolicy +argv

These changes will not affect users that are currently logged in."
                  reference   : "800-171|3.1.1,800-53|AC-2(4),800-53r5|AC-2(4),CAT|II,CCI|CCI-001404,CN-L3|7.1.3.2(d),CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|PR.AA-01,CSF2.0|PR.AA-05,CSF2.0|PR.DS-10,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(4),NESA|T5.2.2,NIAv2|AM9a,NIAv2|AM9b,NIAv2|AM9c,NIAv2|AM9d,NIAv2|AM9e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,Rule-ID|SV-216026r958592_rule,STIG-ID|SOL-11.1-010260,STIG-Legacy|SV-60687,STIG-Legacy|V-47811,TBA-FIISB|36.2.3,Vuln-ID|V-216026"
                  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
                  show_output : YES
                </report>
              </then>
            </if>
          </then>

          <else>
            <if>
              <condition auto:"FAILED" type:"AND">
                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getflags"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -t -getflags | /usr/bin/grep active | /usr/bin/sed s/\'active user default audit flags =\'// | /usr/bin/grep 'cusa,fm,fd,-fa,-ps,-ex' | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>

                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getpolicy"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getpolicy | /usr/bin/grep active | /usr/bin/grep argv | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>
              </condition>

              <then>
                <report type:"PASSED">
                  description : "SOL-11.1-010260 - The operating system must automatically audit account disabling actions."
                  info        : "Without auditing, malicious activity cannot be detected."
                  solution    : "The Audit Configuration profile is required. All audit flags must be enabled in a single command.

This action applies to the global zone only. Determine the zone currently being secured.

# zonename

If the command output is  'global ', this action applies.

For Solaris 11, 11.1, 11.2, and 11.3:
# pfexec auditconfig -setflags cusa,-ps,fd,-fa,fm

For Solaris 11.4 or newer:
# pfexec auditconfig -setflags cusa,-fa,-ex,-ps,fd,fm

Enable the audit policy to collect command line arguments.

# pfexec auditconfig -setpolicy +argv

These changes will not affect users that are currently logged in."
                  reference   : "800-171|3.1.1,800-53|AC-2(4),800-53r5|AC-2(4),CAT|II,CCI|CCI-001404,CN-L3|7.1.3.2(d),CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|PR.AA-01,CSF2.0|PR.AA-05,CSF2.0|PR.DS-10,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(4),NESA|T5.2.2,NIAv2|AM9a,NIAv2|AM9b,NIAv2|AM9c,NIAv2|AM9d,NIAv2|AM9e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,Rule-ID|SV-216026r958592_rule,STIG-ID|SOL-11.1-010260,STIG-Legacy|SV-60687,STIG-Legacy|V-47811,TBA-FIISB|36.2.3,Vuln-ID|V-216026"
                  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
                  show_output : YES
                </report>
              </then>
            </if>
          </else>
        </if>

        <if>
          <condition type:"AND">
            <custom_item>
              type        : CMD_EXEC
              description : "Check for Solaris 11.0 - 11.3."
              cmd         : "uname -v"
              expect      : "^[\\s]*11\\.[0-3]"
            </custom_item>
          </condition>

          <then>
            <if>
              <condition auto:"FAILED" type:"AND">
                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getflags"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getflags | /usr/bin/grep active | /usr/bin/sed s/\'active user default audit flags =\'// | /usr/bin/grep ps | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>

                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getpolicy"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getpolicy | /usr/bin/grep active | /usr/bin/grep argv | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>
              </condition>

              <then>
                <report type:"PASSED">
                  description : "SOL-11.1-010270 - The operating system must automatically audit account termination."
                  info        : "Without auditing, malicious activity cannot be detected."
                  solution    : "The Audit Configuration profile is required. All audit flags must be enabled in a single command.

This action applies to the global zone only. Determine the zone currently being secured.

# zonename

If the command output is  'global ', this action applies.

For Solaris 11, 11.1, 11.2, and 11.3:
# pfexec auditconfig -setflags cusa,-ps,fd,-fa,fm

For Solaris 11.4 or newer:
# pfexec auditconfig -setflags cusa,-fa,-ex,-ps,fd,fm

Enable the audit policy to collect command line arguments.

# pfexec auditconfig -setpolicy +argv

These changes will not affect users that are currently logged in."
                  reference   : "800-171|3.1.1,800-53|AC-2(4),800-53r5|AC-2(4),CAT|II,CCI|CCI-001405,CN-L3|7.1.3.2(d),CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|PR.AA-01,CSF2.0|PR.AA-05,CSF2.0|PR.DS-10,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(4),NESA|T5.2.2,NIAv2|AM9a,NIAv2|AM9b,NIAv2|AM9c,NIAv2|AM9d,NIAv2|AM9e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,Rule-ID|SV-216027r958594_rule,STIG-ID|SOL-11.1-010270,STIG-Legacy|SV-60689,STIG-Legacy|V-47813,TBA-FIISB|36.2.3,Vuln-ID|V-216027"
                  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
                  show_output : YES
                </report>
              </then>
            </if>
          </then>

          <else>
            <if>
              <condition auto:"FAILED" type:"AND">
                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getflags"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -t -getflags | /usr/bin/grep active | /usr/bin/sed s/\'active user default audit flags =\'// | /usr/bin/grep 'cusa,fm,fd,-fa,-ps,-ex' | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>

                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getpolicy"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getpolicy | /usr/bin/grep active | /usr/bin/grep argv | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>
              </condition>

              <then>
                <report type:"PASSED">
                  description : "SOL-11.1-010270 - The operating system must automatically audit account termination."
                  info        : "Without auditing, malicious activity cannot be detected."
                  solution    : "The Audit Configuration profile is required. All audit flags must be enabled in a single command.

This action applies to the global zone only. Determine the zone currently being secured.

# zonename

If the command output is  'global ', this action applies.

For Solaris 11, 11.1, 11.2, and 11.3:
# pfexec auditconfig -setflags cusa,-ps,fd,-fa,fm

For Solaris 11.4 or newer:
# pfexec auditconfig -setflags cusa,-fa,-ex,-ps,fd,fm

Enable the audit policy to collect command line arguments.

# pfexec auditconfig -setpolicy +argv

These changes will not affect users that are currently logged in."
                  reference   : "800-171|3.1.1,800-53|AC-2(4),800-53r5|AC-2(4),CAT|II,CCI|CCI-001405,CN-L3|7.1.3.2(d),CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|PR.AA-01,CSF2.0|PR.AA-05,CSF2.0|PR.DS-10,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(4),NESA|T5.2.2,NIAv2|AM9a,NIAv2|AM9b,NIAv2|AM9c,NIAv2|AM9d,NIAv2|AM9e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,Rule-ID|SV-216027r958594_rule,STIG-ID|SOL-11.1-010270,STIG-Legacy|SV-60689,STIG-Legacy|V-47813,TBA-FIISB|36.2.3,Vuln-ID|V-216027"
                  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
                  show_output : YES
                </report>
              </then>
            </if>
          </else>
        </if>

        <if>
          <condition type:"AND">
            <custom_item>
              type        : CMD_EXEC
              description : "Check for Solaris 11.0 - 11.3."
              cmd         : "uname -v"
              expect      : "^[\\s]*11\\.[0-3]"
            </custom_item>
          </condition>

          <then>
            <if>
              <condition auto:"FAILED" type:"AND">
                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getflags"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getflags | /usr/bin/grep active | /usr/bin/sed s/\'active user default audit flags =\'// | /usr/bin/grep as | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>

                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getpolicy"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getpolicy | /usr/bin/grep active | /usr/bin/grep argv | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>
              </condition>

              <then>
                <report type:"PASSED">
                  description : "SOL-11.1-010290 - The operating system must ensure unauthorized, security-relevant configuration changes detected are tracked."
                  info        : "Without auditing, malicious activity cannot be detected."
                  solution    : "The Audit Configuration profile is required. All audit flags must be enabled in a single command.

This action applies to the global zone only. Determine the zone currently being secured.

# zonename

If the command output is  'global ', this action applies.

For Solaris 11, 11.1, 11.2, and 11.3:
# pfexec auditconfig -setflags cusa,-ps,fd,-fa,fm

For Solaris 11.4 or newer:
# pfexec auditconfig -setflags cusa,-fa,-ex,-ps,fd,fm

Enable the audit policy to collect command line arguments.

# pfexec auditconfig -setpolicy +argv

These changes will not affect users that are currently logged in."
                  reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216028r959010_rule,STIG-ID|SOL-11.1-010290,STIG-Legacy|SV-60691,STIG-Legacy|V-47815,SWIFT-CSCv1|2.3,Vuln-ID|V-216028"
                  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
                  show_output : YES
                </report>
              </then>
            </if>
          </then>

          <else>
            <if>
              <condition auto:"FAILED" type:"AND">
                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getflags"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getflags | /usr/bin/grep active | /usr/bin/sed s/\'active user default audit flags =\'// | /usr/bin/grep 'cusa,fm,fd,-fa,-ps,-ex' | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>

                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getpolicy"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getpolicy | /usr/bin/grep active | /usr/bin/grep argv | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>
              </condition>

              <then>
                <report type:"PASSED">
                  description : "SOL-11.1-010290 - The operating system must ensure unauthorized, security-relevant configuration changes detected are tracked."
                  info        : "Without auditing, malicious activity cannot be detected."
                  solution    : "The Audit Configuration profile is required. All audit flags must be enabled in a single command.

This action applies to the global zone only. Determine the zone currently being secured.

# zonename

If the command output is  'global ', this action applies.

For Solaris 11, 11.1, 11.2, and 11.3:
# pfexec auditconfig -setflags cusa,-ps,fd,-fa,fm

For Solaris 11.4 or newer:
# pfexec auditconfig -setflags cusa,-fa,-ex,-ps,fd,fm

Enable the audit policy to collect command line arguments.

# pfexec auditconfig -setpolicy +argv

These changes will not affect users that are currently logged in."
                  reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216028r959010_rule,STIG-ID|SOL-11.1-010290,STIG-Legacy|SV-60691,STIG-Legacy|V-47815,SWIFT-CSCv1|2.3,Vuln-ID|V-216028"
                  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
                  show_output : YES
                </report>
              </then>
            </if>
          </else>
        </if>

        <if>
          <condition type:"AND">
            <custom_item>
              type        : CMD_EXEC
              description : "Check for Solaris 11.0 - 11.3."
              cmd         : "uname -v"
              expect      : "^[\\s]*11\\.[0-3]"
            </custom_item>
          </condition>

          <then>
            <if>
              <condition auto:"FAILED" type:"AND">
                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getflags"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getflags | /usr/bin/grep active | /usr/bin/sed s/\'active user default audit flags =\'// | /usr/bin/grep as | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>

                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getpolicy"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getpolicy | /usr/bin/grep active | /usr/bin/grep argv | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>
              </condition>

              <then>
                <report type:"PASSED">
                  description : "SOL-11.1-010300 - The audit system must be configured to audit all administrative, privileged, and security actions."
                  info        : "Without auditing, individual system accesses cannot be tracked, and malicious activity cannot be detected and traced back to an individual account."
                  solution    : "The Audit Configuration profile is required. All audit flags must be enabled in a single command.

This action applies to the global zone only. Determine the zone currently being secured.

# zonename

If the command output is  'global ', this action applies.

For Solaris 11, 11.1, 11.2, and 11.3:
# pfexec auditconfig -setflags cusa,-ps,fd,-fa,fm

For Solaris 11.4 or newer:
# pfexec auditconfig -setflags cusa,-fa,-ex,-ps,fd,fm

Enable the audit policy to collect command line arguments.

# pfexec auditconfig -setpolicy +argv

These changes will not affect users that are currently logged in."
                  reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216029r959010_rule,STIG-ID|SOL-11.1-010300,STIG-Legacy|SV-60693,STIG-Legacy|V-47817,SWIFT-CSCv1|2.3,Vuln-ID|V-216029"
                  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
                  show_output : YES
                </report>
              </then>
            </if>
          </then>

          <else>
            <if>
              <condition auto:"FAILED" type:"AND">
                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getflags"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getflags | /usr/bin/grep active | /usr/bin/sed s/\'active user default audit flags =\'// | /usr/bin/grep 'cusa,fm,fd,-fa,-ps,-ex' | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>

                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getpolicy"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getpolicy | /usr/bin/grep active | /usr/bin/grep argv | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>
              </condition>

              <then>
                <report type:"PASSED">
                  description : "SOL-11.1-010300 - The audit system must be configured to audit all administrative, privileged, and security actions."
                  info        : "Without auditing, individual system accesses cannot be tracked, and malicious activity cannot be detected and traced back to an individual account."
                  solution    : "The Audit Configuration profile is required. All audit flags must be enabled in a single command.

This action applies to the global zone only. Determine the zone currently being secured.

# zonename

If the command output is  'global ', this action applies.

For Solaris 11, 11.1, 11.2, and 11.3:
# pfexec auditconfig -setflags cusa,-ps,fd,-fa,fm

For Solaris 11.4 or newer:
# pfexec auditconfig -setflags cusa,-fa,-ex,-ps,fd,fm

Enable the audit policy to collect command line arguments.

# pfexec auditconfig -setpolicy +argv

These changes will not affect users that are currently logged in."
                  reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216029r959010_rule,STIG-ID|SOL-11.1-010300,STIG-Legacy|SV-60693,STIG-Legacy|V-47817,SWIFT-CSCv1|2.3,Vuln-ID|V-216029"
                  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
                  show_output : YES
                </report>
              </then>
            </if>
          </else>
        </if>

        <if>
          <condition type:"AND">
            <custom_item>
              type        : CMD_EXEC
              description : "Check for Solaris 11.0 - 11.3."
              cmd         : "uname -v"
              expect      : "^[\\s]*11\\.[0-3]"
            </custom_item>
          </condition>

          <then>
            <if>
              <condition auto:"FAILED" type:"AND">
                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getflags"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getflags | /usr/bin/grep active | /usr/bin/sed s/\'active user default audit flags =\'// | /usr/bin/grep lo | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>

                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getnaflags lo"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getnaflags | /usr/bin/grep active | /usr/bin/sed s/\'active user default audit flags =\'// | /usr/bin/grep lo | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>

                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getnaflags na"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getnaflags | /usr/bin/grep active | /usr/bin/sed s/\'active user default audit flags =\'// | /usr/bin/grep na | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>

                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getpolicy"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getpolicy | /usr/bin/grep active | /usr/bin/grep argv | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>
              </condition>

              <then>
                <report type:"PASSED">
                  description : "SOL-11.1-010310 - The audit system must be configured to audit login, logout, and session initiation."
                  info        : "Without auditing, individual system accesses cannot be tracked, and malicious activity cannot be detected and traced back to an individual account."
                  solution    : "The Audit Configuration profile is required. All audit flags must be enabled in a single command.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

For Solaris 11, 11.1, 11.2, and 11.3:
# pfexec auditconfig -setflags cusa,-ps,fd,-fa,fm
# pfexec auditconfig -setnaflags lo,na

For Solaris 11.4 or newer:
# pfexec auditconfig -setflags cusa,-fa,-ex,-ps,fd,fm
# pfexec auditconfig -setnaflags lo,na

Enable the audit policy to collect command line arguments.

# pfexec auditconfig -setpolicy +argv

These changes will not affect users that are currently logged in."
                  reference   : "800-171|3.1.12,800-53|AC-17(1),800-53r5|AC-17(1),CAT|III,CCI|CCI-000067,CN-L3|8.1.4.4(c),CN-L3|8.1.10.6(i),CSF|PR.AC-3,CSF|PR.PT-4,CSF2.0|PR.AA-05,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17(1),NESA|T5.4.4,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,Rule-ID|SV-216030r958406_rule,STIG-ID|SOL-11.1-010310,STIG-Legacy|SV-60695,STIG-Legacy|V-47819,SWIFT-CSCv1|2.6,Vuln-ID|V-216030"
                  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
                  show_output : YES
                </report>
              </then>
            </if>
          </then>

          <else>
            <if>
              <condition auto:"FAILED" type:"AND">
                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getflags"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -t -getflags | /usr/bin/grep active | /usr/bin/sed s/\'active user default audit flags =\'// | /usr/bin/grep 'cusa,fm,fd,-fa,-ps,-ex' | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>

                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getnaflags lo"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -t -getnaflags | /usr/bin/grep active | /usr/bin/sed s/\'active user default audit flags =\'// | /usr/bin/grep lo | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>

                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getnaflags na"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -t -getnaflags | /usr/bin/grep active | /usr/bin/sed s/\'active user default audit flags =\'// | /usr/bin/grep na | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>

                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getpolicy"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getpolicy | /usr/bin/grep active | /usr/bin/grep argv | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>
              </condition>

              <then>
                <report type:"PASSED">
                  description : "SOL-11.1-010310 - The audit system must be configured to audit login, logout, and session initiation."
                  info        : "Without auditing, individual system accesses cannot be tracked, and malicious activity cannot be detected and traced back to an individual account."
                  solution    : "The Audit Configuration profile is required. All audit flags must be enabled in a single command.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

For Solaris 11, 11.1, 11.2, and 11.3:
# pfexec auditconfig -setflags cusa,-ps,fd,-fa,fm
# pfexec auditconfig -setnaflags lo,na

For Solaris 11.4 or newer:
# pfexec auditconfig -setflags cusa,-fa,-ex,-ps,fd,fm
# pfexec auditconfig -setnaflags lo,na

Enable the audit policy to collect command line arguments.

# pfexec auditconfig -setpolicy +argv

These changes will not affect users that are currently logged in."
                  reference   : "800-171|3.1.12,800-53|AC-17(1),800-53r5|AC-17(1),CAT|III,CCI|CCI-000067,CN-L3|8.1.4.4(c),CN-L3|8.1.10.6(i),CSF|PR.AC-3,CSF|PR.PT-4,CSF2.0|PR.AA-05,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17(1),NESA|T5.4.4,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,Rule-ID|SV-216030r958406_rule,STIG-ID|SOL-11.1-010310,STIG-Legacy|SV-60695,STIG-Legacy|V-47819,SWIFT-CSCv1|2.6,Vuln-ID|V-216030"
                  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
                  show_output : YES
                </report>
              </then>
            </if>
          </else>
        </if>

        <if>
          <condition type:"AND">
            <custom_item>
              type        : CMD_EXEC
              description : "Check for Solaris 11.0 - 11.3."
              cmd         : "uname -v"
              expect      : "^[\\s]*11\\.[0-3]"
            </custom_item>
          </condition>

          <then>
            <if>
              <condition auto:"FAILED" type:"AND">
                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getflags"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getflags | /usr/bin/grep active | /usr/bin/sed s/\'active user default audit flags =\'// | /usr/bin/grep fm | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>

                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getpolicy"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getpolicy | /usr/bin/grep active | /usr/bin/grep argv | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>
              </condition>

              <then>
                <report type:"PASSED">
                  description : "SOL-11.1-010320 - The audit system must be configured to audit all discretionary access control permission modifications."
                  info        : "Without auditing, individual system accesses cannot be tracked, and malicious activity cannot be detected and traced back to an individual account."
                  solution    : "The Audit Configuration profile is required. All audit flags must be enabled in a single command.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

For Solaris 11, 11.1, 11.2, and 11.3:
# pfexec auditconfig -setflags cusa,-ps,fd,-fa,fm

For Solaris 11.4 or newer:
# pfexec auditconfig -setflags cusa,-fa,-ex,-ps,fd,fm

Enable the audit policy to collect command line arguments.

# pfexec auditconfig -setpolicy +argv

These changes will not affect users that are currently logged in."
                  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12a.,800-53r5|AU-12a.,CAT|II,CCI|CCI-000169,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|DE.CM-09,CSF2.0|PR.PS-04,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-12a.,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-219991r958442_rule,STIG-ID|SOL-11.1-010320,STIG-Legacy|SV-60697,STIG-Legacy|V-47821,SWIFT-CSCv1|6.4,Vuln-ID|V-219991"
                  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
                  show_output : YES
                </report>
              </then>
            </if>
          </then>

          <else>
            <if>
              <condition auto:"FAILED" type:"AND">
                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getflags"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -t -getflags | /usr/bin/grep active | /usr/bin/sed s/\'active user default audit flags =\'// | /usr/bin/grep fm | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>

                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getpolicy"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getpolicy | /usr/bin/grep active | /usr/bin/grep argv | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>
              </condition>

              <then>
                <report type:"PASSED">
                  description : "SOL-11.1-010320 - The audit system must be configured to audit all discretionary access control permission modifications."
                  info        : "Without auditing, individual system accesses cannot be tracked, and malicious activity cannot be detected and traced back to an individual account."
                  solution    : "The Audit Configuration profile is required. All audit flags must be enabled in a single command.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

For Solaris 11, 11.1, 11.2, and 11.3:
# pfexec auditconfig -setflags cusa,-ps,fd,-fa,fm

For Solaris 11.4 or newer:
# pfexec auditconfig -setflags cusa,-fa,-ex,-ps,fd,fm

Enable the audit policy to collect command line arguments.

# pfexec auditconfig -setpolicy +argv

These changes will not affect users that are currently logged in."
                  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12a.,800-53r5|AU-12a.,CAT|II,CCI|CCI-000169,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|DE.CM-09,CSF2.0|PR.PS-04,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-12a.,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-219991r958442_rule,STIG-ID|SOL-11.1-010320,STIG-Legacy|SV-60697,STIG-Legacy|V-47821,SWIFT-CSCv1|6.4,Vuln-ID|V-219991"
                  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
                  show_output : YES
                </report>
              </then>
            </if>
          </else>
        </if>

        <if>
          <condition type:"AND">
            <custom_item>
              type        : CMD_EXEC
              description : "Check for Solaris 11.0 - 11.3."
              cmd         : "uname -v"
              expect      : "^[\\s]*11\\.[0-3]"
            </custom_item>
          </condition>

          <then>
            <if>
              <condition auto:"FAILED" type:"AND">
                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getflags"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getflags | /usr/bin/grep active | /usr/bin/sed s/\'active user default audit flags =\'// | /usr/bin/grep as | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>

                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getpolicy"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getpolicy | /usr/bin/grep active | /usr/bin/grep argv | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>
              </condition>

              <then>
                <report type:"PASSED">
                  description : "SOL-11.1-010330 - The audit system must be configured to audit the loading and unloading of dynamic kernel modules."
                  info        : "Without auditing, individual system accesses cannot be tracked, and malicious activity cannot be detected and traced back to an individual account."
                  solution    : "The Audit Configuration profile is required. All audit flags must be enabled in a single command.

This action applies to the global zone only. Determine the zone currently being secured.

# zonename

If the command output is  'global ', this action applies.

For Solaris 11, 11.1, 11.2, and 11.3:
# pfexec auditconfig -setflags cusa,-ps,fd,-fa,fm

For Solaris 11.4 or newer:
# pfexec auditconfig -setflags cusa,-fa,-ex,-ps,fd,fm

Enable the audit policy to collect command line arguments.

# pfexec auditconfig -setpolicy +argv

These changes will not affect users that are currently logged in."
                  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12a.,800-53r5|AU-12a.,CAT|II,CCI|CCI-000169,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|DE.CM-09,CSF2.0|PR.PS-04,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-12a.,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-219992r958442_rule,STIG-ID|SOL-11.1-010330,STIG-Legacy|SV-60699,STIG-Legacy|V-47823,SWIFT-CSCv1|6.4,Vuln-ID|V-219992"
                  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
                  show_output : YES
                </report>
              </then>
            </if>
          </then>

          <else>
            <if>
              <condition auto:"FAILED" type:"AND">
                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getflags"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -t -getflags | /usr/bin/grep active | /usr/bin/sed s/\'active user default audit flags =\'// | /usr/bin/grep 'cusa,fm,fd,-fa,-ps,-ex' | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>

                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getpolicy"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getpolicy | /usr/bin/grep active | /usr/bin/grep argv | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>
              </condition>

              <then>
                <report type:"PASSED">
                  description : "SOL-11.1-010330 - The audit system must be configured to audit the loading and unloading of dynamic kernel modules."
                  info        : "Without auditing, individual system accesses cannot be tracked, and malicious activity cannot be detected and traced back to an individual account."
                  solution    : "The Audit Configuration profile is required. All audit flags must be enabled in a single command.

This action applies to the global zone only. Determine the zone currently being secured.

# zonename

If the command output is  'global ', this action applies.

For Solaris 11, 11.1, 11.2, and 11.3:
# pfexec auditconfig -setflags cusa,-ps,fd,-fa,fm

For Solaris 11.4 or newer:
# pfexec auditconfig -setflags cusa,-fa,-ex,-ps,fd,fm

Enable the audit policy to collect command line arguments.

# pfexec auditconfig -setpolicy +argv

These changes will not affect users that are currently logged in."
                  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12a.,800-53r5|AU-12a.,CAT|II,CCI|CCI-000169,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|DE.CM-09,CSF2.0|PR.PS-04,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-12a.,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-219992r958442_rule,STIG-ID|SOL-11.1-010330,STIG-Legacy|SV-60699,STIG-Legacy|V-47823,SWIFT-CSCv1|6.4,Vuln-ID|V-219992"
                  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
                  show_output : YES
                </report>
              </then>
            </if>
          </else>
        </if>

        <if>
          <condition type:"AND">
            <custom_item>
              type        : CMD_EXEC
              description : "Check for Solaris 11.0 - 11.3."
              cmd         : "uname -v"
              expect      : "^[\\s]*11\\.[0-3]"
            </custom_item>
          </condition>

          <then>
            <if>
              <condition auto:"FAILED" type:"AND">
                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getflags fa"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getflags | /usr/bin/grep active | /usr/bin/sed s/\'active user default audit flags =\'// | /usr/bin/grep fa | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>

                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getflags ps"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getflags | /usr/bin/grep active | /usr/bin/sed s/\'active user default audit flags =\'// | /usr/bin/grep ps | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>

                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getpolicy"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getpolicy | /usr/bin/grep active | /usr/bin/grep argv | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>
              </condition>

              <then>
                <report type:"PASSED">
                  description : "SOL-11.1-010340 - The audit system must be configured to audit failed attempts to access files and programs."
                  info        : "Without auditing, individual system accesses cannot be tracked, and malicious activity cannot be detected and traced back to an individual account."
                  solution    : "The Audit Configuration profile is required. All audit flags must be enabled in a single command.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

For Solaris 11, 11.1, 11.2, and 11.3:
# pfexec auditconfig -setflags cusa,-ps,fd,-fa,fm

For Solaris 11.4 or newer:
# pfexec auditconfig -setflags cusa,-fa,-ex,-ps,fd,fm

Enable the audit policy to collect command line arguments.

# pfexec auditconfig -setpolicy +argv

These changes will not affect users that are currently logged in."
                  reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216033r959010_rule,STIG-ID|SOL-11.1-010340,STIG-Legacy|SV-60701,STIG-Legacy|V-47825,SWIFT-CSCv1|2.3,Vuln-ID|V-216033"
                  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
                  show_output : YES
                </report>
              </then>
            </if>
          </then>

          <else>
            <if>
              <condition auto:"FAILED" type:"AND">
                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getflags fa"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -t -getflags | /usr/bin/grep active | /usr/bin/sed s/\'active user default audit flags =\'// | /usr/bin/grep fa | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>

                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getflags ps"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -t -getflags | /usr/bin/grep active | /usr/bin/sed s/\'active user default audit flags =\'// | /usr/bin/grep ps | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>

                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getflags ex"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -t -getflags | /usr/bin/grep active | /usr/bin/sed s/\'active user default audit flags =\'// | /usr/bin/grep ex | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>

                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "getpolicy"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getpolicy | /usr/bin/grep active | /usr/bin/grep argv | /usr/bin/awk \'{ print } END { if (NR != 0) print \"found\" }\'"
                  expect      : "found"
                </custom_item>
              </condition>

              <then>
                <report type:"PASSED">
                  description : "SOL-11.1-010340 - The audit system must be configured to audit failed attempts to access files and programs."
                  info        : "Without auditing, individual system accesses cannot be tracked, and malicious activity cannot be detected and traced back to an individual account."
                  solution    : "The Audit Configuration profile is required. All audit flags must be enabled in a single command.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

For Solaris 11, 11.1, 11.2, and 11.3:
# pfexec auditconfig -setflags cusa,-ps,fd,-fa,fm

For Solaris 11.4 or newer:
# pfexec auditconfig -setflags cusa,-fa,-ex,-ps,fd,fm

Enable the audit policy to collect command line arguments.

# pfexec auditconfig -setpolicy +argv

These changes will not affect users that are currently logged in."
                  reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216033r959010_rule,STIG-ID|SOL-11.1-010340,STIG-Legacy|SV-60701,STIG-Legacy|V-47825,SWIFT-CSCv1|2.3,Vuln-ID|V-216033"
                  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
                  show_output : YES
                </report>
              </then>
            </if>
          </else>
        </if>

        <if>
          <condition type:"AND">
            <custom_item>
              type        : CMD_EXEC
              description : "Default system-log service is online"
              cmd         : "/usr/bin/pfexec svcs system-log | /usr/bin/grep online | /usr/bin/grep default | /usr/bin/awk '{ print } END { if (NR != 0) print \"active\" }'"
              expect      : "active"
            </custom_item>
          </condition>

          <then>
            <if>
              <condition auto:"FAILED" type:"AND">
                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "'getplugin'"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getplugin | /usr/bin/grep audit_syslog | /usr/bin/grep -v inactive | /usr/bin/awk '{ print } END { if (NR != 0) print \"active\" }'"
                  expect      : "active"
                </custom_item>

                <custom_item>
                  system      : "SunOS"
                  type        : FILE_CONTENT_CHECK
                  description : "'.conf'"
                  file        : "/etc/syslog.conf"
                  regex       : "audit.notice"
                  expect      : "audit.notice (@|!)@SYSLOG_SERVER@"
                </custom_item>
              </condition>

              <then>
                <report type:"PASSED">
                  description : "SOL-11.1-010350 - The operating system must protect against an individual falsely denying having performed a particular action. In order to do so the system must be configured to send audit records to a remote audit server."
                  info        : "Keeping audit records on a remote system reduces the likelihood of audit records being changed or corrupted. Duplicating and protecting the audit trail on a separate system reduces the likelihood of an individual being able to deny performing an action.

Solaris has supported rsyslog since version 11.1 and the differences between syslog and rsyslog are numerous. Solaris 11.4 installs rsyslog by default, but previous versions require a manual installation. When establishing a rsyslog server to forward to, it is important to consider the network requirements for this action.  Note the following configuration options:
There are three ways to forward message: the traditional UDP transport, which is extremely lossy but standard; the plain TCP based transport, which loses messages only during certain situations but is widely available; and the RELP transport, which does not lose messages but is currently available only as part of the rsyslogd 3.15.0 and above.
Examples of each configuration:
UDP  *.* @remotesystemname
TCP  *.* @@remotesystemname
RELP  *.* :omrelp:remotesystemname:2514
Please note that a port number was given as there is no standard port for RELP."
                  solution    : "Service Management, Audit Configuration and Audit Control rights profile is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

Configure Solaris 11 to use the syslog audit plugin

# pfexec auditconfig -setplugin audit_syslog active

Determine which system-log service instance is online.

# pfexec svcs system-log

If the default system-log service is online:

# pfedit /etc/syslog.conf

Add the line:

audit.notice @[remotesystemname]
or
audit.notice ![remotesystemname]

Replacing the remote system name with the correct hostname.

If the rsyslog service is online, modify the /etc/rsyslog.conf file.

# pfedit /etc/rsyslog.conf

Add the line:

*.* @@[remotesystemname]
Or
*.* :omrelp:[remotesystemname]:[designatedportnumber]

Replacing the remote system name with the correct hostname.

Create the log file on the remote system

# touch /var/adm/auditlog

Refresh the syslog service

# pfexec svcadm refresh system/system-log:default

or

# pfexec svcadm refresh system/system-log:rsyslog

Refresh the audit service

# pfexec audit -s"
                  reference   : "800-53|AU-10,800-53r5|AU-10,CAT|III,CCI|CCI-000166,CSF|PR.PT-1,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-10,NESA|T4.3.1,NESA|T7.3.3,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-216034r958440_rule,STIG-ID|SOL-11.1-010350,STIG-Legacy|SV-60703,STIG-Legacy|V-47827,Vuln-ID|V-216034"
                  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
                  show_output : YES
                </report>
              </then>
            </if>
          </then>

          <else>
            <if>
              <condition auto:"FAILED" type:"AND">
                <custom_item>
                  system      : "SunOS"
                  type        : CMD_EXEC
                  description : "'getplugin'"
                  cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getplugin | /usr/bin/grep audit_syslog | /usr/bin/grep -v inactive | /usr/bin/awk '{ print } END { if (NR != 0) print \"active\" }'"
                  expect      : "active"
                </custom_item>

                <custom_item>
                  system      : "SunOS"
                  type        : FILE_CONTENT_CHECK
                  description : "'.conf'"
                  file        : "/etc/rsyslog.conf"
                  regex       : "(audit.notice|\\*\\.\\*)"
                  expect      : "(audit.notice|\\*\\.\\*) (@@|:omrelp:)@SYSLOG_SERVER@"
                </custom_item>
              </condition>

              <then>
                <report type:"PASSED">
                  description : "SOL-11.1-010350 - The operating system must protect against an individual falsely denying having performed a particular action. In order to do so the system must be configured to send audit records to a remote audit server."
                  info        : "Keeping audit records on a remote system reduces the likelihood of audit records being changed or corrupted. Duplicating and protecting the audit trail on a separate system reduces the likelihood of an individual being able to deny performing an action.

Solaris has supported rsyslog since version 11.1 and the differences between syslog and rsyslog are numerous. Solaris 11.4 installs rsyslog by default, but previous versions require a manual installation. When establishing a rsyslog server to forward to, it is important to consider the network requirements for this action.  Note the following configuration options:
There are three ways to forward message: the traditional UDP transport, which is extremely lossy but standard; the plain TCP based transport, which loses messages only during certain situations but is widely available; and the RELP transport, which does not lose messages but is currently available only as part of the rsyslogd 3.15.0 and above.
Examples of each configuration:
UDP  *.* @remotesystemname
TCP  *.* @@remotesystemname
RELP  *.* :omrelp:remotesystemname:2514
Please note that a port number was given as there is no standard port for RELP."
                  solution    : "Service Management, Audit Configuration and Audit Control rights profile is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

Configure Solaris 11 to use the syslog audit plugin

# pfexec auditconfig -setplugin audit_syslog active

Determine which system-log service instance is online.

# pfexec svcs system-log

If the default system-log service is online:

# pfedit /etc/syslog.conf

Add the line:

audit.notice @[remotesystemname]
or
audit.notice ![remotesystemname]

Replacing the remote system name with the correct hostname.

If the rsyslog service is online, modify the /etc/rsyslog.conf file.

# pfedit /etc/rsyslog.conf

Add the line:

*.* @@[remotesystemname]
Or
*.* :omrelp:[remotesystemname]:[designatedportnumber]

Replacing the remote system name with the correct hostname.

Create the log file on the remote system

# touch /var/adm/auditlog

Refresh the syslog service

# pfexec svcadm refresh system/system-log:default

or

# pfexec svcadm refresh system/system-log:rsyslog

Refresh the audit service

# pfexec audit -s"
                  reference   : "800-53|AU-10,800-53r5|AU-10,CAT|III,CCI|CCI-000166,CSF|PR.PT-1,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-10,NESA|T4.3.1,NESA|T7.3.3,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-216034r958440_rule,STIG-ID|SOL-11.1-010350,STIG-Legacy|SV-60703,STIG-Legacy|V-47827,Vuln-ID|V-216034"
                  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
                  show_output : YES
                </report>
              </then>
            </if>
          </else>
        </if>

        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "SOL-11.1-010360 - The auditing system must not define a different auditing level for specific users."
          info        : "Without auditing, individual system accesses cannot be tracked, and malicious activity cannot be detected and traced back to an individual account."
          solution    : "The root role is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

For each user on the system, remove all special audit configuration flags.

# usermod -K audit_flags= [username]"
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216035r959010_rule,STIG-ID|SOL-11.1-010360,STIG-Legacy|SV-60705,STIG-Legacy|V-47831,SWIFT-CSCv1|2.3,Vuln-ID|V-216035"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          cmd         : "/usr/bin/echo $(for user in $(/usr/bin/cut -d: -f1 /etc/passwd | /usr/bin/egrep -v '^root'); do echo \"$user: $(userattr -v audit_flags $user 2>&1)\"; done | awk '/user_attr/ { print; f++} END { if (!f) print \"no user attributes assigned\" }')"
          expect      : "no user attributes assigned"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : FILE_CONTENT_CHECK
          description : "SOL-11.1-010370 - The audit system must alert the SA when the audit storage volume approaches its capacity."
          info        : "Filling the audit storage area can result in a denial of service or system outage and can lead to events going undetected."
          solution    : "The root role is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

Add an audit_warn alias to /etc/mail/aliases that will forward to designated system administrator(s).

# pfedit /etc/mail/aliases

Insert a line in the form:
audit_warn:user1,user2

Put the updated aliases file into service.
# newaliases"
          reference   : "800-171|3.3.4,800-53|AU-5(1),800-53r5|AU-5(1),CAT|II,CCI|CCI-001855,CN-L3|7.1.3.7(e),CSF|PR.PT-1,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-5(1),NESA|T3.3.1,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-219993r971542_rule,STIG-ID|SOL-11.1-010370,STIG-Legacy|SV-60709,STIG-Legacy|V-47835,TBA-FIISB|37.3.2,Vuln-ID|V-219993"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          file        : "/etc/mail/aliases"
          regex       : "[\\s]*audit_warn:"
          expect      : "[\\s]*audit_warn:[\\s]*@SMTP_AUDIT_WARN_USERS@"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : FILE_CONTENT_CHECK
          description : "SOL-11.1-010380 - The audit system must alert the System Administrator (SA) if there is any type of audit failure."
          info        : "Proper alerts to system administrators and Information Assurance (IA) officials of audit failures ensure a timely response to critical system issues."
          solution    : "The root role is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

Add an audit_warn alias to /etc/mail/aliases that will forward to designated system administrator(s).

# pfedit /etc/mail/aliases

Insert a line in the form:
audit_warn:user1,user2

Put the updated aliases file into service.
# newaliases"
          reference   : "800-171|3.3.4,800-53|AU-5(2),800-53r5|AU-5(2),CAT|I,CCI|CCI-001858,CN-L3|7.1.3.3(e),CSF|PR.PT-1,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-5(2),NESA|T3.6.2,NIAv2|GS7f,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-219994r958758_rule,STIG-ID|SOL-11.1-010380,STIG-Legacy|SV-60717,STIG-Legacy|V-47843,Vuln-ID|V-219994"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          file        : "/etc/mail/aliases"
          regex       : "[\\s]*audit_warn:"
          expect      : "[\\s]*audit_warn:[\\s]*@SMTP_AUDIT_WARN_USERS@"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : FILE_CONTENT_CHECK
          description : "SOL-11.1-010390 - The operating system must alert designated organizational officials in the event of an audit processing failure."
          info        : "Proper alerts to system administrators and IA officials of audit failures ensure a timely response to critical system issues."
          solution    : "The root role is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

Add an audit_warn alias to /etc/mail/aliases that will forward to designated system administrator(s).

# pfedit /etc/mail/aliases

Insert a line in the form:
audit_warn:user1,user2

Put the updated aliases file into service.
# newaliases"
          reference   : "800-171|3.3.4,800-53|AU-5a.,800-53r5|AU-5a.,CAT|I,CCI|CCI-000139,CN-L3|7.1.3.3(e),CSF|PR.PT-1,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-5a.,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-216038r958424_rule,STIG-ID|SOL-11.1-010390,STIG-Legacy|SV-60719,STIG-Legacy|V-47845,Vuln-ID|V-216038"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          file        : "/etc/mail/aliases"
          regex       : "[\\s]*audit_warn:"
          expect      : "[\\s]*audit_warn:[\\s]*@SMTP_AUDIT_WARN_USERS@"
        </custom_item>

        <if>
          <condition auto:"FAILED" type:"AND">
            <custom_item>
              system      : "SunOS"
              type        : CMD_EXEC
              description : "'p_minfree'"
              cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getplugin audit_binfile | /usr/bin/grep p_minfree"
              expect      : "p_minfree=([2-9]|[1-9][0-9]+)"
            </custom_item>

            <custom_item>
              system      : "SunOS"
              type        : CMD_EXEC
              description : "'zfs compression'"
              cmd         : "/usr/sbin/zfs get compression rpool/VARSHARE | /usr/bin/grep rpool | /usr/bin/grep -v off"
              expect      : "compression[\\s]+on"
            </custom_item>

            <custom_item>
              system      : "SunOS"
              type        : CMD_EXEC
              description : "'zfs quota'"
              cmd         : "/usr/sbin/zfs get quota rpool/VARSHARE | /usr/bin/grep rpool | /usr/bin/grep -v none"
              expect      : "quota[\\s]+[\\d]+"
            </custom_item>

            <custom_item>
              system      : "SunOS"
              type        : CMD_EXEC
              description : "'zfs reservation'"
              cmd         : "/usr/sbin/zfs get reservation rpool/VARSHARE | /usr/bin/grep rpool | /usr/bin/grep -v none"
              expect      : "reservation[\\s]+[\\d]+"
            </custom_item>
          </condition>

          <then>
            <report type:"PASSED">
              description : "SOL-11.1-010400 - The operating system must allocate audit record storage capacity."
              info        : "Proper audit storage capacity is crucial to ensuring the ongoing logging of critical events."
              solution    : "The Audit Configuration, Audit Control and ZFS File System Management profiles are required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

Determine the audit system directory name:

# pfexec auditconfig -getplugin audit_binfile
Plugin: audit_binfile (active)

The output of the command will appear in this form:

Attributes: p_dir=/var/audit;p_fsize=4M;p_minfree=1;

p_dir defines the current audit file system.

Note: By default in Solaris 11.1, /var/audit is a link to /var/share/audit which is mounted on rpool/VARSHARE.

Set a minimum percentage of free space on the audit_binfile plugin to 2%.

# pfexec auditconfig -setplugin audit_binfile p_minfree=2

Restart the audit system.

# pfexec audit -s

Enable compression for the audit filesystem.

# pfexec zfs set compression=on [poolname/filesystemname]

Set a ZFS quota on the default /var/share filesystem for audit records to ensure that the root pool is not filled up with audit logs.

# pfexec zfs set quota=XXG [poolname/filesystemname]

This commands sets the quota to XX Gigabytes. This value should be based upon organizational requirements.

Set a ZFS reservation on the default /var/share filesystem for audit records to ensure that the audit file system is guaranteed a fixed amount of storage.

# pfexec zfs set reservation=XXG [poolname/filesystemname]

This commands sets the quota to XX Gigabytes. This value should be based upon organizational requirements."
              reference   : "800-53|AU-4,800-53r5|AU-4,CAT|II,CCI|CCI-001849,CSF|PR.DS-4,CSF|PR.PT-1,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-4,NESA|T3.3.1,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-219995r958752_rule,STIG-ID|SOL-11.1-010400,STIG-Legacy|SV-60731,STIG-Legacy|V-47857,Vuln-ID|V-219995"
              see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
              show_output : YES
            </report>
          </then>
        </if>

        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "SOL-11.1-010410 - The operating system must configure auditing to reduce the likelihood of storage capacity being exceeded."
          info        : "Overflowing the audit storage area can result in a denial of service or system outage."
          solution    : "The Audit Control profile is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

Set the size of a binary audit file to a specific size. The size is specified in megabytes.

# pfexec auditconfig -setplugin audit_binfile p_fsize=4M

Restart the audit system.

# pfexec audit -s"
          reference   : "800-53|AU-4,800-53r5|AU-4,CAT|I,CCI|CCI-001849,CSF|PR.DS-4,CSF|PR.PT-1,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-4,NESA|T3.3.1,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-219996r958752_rule,STIG-ID|SOL-11.1-010410,STIG-Legacy|SV-62545,STIG-Legacy|V-49621,Vuln-ID|V-219996"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getplugin audit_binfile | /usr/bin/grep p_fsize"
          expect      : "p_fsize=4M"
        </custom_item>

        <if>
          <condition auto:"FAILED" type:"AND">
            <custom_item>
              system      : "SunOS"
              type        : CMD_EXEC
              description : "ahlt."
              cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getpolicy | /usr/bin/grep ahlt"
              expect      : "ahlt"
            </custom_item>

            <custom_item>
              system      : "SunOS"
              type        : CMD_EXEC
              description : "cnt."
              cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getpolicy | /usr/bin/grep active | /usr/bin/grep cnt | /usr/bin/awk '{print} END {if (NR == 0) print \"cnt not active\"; else print \"fail - cnt is active\"}'"
              expect      : "cnt not active"
            </custom_item>
          </condition>

          <then>
            <report type:"PASSED">
              description : "SOL-11.1-010420 - The operating system must shut down by default upon audit failure (unless availability is an overriding concern)."
              info        : "Continuing to operate a system without auditing working properly can result in undocumented access or system changes."
              solution    : "The Audit Configuration profile is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

Set audit policy to halt and suspend on failure.

# pfexec auditconfig -setpolicy +ahlt
# pfexec auditconfig -setpolicy -cnt"
              reference   : "800-171|3.3.4,800-53|AU-5b.,800-53r5|AU-5b.,CAT|II,CCI|CCI-000140,CN-L3|7.1.3.3(e),CSF|PR.PT-1,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-5b.,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-216041r958426_rule,STIG-ID|SOL-11.1-010420,STIG-Legacy|SV-60737,STIG-Legacy|V-47863,Vuln-ID|V-216041"
              see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
              show_output : YES
            </report>
          </then>
        </if>

        <if>
          <condition auto:"FAILED" type:"AND">
            <custom_item>
              system      : "SunOS"
              type        : FILE_CHECK
              description : "'owned by root'"
              file        : "/var/share/audit"
              owner       : "root"
            </custom_item>

            <custom_item>
              system      : "SunOS"
              type        : FILE_CHECK
              description : "'group-owned by root'"
              file        : "/var/share/audit"
              group       : "root"
            </custom_item>

            <custom_item>
              system      : "SunOS"
              type        : FILE_CHECK
              description : "'permissions 0750'"
              file        : "/var/share/audit"
              mask        : "7027"
            </custom_item>
          </condition>

          <then>
            <report type:"PASSED">
              description : "SOL-11.1-010440 - The operating system must protect audit information from unauthorized access."
              info        : "If audit data were to become compromised, then competent forensic analysis and discovery of the true source of potentially malicious system activity is difficult, if not impossible, to achieve.

To ensure the veracity of audit data, the operating system must protect audit information from unauthorized access.

Satisfies: SRG-OS-000057, SRG-OS-000058, SRG-OS-000059"
              solution    : "Note: By default in Solaris 11.1, /var/audit is a link to /var/share/audit which is mounted on rpool/VARSHARE.

The root role is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

Determine the location of the audit trail files
# pfexec auditconfig -getplugin audit_binfile|

The output will appear in this form:

Plugin: audit_binfile (active)
Attributes: p_dir=/var/audit;p_fsize=0;p_minfree=1

The p_dir attribute defines the location of the audit directory.

# chown root [directory]
# chgrp root [directory]
# chmod 750 [directory]"
              reference   : "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9a.,CAT|II,CCI|CCI-000162,CCI|CCI-000163,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,CSF2.0|PR.DS-10,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-216042r958434_rule,STIG-ID|SOL-11.1-010440,STIG-Legacy|SV-60741,STIG-Legacy|V-47869,Vuln-ID|V-216042"
              see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
              show_output : YES
            </report>
          </then>
        </if>
      </then>

      <else>
        <report type:"PASSED">
          description : "SOL-11.1-010040 - The audit system must produce records containing sufficient information to establish the identity of any user/subject associated with the event."
          info        : "Enabling the audit system will produce records with accurate time stamps, source, user, and activity information. Without this information malicious activity cannot be accurately tracked."
          solution    : "The Audit Control profile is required.

This action applies to the global zone only. Determine the zone to be secured.

# zonename

If the command output is 'global', this action applies.

If auditing has been disabled, it must be enabled with the following command:

# pfexec audit -s"
          reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-3,800-53r5|AU-3f.,800-53r5|MA-3(5),CAT|II,CCI|CCI-001487,CCI|CCI-004188,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.3.3(a),CN-L3|8.1.4.3(b),CSF|PR.PT-1,CSF2.0|PR.PS-04,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-216011r986460_rule,STIG-ID|SOL-11.1-010040,STIG-Legacy|SV-60657,STIG-Legacy|V-47781,SWIFT-CSCv1|6.4,Vuln-ID|V-216011"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-010060 - The audit system must support an audit reduction capability."
          info        : "Using the audit system will utilize the audit reduction capability. Without an audit reduction capability, users find it difficult to identify specific patterns of attack."
          solution    : "The Audit Control profile is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

If auditing has been disabled, it must be enabled with the following command:

# pfexec audit -s"
          reference   : "800-171|3.3.6,800-53|AU-7a.,800-53r5|AU-7a.,CAT|II,CCI|CCI-001877,CN-L3|7.1.2.3(c),CSF|PR.PT-1,CSF|RS.AN-3,CSF2.0|PR.PS-04,CSF2.0|RS.AN-03,CSF2.0|RS.AN-06,CSF2.0|RS.AN-07,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-7,NESA|T3.6.3,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,Rule-ID|SV-219988r958768_rule,STIG-ID|SOL-11.1-010060,STIG-Legacy|SV-60659,STIG-Legacy|V-47783,SWIFT-CSCv1|6.4,Vuln-ID|V-219988"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-010070 - The audit system records must be able to be used by a report generation capability."
          info        : "Enabling the audit system will produce records for use in report generation.  Without an audit reporting capability, users find it difficult to identify specific patterns of attack."
          solution    : "The Audit Control profile is required.

This action applies to the global zone only.  Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

If auditing has been disabled, it must be enabled with the following command:

# pfexec audit -s"
          reference   : "800-171|3.3.6,800-53|AU-7a.,800-53r5|AU-7a.,CAT|II,CCI|CCI-001880,CN-L3|7.1.2.3(c),CSF|PR.PT-1,CSF|RS.AN-3,CSF2.0|PR.PS-04,CSF2.0|RS.AN-03,CSF2.0|RS.AN-06,CSF2.0|RS.AN-07,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-7,NESA|T3.6.3,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,Rule-ID|SV-219989r958774_rule,STIG-ID|SOL-11.1-010070,STIG-Legacy|SV-60661,STIG-Legacy|V-47785,SWIFT-CSCv1|6.4,Vuln-ID|V-219989"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-010080 - The operating system must provide the capability to automatically process audit records for events of interest based upon selectable, event criteria."
          info        : "Without an audit reporting capability, users find it difficult to identify specific patterns of attack."
          solution    : "The Audit Control profile is required.

This action applies to the global zone only.  Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

If auditing has been disabled, it must be enabled with the following command:

# pfexec audit -s"
          reference   : "800-171|3.3.6,800-53|AU-7(1),800-53r5|AU-7(1),CAT|II,CCI|CCI-000158,CN-L3|7.1.2.3(c),CSF|PR.PT-1,CSF|RS.AN-3,CSF2.0|PR.PS-04,CSF2.0|RS.AN-03,CSF2.0|RS.AN-06,CSF2.0|RS.AN-07,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-7(1),QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,Rule-ID|SV-216014r958430_rule,STIG-ID|SOL-11.1-010080,STIG-Legacy|SV-60663,STIG-Legacy|V-47787,SWIFT-CSCv1|6.4,Vuln-ID|V-216014"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-010100 - The audit records must provide data for all auditable events defined at the organizational level for the organization-defined information system components."
          info        : "Without auditing, individual system accesses cannot be tracked, and malicious activity cannot be detected and traced back to an individual account.

Without accurate time stamps, source, user, and activity information, malicious activity cannot be accurately tracked.

Without an audit reduction and reporting capability, users find it difficult to identify specific patterns of attack."
          solution    : "The Audit Control profile is required.

This action applies to the global zone only.  Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

If auditing has been disabled, it must be enabled with the following command:

# pfexec audit -s"
          reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12a.,800-53r5|AU-12a.,CAT|II,CCI|CCI-000169,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|DE.CM-09,CSF2.0|PR.PS-04,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-12a.,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-216015r958442_rule,STIG-ID|SOL-11.1-010100,STIG-Legacy|SV-60665,STIG-Legacy|V-47789,SWIFT-CSCv1|6.4,Vuln-ID|V-216015"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-010120 - The operating system must generate audit records for the selected list of auditable events as defined in DoD list of events."
          info        : "Without auditing, individual system accesses cannot be tracked, and malicious activity cannot be detected and traced back to an individual account.

Without accurate time stamps, source, user, and activity information, malicious activity cannot be accurately tracked.

Without an audit reduction and reporting capability, users find it difficult to identify specific patterns of attack."
          solution    : "The Audit Control profile is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

If auditing has been disabled, it must be enabled with the following command:

# pfexec audit -s"
          reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,800-53r5|AU-12c.,CAT|II,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|DE.CM-09,CSF2.0|PR.PS-04,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-216016r958446_rule,STIG-ID|SOL-11.1-010120,STIG-Legacy|SV-60667,STIG-Legacy|V-47791,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-216016"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-010130 - The operating system must support the capability to compile audit records from multiple components within the system into a system-wide (logical or physical) audit trail that is time-correlated to within organization-defined level of tolerance."
          info        : "Without auditing, individual system accesses cannot be tracked, and malicious activity cannot be detected and traced back to an individual account.

Without accurate time stamps, source, user, and activity information, malicious activity cannot be accurately tracked.

Without an audit reduction and reporting capability, users find it difficult to identify specific patterns of attack."
          solution    : "The Audit Control profile is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

If auditing has been disabled, it must be enabled with the following command:

# pfexec audit -s"
          reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12a.,800-53r5|AU-12a.,CAT|II,CCI|CCI-000169,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|DE.CM-09,CSF2.0|PR.PS-04,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-12a.,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-219990r958442_rule,STIG-ID|SOL-11.1-010130,STIG-Legacy|SV-60669,STIG-Legacy|V-47793,SWIFT-CSCv1|6.4,Vuln-ID|V-219990"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-010140 - Audit records must include what type of events occurred."
          info        : "Without proper system auditing, individual system accesses cannot be tracked, and malicious activity cannot be detected and traced back to an individual account."
          solution    : "The Audit Control profile is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

If auditing has been disabled, it must be enabled with the following command:

# pfexec audit -s"
          reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-3,800-53r5|AU-3a.,CAT|II,CCI|CCI-000130,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.3.3(a),CN-L3|8.1.4.3(b),CSF|PR.PT-1,CSF2.0|PR.PS-04,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-216018r958412_rule,STIG-ID|SOL-11.1-010140,STIG-Legacy|SV-60671,STIG-Legacy|V-47795,SWIFT-CSCv1|6.4,Vuln-ID|V-216018"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-010150 - Audit records must include when (date and time) the events occurred."
          info        : "Without accurate time stamps malicious activity cannot be accurately tracked."
          solution    : "The Audit Control profile is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

If auditing has been disabled, it must be enabled with the following command:

# pfexec audit -s"
          reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-3,800-53r5|AU-3b.,CAT|II,CCI|CCI-000131,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.3.3(a),CN-L3|8.1.4.3(b),CSF|PR.PT-1,CSF2.0|PR.PS-04,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-216019r958414_rule,STIG-ID|SOL-11.1-010150,STIG-Legacy|SV-60673,STIG-Legacy|V-47797,SWIFT-CSCv1|6.4,Vuln-ID|V-216019"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-010160 - Audit records must include where the events occurred."
          info        : "Without auditing, individual system accesses cannot be tracked, and malicious activity cannot be detected and traced back to an individual account.

Without accurate time stamps, source, user, and activity information, malicious activity cannot be accurately tracked.

Without an audit reduction and reporting capability, users find it difficult to identify specific patterns of attack."
          solution    : "The Audit Control profile is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

If auditing has been disabled, it must be enabled with the following command:

# pfexec audit -s"
          reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-3,800-53r5|AU-3c.,CAT|II,CCI|CCI-000132,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.3.3(a),CN-L3|8.1.4.3(b),CSF|PR.PT-1,CSF2.0|PR.PS-04,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-216020r958416_rule,STIG-ID|SOL-11.1-010160,STIG-Legacy|SV-60675,STIG-Legacy|V-47799,SWIFT-CSCv1|6.4,Vuln-ID|V-216020"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-010170 - Audit records must include the sources of the events that occurred."
          info        : "Without accurate source information malicious activity cannot be accurately tracked."
          solution    : "The Audit Control profile is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

If auditing has been disabled, it must be enabled with the following command:

# pfexec audit -s"
          reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-3,800-53r5|AU-3d.,CAT|II,CCI|CCI-000133,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.3.3(a),CN-L3|8.1.4.3(b),CSF|PR.PT-1,CSF2.0|PR.PS-04,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-216021r958418_rule,STIG-ID|SOL-11.1-010170,STIG-Legacy|SV-60677,STIG-Legacy|V-47801,SWIFT-CSCv1|6.4,Vuln-ID|V-216021"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-010180 - Audit records must include the outcome (success or failure) of the events that occurred."
          info        : "Tracking both the successful and unsuccessful attempts aids in identifying threats to the system."
          solution    : "The Audit Control profile is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

If auditing has been disabled, it must be enabled with the following command:

# pfexec audit -s"
          reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-3,800-53r5|AU-3e.,CAT|II,CCI|CCI-000134,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.3.3(a),CN-L3|8.1.4.3(b),CSF|PR.PT-1,CSF2.0|PR.PS-04,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-216022r958420_rule,STIG-ID|SOL-11.1-010180,STIG-Legacy|SV-60679,STIG-Legacy|V-47803,SWIFT-CSCv1|6.4,Vuln-ID|V-216022"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-010220 - The audit system must be configured to audit file deletions."
          info        : "Without auditing, malicious activity cannot be detected."
          solution    : "The Audit Configuration profile is required. All audit flags must be enabled in a single command.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

For Solaris 11, 11.1, 11.2, and 11.3:
# pfexec auditconfig -setflags cusa,-ps,fd,-fa,fm

For Solaris 11.4 or newer:
# pfexec auditconfig -setflags cusa,-fa,-ex,-ps,fd,fm

Enable the audit policy to collect command line arguments.

# pfexec auditconfig -setpolicy +argv

These changes will not affect users that are currently logged in."
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216023r959010_rule,STIG-ID|SOL-11.1-010220,STIG-Legacy|SV-60681,STIG-Legacy|V-47805,SWIFT-CSCv1|2.3,Vuln-ID|V-216023"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-010230 - The audit system must be configured to audit account creation."
          info        : "Without auditing, malicious activity cannot be detected."
          solution    : "The Audit Configuration profile is required. All audit flags must be enabled in a single command.

This action applies to the global zone only. Determine the zone currently being secured.

# zonename

If the command output is  'global ', this action applies.

For Solaris 11, 11.1, 11.2, and 11.3:
# pfexec auditconfig -setflags cusa,-ps,fd,-fa,fm

For Solaris 11.4 or newer:
# pfexec auditconfig -setflags cusa,-fa,-ex,-ps,fd,fm

Enable the audit policy to collect command line arguments.

# pfexec auditconfig -setpolicy +argv

These changes will not affect users that are currently logged in."
          reference   : "800-171|3.1.1,800-53|AC-2(4),800-53r5|AC-2(4),CAT|II,CCI|CCI-000018,CN-L3|7.1.3.2(d),CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|PR.AA-01,CSF2.0|PR.AA-05,CSF2.0|PR.DS-10,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(4),NESA|T5.2.2,NIAv2|AM9a,NIAv2|AM9b,NIAv2|AM9c,NIAv2|AM9d,NIAv2|AM9e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,Rule-ID|SV-216024r958368_rule,STIG-ID|SOL-11.1-010230,STIG-Legacy|SV-60683,STIG-Legacy|V-47807,TBA-FIISB|36.2.3,Vuln-ID|V-216024"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-010250 - The audit system must be configured to audit account modification."
          info        : "Without auditing, malicious activity cannot be detected."
          solution    : "The Audit Configuration profile is required. All audit flags must be enabled in a single command.

This action applies to the global zone only. Determine the zone currently being secured.

# zonename

If the command output is  'global ', this action applies.

For Solaris 11, 11.1, 11.2, and 11.3:
# pfexec auditconfig -setflags cusa,-ps,fd,-fa,fm

For Solaris 11.4 or newer:
# pfexec auditconfig -setflags cusa,-fa,-ex,-ps,fd,fm

Enable the audit policy to collect command line arguments.

# pfexec auditconfig -setpolicy +argv

These changes will not affect users that are currently logged in."
          reference   : "800-171|3.1.1,800-53|AC-2(4),800-53r5|AC-2(4),CAT|II,CCI|CCI-001403,CN-L3|7.1.3.2(d),CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|PR.AA-01,CSF2.0|PR.AA-05,CSF2.0|PR.DS-10,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(4),NESA|T5.2.2,NIAv2|AM9a,NIAv2|AM9b,NIAv2|AM9c,NIAv2|AM9d,NIAv2|AM9e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,Rule-ID|SV-216025r958590_rule,STIG-ID|SOL-11.1-010250,STIG-Legacy|SV-60685,STIG-Legacy|V-47809,TBA-FIISB|36.2.3,Vuln-ID|V-216025"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-010260 - The operating system must automatically audit account disabling actions."
          info        : "Without auditing, malicious activity cannot be detected."
          solution    : "The Audit Configuration profile is required. All audit flags must be enabled in a single command.

This action applies to the global zone only. Determine the zone currently being secured.

# zonename

If the command output is  'global ', this action applies.

For Solaris 11, 11.1, 11.2, and 11.3:
# pfexec auditconfig -setflags cusa,-ps,fd,-fa,fm

For Solaris 11.4 or newer:
# pfexec auditconfig -setflags cusa,-fa,-ex,-ps,fd,fm

Enable the audit policy to collect command line arguments.

# pfexec auditconfig -setpolicy +argv

These changes will not affect users that are currently logged in."
          reference   : "800-171|3.1.1,800-53|AC-2(4),800-53r5|AC-2(4),CAT|II,CCI|CCI-001404,CN-L3|7.1.3.2(d),CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|PR.AA-01,CSF2.0|PR.AA-05,CSF2.0|PR.DS-10,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(4),NESA|T5.2.2,NIAv2|AM9a,NIAv2|AM9b,NIAv2|AM9c,NIAv2|AM9d,NIAv2|AM9e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,Rule-ID|SV-216026r958592_rule,STIG-ID|SOL-11.1-010260,STIG-Legacy|SV-60687,STIG-Legacy|V-47811,TBA-FIISB|36.2.3,Vuln-ID|V-216026"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-010270 - The operating system must automatically audit account termination."
          info        : "Without auditing, malicious activity cannot be detected."
          solution    : "The Audit Configuration profile is required. All audit flags must be enabled in a single command.

This action applies to the global zone only. Determine the zone currently being secured.

# zonename

If the command output is  'global ', this action applies.

For Solaris 11, 11.1, 11.2, and 11.3:
# pfexec auditconfig -setflags cusa,-ps,fd,-fa,fm

For Solaris 11.4 or newer:
# pfexec auditconfig -setflags cusa,-fa,-ex,-ps,fd,fm

Enable the audit policy to collect command line arguments.

# pfexec auditconfig -setpolicy +argv

These changes will not affect users that are currently logged in."
          reference   : "800-171|3.1.1,800-53|AC-2(4),800-53r5|AC-2(4),CAT|II,CCI|CCI-001405,CN-L3|7.1.3.2(d),CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|PR.AA-01,CSF2.0|PR.AA-05,CSF2.0|PR.DS-10,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(4),NESA|T5.2.2,NIAv2|AM9a,NIAv2|AM9b,NIAv2|AM9c,NIAv2|AM9d,NIAv2|AM9e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,Rule-ID|SV-216027r958594_rule,STIG-ID|SOL-11.1-010270,STIG-Legacy|SV-60689,STIG-Legacy|V-47813,TBA-FIISB|36.2.3,Vuln-ID|V-216027"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-010290 - The operating system must ensure unauthorized, security-relevant configuration changes detected are tracked."
          info        : "Without auditing, malicious activity cannot be detected."
          solution    : "The Audit Configuration profile is required. All audit flags must be enabled in a single command.

This action applies to the global zone only. Determine the zone currently being secured.

# zonename

If the command output is  'global ', this action applies.

For Solaris 11, 11.1, 11.2, and 11.3:
# pfexec auditconfig -setflags cusa,-ps,fd,-fa,fm

For Solaris 11.4 or newer:
# pfexec auditconfig -setflags cusa,-fa,-ex,-ps,fd,fm

Enable the audit policy to collect command line arguments.

# pfexec auditconfig -setpolicy +argv

These changes will not affect users that are currently logged in."
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216028r959010_rule,STIG-ID|SOL-11.1-010290,STIG-Legacy|SV-60691,STIG-Legacy|V-47815,SWIFT-CSCv1|2.3,Vuln-ID|V-216028"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-010300 - The audit system must be configured to audit all administrative, privileged, and security actions."
          info        : "Without auditing, individual system accesses cannot be tracked, and malicious activity cannot be detected and traced back to an individual account."
          solution    : "The Audit Configuration profile is required. All audit flags must be enabled in a single command.

This action applies to the global zone only. Determine the zone currently being secured.

# zonename

If the command output is  'global ', this action applies.

For Solaris 11, 11.1, 11.2, and 11.3:
# pfexec auditconfig -setflags cusa,-ps,fd,-fa,fm

For Solaris 11.4 or newer:
# pfexec auditconfig -setflags cusa,-fa,-ex,-ps,fd,fm

Enable the audit policy to collect command line arguments.

# pfexec auditconfig -setpolicy +argv

These changes will not affect users that are currently logged in."
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216029r959010_rule,STIG-ID|SOL-11.1-010300,STIG-Legacy|SV-60693,STIG-Legacy|V-47817,SWIFT-CSCv1|2.3,Vuln-ID|V-216029"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-010310 - The audit system must be configured to audit login, logout, and session initiation."
          info        : "Without auditing, individual system accesses cannot be tracked, and malicious activity cannot be detected and traced back to an individual account."
          solution    : "The Audit Configuration profile is required. All audit flags must be enabled in a single command.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

For Solaris 11, 11.1, 11.2, and 11.3:
# pfexec auditconfig -setflags cusa,-ps,fd,-fa,fm
# pfexec auditconfig -setnaflags lo,na

For Solaris 11.4 or newer:
# pfexec auditconfig -setflags cusa,-fa,-ex,-ps,fd,fm
# pfexec auditconfig -setnaflags lo,na

Enable the audit policy to collect command line arguments.

# pfexec auditconfig -setpolicy +argv

These changes will not affect users that are currently logged in."
          reference   : "800-171|3.1.12,800-53|AC-17(1),800-53r5|AC-17(1),CAT|III,CCI|CCI-000067,CN-L3|8.1.4.4(c),CN-L3|8.1.10.6(i),CSF|PR.AC-3,CSF|PR.PT-4,CSF2.0|PR.AA-05,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17(1),NESA|T5.4.4,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,Rule-ID|SV-216030r958406_rule,STIG-ID|SOL-11.1-010310,STIG-Legacy|SV-60695,STIG-Legacy|V-47819,SWIFT-CSCv1|2.6,Vuln-ID|V-216030"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-010320 - The audit system must be configured to audit all discretionary access control permission modifications."
          info        : "Without auditing, individual system accesses cannot be tracked, and malicious activity cannot be detected and traced back to an individual account."
          solution    : "The Audit Configuration profile is required. All audit flags must be enabled in a single command.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

For Solaris 11, 11.1, 11.2, and 11.3:
# pfexec auditconfig -setflags cusa,-ps,fd,-fa,fm

For Solaris 11.4 or newer:
# pfexec auditconfig -setflags cusa,-fa,-ex,-ps,fd,fm

Enable the audit policy to collect command line arguments.

# pfexec auditconfig -setpolicy +argv

These changes will not affect users that are currently logged in."
          reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12a.,800-53r5|AU-12a.,CAT|II,CCI|CCI-000169,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|DE.CM-09,CSF2.0|PR.PS-04,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-12a.,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-219991r958442_rule,STIG-ID|SOL-11.1-010320,STIG-Legacy|SV-60697,STIG-Legacy|V-47821,SWIFT-CSCv1|6.4,Vuln-ID|V-219991"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-010330 - The audit system must be configured to audit the loading and unloading of dynamic kernel modules."
          info        : "Without auditing, individual system accesses cannot be tracked, and malicious activity cannot be detected and traced back to an individual account."
          solution    : "The Audit Configuration profile is required. All audit flags must be enabled in a single command.

This action applies to the global zone only. Determine the zone currently being secured.

# zonename

If the command output is  'global ', this action applies.

For Solaris 11, 11.1, 11.2, and 11.3:
# pfexec auditconfig -setflags cusa,-ps,fd,-fa,fm

For Solaris 11.4 or newer:
# pfexec auditconfig -setflags cusa,-fa,-ex,-ps,fd,fm

Enable the audit policy to collect command line arguments.

# pfexec auditconfig -setpolicy +argv

These changes will not affect users that are currently logged in."
          reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12a.,800-53r5|AU-12a.,CAT|II,CCI|CCI-000169,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|DE.CM-09,CSF2.0|PR.PS-04,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-12a.,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-219992r958442_rule,STIG-ID|SOL-11.1-010330,STIG-Legacy|SV-60699,STIG-Legacy|V-47823,SWIFT-CSCv1|6.4,Vuln-ID|V-219992"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-010340 - The audit system must be configured to audit failed attempts to access files and programs."
          info        : "Without auditing, individual system accesses cannot be tracked, and malicious activity cannot be detected and traced back to an individual account."
          solution    : "The Audit Configuration profile is required. All audit flags must be enabled in a single command.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

For Solaris 11, 11.1, 11.2, and 11.3:
# pfexec auditconfig -setflags cusa,-ps,fd,-fa,fm

For Solaris 11.4 or newer:
# pfexec auditconfig -setflags cusa,-fa,-ex,-ps,fd,fm

Enable the audit policy to collect command line arguments.

# pfexec auditconfig -setpolicy +argv

These changes will not affect users that are currently logged in."
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216033r959010_rule,STIG-ID|SOL-11.1-010340,STIG-Legacy|SV-60701,STIG-Legacy|V-47825,SWIFT-CSCv1|2.3,Vuln-ID|V-216033"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-010350 - The operating system must protect against an individual falsely denying having performed a particular action. In order to do so the system must be configured to send audit records to a remote audit server."
          info        : "Keeping audit records on a remote system reduces the likelihood of audit records being changed or corrupted. Duplicating and protecting the audit trail on a separate system reduces the likelihood of an individual being able to deny performing an action.

Solaris has supported rsyslog since version 11.1 and the differences between syslog and rsyslog are numerous. Solaris 11.4 installs rsyslog by default, but previous versions require a manual installation. When establishing a rsyslog server to forward to, it is important to consider the network requirements for this action.  Note the following configuration options:
There are three ways to forward message: the traditional UDP transport, which is extremely lossy but standard; the plain TCP based transport, which loses messages only during certain situations but is widely available; and the RELP transport, which does not lose messages but is currently available only as part of the rsyslogd 3.15.0 and above.
Examples of each configuration:
UDP  *.* @remotesystemname
TCP  *.* @@remotesystemname
RELP  *.* :omrelp:remotesystemname:2514
Please note that a port number was given as there is no standard port for RELP."
          solution    : "Service Management, Audit Configuration and Audit Control rights profile is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

Configure Solaris 11 to use the syslog audit plugin

# pfexec auditconfig -setplugin audit_syslog active

Determine which system-log service instance is online.

# pfexec svcs system-log

If the default system-log service is online:

# pfedit /etc/syslog.conf

Add the line:

audit.notice @[remotesystemname]
or
audit.notice ![remotesystemname]

Replacing the remote system name with the correct hostname.

If the rsyslog service is online, modify the /etc/rsyslog.conf file.

# pfedit /etc/rsyslog.conf

Add the line:

*.* @@[remotesystemname]
Or
*.* :omrelp:[remotesystemname]:[designatedportnumber]

Replacing the remote system name with the correct hostname.

Create the log file on the remote system

# touch /var/adm/auditlog

Refresh the syslog service

# pfexec svcadm refresh system/system-log:default

or

# pfexec svcadm refresh system/system-log:rsyslog

Refresh the audit service

# pfexec audit -s"
          reference   : "800-53|AU-10,800-53r5|AU-10,CAT|III,CCI|CCI-000166,CSF|PR.PT-1,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-10,NESA|T4.3.1,NESA|T7.3.3,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-216034r958440_rule,STIG-ID|SOL-11.1-010350,STIG-Legacy|SV-60703,STIG-Legacy|V-47827,Vuln-ID|V-216034"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-010360 - The auditing system must not define a different auditing level for specific users."
          info        : "Without auditing, individual system accesses cannot be tracked, and malicious activity cannot be detected and traced back to an individual account."
          solution    : "The root role is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

For each user on the system, remove all special audit configuration flags.

# usermod -K audit_flags= [username]"
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216035r959010_rule,STIG-ID|SOL-11.1-010360,STIG-Legacy|SV-60705,STIG-Legacy|V-47831,SWIFT-CSCv1|2.3,Vuln-ID|V-216035"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-010370 - The audit system must alert the SA when the audit storage volume approaches its capacity."
          info        : "Filling the audit storage area can result in a denial of service or system outage and can lead to events going undetected."
          solution    : "The root role is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

Add an audit_warn alias to /etc/mail/aliases that will forward to designated system administrator(s).

# pfedit /etc/mail/aliases

Insert a line in the form:
audit_warn:user1,user2

Put the updated aliases file into service.
# newaliases"
          reference   : "800-171|3.3.4,800-53|AU-5(1),800-53r5|AU-5(1),CAT|II,CCI|CCI-001855,CN-L3|7.1.3.7(e),CSF|PR.PT-1,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-5(1),NESA|T3.3.1,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-219993r971542_rule,STIG-ID|SOL-11.1-010370,STIG-Legacy|SV-60709,STIG-Legacy|V-47835,TBA-FIISB|37.3.2,Vuln-ID|V-219993"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-010380 - The audit system must alert the System Administrator (SA) if there is any type of audit failure."
          info        : "Proper alerts to system administrators and Information Assurance (IA) officials of audit failures ensure a timely response to critical system issues."
          solution    : "The root role is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

Add an audit_warn alias to /etc/mail/aliases that will forward to designated system administrator(s).

# pfedit /etc/mail/aliases

Insert a line in the form:
audit_warn:user1,user2

Put the updated aliases file into service.
# newaliases"
          reference   : "800-171|3.3.4,800-53|AU-5(2),800-53r5|AU-5(2),CAT|I,CCI|CCI-001858,CN-L3|7.1.3.3(e),CSF|PR.PT-1,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-5(2),NESA|T3.6.2,NIAv2|GS7f,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-219994r958758_rule,STIG-ID|SOL-11.1-010380,STIG-Legacy|SV-60717,STIG-Legacy|V-47843,Vuln-ID|V-219994"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-010390 - The operating system must alert designated organizational officials in the event of an audit processing failure."
          info        : "Proper alerts to system administrators and IA officials of audit failures ensure a timely response to critical system issues."
          solution    : "The root role is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

Add an audit_warn alias to /etc/mail/aliases that will forward to designated system administrator(s).

# pfedit /etc/mail/aliases

Insert a line in the form:
audit_warn:user1,user2

Put the updated aliases file into service.
# newaliases"
          reference   : "800-171|3.3.4,800-53|AU-5a.,800-53r5|AU-5a.,CAT|I,CCI|CCI-000139,CN-L3|7.1.3.3(e),CSF|PR.PT-1,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-5a.,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-216038r958424_rule,STIG-ID|SOL-11.1-010390,STIG-Legacy|SV-60719,STIG-Legacy|V-47845,Vuln-ID|V-216038"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-010400 - The operating system must allocate audit record storage capacity."
          info        : "Proper audit storage capacity is crucial to ensuring the ongoing logging of critical events."
          solution    : "The Audit Configuration, Audit Control and ZFS File System Management profiles are required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

Determine the audit system directory name:

# pfexec auditconfig -getplugin audit_binfile
Plugin: audit_binfile (active)

The output of the command will appear in this form:

Attributes: p_dir=/var/audit;p_fsize=4M;p_minfree=1;

p_dir defines the current audit file system.

Note: By default in Solaris 11.1, /var/audit is a link to /var/share/audit which is mounted on rpool/VARSHARE.

Set a minimum percentage of free space on the audit_binfile plugin to 2%.

# pfexec auditconfig -setplugin audit_binfile p_minfree=2

Restart the audit system.

# pfexec audit -s

Enable compression for the audit filesystem.

# pfexec zfs set compression=on [poolname/filesystemname]

Set a ZFS quota on the default /var/share filesystem for audit records to ensure that the root pool is not filled up with audit logs.

# pfexec zfs set quota=XXG [poolname/filesystemname]

This commands sets the quota to XX Gigabytes. This value should be based upon organizational requirements.

Set a ZFS reservation on the default /var/share filesystem for audit records to ensure that the audit file system is guaranteed a fixed amount of storage.

# pfexec zfs set reservation=XXG [poolname/filesystemname]

This commands sets the quota to XX Gigabytes. This value should be based upon organizational requirements."
          reference   : "800-53|AU-4,800-53r5|AU-4,CAT|II,CCI|CCI-001849,CSF|PR.DS-4,CSF|PR.PT-1,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-4,NESA|T3.3.1,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-219995r958752_rule,STIG-ID|SOL-11.1-010400,STIG-Legacy|SV-60731,STIG-Legacy|V-47857,Vuln-ID|V-219995"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-010410 - The operating system must configure auditing to reduce the likelihood of storage capacity being exceeded."
          info        : "Overflowing the audit storage area can result in a denial of service or system outage."
          solution    : "The Audit Control profile is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

Set the size of a binary audit file to a specific size. The size is specified in megabytes.

# pfexec auditconfig -setplugin audit_binfile p_fsize=4M

Restart the audit system.

# pfexec audit -s"
          reference   : "800-53|AU-4,800-53r5|AU-4,CAT|I,CCI|CCI-001849,CSF|PR.DS-4,CSF|PR.PT-1,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-4,NESA|T3.3.1,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-219996r958752_rule,STIG-ID|SOL-11.1-010410,STIG-Legacy|SV-62545,STIG-Legacy|V-49621,Vuln-ID|V-219996"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-010420 - The operating system must shut down by default upon audit failure (unless availability is an overriding concern)."
          info        : "Continuing to operate a system without auditing working properly can result in undocumented access or system changes."
          solution    : "The Audit Configuration profile is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

Set audit policy to halt and suspend on failure.

# pfexec auditconfig -setpolicy +ahlt
# pfexec auditconfig -setpolicy -cnt"
          reference   : "800-171|3.3.4,800-53|AU-5b.,800-53r5|AU-5b.,CAT|II,CCI|CCI-000140,CN-L3|7.1.3.3(e),CSF|PR.PT-1,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-5b.,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-216041r958426_rule,STIG-ID|SOL-11.1-010420,STIG-Legacy|SV-60737,STIG-Legacy|V-47863,Vuln-ID|V-216041"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-010440 - The operating system must protect audit information from unauthorized access."
          info        : "If audit data were to become compromised, then competent forensic analysis and discovery of the true source of potentially malicious system activity is difficult, if not impossible, to achieve.

To ensure the veracity of audit data, the operating system must protect audit information from unauthorized access.

Satisfies: SRG-OS-000057, SRG-OS-000058, SRG-OS-000059"
          solution    : "Note: By default in Solaris 11.1, /var/audit is a link to /var/share/audit which is mounted on rpool/VARSHARE.

The root role is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

Determine the location of the audit trail files
# pfexec auditconfig -getplugin audit_binfile|

The output will appear in this form:

Plugin: audit_binfile (active)
Attributes: p_dir=/var/audit;p_fsize=0;p_minfree=1

The p_dir attribute defines the location of the audit directory.

# chown root [directory]
# chgrp root [directory]
# chmod 750 [directory]"
          reference   : "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9a.,CAT|II,CCI|CCI-000162,CCI|CCI-000163,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,CSF2.0|PR.DS-10,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-216042r958434_rule,STIG-ID|SOL-11.1-010440,STIG-Legacy|SV-60741,STIG-Legacy|V-47869,Vuln-ID|V-216042"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>
      </else>
    </if>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "SOL-11.1-020010 - The System packages must be up to date with the most recent vendor updates and security fixes."
      info        : "Failure to install security updates can provide openings for attack."
      solution    : "The Software Installation Profile is required.

An up-to-date Solaris repository must be accessible to the system. Enter the command:

# pkg publisher

to determine the current repository publisher. If a repository is not accessible, it may need to be locally installed and configured.

Update system packages to the current version.

# pfexec pkg update

A reboot may be required for the updates to take effect."
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216045r959010_rule,STIG-ID|SOL-11.1-020010,STIG-Legacy|SV-60753,STIG-Legacy|V-47881,SWIFT-CSCv1|2.3,Vuln-ID|V-216045"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      cmd         : "/usr/bin/pfexec pkg update -n"
      expect      : "No updates available for this image"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "SOL-11.1-020020 - The system must verify that package updates are digitally signed."
      info        : "Digitally signed packages ensure that the source of the package can be identified."
      solution    : "The Software Installation Profile is required.

Configure the package system to ensure that digital signatures are verified.

# pfexec pkg set-property signature-policy verify"
      reference   : "800-171|3.4.5,800-53|CM-5(3),800-53r5|CM-14,CAT|II,CCI|CCI-003992,CSF|PR.IP-1,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-5(3),NESA|T3.2.3,NESA|T5.1.1,NESA|T5.6.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.3,QCSC-v1|7.2,Rule-ID|SV-219997r986452_rule,STIG-ID|SOL-11.1-020020,STIG-Legacy|SV-60755,STIG-Legacy|V-47883,Vuln-ID|V-219997"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      cmd         : "/usr/bin/pkg property | /usr/bin/grep signature-policy"
      expect      : "signature-policy[\\s]+verify"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "SOL-11.1-020030 - The operating system must protect audit tools from unauthorized access."
      info        : "Failure to maintain system configurations may result in privilege escalation."
      solution    : "The Software Installation Profile is required.

Configure the package system to ensure that digital signatures are verified.

# pfexec pkg set-property signature-policy verify

Check that package permissions are configured per vendor requirements.

# pfexec pkg verify

If any errors are reported unrelated to STIG changes, use:

# pfexec pkg fix

to bring configuration settings and permissions into factory compliance."
      reference   : "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9a.,CAT|II,CCI|CCI-001493,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,CSF2.0|PR.DS-10,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-216047r958610_rule,STIG-ID|SOL-11.1-020030,STIG-Legacy|SV-60757,STIG-Legacy|V-47885,Vuln-ID|V-216047"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      cmd         : "/usr/bin/pkg property | /usr/bin/grep signature-policy"
      expect      : "signature-policy[\\s]+verify"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "SOL-11.1-020040 - The operating system must protect audit tools from unauthorized modification."
      info        : "Failure to maintain system configurations may result in privilege escalation."
      solution    : "The Software Installation Profile is required.

Configure the package system to ensure that digital signatures are verified.

# pfexec pkg set-property signature-policy verify

Check that package permissions are configured per vendor requirements.

# pfexec pkg verify

If any errors are reported unrelated to STIG changes, use:

# pfexec pkg fix

to bring configuration settings and permissions into factory compliance."
      reference   : "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CAT|II,CCI|CCI-001494,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,CSF2.0|PR.DS-10,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-216048r958612_rule,STIG-ID|SOL-11.1-020040,STIG-Legacy|SV-60759,STIG-Legacy|V-47887,Vuln-ID|V-216048"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      cmd         : "/usr/bin/pkg property | /usr/bin/grep signature-policy"
      expect      : "signature-policy[\\s]+verify"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "SOL-11.1-020050 - The operating system must protect audit tools from unauthorized deletion."
      info        : "Failure to maintain system configurations may result in privilege escalation."
      solution    : "The Software Installation Profile is required.

Configure the package system to ensure that digital signatures are verified.

# pfexec pkg set-property signature-policy verify

Check that package permissions are configured per vendor requirements.

# pfexec pkg verify

If any errors are reported unrelated to STIG changes, use:

# pfexec pkg fix

to bring configuration settings and permissions into factory compliance."
      reference   : "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CAT|II,CCI|CCI-001495,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,CSF2.0|PR.DS-10,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-216049r958614_rule,STIG-ID|SOL-11.1-020050,STIG-Legacy|SV-60761,STIG-Legacy|V-47889,Vuln-ID|V-216049"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      cmd         : "/usr/bin/pkg property | /usr/bin/grep signature-policy"
      expect      : "signature-policy[\\s]+verify"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "SOL-11.1-020080 - System packages must be configured with the vendor-provided files, permissions, and ownerships."
      info        : "Failure to maintain system configurations may result in privilege escalation."
      solution    : "The Software Installation Profile is required.

Configure the package system to ensure that digital signatures are verified.

# pfexec pkg set-property signature-policy verify

Check that package permissions are configured per vendor requirements.

# pfexec pkg verify

If any errors are reported unrelated to STIG changes, use:

# pfexec pkg fix

to bring configuration settings and permissions into factory compliance."
      reference   : "800-171|3.3.8,800-53|AU-9(3),800-53r5|AU-9(3),CAT|II,CCI|CCI-001496,CN-L3|8.1.4.3(d),CSF|PR.PT-1,CSF2.0|PR.DS-10,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9(3),NESA|M5.2.3,NESA|M5.5.2,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-216050r958634_rule,STIG-ID|SOL-11.1-020080,STIG-Legacy|SV-60763,STIG-Legacy|V-47891,TBA-FIISB|37.3.3,Vuln-ID|V-216050"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      cmd         : "/usr/bin/pkg property | /usr/bin/grep signature-policy"
      expect      : "signature-policy[\\s]+verify"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "SOL-11.1-020090 - The finger daemon package must not be installed."
      info        : "Finger is an insecure protocol."
      solution    : "The Software Installation Profile is required.

# pfexec pkg uninstall service/network/finger"
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216051r959010_rule,STIG-ID|SOL-11.1-020090,STIG-Legacy|SV-60765,STIG-Legacy|V-47893,SWIFT-CSCv1|2.3,Vuln-ID|V-216051"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      cmd         : "/usr/bin/pkg list service/network/finger 2>&1"
      expect      : "no packages matching"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "SOL-11.1-020100 - The legacy remote network access utilities daemons must not be installed."
      info        : "Legacy remote access utilities allow remote control of a system without proper authentication."
      solution    : "The Software Installation Profile is required.

# pfexec pkg uninstall service/network/legacy-remote-utilities"
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216052r959010_rule,STIG-ID|SOL-11.1-020100,STIG-Legacy|SV-60773,STIG-Legacy|V-47901,SWIFT-CSCv1|2.3,Vuln-ID|V-216052"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      cmd         : "/usr/bin/pkg list service/network/legacy-remote-utilities 2>&1"
      expect      : "no packages matching"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "SOL-11.1-020110 - The NIS package must not be installed."
      info        : "NIS is an insecure protocol."
      solution    : "The Software Installation Profile is required.

# pfexec pkg uninstall service/network/nis"
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|I,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216053r959010_rule,STIG-ID|SOL-11.1-020110,STIG-Legacy|SV-60777,STIG-Legacy|V-47905,SWIFT-CSCv1|2.3,Vuln-ID|V-216053"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      cmd         : "/usr/bin/pkg list service/network/nis 2>&1"
      expect      : "no packages matching"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "SOL-11.1-020120 - The pidgin IM client package must not be installed."
      info        : "Instant messaging is an insecure protocol."
      solution    : "The Software Installation Profile is required.

# pfexec pkg uninstall communication/im/pidgin"
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216054r959010_rule,STIG-ID|SOL-11.1-020120,STIG-Legacy|SV-60781,STIG-Legacy|V-47909,SWIFT-CSCv1|2.3,Vuln-ID|V-216054"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      cmd         : "/usr/bin/pkg list communication/im/pidgin 2>&1"
      expect      : "no packages matching"
    </custom_item>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : CMD_EXEC
          description : "FTP service is not installed"
          cmd         : "/usr/bin/pkg list service/network/ftp 2>&1"
          expect      : "no packages matching"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "SOL-11.1-020130 - The FTP daemon must not be installed unless required."
          info        : "FTP is an insecure protocol."
          solution    : "The Software Installation Profile is required.

# pfexec pkg uninstall service/network/ftp"
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|I,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216055r959010_rule,STIG-ID|SOL-11.1-020130,STIG-Legacy|SV-60783,STIG-Legacy|V-47911,SWIFT-CSCv1|2.3,Vuln-ID|V-216055"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>
      </then>

      <else>
        <report type:"WARNING">
          description : "SOL-11.1-020130 - The FTP daemon must not be installed unless required."
          info        : "FTP is an insecure protocol.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
          solution    : "The Software Installation Profile is required.

# pfexec pkg uninstall service/network/ftp"
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|I,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216055r959010_rule,STIG-ID|SOL-11.1-020130,STIG-Legacy|SV-60783,STIG-Legacy|V-47911,SWIFT-CSCv1|2.3,Vuln-ID|V-216055"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>
      </else>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : CMD_EXEC
          description : "TFTP service is not installed"
          cmd         : "/usr/bin/pkg list service/network/tftp 2>&1"
          expect      : "no packages matching"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "SOL-11.1-020140 - The TFTP service daemon must not be installed unless required."
          info        : "TFTP is an insecure protocol."
          solution    : "The Software Installation Profile is required.

# pfexec pkg uninstall install/installadm
# pfexec pkg uninstall service/network/tftp"
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|I,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216056r959010_rule,STIG-ID|SOL-11.1-020140,STIG-Legacy|SV-60785,STIG-Legacy|V-47913,SWIFT-CSCv1|2.3,Vuln-ID|V-216056"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>
      </then>

      <else>
        <report type:"WARNING">
          description : "SOL-11.1-020140 - The TFTP service daemon must not be installed unless required."
          info        : "TFTP is an insecure protocol.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
          solution    : "The Software Installation Profile is required.

# pfexec pkg uninstall install/installadm
# pfexec pkg uninstall service/network/tftp"
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|I,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216056r959010_rule,STIG-ID|SOL-11.1-020140,STIG-Legacy|SV-60785,STIG-Legacy|V-47913,SWIFT-CSCv1|2.3,Vuln-ID|V-216056"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>
      </else>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : CMD_EXEC
          description : "check for telnet"
          cmd         : "/usr/bin/pkg list service/network/telnet 2>&1"
          expect      : "no packages matching"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "SOL-11.1-020150 - The telnet service daemon must not be installed unless required."
          info        : "Telnet is an insecure protocol."
          solution    : "The Software Installation Profile is required.

# pfexec pkg uninstall service/network/telnet"
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|I,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216057r959010_rule,STIG-ID|SOL-11.1-020150,STIG-Legacy|SV-60787,STIG-Legacy|V-47915,SWIFT-CSCv1|2.3,Vuln-ID|V-216057"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>
      </then>

      <else>
        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "SOL-11.1-020150 - The telnet service daemon must not be installed unless required."
          info        : "Telnet is an insecure protocol."
          solution    : "The Software Installation Profile is required.

# pfexec pkg uninstall service/network/telnet"
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|I,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216057r959010_rule,STIG-ID|SOL-11.1-020150,STIG-Legacy|SV-60787,STIG-Legacy|V-47915,SWIFT-CSCv1|2.3,Vuln-ID|V-216057"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          cmd         : "/usr/bin/svcs -Ho state svc:/ldoms/vntsd:default | /usr/bin/awk \'{ print } END { if (NR == 0) print \"not found\" }\'"
          expect      : "online"
        </custom_item>
      </else>
    </if>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "SOL-11.1-020160 - The UUCP service daemon must not be installed unless required."
      info        : "UUCP is an insecure protocol."
      solution    : "The Software Installation Profile is required.

# pfexec pkg uninstall /service/network/uucp"
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216058r959010_rule,STIG-ID|SOL-11.1-020160,STIG-Legacy|SV-60789,STIG-Legacy|V-47917,SWIFT-CSCv1|2.3,Vuln-ID|V-216058"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      cmd         : "/usr/bin/pkg list /service/network/uucp 2>&1"
      expect      : "no packages matching"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "SOL-11.1-020170 - The rpcbind service must be configured for local only services unless organizationally defined."
      info        : "The portmap and rpcbind services increase the attack surface of the system and should only be used when needed. The portmap or rpcbind services are used by a variety of services using remote procedure calls (RPCs).  The organization may define and document the limited use of services (for example NFS) that may use these services with approval from their Authorizing Official."
      solution    : "The Service Management profile is required.

If services such as portmap or rpcbind are required for system operations, the operator must document the services used and obtain approval from their Authorizing Official. They should also document the method(s) of blocking all other remote accesses through tools like a firewall or tcp_wrappers.
Otherwise, configure the rpc/bind service for local only access.

# svccfg -s network/rpc/bind setprop config/local_only=true"
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216059r959010_rule,STIG-ID|SOL-11.1-020170,STIG-Legacy|SV-60791,STIG-Legacy|V-47919,SWIFT-CSCv1|2.3,Vuln-ID|V-216059"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      cmd         : "/usr/bin/svcprop -p config/local_only network/rpc/bind"
      expect      : "^[\\s]*true[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "SOL-11.1-020180 - The VNC server package must not be installed unless required."
      info        : "The VNC service uses weak authentication capabilities and provides the user complete graphical system access."
      solution    : "The Software Installation Profile is required.

# pfexec pkg uninstall x11/server/xvnc"
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216060r959010_rule,STIG-ID|SOL-11.1-020180,STIG-Legacy|SV-60793,STIG-Legacy|V-47921,SWIFT-CSCv1|2.3,Vuln-ID|V-216060"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      cmd         : "/usr/bin/pkg list x11/server/xvnc 2>&1"
      expect      : "no packages matching"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "SOL-11.1-020190 - The operating system must employ automated mechanisms, per organization-defined frequency, to detect the addition of unauthorized components/devices into the operating system."
      info        : "Addition of unauthorized code or packages may result in data corruption or theft.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "The Software Installation Profile is required.

Review and report any unauthorized package installation operations.

If necessary, remove unauthorized packages.

# pfexec pkg uninstall [package name]"
      reference   : "800-171|3.4.3,800-53|CM-3(5),800-53r5|CM-3(5),CAT|II,CCI|CCI-001744,CN-L3|8.1.10.6(g),CSF|DE.CM-1,CSF|DE.CM-7,CSF|PR.IP-1,CSF|PR.IP-3,CSF2.0|DE.CM-01,CSF2.0|DE.CM-09,CSF2.0|ID.RA-07,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.1.2,ITSG-33|CM-3,NESA|T3.2.3,NESA|T3.3.2,NESA|T7.5.1,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NIAv2|CM1,NIAv2|CM1a,NIAv2|CM1b,NIAv2|CM1c,PCI-DSSv3.2.1|11.5,PCI-DSSv4.0|11.5.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|6.2,QCSC-v1|7.2,QCSC-v1|8.2.1,Rule-ID|SV-219998r958794_rule,STIG-ID|SOL-11.1-020190,STIG-Legacy|SV-60795,STIG-Legacy|V-47923,Vuln-ID|V-219998"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      cmd         : "/usr/bin/pkg history -o finish,user,operation,command | /usr/bin/grep install"
      expect      : ""
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "SOL-11.1-020220 - The operating system must be configured to provide essential capabilities."
      info        : "Operating systems are capable of providing a wide variety of functions and services. Execution must be disabled based on organization-defined specifications.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "The Software Installation profile is required.

Identify packages installed on the system:

# pkg list

uninstall unauthorized packages:

# pfexec pkg uninstall [ package name]"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-216062r958478_rule,STIG-ID|SOL-11.1-020220,STIG-Legacy|SV-60797,STIG-Legacy|V-47925,SWIFT-CSCv1|2.3,Vuln-ID|V-216062"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      cmd         : "/usr/bin/pkg list"
      expect      : ""
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "SOL-11.1-020230 - The operating system must employ automated mechanisms to prevent program execution in accordance with the organization-defined specifications."
      info        : "Operating systems are capable of providing a wide variety of functions and services. Execution must be disabled based on organization-defined specifications.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "The Software Installation profile is required.

Identify packages installed on the system:

# pkg list

uninstall unauthorized packages:

# pfexec pkg uninstall [ package name]"
      reference   : "800-171|3.4.7,800-53|CM-7(2),800-53r5|CM-7(2),CAT|II,CCI|CCI-001764,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7(2),NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,Rule-ID|SV-219999r958804_rule,STIG-ID|SOL-11.1-020230,STIG-Legacy|SV-60799,STIG-Legacy|V-47927,SWIFT-CSCv1|2.3,Vuln-ID|V-219999"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      cmd         : "/usr/bin/pkg list"
      expect      : ""
      severity    : MEDIUM
    </custom_item>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          system      : "SunOS"
          type        : FILE_CHECK
          description : "'/etc/rc*'"
          file        : "/etc/rc*/*"
          mask        : "7022"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : FILE_CHECK
          description : "'/etc/init.d'"
          file        : "/etc/init.d/*"
          mask        : "7022"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : FILE_CHECK
          description : "'/lib/svc/method'"
          file        : "/lib/svc/method/*"
          mask        : "7022"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "SOL-11.1-020300 - All run control scripts must have mode 0755 or less permissive."
          info        : "If the startup files are writable by other users, these users could modify the startup files to insert malicious commands into the startup files."
          solution    : "Ensure all system startup files have mode 0755 or less permissive. Examine the rc files, and all files in the rc1.d (rc2.d, and so on) directories, and in the /etc/init.d and /lib/svc/method directories to ensure they are not world writable. If they are world writable, use the chmod command to correct the vulnerability and to research why.

Procedure:

# chmod go-w <startupfile>"
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216064r959010_rule,STIG-ID|SOL-11.1-020300,STIG-Legacy|SV-74257,STIG-Legacy|V-59827,SWIFT-CSCv1|2.3,Vuln-ID|V-216064"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          system        : "SunOS"
          type          : CMD_EXEC
          description   : "'/etc/rc*'"
          cmd           : "/usr/bin/find /etc/rc*/* -exec /usr/bin/ls -lLd {} \\; | /usr/bin/awk 'BEGIN { n=0 } substr($0,11,1) == \"+\" { n++; print $1,$NF } END { print \"ACL found: \"n }'"
          expect        : "^ACL found: 0$"
          timeout       : "@FIND_TIMEOUT@"
          dont_echo_cmd : YES
        </custom_item>

        <custom_item>
          system        : "SunOS"
          type          : CMD_EXEC
          description   : "'/etc/init.d/*'"
          cmd           : "/usr/bin/find /etc/init.d/* -exec /usr/bin/ls -lLd {} \\; | /usr/bin/awk 'BEGIN { n=0 } substr($0,11,1) == \"+\" { n++; print $1,$NF } END { print \"ACL found: \"n }'"
          expect        : "^ACL found: 0$"
          timeout       : "@FIND_TIMEOUT@"
          dont_echo_cmd : YES
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "SOL-11.1-020310 - All run control scripts must have no extended ACLs."
          info        : "If the startup files are writable by other users, these users could modify the startup files to insert malicious commands into the startup files."
          solution    : "Remove the extended ACL from the file.

# chmod A- [run control script with extended ACL]"
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216065r959010_rule,STIG-ID|SOL-11.1-020310,STIG-Legacy|SV-74259,STIG-Legacy|V-59829,SWIFT-CSCv1|2.3,Vuln-ID|V-216065"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          system          : "SunOS"
          type            : FILE_CONTENT_CHECK_NOT
          description     : "'/etc/init.d'"
          file            : "/etc/init.d/*"
          regex           : "^[\\s]*PATH[\\s]*="
          expect          : "(=[\\.:]|\"[\\.:]|:\\.|::|:\"|:[\\s]*;|:$)"
          file_required   : NO
          string_required : NO
        </custom_item>

        <custom_item>
          system          : "SunOS"
          type            : FILE_CONTENT_CHECK_NOT
          description     : "'/etc/rc*'"
          file            : "/etc/rc*/*"
          regex           : "^[\\s]*PATH[\\s]*="
          expect          : "(=[\\.:]|\"[\\.:]|:\\.|::|:\"|:[\\s]*;|:$)"
          file_required   : NO
          string_required : NO
        </custom_item>

        <custom_item>
          system          : "SunOS"
          type            : FILE_CONTENT_CHECK_NOT
          description     : "'/lib/svc/method'"
          file            : "/lib/svc/method/*"
          regex           : "^[\\s]*PATH[\\s]*="
          expect          : "(=[\\.:]|\"[\\.:]|:\\.|::|:\"|:[\\s]*;|:$)"
          file_required   : NO
          string_required : NO
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "SOL-11.1-020320 - Run control scripts executable search paths must contain only authorized paths."
          info        : "The executable search path (typically the PATH environment variable) contains a list of directories for the shell to search to find executables. If this path includes the current working directory or other relative paths, executables in these directories may be executed instead of system commands. This variable is formatted as a colon-separated list of directories. If there is an empty entry, such as a leading or trailing colon, two consecutive colons, or a single period, this is interpreted as the current working directory. Paths starting with a slash (/) are absolute paths."
          solution    : "Edit the run control script and remove the relative path entries from the executable search path variable that have not been documented with the ISSO.

Edit the run control script and remove any empty path entries from the file."
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216066r959010_rule,STIG-ID|SOL-11.1-020320,STIG-Legacy|SV-74261,STIG-Legacy|V-59831,SWIFT-CSCv1|2.3,Vuln-ID|V-216066"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          system          : "SunOS"
          type            : FILE_CONTENT_CHECK_NOT
          description     : "'/etc/rc*'"
          file            : "/etc/rc*/*"
          regex           : "^[\\s]*LD_LIBRARY_PATH[\\s]*="
          expect          : "(=[\\.:]|\"[\\.:]|:\\.|::|:\"|:[\\s]*;|:$)"
          file_required   : NO
          string_required : NO
        </custom_item>

        <custom_item>
          system          : "SunOS"
          type            : FILE_CONTENT_CHECK_NOT
          description     : "'/etc/init.d/*'"
          file            : "/etc/init.d/*"
          regex           : "^[\\s]*LD_LIBRARY_PATH[\\s]*="
          expect          : "(=[\\.:]|\"[\\.:]|:\\.|::|:\"|:[\\s]*;|:$)"
          file_required   : NO
          string_required : NO
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "SOL-11.1-020330 - Run control scripts library search paths must contain only authorized paths."
          info        : "The library search path environment variable(s) contain a list of directories for the dynamic linker to search to find libraries. If this path includes the current working directory or other relative paths, libraries in these directories may be loaded instead of system libraries. This variable is formatted as a colon-separated list of directories. If there is an empty entry, such as a leading or trailing colon, two consecutive colons, or a single period, this is interpreted as the current working directory. Paths starting with a slash (/) are absolute paths."
          solution    : "Edit the run control script and remove the relative path entries from the library search path variables that have not been documented with the ISSO.

Edit the run control script and remove any empty path entries from the file."
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216067r959010_rule,STIG-ID|SOL-11.1-020330,STIG-Legacy|SV-74263,STIG-Legacy|V-59833,SWIFT-CSCv1|2.3,Vuln-ID|V-216067"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          system          : "SunOS"
          type            : FILE_CONTENT_CHECK_NOT
          description     : "'/etc/rc*'"
          file            : "/etc/rc*/*"
          regex           : "^[\\s]*LD_PRELOAD[\\s]*="
          expect          : "(=[\\.:]|\"[\\.:]|:\\.|::|:\"|:[\\s]*;|:$)"
          file_required   : NO
          string_required : NO
        </custom_item>

        <custom_item>
          system          : "SunOS"
          type            : FILE_CONTENT_CHECK_NOT
          description     : "'/etc/init.d/*'"
          file            : "/etc/init.d/*"
          regex           : "^[\\s]*LD_PRELOAD[\\s]*="
          expect          : "(=[\\.:]|\"[\\.:]|:\\.|::|:\"|:[\\s]*;|:$)"
          file_required   : NO
          string_required : NO
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "SOL-11.1-020340 - Run control scripts lists of preloaded libraries must contain only authorized paths."
          info        : "The library preload list environment variable contains a list of libraries for the dynamic linker to load before loading the libraries required by the binary. If this list contains paths to libraries to the current working directory that have not been authorized, unintended libraries may be preloaded. This variable is formatted as a space-separated list of libraries. Paths starting with a slash (/) are absolute paths."
          solution    : "Edit the run control script and remove the relative path entries from the library preload variables that have not been documented with the ISSO.

Edit the run control script and remove any empty path entries from the file."
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216068r959010_rule,STIG-ID|SOL-11.1-020340,STIG-Legacy|SV-74265,STIG-Legacy|V-59835,SWIFT-CSCv1|2.3,Vuln-ID|V-216068"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "SOL-11.1-020350 - Run control scripts must not execute world writable programs or scripts."
      info        : "World writable files could be modified accidentally or maliciously to compromise system integrity."
      solution    : "Remove the world writable permission from programs or scripts executed by run control scripts.

Procedure:

# chmod o-w <program or script executed from run control script>"
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216069r959010_rule,STIG-ID|SOL-11.1-020350,STIG-Legacy|SV-74267,STIG-Legacy|V-59837,SWIFT-CSCv1|2.3,Vuln-ID|V-216069"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      cmd         : "/usr/bin/find /etc/init.d/* /etc/rc* -perm -002 -type f | /usr/bin/awk '{ print } END { if (NR == 0) print \"none\" }'"
      expect      : "none"
      timeout     : "@FIND_TIMEOUT@"
    </custom_item>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          system      : "SunOS"
          type        : FILE_CHECK
          description : "'/etc/rc*'"
          file        : "/etc/rc*/*"
          owner       : "root"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : FILE_CHECK
          description : "'/etc/init.d/*'"
          file        : "/etc/init.d/*"
          owner       : "root"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "SOL-11.1-020360 - All system start-up files must be owned by root."
          info        : "System start-up files not owned by root could lead to system compromise by allowing malicious users or applications to modify them for unauthorized purposes.  This could lead to system and network compromise."
          solution    : "Change the ownership of the run control script(s) with incorrect ownership.

# chown root <run control script>"
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216070r959010_rule,STIG-ID|SOL-11.1-020360,STIG-Legacy|SV-74269,STIG-Legacy|V-59839,SWIFT-CSCv1|2.3,Vuln-ID|V-216070"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          system      : "SunOS"
          type        : FILE_CHECK
          description : "'/etc/rc*/*'"
          file        : "/etc/rc*/*"
          group       : "bin" || "root" || "sys"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : FILE_CHECK
          description : "'/etc/init.d/*'"
          file        : "/etc/init.d/*"
          group       : "bin" || "root" || "sys"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "SOL-11.1-020370 - All system start-up files must be group-owned by root, sys, or bin."
          info        : "If system start-up files do not have a group owner of root or a system group, the files may be modified by malicious users or intruders."
          solution    : "Change the group ownership of the run control script(s) with incorrect group ownership.

Procedure:

# chgrp root <run control script>"
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216071r959010_rule,STIG-ID|SOL-11.1-020370,STIG-Legacy|SV-74271,STIG-Legacy|V-59841,SWIFT-CSCv1|2.3,Vuln-ID|V-216071"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <report type:"WARNING">
      description : "SOL-11.1-020380 - System start-up files must only execute programs owned by a privileged UID or an application."
      info        : "System start-up files executing programs owned by other than root (or another privileged user) or an application indicates the system may have been compromised.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Change the ownership of the file executed from system startup scripts to root, bin, or sys.

# chown root <executed file>"
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216072r959010_rule,STIG-ID|SOL-11.1-020380,STIG-Legacy|SV-74273,STIG-Legacy|V-59843,SWIFT-CSCv1|2.3,Vuln-ID|V-216072"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
    </report>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : PROCESS_CHECK
          description : "Check for XDM"
          name        : "xdm"
          status      : ON
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system      : "SunOS"
          type        : FILE_CHECK
          description : "SOL-11.1-020500 - Any X Windows host must write .Xauthority files."
          info        : ".Xauthority files ensure the user is authorized to access the specific X Windows host. If .Xauthority files are not used, it may be possible to obtain unauthorized access to the X Windows host."
          solution    : "Ensure the X Windows host is configured to write .Xauthority files into user home directories.

Edit the Xaccess file. Ensure the line that writes the .Xauthority file is uncommented."
          reference   : "800-171|3.4.1,800-171|3.4.2,800-53|CM-2(1)(b),800-53|CM-6b.,800-53r5|CM-2b.2.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000297,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-2(1)(b),ITSG-33|CM-6b.,NESA|T3.2.1,NESA|T3.2.5,NESA|T7.5.1,NIAv2|SS18,QCSC-v1|5.2.1,QCSC-v1|5.2.2,Rule-ID|SV-216073r959010_rule,STIG-ID|SOL-11.1-020500,STIG-Legacy|SV-75471,STIG-Legacy|V-61003,SWIFT-CSCv1|2.3,Vuln-ID|V-216073"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          file        : "~/.Xauthority"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : FILE_CHECK
          description : "SOL-11.1-020510 - All .Xauthority files must have mode 0600 or less permissive."
          info        : ".Xauthority files ensure the user is authorized to access the specific X Windows host. Excessive permissions may permit unauthorized modification of these files, which could lead to Denial of Service to authorized access or allow unauthorized access to be obtained."
          solution    : "Change the mode of the .Xauthority files.

Procedure:
# chmod 0600 .Xauthority"
          reference   : "800-171|3.1.5,800-171|3.4.2,800-53|AC-6,800-53|CM-6b.,800-53r5|AC-6,800-53r5|CM-6b.,CAT|II,CCI|CCI-000225,CCI|CCI-000366,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CN-L3|8.1.10.6(d),CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.AA-05,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,ITSG-33|CM-6b.,NESA|T3.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,Rule-ID|SV-216074r959010_rule,STIG-ID|SOL-11.1-020510,STIG-Legacy|SV-75473,STIG-Legacy|V-61005,SWIFT-CSCv1|2.3,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,Vuln-ID|V-216074"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          file        : "~/.Xauthority"
          mask        : "177"
        </custom_item>

        <custom_item>
          type        : FIND_CMD
          description : "SOL-11.1-020520 - The .Xauthority files must not have extended ACLs."
          info        : ".Xauthority files ensure the user is authorized to access the specific X Windows host. Extended ACLs may permit unauthorized modification of these files, which could lead to Denial of Service to authorized access or allow unauthorized access to be obtained."
          solution    : "Remove the extended ACL from the file.

# chmod A- .Xauthority"
          reference   : "800-171|3.1.5,800-171|3.4.2,800-53|AC-6,800-53|CM-6b.,800-53r5|AC-6,800-53r5|CM-6b.,CAT|II,CCI|CCI-000225,CCI|CCI-000366,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CN-L3|8.1.10.6(d),CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.AA-05,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,ITSG-33|CM-6b.,NESA|T3.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,Rule-ID|SV-216075r959010_rule,STIG-ID|SOL-11.1-020520,STIG-Legacy|SV-75491,STIG-Legacy|V-61023,SWIFT-CSCv1|2.3,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,Vuln-ID|V-216075"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          not_expect  : ".+"
          exec        : "ls -lL '{}' \\;"
          find_acl    : YES
          find_name   : ".Xauthority"
          find_type   : "f"
        </custom_item>

        <report type:"WARNING">
          description : "SOL-11.1-020530 - X displays must not be exported to the world."
          info        : "Open X displays allow an attacker to capture keystrokes and to execute commands remotely. Many users have their X Server set to xhost +, permitting access to the X Server by anyone, from anywhere.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
          solution    : "If using an xhost-type authentication the xhost - command can be used to remove current trusted hosts and then selectively allow only trusted hosts to connect with xhost + commands. A cryptographically secure authentication, such as provided by the xauth program, is always preferred. Refer to your X11 server's documentation for further security information."
          reference   : "800-171|3.1.5,800-171|3.4.2,800-53|AC-6,800-53|CM-6b.,800-53r5|AC-6,800-53r5|CM-6b.,CAT|I,CCI|CCI-000225,CCI|CCI-000366,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CN-L3|8.1.10.6(d),CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.AA-05,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,ITSG-33|CM-6b.,NESA|T3.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,Rule-ID|SV-216076r959010_rule,STIG-ID|SOL-11.1-020530,STIG-Legacy|SV-75493,STIG-Legacy|V-61025,SWIFT-CSCv1|2.3,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,Vuln-ID|V-216076"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"WARNING">
          description : "SOL-11.1-020540 - .Xauthority or X*.hosts (or equivalent) file(s) must be used to restrict access to the X server."
          info        : "If access to the X server is not restricted, a user's X session may be compromised.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
          solution    : "Create an X*.hosts file, where * is a display number that may be used to limit X window connections.

Add the list of authorized X clients to the file."
          reference   : "800-171|3.4.1,800-171|3.4.2,800-53|CM-2(1)(b),800-53|CM-6b.,800-53r5|CM-2b.2.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000297,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-2(1)(b),ITSG-33|CM-6b.,NESA|T3.2.1,NESA|T3.2.5,NESA|T7.5.1,NIAv2|SS18,QCSC-v1|5.2.1,QCSC-v1|5.2.2,Rule-ID|SV-216077r959010_rule,STIG-ID|SOL-11.1-020540,STIG-Legacy|SV-75495,STIG-Legacy|V-61027,SWIFT-CSCv1|2.3,Vuln-ID|V-216077"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"WARNING">
          description : "SOL-11.1-020550 - The .Xauthority utility must only permit access to authorized hosts."
          info        : "If unauthorized clients are permitted access to the X server, a user's X session may be compromised.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
          solution    : "Remove unauthorized clients from the xauth configuration.

Procedure:
# xauth remove <display name>"
          reference   : "800-171|3.1.5,800-171|3.4.2,800-53|AC-6,800-53|CM-6b.,800-53r5|AC-6,800-53r5|CM-6b.,CAT|II,CCI|CCI-000225,CCI|CCI-000366,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CN-L3|8.1.10.6(d),CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.AA-05,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,ITSG-33|CM-6b.,NESA|T3.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,Rule-ID|SV-216078r959010_rule,STIG-ID|SOL-11.1-020550,STIG-Legacy|SV-75497,STIG-Legacy|V-61029,SWIFT-CSCv1|2.3,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,Vuln-ID|V-216078"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>
      </then>

      <else>
        <report type:"PASSED">
          description : "SOL-11.1-020500 - Any X Windows host must write .Xauthority files."
          info        : ".Xauthority files ensure the user is authorized to access the specific X Windows host. If .Xauthority files are not used, it may be possible to obtain unauthorized access to the X Windows host."
          solution    : "Ensure the X Windows host is configured to write .Xauthority files into user home directories.

Edit the Xaccess file. Ensure the line that writes the .Xauthority file is uncommented."
          reference   : "800-171|3.4.1,800-171|3.4.2,800-53|CM-2(1)(b),800-53|CM-6b.,800-53r5|CM-2b.2.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000297,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-2(1)(b),ITSG-33|CM-6b.,NESA|T3.2.1,NESA|T3.2.5,NESA|T7.5.1,NIAv2|SS18,QCSC-v1|5.2.1,QCSC-v1|5.2.2,Rule-ID|SV-216073r959010_rule,STIG-ID|SOL-11.1-020500,STIG-Legacy|SV-75471,STIG-Legacy|V-61003,SWIFT-CSCv1|2.3,Vuln-ID|V-216073"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-020510 - All .Xauthority files must have mode 0600 or less permissive."
          info        : ".Xauthority files ensure the user is authorized to access the specific X Windows host. Excessive permissions may permit unauthorized modification of these files, which could lead to Denial of Service to authorized access or allow unauthorized access to be obtained."
          solution    : "Change the mode of the .Xauthority files.

Procedure:
# chmod 0600 .Xauthority"
          reference   : "800-171|3.1.5,800-171|3.4.2,800-53|AC-6,800-53|CM-6b.,800-53r5|AC-6,800-53r5|CM-6b.,CAT|II,CCI|CCI-000225,CCI|CCI-000366,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CN-L3|8.1.10.6(d),CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.AA-05,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,ITSG-33|CM-6b.,NESA|T3.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,Rule-ID|SV-216074r959010_rule,STIG-ID|SOL-11.1-020510,STIG-Legacy|SV-75473,STIG-Legacy|V-61005,SWIFT-CSCv1|2.3,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,Vuln-ID|V-216074"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-020520 - The .Xauthority files must not have extended ACLs."
          info        : ".Xauthority files ensure the user is authorized to access the specific X Windows host. Extended ACLs may permit unauthorized modification of these files, which could lead to Denial of Service to authorized access or allow unauthorized access to be obtained."
          solution    : "Remove the extended ACL from the file.

# chmod A- .Xauthority"
          reference   : "800-171|3.1.5,800-171|3.4.2,800-53|AC-6,800-53|CM-6b.,800-53r5|AC-6,800-53r5|CM-6b.,CAT|II,CCI|CCI-000225,CCI|CCI-000366,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CN-L3|8.1.10.6(d),CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.AA-05,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,ITSG-33|CM-6b.,NESA|T3.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,Rule-ID|SV-216075r959010_rule,STIG-ID|SOL-11.1-020520,STIG-Legacy|SV-75491,STIG-Legacy|V-61023,SWIFT-CSCv1|2.3,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,Vuln-ID|V-216075"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-020530 - X displays must not be exported to the world."
          info        : "Open X displays allow an attacker to capture keystrokes and to execute commands remotely. Many users have their X Server set to xhost +, permitting access to the X Server by anyone, from anywhere."
          solution    : "If using an xhost-type authentication the xhost - command can be used to remove current trusted hosts and then selectively allow only trusted hosts to connect with xhost + commands. A cryptographically secure authentication, such as provided by the xauth program, is always preferred. Refer to your X11 server's documentation for further security information."
          reference   : "800-171|3.1.5,800-171|3.4.2,800-53|AC-6,800-53|CM-6b.,800-53r5|AC-6,800-53r5|CM-6b.,CAT|I,CCI|CCI-000225,CCI|CCI-000366,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CN-L3|8.1.10.6(d),CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.AA-05,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,ITSG-33|CM-6b.,NESA|T3.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,Rule-ID|SV-216076r959010_rule,STIG-ID|SOL-11.1-020530,STIG-Legacy|SV-75493,STIG-Legacy|V-61025,SWIFT-CSCv1|2.3,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,Vuln-ID|V-216076"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-020540 - .Xauthority or X*.hosts (or equivalent) file(s) must be used to restrict access to the X server."
          info        : "If access to the X server is not restricted, a user's X session may be compromised."
          solution    : "Create an X*.hosts file, where * is a display number that may be used to limit X window connections.

Add the list of authorized X clients to the file."
          reference   : "800-171|3.4.1,800-171|3.4.2,800-53|CM-2(1)(b),800-53|CM-6b.,800-53r5|CM-2b.2.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000297,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-2(1)(b),ITSG-33|CM-6b.,NESA|T3.2.1,NESA|T3.2.5,NESA|T7.5.1,NIAv2|SS18,QCSC-v1|5.2.1,QCSC-v1|5.2.2,Rule-ID|SV-216077r959010_rule,STIG-ID|SOL-11.1-020540,STIG-Legacy|SV-75495,STIG-Legacy|V-61027,SWIFT-CSCv1|2.3,Vuln-ID|V-216077"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-020550 - The .Xauthority utility must only permit access to authorized hosts."
          info        : "If unauthorized clients are permitted access to the X server, a user's X session may be compromised."
          solution    : "Remove unauthorized clients from the xauth configuration.

Procedure:
# xauth remove <display name>"
          reference   : "800-171|3.1.5,800-171|3.4.2,800-53|AC-6,800-53|CM-6b.,800-53r5|AC-6,800-53r5|CM-6b.,CAT|II,CCI|CCI-000225,CCI|CCI-000366,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CN-L3|8.1.10.6(d),CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.AA-05,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,ITSG-33|CM-6b.,NESA|T3.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,Rule-ID|SV-216078r959010_rule,STIG-ID|SOL-11.1-020550,STIG-Legacy|SV-75497,STIG-Legacy|V-61029,SWIFT-CSCv1|2.3,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,Vuln-ID|V-216078"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>
      </else>
    </if>

    <custom_item>
      system        : "SunOS"
      type          : CMD_EXEC
      description   : "SOL-11.1-020560 - X Window System connections that are not required must be disabled."
      info          : "If unauthorized clients are permitted access to the X server, a user's X session may be compromised."
      solution      : "Disable the X Windows server on the system."
      reference     : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216079r959010_rule,STIG-ID|SOL-11.1-020560,STIG-Legacy|SV-75499,STIG-Legacy|V-61031,SWIFT-CSCv1|2.3,Vuln-ID|V-216079"
      see_also      : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      cmd           : "/usr/bin/ps -ef | /usr/bin/egrep 'X(11|org)' 2>&1 | /usr/bin/awk '{ print } END { if (NR == 0) print \"no processes found\" }'"
      expect        : "^no processes found$"
      dont_echo_cmd : YES
    </custom_item>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : CMD_EXEC
          description : "X-Windows is running"
          cmd         : "/usr/bin/svcprop -p options/tcp_listen svc:/application/x11/x11-server"
          expect      : "true"
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "SOL-11.1-030010 - The graphical login service provides the capability of logging into the system using an X-Windows type interface from the console. If graphical login access for the console is required, the service must be in local-only mode."
          info        : "Externally accessible graphical desktop software may open the system to remote attacks."
          solution    : "The System Administrator profile is required:

Configure the X11 server for local system only graphics access.

# pfexec svccfg -s svc:/application/x11/x11-server setprop options/tcp_listen=false"
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216080r959010_rule,STIG-ID|SOL-11.1-030010,STIG-Legacy|SV-60801,STIG-Legacy|V-47929,SWIFT-CSCv1|2.3,Vuln-ID|V-216080"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          cmd         : "/usr/bin/svcprop -p options/tcp_listen svc:/application/x11/x11-server"
          expect      : "false"
        </custom_item>
      </then>

      <else>
        <report type:"PASSED">
          description : "SOL-11.1-030010 - The graphical login service provides the capability of logging into the system using an X-Windows type interface from the console. If graphical login access for the console is required, the service must be in local-only mode."
          info        : "Externally accessible graphical desktop software may open the system to remote attacks."
          solution    : "The System Administrator profile is required:

Configure the X11 server for local system only graphics access.

# pfexec svccfg -s svc:/application/x11/x11-server setprop options/tcp_listen=false"
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216080r959010_rule,STIG-ID|SOL-11.1-030010,STIG-Legacy|SV-60801,STIG-Legacy|V-47929,SWIFT-CSCv1|2.3,Vuln-ID|V-216080"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>
      </else>
    </if>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "SOL-11.1-030030 - Generic Security Services (GSS) must be disabled."
      info        : "This service should be disabled if it is not required."
      solution    : "The Service Management profile is required:

Disable the GSS service.

# pfexec svcadm disable svc:/network/rpc/gss"
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216081r959010_rule,STIG-ID|SOL-11.1-030030,STIG-Legacy|SV-60803,STIG-Legacy|V-47931,SWIFT-CSCv1|2.3,Vuln-ID|V-216081"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      cmd         : "/usr/bin/svcs -Ho state svc:/network/rpc/gss | /usr/bin/awk \'{ print } END { if (NR == 0) print \"not found\" }\'"
      expect      : "disabled"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "SOL-11.1-030040 - Systems services that are not required must be disabled."
      info        : "Services that are enabled but not required by the mission may provide excessive access or additional attack vectors to penetrate the system.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "The Service Management profile is required:

Disable any other service not required.

# pfexec svcadm disable [service name]"
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216082r959010_rule,STIG-ID|SOL-11.1-030040,STIG-Legacy|SV-60805,STIG-Legacy|V-47933,SWIFT-CSCv1|2.3,Vuln-ID|V-216082"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      cmd         : "/usr/bin/svcs -a | /usr/bin/grep online"
      expect      : ""
      severity    : MEDIUM
    </custom_item>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "'TCP Wrappers'"
          cmd         : "/usr/sbin/inetadm -p | /usr/bin/grep tcp_wrappers"
          expect      : "tcp_wrappers=TRUE"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : FILE_CONTENT_CHECK
          description : "'/etc/hosts.deny'"
          file        : "/etc/hosts.deny"
          regex       : "ALL:[\\s]*ALL"
          expect      : "ALL:[\\s]*ALL"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : FILE_CHECK
          description : "'/etc/hosts.allow'"
          file        : "/etc/hosts.allow"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "SOL-11.1-030050 - TCP Wrappers must be enabled and configured per site policy to only allow access by approved hosts and services."
          info        : "TCP Wrappers are a host-based access control system that allows administrators to control who has access to various network services based on the IP address of the remote end of the connection. TCP Wrappers also provide logging information via syslog about both successful and unsuccessful connections."
          solution    : "The root role is required.

To enable TCP Wrappers, run the following commands:

1. Create and customize your policy in /etc/hosts.allow:
# echo 'ALL: [net]/[mask], [net]/[mask], ...' > /etc/hosts.allow

where each [net>/[mask> combination (for example, the Class C address block '192.168.1.0/255.255.255.0') can represent one network block in use by your organization that requires access to this system.

2. Create a default deny policy in /etc/hosts.deny:

# echo 'ALL: ALL' >/etc/hosts.deny

3. Enable TCP Wrappers for all services started by inetd:

# inetadm -M tcp_wrappers=TRUE

The versions of SunSSH (0.5.11) and sendmail that ship with Solaris 11 will automatically use TCP Wrappers to filter access if a hosts.allow or hosts.deny file exists.

The use of OpenSSH access is controlled by the sshd_config file starting with Solaris 11.3.

SunSSH is removed starting with Solaris 11.4."
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216083r959010_rule,STIG-ID|SOL-11.1-030050,STIG-Legacy|SV-60807,STIG-Legacy|V-47935,SWIFT-CSCv1|2.3,Vuln-ID|V-216083"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : CMD_EXEC
          description : "Global zone auditing is configured."
          cmd         : "/usr/bin/zonename"
          expect      : "^global$"
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "SOL-11.1-030060 - The operating system must disable information system functionality that provides the capability for automatic execution of code on mobile devices without user direction."
          info        : "Mobile devices include portable storage media (e.g., USB memory sticks, external hard disk drives) and portable computing and communications devices with information storage capability (e.g., notebook/laptop computers, personal digital assistants, cellular telephones, digital cameras, audio recording devices).

Auto execution vulnerabilities can result in malicious programs being automatically executed. Examples of information system functionality providing the capability for automatic execution of code are Auto Run and Auto Play. Auto Run and Auto Play are components of the Microsoft Windows operating system that dictate what actions the system takes when a drive is mounted. This requirement is designed to address vulnerabilities that arise when mobile devices such as USB memory sticks or other mobile storage devices are automatically mounted and applications are automatically invoked without user knowledge or acceptance."
          solution    : "The Service Management profile is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

Disable the rmvolmgr service.

# pfexec svcadm disable svc:/system/filesystem/rmvolmgr:default"
          reference   : "800-171|3.13.13,800-53|SC-18(4),800-53r5|SC-18(4),CAT|II,CCI|CCI-001170,CSF|DE.CM-5,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(4),NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-220000r958548_rule,STIG-ID|SOL-11.1-030060,STIG-Legacy|SV-60811,STIG-Legacy|V-47939,Vuln-ID|V-220000"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          cmd         : "/usr/bin/svcs -Ho state svc:/system/filesystem/rmvolmgr:default | /usr/bin/awk \'{ print } END { if (NR == 0) print \"not found\" }\'"
          expect      : "disabled"
        </custom_item>
      </then>

      <else>
        <report type:"PASSED">
          description : "SOL-11.1-030060 - The operating system must disable information system functionality that provides the capability for automatic execution of code on mobile devices without user direction."
          info        : "Mobile devices include portable storage media (e.g., USB memory sticks, external hard disk drives) and portable computing and communications devices with information storage capability (e.g., notebook/laptop computers, personal digital assistants, cellular telephones, digital cameras, audio recording devices).

Auto execution vulnerabilities can result in malicious programs being automatically executed. Examples of information system functionality providing the capability for automatic execution of code are Auto Run and Auto Play. Auto Run and Auto Play are components of the Microsoft Windows operating system that dictate what actions the system takes when a drive is mounted. This requirement is designed to address vulnerabilities that arise when mobile devices such as USB memory sticks or other mobile storage devices are automatically mounted and applications are automatically invoked without user knowledge or acceptance."
          solution    : "The Service Management profile is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

Disable the rmvolmgr service.

# pfexec svcadm disable svc:/system/filesystem/rmvolmgr:default"
          reference   : "800-171|3.13.13,800-53|SC-18(4),800-53r5|SC-18(4),CAT|II,CCI|CCI-001170,CSF|DE.CM-5,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(4),NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-220000r958548_rule,STIG-ID|SOL-11.1-030060,STIG-Legacy|SV-60811,STIG-Legacy|V-47939,Vuln-ID|V-220000"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>
      </else>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : CMD_EXEC
          description : "Check for Solaris 11.0 - 11.3."
          cmd         : "uname -v"
          expect      : "^[\\s]*11\\.[0-3]"
        </custom_item>
      </condition>

      <then>
        <if>
          <condition auto:"FAILED" type:"AND">
            <custom_item>
              system      : "SunOS"
              type        : CMD_EXEC
              description : "'user passwords'"
              cmd         : "/usr/bin/logins -ox | /usr/bin/awk -F: '( $1 != \"root\" && $8 != \"LK\" && $8 != \"NL\" && ( $11 > \"56\" || $11 < \"1\" ) ) { print }' | /usr/bin/awk '{ print } END { if (NR == 0) print \"no invalid expiration\" }'"
              expect      : "no invalid expiration"
            </custom_item>

            <custom_item>
              system      : "SunOS"
              type        : FILE_CONTENT_CHECK
              description : "'MAXWEEKS'"
              file        : "/etc/default/passwd"
              regex       : "^[\\s]*MAXWEEKS[\\s]*="
              expect      : "^[\\s]*MAXWEEKS[\\s]*=[\\s]*@PASSWORD_MAXWEEKS@[\\s]*$"
            </custom_item>
          </condition>

          <then>
            <report type:"PASSED">
              description : "SOL-11.1-040010 - User passwords must be changed at least every 60 days."
              info        : "Limiting the lifespan of authenticators limits the period of time an unauthorized user has access to the system while using compromised credentials and reduces the period of time available for password-guessing attacks to run against a single password.

Solaris 11.4 introduced new password security features that allow for a more granular approach to password duration parameters. The introduction of MAXDAYS, MINDAYS, and WARNDAYS allow the /etc/default/passwd configuration file to enforce a password change every 60 days."
              solution    : "The User Security role is required.

For Solaris 11, 11.1, 11.2, and 11.3:

Change each username to enforce 56 day password changes.

# pfexec passwd -x 56 [username]

# pfedit /etc/default/passwd

Search for MAXWEEKS. Change the line to read:

MAXWEEKS=8

For Solaris 11.4 or newer:

Change each username to enforce 60 day password changes.

# pfexec passwd -x 60 [username]

# pfedit /etc/default/passwd
Note: It is an error to set both the WEEKS and the DAYS variant for a given MIN/MAX/WARN variable.

Search for MAXDAYS. Change the line to read:

MAXDAYS=60

Search for MAXWEEKS. Change the line to read:

#MAXWEEKS="
              reference   : "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(h),CAT|II,CCI|CCI-004066,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-216086r986424_rule,STIG-ID|SOL-11.1-040010,STIG-Legacy|SV-60815,STIG-Legacy|V-47943,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-216086"
              see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
              show_output : YES
            </report>
          </then>
        </if>
      </then>

      <else>
        <if>
          <condition auto:"FAILED" type:"AND">
            <custom_item>
              system      : "SunOS"
              type        : CMD_EXEC
              description : "'user passwords'"
              cmd         : "/usr/bin/logins -ox | /usr/bin/awk -F: '( $1 != \"root\" && $8 != \"LK\" && $8 != \"NL\" && ($11 > \"60\" || $11 < \"1\" )) { print }' | /usr/bin/awk '{ print } END { if (NR == 0) print \"no invalid expiration\" }'"
              expect      : "no invalid expiration"
            </custom_item>

            <custom_item>
              system      : "SunOS"
              type        : FILE_CONTENT_CHECK_NOT
              description : "'MAXDAYS'"
              file        : "/etc/default/passwd"
              regex       : "^[\\s]*MAXDAYS[\\s]*="
              expect      : "^[\\s]*MAXDAYS[\\s]*=([1-9]|[1-5][0-9]|60)"
            </custom_item>

            <custom_item>
              system      : "SunOS"
              type        : FILE_CONTENT_CHECK_NOT
              description : "'MAXWEEKS'"
              file        : "/etc/default/passwd"
              regex       : "^[\\s]*MAXWEEKS[\\s]*="
              expect      : "^[\\s]*MAXWEEKS[\\s]*="
            </custom_item>
          </condition>

          <then>
            <report type:"PASSED">
              description : "SOL-11.1-040010 - User passwords must be changed at least every 60 days."
              info        : "Limiting the lifespan of authenticators limits the period of time an unauthorized user has access to the system while using compromised credentials and reduces the period of time available for password-guessing attacks to run against a single password.

Solaris 11.4 introduced new password security features that allow for a more granular approach to password duration parameters. The introduction of MAXDAYS, MINDAYS, and WARNDAYS allow the /etc/default/passwd configuration file to enforce a password change every 60 days."
              solution    : "The User Security role is required.

For Solaris 11, 11.1, 11.2, and 11.3:

Change each username to enforce 56 day password changes.

# pfexec passwd -x 56 [username]

# pfedit /etc/default/passwd

Search for MAXWEEKS. Change the line to read:

MAXWEEKS=8

For Solaris 11.4 or newer:

Change each username to enforce 60 day password changes.

# pfexec passwd -x 60 [username]

# pfedit /etc/default/passwd
Note: It is an error to set both the WEEKS and the DAYS variant for a given MIN/MAX/WARN variable.

Search for MAXDAYS. Change the line to read:

MAXDAYS=60

Search for MAXWEEKS. Change the line to read:

#MAXWEEKS="
              reference   : "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(h),CAT|II,CCI|CCI-004066,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-216086r986424_rule,STIG-ID|SOL-11.1-040010,STIG-Legacy|SV-60815,STIG-Legacy|V-47943,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-216086"
              see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
              show_output : YES
            </report>
          </then>
        </if>
      </else>
    </if>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "SOL-11.1-040020 - The operating system must automatically terminate temporary accounts within 72 hours."
      info        : "If temporary user accounts remain active when no longer needed or for an excessive period, these accounts may be used to gain unauthorized access. To mitigate this risk, automated termination of all temporary accounts must be set upon account creation.

Temporary accounts are established as part of normal account activation procedures when there is a need for short-term accounts without the demand for immediacy in account activation.

If temporary accounts are used, the operating system must be configured to automatically terminate these types of accounts after a DoD-defined time period of 72 hours.

When temporary and emergency accounts are created, there is a risk the temporary account may remain in place and active after the need for the account no longer exists.

To address this, in the event temporary accounts are required, accounts designated as temporary in nature must be automatically terminated after 72 hours. Such a process and capability greatly reduces the risk of accounts being misused, hijacked, or data compromised.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "The User Security role is required.

Apply an expiration date to temporary users.

# pfexec usermod -e '[date]' [username]

Enter the date in the form mm/dd/yyyy such that it is within 72 hours."
      reference   : "800-171|3.1.1,800-53|AC-2(2),800-53r5|AC-2(2),CAT|III,CCI|CCI-000016,CN-L3|7.1.3.2(e),CSF|PR.AC-1,CSF|PR.AC-4,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|PR.AA-01,CSF2.0|PR.AA-05,CSF2.0|PR.DS-10,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(2),NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,Rule-ID|SV-216087r958364_rule,STIG-ID|SOL-11.1-040020,STIG-Legacy|SV-60821,STIG-Legacy|V-47949,Vuln-ID|V-216087"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      cmd         : "/usr/bin/logins -aox | /usr/bin/cut -d: -f1,14"
      expect      : ""
      severity    : MEDIUM
    </custom_item>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : CMD_EXEC
          description : "Check for Solaris 11.0 - 11.3."
          cmd         : "uname -v"
          expect      : "^[\\s]*11\\.[0-3]"
        </custom_item>
      </condition>

      <then>
        <if>
          <condition auto:"FAILED" type:"AND">
            <custom_item>
              system        : "SunOS"
              type          : CMD_EXEC
              description   : "'/etc/shadow'"
              cmd           : "(/usr/bin/logins -uo; /usr/bin/cat /etc/shadow) | /usr/bin/awk -F: '$4 < 1 || int($2) > 99 { print $1 }' | /usr/bin/sort | /usr/bin/uniq -d 2>&1 | /usr/bin/awk '{ print } END { if (NR == 0) print \"no accounts found\" }'"
              expect        : "^no accounts found$"
              dont_echo_cmd : YES
            </custom_item>

            <custom_item>
              system      : "SunOS"
              type        : FILE_CONTENT_CHECK
              description : "'MINWEEKS'"
              file        : "/etc/default/passwd"
              regex       : "^[\\s]*MINWEEKS[\\s]*="
              expect      : "^[\\s]*MINWEEKS[\\s]*=[\\s]*@PASSWORD_MIN_WEEKS@[\\s]*$"
            </custom_item>
          </condition>

          <then>
            <report type:"PASSED">
              description : "SOL-11.1-040030 - The operating system must enforce minimum password lifetime restrictions."
              info        : "Passwords need to be changed at specific policy-based intervals; however, if the information system or application allows the user to immediately and continually change their password, then the password could be repeatedly changed in a short period of time, defeating the organization's policy regarding password reuse.

Solaris 11.4 introduced new password security features that allow for a more granular approach to password duration parameters. The introduction of MAXDAYS, MINDAYS, and WARNDAYS allow the /etc/default/passwd configuration file to enforce a minimum password lifetime of a single day."
              solution    : "The root role is required.

For Solaris 11, 11.1, 11.2, and 11.3:

# pfedit /etc/default/passwd file.

Locate the line containing:

MINWEEKS

Change the line to read:

MINWEEKS=1

Set the per-user minimum password change times by using the following command on each user account.

# passwd -n [number of days] [accountname]

For Solaris 11.4 or newer:

# pfedit /etc/default/passwd file.
Note: It is an error to set both the WEEKS and the DAYS variant for a given MIN/MAX/WARN variable.

Search for MINDAYS. Change the line to read:

MINDAYS=1

Search for MINWEEKS. Change the line to read:

#MINWEEKS=

Set the per-user minimum password change times by using the following command on each user account.

# passwd -n [number of days] [accountname]"
              reference   : "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(h),CAT|II,CCI|CCI-004066,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-216088r986427_rule,STIG-ID|SOL-11.1-040030,STIG-Legacy|SV-60825,STIG-Legacy|V-47953,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-216088"
              see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
              show_output : YES
            </report>
          </then>
        </if>
      </then>

      <else>
        <if>
          <condition auto:"FAILED" type:"AND">
            <custom_item>
              system        : "SunOS"
              type          : CMD_EXEC
              description   : "'/etc/shadow'"
              cmd           : "(/usr/bin/logins -uo; /usr/bin/cat /etc/shadow) | /usr/bin/awk -F: '$4 < 1 || int($2) > 99 { print $1 }' | /usr/bin/sort | /usr/bin/uniq -d 2>&1 | /usr/bin/awk '{ print } END { if (NR == 0) print \"no accounts found\" }'"
              expect        : "^no accounts found$"
              dont_echo_cmd : YES
            </custom_item>

            <custom_item>
              system      : "SunOS"
              type        : FILE_CONTENT_CHECK
              description : "'MINDAYS'"
              file        : "/etc/default/passwd"
              regex       : "^[\\s]*MINDAYS[\\s]*="
              expect      : "^[\\s]*MINDAYS[\\s]*=[\\s]*@PASSWORD_MIN_DAYS@[\\s]*$"
            </custom_item>

            <custom_item>
              system      : "SunOS"
              type        : FILE_CONTENT_CHECK_NOT
              description : "'MINWEEKS'"
              file        : "/etc/default/passwd"
              regex       : "^[\\s]*MINWEEKS[\\s]*="
              expect      : "^[\\s]*MINWEEKS[\\s]*="
            </custom_item>
          </condition>

          <then>
            <report type:"PASSED">
              description : "SOL-11.1-040030 - The operating system must enforce minimum password lifetime restrictions."
              info        : "Passwords need to be changed at specific policy-based intervals; however, if the information system or application allows the user to immediately and continually change their password, then the password could be repeatedly changed in a short period of time, defeating the organization's policy regarding password reuse.

Solaris 11.4 introduced new password security features that allow for a more granular approach to password duration parameters. The introduction of MAXDAYS, MINDAYS, and WARNDAYS allow the /etc/default/passwd configuration file to enforce a minimum password lifetime of a single day."
              solution    : "The root role is required.

For Solaris 11, 11.1, 11.2, and 11.3:

# pfedit /etc/default/passwd file.

Locate the line containing:

MINWEEKS

Change the line to read:

MINWEEKS=1

Set the per-user minimum password change times by using the following command on each user account.

# passwd -n [number of days] [accountname]

For Solaris 11.4 or newer:

# pfedit /etc/default/passwd file.
Note: It is an error to set both the WEEKS and the DAYS variant for a given MIN/MAX/WARN variable.

Search for MINDAYS. Change the line to read:

MINDAYS=1

Search for MINWEEKS. Change the line to read:

#MINWEEKS=

Set the per-user minimum password change times by using the following command on each user account.

# passwd -n [number of days] [accountname]"
              reference   : "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(h),CAT|II,CCI|CCI-004066,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-216088r986427_rule,STIG-ID|SOL-11.1-040030,STIG-Legacy|SV-60825,STIG-Legacy|V-47953,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-216088"
              see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
              show_output : YES
            </report>
          </then>
        </if>
      </else>
    </if>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "SOL-11.1-040040 - User passwords must be at least 15 characters in length."
      info        : "Password complexity, or strength, is a measure of the effectiveness of a password in resisting guessing and brute-force attacks.

Password length is one factor of several that helps to determine strength and how long it takes to crack a password. The shorter the password is, the lower the number of possible combinations that need to be tested before the password is compromised.

Use of more characters in a password helps to exponentially increase the time and/or resources required to compromise the password."
      solution    : "The root role is required.

# pfedit /etc/default/passwd

Locate the line containing:

PASSLENGTH

Change the line to read:

PASSLENGTH=15"
      reference   : "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(h),CAT|II,CCI|CCI-004066,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-216089r986429_rule,STIG-ID|SOL-11.1-040040,STIG-Legacy|SV-60829,STIG-Legacy|V-47957,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-216089"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      file        : "/etc/default/passwd"
      regex       : "^[\\s]*PASSLENGTH[\\s]*="
      expect      : "^[\\s]*PASSLENGTH[\\s]*=[\\s]*@PASSWORD_MINIMUM_LENGTH@$"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "SOL-11.1-040060 - The system must require at least eight characters be changed between the old and new passwords during a password change."
      info        : "To ensure password changes are effective in their goals, the system must ensure old and new passwords have significant differences. Without significant changes, new passwords may be easily guessed based on the value of a previously compromised password."
      solution    : "The root role is required.

# pfedit /etc/default/passwd

Search for MINDIFF. Change the line to read:

MINDIFF=8"
      reference   : "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(h),CAT|II,CCI|CCI-004066,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-216091r986431_rule,STIG-ID|SOL-11.1-040060,STIG-Legacy|SV-60839,STIG-Legacy|V-47967,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-216091"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      file        : "/etc/default/passwd"
      regex       : "^[\\s]*MINDIFF[\\s]*="
      expect      : "^[\\s]*MINDIFF[\\s]*=[\\s]*@PASSWORD_MINDIFF@[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "SOL-11.1-040070 - The system must require passwords to contain at least one uppercase alphabetic character."
      info        : "Complex passwords can reduce the likelihood of success of automated password-guessing attacks."
      solution    : "The root role is required.

# pfedit /etc/default/passwd

Locate the line containing:

MINUPPER

Change the line to read:

MINUPPER=1"
      reference   : "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(h),CAT|II,CCI|CCI-004066,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-216092r986434_rule,STIG-ID|SOL-11.1-040070,STIG-Legacy|SV-60843,STIG-Legacy|V-47971,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-216092"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      file        : "/etc/default/passwd"
      regex       : "^[\\s]*MINUPPER[\\s]*="
      expect      : "^[\\s]*MINUPPER[\\s]*=[\\s]*@PASSWORD_MINUPPER@[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "SOL-11.1-040080 - The operating system must enforce password complexity requiring that at least one lowercase character is used."
      info        : "Complex passwords can reduce the likelihood of success of automated password-guessing attacks."
      solution    : "The root role is required.

# pfedit /etc/default/passwd

Locate the line containing:

MINLOWER

Change the line to read:

MINLOWER=1"
      reference   : "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(h),CAT|II,CCI|CCI-004066,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-216093r986437_rule,STIG-ID|SOL-11.1-040080,STIG-Legacy|SV-60853,STIG-Legacy|V-47981,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-216093"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      file        : "/etc/default/passwd"
      regex       : "^[\\s]*MINLOWER[\\s]*="
      expect      : "^[\\s]*MINLOWER[\\s]*=[\\s]*@PASSWORD_MINLOWER@[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "SOL-11.1-040090 - The system must require passwords to contain at least one numeric character."
      info        : "Complex passwords can reduce the likelihood of success of automated password-guessing attacks."
      solution    : "The root role is required.

# pfedit /etc/default/passwd

Locate the line containing:

MINDIGIT

Change the line to read:

MINDIGIT=1"
      reference   : "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(h),CAT|II,CCI|CCI-004066,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-216094r986440_rule,STIG-ID|SOL-11.1-040090,STIG-Legacy|SV-60861,STIG-Legacy|V-47989,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-216094"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      file        : "/etc/default/passwd"
      regex       : "^[\\s]*MINDIGIT[\\s]*="
      expect      : "^[\\s]*MINDIGIT[\\s]*=[\\s]*@PASSWORD_MINDIGIT@[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "SOL-11.1-040100 - The system must require passwords to contain at least one special character."
      info        : "Complex passwords can reduce the likelihood of success of automated password-guessing attacks."
      solution    : "The root role is required.

# pfedit /etc/default/passwd a

Locate the line containing:

MINSPECIAL

Change the line to read:

MINSPECIAL=1"
      reference   : "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(h),CAT|II,CCI|CCI-004066,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-216095r986443_rule,STIG-ID|SOL-11.1-040100,STIG-Legacy|SV-60863,STIG-Legacy|V-47991,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-216095"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      file        : "/etc/default/passwd"
      regex       : "^[\\s]*MINSPECIAL[\\s]*="
      expect      : "^[\\s]*MINSPECIAL[\\s]*=[\\s]*@PASSWORD_MINSPECIAL@[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "SOL-11.1-040110 - The system must require passwords to contain no more than three consecutive repeating characters."
      info        : "Complex passwords can reduce the likelihood of success of automated password-guessing attacks."
      solution    : "The root role is required.
# pfedit /etc/default/passwd

Locate the line containing:

MAXREPEATS

Change the line to read:

MAXREPEATS=3"
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216096r959010_rule,STIG-ID|SOL-11.1-040110,STIG-Legacy|SV-60865,STIG-Legacy|V-47993,SWIFT-CSCv1|2.3,Vuln-ID|V-216096"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      file        : "/etc/default/passwd"
      regex       : "^[\\s]*MAXREPEATS[\\s]*="
      expect      : "^[\\s]*MAXREPEATS[\\s]*=[\\s]*@PASSWORD_MAXREPEATS@[\\s]*$"
    </custom_item>

    <custom_item>
      system        : "SunOS"
      type          : CMD_EXEC
      description   : "SOL-11.1-040120 - The system must not have accounts configured with blank or null passwords."
      info          : "Complex passwords can reduce the likelihood of success of automated password-guessing attacks."
      solution      : "The root role is required.

Remove, lock, or configure a password for any account with a blank password.

# passwd [username]
or
Use the passwd -l command to lock accounts that are not permitted to execute commands.
or
Use the passwd -N command to set accounts to be non-login."
      reference     : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216097r959010_rule,STIG-ID|SOL-11.1-040120,STIG-Legacy|SV-60871,STIG-Legacy|V-47999,SWIFT-CSCv1|2.3,Vuln-ID|V-216097"
      see_also      : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      cmd           : "/usr/bin/logins -p 2>&1 | /usr/bin/awk '{ print } END { if (NR == 0) print \"no accounts found\" }'"
      expect        : "^no accounts found$"
      dont_echo_cmd : YES
    </custom_item>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          system      : "SunOS"
          type        : FILE_CONTENT_CHECK
          description : "'CRYPT_DEFAULT'"
          file        : "/etc/security/policy.conf"
          regex       : "^[\\s]*CRYPT_DEFAULT="
          expect      : "^[\\s]*CRYPT_DEFAULT=6[\\s]*$"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : FILE_CONTENT_CHECK
          description : "CRYPT_ALGORITHMS_ALLOW"
          file        : "/etc/security/policy.conf"
          regex       : "^[\\s]*CRYPT_ALGORITHMS_ALLOW="
          expect      : "^[\\s]*CRYPT_ALGORITHMS_ALLOW=5,6[\\s]*$"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "SOL-11.1-040130 - Systems must employ cryptographic hashes for passwords using the SHA-2 family of algorithms or FIPS 140-2 approved successors."
          info        : "Cryptographic hashes provide quick password authentication while not actually storing the password."
          solution    : "The root role is required.

Configure the system to disallow the use of UNIX encryption and enable SHA256 as the default encryption hash.

# pfedit /etc/security/policy.conf

Check that the following lines exist and are not commented out:

CRYPT_DEFAULT=6
CRYPT_ALGORITHMS_ALLOW=5,6"
          reference   : "800-171|3.5.2,800-53|IA-5(1)(d),800-53r5|IA-5(1)(d),CAT|II,CCI|CCI-004062,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(d),NESA|T5.2.3,NIAv2|AM20,NIAv2|AM21,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-216098r986446_rule,STIG-ID|SOL-11.1-040130,STIG-Legacy|SV-61115,STIG-Legacy|V-48243,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.2,Vuln-ID|V-216098"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          system      : "SunOS"
          type        : FILE_CONTENT_CHECK
          description : "'RETRIES'"
          file        : "/etc/default/login"
          regex       : "^[\\s]*RETRIES[\\s]*="
          expect      : "^[\\s]*RETRIES[\\s]*=[\\s]*[1-3][\\s]*$"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : FILE_CONTENT_CHECK
          description : "'LOCK_AFTER_RETRIES'"
          file        : "/etc/security/policy.conf"
          regex       : "^[\\s]*LOCK_AFTER_RETRIES[\\s]*="
          expect      : "^[\\s]*LOCK_AFTER_RETRIES[\\s]*=[\\s]*[yY][eE][sS][\\s]*$"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "user overrides"
          cmd         : "/usr/bin/echo $(for user in $(/usr/bin/cut -d: -f1 /etc/passwd); do echo \"$user: $(userattr lock_after_retries $user 2> /dev/null)\"; done | awk '/: no$/ { print; f++} END { if (!f) print \"no user overrides\" }')"
          expect      : "no user overrides"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "SOL-11.1-040140 - The system must disable accounts after three consecutive unsuccessful login attempts."
          info        : "Allowing continued access to accounts on the system exposes them to brute-force password-guessing attacks."
          solution    : "The root role is required.

# pfedit /etc/default/login

Change the line:

#RETRIES=5

to read

RETRIES=3

pfedit /etc/security/policy.conf

Change the line containing

#LOCK_AFTER_RETRIES

to read:

LOCK_AFTER_RETRIES=YES


If a user has lock_after_retries set to 'no', update the user's attributes using the command:

# usermod -K lock_after_retries=yes [username]"
          reference   : "800-171|3.1.8,800-53|AC-7a.,800-53r5|AC-7a.,CAT|II,CCI|CCI-000044,CN-L3|8.1.4.1(b),CSF2.0|PR.AA-03,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-7a.,NESA|T5.5.1,NIAv2|AM24,PCI-DSSv3.2.1|8.1.6,PCI-DSSv4.0|8.3.4,Rule-ID|SV-216099r958388_rule,STIG-ID|SOL-11.1-040140,STIG-Legacy|SV-61117,STIG-Legacy|V-48245,TBA-FIISB|45.1.2,TBA-FIISB|45.2.1,TBA-FIISB|45.2.2,Vuln-ID|V-216099"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "SOL-11.1-040160 - The delay between login prompts following a failed login attempt must be at least 4 seconds."
      info        : "As an immediate return of an error message, coupled with the capability to try again, may facilitate automatic and rapid-fire brute-force password attacks by a malicious user."
      solution    : "The root role is required.

# pfedit the /etc/default/login

Locate the line containing:

SLEEPTIME

Change the line to read:

SLEEPTIME=4"
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216100r959010_rule,STIG-ID|SOL-11.1-040160,STIG-Legacy|SV-60915,STIG-Legacy|V-48043,SWIFT-CSCv1|2.3,Vuln-ID|V-216100"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      file        : "/etc/default/login"
      regex       : "^[\\s]*SLEEPTIME[\\s]*="
      expect      : "^[\\s]*SLEEPTIME[\\s]*=[\\s]*[4-9][\\s]*$"
    </custom_item>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : CMD_EXEC
          description : "X-Windows is running"
          cmd         : "/usr/bin/svcprop -p options/tcp_listen svc:/application/x11/x11-server"
          expect      : "true"
        </custom_item>
      </condition>

      <then>
        <if>
          <condition auto:"FAILED" type:"AND">
            <custom_item>
              system      : "SunOS"
              type        : FILE_CONTENT_CHECK
              description : "'*timeout'"
              file        : "/usr/share/X11/app-defaults/XScreenSaver"
              regex       : "^[\\s]*\\*timeout[\\s]*:"
              expect      : "^[\\s]*\\*timeout[\\s]*:[\\s]*0:(1[0-5]|[1-9]):[0-9][0-9][\\s]*$"
            </custom_item>

            <custom_item>
              system      : "SunOS"
              type        : FILE_CONTENT_CHECK
              description : "'*lockTimeout'"
              file        : "/usr/share/X11/app-defaults/XScreenSaver"
              regex       : "^[\\s]*\\*lockTimeout[\\s]*:"
              expect      : "^[\\s]*\\*lockTimeout[\\s]*:[\\s]*0:00:0[0-5][\\s]*$"
            </custom_item>

            <custom_item>
              system      : "SunOS"
              type        : FILE_CONTENT_CHECK
              description : "'*lock'"
              file        : "/usr/share/X11/app-defaults/XScreenSaver"
              regex       : "^[\\s]*\\*lock[\\s]*:"
              expect      : "^[\\s]*\\*lock[\\s]*:[\\s]*[tT][rR][uU][eE][\\s]*$"
            </custom_item>

            <custom_item>
              system      : "SunOS"
              type        : FILE_CONTENT_CHECK
              description : "'user lock'"
              file        : "~/.xscreensaver"
              regex       : "^[\\s]*lock[\\s]*:"
              expect      : "^[\\s]*lock[\\s]*:[\\s]*[tT][rR][uU][eE][\\s]*$"
            </custom_item>

            <custom_item>
              system      : "SunOS"
              type        : FILE_CONTENT_CHECK
              description : "'user lockTimeout'"
              file        : "~/.xscreensaver"
              regex       : "^[\\s]*\\*lockTimeout[\\s]*:"
              expect      : "^[\\s]*\\*lockTimeout[\\s]*:[\\s]*0:00:0[0-5][\\s]*$"
            </custom_item>

            <custom_item>
              system      : "SunOS"
              type        : FILE_CONTENT_CHECK
              description : "'user timeout'"
              file        : "~/.xscreensaver"
              regex       : "^[\\s]*timeout[\\s]*:"
              expect      : "^[\\s]*\\*timeout[\\s]*:[\\s]*0:(1[0-5]|[1-9]):[0-9][0-9][\\s]*$"
            </custom_item>
          </condition>

          <then>
            <report type:"PASSED">
              description : "SOL-11.1-040170 - The system must require users to re-authenticate to unlock a graphical desktop environment."
              info        : "Allowing access to a graphical environment when the user is not attending the system can allow unauthorized users access to the system."
              solution    : "The root role is required.

Edit the global screensaver configuration file to ensure 15 minute screen lock.

# pfedit /usr/share/X11/app-defaults/XScreenSaver

Find the timeout control lines and change them to read:

*timeout: 0:15:00
*lockTimeout: 0:00:05
*lock: True

For each user on the system, edit their local $HOME/.xscreensaver file and change the timeout values.

# pfedit $HOME/.xscreensaver

Find the timeout control lines and change them to read:

timeout: 0:15:00
lockTimeout: 0:00:05
lock: True"
              reference   : "800-171|3.1.10,800-53|AC-11b.,800-53r5|AC-11b.,CAT|II,CCI|CCI-000056,CN-L3|8.1.4.1(b),DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11b.,NIAv2|AM23e,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,Rule-ID|SV-216101r958400_rule,STIG-ID|SOL-11.1-040170,STIG-Legacy|SV-60917,STIG-Legacy|V-48045,Vuln-ID|V-216101"
              see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
              show_output : YES
            </report>
          </then>
        </if>

        <if>
          <condition auto:"FAILED" type:"AND">
            <custom_item>
              system      : "SunOS"
              type        : FILE_CONTENT_CHECK
              description : "'*timeout'"
              file        : "/usr/share/X11/app-defaults/XScreenSaver"
              regex       : "^[\\s]*\\*timeout[\\s]*:"
              expect      : "^[\\s]*\\*timeout[\\s]*:[\\s]*0:(1[0-5]|[1-9]):00[\\s]*$"
            </custom_item>

            <custom_item>
              system      : "SunOS"
              type        : FILE_CONTENT_CHECK
              description : "'*lockTimeout'"
              file        : "/usr/share/X11/app-defaults/XScreenSaver"
              regex       : "^[\\s]*\\*lockTimeout[\\s]*:"
              expect      : "^[\\s]*\\*lockTimeout[\\s]*:[\\s]*0:00:05[\\s]*$"
            </custom_item>

            <custom_item>
              system      : "SunOS"
              type        : FILE_CONTENT_CHECK
              description : "'*lock'"
              file        : "/usr/share/X11/app-defaults/XScreenSaver"
              regex       : "^[\\s]*\\*lock[\\s]*:"
              expect      : "^[\\s]*\\*lock[\\s]*:[\\s]*[tT][rR][uU][eE][\\s]*$"
            </custom_item>

            <custom_item>
              system      : "SunOS"
              type        : FILE_CONTENT_CHECK
              description : "'user lock'"
              file        : "~/.xscreensaver"
              regex       : "^[\\s]*lock[\\s]*:"
              expect      : "^[\\s]*lock[\\s]*:[\\s]*[tT][rR][uU][eE][\\s]*$"
            </custom_item>

            <custom_item>
              system      : "SunOS"
              type        : FILE_CONTENT_CHECK
              description : "'user lockTimeout'"
              file        : "~/.xscreensaver"
              regex       : "^[\\s]*\\*lockTimeout[\\s]*:"
              expect      : "^[\\s]*\\*lockTimeout[\\s]*:[\\s]*0:00:05[\\s]*$"
            </custom_item>

            <custom_item>
              system      : "SunOS"
              type        : FILE_CONTENT_CHECK
              description : "'user timeout'"
              file        : "~/.xscreensaver"
              regex       : "^[\\s]*timeout[\\s]*:"
              expect      : "^[\\s]*\\*timeout[\\s]*:[\\s]*0:(1[0-5]|[1-9]):00[\\s]*$"
            </custom_item>
          </condition>

          <then>
            <report type:"PASSED">
              description : "SOL-11.1-040180 - Graphical desktop environments provided by the system must automatically lock after 15 minutes of inactivity."
              info        : "Allowing access to a graphical environment when the user is not attending the system can allow unauthorized users access to the system."
              solution    : "The root role is required.

Edit the global screensaver configuration file to ensure 15 minute screen lock.

# pfedit /usr/share/X11/app-defaults/XScreenSaver

Find the timeout control lines and change them to read:

*timeout: 0:15:00
*lockTimeout:0:00:05
*lock: True

For each user on the system, edit their local $HOME/.xscreensaver file and change the timeout values.

# pfedit $HOME/.xscreensaver

Find the timeout control lines and change them to read:

timeout: 0:15:00
lockTimeout:0:00:05
lock: True"
              reference   : "800-171|3.1.10,800-53|AC-11a.,800-53r5|AC-11a.,CAT|II,CCI|CCI-000057,CN-L3|8.1.4.1(b),DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11a.,NESA|T2.3.8,NESA|T2.3.9,NIAv2|AM23a,NIAv2|AM23b,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,Rule-ID|SV-216102r958402_rule,STIG-ID|SOL-11.1-040180,STIG-Legacy|SV-60919,STIG-Legacy|V-48047,Vuln-ID|V-216102"
              see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
              show_output : YES
            </report>
          </then>
        </if>
      </then>

      <else>
        <report type:"PASSED">
          description : "SOL-11.1-040170 - The system must require users to re-authenticate to unlock a graphical desktop environment."
          info        : "Allowing access to a graphical environment when the user is not attending the system can allow unauthorized users access to the system."
          solution    : "The root role is required.

Edit the global screensaver configuration file to ensure 15 minute screen lock.

# pfedit /usr/share/X11/app-defaults/XScreenSaver

Find the timeout control lines and change them to read:

*timeout: 0:15:00
*lockTimeout: 0:00:05
*lock: True

For each user on the system, edit their local $HOME/.xscreensaver file and change the timeout values.

# pfedit $HOME/.xscreensaver

Find the timeout control lines and change them to read:

timeout: 0:15:00
lockTimeout: 0:00:05
lock: True"
          reference   : "800-171|3.1.10,800-53|AC-11b.,800-53r5|AC-11b.,CAT|II,CCI|CCI-000056,CN-L3|8.1.4.1(b),DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11b.,NIAv2|AM23e,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,Rule-ID|SV-216101r958400_rule,STIG-ID|SOL-11.1-040170,STIG-Legacy|SV-60917,STIG-Legacy|V-48045,Vuln-ID|V-216101"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-040180 - Graphical desktop environments provided by the system must automatically lock after 15 minutes of inactivity."
          info        : "Allowing access to a graphical environment when the user is not attending the system can allow unauthorized users access to the system."
          solution    : "The root role is required.

Edit the global screensaver configuration file to ensure 15 minute screen lock.

# pfedit /usr/share/X11/app-defaults/XScreenSaver

Find the timeout control lines and change them to read:

*timeout: 0:15:00
*lockTimeout:0:00:05
*lock: True

For each user on the system, edit their local $HOME/.xscreensaver file and change the timeout values.

# pfedit $HOME/.xscreensaver

Find the timeout control lines and change them to read:

timeout: 0:15:00
lockTimeout:0:00:05
lock: True"
          reference   : "800-171|3.1.10,800-53|AC-11a.,800-53r5|AC-11a.,CAT|II,CCI|CCI-000057,CN-L3|8.1.4.1(b),DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11a.,NESA|T2.3.8,NESA|T2.3.9,NIAv2|AM23a,NIAv2|AM23b,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,Rule-ID|SV-216102r958402_rule,STIG-ID|SOL-11.1-040180,STIG-Legacy|SV-60919,STIG-Legacy|V-48047,Vuln-ID|V-216102"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>
      </else>
    </if>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          system      : "SunOS"
          type        : FILE_CONTENT_CHECK
          description : "'DICTIONLIST'"
          file        : "/etc/default/passwd"
          regex       : "^[\\s]*DICTIONLIST[\\s]*="
          expect      : "^[\\s]*DICTIONLIST[\\s]*=[\\s]*@PASSWORD_DICTIONLIST@[\\s]*$"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : FILE_CONTENT_CHECK
          description : "'DICTIONDBDIR'"
          file        : "/etc/default/passwd"
          regex       : "^[\\s]*DICTIONDBDIR[\\s]*="
          expect      : "^[\\s]*DICTIONDBDIR[\\s]*=[\\s]*@PASSWORD_DICTIONDBDIR@[\\s]*$"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : FILE_CHECK
          description : "'/var/passwd'"
          file        : "/var/passwd"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : FILE_CHECK
          description : "/usr/share/lib/dict/words"
          file        : "/usr/share/lib/dict/words"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "SOL-11.1-040190 - The system must prevent the use of dictionary words for passwords."
          info        : "The use of common words in passwords simplifies password-cracking attacks."
          solution    : "The root role is required.

# pfedit /etc/default/passwd

Insert the lines:

DICTIONLIST=/usr/share/lib/dict/words
DICTIONDBDIR=/var/passwd

Generate the password dictionary by running the mkpwdict command.

# mkpwdict -s /usr/share/lib/dict/words"
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216103r959010_rule,STIG-ID|SOL-11.1-040190,STIG-Legacy|SV-60925,STIG-Legacy|V-48053,SWIFT-CSCv1|2.3,Vuln-ID|V-216103"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "'userattr role'"
          cmd         : "/usr/bin/userattr type root"
          expect      : "role"
        </custom_item>

        <custom_item>
          system        : "SunOS"
          type          : CMD_EXEC
          description   : "'user root role'"
          cmd           : "/usr/bin/grep '[:;]roles=root[^;]*' /etc/user_attr | /usr/bin/awk '{ print } END { if (NR != 0) print \"user found\" }'"
          expect        : "user found"
          dont_echo_cmd : YES
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "SOL-11.1-040200 - The system must restrict the ability of users to assume excessive privileges to members of a defined group and prevent unauthorized users from accessing administrative tools."
          info        : "Allowing any user to elevate their privileges can allow them excessive control of the system tools."
          solution    : "The root role is required.

Convert the root user into a role.

# usermod -K type=role root

Add the root role to authorized users' logins.

# usermod -R +root [username]

Remove the root role from users who should not be authorized to assume it.

# usermod -R -root [username]"
          reference   : "800-171|3.1.7,800-53|AC-6(10),800-53r5|AC-6(10),CAT|II,CCI|CCI-002235,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,CSF2.0|PR.AA-05,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,Rule-ID|SV-220001r958726_rule,STIG-ID|SOL-11.1-040200,STIG-Legacy|SV-60927,STIG-Legacy|V-48055,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,Vuln-ID|V-220001"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "'user root role'"
          cmd         : "/usr/bin/userattr type root"
          expect      : "role"
        </custom_item>

        <custom_item>
          system        : "SunOS"
          type          : CMD_EXEC
          description   : "'userattr role'"
          cmd           : "/usr/bin/grep '[:;]roles=root[^;]*' /etc/user_attr | /usr/bin/awk '{ print } END { if (NR != 0) print \"user found\" }'"
          expect        : "user found"
          dont_echo_cmd : YES
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "SOL-11.1-040230 - The operating system must require individuals to be authenticated with an individual authenticator prior to using a group authenticator."
          info        : "Allowing any user to elevate their privileges can allow them excessive control of the system tools."
          solution    : "The root role is required.

Convert the root user into a role.

# usermod -K type=role root

Add the root role to authorized users' logins.

# usermod -R +root [username]

Remove the root role from users who should not be authorized to assume it.

# usermod -R -root [username]"
          reference   : "800-171|3.5.1,800-53|IA-2(5),800-53r5|IA-2(5),CAT|II,CCI|CCI-004045,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2(5),ITSG-33|IA-2(5)(a),ITSG-33|IA-2(5)(b),NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-216105r986447_rule,STIG-ID|SOL-11.1-040230,STIG-Legacy|SV-60929,STIG-Legacy|V-48057,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-216105"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          system      : "SunOS"
          type        : FILE_CONTENT_CHECK
          description : "/etc/default/login"
          file        : "/etc/default/login"
          regex       : "^[\\s]*[Uu][Mm][Aa][Ss][Kk][\\s]*="
          expect      : "^[\\s]*[Uu][Mm][Aa][Ss][Kk][\\s]*=[\\s]*077[\\s]*$"
        </custom_item>

        <custom_item>
          system          : "SunOS"
          type            : FILE_CONTENT_CHECK
          description     : "'user umask'"
          file            : "~/.[!.]*"
          regex           : "^[\\s]*[Uu][Mm][Aa][Ss][Kk][\\s]*="
          expect          : "^[\\s]*[Uu][Mm][Aa][Ss][Kk][\\s]*=[\\s]*077[\\s]*$"
          file_required   : NO
          string_required : NO
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "SOL-11.1-040250 - The default umask for system and users must be 077."
          info        : "Setting a very secure default value for umask ensures that users make a conscious choice about their file permissions."
          solution    : "The root role is required.

Edit local and global initialization files containing 'umask' and change them to use 077.

# pfedit /etc/default/login

Insert the line
UMASK=077

# pfedit [user initialization file]

Insert the line
umask 077"
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216106r959010_rule,STIG-ID|SOL-11.1-040250,STIG-Legacy|SV-60933,STIG-Legacy|V-48061,SWIFT-CSCv1|2.3,Vuln-ID|V-216106"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : CMD_EXEC
          description : "FTP is installed"
          cmd         : "/usr/bin/pkg list service/network/ftp 2>&1"
          expect      : "no packages matching"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "SOL-11.1-040260 - The default umask for FTP users must be 077."
          info        : "Setting a very secure default value for umask ensures that users make a conscious choice about their file permissions."
          solution    : "The root role is required.

# pkg list service/network/ftp

If the output of this command is:

pkg list: no packages matching 'service/network/ftp' installed

no further action is required. Otherwise, edit the FTP configuration file.

# pfedit /etc/proftpd.conf

Locate the line containing:

Umask

Change the line to read:

Umask 077"
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216107r959010_rule,STIG-ID|SOL-11.1-040260,STIG-Legacy|SV-60943,STIG-Legacy|V-48071,SWIFT-CSCv1|2.3,Vuln-ID|V-216107"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>
      </then>

      <else>
        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "SOL-11.1-040260 - The default umask for FTP users must be 077."
          info        : "Setting a very secure default value for umask ensures that users make a conscious choice about their file permissions."
          solution    : "The root role is required.

# pkg list service/network/ftp

If the output of this command is:

pkg list: no packages matching 'service/network/ftp' installed

no further action is required. Otherwise, edit the FTP configuration file.

# pfedit /etc/proftpd.conf

Locate the line containing:

Umask

Change the line to read:

Umask 077"
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216107r959010_rule,STIG-ID|SOL-11.1-040260,STIG-Legacy|SV-60943,STIG-Legacy|V-48071,SWIFT-CSCv1|2.3,Vuln-ID|V-216107"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          cmd         : "/usr/bin/egrep -i '^UMASK' /etc/proftpd.conf | /usr/bin/awk '{ print $2 }'"
          expect      : "077"
        </custom_item>
      </else>
    </if>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          system      : "SunOS"
          type        : FILE_CONTENT_CHECK
          description : "'/etc/.login'"
          file        : "/etc/.login"
          regex       : "^[\\s]*mesg[\\s]"
          expect      : "^[\\s]*mesg[\\s]+(-)?n[\\s]*$"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : FILE_CONTENT_CHECK
          description : "'/etc/profile'"
          file        : "/etc/profile"
          regex       : "^[\\s]*mesg[\\s]"
          expect      : "^[\\s]*mesg[\\s]+(-)?n[\\s]*$"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "SOL-11.1-040270 - The value mesg n must be configured as the default setting for all users."
          info        : "The 'mesg n' command blocks attempts to use the 'write' or 'talk' commands to contact users at their terminals, but has the side effect of slightly strengthening permissions on the user's TTY device."
          solution    : "The root role is required.

Edit the default profile configuration files.

# pfedit /etc/profile
# pfedit /etc/.login

In each file add a new line:

mesg n

For each user on the system, enter the command:

# mesg n"
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216108r959010_rule,STIG-ID|SOL-11.1-040270,STIG-Legacy|SV-60947,STIG-Legacy|V-48075,SWIFT-CSCv1|2.3,Vuln-ID|V-216108"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "'inactivity'"
          cmd         : "/usr/sbin/useradd -D | /usr/bin/xargs -n 1 | /usr/bin/grep inactive | /usr/bin/awk -F= '{ print $2 }'"
          expect      : "35"
        </custom_item>

        <custom_item>
          system        : "SunOS"
          type          : CMD_EXEC
          description   : "'user inactivity'"
          cmd           : "/usr/bin/logins -axo | /usr/bin/awk -F: '$13 != 35 { print $1 \":\" $13; f++ } END { if (!f) print \"none\" }'"
          expect        : "none"
          dont_echo_cmd : YES
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "SOL-11.1-040280 - User accounts must be locked after 35 days of inactivity."
          info        : "Attackers that are able to exploit an inactive account can potentially obtain and maintain undetected access to an application. Owners of inactive accounts will not notice if unauthorized access to their user account has been obtained. Operating systems need to track periods of user inactivity and disable accounts after 35 days of inactivity. Such a process greatly reduces the risk that accounts will be hijacked, leading to a data compromise.

This policy does not apply to either emergency accounts or infrequently used accounts. Infrequently used accounts are local logon accounts used by system administrators when network or normal logon/access is not available. Emergency accounts are administrator accounts created in response to crisis situations.

Satisfies: SRG-OS-000003, SRG-OS-000118"
          solution    : "The root role is required.

Perform the following to implement the recommended state:

# useradd -D -f 35

To set this policy on a user account, use the command(s):

# usermod -f 35 [username]

To set this policy on a role account, use the command(s):

# rolemod -f 35 [name]"
          reference   : "800-171|3.1.1,800-53|AC-2(3),800-53r5|AC-2(3)(a),800-53r5|AC-2(3)(b),800-53r5|AC-2(3)(d),CAT|II,CCI|CCI-000017,CCI|CCI-003627,CCI|CCI-003628,CN-L3|7.1.3.2(e),CN-L3|8.1.4.2(c),CSF|PR.AC-1,CSF|PR.AC-4,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|PR.AA-01,CSF2.0|PR.AA-05,CSF2.0|PR.DS-10,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.2.6,ITSG-33|AC-2(3),NIAv2|AM26,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,Rule-ID|SV-216109r986449_rule,STIG-ID|SOL-11.1-040280,STIG-Legacy|SV-60951,STIG-Legacy|V-48079,TBA-FIISB|36.2.2,Vuln-ID|V-216109"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "'terma'"
          cmd         : "/usr/bin/svcs -Ho state svc:/system/console-login:terma | /usr/bin/awk \'{ print } END { if (NR == 0) print \"not found\" }\'"
          expect      : "disabled"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "'termb'"
          cmd         : "/usr/bin/svcs -Ho state svc:/system/console-login:termb | /usr/bin/awk \'{ print } END { if (NR == 0) print \"not found\" }\'"
          expect      : "disabled"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "SOL-11.1-040310 - Login services for serial ports must be disabled."
          info        : "Login services should not be enabled on any serial ports that are not strictly required to support the mission of the system. This action can be safely performed even when console access is provided using a serial port."
          solution    : "The Service Operator profile is required.

Disable serial terminal services.

# pfexec svcadm disable svc:/system/console-login:terma
# pfexec svcadm disable svc:/system/console-login:termb"
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216112r959010_rule,STIG-ID|SOL-11.1-040310,STIG-Legacy|SV-60959,STIG-Legacy|V-48087,SWIFT-CSCv1|2.3,Vuln-ID|V-216112"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : CMD_EXEC
          description : "rpc-authdes is not installed"
          cmd         : "/usr/bin/pkg list solaris/legacy/security/rpc-authdes 2>&1"
          expect      : "no packages matching"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "SOL-11.1-040320 - The nobody access for RPC encryption key storage service must be disabled."
          info        : "If login by the user 'nobody' is allowed for secure RPC, there is an increased risk of system compromise. If keyserv holds a private key for the 'nobody' user, it will be used by key_encryptsession to compute a magic phrase which can be easily recovered by a malicious user."
          solution    : "Determine if the rpc-authdes package is installed:

# pkg list solaris/legacy/security/rpc-authdes

If the output of this command is:

pkg list: no packages matching 'solaris/legacy/security/rpc-authdes' installed

no further action is required.

The root role is required.

Modify the /etc/default/keyserv file.

# pfedit /etc/default/keyserv

Locate the line:

#ENABLE_NOBODY_KEYS=YES

Change it to:

ENABLE_NOBODY_KEYS=NO"
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216113r959010_rule,STIG-ID|SOL-11.1-040320,STIG-Legacy|SV-60961,STIG-Legacy|V-48089,SWIFT-CSCv1|2.3,Vuln-ID|V-216113"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>
      </then>

      <else>
        <custom_item>
          system      : "SunOS"
          type        : FILE_CONTENT_CHECK
          description : "SOL-11.1-040320 - The nobody access for RPC encryption key storage service must be disabled."
          info        : "If login by the user 'nobody' is allowed for secure RPC, there is an increased risk of system compromise. If keyserv holds a private key for the 'nobody' user, it will be used by key_encryptsession to compute a magic phrase which can be easily recovered by a malicious user."
          solution    : "Determine if the rpc-authdes package is installed:

# pkg list solaris/legacy/security/rpc-authdes

If the output of this command is:

pkg list: no packages matching 'solaris/legacy/security/rpc-authdes' installed

no further action is required.

The root role is required.

Modify the /etc/default/keyserv file.

# pfedit /etc/default/keyserv

Locate the line:

#ENABLE_NOBODY_KEYS=YES

Change it to:

ENABLE_NOBODY_KEYS=NO"
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216113r959010_rule,STIG-ID|SOL-11.1-040320,STIG-Legacy|SV-60961,STIG-Legacy|V-48089,SWIFT-CSCv1|2.3,Vuln-ID|V-216113"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          file        : "/etc/default/keyserv"
          regex       : "^[\\s]*ENABLE_NOBODY_KEYS[\\s]*="
          expect      : "^[\\s]*ENABLE_NOBODY_KEYS[\\s]*=[\\s]*[Nn][Oo]"
        </custom_item>
      </else>
    </if>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "SOL-11.1-040330 - X11 forwarding for SSH must be disabled."
      info        : "As enabling X11 Forwarding on the host can permit a malicious user to secretly open another X11 connection to another remote client during the session and perform unobtrusive activities such as keystroke monitoring, if the X11 services are not required for the system's intended function, they should be disabled or restricted as appropriate to the user's needs."
      solution    : "The root role is required.

Modify the sshd_config file.

# pfedit /etc/ssh/sshd_config

Locate the line containing:

X11Forwarding

Change it to:

X11Forwarding no

Restart the SSH service.

# svcadm restart svc:/network/ssh"
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216114r959010_rule,STIG-ID|SOL-11.1-040330,STIG-Legacy|SV-60965,STIG-Legacy|V-48093,SWIFT-CSCv1|2.3,Vuln-ID|V-216114"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      file        : "/etc/ssh/sshd_config"
      regex       : "^[\\s]*X11Forwarding"
      expect      : "^[\\s]*X11Forwarding[\\s]*[Nn][Oo][\\s]*$"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "SOL-11.1-040331 - The sshd server must bind the X11 forwarding server to the loopback address."
      info        : "As enabling X11 Forwarding on the host can permit a malicious user to secretly open another X11 connection to another remote client during the session and perform unobtrusive activities such as keystroke monitoring, if the X11 services are not required for the system's intended function, they should be disabled or restricted as appropriate to the user's needs.
By default, sshd binds the forwarding server to the loopback address and sets the hostname part of the DISPLAY environment variable to 'localhost'.  This prevents remote hosts from connecting to the proxy display."
      solution    : "The root role is required.

Modify the sshd_config file.

# vi /etc/ssh/sshd_config

Locate the line containing:

X11UseLocalhost

Change it to:

X11UseLocalhost yes

Restart the SSH service.

# svcadm restart svc:/network/ssh"
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-233301r959010_rule,STIG-ID|SOL-11.1-040331,SWIFT-CSCv1|2.3,Vuln-ID|V-233301"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      file        : "/etc/ssh/sshd_config"
      regex       : "^[\\s]*X11UseLocalhost"
      expect      : "^[\\s]*X11UseLocalhost[\\s]*[Yy][Ee][Ss][\\s]*$"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "SOL-11.1-040340 - Consecutive login attempts for SSH must be limited to 3."
      info        : "Setting the authentication login limit to a low value will disconnect the attacker and force a reconnect, which severely limits the speed of such brute-force attacks."
      solution    : "The root role is required.

Modify the sshd_config file.

# pfedit /etc/ssh/sshd_config

Locate the line containing:

MaxAuthTries

Change it to:

MaxAuthTries 6

Restart the SSH service.

# svcadm restart svc:/network/ssh

Note: Solaris SSH MaxAuthTries of 6 maps to 3 actual failed attempts."
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216115r959010_rule,STIG-ID|SOL-11.1-040340,STIG-Legacy|SV-60971,STIG-Legacy|V-48099,SWIFT-CSCv1|2.3,Vuln-ID|V-216115"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      file        : "/etc/ssh/sshd_config"
      regex       : "^[\\s]*MaxAuthTries[\\s]+"
      expect      : "^[\\s]*MaxAuthTries[\\s]+6[\\s]*$"
    </custom_item>

    <custom_item>
      system          : "SunOS"
      type            : FILE_CONTENT_CHECK
      description     : "SOL-11.1-040350 - The rhost-based authentication for SSH must be disabled."
      info            : "Setting this parameter forces users to enter a password when authenticating with SSH."
      solution        : "The root role is required.

Modify the sshd_config file

# pfedit /etc/ssh/sshd_config

Locate the line containing:

IgnoreRhosts

Change it to:

IgnoreRhosts yes

Restart the SSH service.

# svcadm restart svc:/network/ssh


This action will only set the IgnoreRhosts line if it already exists in the file to ensure that it is set to the proper value. If the IgnoreRhosts line does not exist in the file, the default setting of 'Yes' is automatically used, so no additional changes are needed."
      reference       : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216116r959010_rule,STIG-ID|SOL-11.1-040350,STIG-Legacy|SV-60973,STIG-Legacy|V-48101,SWIFT-CSCv1|2.3,Vuln-ID|V-216116"
      see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      file            : "/etc/ssh/sshd_config"
      regex           : "^[\\s]*IgnoreRhosts[\\s]+"
      expect          : "^[\\s]*IgnoreRhosts[\\s]+[Yy][Ee][Ss][\\s]*$"
      string_required : NO
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "SOL-11.1-040360 - Direct root account login must not be permitted for SSH access."
      info        : "The system should not allow users to log in as the root user directly, as audited actions would be non-attributable to a specific user."
      solution    : "The root role is required.

Modify the sshd_config file

# pfedit /etc/ssh/sshd_config

Locate the line containing:

PermitRootLogin

Change it to:

PermitRootLogin no

Restart the SSH service.

# svcadm restart svc:/network/ssh"
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216117r959010_rule,STIG-ID|SOL-11.1-040360,STIG-Legacy|SV-60975,STIG-Legacy|V-48103,SWIFT-CSCv1|2.3,Vuln-ID|V-216117"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      file        : "/etc/ssh/sshd_config"
      regex       : "^[\\s]*PermitRootLogin[\\s]+"
      expect      : "^[\\s]*PermitRootLogin[\\s]+[Nn][Oo][\\s]*$"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "SOL-11.1-040370 - Login must not be permitted with empty/null passwords for SSH."
      info        : "Permitting login without a password is inherently risky."
      solution    : "The root role is required.

Modify the sshd_config file

# pfedit /etc/ssh/sshd_config

Locate the line containing:

PermitEmptyPasswords

Change it to:

PermitEmptyPasswords no

Restart the SSH service.

# svcadm restart svc:/network/ssh"
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|I,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216118r959010_rule,STIG-ID|SOL-11.1-040370,STIG-Legacy|SV-60979,STIG-Legacy|V-48107,SWIFT-CSCv1|2.3,Vuln-ID|V-216118"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      file        : "/etc/ssh/sshd_config"
      regex       : "^[\\s]*PermitEmptyPasswords[\\s]+"
      expect      : "^[\\s]*PermitEmptyPasswords[\\s]+[Nn][Oo][\\s]*$"
    </custom_item>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          system      : "SunOS"
          type        : FILE_CONTENT_CHECK
          description : "'ClientAliveInterval'"
          file        : "/etc/ssh/sshd_config"
          regex       : "^[\\s]*ClientAliveInterval[\\s]+"
          expect      : "^[\\s]*ClientAliveInterval[\\s]+600[\\s]*$"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : FILE_CONTENT_CHECK
          description : "'ClientAliveCountMax'"
          file        : "/etc/ssh/sshd_config"
          regex       : "^[\\s]*ClientAliveCountMax[\\s]+"
          expect      : "^[\\s]*ClientAliveCountMax[\\s]+0[\\s]*$"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "SOL-11.1-040380 - The operating system must terminate the network connection associated with a communications session at the end of the session or after 10 minutes of inactivity."
          info        : "This requirement applies to both internal and external networks.

Terminating network connections associated with communications sessions means de-allocating associated TCP/IP address/port pairs at the operating system level.

The time period of inactivity may, as the organization deems necessary, be a set of time periods by type of network access or for specific accesses."
          solution    : "The root role is required.

Configure the system to disconnect SSH sessions after 10 minutes of inactivity.

Modify the sshd_config file:

# pfedit /etc/ssh/sshd_config

Modify or add the lines containing:

ClientAliveInterval
ClientAliveCountMax

Change them to:

ClientAliveInterval 600
ClientAliveCountMax 0

Restart the SSH service:

# svcadm restart svc:/network/ssh"
          reference   : "800-171|3.13.9,800-53|SC-10,800-53r5|SC-10,CAT|III,CCI|CCI-001133,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-10,ITSG-33|SC-10a.,NESA|T2.3.8,NESA|T4.5.1,NESA|T5.5.1,Rule-ID|SV-216119r970703_rule,STIG-ID|SOL-11.1-040380,STIG-Legacy|SV-60983,STIG-Legacy|V-48111,SWIFT-CSCv1|2.6,Vuln-ID|V-216119"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          system      : "SunOS"
          type        : FILE_CONTENT_CHECK_NOT
          description : "'/etc/pam.conf"
          file        : "/etc/pam.conf"
          regex       : "pam_rhosts_auth\\.so\\.1"
          expect      : "^[\\s]*[^#]"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : FILE_CONTENT_CHECK_NOT
          description : "'/etc/pam.d/*"
          file        : "/etc/pam.d/*"
          regex       : "pam_rhosts_auth\\.so\\.1"
          expect      : "^[\\s]*[^#]"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "SOL-11.1-040390 - Host-based authentication for login-based services must be disabled."
          info        : "The use of .rhosts authentication is an insecure protocol and can be replaced with public-key authentication using Secure Shell. As automatic authentication settings in the .rhosts files can provide a malicious user with sensitive system credentials, the use of .rhosts files should be disabled."
          solution    : "Note: This is the location for Solaris 11.1. For earlier versions, the information is in /etc/pam.conf.

The root role is required.

# ls -l /etc/pam.d
to identify the various configuration files used by PAM.

Search each file for the pam_rhosts_auth.so.1 entry.

# grep pam_rhosts_auth.so.1 [filename]

Identify the file with the line pam_hosts_auth.so.1 in it.

# pfedit [filename]

Insert a comment character (#) at the beginning of the line containing 'pam_hosts_auth.so.1'."
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216120r959010_rule,STIG-ID|SOL-11.1-040390,STIG-Legacy|SV-60985,STIG-Legacy|V-48113,SWIFT-CSCv1|2.3,Vuln-ID|V-216120"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : CMD_EXEC
          description : "FTP service is not installed"
          cmd         : "/usr/bin/pkg list service/network/ftp 2>&1"
          expect      : "no packages matching"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "SOL-11.1-040400 - The use of FTP must be restricted."
          info        : "FTP is an insecure protocol that transfers files and credentials in clear text, and can be replaced by using SFTP. However, if FTP is permitted for use in the environment, it is important to ensure that the default 'system' accounts are not permitted to transfer files via FTP, especially the root role. Consider also adding the names of other privileged or shared accounts that may exist on the system such as user 'oracle' and the account which the web server process runs under."
          solution    : "The root role is required.

Determine if the FTP server package is installed:

# pkg list service/network/ftp

If the output of this command is:

pkg list: no packages matching 'service/network/ftp' installed

no further action is required.

# for user in 'logins -s | awk '{ print $1 }'' \
aiuser noaccess nobody nobody4; do
$(echo $user >> /etc/ftpd/ftpusers)
done
# sort -u /etc/ftpd/ftpusers > /etc/ftpd/ftpusers.temp
# mv /etc/ftpd/ftpusers.temp /etc/ftpd/ftpusers"
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216121r959010_rule,STIG-ID|SOL-11.1-040400,STIG-Legacy|SV-60989,STIG-Legacy|V-48117,SWIFT-CSCv1|2.3,Vuln-ID|V-216121"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>
      </then>

      <else>
        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "SOL-11.1-040400 - The use of FTP must be restricted."
          info        : "FTP is an insecure protocol that transfers files and credentials in clear text, and can be replaced by using SFTP. However, if FTP is permitted for use in the environment, it is important to ensure that the default 'system' accounts are not permitted to transfer files via FTP, especially the root role. Consider also adding the names of other privileged or shared accounts that may exist on the system such as user 'oracle' and the account which the web server process runs under."
          solution    : "The root role is required.

Determine if the FTP server package is installed:

# pkg list service/network/ftp

If the output of this command is:

pkg list: no packages matching 'service/network/ftp' installed

no further action is required.

# for user in 'logins -s | awk '{ print $1 }'' \
aiuser noaccess nobody nobody4; do
$(echo $user >> /etc/ftpd/ftpusers)
done
# sort -u /etc/ftpd/ftpusers > /etc/ftpd/ftpusers.temp
# mv /etc/ftpd/ftpusers.temp /etc/ftpd/ftpusers"
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216121r959010_rule,STIG-ID|SOL-11.1-040400,STIG-Legacy|SV-60989,STIG-Legacy|V-48117,SWIFT-CSCv1|2.3,Vuln-ID|V-216121"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          cmd         : "for user in `logins -s | awk '{ print $1 }'` aiuser noaccess nobody nobody4; do grep -w \"${user}\" /etc/ftpd/ftpusers >/dev/null 2>&1; if [ $? != 0 ]; then echo \"User '${user}' not in /etc/ftpd/ftpusers.\"; fi; done | /usr/bin/awk '{ print } END { if (NR == 0) print \"none\" }'"
          expect      : "none"
        </custom_item>
      </else>
    </if>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK_NOT
      description : "SOL-11.1-040410 - The system must not allow autologin capabilities from the GNOME desktop."
      info        : "As automatic logins are a known security risk for other than 'kiosk' types of systems, GNOME automatic login should be disabled in pam.conf."
      solution    : "The root role is required.

Modify the /etc/pam.d/gdm-autologin file.

# pfedit /etc/pam.d/gdm-autologin

Locate the lines:

auth required pam_unix_cred.so.1
auth sufficient pam_allow.so.1
account sufficient pam_allow.so.1

Change the lines to read:

#auth required pam_unix_cred.so.1
#auth sufficient pam_allow.so.1
#account sufficient pam_allow.so.1"
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|I,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216122r959010_rule,STIG-ID|SOL-11.1-040410,STIG-Legacy|SV-60993,STIG-Legacy|V-48121,SWIFT-CSCv1|2.3,Vuln-ID|V-216122"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      file        : "/etc/pam.d/gdm-autologin"
      regex       : "auth|account"
      expect      : "^[\\s]*[^#]"
    </custom_item>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : CMD_EXEC
          description : "Check for user to have RBAC permission of solaris.jobs.user"
          cmd         : "/usr/bin/auths"
          expect      : "solaris\.jobs\.user:"
        </custom_item>
      </condition>

      <then>
        <if>
          <condition auto:"FAILED" type:"AND">
            <custom_item>
              system      : "SunOS"
              type        : FILE_CHECK_NOT
              description : "'/etc/cron.d/cron.deny'"
              file        : "/etc/cron.d/cron.deny"
            </custom_item>

            <custom_item>
              system      : "SunOS"
              type        : FILE_CHECK_NOT
              description : "'/etc/cron.d/at.deny'"
              file        : "/etc/cron.d/at.deny"
            </custom_item>

            <custom_item>
              system      : "SunOS"
              type        : FILE_CHECK_NOT
              description : "'/etc/cron.d/cron.allow file'"
              file        : "/etc/cron.d/cron.allow"
            </custom_item>

            <custom_item>
              system      : "SunOS"
              type        : FILE_CHECK_NOT
              description : "'/etc/cron.d/at.allow file'"
              file        : "/etc/cron.d/at.allow"
            </custom_item>
          </condition>

          <then>
            <report type:"PASSED">
              description : "SOL-11.1-040420 - Unauthorized use of the at or cron capabilities must not be permitted."
              info        : "On many systems, only the system administrator needs the ability to schedule jobs.

Even though a given user is not listed in the 'cron.allow' file, cron jobs can still be run as that user. The 'cron.allow' file only controls administrative access to the 'crontab' command for scheduling and modifying cron jobs. Much more effective access controls for the cron system can be obtained by using Role-Based Access Controls (RBAC)."
              solution    : "The root role is required.

Modify the cron configuration files.

# mv /etc/cron.d/cron.deny /etc/cron.d/cron.deny.temp
# mv /etc/cron.d/at.deny /etc/cron.d/at.deny.temp

Skip the remaining steps only if using the 'solaris.jobs.user' RBAC role.

# echo root > /etc/cron.d/cron.allow
# cp /dev/null /etc/cron.d/at.allow
# chown root:root /etc/cron.d/cron.allow /etc/cron.d/at.allow
# chmod 400 /etc/cron.d/cron.allow /etc/cron.d/at.allow"
              reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216123r959010_rule,STIG-ID|SOL-11.1-040420,STIG-Legacy|SV-60997,STIG-Legacy|V-48125,SWIFT-CSCv1|2.3,Vuln-ID|V-216123"
              see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
              show_output : YES
            </report>
          </then>
        </if>
      </then>

      <else>
        <if>
          <condition auto:"FAILED" type:"AND">
            <custom_item>
              system      : "SunOS"
              type        : FILE_CHECK_NOT
              description : "'/etc/cron.d/cron.deny'"
              file        : "/etc/cron.d/cron.deny"
            </custom_item>

            <custom_item>
              system      : "SunOS"
              type        : FILE_CHECK_NOT
              description : "'/etc/cron.d/at.deny'"
              file        : "/etc/cron.d/at.deny"
            </custom_item>

            <custom_item>
              system      : "SunOS"
              type        : FILE_CONTENT_CHECK
              description : "/etc/cron.d/cron.allow content"
              file        : "/etc/cron.d/cron.allow"
              regex       : "root"
              expect      : "root"
            </custom_item>

            <custom_item>
              system      : "Linux"
              type        : CMD_EXEC
              description : "/etc/cron.d/cron.allow count"
              cmd         : "/usr/bin/wc -l /etc/cron.d/cron.allow"
              expect      : "^1$"
            </custom_item>

            <custom_item>
              system      : "Linux"
              type        : CMD_EXEC
              description : "/etc/cron.d/at.allow count"
              cmd         : "/usr/bin/wc -l /etc/cron.d/cron.allow"
              expect      : "^0$"
            </custom_item>
          </condition>

          <then>
            <report type:"PASSED">
              description : "SOL-11.1-040420 - Unauthorized use of the at or cron capabilities must not be permitted."
              info        : "On many systems, only the system administrator needs the ability to schedule jobs.

Even though a given user is not listed in the 'cron.allow' file, cron jobs can still be run as that user. The 'cron.allow' file only controls administrative access to the 'crontab' command for scheduling and modifying cron jobs. Much more effective access controls for the cron system can be obtained by using Role-Based Access Controls (RBAC)."
              solution    : "The root role is required.

Modify the cron configuration files.

# mv /etc/cron.d/cron.deny /etc/cron.d/cron.deny.temp
# mv /etc/cron.d/at.deny /etc/cron.d/at.deny.temp

Skip the remaining steps only if using the 'solaris.jobs.user' RBAC role.

# echo root > /etc/cron.d/cron.allow
# cp /dev/null /etc/cron.d/at.allow
# chown root:root /etc/cron.d/cron.allow /etc/cron.d/at.allow
# chmod 400 /etc/cron.d/cron.allow /etc/cron.d/at.allow"
              reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216123r959010_rule,STIG-ID|SOL-11.1-040420,STIG-Legacy|SV-60997,STIG-Legacy|V-48125,SWIFT-CSCv1|2.3,Vuln-ID|V-216123"
              see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
              show_output : YES
            </report>
          </then>
        </if>
      </else>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : CMD_EXEC
          description : "Global zone auditing is configured."
          cmd         : "/usr/bin/zonename"
          expect      : "^global$"
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system      : "SunOS"
          type        : FILE_CONTENT_CHECK
          description : "SOL-11.1-040430 - Logins to the root account must be restricted to the system console only."
          info        : "Use an authorized mechanism such as RBAC and the 'su' command to provide administrative access to unprivileged accounts. These mechanisms provide an audit trail in the event of problems."
          solution    : "The root role is required.

Modify the /etc/default/login file

# pfedit /etc/default/login

Locate the line containing:

CONSOLE

Change it to read:

CONSOLE=/dev/console"
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216124r959010_rule,STIG-ID|SOL-11.1-040430,STIG-Legacy|SV-60999,STIG-Legacy|V-48127,SWIFT-CSCv1|2.3,Vuln-ID|V-216124"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          file        : "/etc/default/login"
          regex       : "^ *[^#]*CONSOLE\\s*=.*"
          expect      : "CONSOLE\\s*=\\s*/dev/console"
        </custom_item>
      </then>

      <else>
        <report type:"PASSED">
          description : "SOL-11.1-040430 - Logins to the root account must be restricted to the system console only."
          info        : "Use an authorized mechanism such as RBAC and the 'su' command to provide administrative access to unprivileged accounts. These mechanisms provide an audit trail in the event of problems."
          solution    : "The root role is required.

Modify the /etc/default/login file

# pfedit /etc/default/login

Locate the line containing:

CONSOLE

Change it to read:

CONSOLE=/dev/console"
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216124r959010_rule,STIG-ID|SOL-11.1-040430,STIG-Legacy|SV-60999,STIG-Legacy|V-48127,SWIFT-CSCv1|2.3,Vuln-ID|V-216124"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>
      </else>
    </if>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK_NOT
      description : "SOL-11.1-040450 - The operating system, upon successful logon, must display to the user the date and time of the last logon (access)."
      info        : "Users need to be aware of activity that occurs regarding their account. Providing users with information regarding the date and time of their last successful login allows the user to determine if any unauthorized activity has occurred and gives them an opportunity to notify administrators."
      solution    : "The root role is required for this action.

# pfedit /etc/ssh/sshd_config

Locate the line containing:

PrintLastLog no

and place a comment sign ('# ')at the beginning of the line or delete the line

# PrintLastLog no

Restart the ssh service

# pfexec svcadm restart svc:/network/ssh"
      reference   : "800-53|AC-9,800-53r5|AC-9,CAT|III,CCI|CCI-000052,CSF2.0|DE.CM-09,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-9,NESA|T5.5.1,Rule-ID|SV-216125r987814_rule,STIG-ID|SOL-11.1-040450,STIG-Legacy|SV-61003,STIG-Legacy|V-48131,TBA-FIISB|45.2.4,Vuln-ID|V-216125"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      file        : "/etc/ssh/sshd_config"
      regex       : "^[\\s]*PrintLastLog[\\s]+"
      expect      : "^[\\s]*PrintLastLog[\\s]+[Nn][Oo][\\s]*$"
    </custom_item>

    <report type:"WARNING">
      description : "SOL-11.1-040460 - The operating system must provide the capability for users to directly initiate session lock mechanisms."
      info        : "A session lock is a temporary action taken when a user stops work and moves away from the immediate physical vicinity of the system but does not want to log out because of the temporary nature of the absence.

Rather than be forced to wait for a period of time to expire before the user session can be locked, the operating system needs to provide users with the ability to manually invoke a session lock so users may secure their account should the need arise for them to temporarily vacate the immediate physical vicinity.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "User-initiated session lock is accessible from the GNOME graphical desktop menu GNOME 2: System >> Lock Screen.

GNOME 3: Status Menu (top right corner) >> Lock Icon.

However, the user has the option to disable screensaver lock.

For Solaris 11, 11.1, 11.2, and 11.3:
In the GNOME 2 desktop: System >> Preferences >> Screensaver.

For Solaris 11.4 or newer:
If using the default GNOME desktop: Activities >> Show Applications >> select 'Screensaver' icon.

If using the GNOME Classic desktop: Applications >> Other >> Screensaver.

Ensure that 'Mode' is set to 'Blank Screen only'."
      reference   : "800-171|3.1.10,800-53|AC-11a.,800-53r5|AC-11a.,CAT|II,CCI|CCI-000057,CN-L3|8.1.4.1(b),DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11a.,NESA|T2.3.8,NESA|T2.3.9,NIAv2|AM23a,NIAv2|AM23b,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,Rule-ID|SV-216126r986451_rule,STIG-ID|SOL-11.1-040460,STIG-Legacy|SV-61007,STIG-Legacy|V-48135,Vuln-ID|V-216126"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
    </report>

    <report type:"WARNING">
      description : "SOL-11.1-040470 - The operating system session lock mechanism, when activated on a device with a display screen, must place a publicly viewable pattern onto the associated display, hiding what was previously visible on the screen."
      info        : "A session time-out lock is a temporary action taken when a user stops work and moves away from the immediate physical vicinity of the system but does not log out because of the temporary nature of the absence.

The session lock will also include an obfuscation of the display screen to prevent other users from reading what was previously displayed.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "For Solaris 11, 11.1, 11.2, and 11.3:
In the GNOME 2 desktop: System >> Preferences >> Screensaver.

For Solaris 11.4 or newer:
If using the default GNOME desktop: Activities >> Show Applications >> select 'Screensaver' icon.

If using the GNOME Classic desktop: Applications >> Other >> Screensaver.

Click on Mode's pull-down.

Select: 'Blank Screen Only'.

Ensure that 'Blank Screen Only' is selected."
      reference   : "800-171|3.1.10,800-53|AC-11(1),800-53r5|AC-11(1),CAT|II,CCI|CCI-000060,CN-L3|8.1.4.1(b),DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11(1),NIAv2|AM23c,NIAv2|AM23d,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,Rule-ID|SV-216127r958404_rule,STIG-ID|SOL-11.1-040470,STIG-Legacy|SV-61011,STIG-Legacy|V-48139,Vuln-ID|V-216127"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
    </report>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "SOL-11.1-040480 - The operating system must not allow logins for users with blank passwords."
      info        : "If the password field is blank and the system does not enforce a policy that passwords are required, it could allow login without proper authentication of a user."
      solution    : "The root role is required.

Modify the /etc/default/login file.

# pfedit /etc/default/login

Insert the line:

PASSREQ=YES"
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|I,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216128r959010_rule,STIG-ID|SOL-11.1-040480,STIG-Legacy|SV-61015,STIG-Legacy|V-48143,SWIFT-CSCv1|2.3,Vuln-ID|V-216128"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      file        : "/etc/default/login"
      regex       : "^[\\s]*PASSREQ[\\s]*="
      expect      : "^[\\s]*PASSREQ[\\s]*=[\\s]*[Yy][Ee][Ss][\\s]*$"
    </custom_item>

    <if>
      <condition auto:"WARNING" type:"AND">
        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "'RestrictOutbound name'"
          cmd         : "/usr/bin/profiles -p RestrictOutbound info name 2> /dev/null"
          expect      : "name=RestrictOutbound$"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "'RestrictOutbound connections'"
          cmd         : "/usr/bin/profiles -p RestrictOutbound info desc 2> /dev/null"
          expect      : "desc=Restrict Outbound Connections$"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "profile"
          cmd         : "/usr/bin/profiles -p RestrictOutbound info limitpriv 2> /dev/null"
          expect      : "limitpriv=zone,!net_access$"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "user accounts"
          cmd         : "for user in `cat /etc/passwd | /usr/bin/cut -f1 -d:`; do output=`/usr/bin/profiles -l $user | /usr/bin/grep RestrictOutbound`; /usr/bin/echo \"$user: $output\"; done"
          expect      : "Manual Review Required"
          severity    : MEDIUM
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "SOL-11.1-040490 - The operating system must prevent remote devices that have established a non-remote connection with the system from communicating outside of the communication path with resources in external networks."
          info        : "This control enhancement is implemented within the remote device (e.g., notebook/laptop computer) via configuration settings not configurable by the user of the device. An example of a non-remote communications path from a remote device is a virtual private network. When a non-remote connection is established using a virtual private network, the configuration settings prevent split-tunneling. Split-tunneling might otherwise be used by remote users to communicate with the information system as an extension of the system and to communicate with local resources, such as a printer or file server. The remote device, when connected by a non-remote connection, becomes an extension of the information system allowing dual communications paths, such as split-tunneling, in effect allowing unauthorized external connections into the system. This is a split-tunneling requirement that can be controlled via the operating system by disabling interfaces.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
          solution    : "The root Role is required.

Remove net_access privilege from users who may be accessing the systems externally.

1. Create an RBAC Profile with net_access restriction

# profiles -p RestrictOutbound
profiles:RestrictOutbound> set desc='Restrict Outbound Connections'
profiles:RestrictOutbound> set limitpriv=zone,!net_access
profiles:RestrictOutbound> exit


2. Assign the RBAC Profile to a user

# usermod -P +RestrictOutbound [username]

This prevents the user from initiating any outbound network connections."
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216129r959010_rule,STIG-ID|SOL-11.1-040490,STIG-Legacy|SV-61019,STIG-Legacy|V-48147,SWIFT-CSCv1|2.3,Vuln-ID|V-216129"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <report type:"WARNING">
      description : "SOL-11.1-040500 - The operating system must limit the number of concurrent sessions for each account to an organization-defined number of sessions."
      info        : "Limiting the number of allowed users and sessions per user can limit risks related to denial of service attacks. The organization may define the maximum number of concurrent sessions for an information system account globally, by account type, by account, or by a combination thereof.

This requirement addresses concurrent sessions for a single information system account and does not address concurrent sessions by a single user via multiple accounts.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Identify the organizational requirements for maximum number of sessions and which users must be restricted. If there are no requirements to limit concurrent sessions, this item does not apply.

The Project Management profile is required.

For each user requiring concurrent session restrictions, add the user to the special user.[username] project where [username] is the user's account username where [MAX] is equal to the organizational requirement.

# pfexec projadd -K 'project.max-tasks=(privileged,[MAX],deny)' user.[username]

Determine the project membership for the user.

# projects [username]

If the user is a member of any projects other than default, group.[groupname], or user.[username], remove that project from the user's account.

The root role is required.

# pfedit /etc/user_attr

Locate the line containing the user's username. Remove any project=[projectname] entries from the fifth field.

# pfedit /etc/project

Locate the line containing the user's username in a project other than default, group.[groupname], or user.[username], and remove the user from the project's entry or entries from the fourth field."
      reference   : "800-53|AC-10,800-53r5|AC-10,CAT|III,CCI|CCI-000054,CSF2.0|PR.AA-05,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-10,NESA|T5.5.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,Rule-ID|SV-216130r958398_rule,STIG-ID|SOL-11.1-040500,STIG-Legacy|SV-61023,STIG-Legacy|V-48151,Vuln-ID|V-216130"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
    </report>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "SOL-11.1-050010 - The system must disable directed broadcast packet forwarding."
      info        : "This parameter must be disabled to reduce the risk of denial of service attacks."
      solution    : "The Network Management profile is required.

Disable directed broadcast packet forwarding.

# pfexec ipadm set-prop -p _forward_directed_broadcasts=0 ip"
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216131r959010_rule,STIG-ID|SOL-11.1-050010,STIG-Legacy|SV-61037,STIG-Legacy|V-48165,SWIFT-CSCv1|2.3,Vuln-ID|V-216131"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      cmd         : "/usr/sbin/ipadm show-prop -p _forward_directed_broadcasts -co current ip"
      expect      : "^0$"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "SOL-11.1-050020 - The system must not respond to ICMP timestamp requests."
      info        : "By accurately determining the system's clock state, an attacker can more effectively attack certain time-based pseudorandom number generators (PRNGs) and the authentication systems that rely on them."
      solution    : "The Network Management profile is required.

Disable source respond to timestamp.

# pfexec ipadm set-prop -p _respond_to_timestamp=0 ip"
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216132r959010_rule,STIG-ID|SOL-11.1-050020,STIG-Legacy|SV-61041,STIG-Legacy|V-48169,SWIFT-CSCv1|2.3,Vuln-ID|V-216132"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      cmd         : "/usr/sbin/ipadm show-prop -p _respond_to_timestamp -co current ip"
      expect      : "^0$"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "SOL-11.1-050030 - The system must not respond to ICMP broadcast timestamp requests."
      info        : "By accurately determining the system's clock state, an attacker can more effectively attack certain time-based pseudorandom number generators (PRNGs) and the authentication systems that rely on them."
      solution    : "The Network Management profile is required.

Disable respond to timestamp broadcasts.

# pfexec ipadm set-prop -p _respond_to_timestamp_broadcast=0 ip"
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216133r959010_rule,STIG-ID|SOL-11.1-050030,STIG-Legacy|SV-61045,STIG-Legacy|V-48173,SWIFT-CSCv1|2.3,Vuln-ID|V-216133"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      cmd         : "/usr/sbin/ipadm show-prop -p _respond_to_timestamp_broadcast -co current ip"
      expect      : "^0$"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "SOL-11.1-050040 - The system must not respond to ICMP broadcast netmask requests."
      info        : "By determining the netmasks of various computers in your network, an attacker can better map your subnet structure and infer trust relationships."
      solution    : "The Network Management profile is required.

Disable responses to address mask broadcast.

# pfexec ipadm set-prop -p _respond_to_address_mask_broadcast=0 ip"
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216134r959010_rule,STIG-ID|SOL-11.1-050040,STIG-Legacy|SV-61049,STIG-Legacy|V-48177,SWIFT-CSCv1|2.3,Vuln-ID|V-216134"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      cmd         : "/usr/sbin/ipadm show-prop -p _respond_to_address_mask_broadcast -co current ip"
      expect      : "^0$"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "SOL-11.1-050050 - The system must not respond to broadcast ICMP echo requests."
      info        : "ICMP echo requests can be useful for reconnaissance of systems and for denial of service attacks."
      solution    : "The Network Management profile is required.

Disable respond to echo broadcast.

# pfexec ipadm set-prop -p _respond_to_echo_broadcast=0 ip"
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216135r959010_rule,STIG-ID|SOL-11.1-050050,STIG-Legacy|SV-61053,STIG-Legacy|V-48181,SWIFT-CSCv1|2.3,Vuln-ID|V-216135"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      cmd         : "/usr/sbin/ipadm show-prop -p _respond_to_echo_broadcast -co current ip"
      expect      : "^0$"
    </custom_item>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "'IPv4'"
          cmd         : "/usr/sbin/ipadm show-prop -p _respond_to_echo_multicast -co current ipv4"
          expect      : "^0$"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "'IPv6'"
          cmd         : "/usr/sbin/ipadm show-prop -p _respond_to_echo_multicast -co current ipv6"
          expect      : "^0$"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "SOL-11.1-050060 - The system must not respond to multicast echo requests."
          info        : "Multicast echo requests can be useful for reconnaissance of systems and for denial of service attacks."
          solution    : "The Network Management profile is required.

Disable respond to echo multi-cast for IPv4 and IPv6.

# pfexec ipadm set-prop -p _respond_to_echo_multicast=0 ipv4
# pfexec ipadm set-prop -p _respond_to_echo_multicast=0 ipv6"
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216136r959010_rule,STIG-ID|SOL-11.1-050060,STIG-Legacy|SV-61057,STIG-Legacy|V-48185,SWIFT-CSCv1|2.3,Vuln-ID|V-216136"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "'IPv4'"
          cmd         : "/usr/sbin/ipadm show-prop -p _ignore_redirect -co current ipv4"
          expect      : "^1$"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "'IPv6'"
          cmd         : "/usr/sbin/ipadm show-prop -p _ignore_redirect -co current ipv6"
          expect      : "^1$"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "SOL-11.1-050070 - The system must ignore ICMP redirect messages."
          info        : "Ignoring ICMP redirect messages reduces the likelihood of denial of service attacks."
          solution    : "The Network Management profile is required.

Disable ignore redirects for IPv4 and IPv6.

# pfexec ipadm set-prop -p _ignore_redirect=1 ipv4
# pfexec ipadm set-prop -p _ignore_redirect=1 ipv6"
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216137r959010_rule,STIG-ID|SOL-11.1-050070,STIG-Legacy|SV-61061,STIG-Legacy|V-48189,SWIFT-CSCv1|2.3,Vuln-ID|V-216137"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "'IPv4'"
          cmd         : "/usr/sbin/ipadm show-prop -p _strict_dst_multihoming -co current ipv4"
          expect      : "^1$"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "'IPv6'"
          cmd         : "/usr/sbin/ipadm show-prop -p _strict_dst_multihoming -co current ipv6"
          expect      : "^1$"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "SOL-11.1-050080 - The system must set strict multihoming."
          info        : "These settings control whether a packet arriving on a non-forwarding interface can be accepted for an IP address that is not explicitly configured on that interface.

This rule is NA for documented systems that have interfaces that cross strict networking domains (for example, a firewall, a router, or a VPN node)."
          solution    : "The Network Management profile is required.

Disable strict multihoming for IPv4 and IPv6.

# pfexec ipadm set-prop -p _strict_dst_multihoming=1 ipv4
# pfexec ipadm set-prop -p _strict_dst_multihoming=1 ipv6"
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216138r959010_rule,STIG-ID|SOL-11.1-050080,STIG-Legacy|SV-61065,STIG-Legacy|V-48193,SWIFT-CSCv1|2.3,Vuln-ID|V-216138"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "'IPv4'"
          cmd         : "/usr/sbin/ipadm show-prop -p _send_redirects -co current ipv4"
          expect      : "^0|off$"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "'IPv6'"
          cmd         : "/usr/sbin/ipadm show-prop -p _send_redirects -co current ipv6"
          expect      : "^0|off$"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "SOL-11.1-050090 - The system must disable ICMP redirect messages."
          info        : "A malicious user can exploit the ability of the system to send ICMP redirects by continually sending packets to the system, forcing the system to respond with ICMP redirect messages, resulting in an adverse impact on the CPU performance of the system."
          solution    : "The Network Management profile is required.

If the version of Solaris is earlier than Solaris 11.2, disable send redirects for IPv4 and IPv6.

# pfexec ipadm set-prop -p _send_redirects=0 ipv4
# pfexec ipadm set-prop -p _send_redirects=0 ipv6

If the version of Solaris is Solaris 11.2 or later, disable send redirects for IPv4 and IPv6.

# pfexec ipadm set-prop -p send_redirects=off ipv4
# pfexec ipadm set-prop -p send_redirects=off ipv6"
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216139r959010_rule,STIG-ID|SOL-11.1-050090,STIG-Legacy|SV-61069,STIG-Legacy|V-48197,SWIFT-CSCv1|2.3,Vuln-ID|V-216139"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "SOL-11.1-050100 - The system must disable TCP reverse IP source routing."
      info        : "If enabled, reverse IP source routing would allow an attacker to more easily complete a three-way TCP handshake and spoof new connections."
      solution    : "The Network Management profile is required.

Disable reverse source routing.

# pfexec ipadm set-prop -p _rev_src_routes=0 tcp"
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216140r959010_rule,STIG-ID|SOL-11.1-050100,STIG-Legacy|SV-61073,STIG-Legacy|V-48201,SWIFT-CSCv1|2.3,Vuln-ID|V-216140"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      cmd         : "/usr/sbin/ipadm show-prop -p _rev_src_routes -co current tcp"
      expect      : "^0$"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "SOL-11.1-050110 - The system must set maximum number of half-open TCP connections to 4096."
      info        : "This setting controls how many half-open connections can exist for a TCP port.

It is necessary to control the number of completed connections to the system to provide some protection against denial of service attacks."
      solution    : "The Network Management profile is required

Configure maximum TCP connections for IPv4 and IPv6.

# pfexec ipadm set-prop -p _conn_req_max_q0=4096 tcp"
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216141r959010_rule,STIG-ID|SOL-11.1-050110,STIG-Legacy|SV-61079,STIG-Legacy|V-48207,SWIFT-CSCv1|2.3,Vuln-ID|V-216141"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      cmd         : "/usr/sbin/ipadm show-prop -p _conn_req_max_q0 -co current tcp"
      expect      : "^4096$"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "SOL-11.1-050120 - The system must set maximum number of incoming connections to 1024."
      info        : "This setting controls the maximum number of incoming connections that can be accepted on a TCP port limiting exposure to denial of service attacks."
      solution    : "The Network Management profile is required.

Configure maximum number of incoming connections.

# pfexec ipadm set-prop -p _conn_req_max_q=1024 tcp"
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216142r959010_rule,STIG-ID|SOL-11.1-050120,STIG-Legacy|SV-61083,STIG-Legacy|V-48211,SWIFT-CSCv1|2.3,Vuln-ID|V-216142"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      cmd         : "/usr/sbin/ipadm show-prop -p _conn_req_max_q -co current tcp"
      expect      : "^1024$"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "SOL-11.1-050130 - The system must disable network routing unless required."
      info        : "The network routing daemon, in.routed, manages network routing tables. If enabled, it periodically supplies copies of the system's routing tables to any directly connected hosts and networks and picks up routes supplied to it from other networks and hosts.
Routing Internet Protocol (RIP) is a legacy protocol with a number of security weaknesses, including a lack of authentication, zoning, pruning, etc."
      solution    : "The Network Management profile is required.

Disable routing for IPv4 and IPv6.

# pfexec routeadm -d ipv4-forwarding -d ipv4-routing
# pfexec routeadm -d ipv6-forwarding -d ipv6-routing

To apply these changes to the running system, use the command:

# pfexec routeadm -u"
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216143r959010_rule,STIG-ID|SOL-11.1-050130,STIG-Legacy|SV-61089,STIG-Legacy|V-48217,SWIFT-CSCv1|2.3,Vuln-ID|V-216143"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      cmd         : "/usr/sbin/routeadm -p | /usr/bin/egrep 'routing |forwarding' | /usr/bin/egrep '(persistent|current)=enabled' | /usr/bin/awk '{ print } END { if (NR == 0) print \"pass\" }'"
      expect      : "pass"
    </custom_item>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "'tcp_wrappers'"
          cmd         : "/usr/sbin/inetadm -p | /usr/bin/grep tcp_wrappers"
          expect      : "^tcp_wrappers=TRUE$"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : FILE_CHECK
          description : "'/etc/hosts.deny'"
          file        : "/etc/hosts.deny"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : FILE_CONTENT_CHECK
          description : "'/etc/hosts.deny ALL: ALL'"
          file        : "/etc/hosts.deny"
          regex       : "^[\\s]*ALL[\\s]*:[\\s]+ALL[\\s]*$"
          expect      : "^[\\s]*ALL[\\s]*:[\\s]+ALL[\\s]*$"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : FILE_CHECK
          description : "'/etc/hosts.allow'"
          file        : "/etc/hosts.allow"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : FILE_CONTENT_CHECK
          description : "'/etc/hosts.allow subnet'"
          file        : "/etc/hosts.allow"
          regex       : "^[\\s]*ALL[\\s]*:[\\s]+@ETC_HOSTS_ALLOW_LIST@[\\s]*$"
          expect      : "^[\\s]*ALL[\\s]*:[\\s]+@ETC_HOSTS_ALLOW_LIST@[\\s]*$"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "TCP Wrappers inetd services"
          cmd         : "for svc in `/usr/sbin/inetadm | awk '/svc:\\// { print $NF }'`; do val=`/usr/sbin/inetadm -l ${svc} | /usr/bin/grep tcp_wrappers`; echo \"Service: \"${svc} \", value: \"${val}; done"
          expect      : "Manual Review Required"
          severity    : MEDIUM
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "SOL-11.1-050140 - The system must implement TCP Wrappers."
          info        : "TCP Wrappers is a host-based access control system that allows administrators to control who has access to various network services based on the IP address of the remote end of the connection. TCP Wrappers also provides logging information via syslog about both successful and unsuccessful connections.

TCP Wrappers provides granular control over what services can be accessed over the network. Its logs show attempted access to services from non-authorized systems, which can help identify unauthorized access attempts.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
          solution    : "The root role is required.

Configure allowed and denied hosts per organizational policy.

1. Create and customize the policy in /etc/hosts.allow:

# echo 'ALL: [net]/[mask] , [net]/[mask], ...' > /etc/hosts.allow

where each [net>/[mask> combination (for example, the Class C address block '192.168.1.0/255.255.255.0') can represent one network block in use by the organization that requires access to this system.

2. Create a default deny policy in /etc/hosts.deny: # echo 'ALL: ALL' >/etc/hosts.deny

3. Enable TCP Wrappers for all services started by inetd:

# inetadm -M tcp_wrappers=TRUE"
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216144r959010_rule,STIG-ID|SOL-11.1-050140,STIG-Legacy|SV-61093,STIG-Legacy|V-48221,SWIFT-CSCv1|2.3,Vuln-ID|V-216144"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : CMD_EXEC
          description : "Check for Solaris 11.0 - 11.3."
          cmd         : "uname -v"
          expect      : "^[\\s]*11\\.[0-3]"
        </custom_item>
      </condition>

      <then>
        <if>
          <condition auto:"WARNING" type:"AND">
            <custom_item>
              system      : "SunOS"
              type        : CMD_EXEC
              description : "service"
              cmd         : "/usr/bin/svcs ipfilter | /usr/bin/awk '{ print } END { if(NR==0) print \"No results found\" }'"
              expect      : "^online"
            </custom_item>

            <custom_item>
              system      : "SunOS"
              type        : CMD_EXEC
              description : "filters"
              cmd         : "/usr/sbin/ipfstat -io | /usr/bin/awk '{ print } END { if(NR==0) print \"No results found\" }'"
              expect      : ""
              severity    : MEDIUM
            </custom_item>
          </condition>

          <then>
            <report type:"PASSED">
              description : "SOL-11.1-050240 - The boundary protection system (firewall) must be configured to deny network traffic by default and must allow network traffic by exception (i.e., deny all, permit by exception)."
              info        : "A firewall that relies on a deny all, permit by exception strategy requires all traffic to have explicit permission before traversing an interface on the host. The firewall must incorporate stateful packet filtering and logging.

Nonlocal maintenance and diagnostic communications often contain sensitive information and must be protected. The security of these remote accesses can be ensured by sending nonlocal maintenance and diagnostic communications through encrypted channels enforced via firewall configurations.

Satisfies: SRG-OS-000074, SRG-OS-000096, SRG-OS-000112, SRG-OS-000113, SRG-OS-000125, SRG-OS-000250, SRG-OS-000393

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
              solution    : "The root role is required.

For Solaris 11, 11.1, 11.2, and 11.3, that use IP Filter, configure and enable the IP Filters policy.

# pfedit /etc/ipf/ipf.conf.

Add these lines to the file:

# Do not allow all outbound traffic, keep state, and log
block out log all keep state keep frags
# Block and log everything else that comes in
block in log all
block in log from any to 255.255.255.255
block in log from any to 127.0.0.1/32

Enable ipfilter.

# svcadm enable ipfilter

Notify ipfilter to use the new configuration file.

# ipf -Fa -f /etc/ipf/ipf.conf

For Solaris 11.3 or newer, that use Packet Filter, configure and enable the Packet Filter's policy.
# pfedit /etc/firewall/pf.conf.

Add these lines to the file:

# Block and log all traffic on all interfaces in either direction from
# anywhere to anywhere
block log all

Enable Packet Filter.

# svcadm enable firewall:default
Enable Packet Filter logging daemon.
# svcadm enable firewall/pflog:default

Note: Because the default firewall rules block all network access to the system, ensure that there is still a method to access the system such as SSH or console access prior to activating the firewall rules. Operational requirements may dictate the addition of protocols such as SSH, DNS, NTP, HTTP, and HTTPS to be allowed."
              reference   : "800-171|3.1.13,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.5.4,800-171|3.5.10,800-171|3.7.5,800-53|AC-17(2),800-53|CM-6b.,800-53|CM-7b.,800-53|IA-2(8),800-53|IA-5(1)(c),800-53|MA-4c.,800-53|MA-4(6),800-53r5|AC-17(2),800-53r5|CM-6b.,800-53r5|CM-7b.,800-53r5|IA-2(8),800-53r5|IA-5(1)(c),800-53r5|MA-4c.,800-53r5|MA-4(6),CAT|II,CCI|CCI-000197,CCI|CCI-000366,CCI|CCI-000382,CCI|CCI-000877,CCI|CCI-001453,CCI|CCI-001941,CCI|CCI-002890,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(d),CN-L3|7.1.3.1(e),CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.1(a),CN-L3|8.1.4.1(c),CN-L3|8.1.4.2(a),CN-L3|8.1.4.4(b),CN-L3|8.1.10.6(d),CN-L3|8.5.4.1(a),CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.MA-2,CSF|PR.PT-3,CSF|PR.PT-4,CSF2.0|DE.CM-09,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,CSF2.0|PR.AA-05,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17(2),ITSG-33|CM-6b.,ITSG-33|CM-7a.,ITSG-33|IA-2(8),ITSG-33|IA-5(1)(c),ITSG-33|MA-4c.,ITSG-33|MA-4(6),NESA|T2.3.4,NESA|T2.3.8,NESA|T3.2.1,NESA|T5.2.3,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.4.4,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM18,NIAv2|AM37,NIAv2|CY6,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv3.2.1|2.3,PCI-DSSv4.0|2.2.4,PCI-DSSv4.0|2.2.7,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-216150r986422_rule,STIG-ID|SOL-11.1-050240,STIG-Legacy|SV-61107,STIG-Legacy|V-48235,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,SWIFT-CSCv1|4.2,TBA-FIISB|26.1,TBA-FIISB|35.1,TBA-FIISB|36.1,TBA-FIISB|45.2.3,Vuln-ID|V-216150"
              see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
              show_output : YES
            </report>
          </then>
        </if>
      </then>

      <else>
        <if>
          <condition auto:"WARNING" type:"AND">
            <custom_item>
              system      : "SunOS"
              type        : CMD_EXEC
              description : "service"
              cmd         : "/usr/bin/svcs firewall:default | /usr/bin/awk '{ print } END { if(NR==0) print \"No results found\" }'"
              expect      : "^online"
            </custom_item>

            <custom_item>
              system      : "SunOS"
              type        : CMD_EXEC
              description : "filters"
              cmd         : "/usr/sbin/pfctl -s rules | /usr/bin/awk '{ print } END { if(NR==0) print \"No results found\" }'"
              expect      : ""
              severity    : MEDIUM
            </custom_item>
          </condition>

          <then>
            <report type:"PASSED">
              description : "SOL-11.1-050240 - The boundary protection system (firewall) must be configured to deny network traffic by default and must allow network traffic by exception (i.e., deny all, permit by exception)."
              info        : "A firewall that relies on a deny all, permit by exception strategy requires all traffic to have explicit permission before traversing an interface on the host. The firewall must incorporate stateful packet filtering and logging.

Nonlocal maintenance and diagnostic communications often contain sensitive information and must be protected. The security of these remote accesses can be ensured by sending nonlocal maintenance and diagnostic communications through encrypted channels enforced via firewall configurations.

Satisfies: SRG-OS-000074, SRG-OS-000096, SRG-OS-000112, SRG-OS-000113, SRG-OS-000125, SRG-OS-000250, SRG-OS-000393

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
              solution    : "The root role is required.

For Solaris 11, 11.1, 11.2, and 11.3, that use IP Filter, configure and enable the IP Filters policy.

# pfedit /etc/ipf/ipf.conf.

Add these lines to the file:

# Do not allow all outbound traffic, keep state, and log
block out log all keep state keep frags
# Block and log everything else that comes in
block in log all
block in log from any to 255.255.255.255
block in log from any to 127.0.0.1/32

Enable ipfilter.

# svcadm enable ipfilter

Notify ipfilter to use the new configuration file.

# ipf -Fa -f /etc/ipf/ipf.conf

For Solaris 11.3 or newer, that use Packet Filter, configure and enable the Packet Filter's policy.
# pfedit /etc/firewall/pf.conf.

Add these lines to the file:

# Block and log all traffic on all interfaces in either direction from
# anywhere to anywhere
block log all

Enable Packet Filter.

# svcadm enable firewall:default
Enable Packet Filter logging daemon.
# svcadm enable firewall/pflog:default

Note: Because the default firewall rules block all network access to the system, ensure that there is still a method to access the system such as SSH or console access prior to activating the firewall rules. Operational requirements may dictate the addition of protocols such as SSH, DNS, NTP, HTTP, and HTTPS to be allowed."
              reference   : "800-171|3.1.13,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.5.4,800-171|3.5.10,800-171|3.7.5,800-53|AC-17(2),800-53|CM-6b.,800-53|CM-7b.,800-53|IA-2(8),800-53|IA-5(1)(c),800-53|MA-4c.,800-53|MA-4(6),800-53r5|AC-17(2),800-53r5|CM-6b.,800-53r5|CM-7b.,800-53r5|IA-2(8),800-53r5|IA-5(1)(c),800-53r5|MA-4c.,800-53r5|MA-4(6),CAT|II,CCI|CCI-000197,CCI|CCI-000366,CCI|CCI-000382,CCI|CCI-000877,CCI|CCI-001453,CCI|CCI-001941,CCI|CCI-002890,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(d),CN-L3|7.1.3.1(e),CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.1(a),CN-L3|8.1.4.1(c),CN-L3|8.1.4.2(a),CN-L3|8.1.4.4(b),CN-L3|8.1.10.6(d),CN-L3|8.5.4.1(a),CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.MA-2,CSF|PR.PT-3,CSF|PR.PT-4,CSF2.0|DE.CM-09,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,CSF2.0|PR.AA-05,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17(2),ITSG-33|CM-6b.,ITSG-33|CM-7a.,ITSG-33|IA-2(8),ITSG-33|IA-5(1)(c),ITSG-33|MA-4c.,ITSG-33|MA-4(6),NESA|T2.3.4,NESA|T2.3.8,NESA|T3.2.1,NESA|T5.2.3,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.4.4,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM18,NIAv2|AM37,NIAv2|CY6,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv3.2.1|2.3,PCI-DSSv4.0|2.2.4,PCI-DSSv4.0|2.2.7,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-216150r986422_rule,STIG-ID|SOL-11.1-050240,STIG-Legacy|SV-61107,STIG-Legacy|V-48235,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,SWIFT-CSCv1|4.2,TBA-FIISB|26.1,TBA-FIISB|35.1,TBA-FIISB|36.1,TBA-FIISB|45.2.3,Vuln-ID|V-216150"
              see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
              show_output : YES
            </report>
          </then>
        </if>
      </else>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : CMD_EXEC
          description : "Check for Solaris 11.0 - 11.3."
          cmd         : "uname -v"
          expect      : "^[\\s]*11\\.[0-3]"
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "SOL-11.1-050370 - The system must prevent local applications from generating source-routed packets."
          info        : "Source-routed packets allow the source of the packet to suggest that routers forward the packet along a different path than configured on the router, which can be used to bypass network security measures.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
          solution    : "The root role is required.

# pfedit /etc/ipf/ipf.conf

For Solaris 11, 11.1, 11.2, and 11.3 that use IP Filter dd rules to block outgoing source-routed packets, such as:

block out log quick all with opt lsrr
block out log quick all with opt ssrr

Reload the IPF rules.

# ipf -Fa -A -f /etc/ipf/ipf.conf

For Solaris 11.3 or newer that use Packet Filter remove or modify any rules that include 'allow-opts'.

Reload the Packet Filter rules:
# svcadm refresh firewall:default"
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216157r959010_rule,STIG-ID|SOL-11.1-050370,STIG-Legacy|SV-61085,STIG-Legacy|V-48213,SWIFT-CSCv1|2.3,Vuln-ID|V-216157"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          cmd         : "/usr/sbin/ipfstat -io | /usr/bin/awk '{ print } END { if(NR==0) print \"No results found\" }'"
          expect      : ""
          severity    : MEDIUM
        </custom_item>
      </then>

      <else>
        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "SOL-11.1-050370 - The system must prevent local applications from generating source-routed packets."
          info        : "Source-routed packets allow the source of the packet to suggest that routers forward the packet along a different path than configured on the router, which can be used to bypass network security measures.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
          solution    : "The root role is required.

# pfedit /etc/ipf/ipf.conf

For Solaris 11, 11.1, 11.2, and 11.3 that use IP Filter dd rules to block outgoing source-routed packets, such as:

block out log quick all with opt lsrr
block out log quick all with opt ssrr

Reload the IPF rules.

# ipf -Fa -A -f /etc/ipf/ipf.conf

For Solaris 11.3 or newer that use Packet Filter remove or modify any rules that include 'allow-opts'.

Reload the Packet Filter rules:
# svcadm refresh firewall:default"
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216157r959010_rule,STIG-ID|SOL-11.1-050370,STIG-Legacy|SV-61085,STIG-Legacy|V-48213,SWIFT-CSCv1|2.3,Vuln-ID|V-216157"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          cmd         : "/usr/sbin/pfctl -s rules | /usr/bin/grep allow-opts | /usr/bin/awk '{ print } END { if(NR==0) print \"No results found\" }'"
          expect      : ""
          severity    : MEDIUM
        </custom_item>
      </else>
    </if>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          system      : "SunOS"
          type        : BANNER_CHECK
          description : "'/etc/motd'"
          file        : "/etc/motd"
          content     : "@BANNER_TEXT@"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : BANNER_CHECK
          description : "'/etc/issue'"
          file        : "/etc/issue"
          content     : "@BANNER_TEXT@"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "SOL-11.1-050380 - The operating system must display the DoD approved system use notification message or banner before granting access to the system for general system logons."
          info        : "Warning messages inform users who are attempting to log in to the system of their legal status regarding the system and must include the name of the organization that owns the system and any monitoring policies that are in place. As implementing a logon banner to deter inappropriate use can provide a foundation for legal action against abuse, this warning content should be set as appropriate."
          solution    : "The root role is required.

Edit the contents of these two files and ensure that the proper DoD banner message is viewable.

# pfedit /etc/motd
# pfedit /etc/issue

The DoD required text is:

'You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only. By using this IS (which includes any device attached to this IS), you consent to the following conditions:
-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.
-At any time, the USG may inspect and seize data stored on this IS.
-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.
-This IS includes security measures (e.g., authentication and access controls) to protect USG interests -- not for your personal benefit or privacy. -Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.'"
          reference   : "800-171|3.1.9,800-53|AC-8a.,800-53r5|AC-8a.,CAT|III,CCI|CCI-000048,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-8a.,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,Rule-ID|SV-216158r958390_rule,STIG-ID|SOL-11.1-050380,STIG-Legacy|SV-61081,STIG-Legacy|V-48209,TBA-FIISB|45.2.4,Vuln-ID|V-216158"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          system      : "SunOS"
          type        : FILE_CONTENT_CHECK
          description : "'sshd'"
          file        : "/etc/ssh/sshd_config"
          regex       : "^[\\s]*Banner[\\s]+"
          expect      : "^[\\s]*Banner[\\s]+/etc/issue[\\s]*$"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : BANNER_CHECK
          description : "'/etc/issue'"
          file        : "/etc/issue"
          content     : "@BANNER_TEXT@"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "SOL-11.1-050390 - The operating system must display the DoD approved system use notification message or banner for SSH connections."
          info        : "Warning messages inform users who are attempting to log in to the system of their legal status regarding the system and must include the name of the organization that owns the system and any monitoring policies that are in place. As implementing a logon banner to deter inappropriate use can provide a foundation for legal action against abuse, this warning content should be set as appropriate."
          solution    : "The root role is required.

Edit the SSH configuration file.

# pfedit /etc/ssh/sshd_config

Locate the file containing:

Banner

Change the line to read:

Banner /etc/issue

Edit the /etc/issue file

# pfedit /etc/issue

The DoD required text is:

'You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only. By using this IS (which includes any device attached to this IS), you consent to the following conditions:
-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.
-At any time, the USG may inspect and seize data stored on this IS.
-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.
-This IS includes security measures (e.g., authentication and access controls) to protect USG interests -- not for your personal benefit or privacy. -Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.'

Restart the SSH service

# svcadm restart svc:/network/ssh"
          reference   : "800-171|3.1.9,800-53|AC-8a.,800-53r5|AC-8a.,CAT|III,CCI|CCI-000048,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-8a.,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,Rule-ID|SV-216159r958390_rule,STIG-ID|SOL-11.1-050390,STIG-Legacy|SV-61077,STIG-Legacy|V-48205,TBA-FIISB|45.2.4,Vuln-ID|V-216159"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          system        : "SunOS"
          type          : FILE_CONTENT_CHECK
          description   : "'gdm'"
          file          : "/etc/gdm/Init/Default"
          regex         : "^[\\s]*/usr/bin/zenity[\\s]+"
          expect        : "^[\\s]*/usr/bin/zenity --text-info --width=800 --height=300 --title=\"Security Message\" --filename=/etc/issue[\\s]*$"
          file_required : NO
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : BANNER_CHECK
          description : "'/etc/issue'"
          file        : "/etc/issue"
          content     : "@BANNER_TEXT@"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "SOL-11.1-050410 - The GNOME service must display the DoD approved system use notification message or banner before granting access to the system."
          info        : "Warning messages inform users who are attempting to log in to the system of their legal status regarding the system and must include the name of the organization that owns the system and any monitoring policies that are in place. As implementing a logon banner to deter inappropriate use can provide a foundation for legal action against abuse, this warning content should be set as appropriate."
          solution    : "The root role is required.

If the system does not use XWindows, this is not applicable.

# pfedit /etc/issue

Insert the proper DoD banner message text. The DoD required text is:

'You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only. By using this IS (which includes any device attached to this IS), you consent to the following conditions:
-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.
-At any time, the USG may inspect and seize data stored on this IS.
-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.
-This IS includes security measures (e.g., authentication and access controls) to protect USG interests -- not for your personal benefit or privacy. -Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.'

# pfedit /etc/gdm/Init/Default

Add the following content before the 'exit 0' line of the file.

/usr/bin/zenity --text-info --width=800 --height=300 \
--title='Security Message' --filename=/etc/issue"
          reference   : "800-171|3.1.9,800-53|AC-8a.,800-53|AC-8b.,800-53r5|AC-8a.,800-53r5|AC-8b.,CAT|III,CCI|CCI-000048,CCI|CCI-000050,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-8a.,ITSG-33|AC-8b.,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,NIAv2|AM10f,Rule-ID|SV-216160r958390_rule,STIG-ID|SOL-11.1-050410,STIG-Legacy|SV-61075,STIG-Legacy|V-48203,TBA-FIISB|45.2.4,Vuln-ID|V-216160"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : CMD_EXEC
          description : "FTP service is not installed"
          cmd         : "/usr/bin/pkg list service/network/ftp 2>&1"
          expect      : "no packages matching"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "SOL-11.1-050430 - The FTP service must display the DoD approved system use notification message or banner before granting access to the system."
          info        : "Warning messages inform users who are attempting to log in to the system of their legal status regarding the system and must include the name of the organization that owns the system and any monitoring policies that are in place. As implementing a logon banner to deter inappropriate use can provide a foundation for legal action against abuse, this warning content should be set as appropriate."
          solution    : "The root role is required.

The package: pkg:/service/network/ftp must be installed.

# pfedit /etc/issue

Insert the proper DoD banner message text. The DoD required text is:

'You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only. By using this IS (which includes any device attached to this IS), you consent to the following conditions:
-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.
-At any time, the USG may inspect and seize data stored on this IS.
-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.
-This IS includes security measures (e.g., authentication and access controls) to protect USG interests -- not for your personal benefit or privacy. -Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.'

# echo 'DisplayConnect /etc/issue' >> /etc/proftpd.conf

# svcadm restart ftp"
          reference   : "800-171|3.1.9,800-53|AC-8a.,800-53r5|AC-8a.,CAT|III,CCI|CCI-000048,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-8a.,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,Rule-ID|SV-216161r958390_rule,STIG-ID|SOL-11.1-050430,STIG-Legacy|SV-61071,STIG-Legacy|V-48199,TBA-FIISB|45.2.4,Vuln-ID|V-216161"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>
      </then>

      <else>
        <if>
          <condition auto:"FAILED" type:"AND">
            <custom_item>
              system      : "SunOS"
              type        : FILE_CONTENT_CHECK
              description : "'/etc/proftpd.conf'"
              file        : "/etc/proftpd.conf"
              regex       : "^[\\s]*DisplayConnect[\\s]+"
              expect      : "^[\\s]*DisplayConnect[\\s]+/etc/issue[\\s]*$"
            </custom_item>

            <custom_item>
              system      : "SunOS"
              type        : BANNER_CHECK
              description : "'/etc/issue'"
              file        : "/etc/issue"
              content     : "@BANNER_TEXT@"
            </custom_item>
          </condition>

          <then>
            <report type:"PASSED">
              description : "SOL-11.1-050430 - The FTP service must display the DoD approved system use notification message or banner before granting access to the system."
              info        : "Warning messages inform users who are attempting to log in to the system of their legal status regarding the system and must include the name of the organization that owns the system and any monitoring policies that are in place. As implementing a logon banner to deter inappropriate use can provide a foundation for legal action against abuse, this warning content should be set as appropriate."
              solution    : "The root role is required.

The package: pkg:/service/network/ftp must be installed.

# pfedit /etc/issue

Insert the proper DoD banner message text. The DoD required text is:

'You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only. By using this IS (which includes any device attached to this IS), you consent to the following conditions:
-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.
-At any time, the USG may inspect and seize data stored on this IS.
-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.
-This IS includes security measures (e.g., authentication and access controls) to protect USG interests -- not for your personal benefit or privacy. -Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.'

# echo 'DisplayConnect /etc/issue' >> /etc/proftpd.conf

# svcadm restart ftp"
              reference   : "800-171|3.1.9,800-53|AC-8a.,800-53r5|AC-8a.,CAT|III,CCI|CCI-000048,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-8a.,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,Rule-ID|SV-216161r958390_rule,STIG-ID|SOL-11.1-050430,STIG-Legacy|SV-61071,STIG-Legacy|V-48199,TBA-FIISB|45.2.4,Vuln-ID|V-216161"
              see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
              show_output : YES
            </report>
          </then>
        </if>
      </else>
    </if>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          system      : "SunOS"
          type        : FILE_CONTENT_CHECK
          description : "'ClientAliveInterval'"
          file        : "/etc/ssh/sshd_config"
          regex       : "^[\\s]*ClientAliveInterval[\\s]+"
          expect      : "^[\\s]*ClientAliveInterval[\\s]+600[\\s]*$"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : FILE_CONTENT_CHECK
          description : "'ClientAliveCountMax'"
          file        : "/etc/ssh/sshd_config"
          regex       : "^[\\s]*ClientAliveCountMax[\\s]+"
          expect      : "^[\\s]*ClientAliveCountMax[\\s]+0[\\s]*$"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "SOL-11.1-050460 - The operating system must terminate all sessions and network connections when nonlocal maintenance is completed."
          info        : "Nonlocal maintenance and diagnostic activities are those activities conducted by individuals communicating through a network, either an external network (e.g., the internet) or an internal network.

The operating system needs to ensure all sessions and network connections are terminated when nonlocal maintenance is completed."
          solution    : "The root role is required.

Configure the system to disconnect SSH sessions after 10 minutes of inactivity.

# pfedit /etc/ssh/sshd_config

Insert the two lines:

ClientAliveInterval 600
ClientAliveCountMax 0

Restart the SSH service with the new configuration.

# svcadm restart svc:/network/ssh"
          reference   : "800-171|3.13.9,800-53|SC-10,800-53r5|SC-10,CAT|II,CCI|CCI-001133,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-10,ITSG-33|SC-10a.,NESA|T2.3.8,NESA|T4.5.1,NESA|T5.5.1,Rule-ID|SV-216162r986457_rule,STIG-ID|SOL-11.1-050460,STIG-Legacy|SV-61067,STIG-Legacy|V-48195,SWIFT-CSCv1|2.6,Vuln-ID|V-216162"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : CMD_EXEC
          description : "Global zone auditing is configured."
          cmd         : "/usr/bin/zonename"
          expect      : "^global$"
        </custom_item>
      </condition>

      <then>
        <if>
          <condition auto:"FAILED" type:"AND">
            <custom_item>
              system      : "SunOS"
              type        : CMD_EXEC
              description : "'mac-nospoof'"
              cmd         : "/usr/sbin/dladm show-linkprop -p protection -o value | /usr/bin/grep -v VALUE | /usr/bin/xargs /usr/bin/echo"
              expect      : "^.*(?=.*mac-nospoof).*$"
            </custom_item>

            <custom_item>
              system      : "SunOS"
              type        : CMD_EXEC
              description : "'restricted'"
              cmd         : "/usr/sbin/dladm show-linkprop -p protection -o value | /usr/bin/grep -v VALUE | /usr/bin/xargs /usr/bin/echo"
              expect      : "^.*(?=.*restricted).*$"
            </custom_item>

            <custom_item>
              system      : "SunOS"
              type        : CMD_EXEC
              description : "'dhcp-nospoof'"
              cmd         : "/usr/sbin/dladm show-linkprop -p protection -o value | /usr/bin/grep -v VALUE | /usr/bin/xargs /usr/bin/echo"
              expect      : "^.*(?=.*dhcp-nospoof).*$"
            </custom_item>

            <custom_item>
              system      : "SunOS"
              type        : CMD_EXEC
              description : "'ip-nospoof'"
              cmd         : "/usr/sbin/dladm show-linkprop -p protection -o value | /usr/bin/grep -v VALUE | /usr/bin/xargs /usr/bin/echo"
              expect      : "^.*(?=.*ip-nospoof).*$"
            </custom_item>
          </condition>

          <then>
            <report type:"PASSED">
              description : "SOL-11.1-050470 - The operating system must prevent internal users from sending out packets which attempt to manipulate or spoof invalid IP addresses."
              info        : "Manipulation of IP addresses can allow untrusted systems to appear as trusted hosts, bypassing firewall and other security mechanism and resulting in system penetration."
              solution    : "Determine the name of the zone that you are currently securing.

# zonename

If the command output is 'global', then only the 'phys' and 'SR-IOV' interfaces assigned to the global zone require configuration. If using a non-Global zone, then all 'phys' and 'SR-IOV' interfaces assigned to the zone require configuration.

The Network Link Security profile is required.

Determine which network interfaces are available and what protection modes are enabled and required.

Enable link protection based on each configured network interface type.

For InfiniBand:
# pfexec dladm set-linkprop -p protection=restricted,ip-nospoof,dhcp-nospoof [interface name]

For IP forwarding:
# pfexec dladm set-linkprop -p protection=mac-nospoof,restricted,dhcp-nospoof [interface name]

For SR-IOV:
# pfexec dladm set-linkprop -p protection=mac-nospoof,restricted,dhcp-nospoof [interface name]

For Ethernet without IP forwarding:
# pfexec dladm set-linkprop -p protection=mac-nospoof,restricted,ip-nospoof,dhcp-nospoof [interface name]"
              reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216163r959010_rule,STIG-ID|SOL-11.1-050470,STIG-Legacy|SV-61063,STIG-Legacy|V-48191,SWIFT-CSCv1|2.3,Vuln-ID|V-216163"
              see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
              show_output : YES
            </report>
          </then>
        </if>

        <custom_item>
          type        : CMD_EXEC
          description : "SOL-11.1-050480 - Wireless network adapters must be disabled."
          info        : "The use of wireless networking can introduce many different attack vectors into the organization's network. Common attack vectors such as malicious association and ad hoc networks will allow an attacker to spoof a wireless access point (AP), allowing validated systems to connect to the malicious AP and enabling the attacker to monitor and record network traffic. These malicious APs can also serve to create a man-in-the-middle attack or be used to create a denial-of-service to valid network resources."
          solution    : "Configure the system to disable all wireless network interfaces."
          reference   : "800-171|3.1.17,800-171|3.13.8,800-53|AC-18(1),800-53|SC-8,800-53r5|AC-18(1),800-53r5|SC-8,CAT|II,CCI|CCI-001443,CCI|CCI-001444,CCI|CCI-002418,CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,CSF2.0|PR.AA-05,CSF2.0|PR.DS-02,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ITSG-33|AC-18(1),ITSG-33|SC-8,ITSG-33|SC-8a.,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS29,NIAv2|NS33,NIAv2|NS34,NIAv2|NS38,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,Rule-ID|SV-216164r958358_rule,STIG-ID|SOL-11.1-050480,STIG-Legacy|SV-87479,STIG-Legacy|V-72827,SWIFT-CSCv1|2.3,Vuln-ID|V-216164"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          cmd         : "/sbin/dladm show-wifi | /bin/grep 'connected' | /bin/awk '{ print } END { if (NR == 0) print \"No WiFi connected\" }'"
          expect      : "No WiFi connected"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "SOL-11.1-060010 - The operating system must use mechanisms for authentication to a cryptographic module meeting the requirements of applicable federal laws, Executive orders, directives, policies, regulations, standards, and guidance for such authentication."
          info        : "Encryption is only as good as the encryption modules utilized. Unapproved cryptographic module algorithms cannot be verified, and cannot be relied upon to provide confidentiality or integrity, and DoD data may be compromised due to weak algorithms.

Applications utilizing encryption are required to use approved encryption modules meeting the requirements of applicable federal laws, Executive orders, directives, policies, regulations, standards, and guidance.

FIPS 140-2 is the current standard for validating cryptographic modules, and NSA Type-X (where X=1, 2, 3, 4) products are NSA-certified hardware based encryption modules.

Satisfies: SRG-OS-000120, SRG-OS-000169"
          solution    : "The Crypto Management profile is required to execute this command.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

Enable FIPS-140 mode.

# pfexec cryptoadm enable fips-140

Reboot the system as requested."
          reference   : "800-53|IA-7,800-53r5|IA-7,CAT|II,CCI|CCI-000803,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(d),ITSG-33|IA-7,ITSG-33|IA-7a.,NESA|M5.2.1,NESA|M5.2.6,NESA|M5.3.1,NESA|T7.4.1,QCSC-v1|13.2,Rule-ID|SV-216165r958358_rule,STIG-ID|SOL-11.1-060010,STIG-Legacy|SV-61059,STIG-Legacy|V-48187,Vuln-ID|V-216165"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          cmd         : "/usr/sbin/cryptoadm list fips-140| /usr/bin/grep -c 'is disabled'"
          expect      : "^0$"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "SOL-11.1-060060 - The operating system must employ FIPS-validate or NSA-approved cryptography to implement digital signatures."
          info        : "FIPS 140-2 is the current standard for validating cryptographic modules, and NSA Type-X (where X=1, 2, 3, 4) products are NSA-certified hardware based encryption modules."
          solution    : "The Crypto Management profile is required to execute this command.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

Enable FIPS-140 mode.

# pfexec cryptoadm enable fips-140

Reboot the system as requested."
          reference   : "800-171|3.13.11,800-53|SC-13,800-53r5|SC-13b.,CAT|II,CCI|CCI-002450,CSF|PR.DS-5,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2,Rule-ID|SV-220003r987791_rule,STIG-ID|SOL-11.1-060060,STIG-Legacy|SV-61055,STIG-Legacy|V-48183,Vuln-ID|V-220003"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          cmd         : "/usr/sbin/cryptoadm list fips-140| /usr/bin/grep -c 'is disabled'"
          expect      : "^0$"
        </custom_item>
      </then>

      <else>
        <report type:"PASSED">
          description : "SOL-11.1-050470 - The operating system must prevent internal users from sending out packets which attempt to manipulate or spoof invalid IP addresses."
          info        : "Manipulation of IP addresses can allow untrusted systems to appear as trusted hosts, bypassing firewall and other security mechanism and resulting in system penetration."
          solution    : "Determine the name of the zone that you are currently securing.

# zonename

If the command output is 'global', then only the 'phys' and 'SR-IOV' interfaces assigned to the global zone require configuration. If using a non-Global zone, then all 'phys' and 'SR-IOV' interfaces assigned to the zone require configuration.

The Network Link Security profile is required.

Determine which network interfaces are available and what protection modes are enabled and required.

Enable link protection based on each configured network interface type.

For InfiniBand:
# pfexec dladm set-linkprop -p protection=restricted,ip-nospoof,dhcp-nospoof [interface name]

For IP forwarding:
# pfexec dladm set-linkprop -p protection=mac-nospoof,restricted,dhcp-nospoof [interface name]

For SR-IOV:
# pfexec dladm set-linkprop -p protection=mac-nospoof,restricted,dhcp-nospoof [interface name]

For Ethernet without IP forwarding:
# pfexec dladm set-linkprop -p protection=mac-nospoof,restricted,ip-nospoof,dhcp-nospoof [interface name]"
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216163r959010_rule,STIG-ID|SOL-11.1-050470,STIG-Legacy|SV-61063,STIG-Legacy|V-48191,SWIFT-CSCv1|2.3,Vuln-ID|V-216163"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-050480 - Wireless network adapters must be disabled."
          info        : "The use of wireless networking can introduce many different attack vectors into the organization's network. Common attack vectors such as malicious association and ad hoc networks will allow an attacker to spoof a wireless access point (AP), allowing validated systems to connect to the malicious AP and enabling the attacker to monitor and record network traffic. These malicious APs can also serve to create a man-in-the-middle attack or be used to create a denial-of-service to valid network resources."
          solution    : "Configure the system to disable all wireless network interfaces."
          reference   : "800-171|3.1.17,800-171|3.13.8,800-53|AC-18(1),800-53|SC-8,800-53r5|AC-18(1),800-53r5|SC-8,CAT|II,CCI|CCI-001443,CCI|CCI-001444,CCI|CCI-002418,CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,CSF2.0|PR.AA-05,CSF2.0|PR.DS-02,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ITSG-33|AC-18(1),ITSG-33|SC-8,ITSG-33|SC-8a.,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS29,NIAv2|NS33,NIAv2|NS34,NIAv2|NS38,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,Rule-ID|SV-216164r958358_rule,STIG-ID|SOL-11.1-050480,STIG-Legacy|SV-87479,STIG-Legacy|V-72827,SWIFT-CSCv1|2.3,Vuln-ID|V-216164"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-060010 - The operating system must use mechanisms for authentication to a cryptographic module meeting the requirements of applicable federal laws, Executive orders, directives, policies, regulations, standards, and guidance for such authentication."
          info        : "Encryption is only as good as the encryption modules utilized. Unapproved cryptographic module algorithms cannot be verified, and cannot be relied upon to provide confidentiality or integrity, and DoD data may be compromised due to weak algorithms.

Applications utilizing encryption are required to use approved encryption modules meeting the requirements of applicable federal laws, Executive orders, directives, policies, regulations, standards, and guidance.

FIPS 140-2 is the current standard for validating cryptographic modules, and NSA Type-X (where X=1, 2, 3, 4) products are NSA-certified hardware based encryption modules.

Satisfies: SRG-OS-000120, SRG-OS-000169"
          solution    : "The Crypto Management profile is required to execute this command.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

Enable FIPS-140 mode.

# pfexec cryptoadm enable fips-140

Reboot the system as requested."
          reference   : "800-53|IA-7,800-53r5|IA-7,CAT|II,CCI|CCI-000803,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(d),ITSG-33|IA-7,ITSG-33|IA-7a.,NESA|M5.2.1,NESA|M5.2.6,NESA|M5.3.1,NESA|T7.4.1,QCSC-v1|13.2,Rule-ID|SV-216165r958358_rule,STIG-ID|SOL-11.1-060010,STIG-Legacy|SV-61059,STIG-Legacy|V-48187,Vuln-ID|V-216165"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-060060 - The operating system must employ FIPS-validate or NSA-approved cryptography to implement digital signatures."
          info        : "FIPS 140-2 is the current standard for validating cryptographic modules, and NSA Type-X (where X=1, 2, 3, 4) products are NSA-certified hardware based encryption modules."
          solution    : "The Crypto Management profile is required to execute this command.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

Enable FIPS-140 mode.

# pfexec cryptoadm enable fips-140

Reboot the system as requested."
          reference   : "800-171|3.13.11,800-53|SC-13,800-53r5|SC-13b.,CAT|II,CCI|CCI-002450,CSF|PR.DS-5,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2,Rule-ID|SV-220003r987791_rule,STIG-ID|SOL-11.1-060060,STIG-Legacy|SV-61055,STIG-Legacy|V-48183,Vuln-ID|V-220003"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>
      </else>
    </if>

    <if>
      <condition auto:"WARNING" type:"AND">
        <custom_item>
          type        : CMD_EXEC
          description : "netstat review"
          cmd         : "/usr/bin/netstat -a | /usr/bin/grep LISTEN"
          expect      : "^Manual Review Required$"
          severity    : MEDIUM
        </custom_item>

        <custom_item>
          type        : CMD_EXEC
          description : "ssh enabled"
          cmd         : "/usr/bin/svcs svc:/network/ssh"
          expect      : "^[\\s]*online"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "SOL-11.1-060070 - The operating system must protect the integrity of transmitted information."
          info        : "Ensuring the integrity of transmitted information requires the operating system take feasible measures to employ transmission layer security. This requirement applies to communications across internal and external networks.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
          solution    : "Configure SSH to be enabled.

# svcadm enable svc:/network/ssh"
          reference   : "800-171|3.13.8,800-53|SC-8,800-53r5|SC-8,CAT|II,CCI|CCI-002418,CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSF|PR.DS-2,CSF|PR.DS-5,CSF2.0|PR.DS-02,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ITSG-33|SC-8,ITSG-33|SC-8a.,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,Rule-ID|SV-220004r958908_rule,STIG-ID|SOL-11.1-060070,STIG-Legacy|SV-61051,STIG-Legacy|V-48179,Vuln-ID|V-220004"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <if>
      <condition auto:"WARNING" type:"AND">
        <custom_item>
          type        : CMD_EXEC
          description : "netstat review"
          cmd         : "/usr/bin/netstat -a | /usr/bin/grep LISTEN"
          expect      : "^Manual Review Required$"
          severity    : MEDIUM
        </custom_item>

        <custom_item>
          type        : CMD_EXEC
          description : "ssh enabled"
          cmd         : "/usr/bin/svcs svc:/network/ssh"
          expect      : "^[\\s]*online"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "SOL-11.1-060080 - The operating system must employ cryptographic mechanisms to recognize changes to information during transmission unless otherwise protected by alternative physical measures."
          info        : "Ensuring that transmitted information is not altered during transmission requires the operating system take feasible measures to employ transmission layer security. This requirement applies to communications across internal and external networks.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
          solution    : "Configure SSH to be enabled.

# svcadm enable svc:/network/ssh"
          reference   : "800-171|3.13.8,800-53|SC-8(1),800-53r5|SC-8(1),CAT|II,CCI|CCI-002421,CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSF|PR.DS-2,CSF|PR.DS-5,CSF2.0|PR.DS-02,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,Rule-ID|SV-220005r971547_rule,STIG-ID|SOL-11.1-060080,STIG-Legacy|SV-61047,STIG-Legacy|V-48175,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-220005"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <report type:"WARNING">
      description : "SOL-11.1-060090 - The operating system must maintain the integrity of information during aggregation, packaging, and transformation in preparation for transmission."
      info        : "Ensuring the integrity of transmitted information requires the operating system take feasible measures to employ transmission layer security. This requirement applies to communications across internal and external networks.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "All remote sessions must be conducted via SSH and IPsec. Ensure that SSH and IPsec are the only protocols used."
      reference   : "800-171|3.13.8,800-53|SC-8(2),800-53r5|SC-8(2),CAT|II,CCI|CCI-002420,CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSF|PR.DS-2,CSF|PR.DS-5,CSF2.0|PR.DS-02,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,Rule-ID|SV-220006r958912_rule,STIG-ID|SOL-11.1-060090,STIG-Legacy|SV-61043,STIG-Legacy|V-48171,SWIFT-CSCv1|2.1,Vuln-ID|V-220006"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
    </report>

    <report type:"WARNING">
      description : "SOL-11.1-060100 - The operating system must protect the confidentiality of transmitted information."
      info        : "Ensuring the confidentiality of transmitted information requires the operating system take feasible measures to employ transmission layer security. This requirement applies to communications across internal and external networks.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "All remote sessions must be conducted via SSH and IPsec. Ensure that SSH and IPsec are the only protocols used."
      reference   : "800-171|3.13.8,800-53|SC-8,800-53r5|SC-8,CAT|II,CCI|CCI-002418,CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSF|PR.DS-2,CSF|PR.DS-5,CSF2.0|PR.DS-02,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ITSG-33|SC-8,ITSG-33|SC-8a.,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,Rule-ID|SV-220007r958908_rule,STIG-ID|SOL-11.1-060100,STIG-Legacy|SV-61039,STIG-Legacy|V-48167,Vuln-ID|V-220007"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
    </report>

    <report type:"WARNING">
      description : "SOL-11.1-060110 - The operating system must employ cryptographic mechanisms to prevent unauthorized disclosure of information during transmission unless otherwise protected by alternative physical measures."
      info        : "Ensuring that transmitted information does not become disclosed to unauthorized entities requires the operating system take feasible measures to employ transmission layer security. This requirement applies to communications across internal and external networks.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "All remote sessions must be conducted via SSH and IPsec. Ensure that SSH and IPsec are the only protocols used."
      reference   : "800-171|3.13.8,800-53|SC-8(1),800-53r5|SC-8(1),CAT|II,CCI|CCI-002421,CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSF|PR.DS-2,CSF|PR.DS-5,CSF2.0|PR.DS-02,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,Rule-ID|SV-220008r971547_rule,STIG-ID|SOL-11.1-060110,STIG-Legacy|SV-61035,STIG-Legacy|V-48163,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-220008"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
    </report>

    <report type:"WARNING">
      description : "SOL-11.1-060120 - The operating system must maintain the confidentiality of information during aggregation, packaging, and transformation in preparation for transmission."
      info        : "Ensuring that transmitted information remains confidential during aggregation, packaging, and transformation requires the operating system take feasible measures to employ transmission layer security. This requirement applies to communications across internal and external networks.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "All remote sessions must be conducted via SSH and IPsec. Ensure that SSH and IPsec are the only protocols used."
      reference   : "800-171|3.13.8,800-53|SC-8(2),800-53r5|SC-8(2),CAT|II,CCI|CCI-002420,CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSF|PR.DS-2,CSF|PR.DS-5,CSF2.0|PR.DS-02,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,Rule-ID|SV-220009r958912_rule,STIG-ID|SOL-11.1-060120,STIG-Legacy|SV-61033,STIG-Legacy|V-48161,SWIFT-CSCv1|2.1,Vuln-ID|V-220009"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
    </report>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "SOL-11.1-060130 - The operating system must implement DoD-approved encryption to protect the confidentiality of remote access sessions."
      info        : "Remote access is any access to an organizational information system by a user (or an information system) communicating through an external, non-organization-controlled network (e.g., the Internet). Examples of remote access methods include dial-up, broadband, and wireless.

Using cryptography ensures confidentiality of the remote access connections.

The system will attempt to use the first cipher presented by the client that matches the server list. Listing the values 'strongest to weakest' is a method to ensure the use of the strongest cipher available to secure the SSH connection.

Note:  SSH in Solaris 11.GA-11.3 used Sun Microsystem's proprietary SUNWssh. In Solaris 11.3 OpenSSH was offered as optional software and in Solaris 11.4 OpenSSH is the only SSH offered. Both use the same /etc/ssh/sshd_config file and both, by default do not include the ciphers line."
      solution    : "The root role is required.

Modify the sshd_config file.

# pfedit /etc/ssh/sshd_config

Change or set the ciphers line to the following:

ciphers aes256-ctr,aes192-ctr,aes128-ctr

Restart the SSH service.

# svcadm restart svc:/network/ssh"
      reference   : "800-171|3.1.13,800-53|AC-17(2),800-53r5|AC-17(2),CAT|II,CCI|CCI-000068,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,CSF2.0|PR.AA-05,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,PCI-DSSv3.2.1|2.3,PCI-DSSv4.0|2.2.7,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,Rule-ID|SV-216173r958408_rule,STIG-ID|SOL-11.1-060130,STIG-Legacy|SV-61031,STIG-Legacy|V-48159,SWIFT-CSCv1|2.6,Vuln-ID|V-216173"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      file        : "/etc/ssh/sshd_config"
      regex       : "^[\\s]*Ciphers[\\s]+"
      expect      : "^[\\s]*Ciphers[\\s]+aes256-ctr,aes192-ctr,aes128-ctr[\\s]*$"
    </custom_item>

    <report type:"WARNING">
      description : "SOL-11.1-060140 - The operating system must use cryptographic mechanisms to protect and restrict access to information on portable digital media."
      info        : "When data is written to portable digital media, such as thumb drives, floppy diskettes, compact disks, and magnetic tape, etc., there is risk of data loss.

An organizational assessment of risk guides the selection of media and associated information contained on the media requiring restricted access.

Organizations need to document in policy and procedures the media requiring restricted access, individuals authorized to access the media, and the specific measures taken to restrict access. Fewer protection measures are needed for media containing information determined by the organization to be in the public domain, to be publicly releasable, or to have limited or no adverse impact if accessed by other than authorized personnel.

In these situations, it is assumed the physical access controls where the media resides provide adequate protection. The employment of cryptography is at the discretion of the information owner/steward.

When the organization has determined the risk warrants it, data written to portable digital media must be encrypted.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "The root role is required.

Format a removable device as a ZFS encrypted file system.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

The ZFS File System Management and ZFS Storage management profiles are required.

Insert the removable device:

# rmformat

This command lists all attached removable devices. Note the device logical node name. For example: /dev/rdsk/c8t0d0p0

Create an encrypted zpool on this device using a poolname of your choice:

# pfexec zpool create -O encryption=on [poolname] c8t0d0p0

Enter a passphrase and confirm the passphrase. Keep the passphrase secure.

Export the zpool before removing the media:

# pfexec export [poolname]

It will be necessary to enter the passphrase when inserting and importing the removable media zpool:
Insert the removable media
# pfexec import [poolname]

Only store data in the encrypted file system."
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216174r959010_rule,STIG-ID|SOL-11.1-060140,STIG-Legacy|SV-61029,STIG-Legacy|V-48157,SWIFT-CSCv1|2.3,Vuln-ID|V-216174"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
    </report>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "SOL-11.1-060150 - The operating system must employ cryptographic mechanisms to protect information in storage."
      info        : "When data is written to digital media, such as hard drives, mobile computers, external/removable hard drives, personal digital assistants, flash/thumb drives, etc., there is risk of data loss and data compromise.

An organizational assessment of risk guides the selection of media and associated information contained on the media requiring restricted access. Organizations need to document in policy and procedures the media requiring restricted access, individuals authorized to access the media, and the specific measures taken to restrict access.

Fewer protection measures are needed for media containing information determined by the organization to be in the public domain, to be publicly releasable, or to have limited or no adverse impact if accessed by other than authorized personnel. In these situations, it is assumed the physical access controls where the media resides provide adequate protection.

As part of a defense-in-depth strategy, the organization considers routinely encrypting information at rest on selected secondary storage devices. The employment of cryptography is at the discretion of the information owner/steward. The selection of the cryptographic mechanisms used is based upon maintaining the confidentiality and integrity of the information."
      solution    : "The ZFS file system management profile is required.

ZFS file system encryption may only be enabled on creation of the file system. If a file system must be encrypted and is not, its data should be archived, it must be removed and re-created.

First, stop running applications using the file systems, archive the data, unmount, and then remove the file system.

# umount [file system name]
# zfs destroy [file system name]

When creating ZFS file systems, ensure that they are created as encrypted file systems.

# pfexec zfs create -o encryption=on [file system name]
Enter passphrase for '[file system name]': xxxxxxx
Enter again: xxxxxxx

Store the passphrase in a safe location. The passphrase will be required to mount the file systems upon system reboot. If automated mounting is required, the passphrase must be stored in a file."
      reference   : "800-171|3.13.16,800-53|SC-28(1),800-53r5|SC-28(1),CAT|III,CCI|CCI-002475,CN-L3|8.1.4.7(b),CN-L3|8.1.4.8(b),CSF|PR.DS-1,CSF2.0|PR.DS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ITSG-33|SC-28(1),PCI-DSSv3.2.1|3.4,PCI-DSSv4.0|3.3.2,PCI-DSSv4.0|3.5.1,QCSC-v1|5.2.2,QCSC-v1|6.2,Rule-ID|SV-220010r958870_rule,STIG-ID|SOL-11.1-060150,STIG-Legacy|SV-61027,STIG-Legacy|V-48155,TBA-FIISB|28.1,Vuln-ID|V-220010"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      cmd         : "/usr/sbin/zfs get -o value encryption rpool | /usr/bin/egrep -v 'off|VALUE' | /usr/bin/awk '{ print } END { if (NR != 0) print \"pass\" }'"
      expect      : "pass"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "SOL-11.1-060160 - The operating system must protect the confidentiality and integrity of information at rest."
      info        : "When data is written to digital media, such as hard drives, mobile computers, external/removable hard drives, personal digital assistants, flash/thumb drives, etc., there is risk of data loss and data compromise.

An organizational assessment of risk guides the selection of media and associated information contained on the media requiring restricted access. Organizations need to document in policy and procedures the media requiring restricted access, individuals authorized to access the media, and the specific measures taken to restrict access.

Fewer protection measures are needed for media containing information determined by the organization to be in the public domain, to be publicly releasable, or to have limited or no adverse impact if accessed by other than authorized personnel. In these situations, it is assumed the physical access controls where the media resides provide adequate protection.

As part of a defense-in-depth strategy, the organization considers routinely encrypting information at rest on selected secondary storage devices. The employment of cryptography is at the discretion of the information owner/steward. The selection of the cryptographic mechanisms used is based upon maintaining the confidentiality and integrity of the information."
      solution    : "The ZFS file system management profile is required.

ZFS file system encryption may only be enabled on creation of the file system. If a file system must be encrypted and is not, its data should be archived, it must be removed and re-created.

First, stop running applications using the file systems, archive the data, unmount, and then remove the file system.

# umount [file system name]
# zfs destroy [file system name]

When creating ZFS file systems, ensure that they are created as encrypted file systems.

# pfexec zfs create -o encryption=on [file system name]
Enter passphrase for '[file system name]': xxxxxxx
Enter again: xxxxxxx

Store the passphrase in a safe location. The passphrase will be required to mount the file systems upon system reboot. If automated mounting is required, the passphrase must be stored in a file."
      reference   : "800-171|3.13.16,800-53|SC-28,800-53r5|SC-28,CAT|III,CCI|CCI-001199,CN-L3|8.1.4.7(b),CN-L3|8.1.4.8(b),CSF|PR.DS-1,CSF2.0|PR.DS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ITSG-33|SC-28,ITSG-33|SC-28a.,PCI-DSSv3.2.1|3.4,PCI-DSSv4.0|3.3.2,PCI-DSSv4.0|3.5.1,QCSC-v1|5.2.2,QCSC-v1|6.2,Rule-ID|SV-216176r958552_rule,STIG-ID|SOL-11.1-060160,STIG-Legacy|SV-61025,STIG-Legacy|V-48153,Vuln-ID|V-216176"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      cmd         : "/usr/sbin/zfs get -o value encryption rpool | /usr/bin/egrep -v 'off|VALUE' | /usr/bin/awk '{ print } END { if (NR != 0) print \"pass\" }'"
      expect      : "pass"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "SOL-11.1-060170 - The operating system must employ cryptographic mechanisms to prevent unauthorized disclosure of information at rest unless otherwise protected by alternative physical measures."
      info        : "When data is written to digital media, such as hard drives, mobile computers, external/removable hard drives, personal digital assistants, flash/thumb drives, etc., there is risk of data loss and data compromise.

An organizational assessment of risk guides the selection of media and associated information contained on the media requiring restricted access. Organizations need to document in policy and procedures the media requiring restricted access, individuals authorized to access the media, and the specific measures taken to restrict access.

Fewer protection measures are needed for media containing information determined by the organization to be in the public domain, to be publicly releasable, or to have limited or no adverse impact if accessed by other than authorized personnel. In these situations, it is assumed the physical access controls where the media resides provide adequate protection.

As part of a defense-in-depth strategy, the organization considers routinely encrypting information at rest on selected secondary storage devices. The employment of cryptography is at the discretion of the information owner/steward. The selection of the cryptographic mechanisms used is based upon maintaining the confidentiality and integrity of the information."
      solution    : "The ZFS file system management profile is required.

ZFS file system encryption may only be enabled on creation of the file system. If a file system must be encrypted and is not, its data should be archived, it must be removed and re-created.

First, stop running applications using the file systems, archive the data, unmount, and then remove the file system.

# umount [file system name]
# zfs destroy [file system name]

When creating ZFS file systems, ensure that they are created as encrypted file systems.

# pfexec zfs create -o encryption=on [file system name]
Enter passphrase for '[file system name]': xxxxxxx
Enter again: xxxxxxx

Store the passphrase in a safe location. The passphrase will be required to mount the file systems upon system reboot. If automated mounting is required, the passphrase must be stored in a file."
      reference   : "800-171|3.13.16,800-53|SC-28(1),800-53r5|SC-28(1),CAT|III,CCI|CCI-002475,CN-L3|8.1.4.7(b),CN-L3|8.1.4.8(b),CSF|PR.DS-1,CSF2.0|PR.DS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ITSG-33|SC-28(1),PCI-DSSv3.2.1|3.4,PCI-DSSv4.0|3.3.2,PCI-DSSv4.0|3.5.1,QCSC-v1|5.2.2,QCSC-v1|6.2,Rule-ID|SV-220011r958870_rule,STIG-ID|SOL-11.1-060170,STIG-Legacy|SV-61021,STIG-Legacy|V-48149,TBA-FIISB|28.1,Vuln-ID|V-220011"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      cmd         : "/usr/sbin/zfs get -o value encryption rpool | /usr/bin/egrep -v 'off|VALUE' | /usr/bin/awk '{ print } END { if (NR != 0) print \"pass\" }'"
      expect      : "pass"
    </custom_item>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : CMD_EXEC
          description : "Global zone auditing is configured."
          cmd         : "/usr/bin/zonename"
          expect      : "^global$"
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "SOL-11.1-060180 - The operating system must use cryptographic mechanisms to protect the integrity of audit information."
          info        : "Protection of audit records and audit data is of critical importance. Cryptographic mechanisms are the industry established standard used to protect the integrity of audit data."
          solution    : "The ZFS File System Management and ZFS Storage Management profiles are required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

The Audit Configuration and the Audit Control profiles are required.

If necessary, create a new ZFS pool to store the encrypted audit logs.

# pfexec zpool create auditp mirror [device] [device]

Create an encryption key:

# pktool genkey keystore=file outkey=/[filename] keytype=aes keylen=256

Create a new file system to store the audit logs with encryption enabled. Use the file name created in the previous step as the keystore.

# pfexec zfs create -o encryption=aes-256-ccm -o keysource=raw,file:///[filename] -o compression=on -o mountpoint=/audit auditp/auditf

Configure auditing to use this encrypted directory.

# pfexec auditconfig -setplugin audit_binfile p_dir=/audit/

Refresh the audit service for the setting to be applied:

# pfexec audit -s"
          reference   : "800-171|3.3.8,800-53|AU-9(3),800-53r5|AU-9(3),CAT|III,CCI|CCI-001350,CN-L3|8.1.4.3(d),CSF|PR.PT-1,CSF2.0|PR.DS-10,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9(3),NESA|M5.2.3,NESA|M5.5.2,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-216178r958576_rule,STIG-ID|SOL-11.1-060180,STIG-Legacy|SV-61017,STIG-Legacy|V-48145,TBA-FIISB|37.3.3,Vuln-ID|V-216178"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          cmd         : "/usr/sbin/zfs get -o value encryption rpool/VARSHARE | /usr/bin/egrep -v 'off|VALUE' | /usr/bin/awk '{ print } END { if (NR != 0) print \"pass\" }'"
          expect      : "pass"
        </custom_item>
      </then>

      <else>
        <report type:"PASSED">
          description : "SOL-11.1-060180 - The operating system must use cryptographic mechanisms to protect the integrity of audit information."
          info        : "Protection of audit records and audit data is of critical importance. Cryptographic mechanisms are the industry established standard used to protect the integrity of audit data."
          solution    : "The ZFS File System Management and ZFS Storage Management profiles are required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

The Audit Configuration and the Audit Control profiles are required.

If necessary, create a new ZFS pool to store the encrypted audit logs.

# pfexec zpool create auditp mirror [device] [device]

Create an encryption key:

# pktool genkey keystore=file outkey=/[filename] keytype=aes keylen=256

Create a new file system to store the audit logs with encryption enabled. Use the file name created in the previous step as the keystore.

# pfexec zfs create -o encryption=aes-256-ccm -o keysource=raw,file:///[filename] -o compression=on -o mountpoint=/audit auditp/auditf

Configure auditing to use this encrypted directory.

# pfexec auditconfig -setplugin audit_binfile p_dir=/audit/

Refresh the audit service for the setting to be applied:

# pfexec audit -s"
          reference   : "800-171|3.3.8,800-53|AU-9(3),800-53r5|AU-9(3),CAT|III,CCI|CCI-001350,CN-L3|8.1.4.3(d),CSF|PR.PT-1,CSF2.0|PR.DS-10,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9(3),NESA|M5.2.3,NESA|M5.5.2,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-216178r958576_rule,STIG-ID|SOL-11.1-060180,STIG-Legacy|SV-61017,STIG-Legacy|V-48145,TBA-FIISB|37.3.3,Vuln-ID|V-216178"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>
      </else>
    </if>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "SOL-11.1-060190 - The operating system must protect the integrity of transmitted information."
      info        : "Ensuring the integrity of transmitted information requires the operating system take feasible measures to employ transmission layer security. This requirement applies to communications across internal and external networks."
      solution    : "The Service Management profile is required.

Configure IPsec encrypted tunneling between two systems.

On both systems review the file /etc/inet/ipsecinit.conf. Ensure that connections between hosts are configured properly in this file per the Solaris 11 documentation.

Ensure that the IPsec policy service is online:

Enable the IPsec service:

# svcadm enable svc:/network/ipsec/policy:default"
      reference   : "800-171|3.13.8,800-53|SC-8,800-53r5|SC-8,CAT|II,CCI|CCI-002418,CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSF|PR.DS-2,CSF|PR.DS-5,CSF2.0|PR.DS-02,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ITSG-33|SC-8,ITSG-33|SC-8a.,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,Rule-ID|SV-220012r958908_rule,STIG-ID|SOL-11.1-060190,STIG-Legacy|SV-61013,STIG-Legacy|V-48141,Vuln-ID|V-220012"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      cmd         : "/usr/bin/svcs -Ho state svc:/network/ipsec/policy:default | /usr/bin/awk \'{ print } END { if (NR == 0) print \"not found\" }\'"
      expect      : "online"
    </custom_item>

    <item>
      description : "SOL-11.1-070010 - The sticky bit must be set on all world writable directories."
      info        : "Files in directories that have had the 'sticky bit' enabled can only be deleted by users that have both write permissions for the directory in which the file resides, as well as ownership of the file or directory, or have sufficient privileges. As this prevents users from overwriting each others' files, whether it be accidental or malicious, it is generally appropriate for most world-writable directories (e.g., /tmp)."
      solution    : "The root role is required.

Ensure that the 'sticky bit' is set on any directories identified during the check steps.

# chmod +t [directory name]"
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216180r959010_rule,STIG-ID|SOL-11.1-070010,STIG-Legacy|SV-61009,STIG-Legacy|V-48137,SWIFT-CSCv1|2.3,Vuln-ID|V-216180"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      name        : "find_world_writeable_directories"
    </item>

    <item>
      description : "SOL-11.1-070020 - Permissions on user home directories must be 750 or less permissive."
      info        : "Group-writable or world-writable user home directories may enable malicious users to steal or modify other users' data or to gain another user's system privileges."
      solution    : "The root role is required.

Change the permissions on users' directories to 750 or less permissive.

# chmod 750 [directory name]"
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216181r959010_rule,STIG-ID|SOL-11.1-070020,STIG-Legacy|SV-61005,STIG-Legacy|V-48133,SWIFT-CSCv1|2.3,Vuln-ID|V-216181"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      name        : "accounts_bad_home_permissions"
      mask        : "7027"
      uid_ge      : "99"
      uid_lt      : "60000"
    </item>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          system      : "SunOS"
          type        : FILE_CHECK
          description : "'.login'"
          file        : "~/.login"
          mask        : "7027"
          required    : NO
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : FILE_CHECK
          description : "'.cshrc'"
          file        : "~/.cshrc"
          mask        : "7027"
          required    : NO
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : FILE_CHECK
          description : "'.logout'"
          file        : "~/.logout"
          mask        : "7027"
          required    : NO
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : FILE_CHECK
          description : "'.profile'"
          file        : "~/.profile"
          mask        : "7027"
          required    : NO
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : FILE_CHECK
          description : "'.bash_profile'"
          file        : "~/.bash_profile"
          mask        : "7027"
          required    : NO
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : FILE_CHECK
          description : "'.bashrc'"
          file        : "~/.bashrc"
          mask        : "7027"
          required    : NO
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : FILE_CHECK
          description : "'.bash_logout'"
          file        : "~/.bash_logout"
          mask        : "7027"
          required    : NO
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : FILE_CHECK
          description : "'.env'"
          file        : "~/.env"
          mask        : "7027"
          required    : NO
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : FILE_CHECK
          description : "'.dtprofile'"
          file        : "~/.dtprofile"
          mask        : "7027"
          required    : NO
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : FILE_CHECK
          description : "'.dispatch'."
          file        : "~/.dispatch"
          mask        : "7027"
          required    : NO
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : FILE_CHECK
          description : "'.emacs'."
          file        : "~/.emacs"
          mask        : "7027"
          required    : NO
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : FILE_CHECK
          description : "'.exrc'."
          file        : "~/.exrc"
          mask        : "7027"
          required    : NO
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "SOL-11.1-070030 - Permissions on user . (hidden) files must be 750 or less permissive."
          info        : "Group-writable or world-writable user configuration files may enable malicious users to steal or modify other users' data or to gain another user's system privileges."
          solution    : "The root role is required.

Change the permissions on users' '.' files to 750 or less permissive.

# chmod 750 [file name]"
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216182r959010_rule,STIG-ID|SOL-11.1-070030,STIG-Legacy|SV-61001,STIG-Legacy|V-48129,SWIFT-CSCv1|2.3,Vuln-ID|V-216182"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CHECK
      description : "SOL-11.1-070040 - Permissions on user .netrc files must be 750 or less permissive."
      info        : ".netrc files may contain unencrypted passwords that can be used to attack other systems."
      solution    : "The root role is required.

Change the permissions on users' .netrc files to 750 or less permissive.

# chmod 750 [file name]"
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216183r959010_rule,STIG-ID|SOL-11.1-070040,STIG-Legacy|SV-60995,STIG-Legacy|V-48123,SWIFT-CSCv1|2.3,Vuln-ID|V-216183"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      file        : "~/.netrc"
      mask        : "7027"
      required    : NO
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CHECK_NOT
      description : "SOL-11.1-070050 - There must be no user .rhosts files."
      info        : "Even though the .rhosts files are ineffective if support is disabled in /etc/pam.conf, they may have been brought over from other systems and could contain information useful to an attacker for those other systems."
      solution    : "The root role is required.

Remove any .rhosts files found.

# rm [file name]"
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|I,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216184r959010_rule,STIG-ID|SOL-11.1-070050,STIG-Legacy|SV-60991,STIG-Legacy|V-48119,SWIFT-CSCv1|2.3,Vuln-ID|V-216184"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      file        : "~/.rhosts"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "SOL-11.1-070060 - Groups assigned to users must exist in the /etc/group file."
      info        : "Groups defined in passwd but not in group file pose a threat to system security since group permissions are not properly managed."
      solution    : "The root role is required.

Correct or justify any items discovered in the Audit step. Determine if any groups are in passwd but not in group, and work with those users or group owners to determine the best course of action in accordance with site policy."
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216185r959010_rule,STIG-ID|SOL-11.1-070060,STIG-Legacy|SV-60987,STIG-Legacy|V-48115,SWIFT-CSCv1|2.3,Vuln-ID|V-216185"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      cmd         : "/usr/bin/logins -xo | /usr/bin/awk -F: '($3 == \"\") { print $1 }' | /usr/bin/awk '{ print } END { if (NR == 0) print \"pass\" }'"
      expect      : "pass"
    </custom_item>

    <item>
      description : "SOL-11.1-070070 - Users must have a valid home directory assignment."
      info        : "All users must be assigned a home directory in the passwd file. Failure to have a home directory may result in the user being put in the root directory."
      solution    : "The root role is required.

Correct or justify any items discovered in the check step. Determine if there exists any users who are in passwd but do not have a home directory, and work with those users to determine the best course of action in accordance with site policy.  This generally means deleting the user or creating a valid home directory."
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216186r959010_rule,STIG-ID|SOL-11.1-070070,STIG-Legacy|SV-60981,STIG-Legacy|V-48109,SWIFT-CSCv1|2.3,Vuln-ID|V-216186"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      name        : "accounts_without_home_dir"
    </item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "SOL-11.1-070080 - All user accounts must be configured to use a home directory that exists."
      info        : "If the user's home directory does not exist, the user will be placed in '/' and will not be able to write any files or have local environment variables set.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "The root role is required.

Work with users identified in the check step to determine the best course of action in accordance with site policy. This generally means deleting the user account or creating a valid home directory."
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216187r959010_rule,STIG-ID|SOL-11.1-070080,STIG-Legacy|SV-60977,STIG-Legacy|V-48105,SWIFT-CSCv1|2.3,Vuln-ID|V-216187"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      cmd         : "/usr/sbin/pwck 2>&1 | /usr/bin/awk '{ print } END { if (NR == 0) print \"pass\" }'"
      expect      : "^pass$"
      severity    : MEDIUM
    </custom_item>

    <item>
      description : "SOL-11.1-070090 - All home directories must be owned by the respective user assigned to it in /etc/passwd."
      info        : "Since the user is accountable for files stored in the user's home directory, the user must be the owner of the directory."
      solution    : "The root role is required.

Correct the owner of any directory that does not match the password file entry for that user.

# chown [user] [home directory]"
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216188r959010_rule,STIG-ID|SOL-11.1-070090,STIG-Legacy|SV-60969,STIG-Legacy|V-48097,SWIFT-CSCv1|2.3,Vuln-ID|V-216188"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      name        : "accounts_bad_home_permissions"
    </item>

    <item>
      description : "SOL-11.1-070100 - Duplicate User IDs (UIDs) must not exist for users within the organization."
      info        : "Users within the organization must be assigned unique UIDs for accountability and to ensure appropriate access protections."
      solution    : "The root role is required.

Determine if there exists any users who share a common UID, and work with those users to determine the best course of action in accordance with site policy.
Change user account names and UID or delete accounts, so each account has a unique name and UID."
      reference   : "800-171|3.5.1,800-53|IA-2,800-53r5|IA-2,CAT|II,CCI|CCI-000764,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-216189r958482_rule,STIG-ID|SOL-11.1-070100,STIG-Legacy|SV-60967,STIG-Legacy|V-48095,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-216189"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      name        : "passwd_duplicate_uid"
    </item>

    <item>
      description : "SOL-11.1-070110 - Duplicate UIDs must not exist for multiple non-organizational users."
      info        : "Non-organizational users must be assigned unique UIDs for accountability and to ensure appropriate access protections."
      solution    : "The root role is required.

Determine if there exists any users who share a common UID, and work with those users to determine the best course of action in accordance with site policy.
Change user account names and UID or delete accounts, so each account has a unique name and UID."
      reference   : "800-53|IA-8,800-53r5|IA-8,CAT|II,CCI|CCI-000804,CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-8,ITSG-33|IA-8a.,NESA|T4.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-216190r958504_rule,STIG-ID|SOL-11.1-070110,STIG-Legacy|SV-60963,STIG-Legacy|V-48091,SWIFT-CSCv1|2.8,Vuln-ID|V-216190"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      name        : "passwd_duplicate_uid"
    </item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "SOL-11.1-070120 - Duplicate Group IDs (GIDs) must not exist for multiple groups."
      info        : "User groups must be assigned unique GIDs for accountability and to ensure appropriate access protections."
      solution    : "The root role is required.

Work with each respective group owner to remediate this issue and ensure that the group ownership of their files are set to an appropriate value."
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216191r959010_rule,STIG-ID|SOL-11.1-070120,STIG-Legacy|SV-60953,STIG-Legacy|V-48081,SWIFT-CSCv1|2.3,Vuln-ID|V-216191"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      cmd         : "/usr/bin/getent group | /usr/bin/cut -f3 -d\":\" | /usr/bin/sort -n | /usr/bin/uniq -c | while read x ; do [ -z \"${x}\" ] && break; set - $x; if [ $1 -gt 1 ]; then grps=`getent group | /usr/bin/nawk -F: '($3 == n) { print $1 }' n=$2 | xargs`; echo \"Duplicate GID ($2): ${grps}\"; fi; done | /usr/bin/awk '{ print } END { if (NR == 0) print \"pass\" }'"
      expect      : "pass"
    </custom_item>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : CMD_EXEC
          description : "Check if Solaris 11.4 or higher"
          cmd         : "/usr/bin/uname -v"
          expect      : "11\\.[4-9]"
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "SOL-11.1-070130 - Reserved UIDs 0-99 must only be used by system accounts."
          info        : "If a user is assigned a UID that is in the reserved range, even if it is not presently in use, security exposures can arise if a subsequently installed application uses the same UID."
          solution    : "The root role is required.

Correct or justify any items discovered in the Check step. Determine if there are any accounts using these reserved UIDs, and work with their owners to determine the best course of action in accordance with site policy. This may require deleting users or changing UIDs for users."
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216192r959010_rule,STIG-ID|SOL-11.1-070130,STIG-Legacy|SV-60949,STIG-Legacy|V-48077,SWIFT-CSCv1|2.3,Vuln-ID|V-216192"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          cmd         : "/usr/bin/logins -so | /usr/bin/awk -F: '{ print $1 }' | while read user; do found=0; for tUser in root daemon bin sys adm dladm netadm netcfg sshd smmsp gdm zfssnap aiuser _polkitd ikeuser lp openldap webservd unknown uucp nuucp upnp xvm mysql postgres svctag pkg5srv nobody noaccess nobody4 _ntp; do if [ ${user} = ${tUser} ]; then found=1; fi; done; if [ $found -eq 0 ]; then echo \"Invalid User with Reserved UID: ${user}\"; fi; done | /usr/bin/awk '{print} END {if (NR == 0) print \"No invalid users found\"; else print \"fail\"}'"
          expect      : "^No invalid users found$"
        </custom_item>
      </then>

      <else>
        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "SOL-11.1-070130 - Reserved UIDs 0-99 must only be used by system accounts."
          info        : "If a user is assigned a UID that is in the reserved range, even if it is not presently in use, security exposures can arise if a subsequently installed application uses the same UID."
          solution    : "The root role is required.

Correct or justify any items discovered in the Check step. Determine if there are any accounts using these reserved UIDs, and work with their owners to determine the best course of action in accordance with site policy. This may require deleting users or changing UIDs for users."
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216192r959010_rule,STIG-ID|SOL-11.1-070130,STIG-Legacy|SV-60949,STIG-Legacy|V-48077,SWIFT-CSCv1|2.3,Vuln-ID|V-216192"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          cmd         : "/usr/bin/logins -so | /usr/bin/awk -F: '{ print $1 }' | while read user; do found=0; for tUser in root daemon bin sys adm dladm netadm netcfg ftp dhcpserv sshd smmsp gdm zfssnap aiuser polkitd ikeuser lp openldap webservd unknown uucp nuucp upnp xvm mysql postgres svctag pkg5srv nobody noaccess nobody4; do if [ ${user} = ${tUser} ]; then found=1 ; fi; done; if [ $found -eq 0 ]; then echo \"Invalid User with Reserved UID: ${user}\"; fi; done | /usr/bin/awk '{print} END {if (NR == 0) print \"No invalid users found\"; else print \"fail\"}'"
          expect      : "^No invalid users found$"
        </custom_item>
      </else>
    </if>

    <item>
      description : "SOL-11.1-070140 - Duplicate user names must not exist."
      info        : "If a user is assigned a duplicate user name, it will create and have access to files with the first UID for that username in passwd."
      solution    : "The root role is required.

Correct or justify any items discovered in the Check step. Determine if there are any duplicate user names, and work with their respective owners to determine the best course of action in accordance with site policy. Delete or change the user name of duplicate users."
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216193r959010_rule,STIG-ID|SOL-11.1-070140,STIG-Legacy|SV-60945,STIG-Legacy|V-48073,SWIFT-CSCv1|2.3,Vuln-ID|V-216193"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      name        : "passwd_duplicate_username"
    </item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "SOL-11.1-070150 - Duplicate group names must not exist."
      info        : "If a group is assigned a duplicate group name, it will create and have access to files with the first GID for that group in group. Effectively, the GID is shared, which is a security risk."
      solution    : "The root role is required.

Correct or justify any items discovered in the Check step. Determine if there are any duplicate group names, and work with their respective owners to determine the best course of action in accordance with site policy. Delete or change the group name of duplicate groups."
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216194r959010_rule,STIG-ID|SOL-11.1-070150,STIG-Legacy|SV-60941,STIG-Legacy|V-48069,SWIFT-CSCv1|2.3,Vuln-ID|V-216194"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      cmd         : "/usr/bin/getent group | /usr/bin/cut -f1 -d':' | /usr/bin/sort -n | /usr/bin/uniq -d | /usr/bin/awk '{ print } END { if (NR == 0) print \"No duplicate groups found\" }'"
      expect      : "No duplicate groups found"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CHECK_NOT
      description : "SOL-11.1-070160 - User .netrc files must not exist."
      info        : "The .netrc file presents a significant security risk since it stores passwords in unencrypted form."
      solution    : "The root role is required.

Determine if any .netrc files exist, and work with the owners to determine the best course of action in accordance with site policy."
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216195r959010_rule,STIG-ID|SOL-11.1-070160,STIG-Legacy|SV-60939,STIG-Legacy|V-48067,SWIFT-CSCv1|2.3,Vuln-ID|V-216195"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      file        : "~/.netrc"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CHECK_NOT
      description : "SOL-11.1-070170 - The system must not allow users to configure .forward files."
      info        : "Use of the .forward file poses a security risk in that sensitive data may be inadvertently transferred outside the organization. The .forward file also poses a secondary risk as it can be used to execute commands that may perform unintended actions."
      solution    : "The root role is required.

Remove any .forward files that are found.

# pfexec rm [filename]"
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216196r959010_rule,STIG-ID|SOL-11.1-070170,STIG-Legacy|SV-60937,STIG-Legacy|V-48065,SWIFT-CSCv1|2.3,Vuln-ID|V-216196"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      file        : "~/.forward"
    </custom_item>

    <item>
      description : "SOL-11.1-070180 - World-writable files must not exist."
      info        : "Data in world-writable files can be read, modified, and potentially compromised by any user on the system. World-writable files may also indicate an incorrectly written script or program that could potentially be the cause of a larger compromise to the system's integrity."
      solution    : "The root role is required.

Change the permissions of the files identified in the check step to remove the world-writable permission.

# pfexec chmod o-w [filename]"
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216197r959010_rule,STIG-ID|SOL-11.1-070180,STIG-Legacy|SV-60935,STIG-Legacy|V-48063,SWIFT-CSCv1|2.3,Vuln-ID|V-216197"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      name        : "find_world_writeable_directories"
    </item>

    <item>
      description : "SOL-11.1-070190 - All valid SUID/SGID files must be documented."
      info        : "There are valid reasons for SUID/SGID programs, but it is important to identify and review such programs to ensure they are legitimate.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "The root role is required.

Determine the existence of any set-UID programs that do not belong on the system, and work with the owners (or system administrator) to determine the best course of action in accordance with site policy."
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216198r959010_rule,STIG-ID|SOL-11.1-070190,STIG-Legacy|SV-60931,STIG-Legacy|V-48059,SWIFT-CSCv1|2.3,Vuln-ID|V-216198"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      name        : "find_suid_sgid_files"
      severity    : MEDIUM
    </item>

    <item>
      description : "SOL-11.1-070200 - The operating system must have no unowned files."
      info        : "A new user who is assigned a deleted user's user ID or group ID may then end up owning these files, and thus have more access on the system than was intended."
      solution    : "The root role is required.

Correct or justify any items discovered in the Check step. Determine the existence of any files that are not attributed to current users or groups on the system, and determine the best course of action in accordance with site policy. Remove the files and directories or change their ownership."
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216199r959010_rule,STIG-ID|SOL-11.1-070200,STIG-Legacy|SV-60911,STIG-Legacy|V-48039,SWIFT-CSCv1|2.3,Vuln-ID|V-216199"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      name        : "find_orphan_files"
    </item>

    <custom_item>
      type        : FIND_CMD
      description : "SOL-11.1-070210 - The operating system must have no files with extended attributes."
      info        : "Attackers or malicious users could hide information, exploits, etc. in extended attribute areas. Since extended attributes are rarely used, it is important to find files with extended attributes set and correct these attributes."
      solution    : "The root role is required.

Correct or justify any items discovered in the Check step. Determine the existence of any files having extended file attributes, and determine the best course of action in accordance with site policy.

Remove the files or the extended attributes."
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216200r959010_rule,STIG-ID|SOL-11.1-070210,STIG-Legacy|SV-60909,STIG-Legacy|V-48037,SWIFT-CSCv1|2.3,Vuln-ID|V-216200"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      not_expect  : ".+"
      exec        : "runat '{}' ls -al \\;"
      print       : YES
      xattr       : YES
    </custom_item>

    <item>
      description : "SOL-11.1-070220 - The root account must be the only account with GID of 0."
      info        : "All accounts with a GID of 0 have root group privileges and must be limited to the group account only."
      solution    : "The root role is required.

Change the default GID of non-root accounts to a valid GID other than 0."
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216201r959010_rule,STIG-ID|SOL-11.1-070220,STIG-Legacy|SV-60907,STIG-Legacy|V-48035,SWIFT-CSCv1|2.3,Vuln-ID|V-216201"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      name        : "passwd_zero_uid"
    </item>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          system      : "SunOS"
          type        : FILE_CHECK
          description : "'/var/adm/messages owner'"
          file        : "/var/adm/messages"
          owner       : "root"
          mask        : "7137"
          group       : "root"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : FILE_CHECK
          description : "/var/adm owner"
          file        : "/var/adm"
          owner       : "root"
          mask        : "7027"
          group       : "sys"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "SOL-11.1-070240 - The operating system must reveal error messages only to authorized personnel."
          info        : "Proper file permissions and ownership ensures that only designated personnel in the organization can access error messages."
          solution    : "The root role is required.

Change the permissions and owner on the /var/adm/messages file:

# chmod 640 /var/adm/messages
# chown root /var/adm/messages
# chgrp root /var/adm/messages

Change the permissions and owner on the /var/adm directory:

# chmod 750 /var/adm
# chown root /var/adm
# chgrp sys /var/adm"
          reference   : "800-53|SI-11b.,800-53r5|SI-11b.,CAT|III,CCI|CCI-001314,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-11c.,Rule-ID|SV-216202r958566_rule,STIG-ID|SOL-11.1-070240,STIG-Legacy|SV-60905,STIG-Legacy|V-48033,Vuln-ID|V-216202"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : CMD_EXEC
          description : "Global zone auditing is configured."
          cmd         : "/usr/bin/zonename"
          expect      : "^global$"
        </custom_item>
      </condition>

      <then>
        <if>
          <condition auto:"FAILED" type:"AND">
            <custom_item>
              system      : "SunOS"
              type        : FILE_CHECK
              description : "AUDIT_FILES"
              file        : "@AUDIT_FILES@"
              mask        : "7137"
            </custom_item>

            <custom_item>
              system      : "SunOS"
              type        : FILE_CHECK
              description : "AUDIT_FILE_DIR"
              file        : "@AUDIT_FILE_DIR@"
              mask        : "7027"
            </custom_item>
          </condition>

          <then>
            <report type:"PASSED">
              description : "SOL-11.1-070250 - The operating system must protect the audit records resulting from non-local accesses to privileged accounts and the execution of privileged functions."
              info        : "Protection of audit records and audit data is of critical importance. Care must be taken to ensure privileged users cannot circumvent audit protections put in place. Auditing might not be reliable when performed by an operating system which the user being audited has privileged access to. The privileged user could inhibit auditing or directly modify audit records. To prevent this from occurring, privileged access shall be further defined between audit-related privileges and other privileges, thus limiting the users with audit-related privileges."
              solution    : "The root role is required.

Determine the location of the local audit trail files.

# pfexec auditconfig -getplugin audit_binfile
Plugin: audit_binfile (active)
Attributes: p_dir=/var/audit;p_fsize=4M;p_minfree=1

In this example, the audit files can be found in /var/audit.

Change the permissions on the audit trail files and the audit directory.

# chmod 640 /var/share/audit/*

# chmod 750 /var/share/audit

Note:  The default Solaris 11 location for /var/audit is a link to /var/share/audit."
              reference   : "800-171|3.1.7,800-53|AC-6(9),800-53r5|AC-6(9),CAT|II,CCI|CCI-002234,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,CSF2.0|PR.AA-05,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.12.4.3,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.5.4,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,Rule-ID|SV-220013r958732_rule,STIG-ID|SOL-11.1-070250,STIG-Legacy|SV-60903,STIG-Legacy|V-48031,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,Vuln-ID|V-220013"
              see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
              show_output : YES
            </report>
          </then>
        </if>
      </then>

      <else>
        <report type:"PASSED">
          description : "SOL-11.1-070250 - The operating system must protect the audit records resulting from non-local accesses to privileged accounts and the execution of privileged functions."
          info        : "Protection of audit records and audit data is of critical importance. Care must be taken to ensure privileged users cannot circumvent audit protections put in place. Auditing might not be reliable when performed by an operating system which the user being audited has privileged access to. The privileged user could inhibit auditing or directly modify audit records. To prevent this from occurring, privileged access shall be further defined between audit-related privileges and other privileges, thus limiting the users with audit-related privileges."
          solution    : "The root role is required.

Determine the location of the local audit trail files.

# pfexec auditconfig -getplugin audit_binfile
Plugin: audit_binfile (active)
Attributes: p_dir=/var/audit;p_fsize=4M;p_minfree=1

In this example, the audit files can be found in /var/audit.

Change the permissions on the audit trail files and the audit directory.

# chmod 640 /var/share/audit/*

# chmod 750 /var/share/audit

Note:  The default Solaris 11 location for /var/audit is a link to /var/share/audit."
          reference   : "800-171|3.1.7,800-53|AC-6(9),800-53r5|AC-6(9),CAT|II,CCI|CCI-002234,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,CSF2.0|PR.AA-05,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.12.4.3,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.5.4,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,Rule-ID|SV-220013r958732_rule,STIG-ID|SOL-11.1-070250,STIG-Legacy|SV-60903,STIG-Legacy|V-48031,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,Vuln-ID|V-220013"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>
      </else>
    </if>

    <custom_item>
      type        : FIND_CMD
      description : "SOL-11.1-070260 - The operator must document all file system objects that have non-standard access control list settings."
      info        : "Access Control Lists allow an object owner to expand permissions on an object to specific users and groups in addition to the standard permission model. Non-standard Access Control List settings can allow unauthorized users to modify critical files."
      solution    : "The root role is required.

Remove ACLs that are not approved in the security policy.

For ZFS file systems, remove all extended ACLs with the following command:

# chmod A- [filename]

For UFS file systems

Determine the ACLs that are set on a file:

# getfacl [filename]

Remove any ACL configurations that are set:

# setfacl -d [ACL] [filename]"
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216204r959010_rule,STIG-ID|SOL-11.1-070260,STIG-Legacy|SV-60901,STIG-Legacy|V-48029,SWIFT-CSCv1|2.3,Vuln-ID|V-216204"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      not_expect  : ".+"
      exec        : "ls -lL '{}' \\;"
      find_acl    : YES
    </custom_item>

    <custom_item>
      system        : "SunOS"
      type          : CMD_EXEC
      description   : "SOL-11.1-080010 - The operating system must be a supported release."
      info          : "An operating system release is considered supported if the vendor continues to provide security patches for the product. With an unsupported release, it will not be possible to resolve security issues discovered in the system software."
      solution      : "Upgrade to a supported version of the operating system."
      reference     : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|I,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216205r959010_rule,STIG-ID|SOL-11.1-080010,STIG-Legacy|SV-60899,STIG-Legacy|V-48027,SWIFT-CSCv1|2.3,Vuln-ID|V-216205"
      see_also      : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      cmd           : "/usr/bin/uname -a | /usr/bin/awk '{print$3}'"
      expect        : "5\\.11"
      dont_echo_cmd : YES
    </custom_item>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : CMD_EXEC
          description : "Global zone auditing is configured."
          cmd         : "/usr/bin/zonename"
          expect      : "^global$"
        </custom_item>
      </condition>

      <then>
        <if>
          <condition type:"OR">
            <custom_item>
              type        : CMD_EXEC
              description : "Check if Solaris 11.3 or higher"
              cmd         : "/usr/bin/uname -v"
              expect      : "11\\.[3-9]"
            </custom_item>
          </condition>

          <then>
            <custom_item>
              system      : "SunOS"
              type        : CMD_EXEC
              description : "SOL-11.1-080020 - The system must implement non-executable program stacks."
              info        : "A common type of exploit is the stack buffer overflow. An application receives, from an attacker, more data than it is prepared for and stores this information on its stack, writing beyond the space reserved for it. This can be designed to cause execution of the data written on the stack. One mechanism to mitigate this vulnerability is for the system to not allow the execution of instructions in sections of memory identified as part of the stack."
              solution    : "The root role is required.

Determine the OS version you are currently securing.

# uname -v

If the OS version is 11.3 or newer, enable non-executable program stacks using the 'sxadm' command.

# pfexec sxadm enable nxstack

For Solaris 11, 11.1, and 11.2, this action applies to the global zone only and the '/etc/system' file is updated. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', modify the '/etc/system' file.

# pfedit /etc/system

add the line:

set noexec_user_stack=1

Solaris 11, 11.1, and 11.2 systems will need to be restarted for the setting to take effect."
              reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216206r959010_rule,STIG-ID|SOL-11.1-080020,STIG-Legacy|SV-60897,STIG-Legacy|V-48025,SWIFT-CSCv1|2.3,Vuln-ID|V-216206"
              see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
              cmd         : "/usr/sbin/sxadm status -p nxstack | /usr/bin/cut -d: -f2"
              expect      : "enabled.all"
            </custom_item>
          </then>

          <else>
            <custom_item>
              system      : "SunOS"
              type        : FILE_CONTENT_CHECK
              description : "SOL-11.1-080020 - The system must implement non-executable program stacks."
              info        : "A common type of exploit is the stack buffer overflow. An application receives, from an attacker, more data than it is prepared for and stores this information on its stack, writing beyond the space reserved for it. This can be designed to cause execution of the data written on the stack. One mechanism to mitigate this vulnerability is for the system to not allow the execution of instructions in sections of memory identified as part of the stack."
              solution    : "The root role is required.

Determine the OS version you are currently securing.

# uname -v

If the OS version is 11.3 or newer, enable non-executable program stacks using the 'sxadm' command.

# pfexec sxadm enable nxstack

For Solaris 11, 11.1, and 11.2, this action applies to the global zone only and the '/etc/system' file is updated. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', modify the '/etc/system' file.

# pfedit /etc/system

add the line:

set noexec_user_stack=1

Solaris 11, 11.1, and 11.2 systems will need to be restarted for the setting to take effect."
              reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216206r959010_rule,STIG-ID|SOL-11.1-080020,STIG-Legacy|SV-60897,STIG-Legacy|V-48025,SWIFT-CSCv1|2.3,Vuln-ID|V-216206"
              see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
              file        : "/etc/system"
              regex       : "^[\\s]*set[\\s]+noexec_user_stack[\\s]*="
              expect      : "^[\\s]*set[\\s]+noexec_user_stack[\\s]*=[\\s]*1[\\s]*$"
            </custom_item>
          </else>
        </if>

        <if>
          <condition type:"AND">
            <custom_item>
              type        : CMD_EXEC
              description : "Check if Solaris 11.4 or higher"
              cmd         : "/usr/bin/uname -v"
              expect      : "11\\.[4-9]"
            </custom_item>
          </condition>

          <then>
            <custom_item>
              system      : "SunOS"
              type        : CMD_EXEC
              description : "SOL-11.1-080030 - Address Space Layout Randomization (ASLR) must be enabled."
              info        : "Modification of memory area can result in executable code vulnerabilities. ASLR can reduce the likelihood of these attacks. ASLR activates the randomization of key areas of the process such as stack, brk-based heap, memory mappings, and so forth."
              solution    : "The root role is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

Enable address space layout randomization.

# sxadm delcust aslr

Enabling ASLR may affect the function or stability of some applications, including those that use Solaris Intimate Shared Memory features."
              reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216207r959010_rule,STIG-ID|SOL-11.1-080030,STIG-Legacy|SV-60895,STIG-Legacy|V-48023,SWIFT-CSCv1|2.3,Vuln-ID|V-216207"
              see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
              cmd         : "/usr/sbin/sxadm status -p -o status aslr | /usr/bin/grep enabled | /usr/bin/awk '{ print } END { if (NR != 0) print \"pass\" }'"
              expect      : "pass"
            </custom_item>
          </then>

          <else>
            <custom_item>
              system      : "SunOS"
              type        : CMD_EXEC
              description : "SOL-11.1-080030 - Address Space Layout Randomization (ASLR) must be enabled."
              info        : "Modification of memory area can result in executable code vulnerabilities. ASLR can reduce the likelihood of these attacks. ASLR activates the randomization of key areas of the process such as stack, brk-based heap, memory mappings, and so forth."
              solution    : "The root role is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

Enable address space layout randomization.

# sxadm delcust aslr

Enabling ASLR may affect the function or stability of some applications, including those that use Solaris Intimate Shared Memory features."
              reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216207r959010_rule,STIG-ID|SOL-11.1-080030,STIG-Legacy|SV-60895,STIG-Legacy|V-48023,SWIFT-CSCv1|2.3,Vuln-ID|V-216207"
              see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
              cmd         : "/usr/sbin/sxadm info -p | /usr/bin/grep aslr | /usr/bin/grep enabled | /usr/bin/awk '{ print } END { if (NR != 0) print \"pass\" }'"
              expect      : "pass"
            </custom_item>
          </else>
        </if>
      </then>

      <else>
        <report type:"PASSED">
          description : "SOL-11.1-080020 - The system must implement non-executable program stacks."
          info        : "A common type of exploit is the stack buffer overflow. An application receives, from an attacker, more data than it is prepared for and stores this information on its stack, writing beyond the space reserved for it. This can be designed to cause execution of the data written on the stack. One mechanism to mitigate this vulnerability is for the system to not allow the execution of instructions in sections of memory identified as part of the stack."
          solution    : "The root role is required.

Determine the OS version you are currently securing.

# uname -v

If the OS version is 11.3 or newer, enable non-executable program stacks using the 'sxadm' command.

# pfexec sxadm enable nxstack

For Solaris 11, 11.1, and 11.2, this action applies to the global zone only and the '/etc/system' file is updated. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', modify the '/etc/system' file.

# pfedit /etc/system

add the line:

set noexec_user_stack=1

Solaris 11, 11.1, and 11.2 systems will need to be restarted for the setting to take effect."
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216206r959010_rule,STIG-ID|SOL-11.1-080020,STIG-Legacy|SV-60897,STIG-Legacy|V-48025,SWIFT-CSCv1|2.3,Vuln-ID|V-216206"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-080030 - Address Space Layout Randomization (ASLR) must be enabled."
          info        : "Modification of memory area can result in executable code vulnerabilities. ASLR can reduce the likelihood of these attacks. ASLR activates the randomization of key areas of the process such as stack, brk-based heap, memory mappings, and so forth."
          solution    : "The root role is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

Enable address space layout randomization.

# sxadm delcust aslr

Enabling ASLR may affect the function or stability of some applications, including those that use Solaris Intimate Shared Memory features."
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216207r959010_rule,STIG-ID|SOL-11.1-080030,STIG-Legacy|SV-60895,STIG-Legacy|V-48023,SWIFT-CSCv1|2.3,Vuln-ID|V-216207"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>
      </else>
    </if>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "SOL-11.1-080040 - Process core dumps must be disabled unless needed."
      info        : "Process core dumps contain the memory in use by the process when it crashed. Process core dump files can be of significant size and their use can result in file systems filling to capacity, which may result in denial of service. Process core dumps can be useful for software debugging."
      solution    : "The Maintenance and Repair profile is required.

Change the process core dump configuration to disable core dumps globally and on a per process basis.

# coreadm -d global
# coreadm -d process
# coreadm -d global-setid
# coreadm -d proc-setid
# coreadm -e log"
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216208r959010_rule,STIG-ID|SOL-11.1-080040,STIG-Legacy|SV-60893,STIG-Legacy|V-48021,SWIFT-CSCv1|2.3,Vuln-ID|V-216208"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      cmd         : "/usr/bin/coreadm | /usr/bin/grep enabled | /usr/bin/awk '{ print } END { if (NR == 0) print \"pass\" }'"
      expect      : "pass"
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "SOL-11.1-080045 - The system must be configured to store any process core dumps in a specific, centralized directory."
      info        : "Specifying a centralized location for core file creation allows for the centralized protection of core files. Process core dumps contain the memory in use by the process when it crashed. Any data the process was handling may be contained in the core file, and it must be protected accordingly. If process core dump creation is not configured to use a centralized directory, core dumps may be created in a directory that does not have appropriate ownership or permissions configured, which could result in unauthorized access to the core dumps."
      solution    : "The root role is required.

Set the core file directory and file pattern.

# coreadm -g /var/share/cores/core.%f.%p"
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216209r959010_rule,STIG-ID|SOL-11.1-080045,STIG-Legacy|SV-104855,STIG-Legacy|V-95717,SWIFT-CSCv1|2.3,Vuln-ID|V-216209"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      cmd         : "/usr/bin/coreadm | grep 'global core file pattern'"
      expect      : "^[\\s]*global core file pattern:[\\s]*/.*"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CHECK
      description : "SOL-11.1-080050 - The centralized process core dump data directory must be owned by root."
      info        : "Process core dumps contain the memory in use by the process when it crashed. Any data the process was handling may be contained in the core file, and it must be protected accordingly. If the centralized process core dump data directory is not owned by root, the core dumps contained in the directory may be subject to unauthorized access."
      solution    : "The root role is required.

Change the owner of the core file directory.

# chown root [core file directory]"
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216210r959010_rule,STIG-ID|SOL-11.1-080050,STIG-Legacy|SV-60891,STIG-Legacy|V-48019,SWIFT-CSCv1|2.3,Vuln-ID|V-216210"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      file        : "@CORE_FILE_DIR@"
      owner       : "root"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CHECK
      description : "SOL-11.1-080060 - The centralized process core dump data directory must be group-owned by root, bin, or sys."
      info        : "Process core dumps contain the memory in use by the process when it crashed. Any data the process was handling may be contained in the core file, and it must be protected accordingly. If the centralized process core dump data directory is not group-owned by a system group, the core dumps contained in the directory may be subject to unauthorized access."
      solution    : "The root role is required.

Change the group-owner of the core file directory to root, bin or sys.

Example: # chgrp root [core file directory]"
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216211r959010_rule,STIG-ID|SOL-11.1-080060,STIG-Legacy|SV-60889,STIG-Legacy|V-48017,SWIFT-CSCv1|2.3,Vuln-ID|V-216211"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      file        : "@CORE_FILE_DIR@"
      group       : "root" || "sys" || "bin"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CHECK
      description : "SOL-11.1-080070 - The centralized process core dump data directory must have mode 0700 or less permissive."
      info        : "Process core dumps contain the memory in use by the process when it crashed. Any data the process was handling may be contained in the core file, and it must be protected accordingly. If the process core dump data directory has a mode more permissive than 0700, unauthorized users may be able to view or to modify sensitive information contained in any process core dumps in the directory."
      solution    : "The root role is required.

Change the mode of the core file directory.

# chmod 0700 [core file directory]"
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216212r959010_rule,STIG-ID|SOL-11.1-080070,STIG-Legacy|SV-60887,STIG-Legacy|V-48015,SWIFT-CSCv1|2.3,Vuln-ID|V-216212"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      file        : "@CORE_FILE_DIR@"
      mask        : "7077"
    </custom_item>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : CMD_EXEC
          description : "Global zone auditing is configured."
          cmd         : "/usr/bin/zonename"
          expect      : "^global$"
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "SOL-11.1-080080 - Kernel core dumps must be disabled unless needed."
          info        : "Kernel core dumps may contain the full contents of system memory at the time of the crash. Kernel core dumps may consume a considerable amount of disk space and may result in denial of service by exhausting the available space on the target file system. The kernel core dump process may increase the amount of time a system is unavailable due to a crash. Kernel core dumps can be useful for kernel debugging."
          solution    : "The root role is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

Disable savecore.

# dumpadm -n"
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216213r959010_rule,STIG-ID|SOL-11.1-080080,STIG-Legacy|SV-60885,STIG-Legacy|V-48013,SWIFT-CSCv1|2.3,Vuln-ID|V-216213"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          cmd         : "/usr/sbin/dumpadm | /usr/bin/grep 'Savecore enabled' | /usr/bin/awk '{ print } END { if (NR == 0) print \"pass\" }'"
          expect      : "pass"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : FILE_CHECK
          description : "SOL-11.1-080090 - The kernel core dump data directory must be owned by root."
          info        : "Kernel core dumps may contain the full contents of system memory at the time of the crash. As the system memory may contain sensitive information, it must be protected accordingly. If the kernel core dump data directory is not owned by root, the core dumps contained in the directory may be subject to unauthorized access."
          solution    : "The root role is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

Determine the location of the system dump directory.

# dumpadm | grep directory

Change the owner of the kernel core dump data directory to root.

# chown root [savecore directory]

In Solaris 11, /var/crash is linked to /var/share/crash."
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216214r959010_rule,STIG-ID|SOL-11.1-080090,STIG-Legacy|SV-60883,STIG-Legacy|V-48011,SWIFT-CSCv1|2.3,Vuln-ID|V-216214"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          file        : "/var/share/crash"
          owner       : "root"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : FILE_CHECK
          description : "SOL-11.1-080100 - The kernel core dump data directory must be group-owned by root."
          info        : "Kernel core dumps may contain the full contents of system memory at the time of the crash. As the system memory may contain sensitive information, it must be protected accordingly. If the kernel core dump data directory is not group-owned by a system group, the core dumps contained in the directory may be subject to unauthorized access."
          solution    : "The root role is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

Determine the location of the system dump directory.

# dumpadm | grep directory

Change the group-owner of the kernel core dump data directory.

# chgrp root [kernel core dump data directory]

In Solaris 11, /var/crash is linked to /var/share/crash."
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216215r959010_rule,STIG-ID|SOL-11.1-080100,STIG-Legacy|SV-60881,STIG-Legacy|V-48009,SWIFT-CSCv1|2.3,Vuln-ID|V-216215"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          file        : "/var/share/crash"
          group       : "root"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : FILE_CHECK
          description : "SOL-11.1-080110 - The kernel core dump data directory must have mode 0700 or less permissive."
          info        : "Kernel core dumps may contain the full contents of system memory at the time of the crash. As the system memory may contain sensitive information, it must be protected accordingly. If the mode of the kernel core dump data directory is more permissive than 0700, unauthorized users may be able to view or to modify kernel core dump data files."
          solution    : "The root role is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

Determine the location of the system dump directory.

# dumpadm | grep directory

Change the group-owner of the kernel core dump data directory.

# chmod 0700 [savecore directory]"
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216216r959010_rule,STIG-ID|SOL-11.1-080110,STIG-Legacy|SV-60879,STIG-Legacy|V-48007,SWIFT-CSCv1|2.3,Vuln-ID|V-216216"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          file        : "/var/share/crash"
          mask        : "7077"
        </custom_item>
      </then>

      <else>
        <report type:"PASSED">
          description : "SOL-11.1-080080 - Kernel core dumps must be disabled unless needed."
          info        : "Kernel core dumps may contain the full contents of system memory at the time of the crash. Kernel core dumps may consume a considerable amount of disk space and may result in denial of service by exhausting the available space on the target file system. The kernel core dump process may increase the amount of time a system is unavailable due to a crash. Kernel core dumps can be useful for kernel debugging."
          solution    : "The root role is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

Disable savecore.

# dumpadm -n"
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216213r959010_rule,STIG-ID|SOL-11.1-080080,STIG-Legacy|SV-60885,STIG-Legacy|V-48013,SWIFT-CSCv1|2.3,Vuln-ID|V-216213"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-080090 - The kernel core dump data directory must be owned by root."
          info        : "Kernel core dumps may contain the full contents of system memory at the time of the crash. As the system memory may contain sensitive information, it must be protected accordingly. If the kernel core dump data directory is not owned by root, the core dumps contained in the directory may be subject to unauthorized access."
          solution    : "The root role is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

Determine the location of the system dump directory.

# dumpadm | grep directory

Change the owner of the kernel core dump data directory to root.

# chown root [savecore directory]

In Solaris 11, /var/crash is linked to /var/share/crash."
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216214r959010_rule,STIG-ID|SOL-11.1-080090,STIG-Legacy|SV-60883,STIG-Legacy|V-48011,SWIFT-CSCv1|2.3,Vuln-ID|V-216214"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-080100 - The kernel core dump data directory must be group-owned by root."
          info        : "Kernel core dumps may contain the full contents of system memory at the time of the crash. As the system memory may contain sensitive information, it must be protected accordingly. If the kernel core dump data directory is not group-owned by a system group, the core dumps contained in the directory may be subject to unauthorized access."
          solution    : "The root role is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

Determine the location of the system dump directory.

# dumpadm | grep directory

Change the group-owner of the kernel core dump data directory.

# chgrp root [kernel core dump data directory]

In Solaris 11, /var/crash is linked to /var/share/crash."
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216215r959010_rule,STIG-ID|SOL-11.1-080100,STIG-Legacy|SV-60881,STIG-Legacy|V-48009,SWIFT-CSCv1|2.3,Vuln-ID|V-216215"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-080110 - The kernel core dump data directory must have mode 0700 or less permissive."
          info        : "Kernel core dumps may contain the full contents of system memory at the time of the crash. As the system memory may contain sensitive information, it must be protected accordingly. If the mode of the kernel core dump data directory is more permissive than 0700, unauthorized users may be able to view or to modify kernel core dump data files."
          solution    : "The root role is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

Determine the location of the system dump directory.

# dumpadm | grep directory

Change the group-owner of the kernel core dump data directory.

# chmod 0700 [savecore directory]"
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216216r959010_rule,STIG-ID|SOL-11.1-080110,STIG-Legacy|SV-60879,STIG-Legacy|V-48007,SWIFT-CSCv1|2.3,Vuln-ID|V-216216"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>
      </else>
    </if>

    <report type:"WARNING">
      description : "SOL-11.1-080120 - System BIOS or system controllers supporting password protection must have administrator accounts/passwords configured, and no others. (Intel)"
      info        : "A system's BIOS or system controller handles the initial startup of a system and its configuration must be protected from unauthorized modification. When the BIOS or system controller supports the creation of user accounts or passwords, such protections must be used and accounts/passwords only assigned to system administrators. Failure to protect BIOS or system controller settings could result in denial of service or compromise of the system resulting from unauthorized configuration changes.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Consult the hardware vendor's documentation to determine how to start the system and access the BIOS controls.

Access the system's BIOS or system controller. Set a supervisor/administrator password if one has not been set. Disable a user-level password if one has been set."
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216217r959010_rule,STIG-ID|SOL-11.1-080120,STIG-Legacy|SV-60877,STIG-Legacy|V-48005,SWIFT-CSCv1|2.3,Vuln-ID|V-216217"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
    </report>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : CMD_EXEC
          description : "Global zone auditing is configured."
          cmd         : "/usr/bin/zonename"
          expect      : "^global$"
        </custom_item>
      </condition>

      <then>
        <if>
          <condition auto:"FAILED" type:"AND">
            <custom_item>
              system      : "SunOS"
              type        : FILE_CONTENT_CHECK
              description : "'custom.cfg'."
              file        : "/rpool/boot/grub/grub.cfg"
              regex       : "^[\\s]*source[\\s]*"
              expect      : "^[\\s]*source[\\s]+\\$prefix/custom.cfg[\\s]*$"
            </custom_item>

            <custom_item>
              system      : "SunOS"
              type        : FILE_CONTENT_CHECK
              description : "'GRUB superuser'."
              file        : "/rpool/boot/grub/grub.cfg"
              regex       : "^[\\s]*set[\\s]*superusers[\\s]*="
              expect      : "^[\\s]*set[\\s]*superusers[\\s]*=[\\s]*\"@GRUB_SUPERUSER@\"[\\s]*$"
            </custom_item>

            <custom_item>
              system      : "SunOS"
              type        : FILE_CONTENT_CHECK
              description : "'GRUB password hash'."
              file        : "/rpool/boot/grub/grub.cfg"
              regex       : "^[\\s]*password_pbkdf2[\\s]+"
              expect      : "^[\\s]*password_pbkdf2[\\s]+@GRUB_SUPERUSER@[\\s]+[A-Za-z1-9]+[\\s]*$"
            </custom_item>
          </condition>

          <then>
            <report type:"PASSED">
              description : "SOL-11.1-080140 - The system must require authentication before allowing modification of the boot devices or menus. Secure the GRUB Menu (Intel)."
              info        : "The flexibility that GRUB provides creates a security risk if its configuration is modified by an unauthorized user. The failsafe menu entry needs to be secured in the same environments that require securing the systems firmware to avoid unauthorized removable media boots."
              solution    : "The root role is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

Update GRUB to use a custom configuration file.

# pfedit /rpool/boot/grub/grub.cfg
Insert the line:
source $prefix/custom.cfg

Create a password hash.

# /usr/lib/grub2/bios/bin/grub-mkpasswd-pbkdf2
Enter password:
Reenter password:
Your PBKDF2 is .......
Copy the long password hash in its entirety.

# pfedit /rpool/boot/grub/custom.cfg
Insert the lines:
set superusers='[username]'
password_pbkdf2 [username] [password hash]

Restart the system."
              reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216218r959010_rule,STIG-ID|SOL-11.1-080140,STIG-Legacy|SV-60873,STIG-Legacy|V-48001,SWIFT-CSCv1|2.3,Vuln-ID|V-216218"
              see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
              show_output : YES
            </report>
          </then>
        </if>
      </then>

      <else>
        <report type:"PASSED">
          description : "SOL-11.1-080140 - The system must require authentication before allowing modification of the boot devices or menus. Secure the GRUB Menu (Intel)."
          info        : "The flexibility that GRUB provides creates a security risk if its configuration is modified by an unauthorized user. The failsafe menu entry needs to be secured in the same environments that require securing the systems firmware to avoid unauthorized removable media boots."
          solution    : "The root role is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

Update GRUB to use a custom configuration file.

# pfedit /rpool/boot/grub/grub.cfg
Insert the line:
source $prefix/custom.cfg

Create a password hash.

# /usr/lib/grub2/bios/bin/grub-mkpasswd-pbkdf2
Enter password:
Reenter password:
Your PBKDF2 is .......
Copy the long password hash in its entirety.

# pfedit /rpool/boot/grub/custom.cfg
Insert the lines:
set superusers='[username]'
password_pbkdf2 [username] [password hash]

Restart the system."
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216218r959010_rule,STIG-ID|SOL-11.1-080140,STIG-Legacy|SV-60873,STIG-Legacy|V-48001,SWIFT-CSCv1|2.3,Vuln-ID|V-216218"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>
      </else>
    </if>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "SOL-11.1-080150 - The operating system must implement transaction recovery for transaction-based systems."
      info        : "Recovery and reconstitution constitutes executing an operating system contingency plan comprised of activities to restore essential missions and business functions.

Transaction rollback and transaction journaling are examples of mechanisms supporting transaction recovery.

While this is typically a database function, operating systems could be transactional in nature with respect to file processing."
      solution    : "The root role is required.

Solaris 11 ZFS copy-on-write model allows filesystem accesses to work according to a transactional model, such that on-disk content is always consistent and cannot be configured to be out of compliance.

If any UFS file systems are mounted with the 'nologging' options, remove that option from the /etc/vfstab file.

# pfedit /etc/vfstab

Locate any file systems listed with the 'nologging' option and delete the keyword 'nologging'."
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53|CP-10(2),800-53r5|CM-6b.,800-53r5|CP-10(2),CAT|II,CCI|CCI-000366,CCI|CCI-000553,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF|RC.RP-1,CSF|RS.RP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,CSF2.0|RC.RP,CSF2.0|RC.RP-01,CSF2.0|RC.RP-02,CSF2.0|RC.RP-05,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,GDPR|32.1.c,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(ii),ITSG-33|CM-6b.,ITSG-33|CP-10(2),NESA|T2.2.4,NESA|T3.2.1,QCSC-v1|5.2.3,QCSC-v1|10.2.1,QCSC-v1|11.2,Rule-ID|SV-216219r959010_rule,STIG-ID|SOL-11.1-080150,STIG-Legacy|SV-60869,STIG-Legacy|V-47997,SWIFT-CSCv1|2.3,Vuln-ID|V-216219"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      cmd         : "/usr/sbin/mount | /usr/bin/grep nologging | /usr/bin/awk '{ print } END { if (NR == 0) print \"pass\" }'"
      expect      : "pass"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "SOL-11.1-080160 - SNMP communities, users, and passphrases must be changed from the default."
      info        : "Whether active or not, default SNMP passwords, users, and passphrases must be changed to maintain security. If the service is running with the default authenticators, then anyone can gather data about the system and the network and use the information to potentially compromise the integrity of the system or network(s).

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "The root role is required.

Change the default snmpd.conf community passwords. To change them, locate the snmpd.conf file and edit it.

# pfedit [filename]

Locate the line system-group-read-community which has a default password of public and make the password something more random (less guessable). Make the same changes for the lines that read system- group-write-community, read-community, write-community, trap, and trap-community. Read the information in the file carefully. The trap is defining who to send traps to, for instance, by default. It is not a password, but the name of a host."
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|I,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216220r959010_rule,STIG-ID|SOL-11.1-080160,STIG-Legacy|SV-60867,STIG-Legacy|V-47995,SWIFT-CSCv1|2.3,Vuln-ID|V-216220"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      cmd         : "/usr/bin/pkg search -l -Ho path snmpd.conf | /usr/bin/awk '{ print \"/\"$1 }'"
      expect      : ""
      severity    : MEDIUM
    </custom_item>

    <report type:"WARNING">
      description : "SOL-11.1-090010 - A file integrity baseline must be created, maintained, and reviewed at least weekly to determine if unauthorized changes have been made to important system files located in the root file system."
      info        : "A file integrity baseline is a collection of file metadata used to evaluate the integrity of the system. A minimal baseline must contain metadata for all device files, setuid files, setgid files, system libraries, system binaries, and system configuration files. The minimal metadata must consist of the mode, owner, group owner, and modification times. For regular files, metadata must also include file size and a cryptographic hash of the file's contents.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "The root role is required.

Solaris 11 includes the Basic Account and Reporting Tool (BART), which uses cryptographic-strength checksums and file system metadata to determine changes. By default, the manifest generator catalogs all attributes of all files in the root (/) file system. File systems mounted on the root file system are cataloged only if they are of the same type as the root file system.

Create a protected area to store BART manifests.
# mkdir /var/adm/log/bartlogs
# chmod 700 /var/adm/log/bartlogs

After initial installation and configuration of the system, create a manifest report of the current baseline.

# bart create > /var/adm/log/bartlogs/[baseline manifest filename]"
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216221r959010_rule,STIG-ID|SOL-11.1-090010,STIG-Legacy|SV-60859,STIG-Legacy|V-47987,SWIFT-CSCv1|2.3,Vuln-ID|V-216221"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
    </report>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "'ntp running'."
          cmd         : "/usr/bin/svcs -Ho state ntp | /usr/bin/awk \'{ print } END { if (NR == 0) print \"not found\" }\'"
          expect      : "online"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : FILE_CONTENT_CHECK_NOT
          description : "'maxpoll'."
          file        : "/etc/inet/ntp.conf"
          regex       : "^[\\s]*maxpoll[\\s]+"
          expect      : "^[\\s]*[^#]"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "'polling'."
          cmd         : "/usr/sbin/ntpq -p 2> /dev/null | /usr/bin/awk '($6 ~ /[0-9]+/ && $6 > 86400) { print $1\" \"$6 }' | /usr/bin/awk '{ print } END { if (NR == 0) print \"pass\" }'"
          expect      : "pass"
        </custom_item>

        <custom_item>
          type        : FILE_CONTENT_CHECK
          description : "ntp server."
          file        : "/etc/inet/ntp.conf."
          regex       : "^[\\s]*server[\\s]*"
          expect      : "^[\\s]*server[\\s]*@NTP_SERVER@[\\s]*"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "SOL-11.1-090020 - The operating system must synchronize internal information system clocks with a server that is synchronized to one of the redundant United States Naval Observatory (USNO) time servers or a time server designated for the appropriate DOD network (NIPRNet/SIPRNet), and/or the Global Positioning System (GPS)."
          info        : "To assure the accuracy of the system clock, it must be synchronized with an authoritative time source within DOD. Many system functions, including time-based login and activity restrictions, automated reports, system logs, and audit records depend on an accurate system clock. If there is no confidence in the correctness of the system clock, time-based functions may not operate as intended and records may be of diminished value."
          solution    : "The root role is required.

Determine the zone to be secured.

# zonename

If the command output is not 'global', then NTP must be disabled.

# svcadm disable ntp

If the output from 'zonename' is 'global', then NTP must be enabled.

To activate the ntpd daemon, the ntp.conf file must first be created.

# cp /etc/inet/ntp.client /etc/inet/ntp.conf

# pfedit /etc/inet/ntp.conf

Make site-specific changes to this file as needed in the form.

server [ntpserver]

Locate the line containing maxpoll (if it exists).

Delete the line.

Start the ntpd daemon.

# svcadm enable ntp

Use a local authoritative time server synchronizing to an authorized DOD time source, a USNO-based time server, or a GPS. Ensure all systems in the facility feed from one or more local time servers that feed from the authoritative time server.

Edit the NTP configuration files and make the necessary changes to add the approved time servers per Solaris documentation."
          reference   : "800-171|3.3.7,800-53|AU-8(1),800-53r5|SC-45(1)(b),CAT|II,CCI|CCI-004926,CN-L3|8.1.4.3(b),CSF|PR.PT-1,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.4,ITSG-33|AU-8(1),NESA|T3.6.7,NIAv2|NS44,NIAv2|NS45,NIAv2|NS46,NIAv2|NS47,PCI-DSSv3.2.1|10.4,PCI-DSSv3.2.1|10.4.1,PCI-DSSv3.2.1|10.4.3,PCI-DSSv4.0|10.6,PCI-DSSv4.0|10.6.1,PCI-DSSv4.0|10.6.2,PCI-DSSv4.0|10.6.3,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-220014r986455_rule,STIG-ID|SOL-11.1-090020,STIG-Legacy|SV-60857,STIG-Legacy|V-47985,TBA-FIISB|37.4,Vuln-ID|V-220014"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <report type:"WARNING">
      description : "SOL-11.1-090030 - Direct logins must not be permitted to shared, default, application, or utility accounts."
      info        : "Shared accounts (accounts where two or more people log in with the same user identification) do not provide identification and authentication. There is no way to provide for non-repudiation or individual accountability.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "The root role is required.

This action applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this action applies.

Use the switch user ('su') command from a named account login to access shared accounts. Maintain audit trails that identify the actual user of the account name. Document requirements and procedures for users/administrators to log into their own accounts first and then switch user ('su') to the shared account."
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216223r959010_rule,STIG-ID|SOL-11.1-090030,STIG-Legacy|SV-60855,STIG-Legacy|V-47983,SWIFT-CSCv1|2.3,Vuln-ID|V-216223"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
    </report>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "SOL-11.1-090040 - The system must not have any unnecessary accounts."
      info        : "Accounts providing no operational purpose provide additional opportunities for system compromise. Unnecessary accounts include user accounts for individuals not requiring access to the system and application accounts for applications not installed on the system.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "The root role is required.

Remove all unnecessary accounts, such as games, from the /etc/passwd file before connecting a system to the network. Other accounts, such as news and gopher, associated with a service not in use should also be removed.

Identify unnecessary accounts.

# getent passwd

Remove unnecessary accounts.

# userdel [username]"
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216224r959010_rule,STIG-ID|SOL-11.1-090040,STIG-Legacy|SV-60851,STIG-Legacy|V-47979,SWIFT-CSCv1|2.3,Vuln-ID|V-216224"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
      cmd         : "/usr/bin/getent passwd"
      expect      : "none"
      severity    : MEDIUM
    </custom_item>

    <report type:"WARNING">
      description : "SOL-11.1-090050 - The operating system must conduct backups of user-level information contained in the operating system per organization-defined frequency to conduct backups consistent with recovery time and recovery point objectives."
      info        : "Operating system backup is a critical step in maintaining data assurance and availability.

User-level information is data generated by information system and/or application users.

Backups shall be consistent with organizational recovery time and recovery point objectives.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "The operations staff shall install, configure, test, and verify operating system backup software.

Additionally, all backup procedures must be documented."
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216225r959010_rule,STIG-ID|SOL-11.1-090050,STIG-Legacy|SV-60849,STIG-Legacy|V-47977,SWIFT-CSCv1|2.3,Vuln-ID|V-216225"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
    </report>

    <report type:"WARNING">
      description : "SOL-11.1-090060 - The operating system must conduct backups of system-level information contained in the information system per organization-defined frequency to conduct backups that are consistent with recovery time and recovery point objectives."
      info        : "Operating system backup is a critical step in maintaining data assurance and availability.

System-level information is data generated for/by the host (such as configuration settings) and/or administrative users.

Backups shall be consistent with organizational recovery time and recovery point objectives.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "The operations staff shall install, configure, test, and verify operating system backup software.

Additionally, all backup procedures must be documented."
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216226r959010_rule,STIG-ID|SOL-11.1-090060,STIG-Legacy|SV-60847,STIG-Legacy|V-47975,SWIFT-CSCv1|2.3,Vuln-ID|V-216226"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
    </report>

    <report type:"WARNING">
      description : "SOL-11.1-090070 - The operating system must conduct backups of operating system documentation including security-related documentation per organization-defined frequency to conduct backups that is consistent with recovery time and recovery point objectives."
      info        : "Operating system backup is a critical step in maintaining data assurance and availability.

System documentation is data generated for/by the host (such as logs) and/or administrative users.

Backups shall be consistent with organizational recovery time and recovery point objectives.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "The operations staff shall install, configure, test, and verify operating system backup software.

Additionally, all backup procedures must be documented."
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216227r959010_rule,STIG-ID|SOL-11.1-090070,STIG-Legacy|SV-60845,STIG-Legacy|V-47973,SWIFT-CSCv1|2.3,Vuln-ID|V-216227"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
    </report>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : CMD_EXEC
          description : "Check for Firefox"
          cmd         : "/usr/bin/pkg list web/browser/firefox"
          expect      : "^[\\s]*web/browser/firefox[\\s]+.*[\\s]+i--[\\s]*$"
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "SOL-11.1-090100 - The operating system must prevent the execution of prohibited mobile code."
          info        : "Decisions regarding the employment of mobile code within operating systems are based on the potential for the code to cause damage to the system if used maliciously.

Mobile code technologies include Java, JavaScript, ActiveX, PDF, Postscript, Shockwave movies, Flash animations, and VBScript. Usage restrictions and implementation guidance apply to both the selection and use of mobile code installed on organizational servers and mobile code downloaded and executed on individual workstations.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
          solution    : "In the address bar type: about:config

Click on 'I accept the risk' button.

In search bar type: javascript.enabled

Double click on the javascript.enabled and Value true will change to false.

In the address bar type: about:addons

Click on 'Plugins'.

If Java is displayed, disable Java by clicking on the
Never Activate selection"
          reference   : "800-171|3.13.13,800-53|SC-18(3),800-53r5|SC-18(3),CAT|II,CCI|CCI-001695,CSF|DE.CM-5,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(3),NIAv2|NS26f,QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-216228r958544_rule,STIG-ID|SOL-11.1-090100,STIG-Legacy|SV-60841,STIG-Legacy|V-47969,Vuln-ID|V-216228"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          cmd         : "/usr/bin/pkg info firefox"
          expect      : "Manual Review Required"
          severity    : MEDIUM
        </custom_item>
      </then>

      <else>
        <report type:"PASSED">
          description : "SOL-11.1-090100 - The operating system must prevent the execution of prohibited mobile code."
          info        : "Decisions regarding the employment of mobile code within operating systems are based on the potential for the code to cause damage to the system if used maliciously.

Mobile code technologies include Java, JavaScript, ActiveX, PDF, Postscript, Shockwave movies, Flash animations, and VBScript. Usage restrictions and implementation guidance apply to both the selection and use of mobile code installed on organizational servers and mobile code downloaded and executed on individual workstations."
          solution    : "In the address bar type: about:config

Click on 'I accept the risk' button.

In search bar type: javascript.enabled

Double click on the javascript.enabled and Value true will change to false.

In the address bar type: about:addons

Click on 'Plugins'.

If Java is displayed, disable Java by clicking on the
Never Activate selection"
          reference   : "800-171|3.13.13,800-53|SC-18(3),800-53r5|SC-18(3),CAT|II,CCI|CCI-001695,CSF|DE.CM-5,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(3),NIAv2|NS26f,QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-216228r958544_rule,STIG-ID|SOL-11.1-090100,STIG-Legacy|SV-60841,STIG-Legacy|V-47969,Vuln-ID|V-216228"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>
      </else>
    </if>

    <report type:"WARNING">
      description : "SOL-11.1-090115 - The operating system must employ PKI solutions at workstations, servers, or mobile computing devices on the network to create, manage, distribute, use, store, and revoke digital certificates."
      info        : "Without the use of PKI systems to manage digital certificates, the operating system or other system components may be unable to securely communicate on a network or reliably verify the identity of a user via digital signatures.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "The operator will ensure that a DoD approved PKI software is installed and operating continuously."
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216229r959010_rule,STIG-ID|SOL-11.1-090115,STIG-Legacy|SV-62549,STIG-Legacy|V-49625,SWIFT-CSCv1|2.3,Vuln-ID|V-216229"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
    </report>

    <report type:"WARNING">
      description : "SOL-11.1-090120 - The operating system must prevent non-privileged users from circumventing malicious code protection capabilities."
      info        : "In order to minimize potential negative impact to the organization caused by malicious code, it is imperative that malicious code is identified and eradicated prior to entering protected enclaves via operating system entry and exit points.

The requirement states that AV and malware protection applications must be used at entry and exit points. For the operating system, this means an anti-virus application must be installed on machines that are the entry and exit points.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "The operator will ensure that anti-virus software is installed and operating."
      reference   : "800-171|3.1.7,800-53|AC-6(10),800-53r5|AC-6(10),CAT|II,CCI|CCI-002235,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,CSF2.0|PR.AA-05,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,Rule-ID|SV-224672r958726_rule,STIG-ID|SOL-11.1-090120,STIG-Legacy|SV-60835,STIG-Legacy|V-47963,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,Vuln-ID|V-224672"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
    </report>

    <report type:"WARNING">
      description : "SOL-11.1-090130 - The operating system must employ malicious code protection mechanisms at workstations, servers, or mobile computing devices on the network to detect and eradicate malicious code transported by electronic mail, electronic mail attachments, web accesses, removable media, or other common means."
      info        : "In order to minimize potential negative impact to the organization caused by malicious code, it is imperative that malicious code is identified and eradicated prior to entering protected enclaves via operating system entry and exit points.

The requirement states that AV and malware protection applications must be used at entry and exit points. For the operating system, this means an anti-virus application must be installed on machines that are the entry and exit points.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "The operator will ensure that anti-virus software is installed and operating."
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216231r959010_rule,STIG-ID|SOL-11.1-090130,STIG-Legacy|SV-60831,STIG-Legacy|V-47959,SWIFT-CSCv1|2.3,Vuln-ID|V-216231"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
    </report>

    <report type:"WARNING">
      description : "SOL-11.1-090220 - The operating system must back up audit records at least every seven days onto a different system or system component than the system or component being audited."
      info        : "Protection of log data includes assuring log data is not accidentally lost or deleted. Backing up audit records to a different system or onto separate media than the system being audited on an organizationally defined frequency helps to assure in the event of a catastrophic system failure, the audit records will be retained.

This helps to ensure a compromise of the information system being audited does not also result in a compromise of the audit records.

This requirement can be met by the operating system continuously sending records to a centralized logging server.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "This fix applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this check applies.

The operator shall back up audit records at least every seven days."
      reference   : "800-171|3.3.8,800-53|AU-9(2),800-53r5|AU-9(2),CAT|II,CCI|CCI-001348,CN-L3|8.1.3.5(d),CN-L3|8.1.4.3(c),CSF|PR.PT-1,CSF2.0|PR.DS-10,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9(2),NESA|M5.2.3,NESA|M5.5.2,NIAv2|SS13e,PCI-DSSv3.2.1|10.5.3,PCI-DSSv3.2.1|10.5.4,PCI-DSSv4.0|10.3.3,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-216233r958574_rule,STIG-ID|SOL-11.1-090220,STIG-Legacy|SV-60813,STIG-Legacy|V-47941,Vuln-ID|V-216233"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
    </report>

    <report type:"WARNING">
      description : "SOL-11.1-090240 - All manual editing of system-relevant files shall be done using the pfedit command, which logs changes made to the files."
      info        : "Editing a system file with common tools such as vi, emacs, or gedit does not allow the auditing of changes made by an operator. This reduces the capability of determining which operator made security-relevant changes to the system.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Advise the operators to use pdfedit or other appropriate command line tools to make system changes instead of vi, emacs, or gedit.

Oracle Solaris includes administrative configuration files which use pfedit, and the solaris.admin.edit/path_to_file authorization is not recommended. Alternate commands exist which are both domain-specific and safer. For example, for the /etc/passwd, /etc/shadow, or /etc/user_attr files, use instead passwd, useradd, userdel, or usermod. For the /etc/group file, use instead groupadd, groupdel, or groupmod. For updating /etc/security/auth_attr, /etc/security/exec_attr, or /etc/security/prof_attr, the preferred command is profiles."
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216234r959010_rule,STIG-ID|SOL-11.1-090240,STIG-Legacy|SV-60809,STIG-Legacy|V-47937,SWIFT-CSCv1|2.3,Vuln-ID|V-216234"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
    </report>

    <report type:"WARNING">
      description : "SOL-11.1-090250 - The operating system must verify the correct operation of security functions in accordance with organization-defined conditions and in accordance with organization-defined frequency (if periodic verification)."
      info        : "Security functional testing involves testing the operating system for conformance to the operating system security function specifications, as well as for the underlying security model. The need to verify security functionality applies to all security functions. The conformance criteria state the conditions necessary for the operating system to exhibit the desired security behavior or satisfy a security property. For example, successful login triggers an audit entry.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Install, configure, and run DoD-approved SCAP compliance checking software on a periodic basis. Review the output of the software and document any out-of-compliance issues."
      reference   : "800-53|SI-6a.,800-53r5|SI-6a.,CAT|II,CCI|CCI-002696,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-6a.,Rule-ID|SV-220015r958944_rule,STIG-ID|SOL-11.1-090250,STIG-Legacy|SV-60779,STIG-Legacy|V-47907,Vuln-ID|V-220015"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
    </report>

    <report type:"WARNING">
      description : "SOL-11.1-090270 - The operating system must identify potentially security-relevant error conditions."
      info        : "Security functional testing involves testing the operating system for conformance to the operating system security function specifications, as well as for the underlying security model. The need to verify security functionality applies to all security functions. The conformance criteria state the conditions necessary for the operating system to exhibit the desired security behavior or satisfy a security property. For example, successful login triggers an audit entry.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Install, configure, and run DoD-approved SCAP compliance checking software on a periodic basis. Review the output of the software and document any out-of-compliance issues."
      reference   : "800-53|SI-6a.,800-53r5|SI-6a.,CAT|II,CCI|CCI-002696,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-6a.,Rule-ID|SV-224673r958944_rule,STIG-ID|SOL-11.1-090270,STIG-Legacy|SV-60775,STIG-Legacy|V-47903,Vuln-ID|V-224673"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
    </report>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : CMD_EXEC
          description : "Check for Solaris 11.0 - 11.4."
          cmd         : "uname -v"
          expect      : "^[\\s]*11\\.[0-4]"
        </custom_item>
      </condition>

      <then>
        <custom_item>
          type        : CMD_EXEC
          description : "SOL-11.1-090280 - The operating system must manage excess capacity, bandwidth, or other redundancy to limit the effects of information flooding types of denial of service attacks."
          info        : "In the case of denial of service attacks, care must be taken when designing the operating system so as to ensure that the operating system makes the best use of system resources.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
          solution    : "The Network Management profile is required.

Set each link's speed-duplex protection to an appropriate value based on each configured network interface's POSSIBLE settings.

Determine the OS version that is being secured:

# uname -a

For Solaris 11, 11.1, 11.2, and 11.3:

# pfexec dladm set-linkprop -p en_1000fdx_cap=1 net0

Verify EFFECTIVE column
# dladm show-linkprop net0 | egrep 'LINK|en_' | sort|uniq
LINK     PROPERTY        PERM VALUE        EFFECTIVE    DEFAULT   POSSIBLE
net0     en_1000fdx_cap  rw   1            1            1         1,0
net0     en_1000hdx_cap  r-   0            0            0         1,0
net0     en_100fdx_cap   rw   1            1            1         1,0
net0     en_100hdx_cap   rw   1            1            1         1,0
net0     en_10fdx_cap    rw   1            1            1         1,0
net0     en_10gfdx_cap   --   --           --           0         1,0
net0     en_10hdx_cap    rw   1            1            1         1,0

Do the above for all available/connected network adapters.

For Solaris 11.4.x or newer:

# pfexec dladm set-linkprop -p speed-duplex=1g-f,100m-f net0

Verify EFFECTIVE column
# dladm show-linkprop -p speed-duplex net0
LINK     PROPERTY        PERM VALUE        EFFECTIVE    DEFAULT   POSSIBLE
net0     speed-duplex    rw   1g-f,100m-f  1g-f,100m-f  1g-f,     1g-f,100m-f,
                                                        100m-f,   100m-h,10m-f,
                                                        100m-h,   10m-h
                                                        10m-f,
                                                        10m-h

Do the above for all available/connected network adapters."
          reference   : "800-53|SC-5(2),800-53r5|SC-5(2),CAT|II,CCI|CCI-001095,CSF|PR.DS-4,CSF2.0|DE.CM-01,CSF2.0|PR.IR-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-5(2),NESA|T3.3.1,NIAv2|GS8e,NIAv2|GS10c,QCSC-v1|8.2.1,Rule-ID|SV-216237r958528_rule,STIG-ID|SOL-11.1-090280,STIG-Legacy|SV-60771,STIG-Legacy|V-47899,SWIFT-CSCv1|6.4,Vuln-ID|V-216237"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          cmd         : "for IFACE in $(/sbin/dladm show-ether -Z | /bin/grep up | /bin/cut -d' ' -f1); do /sbin/dladm show-linkprop $IFACE| /bin/egrep \"(LINK|en_)\" | /bin/sort | /bin/uniq; done"
          expect      : "Manual Review Required"
          severity    : MEDIUM
        </custom_item>
      </then>

      <else>
        <custom_item>
          type        : CMD_EXEC
          description : "SOL-11.1-090280 - The operating system must manage excess capacity, bandwidth, or other redundancy to limit the effects of information flooding types of denial of service attacks."
          info        : "In the case of denial of service attacks, care must be taken when designing the operating system so as to ensure that the operating system makes the best use of system resources.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
          solution    : "The Network Management profile is required.

Set each link's speed-duplex protection to an appropriate value based on each configured network interface's POSSIBLE settings.

Determine the OS version that is being secured:

# uname -a

For Solaris 11, 11.1, 11.2, and 11.3:

# pfexec dladm set-linkprop -p en_1000fdx_cap=1 net0

Verify EFFECTIVE column
# dladm show-linkprop net0 | egrep 'LINK|en_' | sort|uniq
LINK     PROPERTY        PERM VALUE        EFFECTIVE    DEFAULT   POSSIBLE
net0     en_1000fdx_cap  rw   1            1            1         1,0
net0     en_1000hdx_cap  r-   0            0            0         1,0
net0     en_100fdx_cap   rw   1            1            1         1,0
net0     en_100hdx_cap   rw   1            1            1         1,0
net0     en_10fdx_cap    rw   1            1            1         1,0
net0     en_10gfdx_cap   --   --           --           0         1,0
net0     en_10hdx_cap    rw   1            1            1         1,0

Do the above for all available/connected network adapters.

For Solaris 11.4.x or newer:

# pfexec dladm set-linkprop -p speed-duplex=1g-f,100m-f net0

Verify EFFECTIVE column
# dladm show-linkprop -p speed-duplex net0
LINK     PROPERTY        PERM VALUE        EFFECTIVE    DEFAULT   POSSIBLE
net0     speed-duplex    rw   1g-f,100m-f  1g-f,100m-f  1g-f,     1g-f,100m-f,
                                                        100m-f,   100m-h,10m-f,
                                                        100m-h,   10m-h
                                                        10m-f,
                                                        10m-h

Do the above for all available/connected network adapters."
          reference   : "800-53|SC-5(2),800-53r5|SC-5(2),CAT|II,CCI|CCI-001095,CSF|PR.DS-4,CSF2.0|DE.CM-01,CSF2.0|PR.IR-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-5(2),NESA|T3.3.1,NIAv2|GS8e,NIAv2|GS10c,QCSC-v1|8.2.1,Rule-ID|SV-216237r958528_rule,STIG-ID|SOL-11.1-090280,STIG-Legacy|SV-60771,STIG-Legacy|V-47899,SWIFT-CSCv1|6.4,Vuln-ID|V-216237"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          cmd         : "for IFACE in $(/sbin/dladm show-ether -Z | /bin/grep up | /bin/cut -d' ' -f1); do /sbin/dladm show-linkprop -p speed-duplex $IFACE; done"
          expect      : "Manual Review Required"
          severity    : MEDIUM
        </custom_item>
      </else>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : CMD_EXEC
          description : "Global zone auditing is configured."
          cmd         : "/usr/bin/zonename"
          expect      : "^global$"
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "SOL-11.1-100010 - The /etc/zones directory, and its contents, must have the vendor default owner, group, and permissions."
          info        : "Incorrect ownership can result in unauthorized changes or theft of data."
          solution    : "This check applies to the global zone only.  Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this check applies.

The Software Installation profile is required.

Change the ownership and permissions of the files and directories to the factory default.

# pkg fix system/zones"
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216238r959010_rule,STIG-ID|SOL-11.1-100010,STIG-Legacy|SV-60769,STIG-Legacy|V-47897,SWIFT-CSCv1|2.3,Vuln-ID|V-216238"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          cmd         : "/usr/bin/pkg verify system/zones | /usr/bin/grep -v 'Planning:' | /usr/bin/awk '{ print } END { if (NR == 0) print \"pass\" }'"
          expect      : "pass"
        </custom_item>

        <custom_item>
          system        : "SunOS"
          type          : CMD_EXEC
          description   : "SOL-11.1-100020 - The limitpriv zone option must be set to the vendor default or less permissive."
          info          : "Solaris zones can be assigned privileges generally reserved for the global zone using the 'limitpriv' zone option. Any privilege assignments in excess of the vendor defaults may provide the ability for a non-global zone to compromise the global zone."
          solution      : "This check applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this check applies.

The Zone Security profile is required:

Change the 'limitpriv' setting to default.

# pfexec zonecfg -z [zone] set limitpriv=default"
          reference     : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216239r959010_rule,STIG-ID|SOL-11.1-100020,STIG-Legacy|SV-60767,STIG-Legacy|V-47895,SWIFT-CSCv1|2.3,Vuln-ID|V-216239"
          see_also      : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          cmd           : "/usr/sbin/zoneadm list -vi | /usr/bin/egrep -v \'global|solaris-kz\' | /usr/bin/xargs -IZONE /usr/sbin/zonecfg -z ZONE info limitpriv | /usr/bin/egrep -v '^limitpriv:( default)? *$' 2>&1 | /usr/bin/awk '{ print } END { if (NR == 0) print \"no additional limitpriv found\" }'"
          expect        : "^no additional limitpriv found$"
          dont_echo_cmd : YES
        </custom_item>

        <custom_item>
          system        : "SunOS"
          type          : CMD_EXEC
          description   : "SOL-11.1-100030 - The systems physical devices must not be assigned to non-global zones."
          info          : "Solaris non-global zones can be assigned physical hardware devices. This increases the risk of such a non-global zone having the capability to compromise the global zone."
          solution      : "This check applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this check applies.

The Zone Security profile is required:

Remove all device assignments from the non-global zone.

# pfexec zonecfg -z [zone] delete device [device]"
          reference     : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216240r959010_rule,STIG-ID|SOL-11.1-100030,STIG-Legacy|SV-60715,STIG-Legacy|V-47841,SWIFT-CSCv1|2.3,Vuln-ID|V-216240"
          see_also      : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          cmd           : "/usr/sbin/zoneadm list -i | /usr/bin/egrep -v '^global$' | /usr/bin/xargs -IZONE /usr/sbin/zonecfg -z ZONE info device 2>&1 | /usr/bin/awk '{ print } END { if (NR == 0) print \"no additional device found\" }'"
          expect        : "^no additional device found$"
          dont_echo_cmd : YES
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "SOL-11.1-100040 - The audit system must identify in which zone an event occurred."
          info        : "Tracking the specific Solaris zones in the audit trail reduces the time required to determine the cause of a security event."
          solution    : "This check applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this check applies.

List the non-global zones on the system.

# zoneadm list -vi | grep -v global

The Audit Configuration profile is required.

Enable the 'zonename' auditing policy.

# pfexec auditconfig -setpolicy +zonename"
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216241r959010_rule,STIG-ID|SOL-11.1-100040,STIG-Legacy|SV-60713,STIG-Legacy|V-47839,SWIFT-CSCv1|2.3,Vuln-ID|V-216241"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getpolicy | /usr/bin/grep active | /usr/bin/grep zonename | /usr/bin/awk '{ print } END { if (NR != 0) print \"pass\" }'"
          expect      : "pass"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "SOL-11.1-100050 - The audit system must maintain a central audit trail for all zones."
          info        : "Centralized auditing simplifies the investigative process to determine the cause of a security event."
          solution    : "This check applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this check applies.

List the non-global zones on the system.

# zoneadm list -vi | grep -v global

The Audit Configuration profile is required.

Disable the 'perzone' auditing policy.

# pfexec auditconfig -setpolicy -perzone"
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216242r959010_rule,STIG-ID|SOL-11.1-100050,STIG-Legacy|SV-60711,STIG-Legacy|V-47837,SWIFT-CSCv1|2.3,Vuln-ID|V-216242"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          cmd         : "/usr/bin/pfexec /usr/sbin/auditconfig -getpolicy | /usr/bin/grep active | /usr/bin/grep perzone | /usr/bin/awk '{ print } END { if (NR == 0) print \"pass\" }'"
          expect      : "pass"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "SOL-11.1-120410 - The operating system must monitor for unauthorized connections of mobile devices to organizational information systems."
          info        : "Mobile devices include portable storage media (e.g., USB memory sticks, external hard disk drives) and portable computing and communications devices with information storage capability (e.g., notebook/laptop computers, personal digital assistants, cellular telephones, digital cameras, audio recording devices).

Organization-controlled mobile devices include those devices for which the organization has the authority to specify and the ability to enforce specific security requirements.

Usage restrictions and implementation guidance related to mobile devices include configuration management, device identification and authentication, implementation of mandatory protective software (e.g., malicious code detection, firewall), scanning devices for malicious code, updating virus protection software, scanning for critical software updates and patches, conducting primary operating system (and possibly other resident software) integrity checks, and disabling unnecessary hardware (e.g., wireless, infrared).

In order to detect unauthorized mobile device connections, organizations must first identify and document what mobile devices are authorized."
          solution    : "The root role is required.

This check applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global' this check applies.

Modify the /etc/system file.

Determine the OS version you are currently securing.
# uname -v
For Solaris 11GA and 11.1
# pfedit /etc/system

Add a line containing:

exclude: scsa2usb

Note that the global zone will need to be rebooted for this change to take effect.

For Solaris 11.2 or newer

Modify an /etc/system.d file.
# pfedit /etc/system.d/USB:MassStorage

Add a line containing:
exclude: scsa2usb

Note that the global zone will need to be rebooted for this change to take effect."
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216243r959010_rule,STIG-ID|SOL-11.1-120410,STIG-Legacy|SV-62559,STIG-Legacy|V-49635,SWIFT-CSCv1|2.3,Vuln-ID|V-216243"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
          cmd         : "/usr/bin/grep -sh 'scsa2usb' /etc/system /etc/system.d/*"
          expect      : "^[\\s]*exclude:[\\s]*scsa2usb[\\s]*$"
        </custom_item>
      </then>

      <else>
        <report type:"PASSED">
          description : "SOL-11.1-100010 - The /etc/zones directory, and its contents, must have the vendor default owner, group, and permissions."
          info        : "Incorrect ownership can result in unauthorized changes or theft of data."
          solution    : "This check applies to the global zone only.  Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this check applies.

The Software Installation profile is required.

Change the ownership and permissions of the files and directories to the factory default.

# pkg fix system/zones"
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216238r959010_rule,STIG-ID|SOL-11.1-100010,STIG-Legacy|SV-60769,STIG-Legacy|V-47897,SWIFT-CSCv1|2.3,Vuln-ID|V-216238"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-100020 - The limitpriv zone option must be set to the vendor default or less permissive."
          info        : "Solaris zones can be assigned privileges generally reserved for the global zone using the 'limitpriv' zone option. Any privilege assignments in excess of the vendor defaults may provide the ability for a non-global zone to compromise the global zone."
          solution    : "This check applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this check applies.

The Zone Security profile is required:

Change the 'limitpriv' setting to default.

# pfexec zonecfg -z [zone] set limitpriv=default"
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216239r959010_rule,STIG-ID|SOL-11.1-100020,STIG-Legacy|SV-60767,STIG-Legacy|V-47895,SWIFT-CSCv1|2.3,Vuln-ID|V-216239"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-100030 - The systems physical devices must not be assigned to non-global zones."
          info        : "Solaris non-global zones can be assigned physical hardware devices. This increases the risk of such a non-global zone having the capability to compromise the global zone."
          solution    : "This check applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this check applies.

The Zone Security profile is required:

Remove all device assignments from the non-global zone.

# pfexec zonecfg -z [zone] delete device [device]"
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216240r959010_rule,STIG-ID|SOL-11.1-100030,STIG-Legacy|SV-60715,STIG-Legacy|V-47841,SWIFT-CSCv1|2.3,Vuln-ID|V-216240"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-100040 - The audit system must identify in which zone an event occurred."
          info        : "Tracking the specific Solaris zones in the audit trail reduces the time required to determine the cause of a security event."
          solution    : "This check applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this check applies.

List the non-global zones on the system.

# zoneadm list -vi | grep -v global

The Audit Configuration profile is required.

Enable the 'zonename' auditing policy.

# pfexec auditconfig -setpolicy +zonename"
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216241r959010_rule,STIG-ID|SOL-11.1-100040,STIG-Legacy|SV-60713,STIG-Legacy|V-47839,SWIFT-CSCv1|2.3,Vuln-ID|V-216241"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-100050 - The audit system must maintain a central audit trail for all zones."
          info        : "Centralized auditing simplifies the investigative process to determine the cause of a security event."
          solution    : "This check applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global', this check applies.

List the non-global zones on the system.

# zoneadm list -vi | grep -v global

The Audit Configuration profile is required.

Disable the 'perzone' auditing policy.

# pfexec auditconfig -setpolicy -perzone"
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216242r959010_rule,STIG-ID|SOL-11.1-100050,STIG-Legacy|SV-60711,STIG-Legacy|V-47837,SWIFT-CSCv1|2.3,Vuln-ID|V-216242"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "SOL-11.1-120410 - The operating system must monitor for unauthorized connections of mobile devices to organizational information systems."
          info        : "Mobile devices include portable storage media (e.g., USB memory sticks, external hard disk drives) and portable computing and communications devices with information storage capability (e.g., notebook/laptop computers, personal digital assistants, cellular telephones, digital cameras, audio recording devices).

Organization-controlled mobile devices include those devices for which the organization has the authority to specify and the ability to enforce specific security requirements.

Usage restrictions and implementation guidance related to mobile devices include configuration management, device identification and authentication, implementation of mandatory protective software (e.g., malicious code detection, firewall), scanning devices for malicious code, updating virus protection software, scanning for critical software updates and patches, conducting primary operating system (and possibly other resident software) integrity checks, and disabling unnecessary hardware (e.g., wireless, infrared).

In order to detect unauthorized mobile device connections, organizations must first identify and document what mobile devices are authorized."
          solution    : "The root role is required.

This check applies to the global zone only. Determine the zone that you are currently securing.

# zonename

If the command output is 'global' this check applies.

Modify the /etc/system file.

Determine the OS version you are currently securing.
# uname -v
For Solaris 11GA and 11.1
# pfedit /etc/system

Add a line containing:

exclude: scsa2usb

Note that the global zone will need to be rebooted for this change to take effect.

For Solaris 11.2 or newer

Modify an /etc/system.d file.
# pfedit /etc/system.d/USB:MassStorage

Add a line containing:
exclude: scsa2usb

Note that the global zone will need to be rebooted for this change to take effect."
          reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|Solaris_11_X86_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-216243r959010_rule,STIG-ID|SOL-11.1-120410,STIG-Legacy|SV-62559,STIG-Legacy|V-49635,SWIFT-CSCv1|2.3,Vuln-ID|V-216243"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
        </report>
      </else>
    </if>
  </then>

  <else>
    <report type:"WARNING">
      description : "DISA_STIG_Solaris_11_v3r1.audit from DISA Solaris 11 X86 v3r1 STIG"
      info        : "NOTE: Nessus has not identified that the chosen audit applies to the target device."
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SOL_11_x86_V3R1_STIG.zip"
    </report>
  </else>
</if>

</check_type>
