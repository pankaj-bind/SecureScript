#TRUSTED 103337d5f00bd39cf95864e65afdaa3b9e5c465d5a22c401122bd49acba78cf82f0838ec8d5b2bb60161ec650e6d9f148277e78f8f31c776aadbe2368a4a6753de859509c1392e7bd459c2de398cfb208978cbc9ff590593fb3833437808bee5ea4d9e85cec03c1fb2f3094c7a97a2b875ae719d245997ca2a6912a2dbf0024303ca2c6f5c56963234ec0dcc525d246c549323ab6e42ff9bfdca048d976f411c905d719772d18bad5da4db588649c202b6e844a986b4fbcdf1813fb0b7e8bb9d0b98965e127f2fb044263dbcbbd5afd0ce262bea37f9f7d73c5627deaed6fbb37179d31bec60bae91ec19e491424e2de22ae19987bd9eb20d686d351edd50c2d5be6d0a7740a9db1bbfc0aed83a4b826e83251d8904c746e37b8179792431b63720556088dc800d91b2887e454192b47554cf447c6973efcfee5e8a6acadcf90930d7358c2d286cecb39b9b5d5cbf7c45b467f19bce75af85be0019407679e7e8b9a7cac69f9c93edd29554471e7e92c9facae5fe96d6871da3b7894224db289a1a4fce5db2ad17a8fc45535d09016d87fa035ac3754480864f6b2aa6b7fb4768b4e633adfbb908810e71f91db795e41a43a9c7f3110effd1a291a62af0306fe46600241af012c119e95b6e5d335e3a2422badc2dac79873b288a5d085aa80404d3dffe23ffc240ad3b8e7528b2382f6c1d29c970bb428afb8870a39b00dc440
#TRUST-RSA-SHA256 2083d99031617533276d4dc1a261945dc54cb7ae1e3cd2c8470107a80915e224b55188c94fad73f12554755e1334470ba525f9914fef2f50e0e5f19a1e6dc8deaece01f97e03c6ecc18c7a52691391a08ff2cdd4b44ba67718727ecee0b931fa95ae2a982a40ae9d424c774809e2cc26ca6b52528e219a032e0abf376b4fc4ce1620a2c917cfa536530205f44b7f68779142cbb07abc802b106d9ac55d5179b9a6641a5aedff5626b7e519cc8bdfb11f57ddd39303513e021ebc3c5d2b4f4d8cca02291cce5c8af9dd91103e8730308aca961dbe26ea96dfa7521fa5bf7e192a2917b15e3e1f9b94da6f707180f1bcfe32d028dd40a8c38922d9e99885cb7c3d8ea4b7f329c6a41db51587efe2baad026c7d3fbfbb1844050bb50a68aa268c31c20f18abf498e2754a52f273b9dabb46add9beae5771d3905dac005aafd1d04da06006b3c75e397e9548240ddd8f422c1566d3387cd38263c48c96b92faa23797b2ee23093f8c40c64349e42a51c8e2c3bcb8cd3274920837166563b0f723e18a415dbde17d72ae2620843c0d8d6ecf5b838e56fc2d3b1ee5a2d0c1a564b245524f749b3ed13ab15f84417dd744f7363c8a6309f18d9506b9e6067de0f1ebcb10095ebb5728c1133591df798c7789491a9b8cf4d7ddb4698c40a53a0bd9d02f6bfcda151b7425403c6ce3953bd6e82088276abfb2903985a7e7ceec3655309dc
#
# This script is Copyright (C) 2004-2025 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
# $Revision: 1.0 $
# $Date: 2025/04/23 $
#
# description : This .audit is designed against the CIS Apache Tomcat 11 Benchmark 1.0.0
#
#<ui_metadata>
#<display_name>CIS Apache Tomcat 11 v1.0.0 L2</display_name>
#<spec>
#  <type>CIS</type>
#  <name>Apache Tomcat 11</name>
#  <profile>L2</profile>
#  <version>1.0.0</version>
#  <link>https://workbench.cisecurity.org/benchmarks/21082</link>
#</spec>
#<labels>unix,cis,apache_tomcat_11,agent,apache_tomcat_linux_11</labels>
#<benchmark_refs>CSCv6,CSCv7,CSCv8,LEVEL</benchmark_refs>
#<application>
#  <app_name>Apache Tomcat</app_name>
#  <app_key>Config files</app_key>
#</application>
#<variables>
#  <variable>
#    <name>MAX_HEADER_SIZE</name>
#    <default>8192</default>
#    <description>Max HTTP Header Size (in bytes)</description>
#    <info>Value of maxHttpHeaderSize in $CATALINA_HOME/conf/server.xml</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>ALLOWED_MANAGER_SYSTEMS</name>
#    <default>127\.0\.0\.1</default>
#    <description>Allowed Manager Systems</description>
#    <info>The IP address(es) of systems allowed to access the manager application, separated by commas.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>ENGINE</name>
#    <default>*</default>
#    <description>Engine</description>
#    <info>Engine represents the specific Tomcat engine name used in the file path found in 10.3</info>
#    <value_type>UNIX_FILE_PATH</value_type>
#  </variable>
#  <variable>
#    <name>HOST</name>
#    <default>*</default>
#    <description>Host</description>
#    <info>Engine represents the Tomcat host name used in the file path found in 10.3</info>
#    <value_type>UNIX_FILE_PATH</value_type>
#  </variable>
#  <variable>
#    <name>CONNECTION_TIMEOUT</name>
#    <default>60000</default>
#    <description>Connection Timeout length (in milliseconds)</description>
#    <info>Value of connectionTimeout in $CATALINA_HOME/conf/server.xml</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>SERVER_HEADER</name>
#    <default>I am a teapot</default>
#    <description>Server header text</description>
#    <info>The server header is a vanity header developed to help identify the underlying technology in a server for troubleshooting and identification.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>WEB_APP_DIR</name>
#    <default>*</default>
#    <description>Web application directory</description>
#    <info>The name of your web application directory within CATALINA_BASE (e.g., /var/lib/tomcat9/webapps/yourappname)</info>
#    <value_type>UNIX_FILE_PATH</value_type>
#  </variable>
#</variables>
#</ui_metadata>

<check_type:"Unix">

<if>
  <condition type:"AND">
    <custom_item>
      type        : CMD_EXEC
      description : "Tomcat 11 is installed"
      cmd         : "echo '@APP_name@/@APP_version@'"
      expect      : "@APP_name@/11\..*"
    </custom_item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "CIS_Apache_Tomcat_11_v1.0.0_L2.audit from CIS Apache Tomcat 11 Benchmark v1.0.0"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21082"
      show_output : YES
    </report>

    <custom_item>
      type        : AUDIT_XML
      description : "10.10 Configure maxHttpHeaderSize"
      info        : "The maxHttpHeaderSize limits the size of the request and response headers defined in bytes.

Limiting the size of the header request can help protect against Denial of Service (DoS) requests."
      solution    : "Set maxHttpHeaderSize for each connector in $CATALINA_HOME/conf/server.xml to the appropriate setting.

maxHttpHeaderSize=\"8192\""
      reference   : "800-171|3.1.16,800-171|3.13.15,800-171r3|03.01.16,800-171r3|03.13.15,800-53|AC-18,800-53|SC-23,800-53r5|AC-18,800-53r5|SC-23,CSCv7|5.1,CSCv8|12.6,CSF|PR.PT-4,CSF2.0|PR.AA-05,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO-27001-2022|A.5.14,ISO-27001-2022|A.8.20,ITSG-33|AC-18,ITSG-33|SC-23,ITSG-33|SC-23a.,LEVEL|2A,NESA|T4.5.1,QCSC-v1|5.2.1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21082"
      file        : "@APP_Config_files@"
      xsl_stmt    : "<xsl:template match=\"/\">"
      xsl_stmt    : "<xsl:for-each select=\"Server/Service/Connector\">"
      xsl_stmt    : "<xsl:choose>"
      xsl_stmt    : "<xsl:when test=\"@maxHttpHeaderSize and @maxHttpHeaderSize = @MAX_HEADER_SIZE@\">"
      xsl_stmt    : "<xsl:text>PASS - maxHttpHeaderSize set correctly</xsl:text><xsl:text>&#xa;</xsl:text>"
      xsl_stmt    : "</xsl:when>"
      xsl_stmt    : "<xsl:otherwise>"
      xsl_stmt    : "<xsl:text>FAIL - maxHttpHeaderSize incorrect (</xsl:text><xsl:value-of select='@maxHttpHeaderSize'/><xsl:text>) for Connector </xsl:text><xsl:value-of select='@port' /><xsl:text>&#xa;</xsl:text>"
      xsl_stmt    : "</xsl:otherwise>"
      xsl_stmt    : "</xsl:choose>"
      xsl_stmt    : "</xsl:for-each>"
      xsl_stmt    : "</xsl:template>"
      not_expect  : "^FAIL"
    </custom_item>

    <custom_item>
      type        : AUDIT_XML
      description : "10.11 Force SSL for all applications"
      info        : "Use the transport-guarantee attribute to ensure SSL protection when accessing all applications. This can be overridden on a per application basis in the application configuration.

By default, when accessing applications SSL will be enforced to protect information sent over the network. By using the transport-guarantee attribute within web.xml SSL is enforced.

Note: This requires SSL to be configured."
      solution    : "Set transport-guarantee to CONFIDENTIAL in $CATALINA_HOME/conf/web.xml :

<user-data-constraint>
  <transport-guarantee>CONFIDENTIAL</transport-guarantee>
</user-data-constraint>

Impact:

If the data protection level is set to INTEGRAL or CONFIDENTIAL and the client is not already using SSL, then the client is redirected to the same URI, but using port 443 or the port defined for the redirectPort attribute in the <Connector> element in server.xml"
      reference   : "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-171r3|03.05.07,800-171r3|03.05.12,800-171r3|03.13.08,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|14.4,CSCv8|3.10,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,CSF2.0|PR.AA-05,CSF2.0|PR.DS-02,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO-27001-2022|A.5.10,ISO-27001-2022|A.5.14,ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.17,ISO-27001-2022|A.5.33,ISO-27001-2022|A.6.7,ISO-27001-2022|A.8.20,ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|2A,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21082"
      file        : "@APP_Config_catalogs@/conf/web.xml"
      xsl_stmt    : "<xsl:template match=\"/\">"
      xsl_stmt    : "<xsl:choose>"
      xsl_stmt    : "<xsl:when test=\"//*[local-name() = 'web-app']/*[local-name() = 'security-constraint']/*[local-name() = 'user-data-constraint']/*[local-name() = 'transport-guarantee'] = 'CONFIDENTIAL'\">"
      xsl_stmt    : "<xsl:text>PASS - transport-guarantee correctly configured, SSL forced for all applications</xsl:text><xsl:text>&#xa;</xsl:text>"
      xsl_stmt    : "</xsl:when>"
      xsl_stmt    : "<xsl:otherwise>"
      xsl_stmt    : "<xsl:text>FAIL - transport-guarantee misconfigured (</xsl:text><xsl:value-of select=\"//*[local-name() = 'web-app']/*[local-name() = 'security-constraint']/*[local-name() = 'user-data-constraint']/*[local-name() = 'transport-guarantee']\"/><xsl:text>)</xsl:text><xsl:text>&#xa;</xsl:text>"
      xsl_stmt    : "</xsl:otherwise>"
      xsl_stmt    : "</xsl:choose>"
      xsl_stmt    : "</xsl:template>"
      not_expect  : "^FAIL"
    </custom_item>

    <custom_item>
      type        : AUDIT_XML
      description : "10.15 Do not resolve hosts on logging valves"
      info        : "Setting enableLookups to true on Connector will result in a DNS look-ups to obtain the host name of the remote client before logging any information. This uses additional resources when logging.

Allowing enableLookups adds additional overhead to resolve the host name of a remote client which is rarely needed."
      solution    : "In Connector elements, set the enableLookups attribute to false or remove it.

<Connector ... enableLookups=\"false\" />"
      reference   : "800-53|SI-8,800-53r5|SI-8,CSCv7|7.7,CSCv8|9.2,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-8,LEVEL|2A,QCSC-v1|3.2,QCSC-v1|8.2.1"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21082"
      file        : "@APP_Config_files@"
      xsl_stmt    : "<xsl:template match=\"/\">"
      xsl_stmt    : "<xsl:for-each select=\"Server/Service/Connector\">"
      xsl_stmt    : "<xsl:choose>"
      xsl_stmt    : "<xsl:when test=\"@enableLookups and @enableLookups = 'true'\">"
      xsl_stmt    : "<xsl:text>FAIL - Lookups enabled for port </xsl:text><xsl:value-of select=\"@port\" /><xsl:text>&#xa;</xsl:text>"
      xsl_stmt    : "</xsl:when>"
      xsl_stmt    : "<xsl:otherwise>"
      xsl_stmt    : "<xsl:text>PASS - Lookups not enabled for port </xsl:text><xsl:value-of select=\"@port\" /><xsl:text>&#xa;</xsl:text>"
      xsl_stmt    : "</xsl:otherwise>"
      xsl_stmt    : "</xsl:choose>"
      xsl_stmt    : "</xsl:for-each>"
      xsl_stmt    : "</xsl:template>"
      not_expect  : "^FAIL"
    </custom_item>

    <custom_item>
      type        : AUDIT_XML
      description : "10.3 Restrict manager application"
      info        : "Limit access to the manager application to only those with a justified need.

Limiting access to the least privilege will ensure only those people with a justified need will have access to a resource. The manager application should be limited to only administrators."
      solution    : "For the manager application, edit $CATALINA_BASE/conf/

<enginename>

/

<hostname>

/manager.xml and add the bolded line:

<Context path=\"/manager\" docBase=\"${catalina.home}/webapps/manager\" debug=\"0\" privileged=\"true\"><Valve className=\"org.apache.catalina.valves.RemoteAddrValve\" allow=\"127.0.0.1\"/></Context>

Add hosts, comma separated, which are allowed to access the admin application.

Note: The RemoteAddrValve property expects a regular expression, therefore periods and other regular expression meta-characters must be escaped."
      reference   : "800-171|3.1.5,800-171|3.1.6,800-171r3|03.01.06a.,800-171r3|03.01.06b.,800-53|AC-6(2),800-53|AC-6(5),800-53r5|AC-6(2),800-53r5|AC-6(5),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSCv7|4,CSCv8|5.4,CSF|PR.AC-4,CSF2.0|PR.AA-05,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO-27001-2022|A.5.15,ISO-27001-2022|A.8.2,ISO-27001-2022|A.8.18,ISO/IEC-27001|A.9.2.3,ITSG-33|AC-6(2),ITSG-33|AC-6(5),LEVEL|2M,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.6.1,NIAv2|AM1,NIAv2|AM23f,NIAv2|AM32,NIAv2|AM33,NIAv2|SS13c,NIAv2|SS15c,NIAv2|VL3a,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21082"
      file        : "@APP_Config_catalogs@/conf/@ENGINE@/@HOST@/manager.xml"
      xsl_stmt    : "<xsl:template match=\"/\">"
      xsl_stmt    : "<xsl:for-each select=\"Context\">"
      xsl_stmt    : "<xsl:choose>"
      xsl_stmt    : "<xsl:when test=\"Valve/@className='org.apache.catalina.valves.RemoteAddrValve'\">"
      xsl_stmt    : "<xsl:choose>"
      xsl_stmt    : "<xsl:when test=\"Valve/@className='org.apache.catalina.valves.RemoteAddrValve' and Valve/@allow='@ALLOWED_MANAGER_SYSTEMS@' \">"
      xsl_stmt    : "<xsl:text>PASS - RemoteAddrValve configured correctly (allow list: </xsl:text><xsl:value-of select=\"Valve/@allow\" /><xsl:text>) for manager application</xsl:text><xsl:text>&#xa;</xsl:text>"
      xsl_stmt    : "</xsl:when>"
      xsl_stmt    : "<xsl:otherwise>"
      xsl_stmt    : "<xsl:text>FAIL - RemoteAddrValve configured incorrectly (allow list: </xsl:text><xsl:value-of select=\"Valve/@allow\" /><xsl:text>) for manager application</xsl:text><xsl:text>&#xa;</xsl:text>"
      xsl_stmt    : "</xsl:otherwise>"
      xsl_stmt    : "</xsl:choose>"
      xsl_stmt    : "</xsl:when>"
      xsl_stmt    : "<xsl:otherwise>"
      xsl_stmt    : "<xsl:text>FAIL - RemoteAddrValve not configured for manager application</xsl:text><xsl:text>&#xa;</xsl:text>"
      xsl_stmt    : "</xsl:otherwise>"
      xsl_stmt    : "</xsl:choose>"
      xsl_stmt    : "</xsl:for-each>"
      xsl_stmt    : "</xsl:template>"
      expect      : "^PASS"
    </custom_item>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          type        : FILE_CHECK_NOT
          description : "check for conf/Catalina/localhost/manager.xml"
          file        : "@APP_Config_catalogs@/conf/Catalina/localhost/manager.xml"
        </custom_item>

        <custom_item>
          type        : FILE_CHECK_NOT
          description : "check for webapps/manager"
          file        : "@APP_Config_catalogs@/webapps/manager"
        </custom_item>

        <custom_item>
          type        : FILE_CHECK_NOT
          description : "check for host-manager/manager.xml"
          file        : "@APP_Config_catalogs@/webapps/host-manager/manager.xml"
        </custom_item>

        <custom_item>
          type        : FILE_CHECK_NOT
          description : "check for webapps/host-manager"
          file        : "@APP_Config_catalogs@/webapps/host-manager"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "10.5 Rename the manager application"
          info        : "The manager application allows administrators to manage Tomcat remotely via a web interface. The manager application should be renamed to make it harder for attackers or automated scripts to locate.

By relocating the manager applications, an attacker will need to guess its location rather than simply navigate to the standard location in order to carry out an attack."
          solution    : "Perform the following to rename the manager application:

 - Rename the manager application XML file: # mv $CATALINA_HOME/webapps/host-manager/manager.xml \\$CATALINA_HOME/webapps/host-manager/<new-name>.xml
 - Update the docBase attribute within $CATALINA_HOME/webapps/host-manager/

<new-name>

xml to $CATALINA_HOME/webapps/

<new-name>

 - Move $CATALINA_HOME/webapps/manager to $CATALINA_HOME/webapps/

<new-name>

# mv $CATALINA_HOME/webapps/manager $CATALINA_HOME/webapps/<new-name>"
          reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|1.7,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2M,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
          see_also    : "https://workbench.cisecurity.org/benchmarks/21082"
          show_output : YES
        </report>
      </then>
    </if>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "10.6 Enable strict servlet Compliance"
      info        : "The STRICT_SERVLET_COMPLIANCE influences Tomcat's behavior in several subtle ways. See the References below for the complete list. It is recommended that STRICT_SERVLET_COMPLIANCE be set to true

When STRICT_SERVLET_COMPLIANCE is set to true Tomcat will always send an HTTP Content-type header when responding to requests. This is significant as the behavior of web browsers is inconsistent in the absence of the Content-type header. Some browsers will attempt to determine the appropriate content-type by sniffing"
      solution    : "Start Tomcat with strict compliance enabled, add -Dorg.apache.catalina.STRICT_SERVLET_COMPLIANCE=true to your startup script.

Impact:

Changing this to true will change a number of other default values which is likely to break the majority of systems as some browsers are unable to correctly handle the cookie headers that result from a strict adherence to the specifications. Please refer to the referenced documentation for a complete list of changed values. Defaults, regardless of whether or not they have been changed by setting org.apache.catalina.STRICT_SERVLET_COMPLIANCE can always be overridden by explicitly setting the appropriate system property or element attribute."
      reference   : "800-171|3.13.1,800-171r3|03.13.01,800-53|SC-7(8),800-53r5|SC-7(8),CN-L3|8.1.10.6(j),CSCv7|5.1,CSCv8|13.10,CSF|PR.AC-5,CSF|PR.PT-4,CSF2.0|DE.CM-01,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,CSF2.0|PR.IR-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.23,ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(8),LEVEL|2M,NESA|T4.5.4,NIAv2|SU4,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21082"
      file        : "@APP_Binary_catalog@/catalina.sh"
      regex       : "^[^#]+-Dorg\\.apache\\.catalina\\.STRICT_SERVLET_COMPLIANCE[\\s]*=[\\s]*"
      expect      : "^[^#]+-Dorg\\.apache\\.catalina\\.STRICT_SERVLET_COMPLIANCE[\\s]*=[\\s]*(?-i)true(?i)[\\s]*"
    </custom_item>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          type        : FILE_CONTENT_CHECK
          description : "check for ALLOW_BACKSLASH"
          file        : "@APP_Binary_catalog@/catalina.sh"
          regex       : "^[^#]+-Dorg\\.apache\\.catalina\\.connector\\.CoyoteAdapter\\.ALLOW_BACKSLASH[\\s]*=[\\s]*"
          expect      : "^[^#]+-Dorg\\.apache\\.catalina\\.connector\\.CoyoteAdapter\\.ALLOW_BACKSLASH[\\s]*=[\\s]*(?-i)false(?i)[\\s]*"
        </custom_item>

        <custom_item>
          type        : FILE_CONTENT_CHECK
          description : "check for ALLOW_ENCODED_SLASH"
          file        : "@APP_Binary_catalog@/catalina.sh"
          regex       : "^[^#]+-Dorg\\.apache\\.tomcat\\.util\\.buf\\.UDecoder\\.ALLOW_ENCODED_SLASH[\\s]*=[\\s]*"
          expect      : "^[^#]+-Dorg\\.apache\\.tomcat\\.util\\.buf\\.UDecoder\\.ALLOW_ENCODED_SLASH[\\s]*=[\\s]*(?-i)false(?i)[\\s]*"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "10.8 Do not allow additional path delimiters"
          info        : "Being able to specify different path-delimiters on Tomcat creates the possibility that an attacker can access applications that were previously blocked by a proxy like mod_proxy

Allowing additional path-delimiters allows for an attacker to get to an application or area which was not previously visible."
          solution    : "To start Tomcat with ALLOW_BACKSLASH and ALLOW_ENCODED_SLASH set to false add -Dorg.apache.catalina.connector.CoyoteAdapter.ALLOW_BACKSLASH=false and -Dorg.apache.tomcat.util.buf.UDecoder.ALLOW_ENCODED_SLASH=false to your startup script in setenv.sh in CATALINA_BASE/bin."
          reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|5.1,CSCv8|16.7,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2M,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
          see_also    : "https://workbench.cisecurity.org/benchmarks/21082"
          show_output : YES
        </report>
      </then>
    </if>

    <custom_item>
      type        : AUDIT_XML
      description : "10.9 Configure connectionTimeout"
      info        : "The connectionTimeout setting allows Tomcat to close idle sockets after a specific amount of time to save system resources.

Closing idle sockets reduces system resource usage which can provide better performance and help protect against Denial of Service attacks."
      solution    : "Set the connectionTimeout for each connector in $CATALINA_HOME/conf/server.xml ensure to the optimal number of milliseconds based on hardware resources, load, and number of concurrent connections.

connectionTimeout=\"60000\"

Impact:

This timeout will also apply when reading any request body when disableUploadTimeout is not set to false"
      reference   : "800-171|3.4.2,800-171r3|03.04.02,800-53|CM-6,800-53r5|CM-6,CSCv7|5.1,CSCv8|4,CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,LEVEL|2A,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21082"
      file        : "@APP_Config_files@"
      xsl_stmt    : "<xsl:template match=\"/\">"
      xsl_stmt    : "<xsl:for-each select=\"Server/Service/Connector\">"
      xsl_stmt    : "<xsl:choose>"
      xsl_stmt    : "<xsl:when test=\"@connectionTimeout and @connectionTimeout = @CONNECTION_TIMEOUT@\">"
      xsl_stmt    : "<xsl:text>PASS - connectionTimeout set</xsl:text><xsl:text>&#xa;</xsl:text>"
      xsl_stmt    : "</xsl:when>"
      xsl_stmt    : "<xsl:otherwise>"
      xsl_stmt    : "<xsl:text>FAIL - connectionTimeout incorrect (</xsl:text><xsl:value-of select='@connectionTimeout'/><xsl:text>) for Connector </xsl:text><xsl:value-of select='@port' /><xsl:text>&#xa;</xsl:text>"
      xsl_stmt    : "</xsl:otherwise>"
      xsl_stmt    : "</xsl:choose>"
      xsl_stmt    : "</xsl:for-each>"
      xsl_stmt    : "</xsl:template>"
      not_expect  : "^FAIL"
    </custom_item>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          type        : FILE_CHECK_NOT
          description : "check for webapps/manager"
          file        : "@APP_Config_catalogs@/webapps/manager"
        </custom_item>

        <custom_item>
          type        : FILE_CHECK_NOT
          description : "check for /webapps/ROOT"
          file        : "@APP_Config_catalogs@/webapps/ROOT"
        </custom_item>

        <custom_item>
          type        : FILE_CHECK_NOT
          description : "check for /webapps/examples"
          file        : "@APP_Config_catalogs@/webapps/examples"
        </custom_item>

        <custom_item>
          type        : FILE_CHECK_NOT
          description : "check for /webapps/docs"
          file        : "@APP_Config_catalogs@/webapps/docs"
        </custom_item>

        <custom_item>
          type        : FILE_CHECK_NOT
          description : "check for webapps/host-manager"
          file        : "@APP_Config_catalogs@/webapps/host-manager"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "1.1 Remove extraneous files and directories"
          info        : "The installation may provide example applications, documentation, and other directories which may not serve a production use.

Removing sample resources is a defense in depth measure that reduces potential exposures introduced by these resources."
          solution    : "Perform the following to remove extraneous resources:

$ rm -rf $CATALINA_HOME/webapps/docs \\
     $CATALINA_HOME/webapps/examples \\
     $CATALINA_HOME/webapps/ROOT

If the Manager and HOST-Manager application are not utilized, also remove the following resources:

$ rm -rf $CATALINA_HOME/webapps/host-manager \\
     $CATALINA_HOME/webapps/manager"
          reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|2.6,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2M,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
          see_also    : "https://workbench.cisecurity.org/benchmarks/21082"
          show_output : YES
        </report>
      </then>
    </if>

    <custom_item>
      type        : AUDIT_XML
      description : "1.2 Disable Unused Connectors"
      info        : "The default installation of Tomcat includes connectors with default settings. These are traditionally set up for convenience. It is best to remove these connectors and enable only what is needed.

Improperly configured or unnecessarily installed Connectors may lead to a security exposure.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "Within the $CATALINA_HOME/conf/server.xml remove, or comment out, each unused Connector For example, to disable an instance of the HTTPConnector remove the following:

<Connector className=\"org.apache.catalina.connector.http.HttpConnector\"
...
connectionTimeout=\"60000\"/>"
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2M,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21082"
      file        : "@APP_Config_files@"
      xsl_stmt    : "<xsl:template match=\"/\">"
      xsl_stmt    : "<xsl:for-each select=\"Server/Service/Connector\">"
      xsl_stmt    : "<xsl:copy-of select=\".\" />"
      xsl_stmt    : "</xsl:for-each>"
      xsl_stmt    : "</xsl:template>"
      expect      : "^Manual Review Required$"
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "2.1 Alter the Advertised server.info String"
      info        : "The server.info attribute contains the name of the application service. This value is presented to Tomcat clients when clients connect to the tomcat server.

Altering the server.info attribute may increase the complexity for attackers to determine which vulnerabilities affect the server platform."
      solution    : "Perform the following to alter the server platform string that gets displayed when clients connect to the tomcat server.

 - Extract the ServerInfo.properties file from the catalina.jar file: $ cd $CATALINA_HOME/lib$ jar xf catalina.jar org/apache/catalina/util/ServerInfo.properties
 - Navigate to the util directory that was created cd org/apache/catalina/util
 - Open ServerInfo.properties in an editor
 - Update the server.info attribute in the ServerInfo.properties file. server.info=<SomeWebServer>
 - Update the catalina.jar with the modified ServerInfo.properties file. $ jar uf catalina.jar org/apache/catalina/util/ServerInfo.properties"
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|5.1,CSCv7|13.2,CSCv8|16.7,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2M,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21082"
      cmd         : "java -cp @APP_Config_catalogs@/lib/catalina.jar org.apache.catalina.util.ServerInfo | /bin/grep -E 'version'"
      expect      : "^(?-i)((?!(Apache|Tomcat)).)*$"
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "2.2 Alter the Advertised server.number String"
      info        : "The server.number attribute represents the specific version of Tomcat that is executing. This value is presented to Tomcat clients when connect.

Advertising a valid server version may provide attackers with information useful for locating vulnerabilities that affect the server platform. Altering the server version string may increase the complexity for attackers to determine which vulnerabilities affect the server platform.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "Perform the following to alter the server version string that gets displayed when clients connect to the server.

 - Extract the ServerInfo.properties file from the catalina.jar file: $ cd $CATALINA_HOME/lib$ jar xf catalina.jar org/apache/catalina/util/ServerInfo.properties
 - Navigate to the util directory that was created $ cd org/apache/Catalina/util
 - Open ServerInfo.properties in an editor
 - Update the server.number attribute server.number=<someversion>
 - Update the catalina.jar with the modified ServerInfo.properties file. $ jar uf catalina.jar org/apache/catalina/util/ServerInfo.properties"
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|13.2,CSCv8|16.7,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2M,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21082"
      cmd         : "java -cp @APP_Config_catalogs@/lib/catalina.jar org.apache.catalina.util.ServerInfo | /bin/grep -E 'number'"
      expect      : "^Manual Review Required$"
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "2.3 Alter the Advertised server.built Date"
      info        : "The server.built date represents the date which Tomcat was compiled and packaged. This value is presented to Tomcat clients when clients connect to the server.

Altering the server.built string may make it harder for attackers to fingerprint which vulnerabilities affect the server platform.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "Perform the following to alter the server version string that gets displayed when clients connect to the server.

 - Extract the ServerInfo.properties file from the catalina.jar file: $ cd $CATALINA_HOME/lib$ jar xf catalina.jar org/apache/catalina/util/ServerInfo.properties
 - Navigate to the util directory that was created $ cd org/apache/Catalina/util
 - Open ServerInfo.properties in an editor
 - Update the server.built attribute in the ServerInfo.properties file. server.built=
 - Update the catalina.jar with the modified ServerInfo.properties file. $ jar uf catalina.jar org/apache/catalina/util/ServerInfo.properties"
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|13.2,CSCv8|16.7,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2M,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21082"
      cmd         : "java -cp @APP_Config_catalogs@/lib/catalina.jar org.apache.catalina.util.ServerInfo | /bin/grep -E 'built'"
      expect      : "^Manual Review Required$"
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      type        : AUDIT_XML
      description : "2.4 Disable X-Powered-By HTTP Header and Rename the Server Value for all Connectors"
      info        : "The xpoweredBy setting determines if Apache Tomcat will advertise its presence via the X-Powered-By HTTP header. It is recommended that this value be set to false The server attribute overrides the default value that is sent down in the HTTP header further masking Apache Tomcat.

Preventing Tomcat from advertising its presence in this manner may increase the complexity for attackers to determine which vulnerabilities affect the server platform."
      solution    : "Perform the following to prevent Tomcat from advertising its presence via the X-PoweredBy HTTP header.

 - Add the xpoweredBy attribute to each Connector specified in $CATALINA_HOME/conf/server.xml Set the xpoweredBy attributes value to false <Connector...xpoweredBy=\"false\" /> Alternatively, ensure the xpoweredBy attribute for each Connector specified in $CATALINA_HOME/conf/server.xml is absent.
 - Add the server attribute to each Connector specified in $CATALINA_HOME/conf/server.xml Set the server attribute value to anything except a blank string."
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|13.2,CSCv8|16.7,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21082"
      file        : "@APP_Config_files@"
      xsl_stmt    : "<xsl:template match=\"/\">"
      xsl_stmt    : "<xsl:for-each select=\"Server/Service/Connector\">"
      xsl_stmt    : "<xsl:choose>"
      xsl_stmt    : "<xsl:when test=\"@xPoweredBy = 'false'\">"
      xsl_stmt    : "<xsl:text>PASS - xPoweredBy is disabled for port </xsl:text><xsl:value-of select=\"@port\" /><xsl:text>&#xa;</xsl:text>"
      xsl_stmt    : "</xsl:when>"
      xsl_stmt    : "<xsl:when test=\"@xPoweredBy = 'true'\">"
      xsl_stmt    : "<xsl:text>FAIL - xPoweredBy is enabled for port </xsl:text><xsl:value-of select=\"@port\" /><xsl:text>&#xa;</xsl:text>"
      xsl_stmt    : "</xsl:when>"
      xsl_stmt    : "<xsl:otherwise>"
      xsl_stmt    : "<xsl:text>PASS - xPoweredBy not used for port </xsl:text><xsl:value-of select=\"@port\" /><xsl:text>&#xa;</xsl:text>"
      xsl_stmt    : "</xsl:otherwise>"
      xsl_stmt    : "</xsl:choose>"
      xsl_stmt    : "</xsl:for-each>"
      xsl_stmt    : "</xsl:template>"
      expect      : "^PASS"
    </custom_item>

    <custom_item>
      type        : AUDIT_XML
      description : "2.7 Ensure Sever Header is Modified To Prevent Information Disclosure"
      info        : "The server header is a vanity header developed to help identify the underlying technology in a server for troubleshooting and identification. This header is unnecessary and could be used to target your website for exploitation. Tomcat does not provide the ability to remove the server header, however, it does provide the ability to modify the header.

The server header may specify the underlying technology used by an application. Attackers are able to conduct reconnaissance on a website using these response headers. This header could be used to target attacks for specific known vulnerabilities associated with the underlying technology. Removing this header will prevent targeting of your application for specific exploits by non-determined attackers.

While this is not the only way to fingerprint a site through the response headers, it makes it harder and prevents some potential attackers from targeting your website."
      solution    : "In $CATALINA_HOME/conf/server.xml add the server directive to the connector as shown below replacing apache with the text of your choosing. This text should not help in identifying the server.

<Connector port=\"8443\" server=\"I am a teapot\" redirectPort=\"8080\" />

Scripted:

 - If you do not have the header defined: sed -ir 's/Connector/Connector server=\"I am a teapot\"/g' $CATALINA_HOME/conf/server.xml
 - If you already have a header but it is still revealing sed -ir 's/server=\"[^\"]*\"/server=\"I Am A Teapot\"/g' $CATALINA_HOME/conf/server.xml"
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|13.2,CSCv8|16.7,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21082"
      file        : "@APP_Config_files@"
      xsl_stmt    : "<xsl:template match=\"/\">"
      xsl_stmt    : "<xsl:for-each select=\"Server/Service/Connector\">"
      xsl_stmt    : "<xsl:choose>"
      xsl_stmt    : "<xsl:when test=\"not(@server) or @server='@SERVER_HEADER@'\">"
      xsl_stmt    : "<xsl:text>PASS - server header set correctly on port </xsl:text><xsl:value-of select=\"@port\" /><xsl:text>&#xa;</xsl:text>"
      xsl_stmt    : "</xsl:when>"
      xsl_stmt    : "<xsl:otherwise>"
      xsl_stmt    : "<xsl:text>FAIL - server header set incorrectly (</xsl:text><xsl:value-of select=\"@server\" /><xsl:text>) on port </xsl:text><xsl:value-of select=\"@port\" /><xsl:text>&#xa;</xsl:text>"
      xsl_stmt    : "</xsl:otherwise>"
      xsl_stmt    : "</xsl:choose>"
      xsl_stmt    : "</xsl:for-each>"
      xsl_stmt    : "</xsl:template>"
      not_expect  : "^FAIL"
    </custom_item>

    <custom_item>
      type        : AUDIT_XML
      description : "3.2 Disable the Shutdown port"
      info        : "Tomcat listens on TCP port 8005 to accept shutdown requests. By connecting to this port and sending the SHUTDOWN command, all applications within Tomcat are halted. The shutdown port is not exposed to the network as it is bound to the loopback interface. If this functionality is not used, it is recommended that the shutdown port be disabled.

Disabling the Shutdown port will eliminate the risk of malicious local entities using the shutdown command to disable the Tomcat server."
      solution    : "Set the port to -1 in the $CATALINA_HOME/conf/server.xml to disable the shutdown port:

<Server port=\"-1\" shutdown=\"SHUTDOWN\">"
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.5,800-171|3.13.6,800-171r3|03.04.02,800-171r3|03.04.06,800-171r3|03.13.01,800-171r3|03.13.06,800-53|CA-9,800-53|CM-6,800-53|CM-7,800-53|SC-7,800-53|SC-7(5),800-53r5|CA-9,800-53r5|CM-6,800-53r5|CM-7,800-53r5|SC-7,800-53r5|SC-7(5),CN-L3|7.1.2.2(c),CN-L3|8.1.10.6(j),CSCv7|1.7,CSCv7|9.2,CSCv8|4.4,CSCv8|4.8,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,CSF2.0|DE.CM-01,CSF2.0|DE.CM-09,CSF2.0|ID.AM-03,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,CSF2.0|PR.IR-01,CSF2.0|PR.PS-01,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),ISO-27001-2022|A.5.14,ISO-27001-2022|A.8.9,ISO-27001-2022|A.8.16,ISO-27001-2022|A.8.20,ISO/IEC-27001|A.13.1.3,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|SC-7,ITSG-33|SC-7(5),LEVEL|2A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS7b,NIAv2|NS25,NIAv2|SS15a,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.3,TBA-FIISB|43.1"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21082"
      file        : "@APP_Config_files@"
      xsl_stmt    : "<xsl:template match=\"/\">"
      xsl_stmt    : "<xsl:choose>"
      xsl_stmt    : "<xsl:when test=\"Server/@port=-1\">"
      xsl_stmt    : "<xsl:text>PASS - Value of shutdown port (</xsl:text><xsl:value-of select=\"Server/@port\" /><xsl:text>) configured correctly</xsl:text><xsl:text>&#xa;</xsl:text>"
      xsl_stmt    : "</xsl:when>"
      xsl_stmt    : "<xsl:otherwise>"
      xsl_stmt    : "<xsl:text>FAIL - Value of shutdown port (</xsl:text><xsl:value-of select=\"Server/@port\" /><xsl:text>) configured incorrectly</xsl:text><xsl:text>&#xa;</xsl:text>"
      xsl_stmt    : "</xsl:otherwise>"
      xsl_stmt    : "</xsl:choose>"
      xsl_stmt    : "</xsl:template>"
      expect      : "^PASS"
    </custom_item>

    <custom_item>
      type        : AUDIT_XML
      description : "5.1 Use secure Realms"
      info        : "A realm is a database of usernames and passwords used to identify valid users of web applications. Review the Realms configuration to ensure Tomcat is not configured to use MemoryRealm JDBCRealm UserDatabaseRealm or JAASRealm

According to the Tomcat documentation: MemoryRealm and JDBCRealm are not designed for production usage and could result in reduced availability; the UserDatabaseRealm is not intended for large-scale installations; and the JAASRealm is not widely used and therefore the code is not as mature as the other realms."
      solution    : "Set the Realm className setting in $CATALINA_HOME/conf/server.xml to one of the appropriate realms."
      reference   : "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-171r3|03.01.02,800-171r3|03.01.04,800-171r3|03.01.05a.,800-171r3|03.08.02,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,CSF2.0|PR.AA-05,CSF2.0|PR.DS-10,CSF2.0|PR.IR-01,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO-27001-2022|A.5.3,ISO-27001-2022|A.5.10,ISO-27001-2022|A.5.15,ISO-27001-2022|A.5.33,ISO-27001-2022|A.7.7,ISO-27001-2022|A.7.10,ISO-27001-2022|A.8.2,ISO-27001-2022|A.8.3,ISO-27001-2022|A.8.18,ISO-27001-2022|A.8.20,ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|2A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21082"
      file        : "@APP_Config_files@"
      xsl_stmt    : "<xsl:template match=\"/\">"
      xsl_stmt    : "<xsl:variable name=\"realms\" select=\"'org.apache.catalina.realm.MemoryRealm,org.apache.catalina.realm.JDBCRealm,org.apache.catalina.realm.UserDatabaseRealm,org.apache.catalina.realm.JAASRealm'\" />"
      xsl_stmt    : "<xsl:for-each select=\"Server/Service/Engine//Realm\">"
      xsl_stmt    : "<xsl:choose>"
      xsl_stmt    : "<xsl:when test=\"contains($realms, @className)\">"
      xsl_stmt    : "<xsl:text>FAIL - insecure realm </xsl:text><xsl:value-of select=\"@className\" /><xsl:text> found</xsl:text><xsl:text>&#xa;</xsl:text>"
      xsl_stmt    : "</xsl:when>"
      xsl_stmt    : "<xsl:otherwise>"
      xsl_stmt    : "<xsl:text>PASS - realm </xsl:text><xsl:value-of select=\"@className\" /><xsl:text> found</xsl:text><xsl:text>&#xa;</xsl:text>"
      xsl_stmt    : "</xsl:otherwise>"
      xsl_stmt    : "</xsl:choose>"
      xsl_stmt    : "</xsl:for-each>"
      xsl_stmt    : "</xsl:template>"
      not_expect  : "^FAIL"
    </custom_item>

    <custom_item>
      type        : AUDIT_XML
      description : "5.2 Use LockOut Realms"
      info        : "A LockOut realm wraps around standard realms adding the ability to lock a user out after multiple failed logins.

Locking out a user after multiple failed logins slows down attackers from brute forcing logins."
      solution    : "Create a lockout realm wrapping the main realm similar to the example below:

<Realm className=\"org.apache.catalina.realm.LockOutRealm\"
failureCount=\"3\" lockOutTime=\"600\" cacheSize=\"1000\"
cacheRemovalWarningTime=\"3600\">
    <Realm
className=\"org.apache.catalina.realm.DataSourceRealm\"
dataSourceName=... />
</Realm>"
      reference   : "800-171|3.4.2,800-171r3|03.04.02,800-53|CM-6,800-53r5|CM-6,CSCv7|5.1,CSCv8|4,CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,LEVEL|2A,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21082"
      file        : "@APP_Config_files@"
      xsl_stmt    : "<xsl:template match=\"/\">"
      xsl_stmt    : "<xsl:for-each select=\"Server/Service/Engine/Realm\">"
      xsl_stmt    : "<xsl:choose>"
      xsl_stmt    : "<xsl:when test=\"contains(@className, 'org.apache.catalina.realm.LockOutRealm')\">"
      xsl_stmt    : "<xsl:text>PASS - LockoutRealm found</xsl:text><xsl:text>&#xa;</xsl:text>"
      xsl_stmt    : "</xsl:when>"
      xsl_stmt    : "<xsl:otherwise>"
      xsl_stmt    : "<xsl:text>FAIL - No LockoutRealm found</xsl:text><xsl:text>&#xa;</xsl:text>"
      xsl_stmt    : "</xsl:otherwise>"
      xsl_stmt    : "</xsl:choose>"
      xsl_stmt    : "</xsl:for-each>"
      xsl_stmt    : "</xsl:template>"
      expect      : "^PASS"
    </custom_item>

    <if>
      <condition auto:"WARNING" type:"AND">
        <custom_item>
          type        : AUDIT_XML
          description : "check for certificateValidation"
          file        : "@APP_Config_files@"
          xsl_stmt    : "<xsl:template match=\"/\">"
          xsl_stmt    : "<xsl:for-each select=\"Server/Service/Connector\">"
          xsl_stmt    : "<xsl:choose>"
          xsl_stmt    : "<xsl:when test=\"SSLHostConfig/@certificateVerification='required'\">"
          xsl_stmt    : "<xsl:text>PASS - certificateVerification set for connector on port </xsl:text><xsl:value-of select=\"@port\" /><xsl:text>&#xa;</xsl:text>"
          xsl_stmt    : "</xsl:when>"
          xsl_stmt    : "<xsl:otherwise>"
          xsl_stmt    : "<xsl:text>FAIL - certificateVerification not set on port </xsl:text><xsl:value-of select=\"@port\" /><xsl:text>&#xa;</xsl:text>"
          xsl_stmt    : "</xsl:otherwise>"
          xsl_stmt    : "</xsl:choose>"
          xsl_stmt    : "</xsl:for-each>"
          xsl_stmt    : "</xsl:template>"
          expect      : "^Manual Review Required$"
          severity    : MEDIUM
        </custom_item>

        <custom_item>
          type        : AUDIT_XML
          description : "check for clientAuth"
          file        : "@APP_Config_files@"
          xsl_stmt    : "<xsl:template match=\"/\">"
          xsl_stmt    : "<xsl:for-each select=\"Server/Service/Connector\">"
          xsl_stmt    : "<xsl:choose>"
          xsl_stmt    : "<xsl:when test=\"@clientAuth='true'\">"
          xsl_stmt    : "<xsl:text>PASS - clientAuth set for connector on port </xsl:text><xsl:value-of select=\"@port\" /><xsl:text>&#xa;</xsl:text>"
          xsl_stmt    : "</xsl:when>"
          xsl_stmt    : "<xsl:otherwise>"
          xsl_stmt    : "<xsl:text>FAIL - clientAuth not set on port </xsl:text><xsl:value-of select=\"@port\" /><xsl:text>&#xa;</xsl:text>"
          xsl_stmt    : "</xsl:otherwise>"
          xsl_stmt    : "</xsl:choose>"
          xsl_stmt    : "</xsl:for-each>"
          xsl_stmt    : "</xsl:template>"
          expect      : "^Manual Review Required$"
          severity    : MEDIUM
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "6.1 Setup Client-cert Authentication"
          info        : "Client-cert authentication requires that each client connecting to the server have a certificate to authenticate. This is generally regarded as stronger authentication than a password as it requires the client to have the certificate and not just know a password.

Certificate based authentication is more secure than password based authentication.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
          solution    : "In the Connector element, set the clientAuth parameter to true and the certificateVerification to required

<-- Define a SSL Coyote HTTP/1.1 Connector on port 8443 -->

<Connector
     port=\"8443\" minProcessors=\"5\" maxProcessors=\"75\"
     enableLookups=\"true\" disableUploadTimeout=\"true\"
     acceptCount=\"100\" debug=\"0\" scheme=\"https\" secure=\"true\";
     clientAuth=\"true\" sslProtocol=\"TLS\"/>
...
<Connector ...>
     <SSLHostConfig
      certificateVerification=\"required\"
     />"
          reference   : "800-171|3.5.2,800-171r3|03.05.07,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|16.4,CSCv8|5.2,CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.17,ITSG-33|IA-5(1),LEVEL|2A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1"
          see_also    : "https://workbench.cisecurity.org/benchmarks/21082"
          show_output : YES
        </report>
      </then>
    </if>

    <custom_item>
      type        : FILE_CHECK
      description : "7.1 Application specific logging"
      info        : "By default, java.util.logging does not provide the capabilities to configure per-web application settings, only per VM. In order to overcome this limitation Tomcat implements JULI as a wrapper for java.util.logging JULI provides additional configuration functionality so you can set each web application with different logging specifications.

Establishing per application logging profiles will help ensure that each application's logging verbosity is set to an appropriate level in order to provide appropriate information when needed for security review."
      solution    : "Create a logging.properties file and place that into your application WEB-INF/classes directory.

Note: By default, installing Tomcat places a logging.properties file in $CATALINA_HOME/conf This file can be used as base for an application specific logging properties file"
      reference   : "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-171r3|03.03.02a.,800-171r3|03.03.02b.,800-171r3|03.03.03,800-171r3|03.03.06a.,800-53|AU-3,800-53|AU-3(1),800-53|AU-7,800-53|AU-12,800-53r5|AU-3,800-53r5|AU-3(1),800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.2.3(c),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|8.1.4.3(b),CSCv7|6.3,CSCv8|8.5,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|DE.CM-09,CSF2.0|PR.PS-04,CSF2.0|RS.AN-03,CSF2.0|RS.AN-06,CSF2.0|RS.AN-07,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO-27001-2022|A.5.28,ISO-27001-2022|A.8.15,ITSG-33|AU-3,ITSG-33|AU-3(1),ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|2A,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21082"
      file        : "@APP_Config_catalogs@/webapps/@WEB_APP_DIR@/WEB-INF/classes/logging.properties"
    </custom_item>

    <custom_item>
      type        : AUDIT_XML
      description : "7.3 Ensure className is set correctly in context.xml"
      info        : "Ensure the className attribute is set to AccessLogValve The className attribute determines the access log valve to be used for logging.

Some log valves are not suited for production and should not be used. Apache recommends org.apache.catalina.valves.AccessLogValve"
      solution    : "Add the following statement into the $CATALINA_BASE/webapps/

<app_name>

/META-INF/context.xml file if it does not already exist.

<Valve
className=\"org.apache.catalina.valves.AccessLogValve\"
directory=\"$CATALINA_HOME/logs/\"
prefix=\"access_log\"
fileDateFormat=\"yyyy-MM-dd.HH\"
suffix=\".log\"
pattern=\"%h %t %H cookie:%{SESSIONID}c request:%{SESSIONID}r %m %U %s %q %r\"
/>"
      reference   : "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-171r3|03.03.02a.,800-171r3|03.03.02b.,800-171r3|03.03.03,800-171r3|03.03.06a.,800-53|AU-3,800-53|AU-3(1),800-53|AU-7,800-53|AU-12,800-53r5|AU-3,800-53r5|AU-3(1),800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.2.3(c),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|8.1.4.3(b),CSCv7|6.3,CSCv8|8.5,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|DE.CM-09,CSF2.0|PR.PS-04,CSF2.0|RS.AN-03,CSF2.0|RS.AN-06,CSF2.0|RS.AN-07,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO-27001-2022|A.5.28,ISO-27001-2022|A.8.15,ITSG-33|AU-3,ITSG-33|AU-3(1),ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|2A,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21082"
      file        : "@APP_Config_catalogs@/webapps/@WEB_APP_DIR@/META-INF/context.xml"
      xsl_stmt    : "<xsl:template match=\"/Context\">"
      xsl_stmt    : "<xsl:choose>"
      xsl_stmt    : "<xsl:when test=\"Valve/@className='org.apache.catalina.valves.AccessLogValve'\">"
      xsl_stmt    : "<xsl:text>PASS - AccessLogValve is set </xsl:text><xsl:text>&#xa;</xsl:text>"
      xsl_stmt    : "</xsl:when>"
      xsl_stmt    : "<xsl:otherwise>"
      xsl_stmt    : "<xsl:text>FAIL - AccessLogValve not set</xsl:text><xsl:text>&#xa;</xsl:text>"
      xsl_stmt    : "</xsl:otherwise>"
      xsl_stmt    : "</xsl:choose>"
      xsl_stmt    : "</xsl:template>"
      expect      : "^PASS"
    </custom_item>

    <custom_item>
      type        : AUDIT_XML
      description : "9.1 Disabling auto deployment of applications"
      info        : "Tomcat allows auto deployment of applications while Tomcat is running. It is recommended that this capability be disabled.

This could allow malicious or untested applications to be deployed and should be disabled."
      solution    : "In the $CATALINA_HOME/conf/server.xml file, change autoDeploy to false

autoDeploy=\"false\""
      reference   : "800-171|3.4.2,800-171r3|03.04.02,800-53|CM-6,800-53r5|CM-6,CSCv7|5.1,CSCv8|4,CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,LEVEL|2A,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21082"
      file        : "@APP_Config_files@"
      xsl_stmt    : "<xsl:template match=\"/\">"
      xsl_stmt    : "<xsl:for-each select=\"Server/Service/Engine/Host\">"
      xsl_stmt    : "<xsl:choose>"
      xsl_stmt    : "<xsl:when test=\"./@autoDeploy='false'\">"
      xsl_stmt    : "<xsl:text>PASS - AutoDeploy disabled for </xsl:text><xsl:value-of select=\"./@name\" /><xsl:text>&#xa;</xsl:text>"
      xsl_stmt    : "</xsl:when>"
      xsl_stmt    : "<xsl:otherwise>"
      xsl_stmt    : "<xsl:text>FAIL - AutoDeploy enabled for </xsl:text><xsl:value-of select=\"./@name\" /><xsl:text>&#xa;</xsl:text>"
      xsl_stmt    : "</xsl:otherwise>"
      xsl_stmt    : "</xsl:choose>"
      xsl_stmt    : "</xsl:for-each>"
      xsl_stmt    : "</xsl:template>"
      not_expect  : "^FAIL"
    </custom_item>

    <custom_item>
      type        : AUDIT_XML
      description : "9.2 Disable deploy on startup of applications"
      info        : "Tomcat allows auto deployment of applications on startup. It is recommended that this capability be disabled.

This could allow malicious or untested applications to be deployed and should be disabled."
      solution    : "In the $CATALINA_HOME/conf/server.xml file, change deployOnStartup to false

deployOnStartup=\"false\""
      reference   : "800-171|3.4.2,800-171r3|03.04.02,800-53|CM-6,800-53r5|CM-6,CSCv7|5.1,CSCv8|4,CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,LEVEL|2A,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21082"
      file        : "@APP_Config_files@"
      xsl_stmt    : "<xsl:template match=\"/\">"
      xsl_stmt    : "<xsl:for-each select=\"Server/Service/Engine/Host\">"
      xsl_stmt    : "<xsl:choose>"
      xsl_stmt    : "<xsl:when test=\"./@deployOnStartup='false'\">"
      xsl_stmt    : "<xsl:text>PASS - deployOnStartup disabled for </xsl:text><xsl:value-of select=\"./@name\" /><xsl:text>&#xa;</xsl:text>"
      xsl_stmt    : "</xsl:when>"
      xsl_stmt    : "<xsl:otherwise>"
      xsl_stmt    : "<xsl:text>FAIL - deployOnStartup enabled for </xsl:text><xsl:value-of select=\"./@name\" /><xsl:text>&#xa;</xsl:text>"
      xsl_stmt    : "</xsl:otherwise>"
      xsl_stmt    : "</xsl:choose>"
      xsl_stmt    : "</xsl:for-each>"
      xsl_stmt    : "</xsl:template>"
      not_expect  : "^FAIL"
    </custom_item>
  </then>

  <else>
    <report type:"WARNING">
      description : "CIS_Apache_Tomcat_11_v1.0.0_L2.audit from CIS Apache Tomcat 11 Benchmark v1.0.0"
      info        : "NOTE: Nessus has not identified that the chosen audit applies to the target device."
      see_also    : "https://workbench.cisecurity.org/benchmarks/21082"
      show_output : YES
    </report>
  </else>
</if>

</check_type>
