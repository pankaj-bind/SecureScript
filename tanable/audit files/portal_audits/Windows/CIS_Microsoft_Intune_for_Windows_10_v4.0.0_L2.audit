#TRUSTED 28196c1edc8d405afa331a001206ac0604b6384d677f12ecf8db6a3a9ac40ed0dd35347b527d52ef9e7cb9a6b6f1c11d31941f53387353b5fa34e35e7f922b62c0f1f56fd8ca50852d537c2c945e00624e78711f023f1fba308c1a380306946d24dfdd731760608ab95e7ae7d32498dc33bcebb29f6fc0d5018b16d05f881ee297832ddb432071c7a454bdf20f88e5fe0781b620f85c0f292b26370152b0f5bb08faf0793f017aac38b6dd9b134158e1fb890a6a83c83ab296b3b58ab0587fa0e2679c189b97d2ea42b8ce63e14af10a0254ef127dffe3d33c27675159e68c809a312adba2635c5cb5d246aeae538ae56c2297f3bb467428dff8488a89ccf8056169204a968c7d5115607c160a3e0d338cc5bc6e1ec04c898003450a142b75c7f6ae15171be12d94262ec9d581707b34b22ca1d15b3a93967e1306773d994d3bcd28f829868e1a4580c35d76510a83468b6cc5e5f7606d5a955095b5e4897b4877b6e1de7f98faf1031ac3d32e47a91949d6c3d54e30a7d45a6147548388408411b27e22b1cc0ac66c3ddcb5a24cdeea1478ae3ff36eedd4b5c4af29f547b5320dd59eb87a657579760d1d926c3fa34b84356f2160515989a2882571c474031269c22f60ca99482a7732e059539e55c89078a50fd19ab146b359b5b8707a616e6bdc3e4982f3313c0996e45aff2467bc4785ed32dc6ba5027935f0d65f43995d
#TRUST-RSA-SHA256 0ca73c53a21cd387b6ef4201ebbcb991281fc4f1e3d2cb3c8802078634ff0dc1efab3fb67f42d9b645aa3a44ac1f0cc2addbdc874ca14f2aa23b9c9dadf086da8254fdd8bfcaaa795664a6543f1e7ac28dab8b5f882c60f88ddc2198c267c62d615a5991b09b687b6ec311a666007d7f2242b7756951067829a9d33ed87c6ce2f940b6c4c48aed0388d6473514cb3e10c79ee988166173649fa75712661abaded8ddc890d6004d71e5721b31e7c3fda5ba649cb89c7a3ca2955b38500910711c425b070ae3d8248c3eeb153fc27d7fcb302a250904325d0a6aaba80ed45ce4eefc9e7ee2a86ca1b927edac2884b009203de14a81062c1a68d8b781a6205020504c2db4ec5351e32652b058e8ff421ddb9217d2dc41f6af25df9fccd1f71bd863d8bc44c99de98fb4714e4e8c2d6f5726fca4fd1a5e1e99d7d5ba342de1d9286cd915d91f1da56e55303734e013194ee41902b73e41e3e945a4367e66127a11b9d81cdf2a80ef98fe4e8ea0cb039eb0da600d7d838133fdb62e404c7b79ba11ce5d98c97a05f5f72dc163cce255ca1fc2cc5a51b747f350609bffabc93c2926c68bd46506f454ef93f2102852a347a5ed0980df84bf2db82a035ad113599002c2292d440f7c67793b50eb3db57975e5ce42050ab16af3e5dc82e2cebaee88127206cdba30f099b9a4c37f4df7248146c7fff38fba990675315e5dd5cfc0db6012
#
# This script is Copyright (C) 2004-2025 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
# $Revision: 1.0 $
# $Date: 2025/06/25 $
#
# description : This .audit is designed against the CIS Microsoft Intune for Windows 10 Benchmark 4.0.0
#
#<ui_metadata>
#<display_name>CIS Microsoft Intune for Windows 10 v4.0.0 L2</display_name>
#<spec>
#  <type>CIS</type>
#  <name>Microsoft Intune for Windows 10</name>
#  <profile>L2</profile>
#  <version>4.0.0</version>
#  <link>https://workbench.cisecurity.org/benchmarks/21767</link>
#</spec>
#<labels>windows,cis,microsoft_intune_for_windows_10,agent</labels>
#<benchmark_refs>CSCv6,CSCv7,CSCv8,LEVEL</benchmark_refs>
#<variables>
#  <variable>
#    <name>BUILD_VERSION</name>
#    <default>(1900[0-9]|190[1-9][0-9]|1[0-9][1-9][0-9]{2})</default>
#    <description>Windows Build Version</description>
#    <info>Windows build Version found under HKLM\Software\Microsoft\Windows Nt\Currentversion:CurrentBuild</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>PLATFORM_VERSION</name>
#    <default>10</default>
#    <description>Windows Version</description>
#    <info>The version of Windows 10 to match against in the platform check.</info>
#    <value_type>STRING</value_type>
#  </variable>
#</variables>
#</ui_metadata>

<check_type:"Windows" version:"2">
<group_policy:"CIS Microsoft Intune for Windows 10">

<if>
  <condition type:"AND">
    <custom_item>
      type        : REGISTRY_SETTING
      description : "Windows 10 build installed"
      value_type  : POLICY_TEXT
      value_data  : "@BUILD_VERSION@"
      reg_key     : "HKLM\Software\Microsoft\Windows Nt\Currentversion"
      reg_item    : "CurrentBuild"
      check_type  : CHECK_REGEX
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "Windows 10 is installed"
      value_type  : POLICY_TEXT
      value_data  : "^[Ww][Ii][Nn][Dd][Oo][Ww][Ss] @PLATFORM_VERSION@.+$"
      reg_key     : "HKLM\Software\Microsoft\Windows Nt\Currentversion"
      reg_item    : "ProductName"
      check_type  : CHECK_REGEX
    </custom_item>

    <custom_item>
      type        : REG_CHECK
      description : "Target is enrolled with Microsoft Intune"
      value_type  : POLICY_TEXT
      value_data  : "HKLM\Software\Microsoft\Provisioning\OMADM\Logger"
      reg_option  : MUST_EXIST
      key_item    : "CurrentEnrollmentId"
    </custom_item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "CIS_Microsoft_Intune_for_Windows_10_v4.0.0_L2.audit from CIS Microsoft Intune for Windows 10 Benchmark v4.0.0"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      show_output : YES
    </report>

    <custom_item>
      type         : GUID_REGISTRY_SETTING
      description  : "12.1 (L2) Ensure 'Allow Camera' is set to 'Not allowed'"
      info         : "This policy setting controls whether the use of Camera devices on the machine are permitted.

The recommended state for this setting is: Not allowed

Cameras in a high security environment can pose serious privacy and data exfiltration risks - they should be disabled to help mitigate that risk."
      solution     : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Not allowed :

Camera\Allow Camera

Impact:

Users will not be able to utilize the camera on a system."
      reference    : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also     : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type   : POLICY_DWORD
      value_data   : "0"
      reg_key      : "HKLM\Software\Microsoft\PolicyManager\Providers\{GUID}\Default\Device\Camera"
      reg_item     : "AllowCamera"
      reg_option   : CAN_NOT_BE_NULL
      guid_reg_key : "HKLM\Software\Microsoft\PolicyManager\Current\Device\Camera"
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "22.24 (L2) Ensure 'Enable Convert Warn To Block' is set to 'Warn verdicts are converted to block'"
      info        : "This policy setting controls whether Microsoft Defender Antivirus network protection will display a warning, or block network traffic.

The recommended state for this setting is: Warn verdicts are converted to block

Potentially suspicious network traffic should be blocked until it has been reviewed, and an exception has been granted."
      solution    : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Warn verdicts are converted to block

Defender\Enable Convert Warn To Block

Impact:

Legitimate network traffic could be blocked by Microsoft Defender Antivirus network protection."
      reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-171r3|03.14.02,800-53|SI-3,800-53r5|SI-3,CN-L3|7.1.3.6(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CSCv7|8.1,CSCv8|10.1,CSF|DE.CM-4,CSF|DE.DP-3,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.7,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,LEVEL|2A,NIAv2|GS8a,PCI-DSSv3.2.1|5.1,PCI-DSSv3.2.1|5.1.1,PCI-DSSv4.0|5.2.1,QCSC-v1|3.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "1"
      reg_key     : "HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Policy Manager"
      reg_item    : "EnableConvertWarnToBlock"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "22.25 (L2) Ensure 'Enable File Hash Computation' is set to 'Enable'"
      info        : "This setting determines whether hash values are computed for files scanned by Microsoft Defender.

The recommended state for this setting is: Enable

When running an antivirus solution such as Microsoft Defender Antivirus, it is important to ensure that it is configured to monitor for suspicious and known malicious activity. File hashes are a reliable way of detecting changes to files, and can speed up the scan process by skipping files that have not changed since they were last scanned and determined to be safe. A changed file hash can also be cause for additional scrutiny."
      solution    : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Enable

Defender\Enable File Hash Computation

Impact:

This setting could cause performance degradation during initial deployment and for users where new executable content is frequently being created (such as software developers), or where applications are frequently installed or updated.

For more information on this setting, please visit

Security baseline (FINAL): Windows 10 and Windows Server, version 2004 - Microsoft Tech Community - 1543631

.

Note: The impact of this setting should be monitored closely during deployment to ensure user and system performance impact is within acceptable limits."
      reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-171r3|03.14.02,800-53|SI-3,800-53r5|SI-3,CN-L3|7.1.3.6(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CSCv7|8.1,CSCv8|10.1,CSF|DE.CM-4,CSF|DE.DP-3,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.7,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,LEVEL|2A,NIAv2|GS8a,PCI-DSSv3.2.1|5.1,PCI-DSSv3.2.1|5.1.1,PCI-DSSv4.0|5.2.1,QCSC-v1|3.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "1"
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender\Policy Manager"
      reg_item    : "EnableFileHashComputation"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "22.31 (L2) Ensure 'Remote Encryption Protection Aggressiveness' is set to 'Medium' or higher"
      info        : "This policy setting configures how aggressively Remote Encryption Prevention Protection blocks malicious IP addresses.

The recommended state for this setting is: Medium: Use cloud aggregation and block when confidence level is above 99% or higher. Configuring this setting to High: Use cloud intel and context, and block when confidence level is above 90% also conforms to the benchmark.

Note: As of the publication of this Benchmark, the setting configuration state in Intune is the sentence above after

The recommended state for this setting is:

and not

Medium

or higher as the title states. This was done to keep title length to a minimum.

This feature can help reduce the likelihood of users visiting malicious websites."
      solution    : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Medium: Use cloud aggregation and block when confidence level is above 99% or High: Use cloud intel and context, and block when confidence level is above 90%

Defender\Remote Encryption Protection Aggressiveness

Impact:

Legitimate websites could be blocked by Remote Encryption Prevention Protection. When set to Medium, blocks will occur when the confidence level is above 99%. When set to High, blocks will occur when confidence level is above 90%."
      reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-171r3|03.14.02,800-53|SI-3,800-53r5|SI-3,CN-L3|7.1.3.6(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CSCv7|8.1,CSCv8|10.1,CSF|DE.CM-4,CSF|DE.DP-3,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.7,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,LEVEL|2A,NIAv2|GS8a,PCI-DSSv3.2.1|5.1,PCI-DSSv3.2.1|5.1.1,PCI-DSSv4.0|5.2.1,QCSC-v1|3.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "1" || "2"
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender\Policy Manager"
      reg_item    : "RemoteEncryptionProtectionAggressiveness"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type                  : GUID_REGISTRY_SETTING
      description           : "34.2 (L2) Ensure 'Allow Windows Spotlight (User)' is set to 'Block'"
      info                  : "This policy setting determines whether the all Windows Spotlight features are turned on/off (together).

The recommended state for this setting is: Block

Note:

Per Microsoft TechNet

, this policy setting only applies to Windows 10 Enterprise and Windows 10 Education editions.

Note #2: Setting this recommendation to Block also disables the Recommendation Allow Tailored Experiences With Diagnostic Data which was is included in the on-prem Workstation Benchmarks. It was not included in the Intune version since this setting is automatically disabled.

Disabling this setting will help ensure your data is not shared with any third party. The Windows Spotlight feature collects data and uses that data to display suggested apps as well as images from the internet."
      solution              : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Block :

Experience\Allow Windows Spotlight (User)

Impact:

Windows Spotlight on lock screen, Windows tips, Microsoft consumer features and other related features will be turned off."
      reference             : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also              : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type            : POLICY_DWORD
      value_data            : "0"
      reg_key               : "HKLM\Software\Microsoft\PolicyManager\Providers\{GUID}\Default\{USER_SID}\Experience"
      reg_item              : "AllowWindowsSpotlight"
      reg_option            : CAN_NOT_BE_NULL
      guid_reg_key          : "HKLM\Software\Microsoft\PolicyManager\Current\{USER_SID}\Experience"
      reg_include_hku_users : "S-1-5-21-*"
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "4.10.20.1.1 (L2) Ensure 'Turn off access to the Store' is set to 'Enabled'"
      info        : "This policy setting specifies whether to use the Store service for finding an application to open a file with an unhandled file type or protocol association. When a user opens a file type or protocol that is not associated with any applications on the computer, the user is given the choice to select a local application or use the Store service to find an application.

The recommended state for this setting is: Enabled

The Store service is a retail outlet built into Windows, primarily for consumer use. In an enterprise managed environment the IT department should be managing the installation of all applications to reduce the risk of the installation of vulnerable software."
      solution    : 'To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Enabled

Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off access to the Store

Impact:

The \'Look for an app in the Store\' item in the Open With dialog is removed.'
      reference   : "800-171|3.4.8,800-171r3|03.04.08,800-53|CM-7(5),800-53|CM-10,800-53r5|CM-7(5),800-53r5|CM-10,CSCv7|9.2,CSCv8|2.5,CSF|DE.CM-3,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-03,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.5.32,ISO-27001-2022|A.8.19,ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "1"
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Explorer"
      reg_item    : "NoUseStoreOpenWith"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : '4.10.20.1.10 (L2) Ensure \'Turn off the \'Publish to Web\' task for files and folders\' is set to \'Enabled\''
      info        : "This policy setting specifies whether the tasks Publish this file to the Web, Publish this folder to the Web, and Publish the selected items to the Web are available from File and Folder Tasks in Windows folders. The Web Publishing wizard is used to download a list of providers and allow users to publish content to the Web.

The recommended state for this setting is: Enabled

Users may publish confidential or sensitive information to a public service outside of the control of the organization."
      solution    : 'To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Enabled

Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off the \'Publish to Web\' task for files and folders

Impact:

The \'Publish to Web\' task is removed from File and Folder tasks in Windows folders.'
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "1"
      reg_key     : "HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer"
      reg_item    : "NoPublishingWizard"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "4.10.20.1.11 (L2) Ensure 'Turn off the Windows Messenger Customer Experience Improvement Program' is set to 'Enabled'"
      info        : "This policy setting specifies whether the Windows Customer Experience Improvement Program can collect anonymous information about how Windows is used.

Microsoft uses information collected through the Windows Customer Experience Improvement Program to improve features that are most used and to detect flaws so that they can be corrected more quickly. Enabling this setting will reduce the amount of data Microsoft is able to gather for this purpose. The recommended state for this setting is: Enabled

Large enterprise managed environments may not want to have information collected by Microsoft from managed client computers."
      solution    : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Enabled

Administrative Templates\System\Internet Communication Management\Internet Communication settings\Turn off the Windows Messenger Customer Experience Improvement Program

Impact:

Windows Messenger will not collect usage information, and the user settings to enable the collection of usage information will not be shown."
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "2"
      reg_key     : "HKLM\Software\Policies\Microsoft\Messenger\Client"
      reg_item    : "CEIP"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "4.10.20.1.12 (L2) Ensure 'Turn off Windows Customer Experience Improvement Program' is set to 'Enabled'"
      info        : "This policy setting specifies whether Windows Messenger can collect anonymous information about how the Windows Messenger software and service is used.

Microsoft uses information collected through the Windows Customer Experience Improvement Program to detect software flaws so that they can be corrected more quickly, enabling this setting will reduce the amount of data Microsoft is able to gather for this purpose. The recommended state for this setting is: Enabled

Large enterprise managed environments may not want to have information collected by Microsoft from managed client computers."
      solution    : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Enabled

Administrative Templates\System\Internet Communication Management\Internet Communication settings\Turn off Windows Customer Experience Improvement Program

Impact:

All users are opted out of the Windows Customer Experience Improvement Program."
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "0"
      reg_key     : "HKLM\Software\Policies\Microsoft\SQMClient\Windows"
      reg_item    : "CEIPEnable"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          type        : REGISTRY_SETTING
          description : "Disabled"
          value_type  : POLICY_DWORD
          value_data  : "1"
          reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Windows Error Reporting"
          reg_item    : "Disabled"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DoReport"
          value_type  : POLICY_DWORD
          value_data  : "0"
          reg_key     : "HKLM\SOFTWARE\Policies\Microsoft\PCHealth\ErrorReporting"
          reg_item    : "DoReport"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "4.10.20.1.13 (L2) Ensure 'Turn off Windows Error Reporting' is set to 'Enabled'"
          info        : "This policy setting controls whether or not errors are reported to Microsoft.

Error Reporting is used to report information about a system or application that has failed or has stopped responding and is used to improve the quality of the product.

The recommended state for this setting is: Enabled

If a Windows Error occurs in a secure, enterprise managed environment, the error should be reported directly to IT staff for troubleshooting and remediation. There is no benefit to the corporation to report these errors directly to Microsoft, and there is some risk of unknowingly exposing sensitive data as part of the error."
          solution    : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Enabled

Administrative Templates\System\Internet Communication Management\Internet Communication settings\Turn off Windows Error Reporting

Impact:

Users are not given the option to report errors to Microsoft."
          reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
          see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
          show_output : YES
        </report>
      </then>
    </if>

    <custom_item>
      type                  : REGISTRY_SETTING
      description           : "4.10.20.1.3 (L2) Ensure 'Turn off Help Experience Improvement Program (User)' is set to 'Enabled'"
      info                  : "This policy setting specifies whether users can participate in the Help Experience Improvement program. The Help Experience Improvement program collects information about how customers use Windows Help so that Microsoft can improve it.

The recommended state for this setting is: Enabled

Large enterprise managed environments may not want to have information collected by Microsoft from managed client computers."
      solution              : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Enabled

Administrative Templates\System\Internet Communication Management\Internet Communication Settings\Turn off Help Experience Improvement Program

Impact:

Users cannot participate in the Help Experience Improvement program."
      reference             : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also              : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type            : POLICY_DWORD
      value_data            : "1"
      reg_key               : "HKU\Software\Policies\Microsoft\Assistance\Client\1.0"
      reg_item              : "NoImplicitFeedback"
      reg_option            : CAN_NOT_BE_NULL
      reg_include_hku_users : "S-1-5-21-*"
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "4.10.20.1.4 (L2) Ensure 'Turn off Internet Connection Wizard if URL connection is referring to Microsoft.com' is set to 'Enabled'"
      info        : "This policy setting specifies whether the Internet Connection Wizard can connect to Microsoft to download a list of Internet Service Providers (ISPs).

The recommended state for this setting is: Enabled

In an enterprise managed environment we want to lower the risk of a user unknowingly exposing sensitive data."
      solution    : 'To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Enabled

Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off Internet Connection Wizard if URL connection is referring to Microsoft.com

Impact:

The \'Choose a list of Internet Service Providers\' path in the Internet Connection Wizard causes the wizard to exit. This prevents users from retrieving the list of ISPs, which resides on Microsoft servers.'
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "1"
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Internet Connection Wizard"
      reg_item    : "ExitOnMSICW"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "4.10.20.1.6 (L2) Ensure 'Turn off printing over HTTP' is set to 'Enabled'"
      info        : "This policy setting allows you to disable the client computer's ability to print over HTTP, which allows the computer to print to printers on the intranet as well as the Internet.

The recommended state for this setting is: Enabled

Note: This control affects printing over both HTTP and HTTPS.

Information that is transmitted over HTTP through this capability is not protected and can be intercepted by malicious users. For this reason, it is not often used in enterprise managed environments."
      solution    : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Enabled

Administrative Templates\System\Internet Communication Management\Internet Communication settings\Turn off printing over HTTP

Impact:

The client computer will not be able to print to Internet printers over HTTP or HTTPS.

Note: This policy setting affects the client side of Internet printing only. Regardless of how it is configured, a computer could act as an Internet Printing server and make its shared printers available through HTTP."
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|13.3,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "1"
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows NT\Printers"
      reg_item    : "DisableHTTPPrinting"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "4.10.20.1.7 (L2) Ensure 'Turn off Registration if URL connection is referring to Microsoft.com' is set to 'Enabled'"
      info        : "This policy setting specifies whether the Windows Registration Wizard connects to Microsoft.com for online registration.

The recommended state for this setting is: Enabled

Users in an enterprise managed environment should not be registering their own copies of Windows, providing their own PII in the process."
      solution    : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Enabled

Administrative Templates\System\Internet Communication Management\Internet Communication settings\Turn off Registration if URL connection is referring to Microsoft.com

Impact:

Users are blocked from connecting to Microsoft.com for online registration and they cannot register their copy of Windows online."
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "1"
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Registration Wizard Control"
      reg_item    : "NoRegistration"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "4.10.20.1.8 (L2) Ensure 'Turn off Search Companion content file updates' is set to 'Enabled'"
      info        : "This policy setting specifies whether Search Companion should automatically download content updates during local and Internet searches.

The recommended state for this setting is: Enabled

There is a small risk that users will unknowingly reveal sensitive information because of the topics they are searching for. This risk is very low because even if this setting is enabled users still must submit search queries to the desired search engine in order to perform searches."
      solution    : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Enabled

Administrative Templates\System\Internet Communication Management\Internet Communication settings\Turn off Search Companion content file updates

Impact:

Search Companion does not download content updates during searches.

Note: Internet searches will still send the search text and information about the search to Microsoft and the chosen search provider. If you select Classic Search, the Search Companion feature will be unavailable. You can select Classic Search by clicking Start, Search, Change Preferences, and then Change Internet Search Behavior."
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "1"
      reg_key     : "HKLM\Software\Policies\Microsoft\SearchCompanion"
      reg_item    : "DisableContentFileUpdates"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : '4.10.20.1.9 (L2) Ensure \'Turn off the \'Order Prints\' picture task\' is set to \'Enabled\''
      info        : 'This policy setting specifies whether the \'Order Prints Online\' task is available from Picture Tasks in Windows folders.

The Order Prints Online Wizard is used to download a list of providers and allow users to order prints online.

The recommended state for this setting is: Enabled

In an enterprise managed environment we want to lower the risk of a user unknowingly exposing sensitive data.'
      solution    : 'To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Enabled

Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off the \'Order Prints\' picture task

Impact:

The task \'Order Prints Online\' is removed from Picture Tasks in File Explorer folders.'
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "1"
      reg_key     : "HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer"
      reg_item    : "NoOnlinePrintsWizard"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          type        : REGISTRY_SETTING
          description : "Ensure 'DevicePKInitBehavior' is 'Windows: Registry Value' to '0'"
          value_type  : POLICY_DWORD
          value_data  : "0"
          reg_key     : "HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\kerberos\parameters"
          reg_item    : "DevicePKInitBehavior"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "Ensure 'DevicePKInitEnabled' is 'Windows: Registry Value' to '1'"
          value_type  : POLICY_DWORD
          value_data  : "1"
          reg_key     : "HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\kerberos\parameters"
          reg_item    : "DevicePKInitEnabled"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "4.10.23.1 (L2) Ensure 'Support device authentication using certificate' is set to 'Enabled: Automatic'"
          info        : "This policy setting allows you to set support for Kerberos to attempt authentication using the certificate for the device to the domain.

Support for device authentication using certificate will require connectivity to a DC in the device account domain which supports certificate authentication for computer accounts.

The recommended state for this setting is: Enabled: Automatic

Having stronger device authentication with the use of certificates is strongly encouraged over standard username and password authentication. Having this set to Automatic will allow certificate based authentication to be used whenever possible."
          solution    : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Enabled: Automatic

Administrative Templates\System\Kerberos\Support device authentication using certificate

Impact:

None - this is the default behavior."
          reference   : "800-171|3.4.1,800-171r3|03.04.10,800-171r3|03.05.02,800-53|CM-8,800-53|IA-3,800-53r5|CM-8,800-53r5|IA-3,CN-L3|8.1.10.2(a),CN-L3|8.1.10.2(b),CSCv7|1.6,CSCv7|1.8,CSF|DE.CM-7,CSF|ID.AM-1,CSF|ID.AM-2,CSF|PR.AC-1,CSF|PR.DS-3,CSF2.0|ID.AM-01,CSF2.0|ID.AM-02,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO-27001-2022|A.5.9,ISO-27001-2022|A.8.9,ITSG-33|CM-8,ITSG-33|IA-3,ITSG-33|IA-3a.,LEVEL|2A,NESA|T1.2.1,NESA|T1.2.2,NESA|T5.4.3,QCSC-v1|13.2,TBA-FIISB|27.1"
          see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
          show_output : YES
        </report>
      </then>
    </if>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "4.10.25.1 (L2) Ensure 'Disallow copying of user input methods to the system account for sign-in' is set to 'Enabled'"
      info        : "This policy prevents automatic copying of user input methods to the system account for use on the sign-in screen. The user is restricted to the set of input methods that are enabled in the system account.

The recommended state for this setting is: Enabled

This is a way to increase the security of the system account."
      solution    : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Enabled

Administrative Templates\System\Locale Services\Disallow copying of user input methods to the system account for sign-in

Impact:

Users will have input methods enabled for the system account on the sign-in page."
      reference   : "800-171|3.1.10,800-171r3|03.01.10,800-53|AC-11,800-53r5|AC-11,CN-L3|8.1.4.1(b),CSCv7|16.11,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO-27001-2022|A.7.7,ISO-27001-2022|A.8.1,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11,LEVEL|2A,NIAv2|AM23c,NIAv2|AM23d,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "1"
      reg_key     : "HKLM\Software\Policies\Microsoft\Control Panel\International"
      reg_item    : "BlockUserInputMethodsForSignIn"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "4.10.40.5.1 (L2) Ensure 'Microsoft Support Diagnostic Tool: Turn on MSDT interactive communication with support provider' is set to 'Disabled'"
      info        : "This policy setting configures Microsoft Support Diagnostic Tool (MSDT) interactive communication with the support provider. MSDT gathers diagnostic data for analysis by support professionals.

The recommended state for this setting is: Disabled

Due to privacy concerns, data should never be sent to any third-party since this data could contain sensitive information."
      solution    : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Disabled

Administrative Templates\System\Troubleshooting and Diagnostics\Microsoft Support Diagnostic Tool\Microsoft Support Diagnostic Tool: Turn on MSDT interactive communication with support provider

Impact:

MSDT cannot run in support mode, and no data can be collected or sent to the support provider."
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "0"
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\ScriptedDiagnosticsProvider\Policy"
      reg_item    : "DisableQueryRemoteServer"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "4.11.28.10.1 (L2) Ensure 'Configure Watson events' is set to 'Disabled'"
      info        : "This policy setting allows you to configure whether or not Watson events are sent.

The recommended state for this setting is: Disabled

Watson events are the reports that get sent to Microsoft when a program or service crashes or fails, including the possibility of automatic submission. Preventing this information from being sent can help reduce privacy concerns."
      solution    : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Disabled

Administrative Templates\Windows Components\Microsoft Defender Antivirus\Reporting\Configure Watson events

Impact:

Watson events will not be sent to Microsoft automatically when a program or service crashes or fails."
      reference   : "800-171|3.12.3,800-171r3|03.12.03,800-53|CA-7,800-53r5|CA-7,CSCv7|13.3,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-2,CSF|DE.CM-3,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-1,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.IP-7,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,CSF|RS.MI-3,CSF2.0|DE.AE-02,CSF2.0|DE.AE-03,CSF2.0|DE.CM-01,CSF2.0|DE.CM-02,CSF2.0|DE.CM-03,CSF2.0|DE.CM-06,CSF2.0|DE.CM-09,CSF2.0|ID.IM-01,CSF2.0|ID.IM-02,CSF2.0|ID.IM-03,CSF2.0|ID.RA-01,CSF2.0|ID.RA-07,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO-27001-2022|A.5.36,ISO-27001-2022|9.1,ISO-27001-2022|9.3.2,ISO-27001-2022|9.3.3,ITSG-33|CA-7,LEVEL|2A,NESA|M1.2.2,NESA|M5.3.1,NESA|M5.4.1,NESA|M6.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "1"
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender\Reporting"
      reg_item    : "DisableGenericReports"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "4.11.28.3.2 (L2) Ensure 'Join Microsoft MAPS' is set to 'Disabled'"
      info        : "This policy setting allows you to join Microsoft Active Protection Service (MAPS), which Microsoft renamed to

Windows Defender Antivirus Cloud Protection Service

and then

Microsoft Defender Antivirus Cloud Protection Service

. Microsoft MAPS / Microsoft Defender Antivirus Cloud Protection Service is the online community that helps you choose how to respond to potential threats. The community also helps stop the spread of new malicious software infections. You can choose to send basic or additional information about detected software. Additional information helps Microsoft create new definitions and help it to protect your computer.

Possible options are:

 - (0x0) Disabled (default)
 - (0x1) Basic membership
 - (0x2) Advanced membership

Basic membership will send basic information to Microsoft about software that has been detected including where the software came from the actions that you apply or that are applied automatically and whether the actions were successful.

Advanced membership in addition to basic information will send more information to Microsoft about malicious software spyware and potentially unwanted software including the location of the software file names how the software operates and how it has impacted your computer.

The recommended state for this setting is: Disabled

Note: In Windows 10 and above, Basic membership is no longer available, so setting the value to 1 Basic, or 2 Advanced, enrolls the device into Advanced membership. For more information, please visit:

Turn on cloud protection in Microsoft Defender Antivirus - Microsoft Defender for Endpoint | Microsoft Learn

.

The information that would be sent can include things like location of detected items on your computer if harmful software was removed. The information would be automatically collected and sent. In some instances personal information might unintentionally be sent to Microsoft. However, Microsoft states that it will not use this information to identify you or contact you.

For privacy reasons in high security environments, it is best to prevent these data submissions altogether."
      solution    : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Disabled

Administrative Templates\Windows Components\Microsoft Defender Antivirus\MAPS\Join Microsoft MAPS

Impact:

None - this is the default behavior."
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "0"
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender\Spynet"
      reg_item    : "SpynetReporting"
      reg_option  : CAN_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "4.11.3.2 (L2) Ensure 'Block launching Universal Windows apps with Windows Runtime API access from hosted content.' is set to 'Enabled'"
      info        : "This policy setting controls whether Microsoft Store apps with Windows Runtime API access directly from web content can be launched.

The recommended state for this setting is: Enabled

Blocking apps from the web with direct access to the Windows API can prevent malicious apps from being run on a system. Only system administrators should be installing approved applications."
      solution    : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Enabled

Administrative Templates\Windows Components\App runtime\Block launching Universal Windows apps with Windows Runtime API access from hosted content.

Note: A reboot may be required after the setting is applied.

Impact:

Universal Windows apps which declare Windows Runtime API access in the ApplicationContentUriRules section of the manifest cannot be launched (Universal Windows apps which have not declared Windows Runtime API access in the manifest will not be affected)."
      reference   : "800-171|3.4.8,800-171r3|03.04.08,800-53|CM-7(5),800-53|CM-10,800-53r5|CM-7(5),800-53r5|CM-10,CSCv7|9.2,CSCv8|2.5,CSF|DE.CM-3,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-03,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.5.32,ISO-27001-2022|A.8.19,ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "1"
      reg_key     : "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System"
      reg_item    : "BlockHostedAppAccessWinRT"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "4.11.35.1 (L2) Ensure 'Turn off Push To Install service' is set to 'Enabled'"
      info        : "This policy setting controls whether users can push Apps to the device from the Microsoft Store App running on other devices or the web.

The recommended state for this setting is: Enabled

In a high security managed environment, application installations should be managed centrally by IT staff, not by end users."
      solution    : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Enabled

Administrative Templates\Windows Components\Push to Install\Turn off Push To Install service

Impact:

Users will not be able to push Apps to this device from the Microsoft Store running on other devices or the web."
      reference   : "800-171|3.4.8,800-171r3|03.04.08,800-53|CM-7(5),800-53|CM-10,800-53r5|CM-7(5),800-53r5|CM-10,CSCv7|9.2,CSCv8|2.5,CSF|DE.CM-3,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-03,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.5.32,ISO-27001-2022|A.8.19,ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "1"
      reg_key     : "HKLM\Software\Policies\Microsoft\PushToInstall"
      reg_item    : "DisablePushToInstall"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "4.11.36.4.10.1 (L2) Ensure 'Set time limit for active but idle Remote Desktop Services sessions' is set to 'Enabled: 15 minutes or less, but not Never (0)'"
      info        : "This policy setting allows you to specify the maximum amount of time that an active Remote Desktop Services session can be idle (without user input) before it is automatically disconnected.

The recommended state for this setting is: Enabled: 15 minutes or less, but not Never (0)

This setting helps to prevent active Remote Desktop sessions from tying up the computer for long periods of time while not in use, preventing computing resources from being consumed by large numbers of inactive sessions. In addition, old, forgotten Remote Desktop sessions that are still active can cause password lockouts if the user's password has changed but the old session is still running. For systems that limit the number of connected users (e.g. servers in the default Administrative mode - 2 sessions only), other users' old but still active sessions can prevent another user from connecting, resulting in an effective denial of service.

In addition, session timeouts that are misconfigured or set for a long period of time can leave the system open to an attacker hijacking the session."
      solution    : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Enabled: 15 minutes or less, but not Never (0)

Administrative Templates\Windows Components\Remote Desktop Services\Remote Desktop Session Host\Session Time Limits\Set time limit for active but idle Remote Desktop Services sessions

Impact:

Remote Desktop Services will automatically disconnect active but idle sessions after 15 minutes (or the specified amount of time). The user receives a warning two minutes before the session disconnects, which allows the user to press a key or move the mouse to keep the session active. Note that idle session time limits do not apply to console sessions."
      reference   : "800-171|3.1.10,800-171r3|03.01.10,800-53|AC-11,800-53r5|AC-11,CN-L3|8.1.4.1(b),CSCv7|16.11,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO-27001-2022|A.7.7,ISO-27001-2022|A.8.1,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11,LEVEL|2A,NIAv2|AM23c,NIAv2|AM23d,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "[1..900000]"
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows NT\Terminal Services"
      reg_item    : "MaxIdleTime"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "4.11.36.4.10.2 (L2) Ensure 'Set time limit for disconnected sessions' is set to 'Enabled: 1 minute'"
      info        : "This policy setting allows you to configure a time limit for disconnected Remote Desktop Services sessions.

The recommended state for this setting is: Enabled: 1 minute

This setting helps to prevent active Remote Desktop sessions from tying up the computer for long periods of time while not in use, preventing computing resources from being consumed by large numbers of disconnected but still active sessions. In addition, old, forgotten Remote Desktop sessions that are still active can cause password lockouts if the user's password has changed but the old session is still running. For systems that limit the number of connected users (e.g. servers in the default Administrative mode - 2 sessions only), other users' old but still active sessions can prevent another user from connecting, resulting in an effective denial of service. This setting is important to ensure a disconnected session is properly terminated.

In addition, session timeouts that are misconfigured or set for a long period of time can leave the system open to an attacker hijacking the session."
      solution    : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Enabled: 1 minute

Administrative Templates\Windows Components\Remote Desktop Services\Remote Desktop Session Host\Session Time Limits\Set time limit for disconnected sessions

Impact:

Disconnected Remote Desktop sessions are deleted from the server after 1 minute. Note that disconnected session time limits do not apply to console sessions."
      reference   : "800-171|3.1.10,800-171r3|03.01.10,800-53|AC-11,800-53r5|AC-11,CN-L3|8.1.4.1(b),CSCv7|16.11,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO-27001-2022|A.7.7,ISO-27001-2022|A.8.1,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11,LEVEL|2A,NIAv2|AM23c,NIAv2|AM23d,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "60000"
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows NT\Terminal Services"
      reg_item    : "MaxDisconnectionTime"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "4.11.36.4.2.1 (L2) Ensure 'Allow users to connect remotely by using Remote Desktop Services' is set to 'Disabled'"
      info        : "This policy setting allows you to configure remote access to computers by using Remote Desktop Services.

The recommended state for this setting is: Disabled

Any account with the

Allow log on through Remote Desktop Services

user right can log on to the remote console of the computer. If you do not restrict access to legitimate users who need to log on to the console of the computer, unauthorized users could download and execute malicious code to elevate their privileges."
      solution    : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Disabled

Administrative Templates\Windows Components\Remote Desktop Services\Remote Desktop Session Host\Connections\Allow users to connect remotely by using Remote Desktop Services

Impact:

None - this is the default configuration, unless Remote Desktop Services has been manually enabled on the Remote tab in the System Properties sheet."
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "1"
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows NT\Terminal Services"
      reg_item    : "fDenyTSConnections"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "4.11.36.4.3.1 (L2) Ensure 'Do not allow COM port redirection' is set to 'Enabled'"
      info        : "This policy setting specifies whether to prevent the redirection of data to client COM ports from the remote computer in a Remote Desktop Services session.

The recommended state for this setting is: Enabled

In a more security-sensitive environment, it is desirable to reduce the possible attack surface. The need for COM port redirection within a Remote Desktop session is very rare, so makes sense to reduce the number of unexpected avenues for data exfiltration and/or malicious code transfer."
      solution    : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Enabled

Administrative Templates\Windows Components\Remote Desktop Services\Remote Desktop Session Host\Device and Resource Redirection\Do not allow COM port redirection

Impact:

Users in a Remote Desktop Services session will not be able to redirect server data to local (client) COM ports."
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "1"
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows NT\Terminal Services"
      reg_item    : "fDisableCcm"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "4.11.36.4.3.3 (L2) Ensure 'Do not allow LPT port redirection' is set to 'Enabled'"
      info        : "This policy setting specifies whether to prevent the redirection of data to client LPT ports during a Remote Desktop Services session.

The recommended state for this setting is: Enabled

In a more security-sensitive environment, it is desirable to reduce the possible attack surface. The need for LPT port redirection within a Remote Desktop session is very rare, so makes sense to reduce the number of unexpected avenues for data exfiltration and/or malicious code transfer."
      solution    : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Enabled

Administrative Templates\Windows Components\Remote Desktop Services\Remote Desktop Session Host\Device and Resource Redirection\Do not allow LPT port redirection

Impact:

Users in a Remote Desktop Services session will not be able to redirect server data to local (client) LPT ports."
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "1"
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows NT\Terminal Services"
      reg_item    : "fDisableLPT"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "4.11.36.4.3.4 (L2) Ensure 'Do not allow supported Plug and Play device redirection' is set to 'Enabled'"
      info        : "This policy setting allows you to control the redirection of supported Plug and Play devices, such as Windows Portable Devices, to the remote computer in a Remote Desktop Services session.

The recommended state for this setting is: Enabled

In a more security-sensitive environment, it is desirable to reduce the possible attack surface. The need for Plug and Play device redirection within a Remote Desktop session is very rare, so makes sense to reduce the number of unexpected avenues for data exfiltration and/or malicious code transfer."
      solution    : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Enabled

Administrative Templates\Windows Components\Remote Desktop Services\Remote Desktop Session Host\Device and Resource Redirection\Do not allow supported Plug and Play device redirection

Impact:

Users in a Remote Desktop Services session will not be able to redirect their supported (local client) Plug and Play devices to the remote computer."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.06b.,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|2A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "1"
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows NT\Terminal Services"
      reg_item    : "fDisablePNPRedir"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "4.11.42.2 (L2) Ensure 'Turn off the Store application' is set to 'Enabled'"
      info        : "This setting denies or allows access to the Store application.

The recommended state for this setting is: Enabled

Note:

Per Microsoft TechNet

and

MSKB 3135657

, this policy setting does not apply to any Windows 10 editions other than Enterprise and Education.

Only applications approved by an IT department should be installed. Allowing users to install third-party applications can lead to missed patches and potential zero day vulnerabilities."
      solution    : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Enabled

Administrative Templates\Windows Components\Store\Turn off the Store application

Impact:

Access to the Microsoft Store application is denied."
      reference   : "800-171|3.4.8,800-171r3|03.04.08,800-53|CM-7(5),800-53|CM-10,800-53r5|CM-7(5),800-53r5|CM-10,CSCv7|9.2,CSCv8|2.5,CSF|DE.CM-3,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-03,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.5.32,ISO-27001-2022|A.8.19,ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "1"
      reg_key     : "HKLM\Software\Policies\Microsoft\WindowsStore"
      reg_item    : "RemoveWindowsStore"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "4.11.49.1 (L2) Ensure 'Prevent Internet Explorer security prompt for Windows Installer scripts' is set to 'Disabled'"
      info        : "This policy setting controls whether Web-based programs are allowed to install software on the computer without notifying the user.

The recommended state for this setting is: Disabled

Suppressing the system warning can pose a security risk and increase the attack surface on the system."
      solution    : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Disabled

Administrative Templates\Windows Components\Windows Installer\Prevent Internet Explorer security prompt for Windows Installer scripts

Impact:

None - this is the default behavior."
      reference   : "800-171|3.4.8,800-171r3|03.04.08,800-53|CM-7(5),800-53|CM-10,800-53r5|CM-7(5),800-53r5|CM-10,CSCv8|2.5,CSF|DE.CM-3,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-03,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.5.32,ISO-27001-2022|A.8.19,ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "0"
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Installer"
      reg_item    : "SafeForScripting"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type                  : REGISTRY_SETTING
      description           : "4.11.52.2.1 (L2) Ensure 'Prevent Codec Download (User)' is set to 'Enabled'"
      info                  : "This setting controls whether Windows Media Player is allowed to download additional codecs for decoding media files it does not already understand.

The recommended state for this setting is: Enabled

This has some potential for risk if a malicious data file is opened in Media Player that requires an additional codec to be installed. If a special codec is required for a necessary job function, then that codec should first be tested to ensure it is legitimate, and it should be supplied by the IT department in the organization."
      solution              : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Enabled

Administrative Templates\Windows Components\Windows Media Player\Playback\Prevent Codec Download (User)

Impact:

Windows Media Player is prevented from automatically downloading codecs to your computer. In addition, the

Download codecs automatically

check box on the Player tab in the Player is not available."
      reference             : "800-171|3.13.13,800-171r3|03.13.13,800-53|SC-18(3),800-53r5|SC-18(3),CSF|DE.CM-5,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(3),LEVEL|2A,NIAv2|NS26f,QCSC-v1|3.2,QCSC-v1|8.2.1"
      see_also              : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type            : POLICY_DWORD
      value_data            : "1"
      reg_key               : "HKU\Software\Policies\Microsoft\WindowsMediaPlayer"
      reg_item              : "PreventCodecDownload"
      reg_option            : CAN_NOT_BE_NULL
      reg_include_hku_users : "S-1-5-21-*"
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "4.11.54.1 (L2) Ensure 'Turn on PowerShell Script Block Logging' is set to 'Enabled'"
      info        : "This policy setting enables logging of all PowerShell script input to the Applications and Services Logs\Microsoft\Windows\PowerShell\Operational Event Log channel.

The recommended state for this setting is: Enabled

Note: If logging of

Script Block Invocation Start/Stop Events

is enabled (option box checked), PowerShell will log additional events when invocation of a command, script block, function, or script starts or stops. Enabling this option generates a high volume of event logs. CIS has intentionally chosen not to make a recommendation for this option, since it generates a large volume of events. If an organization chooses to enable the optional setting (checked), this also conforms to the benchmark.

Logs of PowerShell script input can be very valuable when performing forensic investigations of PowerShell attack incidents to determine what occurred."
      solution    : 'To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Enabled

Administrative Templates\\Windows Components\\Windows PowerShell\\Turn on PowerShell Script Block Logging

Impact:

PowerShell script input will be logged to the Applications and Services Logs\\Microsoft\\Windows\\PowerShell\\Operational Event Log channel, which can contain credentials and sensitive information.

Note: Configuring this setting to Enabled generates a high volume of event logs which will be overwritten if the log size is not expanded or offloaded to a log collection system.

Warning: There are potential risks of capturing credentials and sensitive information in the PowerShell logs, which could be exposed to users who have read-access to those logs. Microsoft provides a feature called \'Protected Event Logging\' to better secure event log data. For assistance with protecting event logging, visit:

About Logging Windows - PowerShell | Microsoft Docs

.'
      reference   : "800-171|3.3.1,800-171|3.3.2,800-171r3|03.03.01,800-53|AU-2,800-53r5|AU-2,CN-L3|8.1.4.3(a),CSCv7|8.8,CSCv8|8.8,CSF|PR.PT-1,CSF2.0|PR.PS-04,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO-27001-2022|A.8.15,ITSG-33|AU-2,LEVEL|2A,NESA|M1.2.2,NESA|M5.5.1,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|SS30,NIAv2|VL8,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "1"
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Powershell\ScriptBlockLogging"
      reg_item    : "EnableScriptBlockLogging"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "4.11.54.2 (L2) Ensure 'Turn on PowerShell Transcription' is set to 'Enabled'"
      info        : "This Policy setting lets you capture the input and output of Windows PowerShell commands into text-based transcripts.

The recommended state for this setting is: Enabled

PowerShell transcript input can be very valuable when performing forensic investigations of PowerShell attack incidents to determine what occurred."
      solution    : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Enabled

Administrative Templates\Windows Components\Windows PowerShell\Turn on PowerShell Transcription

Impact:

PowerShell transcript input will be logged to the PowerShell_transcript output file, which is saved to the My Documents folder of each users' profile by default. Optionally, a specific output directory name can be specified, which will contain all PowerShell transcript logs in a subfolder of My Documents. If specifying a full path outside the users My Documents folder, other users on the system could have access to view these logs, which may contain sensitive information such as passwords.

Warning: There are potential risks of capturing credentials and sensitive information in the PowerShell_transcript output file, which could be exposed to users who have read-access to the file.

Warning #2: PowerShell Transcription is not compatible with the natively installed PowerShell v4 on Microsoft Windows 10 Release 1511 and Server 2012 R2 and below. If this recommendation is set as prescribed, PowerShell will need to be updated to at least v5.1 or newer. For more information on updating PowerShell, please see

Windows PowerShell System Requirements - PowerShell | Microsoft Learn

."
      reference   : "800-171|3.3.1,800-171|3.3.2,800-171r3|03.03.01,800-53|AU-2,800-53r5|AU-2,CN-L3|8.1.4.3(a),CSCv7|8.8,CSCv8|8.8,CSF|PR.PT-1,CSF2.0|PR.PS-04,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO-27001-2022|A.8.15,ITSG-33|AU-2,LEVEL|2A,NESA|M1.2.2,NESA|M5.5.1,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|SS30,NIAv2|VL8,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "1"
      reg_key     : "HKLM\SOFTWARE\Policies\Microsoft\Windows\PowerShell\Transcription"
      reg_item    : "EnableTranscripting"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "4.11.55.2.2 (L2) Ensure 'Allow remote server management through WinRM' is set to 'Disabled'"
      info        : "This policy setting allows you to manage whether the Windows Remote Management (WinRM) service automatically listens on the network for requests on the HTTP transport over the default HTTP port.

The recommended state for this setting is: Disabled

Any feature is a potential avenue of attack, those that enable inbound network connections are particularly risky. Only enable the use of the Windows Remote Management (WinRM) service on trusted networks and when feasible employ additional controls such as IPsec."
      solution    : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Disabled

Administrative Templates\Windows Components\Windows Remote Management (WinRM)\WinRM Service\Allow remote server management through WinRM

Impact:

None - this is the default behavior."
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "0"
      reg_key     : "HKLM\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service"
      reg_item    : "AllowAutoConfig"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "4.11.56.1 (L2) Ensure 'Allow Remote Shell Access' is set to 'Disabled'"
      info        : "This policy setting allows you to manage configuration of remote access to all supported shells to execute scripts and commands.

The recommended state for this setting is: Disabled

Note: The GPME help text for this setting is incorrectly worded, implying that configuring it to Enabled will reject new Remote Shell connections, and setting it to Disabled will allow Remote Shell connections. The opposite is true (and is consistent with the title of the setting). This is a wording mistake by Microsoft in the Administrative Template.

Any feature is a potential avenue of attack, those that enable inbound network connections are particularly risky. Only enable the use of the Windows Remote Shell on trusted networks and when feasible employ additional controls such as IPsec."
      solution    : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Disabled

Administrative Templates\Windows Components\Windows Remote Shell\Allow Remote Shell Access

Impact:

New Remote Shell connections are not allowed and are rejected by the workstation."
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "0"
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\WinRM\Service\WinRS"
      reg_item    : "AllowRemoteShellAccess"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "4.5.11 (L2) Ensure 'MSS: (TcpMaxDataRetransmissions IPv6) How many times unacknowledged data is retransmitted' is set to 'Enabled: 3'"
      info        : "This setting controls the number of times that TCP retransmits an individual data segment (non-connect segment) before the connection is aborted. The retransmission time-out is doubled with each successive retransmission on a connection. It is reset when responses resume. The base time-out value is dynamically determined by the measured round-trip time on the connection.

The recommended state for this setting is: Enabled: 3

A malicious user could exhaust a target computer's resources if it never sent any acknowledgment messages for data that was transmitted by the target computer."
      solution    : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Enabled: 3

Administrative Templates\MSS (Legacy)\MSS:(TcpMaxDataRetransmissions IPv6) How many times unacknowledged data is retransmitted

Impact:

TCP starts a retransmission timer when each outbound segment is passed to the IP. If no acknowledgment is received for the data in a given segment before the timer expires, then the segment is retransmitted up to three times."
      reference   : "800-171|3.1.16,800-171|3.1.17,800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.01.16,800-171r3|03.04.01,800-171r3|03.04.02,800-171r3|03.04.06,800-53|AC-18,800-53|AC-18(1),800-53|AC-18(3),800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53r5|AC-18,800-53r5|AC-18(1),800-53r5|AC-18(3),800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,CSCv7|11.1,CSCv8|4.2,CSF|DE.AE-1,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,CSF2.0|DE.CM-09,CSF2.0|ID.AM-08,CSF2.0|PR.AA-05,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO-27001-2022|A.5.2,ISO-27001-2022|A.5.14,ISO-27001-2022|A.8.9,ISO-27001-2022|A.8.20,ITSG-33|AC-18,ITSG-33|AC-18(1),ITSG-33|AC-18(3),ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,LEVEL|2A,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T5.4.2,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NIAv2|NS33,NIAv2|NS34,NIAv2|NS38,NIAv2|SS15a,NIAv2|SS16,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "3"
      reg_key     : "HKLM\System\CurrentControlSet\Services\TCPIP6\Parameters"
      reg_item    : "tcpmaxdataretransmissions"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "4.5.12 (L2) Ensure 'MSS: (TcpMaxDataRetransmissions) How many times unacknowledged data is retransmitted' is set to 'Enabled: 3'"
      info        : "This setting controls the number of times that TCP retransmits an individual data segment (non-connect segment) before the connection is aborted. The retransmission time-out is doubled with each successive retransmission on a connection. It is reset when responses resume. The base time-out value is dynamically determined by the measured round-trip time on the connection.

The recommended state for this setting is: Enabled: 3

A malicious user could exhaust a target computer's resources if it never sent any acknowledgment messages for data that was transmitted by the target computer."
      solution    : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Enabled: 3

Administrative Templates\MSS (Legacy)\MSS:(TcpMaxDataRetransmissions) How many times unacknowledged data is retransmitted

Impact:

TCP starts a retransmission timer when each outbound segment is passed to the IP. If no acknowledgment is received for the data in a given segment before the timer expires, then the segment is retransmitted up to three times."
      reference   : "800-171|3.1.16,800-171|3.1.17,800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.01.16,800-171r3|03.04.01,800-171r3|03.04.02,800-171r3|03.04.06,800-53|AC-18,800-53|AC-18(1),800-53|AC-18(3),800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53r5|AC-18,800-53r5|AC-18(1),800-53r5|AC-18(3),800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,CSCv7|11.1,CSCv8|4.2,CSF|DE.AE-1,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,CSF2.0|DE.CM-09,CSF2.0|ID.AM-08,CSF2.0|PR.AA-05,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO-27001-2022|A.5.2,ISO-27001-2022|A.5.14,ISO-27001-2022|A.8.9,ISO-27001-2022|A.8.20,ITSG-33|AC-18,ITSG-33|AC-18(1),ITSG-33|AC-18(3),ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,LEVEL|2A,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T5.4.2,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NIAv2|NS33,NIAv2|NS34,NIAv2|NS38,NIAv2|SS15a,NIAv2|SS16,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "3"
      reg_key     : "HKLM\System\CurrentControlSet\Services\Tcpip\Parameters"
      reg_item    : "tcpmaxdataretransmissions"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "4.5.4 (L2) Ensure 'MSS: (DisableSavePassword) Prevent the dial-up password from being saved (recommended)' is set to 'Enabled'"
      info        : 'When you dial a phonebook or VPN entry in Dial-Up Networking, you can use the \'Save Password\' option so that your Dial-Up Networking password is cached and you will not need to enter it on successive dial attempts. For security, administrators may want to prevent users from caching passwords.

The recommended state for this setting is: Enabled

An attacker who steals a mobile user\'s computer could automatically connect to the organization\'s network if the Save This Password check box is selected for the dial-up or VPN networking entry used to connect to your organization\'s network.'
      solution    : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Enabled

Administrative Templates\MSS (Legacy)\MSS:(DisableSavePassword) Prevent the dial-up password from being saved (recommended)

Impact:

Users will not be able to automatically store their logon credentials for dial-up and VPN connections."
      reference   : "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-171r3|03.04.01,800-171r3|03.04.02,800-171r3|03.04.06,800-171r3|03.16.01,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|ID.AM-08,CSF2.0|ID.IM-01,CSF2.0|ID.IM-02,CSF2.0|ID.IM-03,CSF2.0|ID.RA-09,CSF2.0|PR.DS-10,CSF2.0|PR.IR-03,CSF2.0|PR.PS-01,CSF2.0|PR.PS-06,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.5.2,ISO-27001-2022|A.5.8,ISO-27001-2022|A.8.9,ISO-27001-2022|A.8.25,ISO-27001-2022|A.8.26,ISO-27001-2022|A.8.27,ISO-27001-2022|A.8.28,ISO-27001-2022|A.8.30,ISO-27001-2022|A.8.31,ISO-27001-2022|A.8.32,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|2A,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "1"
      reg_key     : "HKLM\System\CurrentControlSet\Services\RasMan\Parameters"
      reg_item    : "disablesavepassword"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "4.5.6 (L2) Ensure 'MSS: (KeepAliveTime) How often keep-alive packets are sent in milliseconds' is set to 'Enabled: 300,000 or 5 minutes (recommended)'"
      info        : "This value controls how often TCP attempts to verify that an idle connection is still intact by sending a keep-alive packet. If the remote computer is still reachable, it acknowledges the keep-alive packet.

The recommended state for this setting is: Enabled: 300,000 or 5 minutes (recommended)

An attacker who is able to connect to network applications could establish numerous connections to cause a DoS condition."
      solution    : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Enabled: 300,000 or 5 minutes (recommended)

Administrative Templates\MSS (Legacy)\MSS: (KeepAliveTime) How often keep-alive packets are sent in milliseconds

Impact:

Keep-alive packets are not sent by default by Windows. However, some applications may configure the TCP stack flag that requests keep-alive packets. For such configurations, you can lower this value from the default setting of two hours to five minutes to disconnect inactive sessions more quickly."
      reference   : "800-171|3.13.1,800-171r3|03.13.01,800-53|SC-7(12),800-53r5|SC-7(12),CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,CSF2.0|DE.CM-01,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,CSF2.0|PR.IR-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.5.14,ISO-27001-2022|A.8.16,ISO-27001-2022|A.8.20,ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(12),LEVEL|2A,NESA|T4.5.4,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSSv3.2.1|1.4,PCI-DSSv4.0|1.5.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "[MIN..300000]"
      reg_key     : "HKLM\System\CurrentControlSet\Services\Tcpip\Parameters"
      reg_item    : "KeepAliveTime"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "4.5.8 (L2) Ensure 'MSS: (PerformRouterDiscovery) Allow IRDP to detect and configure Default Gateway addresses (could lead to DoS)' is set to 'Disabled'"
      info        : "This setting is used to enable or disable the Internet Router Discovery Protocol (IRDP), which allows the system to detect and configure default gateway addresses automatically as described in RFC 1256 on a per-interface basis.

The recommended state for this setting is: Disabled

An attacker who has gained control of a computer on the same network segment could configure a computer on the network to impersonate a router. Other computers with IRDP enabled would then attempt to route their traffic through the already compromised computer."
      solution    : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Disabled

Administrative Templates\MSS (Legacy)\MSS: (PerformRouterDiscovery) Allow IRDP to detect and configure Default Gateway addresses (could lead to DoS)

Impact:

Windows will not automatically detect and configure default gateway addresses on the computer."
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "0"
      reg_key     : "HKLM\System\CurrentControlSet\Services\Tcpip\Parameters"
      reg_item    : "PerformRouterDiscovery"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          type        : REGISTRY_SETTING
          description : "EnableRegistrars"
          value_type  : POLICY_DWORD
          value_data  : "0"
          reg_key     : "HKLM\SOFTWARE\Policies\Microsoft\Windows\WCN\Registrars"
          reg_item    : "EnableRegistrars"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DisableUPnPRegistrar"
          value_type  : POLICY_DWORD
          value_data  : "0"
          reg_key     : "HKLM\SOFTWARE\Policies\Microsoft\Windows\WCN\Registrars"
          reg_item    : "DisableUPnPRegistrar"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DisableInBand802DOT11Registrar"
          value_type  : POLICY_DWORD
          value_data  : "0"
          reg_key     : "HKLM\SOFTWARE\Policies\Microsoft\Windows\WCN\Registrars"
          reg_item    : "DisableInBand802DOT11Registrar"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DisableFlashConfigRegistrar"
          value_type  : POLICY_DWORD
          value_data  : "0"
          reg_key     : "HKLM\SOFTWARE\Policies\Microsoft\Windows\WCN\Registrars"
          reg_item    : "DisableFlashConfigRegistrar"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DisableWPDRegistrar"
          value_type  : POLICY_DWORD
          value_data  : "0"
          reg_key     : "HKLM\SOFTWARE\Policies\Microsoft\Windows\WCN\Registrars"
          reg_item    : "DisableWPDRegistrar"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "4.6.17.1 (L2) Ensure 'Configuration of wireless settings using Windows Connect Now' is set to 'Disabled'"
          info        : "This policy setting allows the configuration of wireless settings using Windows Connect Now (WCN). The WCN Registrar enables the discovery and configuration of devices over Ethernet (UPnP) over in-band 802.11 Wi-Fi through the Windows Portable Device API (WPD) and via USB Flash drives. Additional options are available to allow discovery and configuration over a specific medium.

The recommended state for this setting is: Disabled

This setting enhances the security of the environment and reduces the overall risk exposure related to user configuration of wireless settings."
          solution    : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Disabled

Administrative Templates\Network\Windows Connect Now\Configuration of wireless settings using Windows Connect Now

Impact:

WCN operations are disabled over all media."
          reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|15.4,CSCv7|15.5,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
          see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
          show_output : YES
        </report>
      </then>
    </if>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "4.6.17.2 (L2) Ensure 'Prohibit access of the Windows Connect Now wizards' is set to 'Enabled'"
      info        : "This policy setting prohibits access to Windows Connect Now (WCN) wizards.

The recommended state for this setting is: Enabled

Allowing standard users to access the Windows Connect Now wizard increases the risk and attack surface."
      solution    : 'To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Enabled

Administrative Templates\\Network\\Windows Connect Now\\Prohibit access of the Windows Connect Now wizards

Impact:

The WCN wizards are turned off and users have no access to any of the wizard tasks. All the configuration related tasks including \'Set up a wireless router or access point\' and \'Add a wireless device\' are disabled.'
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "1"
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\WCN\UI"
      reg_item    : "DisableWcnUi"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          type        : REGISTRY_SETTING
          description : "AllowLLTDIOOnDomain"
          value_type  : POLICY_DWORD
          value_data  : "0"
          reg_key     : "HKLM\SOFTWARE\Policies\Microsoft\Windows\LLTD"
          reg_item    : "AllowLLTDIOOnDomain"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "AllowLLTDIOOnPublicNet"
          value_type  : POLICY_DWORD
          value_data  : "0"
          reg_key     : "HKLM\SOFTWARE\Policies\Microsoft\Windows\LLTD"
          reg_item    : "AllowLLTDIOOnPublicNet"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "EnableLLTDIO"
          value_type  : POLICY_DWORD
          value_data  : "0"
          reg_key     : "HKLM\SOFTWARE\Policies\Microsoft\Windows\LLTD"
          reg_item    : "EnableLLTDIO"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "ProhibitLLTDIOOnPrivateNet"
          value_type  : POLICY_DWORD
          value_data  : "0"
          reg_key     : "HKLM\SOFTWARE\Policies\Microsoft\Windows\LLTD"
          reg_item    : "ProhibitLLTDIOOnPrivateNet"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "4.6.8.1 (L2) Ensure 'Turn on Mapper I/O (LLTDIO) driver' is set to 'Disabled'"
          info        : "This policy setting changes the operational behavior of the Mapper I/O network protocol driver.

LLTDIO allows a computer to discover the topology of a network it's connected to. It also allows a computer to initiate Quality-of-Service requests such as bandwidth estimation and network health analysis.

The recommended state for this setting is: Disabled

To help protect from potentially discovering and connecting to unauthorized devices, this setting should be disabled to prevent responding to network traffic for network topology discovery."
          solution    : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Disabled

Administrative Templates\Network\Link-Layer Topology Discovery\Turn on Mapper I/O (LLTDIO) driver

Impact:

None - this is the default behavior."
          reference   : "800-171|3.4.2,800-171r3|03.04.02,800-53|CM-6,800-53r5|CM-6,CSCv7|5.1,CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,LEVEL|2A,SWIFT-CSCv1|2.3"
          see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
          show_output : YES
        </report>
      </then>
    </if>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          type        : REGISTRY_SETTING
          description : "AllowRspndrOnDomain"
          value_type  : POLICY_DWORD
          value_data  : "0"
          reg_key     : "HKLM\SOFTWARE\Policies\Microsoft\Windows\LLTD"
          reg_item    : "AllowRspndrOnDomain"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "AllowRspndrOnPublicNet"
          value_type  : POLICY_DWORD
          value_data  : "0"
          reg_key     : "HKLM\SOFTWARE\Policies\Microsoft\Windows\LLTD"
          reg_item    : "AllowRspndrOnPublicNet"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "EnableRspndr"
          value_type  : POLICY_DWORD
          value_data  : "0"
          reg_key     : "HKLM\SOFTWARE\Policies\Microsoft\Windows\LLTD"
          reg_item    : "EnableRspndr"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "ProhibitRspndrOnPrivateNet"
          value_type  : POLICY_DWORD
          value_data  : "0"
          reg_key     : "HKLM\SOFTWARE\Policies\Microsoft\Windows\LLTD"
          reg_item    : "ProhibitRspndrOnPrivateNet"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "4.6.8.2 (L2) Ensure 'Turn on Responder (RSPNDR) driver' is set to 'Disabled'"
          info        : "This policy setting changes the operational behavior of the Responder network protocol driver.

The Responder allows a computer to participate in Link Layer Topology Discovery requests so that it can be discovered and located on the network. It also allows a computer to participate in Quality-of-Service activities such as bandwidth estimation and network health analysis.

The recommended state for this setting is: Disabled

To help protect from potentially discovering and connecting to unauthorized devices, this setting should be disabled to prevent responding to network traffic for network topology discovery."
          solution    : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Disabled

Administrative Templates\Network\Link-Layer Topology Discovery\Turn on Responder

Impact:

None - this is the default behavior."
          reference   : "800-171|3.4.2,800-171r3|03.04.02,800-53|CM-6,800-53r5|CM-6,CSCv7|5.1,CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,LEVEL|2A,SWIFT-CSCv1|2.3"
          see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
          show_output : YES
        </report>
      </then>
    </if>

    <custom_item>
      type         : GUID_REGISTRY_SETTING
      description  : "47.1 (L2) Ensure 'Disallow KMS Client Online AVS Validation' is set to 'Allow'"
      info         : "The Key Management Service (KMS) is a Microsoft license activation method that entails setting up a local server to store the software licenses. The KMS server itself needs to connect to Microsoft to activate the KMS service, but subsequent on-network clients can activate Microsoft Windows OS and/or their Microsoft Office via the KMS server instead of connecting directly to Microsoft. This policy setting lets you opt-out of sending KMS client activation data to Microsoft automatically.

The recommended state for this setting is: Allow

Even though the KMS licensing method does not

require

KMS clients to connect to Microsoft, they still send KMS client activation state data to Microsoft automatically. Preventing this information from being sent can help reduce privacy concerns in high security environments."
      solution     : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Allow :

Licensing\Disallow KMS Client Online AVS Validation

Impact:

The computer is prevented from sending data to Microsoft regarding its KMS client activation state."
      reference    : "800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.06b.,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv7|9.2,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|2A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3"
      see_also     : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type   : POLICY_DWORD
      value_data   : "1"
      reg_key      : "HKLM\Software\Microsoft\PolicyManager\Providers\{GUID}\Default\Device\Licensing"
      reg_item     : "DisallowKMSClientOnlineAVSValidation"
      reg_option   : CAN_NOT_BE_NULL
      guid_reg_key : "HKLM\Software\Microsoft\PolicyManager\Current\Device\Licensing"
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "49.5 (L2) Ensure 'Devices: Prevent users from installing printer drivers when connecting to shared printers' is set to 'Enable'"
      info        : "For a computer to print to a shared printer, the driver for that shared printer must be installed on the local computer. This security setting determines who is allowed to install a printer driver as part of connecting to a shared printer.

The recommended state for this setting is: Enable

Note: This setting does not affect the ability to add a local printer. This setting does not affect Administrators.

It may be appropriate in some organizations to allow users to install printer drivers on their own workstations. However, in a high security environment, you should allow only Administrators, not users, to do this, because printer driver installation may unintentionally cause the computer to become less stable. A malicious user could install inappropriate printer drivers in a deliberate attempt to damage the computer, or a user might accidentally install malicious software that masquerades as a printer driver. It is feasible for an attacker to disguise a Trojan horse program as a printer driver. The program may appear to users as if they must use it to print, but such a program could unleash malicious code on your computer network."
      solution    : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Enable :

Local Policies Security Options\Devices: Prevent users from installing printer drivers when connecting to shared printers

Impact:

Only Administrators will be able to install a printer driver as part of connecting to a shared printer. The ability to add a local printer will not be affected."
      reference   : "800-171|3.1.1,800-171|3.1.5,800-171|3.3.8,800-171|3.3.9,800-171r3|03.01.01,800-171r3|03.01.02,800-171r3|03.01.05,800-171r3|03.01.05a.,800-171r3|03.01.05b.,800-171r3|03.03.08b.,800-53|AC-2,800-53|AC-3,800-53|AC-6,800-53|AC-6(1),800-53|AC-6(7),800-53|AU-9(4),800-53r5|AC-2,800-53r5|AC-5,800-53r5|AC-6,800-53r5|AC-6(1),800-53r5|AC-6(7),800-53r5|AU-9(4),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(d),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.3(d),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv8|6.8,CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-1,CSF|PR.PT-3,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|PR.AA-01,CSF2.0|PR.AA-05,CSF2.0|PR.DS-10,CSF2.0|PR.IR-01,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(b),ISO-27001-2022|A.5.15,ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.18,ISO-27001-2022|A.5.33,ISO-27001-2022|A.8.2,ISO-27001-2022|A.8.3,ISO-27001-2022|A.8.15,ISO-27001-2022|A.8.18,ISO-27001-2022|A.8.20,ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.2.5,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.4,ISO/IEC-27001|A.9.4.5,ISO/IEC-27001|A.12.4.2,ITSG-33|AC-2,ITSG-33|AC-3,ITSG-33|AC-6,ITSG-33|AC-6(1),ITSG-33|AU-9(4),ITSG-33|AU-9(4)(a),ITSG-33|AU-9(4)(b),LEVEL|2A,NESA|M1.1.3,NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|AM28,NIAv2|AM31,NIAv2|GS3,NIAv2|GS4,NIAv2|GS8c,NIAv2|NS5j,NIAv2|SM5,NIAv2|SM6,NIAv2|SS13c,NIAv2|SS14e,NIAv2|SS15c,NIAv2|SS29,NIAv2|VL3b,PCI-DSSv3.2.1|7.1.2,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,PCI-DSSv4.0|10.3.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "1"
      reg_key     : "HKLM\System\CurrentControlSet\Control\Print\Providers\LanMan Print Services\Servers"
      reg_item    : "AddPrinterDrivers"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type         : GUID_REGISTRY_SETTING
      description  : "54.1 (L2) Ensure 'Allow Message Sync' is set to 'message sync is not allowed and cannot be changed by the user.'"
      info         : "This policy setting allows backup and restore of cellular text messages to Microsoft's cloud services.

The recommended state for this setting is: message sync is not allowed and cannot be changed by the user.

In a high security environment, data should never be sent to any third-party since this data could contain sensitive information."
      solution     : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to message sync is not allowed and cannot be changed by the user.:

Messaging\Allow Message Sync

Impact:

Cellular text messages will not be backed up to (or restored from) Microsoft's cloud services."
      reference    : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also     : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type   : POLICY_DWORD
      value_data   : "0"
      reg_key      : "HKLM\Software\Microsoft\PolicyManager\Providers\{GUID}\Default\Device\Messaging"
      reg_item     : "AllowMessageSync"
      reg_option   : CAN_NOT_BE_NULL
      guid_reg_key : "HKLM\Software\Microsoft\PolicyManager\Current\Device\Messaging"
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "55.3 (L2) Ensure 'Allow Shared User App Data' is set to 'Block'"
      info        : "Manages a Windows app's ability to share data between users who have installed the app. Data is shared through the SharedLocal folder. This folder is available through the Windows.Storage API.

The recommended state for this setting is: Block

Users of a system could accidentally share sensitive data with other users on the same system."
      solution    : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Block

Microsoft App Store\Allow Shared User App Data

Impact:

None - this is the default behavior."
      reference   : "800-171|3.1.1,800-171r3|03.01.02,800-53|AC-3,800-53r5|AC-3,CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSF|PR.AC-4,CSF|PR.PT-3,CSF2.0|PR.AA-05,CSF2.0|PR.DS-10,CSF2.0|PR.IR-01,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO-27001-2022|A.5.15,ISO-27001-2022|A.5.33,ISO-27001-2022|A.8.3,ISO-27001-2022|A.8.18,ISO-27001-2022|A.8.20,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,LEVEL|2A,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|31.1"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "0"
      reg_key     : "HKLM\SOFTWARE\Policies\Microsoft\Windows\CurrentVersion\AppModel\StateManager"
      reg_item    : "AllowSharedLocalAppData"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type         : GUID_REGISTRY_SETTING
      description  : "55.5 (L2) Ensure 'Disable Store Originated Apps' is set to 'Enabled'"
      info         : "This setting configures the launch of all apps from the Microsoft Store that came pre-installed or were downloaded.

The recommended state for this setting is: Enabled

Note: This policy setting only applies to Windows 10 Enterprise and Windows 10 Education editions.

The Store service is a retail outlet built into Windows, primarily for consumer use. In an enterprise managed environment the IT department should be managing the installation of all applications to reduce the risk of the installation of vulnerable software."
      solution     : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Enabled :

Microsoft App Store\Disable Store Originated Apps

Impact:

All apps from the Microsoft Store that came pre-installed or were downloaded are prevented from launching. Existing Microsoft Store apps will not be updated. Microsoft Store is disabled."
      reference    : "800-171|3.4.8,800-171r3|03.04.08,800-53|CM-7(5),800-53|CM-10,800-53r5|CM-7(5),800-53r5|CM-10,CSCv7|9.2,CSCv8|2.5,CSF|DE.CM-3,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-03,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.5.32,ISO-27001-2022|A.8.19,ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
      see_also     : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type   : POLICY_DWORD
      value_data   : "1"
      reg_key      : "HKLM\Software\Microsoft\PolicyManager\Providers\{GUID}\Default\Device\ApplicationManagement"
      reg_item     : "DisableStoreOriginatedApps"
      reg_option   : CAN_NOT_BE_NULL
      guid_reg_key : "HKLM\Software\Microsoft\PolicyManager\Current\Device\ApplicationManagement"
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "60.1 (L2) Ensure 'Enable news and interests' is set to 'Not Allowed'"
      info        : "This policy setting specifies whether the

news and interests

feature is allowed on the device.

The recommended state for this setting is: Not Allowed

Note: This setting only applies to Windows 10. When configured in settings catalog for a Windows 11 system an error will be generated in both Intune and the local event log.

Due to privacy concerns, apps and features such as

news and interests

on the Windows taskbar should be treated as a possible security risk due to the potential of data being sent back to third-parties, such as Microsoft.

In addition, the app may display inappropriate

news and interests

within the feed."
      solution    : 'To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Not Allowed :

News and interests\\Enable News and interests

Note: At time of benchmark publication, the Feeds category was not visible when browsing by category. To find this setting, search for news and feeds and the Feeds category will show.

Impact:

The

news and interests

feature on the Windows taskbar will not be available on the device.

Note: At time of benchmark publication, this setting does not hide or disable the taskbar menu options for the

news and interests

feature, however attempting to turn the feature back on does not cause any visible change. It is possible that Microsoft will modify this behavior to \'gray out\' the taskbar menu options in a future OS update.'
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "0"
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Windows Feeds"
      reg_item    : "EnableFeeds"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type         : GUID_REGISTRY_SETTING
      description  : "61.1 (L2) Ensure 'Disallow Cloud Notification' is set to 'Allow'"
      info         : "This policy setting blocks applications from using the network to send notifications to update tiles, tile badges, toast, or raw notifications. This policy setting turns off the connection between Windows and the Windows Push Notification Service (WNS). This policy setting also stops applications from being able to poll application services to update tiles.

The recommended state for this setting is: Allow

Windows Push Notification Services (WNS) is a mechanism to receive third-party notifications and updates from the cloud/Internet. In a high security environment, external systems, especially those hosted outside the organization, should be prevented from having an impact on the secure workstations."
      solution     : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Allow

Notifications\Disallow Cloud Notification

Impact:

Applications and system features will not be able receive notifications from the network from WNS or via notification polling APIs."
      reference    : "800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.06b.,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv7|9.2,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|2A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3"
      see_also     : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type   : POLICY_DWORD
      value_data   : "1"
      reg_key      : "HKLM\Software\Microsoft\PolicyManager\Providers\{GUID}\Default\Device\Notifications"
      reg_item     : "DisallowCloudNotification"
      reg_option   : CAN_NOT_BE_NULL
      guid_reg_key : "HKLM\Software\Microsoft\PolicyManager\Current\Device\Notifications"
    </custom_item>

    <custom_item>
      type         : GUID_REGISTRY_SETTING
      description  : "68.1 (L2) Ensure 'Allow Cross Device Clipboard' is set to 'Block'"
      info         : "This setting determines whether Clipboard contents can be synchronized across devices.

The recommended state for this setting is: Block

In high security environments, clipboard data should stay local to the system and not synced across devices, as it may contain very sensitive information that must be contained locally."
      solution     : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Block :

Privacy\Allow Cross Device Clipboard

Impact:

Clipboard contents will not be shareable to other devices."
      reference    : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also     : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type   : POLICY_DWORD
      value_data   : "0"
      reg_key      : "HKLM\Software\Microsoft\PolicyManager\Providers\{GUID}\Default\Device\Privacy"
      reg_item     : "AllowCrossDeviceClipboard"
      reg_option   : CAN_NOT_BE_NULL
      guid_reg_key : "HKLM\Software\Microsoft\PolicyManager\Current\Device\Privacy"
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "68.3 (L2) Ensure 'Disable Advertising ID' is set to 'Enabled'"
      info        : "This policy setting turns off the advertising ID, preventing apps from using the ID for experiences across apps.

The recommended state for this setting is: Enabled

Tracking user activity for advertising purposes, even anonymously, may be a privacy concern. In an enterprise managed environment, applications should not need or require tracking for targeted advertising."
      solution    : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Enabled :

Privacy\Disable Advertising ID

Impact:

The advertising ID is turned off. Apps can't use the ID for experiences across apps."
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "1"
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\AdvertisingInfo"
      reg_item    : "DisabledByGroupPolicy"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type         : GUID_REGISTRY_SETTING
      description  : "68.5 (L2) Ensure 'Upload User Activities' is set to 'Disabled'"
      info         : "This policy setting determines whether published User Activities can be uploaded to the cloud.

The recommended state for this setting is: Disabled

Due to privacy concerns, data should never be sent to any third-party since this data could contain sensitive information."
      solution     : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Disabled :

Privacy\Upload User Activities

Impact:

Activities of type User Activity are not allowed to be uploaded to the cloud. The Timeline feature will not function across devices."
      reference    : "800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.06b.,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv7|9.2,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|2A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3"
      see_also     : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type   : POLICY_DWORD
      value_data   : "0"
      reg_key      : "HKLM\Software\Microsoft\PolicyManager\Providers\{GUID}\Default\Device\Privacy"
      reg_item     : "UploadUserActivities"
      reg_option   : CAN_NOT_BE_NULL
      guid_reg_key : "HKLM\Software\Microsoft\PolicyManager\Current\Device\Privacy"
    </custom_item>

    <custom_item>
      type         : GUID_REGISTRY_SETTING
      description  : "72.1 (L2) Ensure 'Allow Cloud Search' is set to 'Not allowed'"
      info         : "This policy setting allows search and Cortana to search cloud sources like OneDrive and SharePoint.

The recommended state for this setting is: Not allowed

Due to privacy concerns, data should never be sent to any third-party since this data could contain sensitive information."
      solution     : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Not allowed :

Search\Allow Cloud Search

Impact:

Search and Cortana will not be permitted to search cloud sources like OneDrive and SharePoint."
      reference    : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also     : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type   : POLICY_DWORD
      value_data   : "0"
      reg_key      : "HKLM\Software\Microsoft\PolicyManager\Providers\{GUID}\Default\Device\Search"
      reg_item     : "AllowCloudSearch"
      reg_option   : CAN_NOT_BE_NULL
      guid_reg_key : "HKLM\Software\Microsoft\PolicyManager\Current\Device\Search"
    </custom_item>

    <custom_item>
      type         : GUID_REGISTRY_SETTING
      description  : "74.1 (L2) Ensure 'Allow Online Tips' is set to 'Block'"
      info         : "This policy setting configures the retrieval of online tips and help for the Settings app.

The recommended state for this setting is: Block

Due to privacy concerns, data should never be sent to any third-party since this data could contain sensitive information."
      solution     : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Block

Settings\Allow Online Tips

Impact:

Settings will not contact Microsoft content services to retrieve tips and help content."
      reference    : "800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.06b.,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv7|9.2,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|2A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3"
      see_also     : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type   : POLICY_DWORD
      value_data   : "0"
      reg_key      : "HKLM\Software\Microsoft\PolicyManager\Providers\{GUID}\Default\Device\Settings"
      reg_item     : "AllowOnlineTips"
      reg_option   : CAN_NOT_BE_NULL
      guid_reg_key : "HKLM\Software\Microsoft\PolicyManager\Current\Device\Settings"
    </custom_item>

    <custom_item>
      type         : GUID_REGISTRY_SETTING
      description  : "80.1 (L2) Ensure 'Allow Font Providers' is set to 'Not allowed'"
      info         : "This policy setting determines whether Windows is allowed to download fonts and font catalog data from an online font provider.

The recommended state for this setting is: Not allowed

In an enterprise managed environment the IT department should be managing the changes to the system configuration, to ensure all changes are tested and approved."
      solution     : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Not allowed :

System\Allow Font Providers

Impact:

Windows will not connect to an online font provider and will only enumerate locally-installed fonts."
      reference    : "800-171|3.5.2,800-171r3|03.05.12,800-53|IA-5,800-53r5|SR-11,CSCv7|18.4,CSCv8|16.5,CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.17,ITSG-33|IA-5,LEVEL|2A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2"
      see_also     : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type   : POLICY_DWORD
      value_data   : "0"
      reg_key      : "HKLM\Software\Microsoft\PolicyManager\Providers\{GUID}\Default\Device\System"
      reg_item     : "AllowFontProviders"
      reg_option   : CAN_NOT_BE_NULL
      guid_reg_key : "HKLM\Software\Microsoft\PolicyManager\Current\Device\System"
    </custom_item>

    <custom_item>
      type         : GUID_REGISTRY_SETTING
      description  : "80.2 (L2) Ensure 'Allow Location' is set to 'Force Location Off...'"
      info         : "This policy setting turns off the location feature for the computer.

The recommended state for this setting is: Force Location Off Force Location Off. All Location Privacy settings are toggled off and grayed out. Users can't change the settings, and no apps are allowed access to the Location service, including Cortana and Search.

This setting affects the location feature (e.g. GPS or other location tracking). From a security perspective, it's not a good idea to reveal your location to software in most cases, but there are legitimate uses, such as mapping software. However, they should not be used in high security environments."
      solution     : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Force Location Off...

System\Allow Location

Impact:

The location feature is turned off, and all programs on the computer are prevented from using location information from the location feature."
      reference    : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also     : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type   : POLICY_DWORD
      value_data   : "0"
      reg_key      : "HKLM\Software\Microsoft\PolicyManager\Providers\{GUID}\Default\Device\System"
      reg_item     : "AllowLocation"
      reg_option   : CAN_NOT_BE_NULL
      guid_reg_key : "HKLM\Software\Microsoft\PolicyManager\Current\Device\System"
    </custom_item>

    <custom_item>
      type         : GUID_REGISTRY_SETTING
      description  : "80.4 (L2) Ensure 'Disable Enterprise Auth Proxy' is set to 'Enable'"
      info         : "This policy setting controls whether the Connected User Experience and Telemetry service can automatically use an authenticated proxy to send data back to Microsoft.

The recommended state for this setting is: Enable

Sending any data to a third-party vendor is a security concern and should only be done on an as needed basis."
      solution     : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Enable

System\Disable Enterprise Auth Proxy

Impact:

The Connected User Experience and Telemetry service will be blocked from automatically using an authenticated proxy."
      reference    : "800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.06b.,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv7|9.2,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|2A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3"
      see_also     : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type   : POLICY_DWORD
      value_data   : "1"
      reg_key      : "HKLM\Software\Microsoft\PolicyManager\Providers\{GUID}\Default\Device\System"
      reg_item     : "DisableEnterpriseAuthProxy"
      reg_option   : CAN_NOT_BE_NULL
      guid_reg_key : "HKLM\Software\Microsoft\PolicyManager\Current\Device\System"
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "80.5 (L2) Ensure 'Disable One Drive File Sync' is set to 'Sync Disabled'"
      info        : "This policy setting lets you prevent apps and features from working with files on OneDrive using the Next Generation Sync Client.

The recommended state for this setting is: Sync Disabled

Enabling this setting prevents users from accidentally (or intentionally) uploading confidential or sensitive corporate information to the OneDrive cloud service using the Next Generation Sync Client.

Note: This security concern applies to

any

cloud-based file storage application installed on a workstation, not just the one supplied with Windows."
      solution    : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Sync Disabled :

System\Disable One Drive File Sync

Impact:

Users can't access OneDrive from the OneDrive app and file picker. Windows Store apps can't access OneDrive using the WinRT API. OneDrive doesn't appear in the navigation pane in File Explorer. OneDrive files aren't kept in sync with the cloud. Users can't automatically upload photos and videos from the camera roll folder.

Note: If your organization uses Microsoft 365, be aware that this setting will prevent users from saving files to OneDrive/SkyDrive.

 -

Allow syncing OneDrive accounts for only specific organizations

- a computer-based setting that restricts OneDrive client connections to only approved tenant IDs.
 -

Prevent users from synchronizing personal OneDrive accounts

- a user-based setting that prevents use of consumer OneDrive (i.e. non-business)."
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|13.4,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "1"
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\OneDrive"
      reg_item    : "DisableFileSyncNGSC"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "81.1 (L2) Ensure 'Bluetooth Audio Gateway Service (BTAGService)' is set to 'Disabled'"
      info        : "Service supporting the audio gateway role of the Bluetooth Handsfree Profile.

The recommended state for this setting is: Disabled

Bluetooth technology has inherent security risks - especially prior to the v2.1 standard. Wireless Bluetooth traffic is not well encrypted (if at all), so in a high-security environment, it should not be permitted, in spite of the added inconvenience of not being able to use Bluetooth devices."
      solution    : "Remediation of this service is currently not possible through Settings Catalog or a custom profile OMA-URI. Instead, it can be scripted and deployed through the Intune Scripts or Remediations blade or by other means.

To establish the recommended configuration via PowerShell, run the following cmdlet:

Set-Service -Name BTAGService -StartupType Disabled

Note: This service was first introduced in Windows 10 Release 1803. It appears to have replaced the older

Bluetooth Handsfree Service (BthHFSrv)

, which was removed from Windows in that release (it is not simply a rename, but a different service).

Impact:

Bluetooth hands-free devices will not function properly with the computer."
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "4"
      reg_key     : "HKLM\System\CurrentControlSet\Services\BTAGService"
      reg_item    : "Start"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "81.10 (L2) Ensure 'Link-Layer Topology Discovery Mapper (lltdsvc)' is set to 'Disabled'"
      info        : "Creates a Network Map, consisting of PC and device topology (connectivity) information, and metadata describing each PC and device.

The recommended state for this setting is: Disabled

The feature that this service enables could potentially be used for unauthorized discovery and connection to network devices. Disabling the service helps to prevent responses to requests for network topology discovery in high security environments."
      solution    : "Remediation of this service is currently not possible through Settings Catalog or a custom profile OMA-URI. Instead, it can be scripted and deployed through the Intune Scripts or Remediations blade or by other means.

To establish the recommended configuration via PowerShell, run the following cmdlet:

Set-Service -Name lltdsvc -StartupType Disabled

Impact:

The Network Map will not function properly."
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "4"
      reg_key     : "HKLM\System\CurrentControlSet\Services\lltdsvc"
      reg_item    : "Start"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "81.13 (L2) Ensure 'Microsoft iSCSI Initiator Service (MSiSCSI)' is set to 'Disabled'"
      info        : "Manages Internet SCSI (iSCSI) sessions from this computer to remote target devices.

The recommended state for this setting is: Disabled

This service is critically necessary in order to directly attach to an iSCSI device. However, iSCSI itself uses a very weak authentication protocol (CHAP), which means that the passwords for iSCSI communication are easily exposed, unless all of the traffic is isolated and/or encrypted using another technology like IPsec. This service is generally more appropriate for servers in a controlled environment then on workstations requiring high security."
      solution    : "Remediation of this service is currently not possible through Settings Catalog or a custom profile OMA-URI. Instead, it can be scripted and deployed through the Intune Scripts or Remediations blade or by other means.

To establish the recommended configuration via PowerShell, run the following cmdlet:

Set-Service -Name MSiSCSI -StartupType Disabled

Impact:

The computer will not be able to directly login to or access iSCSI targets."
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "4"
      reg_key     : "HKLM\System\CurrentControlSet\Services\MSiSCSI"
      reg_item    : "Start"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "81.15 (L2) Ensure 'Peer Name Resolution Protocol (PNRPsvc)' is set to 'Disabled'"
      info        : "Enables serverless peer name resolution over the Internet using the Peer Name Resolution Protocol (PNRP).

The recommended state for this setting is: Disabled

Peer Name Resolution Protocol is a distributed and (mostly) serverless way to handle name resolution of clients with each other. In a high security environment, it is more secure to rely on centralized name resolution methods maintained by authorized staff."
      solution    : "Remediation of this service is currently not possible through Settings Catalog or a custom profile OMA-URI. Instead, it can be scripted and deployed through the Intune Scripts or Remediations blade or by other means.

To establish the recommended configuration via PowerShell, run the following cmdlet:

Set-Service -Name PNRPsvc -StartupType Disabled

Impact:

Some peer-to-peer and collaborative applications, such as Remote Assistance, may not function."
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "4"
      reg_key     : "HKLM\System\CurrentControlSet\Services\PNRPsvc"
      reg_item    : "Start"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "81.16 (L2) Ensure 'Peer Networking Grouping (p2psvc)' is set to 'Disabled'"
      info        : "Enables multi-party communication using Peer-to-Peer Grouping.

The recommended state for this setting is: Disabled

Peer Name Resolution Protocol is a distributed and (mostly) serverless way to handle name resolution of clients with each other. In a high security environment, it is more secure to rely on centralized name resolution methods maintained by authorized staff."
      solution    : "Remediation of this service is currently not possible through Settings Catalog or a custom profile OMA-URI. Instead, it can be scripted and deployed through the Intune Scripts or Remediations blade or by other means.

To establish the recommended configuration via PowerShell, run the following cmdlet:

Set-Service -Name p2psvc -StartupType Disabled

Impact:

Some applications, such as HomeGroup, may not function."
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "4"
      reg_key     : "HKLM\System\CurrentControlSet\Services\p2psvc"
      reg_item    : "Start"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "81.17 (L2) Ensure 'Peer Networking Identity Manager (p2pimsvc)' is set to 'Disabled'"
      info        : "Provides identity services for the Peer Name Resolution Protocol (PNRP) and Peer-to-Peer Grouping services.

The recommended state for this setting is: Disabled

Peer Name Resolution Protocol is a distributed and (mostly) serverless way to handle name resolution of clients with each other. In a high security environment, it is more secure to rely on centralized name resolution methods maintained by authorized staff."
      solution    : "Remediation of this service is currently not possible through Settings Catalog or a custom profile OMA-URI. Instead, it can be scripted and deployed through the Intune Scripts or Remediations blade or by other means.

To establish the recommended configuration via PowerShell, run the following cmdlet:

Set-Service -Name p2pimsvc -StartupType Disabled

Impact:

The Peer Name Resolution Protocol (PNRP) and Peer-to-Peer Grouping services may not function, and some applications, such as HomeGroup and Remote Assistance, may not function correctly."
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "4"
      reg_key     : "HKLM\System\CurrentControlSet\Services\p2pimsvc"
      reg_item    : "Start"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "81.18 (L2) Ensure 'PNRP Machine Name Publication Service (PNRPAutoReg)' is set to 'Disabled'"
      info        : "This service publishes a machine name using the Peer Name Resolution Protocol. Configuration is managed via the netsh context 'p2p pnrp peer'.

The recommended state for this setting is: Disabled

Peer Name Resolution Protocol is a distributed and (mostly) serverless way to handle name resolution of clients with each other. In a high security environment, it is more secure to rely on centralized name resolution methods maintained by authorized staff."
      solution    : "Remediation of this service is currently not possible through Settings Catalog or a custom profile OMA-URI. Instead, it can be scripted and deployed through the Intune Scripts or Remediations blade or by other means.

To establish the recommended configuration via PowerShell, run the following cmdlet:

Set-Service -Name PNRPAutoReg -StartupType Disabled

Impact:

Some peer-to-peer and collaborative applications, such as Remote Assistance, may not function."
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "4"
      reg_key     : "HKLM\System\CurrentControlSet\Services\PNRPAutoReg"
      reg_item    : "Start"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "81.19 (L2) Ensure 'Print Spooler (Spooler)' is set to 'Disabled'"
      info        : "This service spools print jobs and handles interaction with printers.

The recommended state for this setting is: Disabled

In a high security environment, unnecessary services especially those with known vulnerabilities should be disabled.

Disabling the Print Spooler (Spooler) service mitigates the PrintNightmare vulnerability (

CVE-2021-34527

) and other attacks against the service."
      solution    : "Remediation of this service is currently not possible through Settings Catalog or a custom profile OMA-URI. Instead, it can be scripted and deployed through the Intune Scripts or Remediations blade or by other means.

To establish the recommended configuration via PowerShell, run the following cmdlet:

Set-Service -Name Spooler -StartupType Disabled

Impact:

Users will not be able to print, including printing to files (such as Adobe Portable Document Format (PDF)) which uses the Print Spooler service."
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : 4
      reg_key     : "HKLM\System\CurrentControlSet\Services\Spooler"
      reg_item    : "Start"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "81.2 (L2) Ensure 'Bluetooth Support Service (bthserv)' is set to 'Disabled'"
      info        : "The Bluetooth service supports discovery and association of remote Bluetooth devices.

The recommended state for this setting is: Disabled

Bluetooth technology has inherent security risks - especially prior to the v2.1 standard. Wireless Bluetooth traffic is not well encrypted (if at all), so in a high-security environment, it should not be permitted, in spite of the added inconvenience of not being able to use Bluetooth devices."
      solution    : "Remediation of this service is currently not possible through Settings Catalog or a custom profile OMA-URI. Instead, it can be scripted and deployed through the Intune Scripts or Remediations blade or by other means.

To establish the recommended configuration via PowerShell, run the following cmdlet:

Set-Service -Name bthserv -StartupType Disabled

Impact:

Already installed Bluetooth devices may fail to operate properly and new devices may be prevented from being discovered or associated. If Bluetooth devices were installed, then some Windows components, such as Devices and Printers, may fail to operate correctly - including hanging/freezing when opened. The solution, besides re-enabling this service, is to disable or delete the offending Bluetooth device(s) in Device Manager, or disable the device altogether via the system BIOS (if it is an on-board Bluetooth device)."
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "4"
      reg_key     : "HKLM\System\CurrentControlSet\Services\bthserv"
      reg_item    : "Start"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "81.20 (L2) Ensure 'Problem Reports and Solutions Control Panel Support (wercplsupport)' is set to 'Disabled'"
      info        : "This service provides support for viewing, sending and deletion of system-level problem reports for the Problem Reports and Solutions control panel.

The recommended state for this setting is: Disabled

This service is involved in the process of displaying/reporting issues & solutions to/from Microsoft. In a high security environment, preventing this information from being sent can help reduce privacy concerns for sensitive corporate information."
      solution    : "Remediation of this service is currently not possible through Settings Catalog or a custom profile OMA-URI. Instead, it can be scripted and deployed through the Intune Scripts or Remediations blade or by other means.

To establish the recommended configuration via PowerShell, run the following cmdlet:

Set-Service -Name wercplsupport -StartupType Disabled

Impact:

Sending and viewing system-level problem reports and solutions to and from Microsoft may no longer function."
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "4"
      reg_key     : "HKLM\System\CurrentControlSet\Services\wercplsupport"
      reg_item    : "Start"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "81.21 (L2) Ensure 'Remote Access Auto Connection Manager (RasAuto)' is set to 'Disabled'"
      info        : 'Creates a connection to a remote network whenever a program references a remote DNS or NetBIOS name or address.

The recommended state for this setting is: Disabled

The function of this service is to provide a \'demand dial\' type of functionality. In a high security environment, it is preferred that any remote \'dial\' connections (whether they be legacy dial-in POTS or VPN) are initiated by the user

not

automatically by the system.'
      solution    : 'Remediation of this service is currently not possible through Settings Catalog or a custom profile OMA-URI. Instead, it can be scripted and deployed through the Intune Scripts or Remediations blade or by other means.

To establish the recommended configuration via PowerShell, run the following cmdlet:

Set-Service -Name RasAuto -StartupType Disabled

Impact:

\'Dial on demand\' functionality will no longer operate - remote dial-in (POTS) and VPN connections must be initiated manually by the user.'
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "4"
      reg_key     : "HKLM\System\CurrentControlSet\Services\RasAuto"
      reg_item    : "Start"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "81.22 (L2) Ensure 'Remote Desktop Configuration (SessionEnv)' is set to 'Disabled'"
      info        : "Remote Desktop Configuration service (RDCS) is responsible for all Remote Desktop related configuration and session maintenance activities that require SYSTEM context. These include per-session temporary folders, RD themes, and RD certificates.

The recommended state for this setting is: Disabled

In a high security environment, Remote Desktop access is an increased security risk. For these environments, only local console access should be permitted."
      solution    : "Remediation of this service is currently not possible through Settings Catalog or a custom profile OMA-URI. Instead, it can be scripted and deployed through the Intune Scripts or Remediations blade or by other means.

To establish the recommended configuration via PowerShell, run the following cmdlet:

Set-Service -Name SessionEnv -StartupType Disabled

Impact:

Users will be unable to use Remote Assistance."
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "4"
      reg_key     : "HKLM\System\CurrentControlSet\Services\SessionEnv"
      reg_item    : "Start"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "81.23 (L2) Ensure 'Remote Desktop Services (TermService)' is set to 'Disabled'"
      info        : "Allows users to connect interactively to a remote computer. Remote Desktop and Remote Desktop Session Host Server depend on this service.

The recommended state for this setting is: Disabled

In a high security environment, Remote Desktop access is an increased security risk. For these environments, only local console access should be permitted."
      solution    : "Remediation of this service is currently not possible through Settings Catalog or a custom profile OMA-URI. Instead, it can be scripted and deployed through the Intune Scripts or Remediations blade or by other means.

To establish the recommended configuration via PowerShell, run the following cmdlet:

Set-Service -Name TermService -StartupType Disabled

Impact:

Remote Desktop Services will not be available on the computer."
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "4"
      reg_key     : "HKLM\System\CurrentControlSet\Services\TermService"
      reg_item    : "Start"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "81.24 (L2) Ensure 'Remote Desktop Services UserMode Port Redirector (UmRdpService)' is set to 'Disabled'"
      info        : "Allows the redirection of Printers/Drives/Ports for RDP connections.

The recommended state for this setting is: Disabled

In a security-sensitive environment, it is desirable to reduce the possible attack surface - preventing the redirection of COM, LPT and PnP ports will reduce the number of unexpected avenues for data exfiltration and/or malicious code transfer within an RDP session."
      solution    : "Remediation of this service is currently not possible through Settings Catalog or a custom profile OMA-URI. Instead, it can be scripted and deployed through the Intune Scripts or Remediations blade or by other means.

To establish the recommended configuration via PowerShell, run the following cmdlet:

Set-Service -Name UmRdpService -StartupType Disabled

Impact:

Printers, drives and ports (COM, LPT, PnP, etc.) will not be allowed to be redirected inside RDP sessions."
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "4"
      reg_key     : "HKLM\System\CurrentControlSet\Services\UmRdpService"
      reg_item    : "Start"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "81.26 (L2) Ensure 'Remote Registry (RemoteRegistry)' is set to 'Disabled'"
      info        : "Enables remote users to view and modify registry settings on this computer.

The recommended state for this setting is: Disabled

In a high security environment, exposing the registry to remote access is an increased security risk."
      solution    : "Remediation of this service is currently not possible through Settings Catalog or a custom profile OMA-URI. Instead, it can be scripted and deployed through the Intune Scripts or Remediations blade or by other means.

To establish the recommended configuration via PowerShell, run the following cmdlet:

Set-Service -Name RemoteRegistry -StartupType Disabled

Impact:

The registry can be viewed and modified only by users on the computer.

Note: Many remote administration tools, such as System Center Configuration Manager (SCCM), require the Remote Registry service to be operational for remote management. In addition, many vulnerability scanners use this service to access the registry remotely."
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "4"
      reg_key     : "HKLM\System\CurrentControlSet\Services\RemoteRegistry"
      reg_item    : "Start"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "81.28 (L2) Ensure 'Server (LanmanServer)' is set to 'Disabled'"
      info        : "Supports file, print, and named-pipe sharing over the network for this computer. If this service is stopped, these functions will be unavailable.

The recommended state for this setting is: Disabled

In a high security environment, a secure workstation should only be a

client

, not a server. Sharing workstation resources for remote access increases security risk as the attack surface is notably higher."
      solution    : "Remediation of this service is currently not possible through Settings Catalog or a custom profile OMA-URI. Instead, it can be scripted and deployed through the Intune Scripts or Remediations blade or by other means.

To establish the recommended configuration via PowerShell, run the following cmdlet:

Set-Service -Name LanmanServer -StartupType Disabled

Impact:

File, print and named-pipe sharing functions will be unavailable from this machine over the network.

Note: Many remote administration tools, such as System Center Configuration Manager (SCCM), require the Server service to be operational for remote management. In addition, many vulnerability scanners use this service to scan the file system remotely."
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "4"
      reg_key     : "HKLM\System\CurrentControlSet\Services\LanmanServer"
      reg_item    : "Start"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "81.30 (L2) Ensure 'SNMP Service (SNMP)' is set to 'Disabled' or 'Not Installed'"
      info        : "Enables Simple Network Management Protocol (SNMP) requests to be processed by this computer.

The recommended state for this setting is: Disabled or Not Installed

Note: This service is not installed by default. It is supplied with Windows, but is installed by enabling an optional Windows feature (

Simple Network Management Protocol (SNMP)

).

Features that enable inbound network connections increase the attack surface. In a high security environment, management of secure workstations should be handled locally."
      solution    : "Remediation of this service is currently not possible through Settings Catalog or a custom profile OMA-URI. Instead, it can be scripted and deployed through the Intune Scripts or Remediations blade or by other means.

To establish the recommended configuration via PowerShell, run the following cmdlet:

Set-Service -Name SNMP -StartupType Disabled

Impact:

The computer will be unable to process SNMP requests."
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "4"
      reg_key     : "HKLM\System\CurrentControlSet\Services\SNMP"
      reg_item    : "Start"
      reg_option  : CAN_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "81.35 (L2) Ensure 'Windows Error Reporting Service (WerSvc)' is set to 'Disabled'"
      info        : "Allows errors to be reported when programs stop working or responding and allows existing solutions to be delivered. Also allows logs to be generated for diagnostic and repair services.

The recommended state for this setting is: Disabled

If a Windows Error occurs in a secure, enterprise managed environment, the error should be reported directly to IT staff for troubleshooting and remediation. There is no benefit to the corporation to report these errors directly to Microsoft, and there is some risk of unknowingly exposing sensitive data as part of the error."
      solution    : "Remediation of this service is currently not possible through Settings Catalog or a custom profile OMA-URI. Instead, it can be scripted and deployed through the Intune Scripts or Remediations blade or by other means.

To establish the recommended configuration via PowerShell, run the following cmdlet:

Set-Service -Name WerSvc -StartupType Disabled

Impact:

If this service is stopped, error reporting might not work correctly and results of diagnostic services and repairs might not be displayed."
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "4"
      reg_key     : "HKLM\System\CurrentControlSet\Services\WerSvc"
      reg_item    : "Start"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "81.36 (L2) Ensure 'Windows Event Collector (Wecsvc)' is set to 'Disabled'"
      info        : "This service manages persistent subscriptions to events from remote sources that support WS-Management protocol. This includes Windows Vista event logs, hardware and IPMI-enabled event sources. The service stores forwarded events in a local Event Log.

The recommended state for this setting is: Disabled

In a high security environment, remote connections to secure workstations should be minimized, and management functions should be done locally."
      solution    : "Remediation of this service is currently not possible through Settings Catalog or a custom profile OMA-URI. Instead, it can be scripted and deployed through the Intune Scripts or Remediations blade or by other means.

To establish the recommended configuration via PowerShell, run the following cmdlet:

Set-Service -Name Wecsvc -StartupType Disabled

Impact:

If this service is stopped or disabled event subscriptions cannot be created and forwarded events cannot be accepted.

Note: Many remote management tools and third-party security audit tools depend on this service."
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "4"
      reg_key     : "HKLM\System\CurrentControlSet\Services\Wecsvc"
      reg_item    : "Start"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "81.39 (L2) Ensure 'Windows Push Notifications System Service (WpnService)' is set to 'Disabled'"
      info        : "This service runs in session 0 and hosts the notification platform and connection provider which handles the connection between the device and WNS server.

The recommended state for this setting is: Disabled

Note: In the first two releases of Windows 10 (R1507 & R1511), the display name of this service was initially named

Windows Push Notifications Service

- but it was renamed to

Windows Push Notifications System Service

starting with Windows 10 R1607.

Windows Push Notification Services (WNS) is a mechanism to receive third-party notifications and updates from the cloud/Internet. In a high security environment, external systems, especially those hosted outside the organization, should be prevented from having an impact on the secure workstations."
      solution    : "Remediation of this service is currently not possible through Settings Catalog or a custom profile OMA-URI. Instead, it can be scripted and deployed through the Intune Scripts or Remediations blade or by other means.

To establish the recommended configuration via PowerShell, run the following cmdlet:

Set-Service -Name WpnService -StartupType Disabled

Impact:

Live Tiles and other features will not get live updates."
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "4"
      reg_key     : "HKLM\System\CurrentControlSet\Services\WpnService"
      reg_item    : "Start"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "81.4 (L2) Ensure 'Downloaded Maps Manager (MapsBroker)' is set to 'Disabled'"
      info        : "Windows service for application access to downloaded maps. This service is started on-demand by application accessing downloaded maps.

Mapping technologies can unwillingly reveal your location to attackers and other software that picks up the information. In addition, automatic downloads of data from third-party sources should be minimized when not needed. Therefore, this service should not be needed in high security environments."
      solution    : "Remediation of this service is currently not possible through Settings Catalog or a custom profile OMA-URI. Instead, it can be scripted and deployed through the Intune Scripts or Remediations blade or by other means.

To establish the recommended configuration via PowerShell, run the following cmdlet:

Set-Service -Name MapsBroker -StartupType Disabled

Impact:

Applications will be prevented from accessing maps data."
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "4"
      reg_key     : "HKLM\System\CurrentControlSet\Services\MapsBroker"
      reg_item    : "Start"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "81.40 (L2) Ensure 'Windows PushToInstall Service (PushToInstall)' is set to 'Disabled'"
      info        : "This service manages Apps that are pushed to the device from the Microsoft Store App running on other devices or the web.

The recommended state for this setting is: Disabled

In a high security managed environment, application installations should be managed centrally by IT staff, not by end users."
      solution    : "Remediation of this service is currently not possible through Settings Catalog or a custom profile OMA-URI. Instead, it can be scripted and deployed through the Intune Scripts or Remediations blade or by other means.

To establish the recommended configuration via PowerShell, run the following cmdlet:

Set-Service -Name PushToInstall -StartupType Disabled

Impact:

Users will not be able to push Apps to this device from the Microsoft Store running on other devices or the web."
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "4"
      reg_key     : "HKLM\System\CurrentControlSet\Services\PushToInstall"
      reg_item    : "Start"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "81.41 (L2) Ensure 'Windows Remote Management (WS-Management) (WinRM)' is set to 'Disabled'"
      info        : "Windows Remote Management (WinRM) service implements the WS-Management protocol for remote management. WS-Management is a standard web services protocol used for remote software and hardware management. The WinRM service listens on the network for WS-Management requests and processes them.

The recommended state for this setting is: Disabled

Features that enable inbound network connections increase the attack surface. In a high security environment, management of secure workstations should be handled locally."
      solution    : "Remediation of this service is currently not possible through Settings Catalog or a custom profile OMA-URI. Instead, it can be scripted and deployed through the Intune Scripts or Remediations blade or by other means.

To establish the recommended configuration via PowerShell, run the following cmdlet:

Set-Service -Name WinRM -StartupType Disabled

Impact:

The ability to remotely manage the system with WinRM will be lost.

Note: Many remote administration tools, such as System Center Configuration Manager (SCCM), may require the WinRM service to be operational for remote management."
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "4"
      reg_key     : "HKLM\System\CurrentControlSet\Services\WinRM"
      reg_item    : "Start"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "81.42 (L2) Ensure 'WinHTTP Web Proxy Auto-Discovery Service (WinHttpAutoProxySvc)' is set to 'Disabled'"
      info        : "WinHTTP implements the client HTTP stack and provides developers with a Win32 API and COM Automation component for sending HTTP requests and receiving responses. In addition, WinHTTP provides support for auto-discovering a proxy configuration via its implementation of the Web Proxy Auto-Discovery (WPAD) protocol.

The recommended state for this setting is: Disabled

Note: Although CIS categorizes this as a L2 recommendation, if none of the cases listed in the Impact Section apply, we highly recommend disabling this service.

This service is primarily needed to support Web Proxy Auto-Discovery (WPAD), which is an auto-proxy discovery mechanism that could expose the computer to Man-In-The-Middle (MITM) attacks. If an organization depends on HTTP proxy configuration, it is recommended that other client configuration mechanisms be used instead, such as Group Policy."
      solution    : "Remediation of this service is currently not possible through Settings Catalog or a custom profile OMA-URI. Instead, it can be scripted and deployed through the Intune Scripts or Remediations blade or by other means.

To establish the recommended configuration via PowerShell, run the following cmdlet:

Set-Service -Name WinHttpAutoProxySvc -StartupType Disabled

Impact:

WPAD will cease to function for automatic HTTP proxy routing, which may prevent Internet connectivity for workstations in organizations that currently use WPAD. Microsoft also cautions that some software that uses the network stack may have a functional dependency on this service, so it is advised that you test disabling this service on a representation of user workstations and applications before disabling it across the entire organization.

Beginning with Windows 10 Release 1709, Microsoft changed the WPAD service to tightly integrate it with all proxy activity. Disabling this service now has these additional impacts:

 - The ability to set a manual (not just auto) proxy configuration.
 - Some VPN clients require the WPAD service, so disabling WPAD breaks them.
 - Some network-related applications will not work without WPAD running (e.g. Fiddler)."
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "4"
      reg_key     : "HKLM\SYSTEM\CurrentControlSet\Services\WinHttpAutoProxySvc"
      reg_item    : "Start"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "81.5 (L2) Ensure 'GameInput Service (GameInputSvc)' is set to 'Disabled'"
      info        : "This service enables the use of keyboards, mice, gamepads, and other input devices to be used with the GameInput API.

The recommended state for this setting is: Disabled

Note: GameInput service runs as LocalSystem in its own process of GameInputSvc.exe and doesn't share its process with other services.

GameInput API pipes input from keyboards, mice, gamepads, and other game controllers via Direct Memory Access (DMA) to decrease latency for gaming performance. This DMA use increases the risk of input data (especially keystrokes) being captured by a malicious attacker."
      solution    : "Remediation of this service is currently not possible through Settings Catalog or a custom profile OMA-URI. Instead, it can be scripted and deployed through the Intune Scripts or Remediations blade or by other means.

To establish the recommended configuration via PowerShell, run the following cmdlet:

Set-Service -Name GameInputSvc -StartupType Disabled

Impact:

Input devices will not be able to utilize the GameInput API."
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "4"
      reg_key     : "HKLM\SYSTEM\CurrentControlSet\Services\GameInputSvc"
      reg_item    : "Start"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "81.6 (L2) Ensure 'Geolocation Service (lfsvc)' is set to 'Disabled'"
      info        : "This service monitors the current location of the system and manages geofences (a geographical location with associated events).

The recommended state for this setting is: Disabled

This setting affects the location feature (e.g. GPS or other location tracking). From a security perspective, it's not a good idea to reveal your location to software in most cases, but there are legitimate uses, such as mapping software. However, they should not be used in high security environments."
      solution    : "Remediation of this service is currently not possible through Settings Catalog or a custom profile OMA-URI. Instead, it can be scripted and deployed through the Intune Scripts or Remediations blade or by other means.

To establish the recommended configuration via PowerShell, run the following cmdlet:

Set-Service -Name lfsvc -StartupType Disabled

Impact:

Applications will be unable to use or receive notifications for geolocation or geofences."
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type  : POLICY_DWORD
      value_data  : "4"
      reg_key     : "HKLM\System\CurrentControlSet\Services\lfsvc"
      reg_item    : "Start"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type         : GUID_REGISTRY_SETTING
      description  : "98.1 (L2) Ensure 'Allow suggested apps in Windows Ink Workspace' is set to 'Block'"
      info         : "This policy setting determines whether suggested apps in Windows Ink Workspace are allowed.

The recommended state for this setting is: Block

This Microsoft feature is designed to collect data and suggest apps based on that data collected. Disabling this setting will help ensure your data is not shared with any third party."
      solution     : "To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Block

Windows Ink Workspace\Allow suggested apps in Windows Ink Workspace

Impact:

The suggested apps in Windows Ink Workspace will not be allowed."
      reference    : "800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.06b.,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv7|9.2,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|2A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3"
      see_also     : "https://workbench.cisecurity.org/benchmarks/21767"
      value_type   : POLICY_DWORD
      value_data   : "0"
      reg_key      : "HKLM\Software\Microsoft\PolicyManager\Providers\{GUID}\Default\Device\WindowsInkWorkspace"
      reg_item     : "AllowSuggestedAppsInWindowsInkWorkspace"
      reg_option   : CAN_NOT_BE_NULL
      guid_reg_key : "HKLM\Software\Microsoft\PolicyManager\Current\Device\WindowsInkWorkSpace"
    </custom_item>
  </then>

  <else>
    <report type:"WARNING">
      description : "CIS_Microsoft_Intune_for_Windows_10_v4.0.0_L2.audit from CIS Microsoft Intune for Windows 10 Benchmark v4.0.0"
      info        : "NOTE: Nessus has not identified that the chosen audit applies to the target device."
      see_also    : "https://workbench.cisecurity.org/benchmarks/21767"
      show_output : YES
    </report>
  </else>
</if>

</group_policy>
</check_type>
