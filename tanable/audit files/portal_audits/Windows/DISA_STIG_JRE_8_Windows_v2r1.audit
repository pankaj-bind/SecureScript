#TRUSTED a0f9f8fca12a8b28978db31f3f2034d6a8ed9d0a381905ab4b94aa7fd5d57146d419c48e5ed0f53a6286375e74f773c6974764c2bba0383f89ec26ca757913dffa9da709b28fb23f150aadf97db464f1b09a8f449de4b5bc637346c09fd41b0073fdbec0cd533d28ab53d03a4ec67ef8910938a8840cc169fc70fc05ba636989b3e4ab2deaa5e07868e4c317583fb6e683268c721b75a363ada154cd5d106019972518cb768e55549cae5cdf5e9c14411c692c31126f94def19f26e42db01257432d87dfeaf47673ef7af2ec3ceeb79c2ca33542fec2b35f98b3c95469687fb672aa5c378c555a67a744d5ed4fa84120ea61bd7114176e0822e67a0b8cdb1cdfd1093ab14438ff5477de1276215959c0ace30957e293187e1f6b3a62e964747fadb6b9732c719479ec3c5068e035c5e4d691bc83d2bf79229c50377c71bb94fab9efdcd24906f2c428b13ff03566cf7a9540a7c739ae0bc3a62caf486ac3bccd243d9b219dc94d582296410c4414cd9eb8336ef7dfc34968fb59df7bf3778bd1bce97e3548cfd46b03e27437e9f3ddd4f1dbfedfb125ed7336bba2d2734901d2f09d066c7411d1337027791069632e69bf5c25be7d1ba4d2dbc47cb1d2f695ef88acc58c139131205680d4cbb4b7ab6f36d425fd7ec25ffd423066348d57f92e24b35a32861d6ca184d36d722fdb06a6376c47075ca38d1ee5b007aebed28f6f
#TRUST-RSA-SHA256 0d4a4761d3a2a98952eac73a2d3d9fbcef6756f4659b7e42c23be2728f01380f6a9cb240739e1a92dc68d3f6d63c4c1e353f6fd92b60eabcbec40a2c42b5081bf7e158d535640da5a6580399f9bccb83a544b34e4424674561d11267c3f23eaf4034a1d748b8bc314223fe57f05f86bc75981db65db4ca18d35986da5ec7c128b632575b943c268eaea0ea5438e6c8bcd4ca15627ec1e6de390d769d3a17f86a7b102823ce818bf4f2b20030b5c5319b2647abd8830ebb026664a9fb01ec15f0c152480d170a63f25485a75a0a163d3831822604e4ce18edfe3b03eb5163280fa0782ab414763fc6196361225e0344afaef4cc09756db425e223ab979ad4d40ea8b21bf0302811d0e60ab409aad52453db024f26281e04722bb8691c9547d7d9a0b2b779efc49656d43f4d1e304254711a707ee714d53270c71b4a01cedf1ecb22573d018570f0f9b5fe8eb2ce27eb01fcc7f5248d4f55b55828dada0344a8366b3ae5bb7f5e882112b080efd47eed5e2968b3924816a9b44f817678a731b2f59e474975f3bbb84696f0083c98ed7bf264a880b6863d517416d2ffbe617d7e76fed2d065e851a20671119284e86241e325912f226e4b14c4c18b8ee44c1bd52ebd402c310c31df4f09bb26704844b34d7cad5c8a69c13ee56090e8128f20409c2d57eb02aa83d08ccceadea99c10d6c0cdb7ccfa9f1b6672eeacfa32b0fe8565
#
# This script is Copyright (C) 2004-2025 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
# $Revision: 1.7 $
# $Date: 2025/01/06 $
#
# Description : This document implements the security configuration as recommended by the
#               DISA Oracle Java Runtime Environment (JRE) Version 8 for Windows v2r1 STIG.
#
#<ui_metadata>
#<display_name>DISA STIG Oracle JRE 8 Windows v2r1</display_name>
#<spec>
#  <type>DISA STIG</type>
#  <name>Oracle JRE 8 Windows</name>
#  <version>2.1.0</version>
#  <link>https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_JRE_Windows_V2R1_STIG.zip</link>
#</spec>
#<labels>disa,windows_java,agent</labels>
#<benchmark_refs>CAT,CCE,CCI,DISA_Benchmark,Group-ID,Rule-ID,STIG-ID,STIG-Legacy,Vuln-ID</benchmark_refs>
#<variables>
#  <variable>
#    <name>PATH_TO_DEPLOYMENT_PROP</name>
#    <default>C:\Program Files\Java\jre8\Lib\deployment.properties</default>
#    <description>Deployment Properties File</description>
#    <info>Full path to Deployment Properties File</info>
#    <value_type>WIN_FILE_PATH</value_type>
#  </variable>
#  <variable>
#    <name>PATH_TO_DEPLOYMENT_PROPFS</name>
#    <default>C:/Program Files/Java/jre8/Lib/deployment.properties</default>
#    <description>Deploy Prop File - Forward Slash</description>
#    <info>Full path to Deployment Properties File</info>
#    <value_type>WIN_FILE_PATH</value_type>
#  </variable>
#  <variable>
#    <name>PATH_TO_DEPLOYMENT_CONFIG</name>
#    <default>C:\Program Files\Java\jre8\Lib\deployment.config</default>
#    <description>Deployment Config File</description>
#    <info>Full path to Deployment Config File</info>
#    <value_type>WIN_FILE_PATH</value_type>
#  </variable>
#  <variable>
#    <name>PATH_TO_EXC_SITES</name>
#    <default>C:\Program Files\Java\jre8\Lib\exception.sites</default>
#    <description>exception sites file path</description>
#    <info>Full path for deployment.properties for exception sites file</info>
#    <value_type>WIN_FILE_PATH</value_type>
#  </variable>
#  <variable>
#    <name>PATH_TO_EXC_SITESBS</name>
#    <default>C:\\\Program Files\\Java\\jre8\\Lib\exception.sites</default>
#    <description>exception sites file - depl prop</description>
#    <info>Full path as defined in deployment.properties for exception sites file</info>
#    <value_type>WIN_FILE_PATH</value_type>
#  </variable>
#  <variable>
#    <name>JRE_INSTALL_PATH</name>
#    <default>C:\Program Files\Java\jre8</default>
#    <description>Java Install Path</description>
#    <info>Full path to Java Installatioin Directory</info>
#    <value_type>WIN_FILE_PATH</value_type>
#  </variable>
#</variables>
#</ui_metadata>

<check_type:"Windows" version:"2">
<group_policy:"DISA JRE 8">

<if>
  <condition type:"AND">
    <custom_item>
      type        : FILE_CHECK
      description : "Check for Java installation"
      value_type  : POLICY_TEXT
      value_data  : "@JRE_INSTALL_PATH@"
      file_option : MUST_EXIST
    </custom_item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "DISA_STIG_JRE_8_Windows_v2r1.audit for DISA Oracle Java Runtime Environment (JRE) Version 8 for Windows v2r1 STIG"
    </report>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "JRE8-WN-000160 - Oracle JRE 8 must lock the option to enable users to check publisher certificates for revocation - deployment.security.revocation.check"
      info        : "Certificates may be revoked due to improper issuance, compromise of the certificate, and failure to adhere to policy. Therefore, any certificate found revoked on a CRL or via Online Certificate Status Protocol (OCSP) should not be trusted. Permitting execution of an applet published with a revoked certificate may result in spoofing, malware, system modification, invasion of privacy, and denial of service.

Ensuring users cannot change these settings assures a more consistent security profile."
      solution    : "If the system is on the SIPRNet, this requirement is NA.

Navigate to the system-level 'deployment.properties' file for JRE.

The location of the deployment.properties file is defined in <JRE Installation Directory>\Lib\deployment.config

Add the key 'deployment.security.revocation.check=ALL_CERTIFICATES' to the deployment.properties file.

Add the key 'deployment.security.revocation.check.locked' to the deployment.properties file."
      reference   : "800-171|3.5.2,800-53|IA-5(2)(d),800-53r5|IA-5(2)(b)(2),CAT|II,CCI|CCI-001991,CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|JRE_8_and_Windows_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(2),NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-234695r617446_rule,STIG-ID|JRE8-WN-000160,STIG-Legacy|SV-81213,STIG-Legacy|V-66723,Vuln-ID|V-234695"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_JRE_Windows_V2R1_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : "@PATH_TO_DEPLOYMENT_PROP@"
      regex       : "^deployment\.security\.revocation\.check[\s]*="
      expect      : "^deployment\.security\.revocation\.check[\s]*=[\s]*ALL_CERTIFICATES"
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "JRE8-WN-000160 - Oracle JRE 8 must lock the option to enable users to check publisher certificates for revocation - eployment.security.revocation.check.locked"
      info        : "Certificates may be revoked due to improper issuance, compromise of the certificate, and failure to adhere to policy. Therefore, any certificate found revoked on a CRL or via Online Certificate Status Protocol (OCSP) should not be trusted. Permitting execution of an applet published with a revoked certificate may result in spoofing, malware, system modification, invasion of privacy, and denial of service.

Ensuring users cannot change these settings assures a more consistent security profile."
      solution    : "If the system is on the SIPRNet, this requirement is NA.

Navigate to the system-level 'deployment.properties' file for JRE.

The location of the deployment.properties file is defined in <JRE Installation Directory>\Lib\deployment.config

Add the key 'deployment.security.revocation.check=ALL_CERTIFICATES' to the deployment.properties file.

Add the key 'deployment.security.revocation.check.locked' to the deployment.properties file."
      reference   : "800-171|3.5.2,800-53|IA-5(2)(d),800-53r5|IA-5(2)(b)(2),CAT|II,CCI|CCI-001991,CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|JRE_8_and_Windows_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(2),NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-234695r617446_rule,STIG-ID|JRE8-WN-000160,STIG-Legacy|SV-81213,STIG-Legacy|V-66723,Vuln-ID|V-234695"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_JRE_Windows_V2R1_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : "@PATH_TO_DEPLOYMENT_PROP@"
      regex       : "^deployment\.security\.revocation\.check\.locked"
      expect      : "^deployment\.security\.revocation\.check\.locked"
    </custom_item>

    <custom_item>
      type        : FILE_CHECK
      description : "JRE8-WN-000010 - Oracle JRE 8 must have a deployment.config file present."
      info        : "By default no deployment.config file exists; thus, no system-wide deployment.properties file exists.  The file must be created. The deployment.config file is used for specifying the location and execution of system-level properties for the Java Runtime Environment. Without the deployment.config file, setting particular options for the Java control panel is impossible.

The deployment.config file can be created in either of the following locations:

<Windows Directory>\Sun\Java\Deployment\deployment.config
- or -
<JRE Installation Directory>\lib\deployment.config"
      solution    : "By default, no 'deployment.config' file exists; a text file must be created. Create a JRE deployment configuration file in either:

<Windows Directory>\Sun\Java\Deployment\deployment.config
- or -
<JRE Installation Directory>\Lib\deployment.config"
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|JRE_8_and_Windows_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-234683r617446_rule,STIG-ID|JRE8-WN-000010,STIG-Legacy|SV-81429,STIG-Legacy|V-66939,SWIFT-CSCv1|2.3,Vuln-ID|V-234683"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_JRE_Windows_V2R1_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : "@PATH_TO_DEPLOYMENT_CONFIG@"
      file_option : MUST_EXIST
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "JRE8-WN-000020 - Oracle JRE 8 deployment.config file must contain proper keys and values - deployment.system.config"
      info        : "The deployment.config  configuration file contains two keys.

The 'deployment.properties' key includes the path of the 'deployment.properties' file and the 'deployment.properties.mandatory' key contains either a TRUE or FALSE value.

If the path specified to 'deployment.properties' does not lead to a 'deployment.properties' file, the value of the 'deployment.system.config.mandatory' key determines how JRE will handle the situation.

If the value of the 'deployment.system.config.mandatory' key is TRUE and if the path to the 'deployment.properties' file is invalid, the JRE will not allow Java applications to run.   This is the desired behavior."
      solution    : "Navigate to the 'deployment.config' file for JRE.

Add the key 'deployment.system.config=<Path to deployment.properties>' to the 'deployment.config' file. The following is an example:
'deployment.system.config=file:///C:/Windows/Java/Deployment/deployment.properties'. Note the use of forward slashes.

Add the key 'deployment.system.config.mandatory=true' to the 'deployment.config' file."
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|JRE_8_and_Windows_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-234684r617446_rule,STIG-ID|JRE8-WN-000020,STIG-Legacy|SV-81431,STIG-Legacy|V-66941,SWIFT-CSCv1|2.3,Vuln-ID|V-234684"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_JRE_Windows_V2R1_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : "@PATH_TO_DEPLOYMENT_CONFIG@"
      regex       : "^deployment\.system.config=file:///"
      expect      : "^deployment\.system.config=file:///@PATH_TO_DEPLOYMENT_PROPFS@"
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "JRE8-WN-000020 - Oracle JRE 8 deployment.config file must contain proper keys and values - deployment.system.config.mandatory"
      info        : "The deployment.config  configuration file contains two keys.

The 'deployment.properties' key includes the path of the 'deployment.properties' file and the 'deployment.properties.mandatory' key contains either a TRUE or FALSE value.

If the path specified to 'deployment.properties' does not lead to a 'deployment.properties' file, the value of the 'deployment.system.config.mandatory' key determines how JRE will handle the situation.

If the value of the 'deployment.system.config.mandatory' key is TRUE and if the path to the 'deployment.properties' file is invalid, the JRE will not allow Java applications to run.   This is the desired behavior."
      solution    : "Navigate to the 'deployment.config' file for JRE.

Add the key 'deployment.system.config=<Path to deployment.properties>' to the 'deployment.config' file. The following is an example:
'deployment.system.config=file:///C:/Windows/Java/Deployment/deployment.properties'. Note the use of forward slashes.

Add the key 'deployment.system.config.mandatory=true' to the 'deployment.config' file."
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|JRE_8_and_Windows_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-234684r617446_rule,STIG-ID|JRE8-WN-000020,STIG-Legacy|SV-81431,STIG-Legacy|V-66941,SWIFT-CSCv1|2.3,Vuln-ID|V-234684"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_JRE_Windows_V2R1_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : "@PATH_TO_DEPLOYMENT_CONFIG@"
      regex       : "^deployment\.system\.config\.mandatory[\s]*="
      expect      : "^deployment\.system\.config\.mandatory[\s]*=[\s]*true"
    </custom_item>

    <custom_item>
      type        : FILE_CHECK
      description : "JRE8-WN-000030 - Oracle JRE 8 must have a deployment.properties file present."
      info        : "By default no deployment.properties file exists; thus, no system-wide deployment exists. The file must be created. The deployment.properties file is used for specifying keys for the Java Runtime Environment.  Each option in the Java control panel is represented by property keys. These keys adjust the options in the Java control panel based on the value assigned to that key.  Without the deployment.properties file, setting particular options for the Java control panel is impossible."
      solution    : "Create the JRE 'deployment.properties' file:

No default file exists. A text file named 'deployment.properties', and the directory structure in which it is located, must be manually created.
The location must be aligned as defined in the 'deployment.config' file.

C:\Windows\Java\Deployment\deployment.properties is an example."
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|JRE_8_and_Windows_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-234685r617446_rule,STIG-ID|JRE8-WN-000030,STIG-Legacy|SV-81433,STIG-Legacy|V-66943,SWIFT-CSCv1|2.3,Vuln-ID|V-234685"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_JRE_Windows_V2R1_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : "@PATH_TO_DEPLOYMENT_PROP@"
      file_option : MUST_EXIST
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "JRE8-WN-000060 - Oracle JRE 8 must default to the most secure built-in setting - deployment.security.level"
      info        : "Applications that are signed with a valid certificate and include the permissions attribute in the manifest for the main JAR file are allowed to run with security prompts. All other applications are blocked. Unsigned applications could perform numerous types of attacks on a system."
      solution    : "Navigate to the system-level 'deployment.properties' file for JRE.

Add the key 'deployment.security.level=VERY_HIGH' to the 'deployment.properties' file.

Add the key 'deployment.security.level.locked' to the 'deployment.properties' file."
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|JRE_8_and_Windows_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-234686r617446_rule,STIG-ID|JRE8-WN-000060,STIG-Legacy|SV-81435,STIG-Legacy|V-66945,SWIFT-CSCv1|2.3,Vuln-ID|V-234686"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_JRE_Windows_V2R1_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : "@PATH_TO_DEPLOYMENT_PROP@"
      regex       : "^deployment\.security\.level[\s]*="
      expect      : "^deployment\.security\.level[\s]*=[\s]*VERY_HIGH"
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "JRE8-WN-000060 - Oracle JRE 8 must default to the most secure built-in setting - deployment.security.level.locked"
      info        : "Applications that are signed with a valid certificate and include the permissions attribute in the manifest for the main JAR file are allowed to run with security prompts. All other applications are blocked. Unsigned applications could perform numerous types of attacks on a system."
      solution    : "Navigate to the system-level 'deployment.properties' file for JRE.

Add the key 'deployment.security.level=VERY_HIGH' to the 'deployment.properties' file.

Add the key 'deployment.security.level.locked' to the 'deployment.properties' file."
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|JRE_8_and_Windows_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-234686r617446_rule,STIG-ID|JRE8-WN-000060,STIG-Legacy|SV-81435,STIG-Legacy|V-66945,SWIFT-CSCv1|2.3,Vuln-ID|V-234686"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_JRE_Windows_V2R1_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : "@PATH_TO_DEPLOYMENT_PROP@"
      regex       : "^deployment\.security\.level\.locked"
      expect      : "^deployment\.security\.level\.locked"
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "JRE8-WN-000070 - Oracle JRE 8 must be set to allow Java Web Start (JWS) applications - deployment.webjava.enabled"
      info        : "Java Web Start (JWS) applications are the most commonly used.  Denying these applications could be detrimental to the user experience. Whitelisting, blacklisting, and signing of applications help mitigate the risk of running JWS applications."
      solution    : "Navigate to the system-level 'deployment.properties' file for JRE.

The location of the deployment.properties file is defined in <JRE Installation Directory>\Lib\deployment.config

Add the key 'deployment.webjava.enabled=true' to the deployment.properties file.

Add the key 'deployment.webjava.enabled.locked' to the deployment.properties file.

Note: If JWS is not enabled, this requirement is NA."
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|JRE_8_and_Windows_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-234687r617446_rule,STIG-ID|JRE8-WN-000070,STIG-Legacy|SV-81437,STIG-Legacy|V-66947,SWIFT-CSCv1|2.3,Vuln-ID|V-234687"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_JRE_Windows_V2R1_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : "@PATH_TO_DEPLOYMENT_PROP@"
      regex       : "^deployment\.webjava\.enabled[\s]*="
      expect      : "^deployment\.webjava\.enabled[\s]*=[\s]*true"
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "JRE8-WN-000070 - Oracle JRE 8 must be set to allow Java Web Start (JWS) applications - deployment.webjava.enabled.locked"
      info        : "Java Web Start (JWS) applications are the most commonly used.  Denying these applications could be detrimental to the user experience. Whitelisting, blacklisting, and signing of applications help mitigate the risk of running JWS applications."
      solution    : "Navigate to the system-level 'deployment.properties' file for JRE.

The location of the deployment.properties file is defined in <JRE Installation Directory>\Lib\deployment.config

Add the key 'deployment.webjava.enabled=true' to the deployment.properties file.

Add the key 'deployment.webjava.enabled.locked' to the deployment.properties file.

Note: If JWS is not enabled, this requirement is NA."
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,DISA_Benchmark|JRE_8_and_Windows_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-234687r617446_rule,STIG-ID|JRE8-WN-000070,STIG-Legacy|SV-81437,STIG-Legacy|V-66947,SWIFT-CSCv1|2.3,Vuln-ID|V-234687"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_JRE_Windows_V2R1_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : "@PATH_TO_DEPLOYMENT_PROP@"
      regex       : "^deployment\.webjava\.enabled\.locked"
      expect      : "^deployment\.webjava\.enabled\.locked"
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "JRE8-WN-000080 - Oracle JRE 8 must disable the dialog enabling users to grant permissions to execute signed content from an untrusted authority - deployment.security.askgrantdialog.notinca"
      info        : "Java applets exist both signed and unsigned.  Even for signed applets, there can be many sources, some of which may be purveyors of malware.  Applet sources considered trusted can have their information populated into the browser, enabling Java to validate applets against trusted sources.  Permitting execution of signed Java applets from untrusted sources may result in acquiring malware, and risks system modification, invasion of privacy, or denial of service."
      solution    : "If the system is on the SIPRNet, this requirement is NA.

Disable the 'Allow user to grant permissions to content from an untrusted authority' feature.

Navigate to the system-level 'deployment.properties' file for JRE.

Add the key 'deployment.security.askgrantdialog.notinca=false' to the 'deployment.properties' file.

Add the key 'deployment.security.askgrantdialog.notinca.locked' to the 'deployment.properties' file."
      reference   : "800-171|3.13.13,800-53|SC-18(3),800-53r5|SC-18(3),CAT|II,CCI|CCI-001695,CSF|DE.CM-5,DISA_Benchmark|JRE_8_and_Windows_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(3),NIAv2|NS26f,QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-234688r617446_rule,STIG-ID|JRE8-WN-000080,STIG-Legacy|SV-81439,STIG-Legacy|V-66949,Vuln-ID|V-234688"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_JRE_Windows_V2R1_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : "@PATH_TO_DEPLOYMENT_PROP@"
      regex       : "^deployment\.security\.askgrantdialog\.notinca[\s]*="
      expect      : "^deployment\.security\.askgrantdialog\.notinca[\s]*=[\s]*false"
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "JRE8-WN-000080 - Oracle JRE 8 must disable the dialog enabling users to grant permissions to execute signed content from an untrusted authority - deployment.security.askgrantdialog.notinca.locked"
      info        : "Java applets exist both signed and unsigned.  Even for signed applets, there can be many sources, some of which may be purveyors of malware.  Applet sources considered trusted can have their information populated into the browser, enabling Java to validate applets against trusted sources.  Permitting execution of signed Java applets from untrusted sources may result in acquiring malware, and risks system modification, invasion of privacy, or denial of service."
      solution    : "If the system is on the SIPRNet, this requirement is NA.

Disable the 'Allow user to grant permissions to content from an untrusted authority' feature.

Navigate to the system-level 'deployment.properties' file for JRE.

Add the key 'deployment.security.askgrantdialog.notinca=false' to the 'deployment.properties' file.

Add the key 'deployment.security.askgrantdialog.notinca.locked' to the 'deployment.properties' file."
      reference   : "800-171|3.13.13,800-53|SC-18(3),800-53r5|SC-18(3),CAT|II,CCI|CCI-001695,CSF|DE.CM-5,DISA_Benchmark|JRE_8_and_Windows_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(3),NIAv2|NS26f,QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-234688r617446_rule,STIG-ID|JRE8-WN-000080,STIG-Legacy|SV-81439,STIG-Legacy|V-66949,Vuln-ID|V-234688"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_JRE_Windows_V2R1_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : "@PATH_TO_DEPLOYMENT_PROP@"
      regex       : "^deployment\.security\.askgrantdialog\.notinca\.locked"
      expect      : "^deployment\.security\.askgrantdialog\.notinca\.locked"
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "JRE8-WN-000090 - Oracle JRE 8 must lock the dialog enabling users to grant permissions to execute signed content from an untrusted authority - deployment.security.askgrantdialog.show"
      info        : "Java applets exist both signed and unsigned. Even for signed applets, there can be many sources, some of which may be purveyors of malware. Applet sources considered trusted can have their information populated into the browser, enabling Java to validate applets against trusted sources. Permitting execution of signed Java applets from untrusted sources may result in acquiring malware, and risks system modification, invasion of privacy, or denial of service.

Ensuring users cannot change settings contributes to a more consistent security profile."
      solution    : "If the system is on the SIPRNet, this requirement is NA.

Lock the 'Allow user to grant permissions to content from an untrusted authority' feature.

Navigate to the system-level 'deployment.properties' file for JRE.

Add the key 'deployment.security.askgrantdialog.show=false' to the 'deployment.properties' file.

Add the key 'deployment.security.askgrantdialog.show.locked' to the 'deployment.properties' file."
      reference   : "800-171|3.13.13,800-53|SC-18(3),800-53r5|SC-18(3),CAT|II,CCI|CCI-001695,CSF|DE.CM-5,DISA_Benchmark|JRE_8_and_Windows_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(3),NIAv2|NS26f,QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-234689r617446_rule,STIG-ID|JRE8-WN-000090,STIG-Legacy|SV-81441,STIG-Legacy|V-66951,Vuln-ID|V-234689"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_JRE_Windows_V2R1_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : "@PATH_TO_DEPLOYMENT_PROP@"
      regex       : "^deployment\.security\.askgrantdialog\.show[\s]*="
      expect      : "^deployment\.security\.askgrantdialog\.show[\s]*=[\s]*false"
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "JRE8-WN-000090 - Oracle JRE 8 must lock the dialog enabling users to grant permissions to execute signed content from an untrusted authority - deployment.security.askgrantdialog.show.locked"
      info        : "Java applets exist both signed and unsigned. Even for signed applets, there can be many sources, some of which may be purveyors of malware. Applet sources considered trusted can have their information populated into the browser, enabling Java to validate applets against trusted sources. Permitting execution of signed Java applets from untrusted sources may result in acquiring malware, and risks system modification, invasion of privacy, or denial of service.

Ensuring users cannot change settings contributes to a more consistent security profile."
      solution    : "If the system is on the SIPRNet, this requirement is NA.

Lock the 'Allow user to grant permissions to content from an untrusted authority' feature.

Navigate to the system-level 'deployment.properties' file for JRE.

Add the key 'deployment.security.askgrantdialog.show=false' to the 'deployment.properties' file.

Add the key 'deployment.security.askgrantdialog.show.locked' to the 'deployment.properties' file."
      reference   : "800-171|3.13.13,800-53|SC-18(3),800-53r5|SC-18(3),CAT|II,CCI|CCI-001695,CSF|DE.CM-5,DISA_Benchmark|JRE_8_and_Windows_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(3),NIAv2|NS26f,QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-234689r617446_rule,STIG-ID|JRE8-WN-000090,STIG-Legacy|SV-81441,STIG-Legacy|V-66951,Vuln-ID|V-234689"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_JRE_Windows_V2R1_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : "@PATH_TO_DEPLOYMENT_PROP@"
      regex       : "^deployment\.security\.askgrantdialog\.show\.locked"
      expect      : "^deployment\.security\.askgrantdialog\.show\.locked"
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "JRE8-WN-000100 - Oracle JRE 8 must set the option to enable online certificate validation - deployment.security.validation.ocsp"
      info        : "Online certificate validation provides a real-time option to validate a certificate.  When enabled, if a certificate is presented, the status of the certificate is requested.  The status is sent back as 'current', 'expired', or 'unknown'.  Online certificate validation provides a greater degree of validation of certificates when running a signed Java applet.   Permitting execution of an applet with an invalid certificate may result in malware, system modification, invasion of privacy, and denial of service."
      solution    : "If the system is on the SIPRNet, this requirement is NA.

Navigate to the system-level 'deployment.properties' file for JRE.

Add the key 'deployment.security.validation.ocsp=true' to the 'deployment.properties' file.

Add the key 'deployment.security.validation.ocsp.locked' to the 'deployment.properties' file."
      reference   : "800-171|3.5.2,800-53|IA-5(2)(a),800-53r5|IA-5(2)(b)(1),CAT|II,CCI|CCI-000185,CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|JRE_8_and_Windows_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(2)(a),NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-234690r617446_rule,STIG-ID|JRE8-WN-000100,STIG-Legacy|SV-81443,STIG-Legacy|V-66953,Vuln-ID|V-234690"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_JRE_Windows_V2R1_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : "@PATH_TO_DEPLOYMENT_PROP@"
      regex       : "^deployment\.security\.validation\.ocsp[\s]*="
      expect      : "^deployment\.security\.validation\.ocsp[\s]*=[\s]*true"
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "JRE8-WN-000100 - Oracle JRE 8 must set the option to enable online certificate validation - deployment.security.validation.ocsp.locked"
      info        : "Online certificate validation provides a real-time option to validate a certificate.  When enabled, if a certificate is presented, the status of the certificate is requested.  The status is sent back as 'current', 'expired', or 'unknown'.  Online certificate validation provides a greater degree of validation of certificates when running a signed Java applet.   Permitting execution of an applet with an invalid certificate may result in malware, system modification, invasion of privacy, and denial of service."
      solution    : "If the system is on the SIPRNet, this requirement is NA.

Navigate to the system-level 'deployment.properties' file for JRE.

Add the key 'deployment.security.validation.ocsp=true' to the 'deployment.properties' file.

Add the key 'deployment.security.validation.ocsp.locked' to the 'deployment.properties' file."
      reference   : "800-171|3.5.2,800-53|IA-5(2)(a),800-53r5|IA-5(2)(b)(1),CAT|II,CCI|CCI-000185,CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|JRE_8_and_Windows_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(2)(a),NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-234690r617446_rule,STIG-ID|JRE8-WN-000100,STIG-Legacy|SV-81443,STIG-Legacy|V-66953,Vuln-ID|V-234690"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_JRE_Windows_V2R1_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : "@PATH_TO_DEPLOYMENT_PROP@"
      regex       : "^deployment\.security\.validation\.ocsp\.locked"
      expect      : "^deployment\.security\.validation\.ocsp\.locked"
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "JRE8-WN-000110 - Oracle JRE 8 must prevent the download of prohibited mobile code - deployment.security.blacklist.check"
      info        : "Decisions regarding the employment of mobile code within organizational information systems are based on the potential for the code to cause damage to the system if used maliciously.

Mobile code is defined as software modules obtained from remote systems, transferred across a network, and then downloaded and executed on a local system without explicit installation or execution by the recipient.

Usage restrictions and implementation guidance apply to both the selection and use of mobile code installed, downloaded, or executed on all endpoints (e.g., servers, workstations, and smart phones). This requirement applies to applications that execute, evaluate, or otherwise process mobile code (e.g., web applications, browsers, and anti-virus applications)."
      solution    : "Navigate to the system-level 'deployment.properties' file for JRE.

Add the key 'deployment.security.blacklist.check=true' to the 'deployment.properties' file.

Add the key 'deployment.security.blacklist.check.locked' to the 'deployment.properties' file."
      reference   : "800-171|3.13.13,800-53|SC-18(3),800-53r5|SC-18(3),CAT|II,CCI|CCI-001169,CSF|DE.CM-5,DISA_Benchmark|JRE_8_and_Windows_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(3),NIAv2|NS26f,QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-234691r617446_rule,STIG-ID|JRE8-WN-000110,STIG-Legacy|SV-81445,STIG-Legacy|V-66955,Vuln-ID|V-234691"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_JRE_Windows_V2R1_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : "@PATH_TO_DEPLOYMENT_PROP@"
      regex       : "^deployment\.security\.blacklist\.check[\s]*="
      expect      : "^deployment\.security\.blacklist\.check[\s]*=[\s]*true"
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "JRE8-WN-000110 - Oracle JRE 8 must prevent the download of prohibited mobile code - deployment.security.blacklist.check.locked"
      info        : "Decisions regarding the employment of mobile code within organizational information systems are based on the potential for the code to cause damage to the system if used maliciously.

Mobile code is defined as software modules obtained from remote systems, transferred across a network, and then downloaded and executed on a local system without explicit installation or execution by the recipient.

Usage restrictions and implementation guidance apply to both the selection and use of mobile code installed, downloaded, or executed on all endpoints (e.g., servers, workstations, and smart phones). This requirement applies to applications that execute, evaluate, or otherwise process mobile code (e.g., web applications, browsers, and anti-virus applications)."
      solution    : "Navigate to the system-level 'deployment.properties' file for JRE.

Add the key 'deployment.security.blacklist.check=true' to the 'deployment.properties' file.

Add the key 'deployment.security.blacklist.check.locked' to the 'deployment.properties' file."
      reference   : "800-171|3.13.13,800-53|SC-18(3),800-53r5|SC-18(3),CAT|II,CCI|CCI-001169,CSF|DE.CM-5,DISA_Benchmark|JRE_8_and_Windows_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(3),NIAv2|NS26f,QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-234691r617446_rule,STIG-ID|JRE8-WN-000110,STIG-Legacy|SV-81445,STIG-Legacy|V-66955,Vuln-ID|V-234691"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_JRE_Windows_V2R1_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : "@PATH_TO_DEPLOYMENT_PROP@"
      regex       : "^deployment\.security\.blacklist\.check\.locked"
      expect      : "^deployment\.security\.blacklist\.check\.locked"
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "JRE8-WN-000120 - Oracle JRE 8 must enable the option to use an accepted sites list."
      info        : "Utilizing a whitelist provides a configuration management method for allowing the execution of only authorized software. Using only authorized software decreases risk by limiting the number of potential vulnerabilities.

The organization must identify authorized software programs and permit execution of authorized software. The process used to identify software programs that are authorized to execute on organizational information systems is commonly referred to as whitelisting.

Verification of whitelisted software can occur either prior to execution or at system startup.

This requirement applies to configuration management applications or similar types of applications designed to manage system processes and configurations (e.g., HBSS and software wrappers)."
      solution    : "Navigate to the system-level 'deployment.properties' file for JRE.

Add the key 'deployment.user.security.exception.sites=C\:\\Windows\\Sun\\Java\\Deployment\\exception.sites' to the 'deployment.properties' file."
      reference   : "800-171|3.4.8,800-53|CM-7(5)(b),800-53r5|CM-7(5)(b),CAT|II,CCI|CCI-001774,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|PR.PS-01,DISA_Benchmark|JRE_8_and_Windows_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|CM-7,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,Rule-ID|SV-234692r617446_rule,STIG-ID|JRE8-WN-000120,STIG-Legacy|SV-81447,STIG-Legacy|V-66957,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3,Vuln-ID|V-234692"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_JRE_Windows_V2R1_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : "@PATH_TO_DEPLOYMENT_PROP@"
      regex       : "^deployment\.user\.security\.exception\.sites[\s]*="
      expect      : "^deployment\.user\.security\.exception\.sites[\s]*=[\s]*@PATH_TO_EXC_SITESBS@"
    </custom_item>

    <custom_item>
      type        : FILE_CHECK
      description : "JRE8-WN-000130 - Oracle JRE 8 must have an exception.sites file present."
      info        : "Utilizing a whitelist provides a configuration management method for allowing the execution of only authorized software. Using only authorized software decreases risk by limiting the number of potential vulnerabilities.

The organization must identify authorized software programs and permit execution of authorized software. The process used to identify software programs that are authorized to execute on organizational information systems is commonly referred to as whitelisting.

Verification of whitelisted software can occur either prior to execution or at system startup.

This requirement applies to configuration management applications or similar types of applications designed to manage system processes and configurations (e.g., HBSS and software wrappers)."
      solution    : "If the system is on the SIPRNet, this requirement is NA.

Create the JRE exception.sites file:
No default file exists. A text file named exception.sites, and the directory structure in which it is located must be manually created. The location must be aligned as defined in the deployment.properties file.
C:\Windows\Java\Deployment\deployment.properties is an example."
      reference   : "800-171|3.4.8,800-53|CM-7(5)(b),800-53r5|CM-7(5)(b),CAT|II,CCI|CCI-001774,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|PR.PS-01,DISA_Benchmark|JRE_8_and_Windows_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|CM-7,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,Rule-ID|SV-234693r617446_rule,STIG-ID|JRE8-WN-000130,STIG-Legacy|SV-81449,STIG-Legacy|V-66959,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3,Vuln-ID|V-234693"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_JRE_Windows_V2R1_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : "@PATH_TO_EXC_SITES@"
      file_option : MUST_EXIST
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "JRE8-WN-000150 - Oracle JRE 8 must enable the dialog to enable users to check publisher certificates for revocation - deployment.security.validation.crl"
      info        : "A certificate revocation list is a directory which contains a list of certificates that have been revoked for various reasons. Certificates may be revoked due to improper issuance, compromise of the certificate, and failure to adhere to policy. Therefore, any certificate found on a CRL should not be trusted. Permitting execution of an applet published with a revoked certificate may result in spoofing, malware, system modification, invasion of privacy, and denial of service."
      solution    : "If the system is on the SIPRNet, this requirement is NA.

Enable the 'Check certificates for revocation using If the system is on the SIPRNet, this requirement is NA.

Enable the 'Check certificates for revocation using Certificate Revocation Lists (CRL)' option.

Navigate to the system-level 'deployment.properties' file for JRE.

Add the key 'deployment.security.validation.crl=true' to the 'deployment.properties' file.

Add the key 'deployment.security.validation.crl.locked' to the 'deployment.properties' file."
      reference   : "800-171|3.5.2,800-53|IA-5(2)(d),800-53r5|IA-5(2)(b)(2),CAT|II,CCI|CCI-001991,CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|JRE_8_and_Windows_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(2),NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-234694r617446_rule,STIG-ID|JRE8-WN-000150,STIG-Legacy|SV-81451,STIG-Legacy|V-66961,Vuln-ID|V-234694"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_JRE_Windows_V2R1_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : "@PATH_TO_DEPLOYMENT_PROP@"
      regex       : "^deployment\.security\.validation\.crl[\s]*="
      expect      : "^deployment\.security\.validation\.crl[\s]*=[\s]*true"
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "JRE8-WN-000150 - Oracle JRE 8 must enable the dialog to enable users to check publisher certificates for revocation - deployment.security.validation.crl.locked"
      info        : "A certificate revocation list is a directory which contains a list of certificates that have been revoked for various reasons. Certificates may be revoked due to improper issuance, compromise of the certificate, and failure to adhere to policy. Therefore, any certificate found on a CRL should not be trusted. Permitting execution of an applet published with a revoked certificate may result in spoofing, malware, system modification, invasion of privacy, and denial of service."
      solution    : "If the system is on the SIPRNet, this requirement is NA.

Enable the 'Check certificates for revocation using If the system is on the SIPRNet, this requirement is NA.

Enable the 'Check certificates for revocation using Certificate Revocation Lists (CRL)' option.

Navigate to the system-level 'deployment.properties' file for JRE.

Add the key 'deployment.security.validation.crl=true' to the 'deployment.properties' file.

Add the key 'deployment.security.validation.crl.locked' to the 'deployment.properties' file."
      reference   : "800-171|3.5.2,800-53|IA-5(2)(d),800-53r5|IA-5(2)(b)(2),CAT|II,CCI|CCI-001991,CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|JRE_8_and_Windows_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(2),NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-234694r617446_rule,STIG-ID|JRE8-WN-000150,STIG-Legacy|SV-81451,STIG-Legacy|V-66961,Vuln-ID|V-234694"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_JRE_Windows_V2R1_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : "@PATH_TO_DEPLOYMENT_PROP@"
      regex       : "^deployment\.security\.validation\.crl\.locked"
      expect      : "^deployment\.security\.validation\.crl\.locked"
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "JRE8-WN-000170 - Oracle JRE 8 must prompt the user for action prior to executing mobile code - deployment.insecure.jres"
      info        : "Mobile code can cause damage to the system. It can execute without explicit action from, or notification to, a user.

Actions enforced before executing mobile code include, for example, prompting users prior to opening email attachments and disabling automatic execution.

This requirement applies to mobile code-enabled software, which is capable of executing one or more types of mobile code."
      solution    : "Navigate to the system-level 'deployment.properties' file for JRE.

Add the key 'deployment.insecure.jres=PROMPT' to the 'deployment.properties' file.

Add the key 'deployment.insecure.jres.locked' to the 'deployment.properties' file."
      reference   : "800-171|3.13.13,800-53|SC-18(4),800-53r5|SC-18(4),CAT|II,CCI|CCI-002460,CSF|DE.CM-5,DISA_Benchmark|JRE_8_and_Windows_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(4),NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-234696r617446_rule,STIG-ID|JRE8-WN-000170,STIG-Legacy|SV-81453,STIG-Legacy|V-66963,Vuln-ID|V-234696"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_JRE_Windows_V2R1_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : "@PATH_TO_DEPLOYMENT_PROP@"
      regex       : "^deployment\.insecure\.jres[\s]*="
      expect      : "^deployment\.insecure\.jres[\s]*=[\s]*PROMPT"
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "JRE8-WN-000170 - Oracle JRE 8 must prompt the user for action prior to executing mobile code - deployment.insecure.jres.locked"
      info        : "Mobile code can cause damage to the system. It can execute without explicit action from, or notification to, a user.

Actions enforced before executing mobile code include, for example, prompting users prior to opening email attachments and disabling automatic execution.

This requirement applies to mobile code-enabled software, which is capable of executing one or more types of mobile code."
      solution    : "Navigate to the system-level 'deployment.properties' file for JRE.

Add the key 'deployment.insecure.jres=PROMPT' to the 'deployment.properties' file.

Add the key 'deployment.insecure.jres.locked' to the 'deployment.properties' file."
      reference   : "800-171|3.13.13,800-53|SC-18(4),800-53r5|SC-18(4),CAT|II,CCI|CCI-002460,CSF|DE.CM-5,DISA_Benchmark|JRE_8_and_Windows_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(4),NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-234696r617446_rule,STIG-ID|JRE8-WN-000170,STIG-Legacy|SV-81453,STIG-Legacy|V-66963,Vuln-ID|V-234696"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_JRE_Windows_V2R1_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : "@PATH_TO_DEPLOYMENT_PROP@"
      regex       : "^deployment\.insecure\.jres\.locked"
      expect      : "^deployment\.insecure\.jres\.locked"
    </custom_item>

    <report type:"WARNING">
      description : "JRE8-WN-000190 - Oracle JRE 8 must remove previous versions when the latest version is installed."
      info        : "Previous versions of software components that are not removed from the information system after updates have been installed may be exploited by adversaries. Some information technology products may remove older versions of software automatically from the information system.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Remove previous versions of JRE.

Open the Windows Control Panel, and navigate to 'Programs and Features'.

Highlight, and click uninstall on all out of date instances of JRE."
      reference   : "800-171|3.14.1,800-53|SI-2(6),800-53r5|SI-2(6),CAT|II,CCI|CCI-002617,CN-L3|8.1.4.4(e),CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSF|ID.RA-1,CSF|PR.IP-12,CSF2.0|ID.IM-01,CSF2.0|ID.IM-02,CSF2.0|ID.IM-03,CSF2.0|PR.PS-02,DISA_Benchmark|JRE_8_and_Windows_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-2,NESA|T7.6.2,NESA|T7.7.1,NIAv2|PR9,PCI-DSSv3.2.1|6.2,PCI-DSSv4.0|6.3,PCI-DSSv4.0|6.3.3,QCSC-v1|11.2,Rule-ID|SV-234698r617446_rule,STIG-ID|JRE8-WN-000190,STIG-Legacy|SV-81455,STIG-Legacy|V-66965,SWIFT-CSCv1|2.2,Vuln-ID|V-234698"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_JRE_Windows_V2R1_STIG.zip"
    </report>

    <report type:"WARNING">
      description : "JRE8-WN-000180 - The version of Oracle JRE 8 running on the system must be the most current available."
      info        : "Oracle JRE 8 is being continually updated by the vendor in order to address identified security vulnerabilities.  Running an older version of the JRE can introduce security vulnerabilities to the system.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Test applications to ensure operational compatibility with new version of Java.

Install a supported version of Oracle JRE 8."
      reference   : "800-171|3.14.1,800-53|SI-2c.,800-53r5|SI-2c.,CAT|I,CCI|CCI-002605,CN-L3|8.1.4.4(e),CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSF|ID.RA-1,CSF|PR.IP-12,CSF2.0|ID.IM-01,CSF2.0|ID.IM-02,CSF2.0|ID.IM-03,CSF2.0|PR.PS-02,DISA_Benchmark|JRE_8_and_Windows_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-2,NESA|T7.6.2,NESA|T7.7.1,NIAv2|AM38,NIAv2|AM39,NIAv2|SS14b,PCI-DSSv3.2.1|6.2,PCI-DSSv4.0|6.3,PCI-DSSv4.0|6.3.3,QCSC-v1|11.2,Rule-ID|SV-234697r617446_rule,STIG-ID|JRE8-WN-000180,STIG-Legacy|SV-81457,STIG-Legacy|V-66967,SWIFT-CSCv1|2.2,Vuln-ID|V-234697"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_JRE_Windows_V2R1_STIG.zip"
    </report>
  </then>

  <else>
    <report type:"WARNING">
      description : "DISA_STIG_JRE_8_Windows_v2r1.audit for DISA Oracle Java Runtime Environment (JRE) Version 8 for Windows v2r1 STIG"
      info        : "NOTE: Nessus has not identified that the chosen audit applies to the target device."
    </report>
  </else>
</if>

</group_policy>
</check_type>
