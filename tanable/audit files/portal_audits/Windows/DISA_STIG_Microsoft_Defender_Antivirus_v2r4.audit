#TRUSTED 6af257d06c956b14d83932d14329a4b096c101fd3014f2bce024985ee0ef000c7206bab0502b8dcc7d0764d33c45ae5fc2ad27be54d233e7b27c0be1bbc5b15b2b856f61b97747ecc08e3080fa022dc065917a917c3d65a7e03922acdb27fc77ad50292175c4a2180b841ac20f7694b6b36befa8a52b31b81b35cca933f7c3512ab247414ec57713466344b47c4feb5aaba3da2b46157f8648b89d0471c037c8742cc4c3b70b096b2f6dac7c4e57e5d4eb6246c88732d1157d7b671d425ec9127be905f948c205af9f6fc289c158b4c02567b47711a66b2b6575f56f58b9d079b6a95c9cf88621b36200a6e8ac93fb2b768dbb64294508e6d921259ac1701f82f28397d83aca814d788e4475c654570131c2920660036709a1fe39187946af0b3c7df100d6c3e8b06333cb82883ae149118be6a72547032ef8c9221d37f86fd05a9aeb3ddbade242085c407c2cc5ab19d794fac965689631e3e73e63e23bfd7874637d047583063f71973913f5b8811268ded4f76f65d9d340aa5e9a4176577f150260302b488696253ad04303f0c68a105be6af9ec42767cc7d380fafeebb01ae217cee425c4ad527764d20f4a27eee2a4abe44db33bd86a373029785defa71e7b1909b5eac035e11639eb858c354c0ad1f6baeae3c0e0dbe02a29c34b8934f550700b6eebb6e02f854a804557aa9dd9b1c4bec75a3d2846a871d5904266860
#TRUST-RSA-SHA256 523d07a95a069e3b197746309b3348e0a30b81960f290369375b0f5874b295d5b9d9ebb9444b0f7a4952b87d917fb9a4fdec5ed1cfee418908652244dc8b00a2f2af39e71dba54d1be8ecbcb74bc092967f2935a43541f995090297bca22b7c657e08e92d3032021a7df7950eeed449a28683243027a261a258e3c5f90291c960b1f733492ff33f133bb128c05b92ecdfa18130647751b008b1c08ecb3d34ea93dda73dd0f19fac55ddd2ecc365896e15436fef56044687940563b5b46c4498c3033f3b5a1c24b39791e651e716994bee9d230c97f5a3863cfd29659e8e0781e75fcacb7b4d07cc0492e8e865d1d64a5111c35f923c2b40ebce96468c8ed866e4c7e0a861d090c5f6373953ce969399d6a46f3352fb6944094e56d2b30f5a4e9698b2ef2f5ba661df09f7e31df49d8f519a1cb0c6eaf4e04013b1d6680dabf05ca0e2c84f51b9231138938bef060094b8350da49ac58802f0031eca3484d7ebd553654242de3fe6c376a19334fb90194929a1b85ef06660ae2ed7b02b3edb2c8ec0f69859f15e1ac6f1c0009bf37aa8e779e6cfff3a3e86106a3087d6825bf88fa2d4f3bd1f0bc33daa7cc1ee37d40ae673e5cdc591dddd5410589b3ef9f2c44f48e75222cac5caae1b2bf1dd4d48f756b90833250021d583f78e1186cd5bd4503e2863ed3ac12df0b294e77b2706bacdbbef27265365e587b623306e9ee8c65
#
# This script is Copyright (C) 2004-2025 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
# $Revision: 1.3 $
# $Date: 2025/01/06 $
#
# Description : This document implements the security configuration as recommended by the
#               DISA Microsoft Defender Antivirus v2r4 STIG.
#
#<ui_metadata>
#<display_name>DISA STIG Microsoft Defender Antivirus v2r4</display_name>
#<spec>
#  <type>DISA STIG</type>
#  <name>Microsoft Defender Antivirus</name>
#  <version>2.4.0</version>
#  <link>https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip</link>
#</spec>
#<labels>disa,windows_defender,agent</labels>
#<benchmark_refs>CAT,CCE,CCI,DISA_Benchmark,Group-ID,Rule-ID,STIG-ID,STIG-Legacy,Vuln-ID</benchmark_refs>
#</ui_metadata>

<check_type:"Windows" version:"2">
<group_policy:"Windows Defender Antivirus">

<if>
  <condition type:"OR">
    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "Check if Windows Defender is installed - Windows Desktop"
      value_type      : POLICY_TEXT
      value_data      : "Windows Defender"
      powershell_args : "Get-Wmiobject -Namespace root/SecurityCenter2 -Class AntiVirusProduct | SELECT displayName"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "Check if Windows Defender is installed - Windows Server"
      value_type      : POLICY_TEXT
      value_data      : "Windows-Defender"
      powershell_args : "Get-WindowsFeature | Where {$_.Name -eq 'Windows-Defender' -And $_.InstallState -eq 'Installed'} | SELECT Name"
      check_type      : CHECK_REGEX
    </custom_item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "DISA_STIG_Microsoft_Defender_Antivirus_v2r4.audit from DISA Microsoft Defender Antivirus v2r4 STIG"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
    </report>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WNDF-AV-000001 - Microsoft Defender AV must be configured to block the Potentially Unwanted Application (PUA) feature - PUA feature."
      info        : "After enabling this feature, PUA protection blocking takes effect on endpoint clients after the next signature update or computer restart. Signature updates take place daily under typical circumstances. PUA will be blocked and automatically quarantined."
      solution    : "Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Defender Antivirus >> 'Configure Detection for Potentially Unwanted Applications' to 'Enabled' and 'Block'."
      reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3c.2.,800-53r5|SI-3c.2.,CAT|I,CCI|CCI-001243,CN-L3|7.1.3.6(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CSF|DE.CM-4,CSF|DE.DP-3,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3c.b.,NESA|T3.4.1,NIAv2|NS24,PCI-DSSv3.2.1|5.1,PCI-DSSv3.2.1|5.1.1,PCI-DSSv4.0|5.3.2,PCI-DSSv4.0|5.3.3,QCSC-v1|3.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,Rule-ID|SV-213426r823024_rule,STIG-ID|WNDF-AV-000001,STIG-Legacy|SV-89827,STIG-Legacy|V-75147,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-213426"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender"
      reg_item    : "PUAProtection"
      reg_option  : CAN_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WNDF-AV-000003 - Microsoft Defender AV must be configured to automatically take action on all detected tasks."
      info        : "This policy setting allows Microsoft Defender configuration to automatically take action on all detected threats. The action to be taken on a particular threat is determined by the combination of the policy-defined action user-defined action and the signature-defined action. If this policy setting is enabled, Microsoft Defender does not automatically take action on the detected threats but prompts users to choose from the actions available for each threat. If this policy setting is disabled or not configured, Microsoft Defender automatically takes action on all detected threats after a nonconfigurable delay of approximately five seconds."
      solution    : "Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Defender Antivirus >> 'Turn off routine remediation' to 'Disabled' or 'Not Configured'."
      reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3c.2.,800-53r5|SI-3c.2.,CAT|II,CCI|CCI-001243,CN-L3|7.1.3.6(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CSF|DE.CM-4,CSF|DE.DP-3,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3c.b.,NESA|T3.4.1,NIAv2|NS24,PCI-DSSv3.2.1|5.1,PCI-DSSv3.2.1|5.1.1,PCI-DSSv4.0|5.3.2,PCI-DSSv4.0|5.3.3,QCSC-v1|3.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,Rule-ID|SV-213427r823026_rule,STIG-ID|WNDF-AV-000003,STIG-Legacy|SV-89831,STIG-Legacy|V-75151,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-213427"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender"
      reg_item    : "DisableRoutinelyTakingAction"
      reg_option  : CAN_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WNDF-AV-000004 - Microsoft Defender AV must be configured to run and scan for malware and other potentially unwanted software."
      info        : "This policy setting turns off Microsoft Defender Antivirus. If this policy setting is enabled, Microsoft Defender Antivirus does not run and computers are not scanned for malware or other potentially unwanted software.

When the setting is disabled and a third-party antivirus solution is installed, the two applications can both simultaneously try to protect the system. The two AV solutions both attempt to quarantine the same threat and will fight for access to delete the file. Users will see conflicts and the system may lock up until the two solutions finish processing.

When the setting is not configured and a third-party antivirus solution is installed, both applications coexist on the system without conflicts.  Defender Antivirus will automatically disable itself and will enable if the third-party solution stops functioning.  When the setting is not configured and Defender Antivirus is the only AV solution, Defender AV will run (default state) and receive definition updates. An administrator account is needed to turn off the service. A standard user cannot disable the service."
      solution    : "For Windows 10: Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Defender Antivirus 'Turn off Microsoft Defender Antivirus' to 'Not Configured'."
      reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3c.1.,800-53r5|SI-3c.1.,CAT|I,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CSF|DE.CM-4,CSF|DE.DP-3,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3c.a.,NESA|T3.4.1,NIAv2|NS24,PCI-DSSv3.2.1|5.1,PCI-DSSv3.2.1|5.1.1,PCI-DSSv4.0|5.3.2,PCI-DSSv4.0|5.3.3,QCSC-v1|3.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,Rule-ID|SV-213428r823028_rule,STIG-ID|WNDF-AV-000004,STIG-Legacy|SV-89833,STIG-Legacy|V-75153,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-213428"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender"
      reg_item    : "DisableAntiSpyware"
      reg_option  : CAN_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WNDF-AV-000005 - Microsoft Defender AV must be configured to not exclude files for scanning."
      info        : "This policy setting allows disabling of scheduled and real-time scanning for files under the paths specified or for the fully qualified resources specified. Paths should be added under the Options for this setting. Each entry must be listed as a name value pair where the name should be a string representation of a path or a fully qualified resource name. As an example, a path might be defined as: 'c:\Windows' to exclude all files in this directory. A fully qualified resource name might be defined as: 'C:\Windows\App.exe'. The value is not used and it is recommended that this be set to 0.

Exceptions can be made to allow file/folders that are impacting enterprise applications to be excluded from being scanned. All exclusions should be documented and approved."
      solution    : "Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Defender Antivirus >> Exclusions >> 'Path Exclusions' to 'Disabled' or 'Not Configured'."
      reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3c.1.,800-53r5|SI-3c.1.,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CSF|DE.CM-4,CSF|DE.DP-3,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3c.a.,NESA|T3.4.1,NIAv2|NS24,PCI-DSSv3.2.1|5.1,PCI-DSSv3.2.1|5.1.1,PCI-DSSv4.0|5.3.2,PCI-DSSv4.0|5.3.3,QCSC-v1|3.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,Rule-ID|SV-213429r823030_rule,STIG-ID|WNDF-AV-000005,STIG-Legacy|SV-89835,STIG-Legacy|V-75155,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-213429"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender\Exclusions"
      reg_item    : "Exclusions_Paths"
      reg_option  : CAN_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WNDF-AV-000006 - Microsoft Defender AV must be configured to not exclude files opened by specified processes."
      info        : "This policy setting allows the disabling of scheduled and real-time scanning for any file opened by any of the specified processes. The process itself will not be excluded. To exclude the process, use the Path exclusion. Processes should be added under the options for this setting. Each entry must be listed as a name value pair where the name should be a string representation of the path to the process image. Note that only executables can be excluded. For example, a process might be defined as: 'c:\windows\app.exe'. The value is not used and it is recommended that this be set to 0."
      solution    : "Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft  Defender Antivirus >> Exclusions >> 'Process Exclusions' to 'Disabled' or 'Not Configured'."
      reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3c.1.,800-53r5|SI-3c.1.,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CSF|DE.CM-4,CSF|DE.DP-3,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3c.a.,NESA|T3.4.1,NIAv2|NS24,PCI-DSSv3.2.1|5.1,PCI-DSSv3.2.1|5.1.1,PCI-DSSv4.0|5.3.2,PCI-DSSv4.0|5.3.3,QCSC-v1|3.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,Rule-ID|SV-213430r823032_rule,STIG-ID|WNDF-AV-000006,STIG-Legacy|SV-89837,STIG-Legacy|V-75157,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-213430"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender\Exclusions"
      reg_item    : "Exclusions_Processes"
      reg_option  : CAN_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WNDF-AV-000007 - Microsoft Defender AV must be configured to enable the Automatic Exclusions feature."
      info        : "This setting allows an administrator to specify if Automatic Exclusions feature for Server SKUs should be turned off."
      solution    : "Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Defender Antivirus >> Exclusions >> 'Turn off Auto Exclusions' to 'Disabled'."
      reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3c.1.,800-53r5|SI-3c.1.,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CSF|DE.CM-4,CSF|DE.DP-3,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3c.a.,NESA|T3.4.1,NIAv2|NS24,PCI-DSSv3.2.1|5.1,PCI-DSSv3.2.1|5.1.1,PCI-DSSv4.0|5.3.2,PCI-DSSv4.0|5.3.3,QCSC-v1|3.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,Rule-ID|SV-213431r823034_rule,STIG-ID|WNDF-AV-000007,STIG-Legacy|SV-89839,STIG-Legacy|V-75159,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-213431"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender\Exclusions"
      reg_item    : "DisableAutoExclusions"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WNDF-AV-000008 - Microsoft Defender AV must be configured to disable local setting override for reporting to Microsoft MAPS."
      info        : "This policy setting configures a local override for the configuration to join Microsoft MAPS. This setting can only be set by Group Policy. If this setting is enabled, the local preference setting will take priority over Group Policy. If this setting is disabled or not configured, Group Policy will take priority over the local preference setting."
      solution    : "This is applicable to unclassified systems. For other systems this is NA.

Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Defender Antivirus >> MAPS >> 'Configure local setting override for reporting to Microsoft MAPS' to 'Disabled' or 'Not Configured'."
      reference   : "800-171|3.13.13,800-53|SC-18(4),800-53r5|SC-18(4),CAT|II,CCI|CCI-001170,CSF|DE.CM-5,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(4),NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-213432r823036_rule,STIG-ID|WNDF-AV-000008,STIG-Legacy|SV-89841,STIG-Legacy|V-75161,Vuln-ID|V-213432"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender\Spynet"
      reg_item    : "LocalSettingOverrideSpynetReporting"
      reg_option  : CAN_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WNDF-AV-000009 - Microsoft Defender AV must be configured to check in real time with MAPS before content is run or accessed."
      info        : "This feature ensures the device checks in real time with the Microsoft Active Protection Service (MAPS) before allowing certain content to be run or accessed. If this feature is disabled, the check will not occur, which will lower the protection state of the device.

Enabled - The Block at First Sight setting is turned on.
Disabled - The Block at First Sight setting is turned off.

This feature requires these Group Policy settings to be set as follows:
MAPS >> The 'Join Microsoft MAPS' must be enabled or the 'Block at First Sight' feature will not function.
MAPS >> The 'Send file samples when further analysis is required' should be set to 1 (Send safe samples) or 3 (Send all samples). Setting to 0 (Always Prompt) will lower the protection state of the device. Setting to 2 (Never send) means the 'Block at First Sight' feature will not function.
Real-time Protection >> The 'Scan all downloaded files and attachments' policy must be enabled or the 'Block at First Sight' feature will not function.
Real-time Protection >> Do not enable the 'Turn off real-time protection' policy or the 'Block at First Sight' feature will not function."
      solution    : "This is applicable to unclassified systems. For other systems this is NA.

Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft  Defender Antivirus >> MAPS >> 'Configure the 'Block at First Sight' feature' to 'Enabled'."
      reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3c.1.,800-53r5|SI-3c.1.,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CSF|DE.CM-4,CSF|DE.DP-3,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3c.a.,NESA|T3.4.1,NIAv2|NS24,PCI-DSSv3.2.1|5.1,PCI-DSSv3.2.1|5.1.1,PCI-DSSv4.0|5.3.2,PCI-DSSv4.0|5.3.3,QCSC-v1|3.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,Rule-ID|SV-213433r823038_rule,STIG-ID|WNDF-AV-000009,STIG-Legacy|SV-89843,STIG-Legacy|V-75163,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-213433"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender\Spynet"
      reg_item    : "DisableBlockAtFirstSeen"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WNDF-AV-000010 - Microsoft Defender AV must be configured to join Microsoft MAPS."
      info        : "This policy setting allows joining Microsoft MAPS. Microsoft MAPS is the online community that helps in choosing how to respond to potential threats. The community also helps stop the spread of new malicious software infections. You can choose to send basic or additional information about detected software. Additional information helps Microsoft create new definitions and protect your computer. This information can include things like location of detected items on your computer if harmful software was removed. The information will be automatically collected and sent. In some instances personal information might unintentionally be sent to Microsoft. However Microsoft will not use this information to identify you or contact you.

Possible options are:
(0x0) Disabled (default)
(0x1) Basic membership
(0x2) Advanced membership

Basic membership will send basic information to Microsoft about software that has been detected, including where the software came from, the actions that you apply or that are applied automatically, and whether the actions were successful. Advanced membership will send, in addition to basic information, more information to Microsoft about malicious software spyware and potentially unwanted software, including the location of the software file names, how the software operates, and how it has impacted your computer.

If this setting is enabled, you will join Microsoft MAPS with the membership specified. If this setting is disabled or do not configured, you will not join Microsoft MAPS. In Windows 10, Basic membership is no longer available, so setting the value to 1 or 2 enrolls the device into Advanced membership."
      solution    : "This is applicable to unclassified systems. For other systems this is NA.

Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Defender Antivirus >> MAPS >> 'Join Microsoft MAPS' to 'Enabled' and select 'Advanced MAPS' from the drop-down box."
      reference   : "800-171|3.13.13,800-53|SC-18(4),800-53r5|SC-18(4),CAT|II,CCI|CCI-001170,CSF|DE.CM-5,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(4),NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-213434r823040_rule,STIG-ID|WNDF-AV-000010,STIG-Legacy|SV-89847,STIG-Legacy|V-75167,Vuln-ID|V-213434"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 2
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender\Spynet"
      reg_item    : "SpynetReporting"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WNDF-AV-000011 - Microsoft Defender AV must be configured to only send safe samples for MAPS telemetry."
      info        : "This policy setting configures behavior of samples submission when opt-in for MAPS telemetry is set. Possible options are:
(0x0) Always prompt
(0x1) Send safe samples automatically
(0x2) Never send
(0x3) Send all samples automatically"
      solution    : "This is applicable to unclassified systems. For other systems this is NA.

Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Defender Antivirus >> MAPS >> 'Send file samples when further analysis is required' to 'Enabled' and select 'Send safe samples' from the drop-down box."
      reference   : "800-171|3.13.13,800-53|SC-18(4),800-53r5|SC-18(4),CAT|II,CCI|CCI-001170,CSF|DE.CM-5,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(4),NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-213435r823042_rule,STIG-ID|WNDF-AV-000011,STIG-Legacy|SV-89887,STIG-Legacy|V-75207,Vuln-ID|V-213435"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender\Spynet"
      reg_item    : "SubmitSamplesConsent"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WNDF-AV-000012 - Microsoft Defender AV must be configured for protocol recognition for network protection."
      info        : "This policy setting allows the configuration of protocol recognition for network protection against exploits of known vulnerabilities. If this setting is enabled or not configured, protocol recognition will be enabled. If this setting is disabled, protocol recognition will be disabled."
      solution    : "Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Defender Antivirus >> Network Inspection System >> 'Turn on protocol recognition' to 'Enabled' or 'Not Configured'."
      reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3c.1.,800-53r5|SI-3c.1.,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CSF|DE.CM-4,CSF|DE.DP-3,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3c.a.,NESA|T3.4.1,NIAv2|NS24,PCI-DSSv3.2.1|5.1,PCI-DSSv3.2.1|5.1.1,PCI-DSSv4.0|5.3.2,PCI-DSSv4.0|5.3.3,QCSC-v1|3.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,Rule-ID|SV-213436r823044_rule,STIG-ID|WNDF-AV-000012,STIG-Legacy|SV-89889,STIG-Legacy|V-75209,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-213436"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender\NIS"
      reg_item    : "DisableProtocolRecognition"
      reg_option  : CAN_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WNDF-AV-000013 - Microsoft Defender AV must be configured to not allow local override of monitoring for file and program activity."
      info        : "This policy setting configures a local override for the configuration of monitoring for file and program activity on your computer. This setting can only be set by Group Policy. If this setting is enabled, the local preference setting will take priority over Group Policy. If this setting is disabled or not configured, Group Policy will take priority over the local preference setting."
      solution    : "Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Defender Antivirus >> Real-time Protection >> 'Configure local setting override for monitoring file and program activity on your computer' to 'Disabled' or 'Not Configured'."
      reference   : "800-171|3.13.13,800-53|SC-18(3),800-53r5|SC-18(3),CAT|II,CCI|CCI-001695,CSF|DE.CM-5,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(3),NIAv2|NS26f,QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-213437r823046_rule,STIG-ID|WNDF-AV-000013,STIG-Legacy|SV-89891,STIG-Legacy|V-75211,Vuln-ID|V-213437"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender\Real-Time Protection"
      reg_item    : "LocalSettingOverrideDisableOnAccessProtection"
      reg_option  : CAN_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WNDF-AV-000014 - Microsoft Defender AV must be configured to not allow override of monitoring for incoming and outgoing file activity."
      info        : "This policy setting configures a local override for the configuration of monitoring for incoming and outgoing file activity. This setting can only be set by Group Policy. If this setting is enabled, the local preference setting will take priority over Group Policy. If this setting is disabled or not configured, Group Policy will take priority over the local preference setting."
      solution    : "Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Defender Antivirus >> Real-time Protection >> 'Configure local setting override for monitoring for incoming and outgoing file activity' to 'Disabled' or 'Not Configured'."
      reference   : "800-171|3.13.13,800-53|SC-18(3),800-53r5|SC-18(3),CAT|II,CCI|CCI-001695,CSF|DE.CM-5,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(3),NIAv2|NS26f,QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-213438r823048_rule,STIG-ID|WNDF-AV-000014,STIG-Legacy|SV-89893,STIG-Legacy|V-75213,Vuln-ID|V-213438"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender\Real-Time Protection"
      reg_item    : "LocalSettingOverrideRealtimeScanDirection"
      reg_option  : CAN_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WNDF-AV-000015 - Microsoft Defender AV must be configured to not allow override of scanning for downloaded files and attachments."
      info        : "This policy setting configures a local override for the configuration of scanning for all downloaded files and attachments. This setting can only be set by Group Policy. If this setting is enabled, the local preference setting will take priority over Group Policy. If this setting is disabled or not configured, Group Policy will take priority over the local preference setting."
      solution    : "Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Defender Antivirus >> Real-time Protection >> 'Configure local setting override for scanning all downloaded files and attachments' to 'Disabled' or 'Not Configured'."
      reference   : "800-171|3.13.13,800-53|SC-18(3),800-53r5|SC-18(3),CAT|II,CCI|CCI-001169,CSF|DE.CM-5,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(3),NIAv2|NS26f,QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-213439r823050_rule,STIG-ID|WNDF-AV-000015,STIG-Legacy|SV-89895,STIG-Legacy|V-75215,Vuln-ID|V-213439"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender\Real-Time Protection"
      reg_item    : "LocalSettingOverrideDisableIOAVProtection"
      reg_option  : CAN_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WNDF-AV-000016 - Microsoft Defender AV must be configured to not allow override of behavior monitoring."
      info        : "This policy setting configures a local override for the configuration of behavior monitoring. This setting can only be set by Group Policy. If this setting is enabled, the local preference setting will take priority over Group Policy. If this setting is disabled or not configured, Group Policy will take priority over the local preference setting."
      solution    : "Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Defender Antivirus >> Real-time Protection >> 'Configure local setting override for turn on behavior monitoring' to 'Disabled' or 'Not Configured'."
      reference   : "800-171|3.13.13,800-53|SC-18(4),800-53r5|SC-18(4),CAT|II,CCI|CCI-001170,CSF|DE.CM-5,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(4),NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-213440r823052_rule,STIG-ID|WNDF-AV-000016,STIG-Legacy|SV-89897,STIG-Legacy|V-75217,Vuln-ID|V-213440"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender\Real-Time Protection"
      reg_item    : "LocalSettingOverrideDisableBehaviorMonitoring"
      reg_option  : CAN_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WNDF-AV-000017 - Microsoft Defender AV Group Policy settings must take priority over the local preference settings."
      info        : "This policy setting configures a local override for the configuration to turn on real-time protection. This setting can only be set by Group Policy. If this setting is enabled, the local preference setting will take priority over Group Policy. If this setting is disabled or not configured, Group Policy will take priority over the local preference setting."
      solution    : "Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Defender Antivirus >> Real-time Protection >> 'Configure local setting override to turn on real-time protection' to 'Disabled' or 'Not Configured'."
      reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3c.1.,800-53r5|SI-3c.1.,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CSF|DE.CM-4,CSF|DE.DP-3,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3c.a.,NESA|T3.4.1,NIAv2|NS24,PCI-DSSv3.2.1|5.1,PCI-DSSv3.2.1|5.1.1,PCI-DSSv4.0|5.3.2,PCI-DSSv4.0|5.3.3,QCSC-v1|3.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,Rule-ID|SV-213441r823054_rule,STIG-ID|WNDF-AV-000017,STIG-Legacy|SV-89899,STIG-Legacy|V-75219,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-213441"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender\Real-Time Protection"
      reg_item    : "LocalSettingOverrideDisableRealtimeMonitoring"
      reg_option  : CAN_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WNDF-AV-000018 - Microsoft Defender AV must monitor for incoming and outgoing files."
      info        : "This policy setting allows the configuration of monitoring for incoming and outgoing files without having to turn off monitoring entirely. It is recommended for use on servers that have a lot of incoming and outgoing file activity but for performance reasons need to have scanning disabled for a particular scan direction. The appropriate configuration should be evaluated based on the server role. Note that this configuration is only honored for NTFS volumes. For any other file system type, full monitoring of file and program activity will be present on those volumes.

The options for this setting are mutually exclusive:
0 = Scan incoming and outgoing files (default)
1 = Scan incoming files only
2 = Scan outgoing files only

Any other value, or if the value does not exist, resolves to the default (0). If this setting is enabled, the specified type of monitoring will be enabled. If this setting is disabled or not configured, monitoring for incoming and outgoing files will be enabled."
      solution    : "Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Defender Antivirus >> Real-time Protection >> 'Configure monitoring for incoming and outgoing file and program activity' to 'Disabled' or 'Not Configured'."
      reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3c.1.,800-53r5|SI-3c.1.,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CSF|DE.CM-4,CSF|DE.DP-3,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3c.a.,NESA|T3.4.1,NIAv2|NS24,PCI-DSSv3.2.1|5.1,PCI-DSSv3.2.1|5.1.1,PCI-DSSv4.0|5.3.2,PCI-DSSv4.0|5.3.3,QCSC-v1|3.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,Rule-ID|SV-213442r823056_rule,STIG-ID|WNDF-AV-000018,STIG-Legacy|SV-89901,STIG-Legacy|V-75221,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-213442"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender\Real-Time Protection"
      reg_item    : "RealtimeScanDirection"
      reg_option  : CAN_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WNDF-AV-000019 - Microsoft Defender AV must be configured to monitor for file and program activity."
      info        : "This policy setting allows configuration of monitoring for file and program activity. If this setting is enabled or not configured, monitoring for file and program activity will be enabled. If this setting is disabled, monitoring for file and program activity will be disabled."
      solution    : "Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Defender Antivirus >> Real-time Protection >> 'Monitor file and program activity on your computer' to 'Enabled' or 'Not Configured'."
      reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3c.1.,800-53r5|SI-3c.1.,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CSF|DE.CM-4,CSF|DE.DP-3,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3c.a.,NESA|T3.4.1,NIAv2|NS24,PCI-DSSv3.2.1|5.1,PCI-DSSv3.2.1|5.1.1,PCI-DSSv4.0|5.3.2,PCI-DSSv4.0|5.3.3,QCSC-v1|3.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,Rule-ID|SV-213443r823058_rule,STIG-ID|WNDF-AV-000019,STIG-Legacy|SV-89903,STIG-Legacy|V-75223,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-213443"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender\Real-Time Protection"
      reg_item    : "DisableOnAccessProtection"
      reg_option  : CAN_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WNDF-AV-000020 - Microsoft Defender AV must be configured to scan all downloaded files and attachments."
      info        : "This policy setting allows configuration of scanning for all downloaded files and attachments. If this setting is enabled or not configured, scanning for all downloaded files and attachments will be enabled. If this setting is disabled, scanning for all downloaded files and attachments will be disabled."
      solution    : "Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Defender Antivirus >> Real-time Protection >> 'Scan all downloaded files and attachments' to 'Enabled' or 'Not Configured'."
      reference   : "800-171|3.13.13,800-53|SC-18(3),800-53r5|SC-18(3),CAT|II,CCI|CCI-001169,CSF|DE.CM-5,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(3),NIAv2|NS26f,QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-213444r823060_rule,STIG-ID|WNDF-AV-000020,STIG-Legacy|SV-89905,STIG-Legacy|V-75225,Vuln-ID|V-213444"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender\Real-Time Protection"
      reg_item    : "DisableIOAVProtection"
      reg_option  : CAN_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WNDF-AV-000021 - Microsoft Defender AV must be configured to always enable real-time protection."
      info        : "This policy setting turns off real-time protection prompts for known malware detection. Microsoft Defender Antivirus alerts  when malware or potentially unwanted software attempts to install itself or to run on your computer. If this policy setting is enabled, Microsoft Defender Antivirus will not prompt users to take actions on malware detections. If this policy setting is disabled or not configured, Microsoft Defender Antivirus will prompt users to take actions on malware detections."
      solution    : "Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Defender Antivirus >> Real-time Protection >> 'Turn off real-time protection' to 'Disabled' or 'Not Configured'."
      reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3c.1.,800-53r5|SI-3c.1.,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CSF|DE.CM-4,CSF|DE.DP-3,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3c.a.,NESA|T3.4.1,NIAv2|NS24,PCI-DSSv3.2.1|5.1,PCI-DSSv3.2.1|5.1.1,PCI-DSSv4.0|5.3.2,PCI-DSSv4.0|5.3.3,QCSC-v1|3.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,Rule-ID|SV-213445r823062_rule,STIG-ID|WNDF-AV-000021,STIG-Legacy|SV-89907,STIG-Legacy|V-75227,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-213445"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender\Real-Time Protection"
      reg_item    : "DisableRealtimeMonitoring"
      reg_option  : CAN_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WNDF-AV-000022 - Microsoft Defender AV must be configured to enable behavior monitoring."
      info        : "This policy setting allows configuration of behavior monitoring. If this setting is enabled or not configured, behavior monitoring will be enabled. If this setting is disabled, behavior monitoring will be disabled."
      solution    : "Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Windows Defender Antivirus >> Real-time Protection >> 'Turn on behavior monitoring' to 'Enabled ' or 'Not Configured'."
      reference   : "800-171|3.13.13,800-53|SC-18(4),800-53r5|SC-18(4),CAT|II,CCI|CCI-001170,CSF|DE.CM-5,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(4),NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-213446r823063_rule,STIG-ID|WNDF-AV-000022,STIG-Legacy|SV-89909,STIG-Legacy|V-75229,Vuln-ID|V-213446"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender\Real-Time Protection"
      reg_item    : "DisableBehaviorMonitoring"
      reg_option  : CAN_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WNDF-AV-000023 - Microsoft Defender AV must be configured to process scanning when real-time protection is enabled."
      info        : "This policy setting allows the configuration of process scanning when real-time protection is turned on. This helps to catch malware, which could start when real-time protection is turned off. If this setting is enabled or not configured, a process scan will be initiated when real-time protection is turned on. If this setting is disabled, a process scan will not be initiated when real-time protection is turned on."
      solution    : "Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Defender Antivirus >> Real-time Protection >> 'Turn on process scanning whenever real-time protection is enabled' to 'Enabled' or 'Not Configured'."
      reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3c.1.,800-53r5|SI-3c.1.,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CSF|DE.CM-4,CSF|DE.DP-3,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3c.a.,NESA|T3.4.1,NIAv2|NS24,PCI-DSSv3.2.1|5.1,PCI-DSSv3.2.1|5.1.1,PCI-DSSv4.0|5.3.2,PCI-DSSv4.0|5.3.3,QCSC-v1|3.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,Rule-ID|SV-213447r823065_rule,STIG-ID|WNDF-AV-000023,STIG-Legacy|SV-89911,STIG-Legacy|V-75231,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-213447"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender\Real-Time Protection"
      reg_item    : "DisableScanOnRealtimeEnable"
      reg_option  : CAN_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WNDF-AV-000024 - Microsoft Defender AV must be configured to scan archive files."
      info        : "This policy setting allows the configuration of scans for malicious software and unwanted software in archive files such as .ZIP or .CAB files. If this setting is enabled or not configured, archive files will be scanned. If this setting is disabled, archive files will not be scanned."
      solution    : "Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Defender Antivirus >> Scan >> 'Scan archive files' to 'Enabled ' or 'Not Configured'."
      reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3c.1.,800-53r5|SI-3c.1.,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CSF|DE.CM-4,CSF|DE.DP-3,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3c.a.,NESA|T3.4.1,NIAv2|NS24,PCI-DSSv3.2.1|5.1,PCI-DSSv3.2.1|5.1.1,PCI-DSSv4.0|5.3.2,PCI-DSSv4.0|5.3.3,QCSC-v1|3.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,Rule-ID|SV-213448r823067_rule,STIG-ID|WNDF-AV-000024,STIG-Legacy|SV-89913,STIG-Legacy|V-75233,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-213448"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender\Scan"
      reg_item    : "DisableArchiveScanning"
      reg_option  : CAN_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WNDF-AV-000025 - Microsoft Defender AV must be configured to scan removable drives."
      info        : "This policy setting allows the management of whether or not to scan for malicious software and unwanted software in the contents of removable drives such as USB flash drives when running a full scan. If this setting is enabled, removable drives will be scanned during any type of scan. If this setting is disabled or not configured, removable drives will not be scanned during a full scan. Removable drives may still be scanned during quick scan and custom scan."
      solution    : "Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Windows Defender Antivirus >> Scan >> 'Scan removable drives' to 'Enabled'."
      reference   : "800-171|3.7.1,800-171|3.7.2,800-171|3.7.4,800-53|MA-3(2),800-53r5|MA-3(2),CAT|II,CCI|CCI-000870,CSF|PR.MA-1,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|MA-3(2),NESA|T2.3.4,QCSC-v1|3.2,QCSC-v1|5.2.3,Rule-ID|SV-213449r823068_rule,STIG-ID|WNDF-AV-000025,STIG-Legacy|SV-89915,STIG-Legacy|V-75235,Vuln-ID|V-213449"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender\Scan"
      reg_item    : "DisableRemovableDriveScanning"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WNDF-AV-000026 - Microsoft Defender AV must be configured to perform a weekly scheduled scan."
      info        : "This policy setting allows specifying the day of the week on which to perform a scheduled scan. The scan can also be configured to run every day or to never run at all. This setting can be configured with the following ordinal number values:
(0x0) Every Day
(0x1) Sunday
(0x2) Monday
(0x3) Tuesday
(0x4) Wednesday
(0x5) Thursday
(0x6) Friday
(0x7) Saturday
(0x8) Never (default)

If this setting is enabled, a scheduled scan will run at the frequency specified. If this setting is disabled or not configured, a scheduled scan will run at a default frequency."
      solution    : "Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Defender Antivirus >> Scan >> 'Specify the day of the week to run a scheduled scan' to 'Enabled ' and select anything other than 'Never' in the drop-down box."
      reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3c.1.,800-53r5|SI-3c.1.,CAT|II,CCI|CCI-001241,CN-L3|7.1.3.6(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CSF|DE.CM-4,CSF|DE.DP-3,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3c.a.,NESA|T3.4.1,NIAv2|NS24,PCI-DSSv3.2.1|5.1,PCI-DSSv3.2.1|5.1.1,PCI-DSSv4.0|5.3.2,PCI-DSSv4.0|5.3.3,QCSC-v1|3.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,Rule-ID|SV-213450r823070_rule,STIG-ID|WNDF-AV-000026,STIG-Legacy|SV-89917,STIG-Legacy|V-75237,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-213450"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : [0..7]
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender\Scan"
      reg_item    : "ScheduleDay"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WNDF-AV-000027 - Microsoft Defender AV must be configured to turn on e-mail scanning."
      info        : "This policy setting allows the configuration of e-mail scanning. When e-mail scanning is enabled, the engine will parse the mailbox and mail files according to their specific format in order to analyze the mail bodies and attachments. Several e-mail formats are currently supported, for example: pst (Outlook), dbx mbx mime (Outlook Express), binhex (Mac). If this setting is enabled, e-mail scanning will be enabled. If this setting is disabled or not configured, e-mail scanning will be disabled."
      solution    : "Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Defender Antivirus >> Scan >> 'Turn on e-mail scanning' to 'Enabled'."
      reference   : "800-171|3.13.13,800-53|SC-18(4),800-53r5|SC-18(4),CAT|II,CCI|CCI-001170,CSF|DE.CM-5,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(4),NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-213451r823072_rule,STIG-ID|WNDF-AV-000027,STIG-Legacy|SV-89919,STIG-Legacy|V-75239,Vuln-ID|V-213451"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender\Scan"
      reg_item    : "DisableEmailScanning"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WNDF-AV-000028 - Microsoft Defender AV spyware definition age must not exceed 7 days."
      info        : "This policy setting allows defining the number of days that must pass before spyware definitions are considered out of date. If definitions are determined to be out of date, this state may trigger several additional actions, including falling back to an alternative update source or displaying a warning icon in the user interface. By default this value is set to 14 days.

If this setting is enabled, spyware definitions will be considered out of date after the number of days specified have passed without an update. If this setting is disabled or not configured, spyware definitions will be considered out of date after the default number of days have passed without an update.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Windows Defender Antivirus >> Signature Updates >> 'Define the number of days before spyware definitions are considered out of date' to 'Enabled' and select '7' or less in the drop-down box.

Do not select a value of 0. This disables the option."
      reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3b.,800-53r5|SI-3b.,CAT|I,CCI|CCI-001240,CN-L3|7.1.3.6(a),CSF|DE.CM-4,CSF|DE.DP-3,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3b.,NESA|T3.4.1,NIAv2|GS8a,PCI-DSSv3.2.1|5.2,PCI-DSSv4.0|5.3.1,QCSC-v1|3.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,Rule-ID|SV-213452r823073_rule,STIG-ID|WNDF-AV-000028,STIG-Legacy|SV-89921,STIG-Legacy|V-75241,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-213452"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : [1..7]
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender\Signature Updates"
      reg_item    : "ASSignatureDue"
      reg_option  : CAN_NOT_BE_NULL
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WNDF-AV-000029 - Microsoft Defender AV virus definition age must not exceed 7 days."
      info        : "This policy setting allows defining the number of days that must pass before virus definitions are considered out of date. If definitions are determined to be out of date, this state may trigger several additional actions, including falling back to an alternative update source or displaying a warning icon in the user interface. By default, this value is set to 14 days.

If this setting is enabled, virus definitions will be considered out of date after the number of days specified have passed without an update. If this setting is disabled or not configured, virus definitions will be considered out of date after the default number of days have passed without an update.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Defender Antivirus >> Signature Updates >> 'Define the number of days before virus definitions are considered out of date' to 'Enabled' and select '7' or less in the drop-down box.

Do not select a value of 0. This disables the option."
      reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3b.,800-53r5|SI-3b.,CAT|I,CCI|CCI-001240,CN-L3|7.1.3.6(a),CSF|DE.CM-4,CSF|DE.DP-3,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3b.,NESA|T3.4.1,NIAv2|GS8a,PCI-DSSv3.2.1|5.2,PCI-DSSv4.0|5.3.1,QCSC-v1|3.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,Rule-ID|SV-213453r823075_rule,STIG-ID|WNDF-AV-000029,STIG-Legacy|SV-89923,STIG-Legacy|V-75243,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-213453"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : [1..7]
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender\Signature Updates"
      reg_item    : "AVSignatureDue"
      reg_option  : CAN_NOT_BE_NULL
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WNDF-AV-000030 - Microsoft Defender AV must be configured to check for definition updates daily."
      info        : "This policy setting allows specifying the day of the week on which to check for definition updates. The check can also be configured to run every day or to never run at all. This setting can be configured with the following ordinal number values:
(0x0) Every Day (default)
(0x1) Sunday
(0x2) Monday
(0x3) Tuesday
(0x4) Wednesday
(0x5) Thursday
(0x6) Friday
(0x7) Saturday
(0x8) Never

If this setting is enabled, the check for definition updates will occur at the frequency specified. If this setting is disabled or not configured, the check for definition updates will occur at a default frequency."
      solution    : "Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Defender Antivirus >> Signature Updates >> 'Specify the day of the week to check for definition updates' to 'Enabled' and select 'Every Day' in the drop-down box."
      reference   : "800-53|SI-8(2),800-53r5|SI-8(2),CAT|II,CCI|CCI-001308,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-8(2),QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-213454r823077_rule,STIG-ID|WNDF-AV-000030,STIG-Legacy|SV-89925,STIG-Legacy|V-75245,Vuln-ID|V-213454"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender\Signature Updates"
      reg_item    : "ScheduleDay"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WNDF-AV-000031 - Microsoft Defender AV must be configured for automatic remediation action to be taken for threat alert level Severe - Enabled"
      info        : "This policy setting allows the customization of which automatic remediation action will be taken for each threat alert level. Threat alert levels should be added under the Options for this setting. Each entry must be listed as a name value pair. The name defines a threat alert level. The value contains the action ID for the remediation action that should be taken.

Valid threat alert levels are:
1 = Low
2 =  Medium
4 = High
5 = Severe

Valid remediation action values are:
2 = Quarantine
3 = Remove
6 = Ignore"
      solution    : "Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Defender Antivirus >> Threats >> 'Specify threat alert levels at which default action should not be taken when detected' to 'Enabled'.

Select the 'Show...' option box and enter '5' in the 'Value name' field and enter '2' in the 'Value' field."
      reference   : "800-171|3.13.13,800-53|SC-18(1),800-53r5|SC-18(1),CAT|II,CCI|CCI-001662,CSF|DE.CM-5,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(1),NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-213455r823079_rule,STIG-ID|WNDF-AV-000031,STIG-Legacy|SV-89927,STIG-Legacy|V-75247,Vuln-ID|V-213455"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender\Threats"
      reg_item    : "Threats_ThreatSeverityDefaultAction"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WNDF-AV-000031 - Microsoft Defender AV must be configured for automatic remediation action to be taken for threat alert level Severe - 5>2"
      info        : "This policy setting allows the customization of which automatic remediation action will be taken for each threat alert level. Threat alert levels should be added under the Options for this setting. Each entry must be listed as a name value pair. The name defines a threat alert level. The value contains the action ID for the remediation action that should be taken.

Valid threat alert levels are:
1 = Low
2 =  Medium
4 = High
5 = Severe

Valid remediation action values are:
2 = Quarantine
3 = Remove
6 = Ignore"
      solution    : "Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Defender Antivirus >> Threats >> 'Specify threat alert levels at which default action should not be taken when detected' to 'Enabled'.

Select the 'Show...' option box and enter '5' in the 'Value name' field and enter '2' in the 'Value' field."
      reference   : "800-171|3.13.13,800-53|SC-18(1),800-53r5|SC-18(1),CAT|II,CCI|CCI-001662,CSF|DE.CM-5,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(1),NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-213455r823079_rule,STIG-ID|WNDF-AV-000031,STIG-Legacy|SV-89927,STIG-Legacy|V-75247,Vuln-ID|V-213455"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : [2..3]
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender\Threats\ThreatSeverityDefaultAction"
      reg_item    : "5"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WNDF-AV-000040 - Microsoft Defender AV must be configured for automatic remediation action to be taken for threat alert level High - Enabled"
      info        : "This policy setting allows the customization of which automatic remediation action will be taken for each threat alert level. Threat alert levels should be added under the Options for this setting. Each entry must be listed as a name value pair. The name defines a threat alert level. The value contains the action ID for the remediation action that should be taken.

Valid threat alert levels are:
1 = Low
2 =  Medium
4 = High
5 = Severe

Valid remediation action values are:
2 = Quarantine
3 = Remove
6 = Ignore"
      solution    : "Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Defender Antivirus >> Threats >> 'Specify threat alert levels at which default action should not be taken when detected' to 'Enabled'.

Select the 'Show...' option box and enter '4' in the 'Value name' field and enter '2' in the 'Value' field."
      reference   : "800-171|3.13.13,800-53|SC-18(1),800-53r5|SC-18(1),CAT|II,CCI|CCI-001662,CSF|DE.CM-5,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(1),NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-213464r823097_rule,STIG-ID|WNDF-AV-000040,STIG-Legacy|SV-94669,STIG-Legacy|V-79965,Vuln-ID|V-213464"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender\Threats"
      reg_item    : "Threats_ThreatSeverityDefaultAction"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WNDF-AV-000040 - Microsoft Defender AV must be configured for automatic remediation action to be taken for threat alert level High - 4>2"
      info        : "This policy setting allows the customization of which automatic remediation action will be taken for each threat alert level. Threat alert levels should be added under the Options for this setting. Each entry must be listed as a name value pair. The name defines a threat alert level. The value contains the action ID for the remediation action that should be taken.

Valid threat alert levels are:
1 = Low
2 =  Medium
4 = High
5 = Severe

Valid remediation action values are:
2 = Quarantine
3 = Remove
6 = Ignore"
      solution    : "Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Defender Antivirus >> Threats >> 'Specify threat alert levels at which default action should not be taken when detected' to 'Enabled'.

Select the 'Show...' option box and enter '4' in the 'Value name' field and enter '2' in the 'Value' field."
      reference   : "800-171|3.13.13,800-53|SC-18(1),800-53r5|SC-18(1),CAT|II,CCI|CCI-001662,CSF|DE.CM-5,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(1),NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-213464r823097_rule,STIG-ID|WNDF-AV-000040,STIG-Legacy|SV-94669,STIG-Legacy|V-79965,Vuln-ID|V-213464"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : [2..3]
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender\Threats\ThreatSeverityDefaultAction"
      reg_item    : "4"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WNDF-AV-000041 - Microsoft Defender AV must be configured for automatic remediation action to be taken for threat alert level Medium - Enabled"
      info        : "This policy setting allows the customization of which automatic remediation action will be taken for each threat alert level. Threat alert levels should be added under the Options for this setting. Each entry must be listed as a name value pair. The name defines a threat alert level. The value contains the action ID for the remediation action that should be taken.

Valid threat alert levels are:
1 = Low
2 =  Medium
4 = High
5 = Severe

Valid remediation action values are:
2 = Quarantine
3 = Remove
6 = Ignore"
      solution    : "Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Defender Antivirus >> Threats >> 'Specify threat alert levels at which default action should not be taken when detected' to 'Enabled'.

Select the 'Show...' option box and enter '2' in the 'Value name' field and enter '2' in the 'Value' field."
      reference   : "800-171|3.13.13,800-53|SC-18(1),800-53r5|SC-18(1),CAT|II,CCI|CCI-001662,CSF|DE.CM-5,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(1),NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-213465r823099_rule,STIG-ID|WNDF-AV-000041,STIG-Legacy|SV-94671,STIG-Legacy|V-79967,Vuln-ID|V-213465"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender\Threats"
      reg_item    : "Threats_ThreatSeverityDefaultAction"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WNDF-AV-000041 - Microsoft Defender AV must be configured for automatic remediation action to be taken for threat alert level Medium - 2>2"
      info        : "This policy setting allows the customization of which automatic remediation action will be taken for each threat alert level. Threat alert levels should be added under the Options for this setting. Each entry must be listed as a name value pair. The name defines a threat alert level. The value contains the action ID for the remediation action that should be taken.

Valid threat alert levels are:
1 = Low
2 =  Medium
4 = High
5 = Severe

Valid remediation action values are:
2 = Quarantine
3 = Remove
6 = Ignore"
      solution    : "Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Defender Antivirus >> Threats >> 'Specify threat alert levels at which default action should not be taken when detected' to 'Enabled'.

Select the 'Show...' option box and enter '2' in the 'Value name' field and enter '2' in the 'Value' field."
      reference   : "800-171|3.13.13,800-53|SC-18(1),800-53r5|SC-18(1),CAT|II,CCI|CCI-001662,CSF|DE.CM-5,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(1),NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-213465r823099_rule,STIG-ID|WNDF-AV-000041,STIG-Legacy|SV-94671,STIG-Legacy|V-79967,Vuln-ID|V-213465"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : [2..3]
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender\Threats\ThreatSeverityDefaultAction"
      reg_item    : "2"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WNDF-AV-000042 - Microsoft Defender AV must be configured for automatic remediation action to be taken for threat alert level Low - Enabled"
      info        : "This policy setting allows the customization of which automatic remediation action will be taken for each threat alert level. Threat alert levels should be added under the Options for this setting. Each entry must be listed as a name value pair. The name defines a threat alert level. The value contains the action ID for the remediation action that should be taken.

Valid threat alert levels are:
1 = Low
2 =  Medium
4 = High
5 = Severe

Valid remediation action values are:
2 = Quarantine
3 = Remove
6 = Ignore"
      solution    : "Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Defender Antivirus >> Threats >> 'Specify threat alert levels at which default action should not be taken when detected' to 'Enabled'.

Select the 'Show...' option box and enter '1' in the 'Value name' field and enter '2' in the 'Value' field."
      reference   : "800-171|3.13.13,800-53|SC-18(1),800-53r5|SC-18(1),CAT|II,CCI|CCI-001662,CSF|DE.CM-5,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(1),NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-213466r823101_rule,STIG-ID|WNDF-AV-000042,STIG-Legacy|SV-94675,STIG-Legacy|V-79971,Vuln-ID|V-213466"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender\Threats"
      reg_item    : "Threats_ThreatSeverityDefaultAction"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WNDF-AV-000042 - Microsoft Defender AV must be configured for automatic remediation action to be taken for threat alert level Low - 1>2"
      info        : "This policy setting allows the customization of which automatic remediation action will be taken for each threat alert level. Threat alert levels should be added under the Options for this setting. Each entry must be listed as a name value pair. The name defines a threat alert level. The value contains the action ID for the remediation action that should be taken.

Valid threat alert levels are:
1 = Low
2 =  Medium
4 = High
5 = Severe

Valid remediation action values are:
2 = Quarantine
3 = Remove
6 = Ignore"
      solution    : "Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Defender Antivirus >> Threats >> 'Specify threat alert levels at which default action should not be taken when detected' to 'Enabled'.

Select the 'Show...' option box and enter '1' in the 'Value name' field and enter '2' in the 'Value' field."
      reference   : "800-171|3.13.13,800-53|SC-18(1),800-53r5|SC-18(1),CAT|II,CCI|CCI-001662,CSF|DE.CM-5,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(1),NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-213466r823101_rule,STIG-ID|WNDF-AV-000042,STIG-Legacy|SV-94675,STIG-Legacy|V-79971,Vuln-ID|V-213466"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : [2..3]
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender\Threats\ThreatSeverityDefaultAction"
      reg_item    : "1"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : REGISTRY_SETTING
          description : "Windows 10 is installed"
          value_type  : POLICY_TEXT
          value_data  : "^[Ww][Ii][Nn][Dd][Oo][Ww][Ss] 10.+$"
          reg_key     : "HKLM\Software\Microsoft\Windows Nt\Currentversion"
          reg_item    : "ProductName"
          check_type  : CHECK_REGEX
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "Check Windows Release"
          value_type  : POLICY_TEXT
          value_data  : "^(1709|1[89]0[39]|2004)$"
          reg_key     : "HKLM\Software\Microsoft\Windows Nt\Currentversion"
          reg_item    : "ReleaseId"
          check_type  : CHECK_REGEX
        </custom_item>
      </condition>

      <then>
        <custom_item>
          type        : REGISTRY_SETTING
          description : "WNDF-AV-000032 - Microsoft Defender AV must be configured to block executable content from email client and webmail."
          info        : "This rule blocks the following file types from being run or launched from an email seen in either Microsoft Outlook or webmail (such as Gmail.com or Outlook.com):
Executable files (such as .exe, .dll, or .scr)
Script files (such as a PowerShell .ps, VisualBasic .vbs, or JavaScript .js file)
Script archive files"
          solution    : "Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Defender Antivirus >> Windows Defender Exploit Guard >> Attack Surface Reduction >> 'Configure Attack Surface Reduction rules' to 'Enabled'.

Click 'Show...'. Set the Value name to 'BE9BA2D9-53EA-4CDC-84E5-9B1EEEE46550' and the Value to '1'."
          reference   : "800-171|3.13.13,800-53|SC-18(4),800-53r5|SC-18(4),CAT|II,CCI|CCI-001170,CSF|DE.CM-5,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(4),NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-213456r823081_rule,STIG-ID|WNDF-AV-000032,STIG-Legacy|SV-92661,STIG-Legacy|V-77965,Vuln-ID|V-213456"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules"
          reg_item    : "BE9BA2D9-53EA-4CDC-84E5-9B1EEEE46550"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>
      </then>

      <else>
        <report type:"PASSED">
          description : "WNDF-AV-000032 - Microsoft Defender AV must be configured to block executable content from email client and webmail."
          info        : "This rule blocks the following file types from being run or launched from an email seen in either Microsoft Outlook or webmail (such as Gmail.com or Outlook.com):
Executable files (such as .exe, .dll, or .scr)
Script files (such as a PowerShell .ps, VisualBasic .vbs, or JavaScript .js file)
Script archive files"
          solution    : "Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Defender Antivirus >> Windows Defender Exploit Guard >> Attack Surface Reduction >> 'Configure Attack Surface Reduction rules' to 'Enabled'.

Click 'Show...'. Set the Value name to 'BE9BA2D9-53EA-4CDC-84E5-9B1EEEE46550' and the Value to '1'."
          reference   : "800-171|3.13.13,800-53|SC-18(4),800-53r5|SC-18(4),CAT|II,CCI|CCI-001170,CSF|DE.CM-5,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(4),NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-213456r823081_rule,STIG-ID|WNDF-AV-000032,STIG-Legacy|SV-92661,STIG-Legacy|V-77965,Vuln-ID|V-213456"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
        </report>
      </else>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : REGISTRY_SETTING
          description : "Windows 10 is installed"
          value_type  : POLICY_TEXT
          value_data  : "^[Ww][Ii][Nn][Dd][Oo][Ww][Ss] 10.+$"
          reg_key     : "HKLM\Software\Microsoft\Windows Nt\Currentversion"
          reg_item    : "ProductName"
          check_type  : CHECK_REGEX
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "Check Windows Release"
          value_type  : POLICY_TEXT
          value_data  : "^(1709|1[89]0[39]|2004)$"
          reg_key     : "HKLM\Software\Microsoft\Windows Nt\Currentversion"
          reg_item    : "ReleaseId"
          check_type  : CHECK_REGEX
        </custom_item>
      </condition>

      <then>
        <custom_item>
          type        : REGISTRY_SETTING
          description : "WNDF-AV-000033 - Microsoft Defender AV must be configured block Office applications from creating child processes."
          info        : "Office apps, such as Word or Excel, will not be allowed to create child processes. This is a typical malware behavior, especially for macro-based attacks that attempt to use Office apps to launch or download malicious executables."
          solution    : "Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Defender Antivirus >> Windows Defender Exploit Guard >> Attack Surface Reduction >> 'Configure Attack Surface Reduction rules' to 'Enabled'.

Click 'Show...'. Set the Value name to 'D4F940AB-401B-4EFC-AADC-AD5F3C50688A' and the Value to '1'."
          reference   : "800-171|3.13.13,800-53|SC-18(4),800-53r5|SC-18(4),CAT|II,CCI|CCI-001170,CSF|DE.CM-5,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(4),NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-213457r823083_rule,STIG-ID|WNDF-AV-000033,STIG-Legacy|SV-92663,STIG-Legacy|V-77967,Vuln-ID|V-213457"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules"
          reg_item    : "D4F940AB-401B-4EFC-AADC-AD5F3C50688A"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>
      </then>

      <else>
        <report type:"PASSED">
          description : "WNDF-AV-000033 - Microsoft Defender AV must be configured block Office applications from creating child processes."
          info        : "Office apps, such as Word or Excel, will not be allowed to create child processes. This is a typical malware behavior, especially for macro-based attacks that attempt to use Office apps to launch or download malicious executables."
          solution    : "Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Defender Antivirus >> Windows Defender Exploit Guard >> Attack Surface Reduction >> 'Configure Attack Surface Reduction rules' to 'Enabled'.

Click 'Show...'. Set the Value name to 'D4F940AB-401B-4EFC-AADC-AD5F3C50688A' and the Value to '1'."
          reference   : "800-171|3.13.13,800-53|SC-18(4),800-53r5|SC-18(4),CAT|II,CCI|CCI-001170,CSF|DE.CM-5,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(4),NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-213457r823083_rule,STIG-ID|WNDF-AV-000033,STIG-Legacy|SV-92663,STIG-Legacy|V-77967,Vuln-ID|V-213457"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
        </report>
      </else>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : REGISTRY_SETTING
          description : "Windows 10 is installed"
          value_type  : POLICY_TEXT
          value_data  : "^[Ww][Ii][Nn][Dd][Oo][Ww][Ss] 10.+$"
          reg_key     : "HKLM\Software\Microsoft\Windows Nt\Currentversion"
          reg_item    : "ProductName"
          check_type  : CHECK_REGEX
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "Check Windows Release"
          value_type  : POLICY_TEXT
          value_data  : "^(1709|1[89]0[39]|2004)$"
          reg_key     : "HKLM\Software\Microsoft\Windows Nt\Currentversion"
          reg_item    : "ReleaseId"
          check_type  : CHECK_REGEX
        </custom_item>
      </condition>

      <then>
        <custom_item>
          type        : REGISTRY_SETTING
          description : "WNDF-AV-000034 - Microsoft Defender AV must be configured block Office applications from creating executable content."
          info        : "This rule targets typical behaviors used by suspicious and malicious add-ons and scripts (extensions) that create or launch executable files. This is a typical malware technique. Extensions will be blocked from being used by Office apps. Typically these extensions use the Windows Scripting Host (.wsh files) to run scripts that automate certain tasks or provide user-created add-on features."
          solution    : "Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Defender Antivirus >> Windows Defender Exploit Guard >> Attack Surface Reduction >> 'Configure Attack Surface Reduction rules' to 'Enabled'.

Click 'Show...'. Set the Value name to '3B576869-A4EC-4529-8536-B80A7769E899' and the Value to '1'."
          reference   : "800-171|3.13.13,800-53|SC-18(4),800-53r5|SC-18(4),CAT|II,CCI|CCI-001170,CSF|DE.CM-5,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(4),NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-213458r823085_rule,STIG-ID|WNDF-AV-000034,STIG-Legacy|SV-92665,STIG-Legacy|V-77969,Vuln-ID|V-213458"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules"
          reg_item    : "3B576869-A4EC-4529-8536-B80A7769E899"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>
      </then>

      <else>
        <report type:"PASSED">
          description : "WNDF-AV-000034 - Microsoft Defender AV must be configured block Office applications from creating executable content."
          info        : "This rule targets typical behaviors used by suspicious and malicious add-ons and scripts (extensions) that create or launch executable files. This is a typical malware technique. Extensions will be blocked from being used by Office apps. Typically these extensions use the Windows Scripting Host (.wsh files) to run scripts that automate certain tasks or provide user-created add-on features."
          solution    : "Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Defender Antivirus >> Windows Defender Exploit Guard >> Attack Surface Reduction >> 'Configure Attack Surface Reduction rules' to 'Enabled'.

Click 'Show...'. Set the Value name to '3B576869-A4EC-4529-8536-B80A7769E899' and the Value to '1'."
          reference   : "800-171|3.13.13,800-53|SC-18(4),800-53r5|SC-18(4),CAT|II,CCI|CCI-001170,CSF|DE.CM-5,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(4),NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-213458r823085_rule,STIG-ID|WNDF-AV-000034,STIG-Legacy|SV-92665,STIG-Legacy|V-77969,Vuln-ID|V-213458"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
        </report>
      </else>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : REGISTRY_SETTING
          description : "Windows 10 is installed"
          value_type  : POLICY_TEXT
          value_data  : "^[Ww][Ii][Nn][Dd][Oo][Ww][Ss] 10.+$"
          reg_key     : "HKLM\Software\Microsoft\Windows Nt\Currentversion"
          reg_item    : "ProductName"
          check_type  : CHECK_REGEX
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "Check Windows Release"
          value_type  : POLICY_TEXT
          value_data  : "^(1709|1[89]0[39]|2004)$"
          reg_key     : "HKLM\Software\Microsoft\Windows Nt\Currentversion"
          reg_item    : "ReleaseId"
          check_type  : CHECK_REGEX
        </custom_item>
      </condition>

      <then>
        <custom_item>
          type        : REGISTRY_SETTING
          description : "WNDF-AV-000035 - Microsoft Defender AV must be configured to block Office applications from injecting into other processes."
          info        : "Office apps, such as Word, Excel, or PowerPoint, will not be able to inject code into other processes. This is typically used by malware to run malicious code in an attempt to hide the activity from antivirus scanning engines."
          solution    : "Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Defender Antivirus >> Windows Defender Exploit Guard >> Attack Surface Reduction >> 'Configure Attack Surface Reduction rules' to 'Enabled'.

Click 'Show...'. Set the Value name to '75668C1F-73B5-4CF0-BB93-3ECF5CB7CC84' and the Value to '1'."
          reference   : "800-171|3.13.13,800-53|SC-18(4),800-53r5|SC-18(4),CAT|II,CCI|CCI-001170,CSF|DE.CM-5,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(4),NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-213459r823087_rule,STIG-ID|WNDF-AV-000035,STIG-Legacy|SV-92667,STIG-Legacy|V-77971,Vuln-ID|V-213459"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules"
          reg_item    : "75668C1F-73B5-4CF0-BB93-3ECF5CB7CC84"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>
      </then>

      <else>
        <report type:"PASSED">
          description : "WNDF-AV-000035 - Microsoft Defender AV must be configured to block Office applications from injecting into other processes."
          info        : "Office apps, such as Word, Excel, or PowerPoint, will not be able to inject code into other processes. This is typically used by malware to run malicious code in an attempt to hide the activity from antivirus scanning engines."
          solution    : "Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Defender Antivirus >> Windows Defender Exploit Guard >> Attack Surface Reduction >> 'Configure Attack Surface Reduction rules' to 'Enabled'.

Click 'Show...'. Set the Value name to '75668C1F-73B5-4CF0-BB93-3ECF5CB7CC84' and the Value to '1'."
          reference   : "800-171|3.13.13,800-53|SC-18(4),800-53r5|SC-18(4),CAT|II,CCI|CCI-001170,CSF|DE.CM-5,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(4),NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-213459r823087_rule,STIG-ID|WNDF-AV-000035,STIG-Legacy|SV-92667,STIG-Legacy|V-77971,Vuln-ID|V-213459"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
        </report>
      </else>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : REGISTRY_SETTING
          description : "Windows 10 is installed"
          value_type  : POLICY_TEXT
          value_data  : "^[Ww][Ii][Nn][Dd][Oo][Ww][Ss] 10.+$"
          reg_key     : "HKLM\Software\Microsoft\Windows Nt\Currentversion"
          reg_item    : "ProductName"
          check_type  : CHECK_REGEX
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "Check Windows Release"
          value_type  : POLICY_TEXT
          value_data  : "^(1709|1[89]0[39]|2004)$"
          reg_key     : "HKLM\Software\Microsoft\Windows Nt\Currentversion"
          reg_item    : "ReleaseId"
          check_type  : CHECK_REGEX
        </custom_item>
      </condition>

      <then>
        <custom_item>
          type        : REGISTRY_SETTING
          description : "WNDF-AV-000036 - Microsoft Defender AV must be configured to impede JavaScript and VBScript to launch executables."
          info        : "JavaScript and VBScript scripts can be used by malware to launch other malicious apps. This rule prevents these scripts from being allowed to launch apps, thus preventing malicious use of the scripts to spread malware and infect machines."
          solution    : "Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Defender Antivirus >> Windows Defender Exploit Guard >> Attack Surface Reduction >> 'Configure Attack Surface Reduction rules' to 'Enabled'.

Click 'Show...'. Set the Value name to 'D3E037E1-3EB8-44C8-A917-57927947596D' and the Value to '1'."
          reference   : "800-171|3.13.13,800-53|SC-18(4),800-53r5|SC-18(4),CAT|II,CCI|CCI-001170,CSF|DE.CM-5,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(4),NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-213460r823089_rule,STIG-ID|WNDF-AV-000036,STIG-Legacy|SV-92669,STIG-Legacy|V-77973,Vuln-ID|V-213460"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules"
          reg_item    : "D3E037E1-3EB8-44C8-A917-57927947596D"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>
      </then>

      <else>
        <report type:"PASSED">
          description : "WNDF-AV-000036 - Microsoft Defender AV must be configured to impede JavaScript and VBScript to launch executables."
          info        : "JavaScript and VBScript scripts can be used by malware to launch other malicious apps. This rule prevents these scripts from being allowed to launch apps, thus preventing malicious use of the scripts to spread malware and infect machines."
          solution    : "Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Defender Antivirus >> Windows Defender Exploit Guard >> Attack Surface Reduction >> 'Configure Attack Surface Reduction rules' to 'Enabled'.

Click 'Show...'. Set the Value name to 'D3E037E1-3EB8-44C8-A917-57927947596D' and the Value to '1'."
          reference   : "800-171|3.13.13,800-53|SC-18(4),800-53r5|SC-18(4),CAT|II,CCI|CCI-001170,CSF|DE.CM-5,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(4),NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-213460r823089_rule,STIG-ID|WNDF-AV-000036,STIG-Legacy|SV-92669,STIG-Legacy|V-77973,Vuln-ID|V-213460"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
        </report>
      </else>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : REGISTRY_SETTING
          description : "Windows 10 is installed"
          value_type  : POLICY_TEXT
          value_data  : "^[Ww][Ii][Nn][Dd][Oo][Ww][Ss] 10.+$"
          reg_key     : "HKLM\Software\Microsoft\Windows Nt\Currentversion"
          reg_item    : "ProductName"
          check_type  : CHECK_REGEX
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "Check Windows Release"
          value_type  : POLICY_TEXT
          value_data  : "^(1709|1[89]0[39]|2004)$"
          reg_key     : "HKLM\Software\Microsoft\Windows Nt\Currentversion"
          reg_item    : "ReleaseId"
          check_type  : CHECK_REGEX
        </custom_item>
      </condition>

      <then>
        <custom_item>
          type        : REGISTRY_SETTING
          description : "WNDF-AV-000037 - Microsoft Defender AV must be configured to block execution of potentially obfuscated scripts."
          info        : "Malware and other threats can attempt to obfuscate or hide their malicious code in some script files. This rule prevents scripts that appear to be obfuscated from running. It uses the AntiMalwareScanInterface (AMSI) to determine if a script is potentially obfuscated and then blocks such a script or blocks scripts when an attempt is made to access them."
          solution    : "Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Defender Antivirus >> Windows Defender Exploit Guard >> Attack Surface Reduction >> 'Configure Attack Surface Reduction rules' to 'Enabled'.

Click 'Show...'. Set the Value name to '5BEB7EFE-FD9A-4556-801D-275E5FFC04CC' and the Value to '1'."
          reference   : "800-171|3.13.13,800-53|SC-18(4),800-53r5|SC-18(4),CAT|II,CCI|CCI-001170,CSF|DE.CM-5,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(4),NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-213461r823091_rule,STIG-ID|WNDF-AV-000037,STIG-Legacy|SV-92671,STIG-Legacy|V-77975,Vuln-ID|V-213461"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules"
          reg_item    : "5BEB7EFE-FD9A-4556-801D-275E5FFC04CC"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>
      </then>

      <else>
        <report type:"PASSED">
          description : "WNDF-AV-000037 - Microsoft Defender AV must be configured to block execution of potentially obfuscated scripts."
          info        : "Malware and other threats can attempt to obfuscate or hide their malicious code in some script files. This rule prevents scripts that appear to be obfuscated from running. It uses the AntiMalwareScanInterface (AMSI) to determine if a script is potentially obfuscated and then blocks such a script or blocks scripts when an attempt is made to access them."
          solution    : "Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Defender Antivirus >> Windows Defender Exploit Guard >> Attack Surface Reduction >> 'Configure Attack Surface Reduction rules' to 'Enabled'.

Click 'Show...'. Set the Value name to '5BEB7EFE-FD9A-4556-801D-275E5FFC04CC' and the Value to '1'."
          reference   : "800-171|3.13.13,800-53|SC-18(4),800-53r5|SC-18(4),CAT|II,CCI|CCI-001170,CSF|DE.CM-5,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(4),NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-213461r823091_rule,STIG-ID|WNDF-AV-000037,STIG-Legacy|SV-92671,STIG-Legacy|V-77975,Vuln-ID|V-213461"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
        </report>
      </else>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : REGISTRY_SETTING
          description : "Windows 10 is installed"
          value_type  : POLICY_TEXT
          value_data  : "^[Ww][Ii][Nn][Dd][Oo][Ww][Ss] 10.+$"
          reg_key     : "HKLM\Software\Microsoft\Windows Nt\Currentversion"
          reg_item    : "ProductName"
          check_type  : CHECK_REGEX
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "Check Windows Release"
          value_type  : POLICY_TEXT
          value_data  : "^(1709|1[89]0[39]|2004)$"
          reg_key     : "HKLM\Software\Microsoft\Windows Nt\Currentversion"
          reg_item    : "ReleaseId"
          check_type  : CHECK_REGEX
        </custom_item>
      </condition>

      <then>
        <custom_item>
          type        : REGISTRY_SETTING
          description : "WNDF-AV-000038 - Microsoft Defender AV must be configured to block Win32 imports from macro code in Office."
          info        : "This rule blocks potentially malicious behavior by not allowing macro code to execute routines in the Win 32 dynamic link library (DLL)."
          solution    : "Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Defender Antivirus >> Windows Defender Exploit Guard >> Attack Surface Reduction >> 'Configure Attack Surface Reduction rules' to 'Enabled'.

Click 'Show...'. Set the Value name to '92E97FA1-2EDF-4476-BDD6-9DD0B4DDDC7B' and the Value to '1'."
          reference   : "800-171|3.13.13,800-53|SC-18(4),800-53r5|SC-18(4),CAT|II,CCI|CCI-001170,CSF|DE.CM-5,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(4),NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-213462r823093_rule,STIG-ID|WNDF-AV-000038,STIG-Legacy|SV-92673,STIG-Legacy|V-77977,Vuln-ID|V-213462"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules"
          reg_item    : "92E97FA1-2EDF-4476-BDD6-9DD0B4DDDC7B"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>
      </then>

      <else>
        <report type:"PASSED">
          description : "WNDF-AV-000038 - Microsoft Defender AV must be configured to block Win32 imports from macro code in Office."
          info        : "This rule blocks potentially malicious behavior by not allowing macro code to execute routines in the Win 32 dynamic link library (DLL)."
          solution    : "Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Defender Antivirus >> Windows Defender Exploit Guard >> Attack Surface Reduction >> 'Configure Attack Surface Reduction rules' to 'Enabled'.

Click 'Show...'. Set the Value name to '92E97FA1-2EDF-4476-BDD6-9DD0B4DDDC7B' and the Value to '1'."
          reference   : "800-171|3.13.13,800-53|SC-18(4),800-53r5|SC-18(4),CAT|II,CCI|CCI-001170,CSF|DE.CM-5,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(4),NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-213462r823093_rule,STIG-ID|WNDF-AV-000038,STIG-Legacy|SV-92673,STIG-Legacy|V-77977,Vuln-ID|V-213462"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
        </report>
      </else>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : REGISTRY_SETTING
          description : "Windows 10 is installed"
          value_type  : POLICY_TEXT
          value_data  : "^[Ww][Ii][Nn][Dd][Oo][Ww][Ss] 10.+$"
          reg_key     : "HKLM\Software\Microsoft\Windows Nt\Currentversion"
          reg_item    : "ProductName"
          check_type  : CHECK_REGEX
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "Check Windows Release"
          value_type  : POLICY_TEXT
          value_data  : "^(1709|1[89]0[39]|2004)$"
          reg_key     : "HKLM\Software\Microsoft\Windows Nt\Currentversion"
          reg_item    : "ReleaseId"
          check_type  : CHECK_REGEX
        </custom_item>
      </condition>

      <then>
        <custom_item>
          type        : REGISTRY_SETTING
          description : "WNDF-AV-000039 - Microsoft Defender AV must be configured to prevent user and apps from accessing dangerous websites."
          info        : "Enable Microsoft Defender Exploit Guard network protection to prevent employees from using any application to access dangerous domains that may host phishing scams, exploit-hosting sites, and other malicious content on the internet."
          solution    : "Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Defender Antivirus >> Windows Defender Exploit Guard >> Network Protection >> 'Prevent users and apps from accessing dangerous websites' to 'Enabled' and select 'Block' in the drop-down box."
          reference   : "800-171|3.13.13,800-53|SC-18(4),800-53r5|SC-18(4),CAT|II,CCI|CCI-001170,CSF|DE.CM-5,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(4),NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-213463r823095_rule,STIG-ID|WNDF-AV-000039,STIG-Legacy|SV-92675,STIG-Legacy|V-77979,Vuln-ID|V-213463"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\Network Protection"
          reg_item    : "EnableNetworkProtection"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>
      </then>

      <else>
        <report type:"PASSED">
          description : "WNDF-AV-000039 - Microsoft Defender AV must be configured to prevent user and apps from accessing dangerous websites."
          info        : "Enable Microsoft Defender Exploit Guard network protection to prevent employees from using any application to access dangerous domains that may host phishing scams, exploit-hosting sites, and other malicious content on the internet."
          solution    : "Set the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Defender Antivirus >> Windows Defender Exploit Guard >> Network Protection >> 'Prevent users and apps from accessing dangerous websites' to 'Enabled' and select 'Block' in the drop-down box."
          reference   : "800-171|3.13.13,800-53|SC-18(4),800-53r5|SC-18(4),CAT|II,CCI|CCI-001170,CSF|DE.CM-5,DISA_Benchmark|MS_Defender_Antivirus,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(4),NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-213463r823095_rule,STIG-ID|WNDF-AV-000039,STIG-Legacy|SV-92675,STIG-Legacy|V-77979,Vuln-ID|V-213463"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
        </report>
      </else>
    </if>
  </then>

  <else>
    <report type:"WARNING">
      description : "DISA_STIG_Microsoft_Defender_Antivirus_v2r4.audit from DISA Microsoft Defender Antivirus v2r4 STIG"
      info        : "NOTE: Nessus has not identified that the chosen audit applies to the target device."
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Defender_Antivirus_V2R4_STIG.zip"
    </report>
  </else>
</if>

</group_policy>
</check_type>
