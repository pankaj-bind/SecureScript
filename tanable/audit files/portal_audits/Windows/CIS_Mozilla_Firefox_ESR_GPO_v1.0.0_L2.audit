#TRUSTED 11739b3ff9d7c4f5c49cbc7bd3c7a7fca454076f112ac9f192a6b54aa280873f2bf968fd5dbf54ead7374b2382a62a7991b945739b89abcb13e2cdda2f7bb8c2ae1362bf680eb51edb09a0f065c10e390848d94dcb040e78f3d5b16d445bda20062c71b8c1bd9cf394d326e23468b70d6b605d78d3af624d4c1460a190566a0e5f5ab1c8ec75fe1e79f76669cd5c83e1725f49ea5f6aeb84b297a493aafce6969ce04415e199847a744803e05ccb3ea8eb1cb0f443f32c61362d8a4a6d395078da7979e7f97d9d7398054d4a419678e320bc2e0d571710cdb912d0e4f06f8c26fe59fe237e0d14b0bc58e6b6c8b49b0b653d06e1fe767908906c038fb4454e6406f42fef2d2923f60da5fa2a4ab8316e7b7961032ece5b462278dce432fc3405f79b8b1c28f19c8bdbc9fd9afc77c1e90a74b7cefa590dc0667e67b277ac54ad8add8cfed9d8140e5c273ca19a0b2ecc95e283156af69ba5b0830527fc50d512a5960e5426d0c929eec0d2fbcd6e5a79e3318c2c12fd58d9487938882e983826242efdec411958fa47cb2726aa3c30d57179cbca532a8fe4211f6b8eebd4808aa74102b48857095d65977189797565e71375a1e6553ff8d3dbd7a084193f10c94391a6d3d0de4f18a46d64f11f0dd950dcd19e38c8d6bcfb740e7456f10268d9ad4150c4e19d214ceaa9edc54195134ec98f67b1f93af6b18cf367f824c26b2f
#TRUST-RSA-SHA256 a6f56e6b6c5dc093569a793d76af209388281983edbbf47fc475d4c1c6637e73e7ba13c4a7c6049671ff1ebd604eb380ce411302551dca3279ff78dab50bfad13296c0abd70c20a240b3fc6ebb0c67825d534f31f82fb7f122dad6cc0b84d23f7f860637a38cce74146e8563f491df50a15f74a501b44fea89a0af57c667a4a9fb9f8cbb137d53f3e835eee7dd1a664045c24862cc4d408866f6eb8db1c93d96c03958374a32f8ba8d20a6064acafae2b3609b1b14d8f80058561fad96ff4e410e5c75135b84971ff1cebab4f67cdd04538be1c3fa41b89b03f7a5e0b85e92f9a3d84a065d85b76a3be52c0d4b0ca7e0462f1866cfe860ddb4e1722f3637f582d3c4fac74c6f421c8e85fafc5a5e9de0c7537b2acce2d27767ca76bcb8d852fa9fb96f99d82fdb2bf0907e85efc27a45bb56e10149b843702630a02f12eb6270b3a1366eb6d05ae90ff28df5ae777a4f94b2e713c4d39c2c81ba0602ae703b7104f4ae1fe4e92f15270696fe83c38503d4025edfa739f1b9383d7f0cb27aced385deeb090ab0757caa8fa36330d5aef7115fd909df79ac3bcd591aeaaaa8706e20ab418c8cc07871f5a196c8c12c1dd1c2402d87b972239f4f725b6dc04024d31c7142e06f56863de981bc706ed28fcd172d801fffba1efa1a844ff8d4d958c602cff025f026ff43cf39fc14444aaea5b476439a941ab1931118455ca01d18a2
#
# This script is Copyright (C) 2004-2025 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
# $Revision: 1.0 $
# $Date: 2025/01/06 $
#
# description : This .audit is designed against the CIS Mozilla Firefox ESR GPO Benchmark 1.0.0
#
#<ui_metadata>
#<display_name>CIS Mozilla Firefox ESR GPO v1.0.0 L2</display_name>
#<spec>
#  <type>CIS</type>
#  <name>Mozilla Firefox ESR GPO</name>
#  <profile>L2</profile>
#  <version>1.0.0</version>
#  <link>https://workbench.cisecurity.org/benchmarks/18454</link>
#</spec>
#<labels>cis,windows_firefox,agent</labels>
#<benchmark_refs>CSCv6,CSCv7,CSCv8,LEVEL</benchmark_refs>
#</ui_metadata>

<check_type:"Windows" version:"2">
<group_policy:"CIS Mozilla Firefox ESR GPO">

<if>
  <condition type:"OR">
    <custom_item>
      type        : REG_CHECK
      description : "Firefox is installed"
      value_type  : POLICY_TEXT
      value_data  : "HKLM\Software\Mozilla\Mozilla Firefox"
      reg_option  : MUST_EXIST
    </custom_item>

    <custom_item>
      type        : REG_CHECK
      description : "Firefox ESR is installed"
      value_type  : POLICY_TEXT
      value_data  : "HKLM\Software\Mozilla\Mozilla Firefox ESR"
      reg_option  : MUST_EXIST
    </custom_item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "CIS_Mozilla_Firefox_ESR_GPO_v1.0.0_L2.audit from CIS Mozilla Firefox ESR GPO Benchmark v1.0.0"
      see_also    : "https://workbench.cisecurity.org/benchmarks/18454"
    </report>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "1.1.18.9 (L2) Ensure 'network.IDN_show_punycode' is set to 'Enabled'"
      info        : "This setting determines whether Internationalized Domain Names (IDNs) displayed in the browser are displayed as Punycode or as Unicode.

The recommended state for this setting is: Enabled

IDNs displayed in Punycode are easier to identify and therefore help mitigate the risk of accessing spoofed web pages."
      solution    : "To establish the recommended configuration via GP, set the following UI path to Enabled :

Computer Configuration\Policies\Administrative Templates\Mozilla\Firefox\Preferences (Deprecated)\network.IDN_show_punycode

Note: This Group Policy path does not exist by default. An additional Group Policy template ( firefox.admx/adml ) is required - it is available to download at this

link

.

Impact:

IDNs will be displayed in Punycode."
      reference   : "800-53|SI-16,800-53r5|SI-16,CSCv7|8.3,CSCv8|10.5,CSF2.0|PR.DS-10,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-16,LEVEL|2A"
      see_also    : "https://workbench.cisecurity.org/benchmarks/18454"
      value_type  : POLICY_DWORD
      value_data  : "1"
      reg_key     : "HKLM\SOFTWARE\Policies\Mozilla\Firefox\Preferences"
      reg_item    : "network.IDN_show_punycode"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "1.1.20.1 (L2) Ensure 'Search Suggestions' is set to 'Disabled'"
      info        : "This policy setting determines whether web search suggestions are used in Firefox.

The recommended state for this setting is: Disabled

Characters that are typed by the user are sent to a search engine before the Enter key is pressed therefore, it is possible for unintended data to be sent."
      solution    : "To establish the recommended configuration via GP, set the following UI path to Disabled :

Computer Configuration\Policies\Administrative Templates\Mozilla\Firefox\Search\Search Suggestions

Note: This Group Policy path does not exist by default. An additional Group Policy template ( firefox.admx/adml ) is required - it is available to download at this

link

.

Impact:

Users will not get customized web suggestions for search results; they will still receive local suggestions."
      reference   : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/benchmarks/18454"
      value_type  : POLICY_DWORD
      value_data  : "0"
      reg_key     : "HKLM\SOFTWARE\Policies\Mozilla\Firefox"
      reg_item    : "SearchSuggestEnabled"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "1.1.31 (L2) Ensure 'Disable Form History' is set to 'Enabled'"
      info        : "Form Fill Assistance allows Firefox to save data that has been entered into forms by users so that future operations are performed faster.

The recommended state for this setting is: Enabled

This mitigates the risk of websites extracting information from prefilled text fields."
      solution    : "To establish the recommended configuration via GP, set the following UI path to Disabled :

Computer Configuration\Policies\Administrative Templates\Mozilla\Firefox\Disable Form History

Note: This Group Policy path does not exist by default. An additional Group Policy template ( firefox.admx/adml ) is required - it is available to download at this

link

.

Impact:

Prefilled text fields will not be enabled."
      reference   : "800-53|AU-11,800-53|SI-12,800-53r5|AU-11,800-53r5|CM-12,800-53r5|SI-12,CSCv8|3.1,CSF|PR.PT-1,CSF2.0|ID.AM-07,CSF2.0|ID.AM-08,CSF2.0|PR.PS-04,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-11,ITSG-33|SI-12,ITSG-33|SI-12a.,LEVEL|2A,NESA|M5.2.3,NESA|M5.2.4,NESA|M5.3.1,NESA|T3.6.2,NIAv2|DR1,NIAv2|DR1a,NIAv2|DR1b,NIAv2|DR1c,NIAv2|DR2,NIAv2|DR3,NIAv2|DR4,NIAv2|DR5,NIAv2|DR6,NIAv2|SM7,PCI-DSSv3.2.1|3.1,PCI-DSSv3.2.1|10.7,PCI-DSSv4.0|3.2.1,PCI-DSSv4.0|10.5.1,QCSC-v1|8.2.1,QCSC-v1|13.2"
      see_also    : "https://workbench.cisecurity.org/benchmarks/18454"
      value_type  : POLICY_DWORD
      value_data  : "1"
      reg_key     : "HKLM\SOFTWARE\Policies\Mozilla\Firefox"
      reg_item    : "DisableFormHistory"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "1.1.40 (L2) Ensure 'New Tab Page' is set to 'Disabled'"
      info        : "The New Tab page shows a list of built-in top sites, as well as the top sites the user has visited by default.

The recommended state for this setting is: Disabled

Allowing the collection of browsing history by Firefox could inadvertently lead to sensitive data being exposed."
      solution    : "To establish the recommended configuration via GP, set the following UI path to Disabled :

Computer Configuration\Policies\Administrative Templates\Mozilla\Firefox\New Tab Page

Note: This Group Policy path does not exist by default. An additional Group Policy template ( firefox.admx/adml ) is required - it is available to download at this

link

.

Impact:

Top site and user history will not be available on a new tab."
      reference   : "800-53|AU-11,800-53|SI-12,800-53r5|AU-11,800-53r5|CM-12,800-53r5|SI-12,CSCv8|3.1,CSF|PR.PT-1,CSF2.0|ID.AM-07,CSF2.0|ID.AM-08,CSF2.0|PR.PS-04,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-11,ITSG-33|SI-12,ITSG-33|SI-12a.,LEVEL|2A,NESA|M5.2.3,NESA|M5.2.4,NESA|M5.3.1,NESA|T3.6.2,NIAv2|DR1,NIAv2|DR1a,NIAv2|DR1b,NIAv2|DR1c,NIAv2|DR2,NIAv2|DR3,NIAv2|DR4,NIAv2|DR5,NIAv2|DR6,NIAv2|SM7,PCI-DSSv3.2.1|3.1,PCI-DSSv3.2.1|10.7,PCI-DSSv4.0|3.2.1,PCI-DSSv4.0|10.5.1,QCSC-v1|8.2.1,QCSC-v1|13.2"
      see_also    : "https://workbench.cisecurity.org/benchmarks/18454"
      value_type  : POLICY_DWORD
      value_data  : "0"
      reg_key     : "HKLM\SOFTWARE\Policies\Mozilla\Firefox"
      reg_item    : "NewTabPage"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>
  </then>

  <else>
    <report type:"WARNING">
      description : "CIS_Mozilla_Firefox_ESR_GPO_v1.0.0_L2.audit from CIS Mozilla Firefox ESR GPO Benchmark v1.0.0"
      info        : "NOTE: Nessus has not identified that the chosen audit applies to the target device."
      see_also    : "https://workbench.cisecurity.org/benchmarks/18454"
    </report>
  </else>
</if>

</group_policy>
</check_type>
