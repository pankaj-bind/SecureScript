#TRUSTED 10e2e99a62886805676b47574996d5634442749507e2974266a6bc93afe8f2ec73fa7b50b3ca35629e85029e4040277655cd53926928df729f1959c5b61cc96ae194f602e45975404fc3547579187d194d22ea67eb6bb3210e91c6ec50b9295d883263844af0ffbd594c3f62c25d1958f2b00aab4b9c5b3cddcff287325e4c3394a5d4fa1f5e45e170478cf3038b9c0d8d910e62cabd835e5758ebe812e2e340af29873268adc5fdea47709c2caff429dceb34d1dde3dd8e2e0f32ca3dcd915eba708acbe67883ddf994eab7fb7e3a1a3dc571914cdb5f7a75cdb9b6d79ffb91cc6251aea08e16d2ba266dfba0b3779a859f4be37bda5e4e388dcbf921f06477455b794cd4ee350fba1e8bc7c0e3cf4564acaf43920e794430c7ac59feeea66e7fdb3b9d6aad77c33970341613939dba49c01cf8dc56b58f93bf7d66b7de00f555609bd9ca4ce830f1ca483e3e4b50215be95a1cf2a4b33908a1b18987ddb7184f5e6e5a133afb7bbf5129cf04cb04e0d8791bf909137f03db87cc876ba25fecdb4222ed0a5cfa1d9edd5e2886b62ce9318aaf81036eced9dcdc335e8fca7e82ad0ae3a0987e359e1a40c0f782e75c6c1f074ab0026381f91279edd23e80e837c0bbde242cd8258230b298b020c26a9d281f04fdf87f6942b97026688887a28cc2e3a5a6391415847d20342e4178341cd311d2657d9aa0e7b776fc33977f7804
#TRUST-RSA-SHA256 1faf7f0ebb0e2a796e48d7a66beb7c342f90674d1e3c6c14ecc340bd09ad523ddb1239430af7977bf83628decdf289859507e453a422f61d144787f74c960b4f77dc07dbd6161331c124e294fd995c37ad36d7448ef5b10b19e0a35d1aabfba173cf84f984322244ad7f40d11799cd0c082c56f0e745c2bae72cef5d04768ef86d1648b6e22ae7d0d82a147b8e024e34f598d43412326c0fefe47c03d2db69f43582338a3a3858503608a2d7539313ed54d6974001b0108afe0e835a04aeaeefcdce2be7eecb883f5f7641cd8f269669ae2e36954ae86d042d4e7b185025b5e1ff5b0c250b638d1e868d3b58a6fb98e431d3ffc1c1e059ca010e552cb66533b947a0c6520dfd594a788b72224ea9fec2df40c5dc34dfdd08c427b59d66e58a03ff02ac1ff025d1f40a5924997244d84ad2798253c5b65a412d12064659cf6ffead942d28eda5f76da748c35a41bbc5d5e91ececcc5cfa17625d2362b76407f7230adee0cc0058d482ff36383d52706ffce562fffce8884f20bba2a3b35791069e8a0327a98f68df0089f6bd0e2d53e8bef3bd8160d266d90117a57e45c8d94b041116b755d155739c9a930c84eabe883f22d1ede3811fef04d4c5f7fa011b29836f6ddad1d7bf57be399f500ccc1da0d5205d5133ec4e5b2b889000f4adcb79050009966cd8e864caa80c6761c7ee7bec31e408b42b958dd4cdc3fe6534c7aa3
#
# This script is Copyright (C) 2004-2025 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
# $Revision: 1.2 $
# $Date: 2025/01/06 $
#
# description : This document implements the security configuration as recommended by the
#               CIS Mozilla Firefox 102 ESR Benchmark
#
#<ui_metadata>
#<display_name>CIS Mozilla Firefox 102 ESR Windows L2 v1.0.0</display_name>
#<spec>
#  <type>CIS</type>
#  <name>Mozilla Firefox 102 ESR</name>
#  <profile>L2 OS Windows</profile>
#  <version>1.0.0</version>
#  <link>https://workbench.cisecurity.org/files/4299</link>
#</spec>
#<labels>windows_firefox,agent</labels>
#<benchmark_refs>CCE,CSCv6,CSCv7,CSCv8,LEVEL</benchmark_refs>
#<variables>
#  <variable>
#    <name>MOZILLA_CONFIG</name>
#    <default>C:\Program Files (X86)\Mozilla Firefox\mozilla.cfg</default>
#    <description>Mozilla configuration file</description>
#    <info>This is the location where the mozilla configuration file can be found.</info>
#    <value_type>WIN_FILE_PATH</value_type>
#  </variable>
#</variables>
#</ui_metadata>

<check_type:"Windows" version:"2">
<group_policy:"Firefox">

<if>
  <condition type:"OR">
    <custom_item>
      type        : REG_CHECK
      description : "Firefox is installed"
      value_type  : POLICY_TEXT
      value_data  : "HKLM\Software\Mozilla\Mozilla Firefox"
      reg_option  : MUST_EXIST
    </custom_item>

    <custom_item>
      type        : REG_CHECK
      description : "Firefox ESR is installed"
      value_type  : POLICY_TEXT
      value_data  : "HKLM\Software\Mozilla\Mozilla Firefox ESR"
      reg_option  : MUST_EXIST
    </custom_item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "CIS_Mozilla_Firefox_102_ESR_v1.0.0_Windows_Level2.audit for CIS Mozilla Firefox 102 ESR v1.0.0"
      see_also    : "https://workbench.cisecurity.org/files/4299"
    </report>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "3.4 Enable IDN Show Punycode"
      info        : "This setting determines whether Internationalized Domain Names (IDNs) displayed in the browser are displayed as Punycode or as Unicode.

Rationale:

IDNs displayed in Punycode are easier to identify and therefore help mitigate the risk of accessing spoofed web pages."
      solution    : "To establish the recommended configuration, set network.IDN_show_punycode to true:

Type about:config in the address bar

Type network.IDN_show_punycode in the filter

Configure the setting as prescribed.

OR

Open the mozilla.cfg file in the installation directory with a text editor

Add the following lines to mozilla.cfg:

lockPref('network.IDN_show_punycode', true);

Default Value:

False"
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|2A,NESA|T3.2.1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/4299"
      value_type  : POLICY_TEXT
      value_data  : "@MOZILLA_CONFIG@"
      regex       : '^[\\s]*lockPref\\("network.IDN_show_punycode",[\\s]*'
      expect      : '^[\\s]*lockPref\\("network.IDN_show_punycode",[\\s]*true\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "4.2 Set OCSP Response Policy"
      info        : "This setting dictates whether Firefox will consider a given certificate to be invalid if it is unable to obtain an Online Certificate Status Protocol (OCSP) response for it.

Rationale:

Requiring an OCSP response will reduce an adversary's ability to successfully leverage a compromised and revoked certificate.

Impact:

Requiring an OCSP response increases opportunity for valid certificates to be deemed invalid. This may occur if OCSP server becomes unavailable or is not accessible."
      solution    : "To establish the recommended configuration, set security.ocsp.require to true:

Type about:config in the address bar

Type security.ocsp.require in the filter

Ensure the setting is set as prescribed.

OR

Open the mozilla.cfg file in the installation directory with a text editor

Add the following lines to mozilla.cfg:

lockPref('security.ocsp.require', true);

Default Value:

False"
      reference   : "800-171|3.5.2,800-53|IA-5(2)(a),800-53r5|IA-5(2)(b)(1),CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(2)(a),LEVEL|2A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2"
      see_also    : "https://workbench.cisecurity.org/files/4299"
      value_type  : POLICY_TEXT
      value_data  : "@MOZILLA_CONFIG@"
      regex       : '^[\\s]*lockPref\\("security.ocsp.require",[\\s]*'
      expect      : '^[\\s]*lockPref\\("security.ocsp.require",[\\s]*true\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "4.3 Set OCSP Use Policy"
      info        : "This setting dictates whether Firefox will leverage Online Certificate Status Protocol (OCSP) to determine if a given certificate has been revoked.

Rationale:

Leveraging OCSP may help identify revoked certificates.

Impact:

None - This is the default behavior."
      solution    : "To establish the recommended configuration, set security.OCSP.enabled to 1:

Type about:config in the address bar

Type security.OCSP.enabled in the filter

Ensure the setting is set as prescribed.

OR

Open the mozilla.cfg file in the installation directory with a text editor

Add the following lines to mozilla.cfg:

lockPref('security.OCSP.enabled', 1);

Note: Configuring this setting to 2 also conforms with this benchmark.

Default Value:

1"
      reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3c.1.,800-53r5|SI-3c.1.,CN-L3|7.1.3.6(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CSF|DE.CM-4,CSF|DE.DP-3,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3c.a.,LEVEL|2A,NESA|T3.4.1,NIAv2|NS24,PCI-DSSv3.2.1|5.1,PCI-DSSv3.2.1|5.1.1,PCI-DSSv4.0|5.3.2,PCI-DSSv4.0|5.3.3,QCSC-v1|3.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7"
      see_also    : "https://workbench.cisecurity.org/files/4299"
      value_type  : POLICY_TEXT
      value_data  : "@MOZILLA_CONFIG@"
      regex       : '^[\\s]*lockPref\\("security.OCSP.enabled",[\\s]*'
      expect      : '^[\\s]*lockPref\\("security.OCSP.enabled",[\\s]*1\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "4.6 Set SSL Override Behavior"
      info        : "This setting controls whether Firefox will or will not automatically fill in the URL text box and auto-fetch the certificate on behalf of the user. When Firefox encounters an invalid certificate and the user clicks 'Add Exception', a dialog is displayed with a text box to fetch the certificate from the given URL.

Rationale:

Requiring the user to manually enter the server's URL and fetch the certificate may provide additional opportunity to scrutinize the certificate before adding an exception for a potentially fraudulent certificate.

Impact:

Setting this configuration to 0 forces the user to enter a URL and click the 'Get Certificate' button before adding an exception for an invalid cert."
      solution    : "To establish the recommended configuration, set browser.ssl_override_behavior to 0:

Type about:config in the address bar

Type browser.ssl_override_behavior in the filter

Ensure the setting is set as prescribed.

OR

Open the mozilla.cfg file in the installation directory with a text editor

Add the following lines to mozilla.cfg:

lockPref('browser.ssl_override_behavior', 0);

Default Value:

2"
      reference   : "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|2A,NESA|T3.2.1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/4299"
      value_type  : POLICY_TEXT
      value_data  : "@MOZILLA_CONFIG@"
      regex       : '^[\\s]*lockPref\\("browser.ssl_override_behavior",[\\s]*'
      expect      : '^[\\s]*lockPref\\("browser.ssl_override_behavior",[\\s]*0\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "6.1 Configure New Tab Page - browser.urlbar.suggest.history"
      info        : "The New Tab page shows a list of built-in top sites, as well as the top sites the user has visited by default.

Rationale:

Allowing the collection of browsing history by Firefox could inadvertently lead to sensitive data being exposed.

Impact:

Top site and user history will not be available on a new tab."
      solution    : "To establish the recommended configuration, set the following values to false:

browser.urlbar.suggest.history

browser.newtabpage.activity-stream.feeds.topsites

browser.newtabpage.activity-stream.feeds.snippets

browser.newtabpage.activity-stream.feeds.section.topstories

browser.newtabpage.activity-stream.section.highlights.includePocket

browser.newtabpage.activity-stream.feeds.section.highlights

Type about:config in the address bar

Type browser.urlbar.suggest.history in the filter

Configure the setting as prescribed.

Type browser.newtabpage.activity-stream.feeds.topsites in the filter

Configure the setting as prescribed.

Type browser.newtabpage.activity-stream.feeds.snippets in the filter

Configure the setting as prescribed.

Type browser.newtabpage.activity-stream.feeds.section.topstories in the filter

Configure the setting as prescribed.

Type browser.newtabpage.activity-stream.section.highlights.includePocket in the filter

Configure the setting as prescribed.

Type browser.newtabpage.activity-stream.feeds.section.highlights in the filter

Configure the setting as prescribed.

OR

Open the mozilla.cfg file in the installation directory with a text editor

Add the following lines to mozilla.cfg:

lockPref('browser.urlbar.suggest.history', false);
lockPref('browser.newtabpage.activity-stream.feeds.topsites', false);
lockPref('browser.newtabpage.activity-stream.feeds.snippets', false);
lockPref('browser.newtabpage.activity-stream.feeds.section.topstories', false);
lockPref('browser.newtabpage.activity-stream.section.highlights.includePocket', false);
lockPref('browser.newtabpage.activity-stream.feeds.section.highlights', false);

Default Value:

browser.urlbar.suggest.history = true

browser.newtabpage.activity-stream.feeds.topsites = true

browser.newtabpage.activity-stream.feeds.snippets = false

browser.newtabpage.activity-stream.feeds.section.topstories = true

browser.newtabpage.activity-stream.section.highlights.includePocket = true

browser.newtabpage.activity-stream.feeds.section.highlights = false"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|2M,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/4299"
      value_type  : POLICY_TEXT
      value_data  : "@MOZILLA_CONFIG@"
      regex       : '^[\\s]*lockPref\\("browser.urlbar.suggest.history",[\\s]*'
      expect      : '^[\\s]*lockPref\\("browser.urlbar.suggest.history",[\\s]*false\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "6.1 Configure New Tab Page - browser.newtabpage.activity-stream.feeds.topsites"
      info        : "The New Tab page shows a list of built-in top sites, as well as the top sites the user has visited by default.

Rationale:

Allowing the collection of browsing history by Firefox could inadvertently lead to sensitive data being exposed.

Impact:

Top site and user history will not be available on a new tab."
      solution    : "To establish the recommended configuration, set the following values to false:

browser.urlbar.suggest.history

browser.newtabpage.activity-stream.feeds.topsites

browser.newtabpage.activity-stream.feeds.snippets

browser.newtabpage.activity-stream.feeds.section.topstories

browser.newtabpage.activity-stream.section.highlights.includePocket

browser.newtabpage.activity-stream.feeds.section.highlights

Type about:config in the address bar

Type browser.urlbar.suggest.history in the filter

Configure the setting as prescribed.

Type browser.newtabpage.activity-stream.feeds.topsites in the filter

Configure the setting as prescribed.

Type browser.newtabpage.activity-stream.feeds.snippets in the filter

Configure the setting as prescribed.

Type browser.newtabpage.activity-stream.feeds.section.topstories in the filter

Configure the setting as prescribed.

Type browser.newtabpage.activity-stream.section.highlights.includePocket in the filter

Configure the setting as prescribed.

Type browser.newtabpage.activity-stream.feeds.section.highlights in the filter

Configure the setting as prescribed.

OR

Open the mozilla.cfg file in the installation directory with a text editor

Add the following lines to mozilla.cfg:

lockPref('browser.urlbar.suggest.history', false);
lockPref('browser.newtabpage.activity-stream.feeds.topsites', false);
lockPref('browser.newtabpage.activity-stream.feeds.snippets', false);
lockPref('browser.newtabpage.activity-stream.feeds.section.topstories', false);
lockPref('browser.newtabpage.activity-stream.section.highlights.includePocket', false);
lockPref('browser.newtabpage.activity-stream.feeds.section.highlights', false);

Default Value:

browser.urlbar.suggest.history = true

browser.newtabpage.activity-stream.feeds.topsites = true

browser.newtabpage.activity-stream.feeds.snippets = false

browser.newtabpage.activity-stream.feeds.section.topstories = true

browser.newtabpage.activity-stream.section.highlights.includePocket = true

browser.newtabpage.activity-stream.feeds.section.highlights = false"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|2M,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/4299"
      value_type  : POLICY_TEXT
      value_data  : "@MOZILLA_CONFIG@"
      regex       : '^[\\s]*lockPref\\("browser.newtabpage.activity-stream.feeds.topsites",[\\s]*'
      expect      : '^[\\s]*lockPref\\("browser.newtabpage.activity-stream.feeds.topsites",[\\s]*false\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "6.1 Configure New Tab Page - browser.newtabpage.activity-stream.feeds.snippets"
      info        : "The New Tab page shows a list of built-in top sites, as well as the top sites the user has visited by default.

Rationale:

Allowing the collection of browsing history by Firefox could inadvertently lead to sensitive data being exposed.

Impact:

Top site and user history will not be available on a new tab."
      solution    : "To establish the recommended configuration, set the following values to false:

browser.urlbar.suggest.history

browser.newtabpage.activity-stream.feeds.topsites

browser.newtabpage.activity-stream.feeds.snippets

browser.newtabpage.activity-stream.feeds.section.topstories

browser.newtabpage.activity-stream.section.highlights.includePocket

browser.newtabpage.activity-stream.feeds.section.highlights

Type about:config in the address bar

Type browser.urlbar.suggest.history in the filter

Configure the setting as prescribed.

Type browser.newtabpage.activity-stream.feeds.topsites in the filter

Configure the setting as prescribed.

Type browser.newtabpage.activity-stream.feeds.snippets in the filter

Configure the setting as prescribed.

Type browser.newtabpage.activity-stream.feeds.section.topstories in the filter

Configure the setting as prescribed.

Type browser.newtabpage.activity-stream.section.highlights.includePocket in the filter

Configure the setting as prescribed.

Type browser.newtabpage.activity-stream.feeds.section.highlights in the filter

Configure the setting as prescribed.

OR

Open the mozilla.cfg file in the installation directory with a text editor

Add the following lines to mozilla.cfg:

lockPref('browser.urlbar.suggest.history', false);
lockPref('browser.newtabpage.activity-stream.feeds.topsites', false);
lockPref('browser.newtabpage.activity-stream.feeds.snippets', false);
lockPref('browser.newtabpage.activity-stream.feeds.section.topstories', false);
lockPref('browser.newtabpage.activity-stream.section.highlights.includePocket', false);
lockPref('browser.newtabpage.activity-stream.feeds.section.highlights', false);

Default Value:

browser.urlbar.suggest.history = true

browser.newtabpage.activity-stream.feeds.topsites = true

browser.newtabpage.activity-stream.feeds.snippets = false

browser.newtabpage.activity-stream.feeds.section.topstories = true

browser.newtabpage.activity-stream.section.highlights.includePocket = true

browser.newtabpage.activity-stream.feeds.section.highlights = false"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|2M,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/4299"
      value_type  : POLICY_TEXT
      value_data  : "@MOZILLA_CONFIG@"
      regex       : '^[\\s]*lockPref\\("browser.newtabpage.activity-stream.feeds.snippets",[\\s]*'
      expect      : '^[\\s]*lockPref\\("browser.newtabpage.activity-stream.feeds.snippets",[\\s]*false\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "6.1 Configure New Tab Page - browser.newtabpage.activity-stream.feeds.section.topstories"
      info        : "The New Tab page shows a list of built-in top sites, as well as the top sites the user has visited by default.

Rationale:

Allowing the collection of browsing history by Firefox could inadvertently lead to sensitive data being exposed.

Impact:

Top site and user history will not be available on a new tab."
      solution    : "To establish the recommended configuration, set the following values to false:

browser.urlbar.suggest.history

browser.newtabpage.activity-stream.feeds.topsites

browser.newtabpage.activity-stream.feeds.snippets

browser.newtabpage.activity-stream.feeds.section.topstories

browser.newtabpage.activity-stream.section.highlights.includePocket

browser.newtabpage.activity-stream.feeds.section.highlights

Type about:config in the address bar

Type browser.urlbar.suggest.history in the filter

Configure the setting as prescribed.

Type browser.newtabpage.activity-stream.feeds.topsites in the filter

Configure the setting as prescribed.

Type browser.newtabpage.activity-stream.feeds.snippets in the filter

Configure the setting as prescribed.

Type browser.newtabpage.activity-stream.feeds.section.topstories in the filter

Configure the setting as prescribed.

Type browser.newtabpage.activity-stream.section.highlights.includePocket in the filter

Configure the setting as prescribed.

Type browser.newtabpage.activity-stream.feeds.section.highlights in the filter

Configure the setting as prescribed.

OR

Open the mozilla.cfg file in the installation directory with a text editor

Add the following lines to mozilla.cfg:

lockPref('browser.urlbar.suggest.history', false);
lockPref('browser.newtabpage.activity-stream.feeds.topsites', false);
lockPref('browser.newtabpage.activity-stream.feeds.snippets', false);
lockPref('browser.newtabpage.activity-stream.feeds.section.topstories', false);
lockPref('browser.newtabpage.activity-stream.section.highlights.includePocket', false);
lockPref('browser.newtabpage.activity-stream.feeds.section.highlights', false);

Default Value:

browser.urlbar.suggest.history = true

browser.newtabpage.activity-stream.feeds.topsites = true

browser.newtabpage.activity-stream.feeds.snippets = false

browser.newtabpage.activity-stream.feeds.section.topstories = true

browser.newtabpage.activity-stream.section.highlights.includePocket = true

browser.newtabpage.activity-stream.feeds.section.highlights = false"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|2M,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/4299"
      value_type  : POLICY_TEXT
      value_data  : "@MOZILLA_CONFIG@"
      regex       : '^[\\s]*lockPref\\("browser.newtabpage.activity-stream.feeds.section.topstories",[\\s]*'
      expect      : '^[\\s]*lockPref\\("browser.newtabpage.activity-stream.feeds.section.topstories",[\\s]*false\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "6.1 Configure New Tab Page - browser.newtabpage.activity-stream.section.highlights.includePocket"
      info        : "The New Tab page shows a list of built-in top sites, as well as the top sites the user has visited by default.

Rationale:

Allowing the collection of browsing history by Firefox could inadvertently lead to sensitive data being exposed.

Impact:

Top site and user history will not be available on a new tab."
      solution    : "To establish the recommended configuration, set the following values to false:

browser.urlbar.suggest.history

browser.newtabpage.activity-stream.feeds.topsites

browser.newtabpage.activity-stream.feeds.snippets

browser.newtabpage.activity-stream.feeds.section.topstories

browser.newtabpage.activity-stream.section.highlights.includePocket

browser.newtabpage.activity-stream.feeds.section.highlights

Type about:config in the address bar

Type browser.urlbar.suggest.history in the filter

Configure the setting as prescribed.

Type browser.newtabpage.activity-stream.feeds.topsites in the filter

Configure the setting as prescribed.

Type browser.newtabpage.activity-stream.feeds.snippets in the filter

Configure the setting as prescribed.

Type browser.newtabpage.activity-stream.feeds.section.topstories in the filter

Configure the setting as prescribed.

Type browser.newtabpage.activity-stream.section.highlights.includePocket in the filter

Configure the setting as prescribed.

Type browser.newtabpage.activity-stream.feeds.section.highlights in the filter

Configure the setting as prescribed.

OR

Open the mozilla.cfg file in the installation directory with a text editor

Add the following lines to mozilla.cfg:

lockPref('browser.urlbar.suggest.history', false);
lockPref('browser.newtabpage.activity-stream.feeds.topsites', false);
lockPref('browser.newtabpage.activity-stream.feeds.snippets', false);
lockPref('browser.newtabpage.activity-stream.feeds.section.topstories', false);
lockPref('browser.newtabpage.activity-stream.section.highlights.includePocket', false);
lockPref('browser.newtabpage.activity-stream.feeds.section.highlights', false);

Default Value:

browser.urlbar.suggest.history = true

browser.newtabpage.activity-stream.feeds.topsites = true

browser.newtabpage.activity-stream.feeds.snippets = false

browser.newtabpage.activity-stream.feeds.section.topstories = true

browser.newtabpage.activity-stream.section.highlights.includePocket = true

browser.newtabpage.activity-stream.feeds.section.highlights = false"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|2M,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/4299"
      value_type  : POLICY_TEXT
      value_data  : "@MOZILLA_CONFIG@"
      regex       : '^[\\s]*lockPref\\("browser.newtabpage.activity-stream.section.highlights.includePocket",[\\s]*'
      expect      : '^[\\s]*lockPref\\("browser.newtabpage.activity-stream.section.highlights.includePocket",[\\s]*false\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "6.1 Configure New Tab Page - browser.newtabpage.activity-stream.feeds.section.highlights"
      info        : "The New Tab page shows a list of built-in top sites, as well as the top sites the user has visited by default.

Rationale:

Allowing the collection of browsing history by Firefox could inadvertently lead to sensitive data being exposed.

Impact:

Top site and user history will not be available on a new tab."
      solution    : "To establish the recommended configuration, set the following values to false:

browser.urlbar.suggest.history

browser.newtabpage.activity-stream.feeds.topsites

browser.newtabpage.activity-stream.feeds.snippets

browser.newtabpage.activity-stream.feeds.section.topstories

browser.newtabpage.activity-stream.section.highlights.includePocket

browser.newtabpage.activity-stream.feeds.section.highlights

Type about:config in the address bar

Type browser.urlbar.suggest.history in the filter

Configure the setting as prescribed.

Type browser.newtabpage.activity-stream.feeds.topsites in the filter

Configure the setting as prescribed.

Type browser.newtabpage.activity-stream.feeds.snippets in the filter

Configure the setting as prescribed.

Type browser.newtabpage.activity-stream.feeds.section.topstories in the filter

Configure the setting as prescribed.

Type browser.newtabpage.activity-stream.section.highlights.includePocket in the filter

Configure the setting as prescribed.

Type browser.newtabpage.activity-stream.feeds.section.highlights in the filter

Configure the setting as prescribed.

OR

Open the mozilla.cfg file in the installation directory with a text editor

Add the following lines to mozilla.cfg:

lockPref('browser.urlbar.suggest.history', false);
lockPref('browser.newtabpage.activity-stream.feeds.topsites', false);
lockPref('browser.newtabpage.activity-stream.feeds.snippets', false);
lockPref('browser.newtabpage.activity-stream.feeds.section.topstories', false);
lockPref('browser.newtabpage.activity-stream.section.highlights.includePocket', false);
lockPref('browser.newtabpage.activity-stream.feeds.section.highlights', false);

Default Value:

browser.urlbar.suggest.history = true

browser.newtabpage.activity-stream.feeds.topsites = true

browser.newtabpage.activity-stream.feeds.snippets = false

browser.newtabpage.activity-stream.feeds.section.topstories = true

browser.newtabpage.activity-stream.section.highlights.includePocket = true

browser.newtabpage.activity-stream.feeds.section.highlights = false"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|2M,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/4299"
      value_type  : POLICY_TEXT
      value_data  : "@MOZILLA_CONFIG@"
      regex       : '^[\\s]*lockPref\\("browser.newtabpage.activity-stream.feeds.section.highlights",[\\s]*'
      expect      : '^[\\s]*lockPref\\("browser.newtabpage.activity-stream.feeds.section.highlights",[\\s]*false\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "6.4 Disable Form Fill Assistance"
      info        : "Form Fill Assistance allows Firefox to save data that has been entered into forms by users so that future operations are performed faster.

Rationale:

This mitigates the risk of websites extracting information from prefilled text fields.

Impact:

Prefilled text fields will not be enabled."
      solution    : "To establish the recommended configuration, set browser.formfill.enable to false:

Type about:config in the address bar

Type browser.formfill.enable in the filter

Ensure the setting is set as prescribed.

OR

Open the mozilla.cfg file in the installation directory with a text editor

Add the following lines to mozilla.cfg:

lockPref('browser.formfill.enable', false);

Default Value:

True (Enabled)."
      reference   : "800-53|AU-11,800-53|SI-12,800-53r5|AU-11,800-53r5|CM-12,800-53r5|SI-12,CSCv8|3.1,CSF|PR.PT-1,CSF2.0|ID.AM-07,CSF2.0|ID.AM-08,CSF2.0|PR.PS-04,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-11,ITSG-33|SI-12,ITSG-33|SI-12a.,LEVEL|2M,NESA|M5.2.3,NESA|M5.2.4,NESA|M5.3.1,NESA|T3.6.2,NIAv2|DR1,NIAv2|DR1a,NIAv2|DR1b,NIAv2|DR1c,NIAv2|DR2,NIAv2|DR3,NIAv2|DR4,NIAv2|DR5,NIAv2|DR6,NIAv2|SM7,PCI-DSSv3.2.1|3.1,PCI-DSSv3.2.1|10.7,PCI-DSSv4.0|3.2.1,PCI-DSSv4.0|10.5.1,QCSC-v1|8.2.1,QCSC-v1|13.2"
      value_type  : POLICY_TEXT
      value_data  : "@MOZILLA_CONFIG@"
      regex       : '^[\\s]*lockPref\\("browser.formfill.enable",[\\s]*'
      expect      : '^[\\s]*lockPref\\("browser.formfill.enable",[\\s]*false\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>
  </then>

  <else>
    <report type:"WARNING">
      description : "CIS_Mozilla_Firefox_102_ESR_v1.0.0_Windows_Level2.audit for CIS Mozilla Firefox 102 ESR v1.0.0"
      info        : "Firefox is not installed or remote registry service is disabled.
      NOTE: Nessus has not identified that the chosen audit applies to the target device."
      see_also    : "https://workbench.cisecurity.org/files/4299"
    </report>
  </else>
</if>

</group_policy>
</check_type>
