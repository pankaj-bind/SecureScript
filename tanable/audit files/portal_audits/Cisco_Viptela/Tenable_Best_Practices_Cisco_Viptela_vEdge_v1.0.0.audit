#TRUSTED 46f4704cd1e944ee664eb681c880fc7ffcfeb96a1f37fa58b808a49197cfa5480db3d01afeb015dbb0106469e59ec54bd790e9c6b5945263da31bc675c8064bf3d048d4d5e26a307ed1674fbb161fbfd3b2ea8c21f8b184b654ef2dc5a73107fa68d7a8eb4d12500f9b62ddb5ea4840101c9922abd2265a9d0005e17593721a0000e2a3b48eb247767c1b1d21b5144f1509e3e9e822ea0dcd905b49033dc63b0e985f3c5b082ba4f7cfd4cde7d48b305dc5230eef9294a8888cb3ec5859ed3785d9c45e5cb0ac2c0c765ae47be0aa4dcd1c6c068466973788a85a6a916eff48c4788ca895130bfbf464b3cafbcd48ad571e62999090526f6c73c68aecbcaacd10cddd7f50abecc55a78153cee510a735ba5480f509b6c39f60b76140d81b11c05c1fe7c64b697d72684a700f590654bdd00da1dc339e877844260494e106dda0b52c7da0a7ddfceed2874dc230b5a8f9980a87403167fe8ca2efeb70a52f1e72b1b09c66997ec7224b30d245616fa811065f380aaa18e75e1ba3ac576b784548a77314070164b44c5c02fdeda3961628b17f24e26a66d6a7fdfdcc576a79ccfd267737942b1a424e1b47b4a3e3e495cb9dcf93a6c476bb96c8bbd542bd7c7b0cb3d65790be357e96df56ac970eda4a163393ac60b8308bb19867161352d31544c7caa35de3668db4bbc1aef930e845a852073af8c68891479fd7354b14900942
#TRUST-RSA-SHA256 3486e56b59085eeff9618d98b8f84892680ba11963fbe34188a35b57da8fde97dfc78d3ac1223cbba53b0fff0ac5e3e14377d01a3de82804a87801b5503c90fea00f79eea6c73de2ef92c112f9fe49c61c47239c1f5ba1deba901ea490050097c3005b4d2e452e757d04cb894cac1228ddddbd26bcb525c3656e1fdeacfb45b8ed96b0dc7e374b114111d5c2beaf5c80c7a2a1f1bf1d5ca4e5b60044216ae26efb0ca1c2f78b5bb056f12a2582261588f984c2dd773e9c9a6dd0ec57b595966bad0bf7d652c19a6378259796dfd42da6cbf9686bb83b6dc4673cd1c855cdbe2e6dd596f9e8870513aa6278bb3b85d680d3bf69231208802b17bddaf7b88c88af31ee06e4d0a50a202c914ad4228b9c3cb9dcf9b9b88e4c26885e6cbd4647b920b6cbc9e327bbb60c580f31c926ea2bc461a0e5590d81680c4eb54dbedfc16aea285e23f52f3a742c7d4d3ef4dff7b126f10cf33466e8510ddebdb98a4d1166c521f4e8c0c41364fd4f5362a4abe1551db0f578f9fc30fc5b793f97f908125379d415db48bfc5034a1347bbfd912be54426f51e8c2408561339c2821456d09ac5833e4337dcbdf18b38ee686ec56ddf406af3afdb1dcfa990c3f0cc11fb84ba39fa36c0b78a892aea8e6b7a85548551b28db5b337bbb330ce4553b951191a2212956f70b126625e3fbcdcb10664d674230236dd90b5fc23f9db1376ff945579a2
#
# This script is Copyright (C) 2004-2024 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
# $Revision: 1.4 $
# $Date: 2024/06/17 $
#
#<ui_metadata>
#<display_name>Tenable Cisco Viptela SD-WAN - vEdge</display_name>
#<spec>
#  <type>TNS</type>
#  <name>Cisco Viptela SD-WAN</name>
#  <profile>vEdge</profile>
#  <version>1.0.0</version>
#</spec>
#<labels>cisco,cisco_viptela,sd-wan,vedge,update_20230227</labels>
#<benchmark_refs>800-53</benchmark_refs>
#<variables>
#  <variable>
#    <name>BANNER_LOGIN</name>
#    <default>Notice: All actions are monitored and logged. By logging in you agree to these terms.</default>
#    <description>Banner login text</description>
#    <info>The prelogin banner text.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>BANNER_MOTD</name>
#    <default>Notice: All actions are monitored and logged. By logging in you agree to these terms.</default>
#    <description>Banner MOTD text</description>
#    <info>The postlogin banner text.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>IDLE_CLI_TIMEOUT</name>
#    <default>5</default>
#    <description>Idle CLI Timeout</description>
#    <info>Idle timeout to terminate a user session, in minutes.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>SYSLOG_SERVER</name>
#    <default>192.168.100.1</default>
#    <description>Syslog Server Address</description>
#    <info>The remote syslog server address.</info>
#    <value_type>HOSTNAME_IP_ADDRESS</value_type>
#  </variable>
#  <variable>
#    <name>SYSLOG_PRIORITY_LEVEL</name>
#    <default>informational</default>
#    <description>Syslog Server Priority Level</description>
#    <info>The remote syslog logging priority level. Default is informational.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>DISK_PRIORITY_LEVEL</name>
#    <default>informational</default>
#    <description>Disk Logging Priroty Level</description>
#    <info>The local disk logging priority level. Default is informational.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>DISK_FILE_ROTATE</name>
#    <default>10</default>
#    <description>Disk Logging File Rotation</description>
#    <info>The number of disk logging file rotations. Default is 10.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>DISK_FILE_SIZE</name>
#    <default>20</default>
#    <description>Disk Logging File Size</description>
#    <info>The size of each disk logging file. Default is 10.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>TIMEZONE</name>
#    <default>America/Chicago</default>
#    <description>Timezone</description>
#    <info>The timezone used for time and logging purposes.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>BACKUP_INTERVAL</name>
#    <default>1440</default>
#    <description>Backup Interval Minutes</description>
#    <info>Backup interval in minutes. Default is 10080.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>IPSEC_REKEY_SECONDS</name>
#    <default>86400</default>
#    <description>IPsec rekeying time seconds.</description>
#    <info>IPsec rekeying time. Default is 86400.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>IPSEC_REPLAY_WINDOW</name>
#    <default>512</default>
#    <description>IPsec sliding replay window.</description>
#    <info>IPsec sliding replay window. Default is 512.</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>IKE_REKEY_SECONDS</name>
#    <default>3600</default>
#    <description>IKE key refresh time.</description>
#    <info>IKE key refresh time. Recommended interval is at least 1 hour (3600).</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>INTERFACE_IPSEC_REKEY_SECONDS</name>
#    <default>14400</default>
#    <description>Interface IPsec rekeying time seconds.</description>
#    <info>Interface IPsec rekeying time. Default is 14400</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>INTERFACE_IPSEC_REPLAY_WINDOW</name>
#    <default>512</default>
#    <description>Interface IPsec replay window.</description>
#    <info>Interface IPsec replay window. Default is 512</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>DEAD_PEER_INTERVAL</name>
#    <default>30</default>
#    <description>Dead-peer detection interval.</description>
#    <info>Dead-peer detection interval. Default is 30</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>DEAD_PEER_RETRIES</name>
#    <default>10</default>
#    <description>Dead-peer retries interval.</description>
#    <info>Dead-peer retries interval. Default is 10</info>
#    <value_type>STRING</value_type>
#  </variable>
#</variables>
#</ui_metadata>

<check_type:"Cisco_Viptela">

<custom_item>
  type        : CONFIG_CHECK
  description : "Account Management - Review disabled user accounts"
  info        : "Information system account types include, for example, individual, shared, group, system, guest/anonymous, emergency, developer/manufacturer/vendor, temporary, and service.

  NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Conditions for disabling or deactivating accounts include, for example: (i) when shared/group, emergency, or temporary accounts are no longer required; or (ii) when individuals are transferred or terminated. Some types of information system accounts may require specialized training."
  reference   : "800-171|3.1.1,800-53|AC-2,800-53r5|AC-2,CN-L3|7.1.3.2(d),CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2"
  context     : "^\s*system"
  context     : "^\s*aaa"
  context     : "^\s*user\s+"
  item        : "^\s*status\s+disabled"
  severity    : MEDIUM
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Account Management - Review account groups assigned to 'netadmin'"
  info        : "Information system account types include, for example, individual, shared, group, system, guest/anonymous, emergency, developer/manufacturer/vendor, temporary, and service.

  NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "The identification of authorized users of the information system and the specification of access privileges reflects the requirements in other security controls in the security plan. Users requiring administrative privileges on information system accounts receive additional scrutiny by appropriate organizational personnel (e.g., system owner, mission/business owner, or chief information security officer) responsible for approving such accounts and privileged access. Organizations may choose to define access privileges or other attributes by account, by type of account, or a combination of both."
  reference   : "800-171|3.1.1,800-53|AC-2,800-53r5|AC-2,CN-L3|7.1.3.2(d),CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2"
  context     : "^\s*system"
  context     : "^\s*aaa"
  context     : "^\s*user\s+"
  item        : "^\s*group\s+netadmin"
  severity    : MEDIUM
</custom_item>

<custom_item>
  type        : BANNER_CHECK
  description : "System Use Notification - Banner Login"
  info        : "System use notifications can be implemented using messages or warning banners displayed before individuals log in to information systems."
  solution    : "System use notifications are used only for access via logon interfaces with human users and are not required when such human interfaces do not exist."
  reference   : "800-171|3.1.9,800-53|AC-8,800-53r5|AC-8,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-8,NESA|M1.3.6,TBA-FIISB|45.2.4"
  item        : "^\s*login"
  content     : "@BANNER_LOGIN@"
</custom_item>

<custom_item>
  type        : BANNER_CHECK
  description : "System Use Notification - Banner motd"
  info        : "System use notifications can be implemented using messages or warning banners displayed before individuals log in to information systems."
  solution    : "System use notifications are used only for access via logon interfaces with human users and are not required when such human interfaces do not exist."
  reference   : "800-171|3.1.9,800-53|AC-8,800-53r5|AC-8,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-8,NESA|M1.3.6,TBA-FIISB|45.2.4"
  item        : "^\s*motd"
  content     : "@BANNER_MOTD@"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Session Termination - Configure Idle CLI timeout"
  info        : "The information system automatically terminates a user session after organization-defined conditions or trigger events requiring session disconnect."
  solution    : "Session termination terminates all processes associated with a user's logical session except those processes that are specifically created by the user (i.e., session owner) to continue after the session is terminated. Conditions or trigger events requiring automatic session termination can include, for example, organization-defined periods of user inactivity, targeted responses to certain types of incidents, time-of-day restrictions on information system use."
  reference   : "800-171|3.1.11,800-53|AC-12,800-53r5|AC-12,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ITSG-33|AC-12,NIAv2|NS49"
  context     : "^\s*system"
  item        : "^\s*idle-timeout @IDLE_CLI_TIMEOUT@"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Event Logging - Configure remote syslog - server"
  info        : "An event is any observable occurrence in an organizational information system. Organizations identify audit events as those events which are significant and relevant to the security of information systems and the environments in which those systems operate in order to meet specific and ongoing audit needs."
  solution    : "In determining the set of auditable events, organizations consider the auditing appropriate for each of the security controls to be implemented. To balance auditing requirements with other information system needs, this control also requires identifying that subset of auditable events that are audited at a given point in time."
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-2,800-53r5|AU-2,CN-L3|8.1.4.3(a),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-2,NESA|M1.2.2,NESA|M5.5.1,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|SS30,NIAv2|VL8,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4"
  context     : "^\s*system"
  context     : "^\s*logging"
  item        : "^\s*server @SYSLOG_SERVER@"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Content of Audit Records - Configure remote syslog - priority level"
  info        : "The information system generates audit records containing information that establishes what type of event occurred, when the event occurred, where the event occurred, the source of the event, the outcome of the event, and the identity of any individuals or subjects associated with the event."
  solution    : "Audit record content that may be necessary to satisfy the requirement of this control, includes, for example, time stamps, source and destination addresses, user/process identifiers, event descriptions, success/fail indications, filenames involved, and access control or flow control rules invoked. Event outcomes can include indicators of event success or failure and event-specific results (e.g., the security state of the information system after the event occurred)."
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-3,800-53r5|AU-3,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.3.3(a),CN-L3|8.1.4.3(b),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4"
  context     : "^\s*system"
  context     : "^\s*logging"
  context     : "^\s*server @SYSLOG_SERVER@"
  item        : "^\s*priority @SYSLOG_PRIORITY_LEVEL@"
  required    : NO
</custom_item>

<custom_item>
  type        : CONFIG_CHECK_NOT
  description : "Content of Audit Records - Configure disk logging - enable"
  info        : "The information system generates audit records containing information that establishes what type of event occurred, when the event occurred, where the event occurred, the source of the event, the outcome of the event, and the identity of any individuals or subjects associated with the event."
  solution    : "Audit record content that may be necessary to satisfy the requirement of this control, includes, for example, time stamps, source and destination addresses, user/process identifiers, event descriptions, success/fail indications, filenames involved, and access control or flow control rules invoked. Event outcomes can include indicators of event success or failure and event-specific results (e.g., the security state of the information system after the event occurred)."
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-3,800-53r5|AU-3,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.3.3(a),CN-L3|8.1.4.3(b),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4"
  context     : "^\s*system"
  context     : "^\s*logging"
  context     : "^\s*disk"
  item        : "^\s*no enable"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Content of Audit Records - Configure disk logging - priority level"
  info        : "The information system generates audit records containing information that establishes what type of event occurred, when the event occurred, where the event occurred, the source of the event, the outcome of the event, and the identity of any individuals or subjects associated with the event."
  solution    : "Audit record content that may be necessary to satisfy the requirement of this control, includes, for example, time stamps, source and destination addresses, user/process identifiers, event descriptions, success/fail indications, filenames involved, and access control or flow control rules invoked. Event outcomes can include indicators of event success or failure and event-specific results (e.g., the security state of the information system after the event occurred)."
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-3,800-53r5|AU-3,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.3.3(a),CN-L3|8.1.4.3(b),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4"
  context     : "^\s*system"
  context     : "^\s*logging"
  context     : "^\s*disk"
  item        : "^\s*priority @DISK_PRIORITY_LEVEL@"
  required    : NO
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Content of Audit Records - Configure disk logging - file size"
  info        : "The information system generates audit records containing information that establishes what type of event occurred, when the event occurred, where the event occurred, the source of the event, the outcome of the event, and the identity of any individuals or subjects associated with the event."
  solution    : "Audit record content that may be necessary to satisfy the requirement of this control, includes, for example, time stamps, source and destination addresses, user/process identifiers, event descriptions, success/fail indications, filenames involved, and access control or flow control rules invoked. Event outcomes can include indicators of event success or failure and event-specific results (e.g., the security state of the information system after the event occurred)."
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-3,800-53r5|AU-3,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.3.3(a),CN-L3|8.1.4.3(b),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4"
  context     : "^\s*system"
  context     : "^\s*logging"
  context     : "^\s*disk"
  item        : "^\s*file size @DISK_FILE_SIZE@"
  required    : NO
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Content of Audit Records - Configure disk logging - file rotate"
  info        : "The information system generates audit records containing information that establishes what type of event occurred, when the event occurred, where the event occurred, the source of the event, the outcome of the event, and the identity of any individuals or subjects associated with the event."
  solution    : "Audit record content that may be necessary to satisfy the requirement of this control, includes, for example, time stamps, source and destination addresses, user/process identifiers, event descriptions, success/fail indications, filenames involved, and access control or flow control rules invoked. Event outcomes can include indicators of event success or failure and event-specific results (e.g., the security state of the information system after the event occurred)."
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-3,800-53r5|AU-3,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.3.3(a),CN-L3|8.1.4.3(b),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4"
  context     : "^\s*system"
  context     : "^\s*logging"
  context     : "^\s*disk"
  item        : "^\s*file size @DISK_FILE_ROTATE@"
  required    : NO
</custom_item>

<custom_item>
  type            : CONFIG_CHECK
  description     : "Time Stamps - Enable NTP - remote server"
  info            : "Time stamps generated by the information system include date and time. Time is commonly expressed in Coordinated Universal Time (UTC), a modern continuation of Greenwich Mean Time (GMT), or local time with an offset from UTC."
  solution        : "Time service can also be critical to other security capabilities such as access control and identification and authentication, depending on the nature of the mechanisms used to support those capabilities."
  reference       : "800-171|3.3.7,800-53|AU-8,800-53r5|AU-8,CN-L3|8.1.4.3(b),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-8,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,TBA-FIISB|37.4"
  context         : "^\s*system"
  context         : "^\s*ntp"
  item            : "^\s*server .+"
  min_occurrences : "1"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Time Stamps - Enable NTP - timezone"
  info        : "Time stamps generated by the information system include date and time. Time is commonly expressed in Coordinated Universal Time (UTC), a modern continuation of Greenwich Mean Time (GMT), or local time with an offset from UTC."
  solution    : "Time service can also be critical to other security capabilities such as access control and identification and authentication, depending on the nature of the mechanisms used to support those capabilities."
  reference   : "800-171|3.3.7,800-53|AU-8,800-53r5|AU-8,CN-L3|8.1.4.3(b),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-8,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,TBA-FIISB|37.4"
  context     : "^\s*system"
  item        : "^\s*clock timezone @TIMEZONE@"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "System Backup - Enable Backups - interval"
  info        : "System-level information includes, for example, system-state information, operating system and application software, and licenses. User-level information includes any information other than system-level information. Mechanisms employed by organizations to protect the integrity of information system backups include, for example, digital signatures and cryptographic hashes."
  solution    : "Protection of system backup information while in transit is beyond the scope of this control. Information system backups reflect the requirements in contingency plans as well as other organizational requirements for backing up information."
  reference   : "800-171|3.8.9,800-53|CP-9,800-53r5|CP-9,CSF|PR.IP-4,GDPR|32.1.b,GDPR|32.1.c,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.3.1,ITSG-33|CP-9,NESA|M5.2.3,NESA|T2.2.4"
  context     : "^\s*system"
  context     : "^\s*archive"
  item        : "^\s*interval @BACKUP_INTERVAL@"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "System Backup - Enable Backups - path"
  info        : "System-level information includes, for example, system-state information, operating system and application software, and licenses. User-level information includes any information other than system-level information. Mechanisms employed by organizations to protect the integrity of information system backups include, for example, digital signatures and cryptographic hashes."
  solution    : "Protection of system backup information while in transit is beyond the scope of this control. Information system backups reflect the requirements in contingency plans as well as other organizational requirements for backing up information."
  reference   : "800-171|3.8.9,800-53|CP-9,800-53r5|CP-9,CSF|PR.IP-4,GDPR|32.1.b,GDPR|32.1.c,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.3.1,ITSG-33|CP-9,NESA|M5.2.3,NESA|T2.2.4"
  context     : "^\s*system"
  context     : "^\s*archive"
  item        : "^\s*path .+"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK_NOT
  description : "Identification and Authentication - Use out of band authentication - AAA - audit logging"
  info        : "The information system uniquely identifies and authenticates organizational users (or processes acting on behalf of organizational users)."
  solution    : "Organizational users include employees or individuals that organizations deem to have equivalent status of employees (e.g., contractors, guest researchers). Organizations may require unique identification of individuals in group accounts (e.g., shared privilege accounts) or for detailed accountability of individual activity. Organizations employ passwords, tokens, or biometrics to authenticate user identities, or in the case multifactor authentication, or some combination thereof. Access to organizational information systems is defined as either local access or network access."
  reference   : "800-171|3.5.1,800-53|IA-2,800-53r5|IA-2,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  context     : "^\s*system"
  context     : "^\s*aaa"
  item        : "^\s*audit-disable"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK_NOT
  description : "Identification and Authentication - Use out of band authentication - AAA - netconf logging"
  info        : "The information system uniquely identifies and authenticates organizational users (or processes acting on behalf of organizational users)."
  solution    : "Organizational users include employees or individuals that organizations deem to have equivalent status of employees (e.g., contractors, guest researchers). Organizations may require unique identification of individuals in group accounts (e.g., shared privilege accounts) or for detailed accountability of individual activity. Organizations employ passwords, tokens, or biometrics to authenticate user identities, or in the case multifactor authentication, or some combination thereof. Access to organizational information systems is defined as either local access or network access."
  reference   : "800-171|3.5.1,800-53|IA-2,800-53r5|IA-2,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  context     : "^\s*system"
  context     : "^\s*aaa"
  item        : "^\s*netconf-disable"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Identification and Authentication - Use out of band authentication - Server IP"
  info        : "The information system uniquely identifies and authenticates organizational users (or processes acting on behalf of organizational users)."
  solution    : "Organizational users include employees or individuals that organizations deem to have equivalent status of employees (e.g., contractors, guest researchers). Organizations may require unique identification of individuals in group accounts (e.g., shared privilege accounts) or for detailed accountability of individual activity. Organizations employ passwords, tokens, or biometrics to authenticate user identities, or in the case multifactor authentication, or some combination thereof. Access to organizational information systems is defined as either local access or network access."
  reference   : "800-171|3.5.1,800-53|IA-2,800-53r5|IA-2,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  context     : "^\s*system"
  context     : "^\s*(radius|tacacs)"
  item        : "^\s*server .+"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Identification and Authentication - Use out of band authentication - Authentication Order"
  info        : "The information system uniquely identifies and authenticates organizational users (or processes acting on behalf of organizational users)."
  solution    : "Organizational users include employees or individuals that organizations deem to have equivalent status of employees (e.g., contractors, guest researchers). Organizations may require unique identification of individuals in group accounts (e.g., shared privilege accounts) or for detailed accountability of individual activity. Organizations employ passwords, tokens, or biometrics to authenticate user identities, or in the case multifactor authentication, or some combination thereof. Access to organizational information systems is defined as either local access or network access."
  reference   : "800-171|3.5.1,800-53|IA-2,800-53r5|IA-2,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  context     : "^\s*system"
  context     : "^\s*aaa"
  item        : "^\s*(radius|tacacs){1,}\s+local$"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Identification and Authentication - Use out of band authentication - Admin Authentication Order"
  info        : "The information system uniquely identifies and authenticates organizational users (or processes acting on behalf of organizational users)."
  solution    : "Organizational users include employees or individuals that organizations deem to have equivalent status of employees (e.g., contractors, guest researchers). Organizations may require unique identification of individuals in group accounts (e.g., shared privilege accounts) or for detailed accountability of individual activity. Organizations employ passwords, tokens, or biometrics to authenticate user identities, or in the case multifactor authentication, or some combination thereof. Access to organizational information systems is defined as either local access or network access."
  reference   : "800-171|3.5.1,800-53|IA-2,800-53r5|IA-2,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  context     : "^\s*system"
  context     : "^\s*aaa"
  item        : "^\s*admin-auth-order"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Secure Name/address Resolution Service - Configure DNS servers - Primary"
  info        : "The information system requests and performs data origin authentication and data integrity verification on the name/address resolution responses the system receives from authoritative sources."
  solution    : "Each client of name resolution services either performs this validation on its own, or has authenticated channels to trusted validation providers. Information systems that provide name and address resolution services for local clients include, for example, recursive resolving or caching domain name system (DNS) servers."
  reference   : "800-53|SC-21,800-53r5|SC-21,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-21,ITSG-33|SC-21a.,NESA|T4.5.1,QCSC-v1|5.2.1"
  context     : "^\s*vpn .+"
  item        : "^\s*dns .+ primary"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Secure Name/address Resolution Service - Configure DNS servers - Secondary"
  info        : "The information system requests and performs data origin authentication and data integrity verification on the name/address resolution responses the system receives from authoritative sources."
  solution    : "Each client of name resolution services either performs this validation on its own, or has authenticated channels to trusted validation providers. Information systems that provide name and address resolution services for local clients include, for example, recursive resolving or caching domain name system (DNS) servers."
  reference   : "800-53|SC-21,800-53r5|SC-21,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-21,ITSG-33|SC-21a.,NESA|T4.5.1,QCSC-v1|5.2.1"
  context     : "^\s*vpn .+"
  item        : "^\s*dns .+ Secondary"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "Flaw Remediation - Review version of running image"
  info        : "Organizations identify information systems affected by announced software flaws including potential vulnerabilities resulting from those flaws, and report this information to designated organizational personnel with information security responsibilities. Security-relevant software updates include, for example, patches, service packs, hot fixes, and anti-virus signatures.

  NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "By incorporating flaw remediation into ongoing configuration management processes, required/anticipated remediation actions can be tracked and verified. Flaw remediation actions that can be tracked and verified include, for example, determining whether organizations follow US-CERT guidance and Information Assurance Vulnerability Alerts. Organization-defined time periods for updating security-relevant software and firmware may vary based on a variety of factors including, for example, the security category of the information system or the criticality of the update (i.e., severity of the vulnerability related to the discovered flaw)."
  reference   : "800-171|3.4.1,800-53|CM-8a.,800-53r5|CM-8a.,CN-L3|8.1.10.2(a),CN-L3|8.1.10.2(b),CSF|DE.CM-7,CSF|ID.AM-1,CSF|ID.AM-2,CSF|PR.DS-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.8.1.1,ITSG-33|CM-8,NESA|T1.2.1,NESA|T1.2.2,NIAv2|NS35,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1"
  cmd         : "show version"
  regex       : ".*"
  expect      : "Manual Review Required"
  severity    : MEDIUM
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Configure Allowed Authentication Types"
  info        : "By default, IPsec tunnel connections use a modified version of the Encapsulating Security Payload (ESP) protocol for authentication.

By default, IPsec tunnel connections use AES-GCM-256, which provides both encryption and authentication.

Configure each authentication type with a separate security ipsec authentication-type command. The command options map to the following authentication types, which are listed in order from most strong to least strong:

- ah-sha1-hmac: enables encryption and encapsulation using ESP. However, in addition to the integrity checks on the ESP header and payload, the checks also include the outer IP and UDP headers. Hence, this option supports an integrity check of the packet similar to the Authentication Header (AH) protocol. All integrity and encryption is performed using AES-256-GCM.
- ah-no-id: enables a mode that is similar to ah-sha1-hmac, however the ID field of the outer IP header is ignored. This option accommodates some non-Cisco SD-WAN devices, including the Apple AirPort Express NAT, that have a bug that causes the ID field in the IP header, a non-mutable field, to be modified. Configure the ah-no-id option in the list of authentication types to have the Cisco SD-WAN AH software ignore the ID field in the IP header so that the Cisco SD-WAN software can work in conjunction with these devices.
- sha1-hmac: enables ESP encryption and integrity checking.
- none maps: to no authentication. This option should only be used if it is required for temporary debugging. You can also choose this option in situations where data plane authentication and integrity are not a concern. Cisco does not recommend using this option for production networks.

See https://www.cisco.com/c/en/us/td/docs/routers/sdwan/configuration/security/vedge-20-x/security-book/config-sec-param.html for more information."
  solution    : "vEdge(config)# security ipsec authentication-type ah-sha1-hmac"
  reference   : "800-171|3.13.11,800-53|SC-13,800-53r5|SC-13,CSF|PR.DS-5,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2"
  context     : "^\s*security"
  context     : "^\s*ipsec"
  item        : "^\s*authentication-type\s+ah-sha1-hmac"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Change the Rekeying Timer"
  info        : "Specify how often a Cisco vEdge router changes the AES key used on its secure DTLS connection to the vSmart controller. If OMP graceful restart is enabled, the rekeying time must be at least twice the value of the OMP graceful restart timer.

Range: 10 through 1209600 seconds (14 days)

Default: 86400 seconds (24 hours)

See https://www.cisco.com/c/en/us/td/docs/routers/sdwan/configuration/security/vedge-20-x/security-book/config-sec-param.html for more information."
  solution    : "vEdge(config)# security ipsec rekey seconds"
  reference   : "800-171|3.1.3,800-53|AC-4,800-53r5|AC-4,CN-L3|8.1.10.2(c),CSF|DE.AE-1,CSF|ID.AM-3,CSF|PR.AC-4,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-4,NESA|T4.2.1,NESA|T4.5.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.4.6,NESA|T5.7.2,NESA|T7.5.2,NESA|T7.6.4,NIAv2|GS11a,NIAv2|GS12a,NIAv2|GS14a,NIAv2|GS15a,NIAv2|GS16a,NIAv2|NS13a,NIAv2|NS13b,NIAv2|NS13c,NIAv2|NS14,NIAv2|SS23,NIAv2|SS27a,NIAv2|SS27b,NIAv2|SS32,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.4"
  context     : "^\s*security"
  context     : "^\s*ipsec"
  item        : "^\s*rekey\s+@IPSEC_REKEY_SECONDS@"
  required    : NO
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Change the Size of the Anti-Replay Window"
  info        : "Specify the size of the sliding replay window.

Values: 64, 128, 256, 512, 1024, 2048, 4096, 8192 packets

Default: 512 packets

See https://www.cisco.com/c/en/us/td/docs/routers/sdwan/configuration/security/vedge-20-x/security-book/config-sec-param.html for more information."
  solution    : "vEdge(config)# security ipsec replay-window number"
  reference   : "800-171|3.1.3,800-53|AC-4,800-53r5|AC-4,CN-L3|8.1.10.2(c),CSF|DE.AE-1,CSF|ID.AM-3,CSF|PR.AC-4,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-4,NESA|T4.2.1,NESA|T4.5.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.4.6,NESA|T5.7.2,NESA|T7.5.2,NESA|T7.6.4,NIAv2|GS11a,NIAv2|GS12a,NIAv2|GS14a,NIAv2|GS15a,NIAv2|GS16a,NIAv2|NS13a,NIAv2|NS13b,NIAv2|NS13c,NIAv2|NS14,NIAv2|SS23,NIAv2|SS27a,NIAv2|SS27b,NIAv2|SS32,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.4"
  context     : "^\s*security"
  context     : "^\s*ipsec"
  item        : "^\s*replay-window\s+@IPSEC_REPLAY_WINDOW@"
  required    : NO
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Configure an IPsec Tunnel"
  info        : "To configure an IPsec tunnel interface for secure transport traffic from a service network, you create a logical IPsec interface.

You can create the IPsec tunnel in the transport VPN (VPN 0) and in any service VPN (VPN 1 through 65530, except for 512).

The IPsec interface has a name in the format ipsecnumber, where number can be from 1 through 255.

Each IPsec interface must have an IPv4 address. This address must be a /30 prefix. All traffic in the VPN that is within this IPv4 prefix is directed to a physical interface in VPN 0 to be sent securely over an IPsec tunnel.

See https://www.cisco.com/c/en/us/td/docs/routers/sdwan/configuration/security/vedge-20-x/security-book/config-sec-param.html for more information.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "vEdge(config)# vpn vpn-id interface ipsecnumber
vEdge(config-interface-ipsec)# ip address ipv4-prefix/length
vEdge(config-interface-ipsec)# (tunnel-source ip-address | tunnel-source-interface interface-name)
vEdge(config-interface-ipsec)# tunnel-destination ipv4-address
vEdge(config-interface-ipsec)# no shutdown"
  reference   : "800-171|3.1.3,800-53|AC-4,800-53r5|AC-4,CN-L3|8.1.10.2(c),CSF|DE.AE-1,CSF|ID.AM-3,CSF|PR.AC-4,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-4,NESA|T4.2.1,NESA|T4.5.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.4.6,NESA|T5.7.2,NESA|T7.5.2,NESA|T7.6.4,NIAv2|GS11a,NIAv2|GS12a,NIAv2|GS14a,NIAv2|GS15a,NIAv2|GS16a,NIAv2|NS13a,NIAv2|NS13b,NIAv2|NS13c,NIAv2|NS14,NIAv2|SS23,NIAv2|SS27a,NIAv2|SS27b,NIAv2|SS32,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.4"
  context     : "^\s*vpn .+"
  context     : "^\s*interface ipsec.+"
  regex       : ".*"
  item        : "Manual Review Required"
  severity    : MEDIUM
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Configure an IPsec Static Route"
  info        : "To direct traffic from the service VPN to an IPsec tunnel in the transport VPN (VPN 0), you configure an IPsec-specific static route in a service VPN (a VPN other than VPN 0 or VPN 512).

See https://www.cisco.com/c/en/us/td/docs/routers/sdwan/configuration/security/vedge-20-x/security-book/config-sec-param.html for more information.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "vEdge(config)# vpn vpn-id
vEdge(config-vpn)# ip ipsec-route prefix/length vpn 0 interface ipsecnumber [ipsecnumber2]"
  reference   : "800-171|3.1.3,800-53|AC-4,800-53r5|AC-4,CN-L3|8.1.10.2(c),CSF|DE.AE-1,CSF|ID.AM-3,CSF|PR.AC-4,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-4,NESA|T4.2.1,NESA|T4.5.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.4.6,NESA|T5.7.2,NESA|T7.5.2,NESA|T7.6.4,NIAv2|GS11a,NIAv2|GS12a,NIAv2|GS14a,NIAv2|GS15a,NIAv2|GS16a,NIAv2|NS13a,NIAv2|NS13b,NIAv2|NS13c,NIAv2|NS14,NIAv2|SS23,NIAv2|SS27a,NIAv2|SS27b,NIAv2|SS32,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.4"
  context     : "^\s*vpn .+"
  regex       : "ip ipsec-route .*"
  item        : "Manual Review Required"
  severity    : MEDIUM
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Enable IKE Version 1/2 - rekey"
  info        : "By default, IKE keys are refreshed every 4 hours (14,400 seconds). You can change the rekeying interval to a value from 30 seconds through 14 days (1209600 seconds).

See https://www.cisco.com/c/en/us/td/docs/routers/sdwan/configuration/security/vedge-20-x/security-book/config-sec-param.html for more information."
  solution    : "vEdge(config)# vpn vpn-id interface ipsecnumber ike
vEdge(config-ike)#  rekey seconds

To force the generation of new keys for an IKE session, issue the request ipsec ike-rekey command."
  reference   : "800-171|3.1.3,800-53|AC-4,800-53r5|AC-4,CN-L3|8.1.10.2(c),CSF|DE.AE-1,CSF|ID.AM-3,CSF|PR.AC-4,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-4,NESA|T4.2.1,NESA|T4.5.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.4.6,NESA|T5.7.2,NESA|T7.5.2,NESA|T7.6.4,NIAv2|GS11a,NIAv2|GS12a,NIAv2|GS14a,NIAv2|GS15a,NIAv2|GS16a,NIAv2|NS13a,NIAv2|NS13b,NIAv2|NS13c,NIAv2|NS14,NIAv2|SS23,NIAv2|SS27a,NIAv2|SS27b,NIAv2|SS32,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.4"
  context     : "^\s*vpn .+"
  context     : "^\s*interface ipsec.+"
  context     : "^\s*ike"
  item        : "^\s*rekey\s+@IKE_REKEY_SECONDS@"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Enable IKE Version 1/2 - cipher-suite"
  info        : "By default, IKE key exchange uses AES-256 advanced encryption standard CBC encryption with the HMAC-SHA1 keyed-hash message authentication code algorithm for integrity.

See https://www.cisco.com/c/en/us/td/docs/routers/sdwan/configuration/security/vedge-20-x/security-book/config-sec-param.html for more information."
  solution    : "You can change the authentication:

vEdge(config)# vpn vpn-id interface ipsecnumber ike
vEdge(config-ike)# cipher-suite suite
The authentication suite can be one of the following:

- aes128-cbc-sha1-AES-128 advanced encryption standard CBC encryption with the HMAC-SHA1 keyed-hash message authentication code algorithm for integrity
- aes128-cbc-sha2-AES-128 advanced encryption standard CBC encryption with the HMAC-SHA256 keyed-hash message authentication code algorithm for integrity
- aes256-cbc-sha1-AES-256 advanced encryption standard CBC encryption with the HMAC-SHA1 keyed-hash message authentication code algorithm for integrity; this is the default.
- aes256-cbc-sha2-AES-256 advanced encryption standard CBC encryption with the HMAC-SHA256 keyed-hash message authentication code algorithm for integrity"
  reference   : "800-171|3.13.11,800-53|SC-13,800-53r5|SC-13,CSF|PR.DS-5,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2"
  context     : "^\s*vpn .+"
  context     : "^\s*interface ipsec.+"
  context     : "^\s*ike"
  item        : "^\s*cipher-suite\s+aes256-cbc-sha2-AES-256"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Enable IKE Version 1/2 - group"
  info        : "By default, IKEv2 uses Diffie-Hellman group 16 in the IKE key exchange. This group uses the 4096-bit more modular exponential (MODP) group during IKE key exchange.

See https://www.cisco.com/c/en/us/td/docs/routers/sdwan/configuration/security/vedge-20-x/security-book/config-sec-param.html for more information."
  solution    : "You can change the group number to 2 (for 1024-bit MODP), 14 (2048-bit MODP), or 15 (3072-bit MODP):

vEdge(config)# vpn vpn-id interface ipsecnumber ike
vEdge(config-ike)# group number"
  reference   : "800-171|3.13.11,800-53|SC-13,800-53r5|SC-13,CSF|PR.DS-5,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2"
  context     : "^\s*vpn .+"
  context     : "^\s*interface ipsec.+"
  context     : "^\s*ike"
  item        : "^\s*group\s+1[45]"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Configure IPsec Tunnel Parameters - cipher-suite"
  info        : "You can change the encryption on the IPsec tunnel to the AES-256 cipher in CBC (cipher block chaining mode, with HMAC using either SHA-1 or SHA-2 keyed-hash message authentication or to null with HMAC using either SHA-1 or SHA-2 keyed-hash message authentication, to not encrypt the IPsec tunnel used for IKE key exchange traffic.

See https://www.cisco.com/c/en/us/td/docs/routers/sdwan/configuration/security/vedge-20-x/security-book/config-sec-param.html for more information."
  solution    : "vEdge(config-interface-ipsecnumber)# ipsec
vEdge(config-ipsec)# cipher-suite (aes256-cbc-sha1 | aes256-gcm | null-sha1)"
  reference   : "800-171|3.1.3,800-53|AC-4,800-53r5|AC-4,CN-L3|8.1.10.2(c),CSF|DE.AE-1,CSF|ID.AM-3,CSF|PR.AC-4,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-4,NESA|T4.2.1,NESA|T4.5.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.4.6,NESA|T5.7.2,NESA|T7.5.2,NESA|T7.6.4,NIAv2|GS11a,NIAv2|GS12a,NIAv2|GS14a,NIAv2|GS15a,NIAv2|GS16a,NIAv2|NS13a,NIAv2|NS13b,NIAv2|NS13c,NIAv2|NS14,NIAv2|SS23,NIAv2|SS27a,NIAv2|SS27b,NIAv2|SS32,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.4"
  context     : "^\s*vpn .+"
  context     : "^\s*interface ipsec.+"
  context     : "^\s*ipsec"
  item        : "^\s*cipher-suite\s+(aes256-cbc-sha1|aes256-gcm)"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Configure IPsec Tunnel Parameters - rekey"
  info        : "By default, IKE keys are refreshed every 4 hours (14,400 seconds). You can change the rekeying interval to a value from 30 seconds through 14 days (1209600 seconds).

See https://www.cisco.com/c/en/us/td/docs/routers/sdwan/configuration/security/vedge-20-x/security-book/config-sec-param.html for more information."
  solution    : "vEdge(config-interface-ipsecnumber)# ipsec
vEdge(config-ipsec)#  rekey seconds

To force the generation of new keys for an IPsec tunnel, issue the request ipsec ipsec-rekey command."
  reference   : "800-171|3.1.3,800-53|AC-4,800-53r5|AC-4,CN-L3|8.1.10.2(c),CSF|DE.AE-1,CSF|ID.AM-3,CSF|PR.AC-4,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-4,NESA|T4.2.1,NESA|T4.5.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.4.6,NESA|T5.7.2,NESA|T7.5.2,NESA|T7.6.4,NIAv2|GS11a,NIAv2|GS12a,NIAv2|GS14a,NIAv2|GS15a,NIAv2|GS16a,NIAv2|NS13a,NIAv2|NS13b,NIAv2|NS13c,NIAv2|NS14,NIAv2|SS23,NIAv2|SS27a,NIAv2|SS27b,NIAv2|SS32,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.4"
  context     : "^\s*vpn .+"
  context     : "^\s*interface ipsec.+"
  context     : "^\s*ipsec"
  item        : "^\s*rekey\s+@INTERFACE_IPSEC_REKEY_SECONDS@"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Configure IPsec Tunnel Parameters - perfect-forward-secrecy"
  info        : "By default, perfect forward secrecy (PFS) is enabled on IPsec tunnels, to ensure that past sessions are not affected if future keys are compromised. PFS forces a new Diffie-Hellman key exchange, by default using the 4096-bit Diffie-Hellman prime module group.

See https://www.cisco.com/c/en/us/td/docs/routers/sdwan/configuration/security/vedge-20-x/security-book/config-sec-param.html for more information."
  solution    : "You can change the PFS setting:

vEdge(config-interface-ipsecnumber)# ipsec
vEdge(config-ipsec)# perfect-forward-secrecy pfs-setting

pfs-setting can be one of the following:

- group-2-Use the 1024-bit Diffie-Hellman prime modulus group.
- group-14-Use the 2048-bit Diffie-Hellman prime modulus group.
- group-15-Use the 3072-bit Diffie-Hellman prime modulus group.
- group-16-Use the 4096-bit Diffie-Hellman prime modulus group. This is the default.
- none-Disable PFS."
  reference   : "800-171|3.1.3,800-53|AC-4,800-53r5|AC-4,CN-L3|8.1.10.2(c),CSF|DE.AE-1,CSF|ID.AM-3,CSF|PR.AC-4,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-4,NESA|T4.2.1,NESA|T4.5.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.4.6,NESA|T5.7.2,NESA|T7.5.2,NESA|T7.6.4,NIAv2|GS11a,NIAv2|GS12a,NIAv2|GS14a,NIAv2|GS15a,NIAv2|GS16a,NIAv2|NS13a,NIAv2|NS13b,NIAv2|NS13c,NIAv2|NS14,NIAv2|SS23,NIAv2|SS27a,NIAv2|SS27b,NIAv2|SS32,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.4"
  context     : "^\s*vpn .+"
  context     : "^\s*interface ipsec.+"
  context     : "^\s*ipsec"
  item        : "^\s*pfs-setting\s+group-1[456]"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "Configure IPsec Tunnel Parameters - replay-window"
  info        : "By default, the IPsec replay window on the IPsec tunnel is 512 bytes.

See https://www.cisco.com/c/en/us/td/docs/routers/sdwan/configuration/security/vedge-20-x/security-book/config-sec-param.html for more information."
  solution    : "You can set the replay window size to 64, 128, 256, 512, 1024, 2048, or 4096 packets:

vEdge(config-interface-ipsecnumber)# ipsec
vEdge(config-ipsec)# replay-window number"
  reference   : "800-171|3.1.3,800-53|AC-4,800-53r5|AC-4,CN-L3|8.1.10.2(c),CSF|DE.AE-1,CSF|ID.AM-3,CSF|PR.AC-4,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-4,NESA|T4.2.1,NESA|T4.5.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.4.6,NESA|T5.7.2,NESA|T7.5.2,NESA|T7.6.4,NIAv2|GS11a,NIAv2|GS12a,NIAv2|GS14a,NIAv2|GS15a,NIAv2|GS16a,NIAv2|NS13a,NIAv2|NS13b,NIAv2|NS13c,NIAv2|NS14,NIAv2|SS23,NIAv2|SS27a,NIAv2|SS27b,NIAv2|SS32,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.4"
  context     : "^\s*vpn .+"
  context     : "^\s*interface ipsec.+"
  context     : "^\s*ipsec"
  item        : "^\s*replay-window\s+@INTERFACE_IPSEC_REPLAY_WINDOW@"
</custom_item>

<custom_item>
  type        : CONFIG_CHECK
  description : "vEdge	Modify IKE Dead-Peer Detection"
  info        : "IKE uses a dead-peer detection mechanism to determine whether the connection to an IKE peer is functional and reachable. To implement this mechanism, IKE sends a Hello packet to its peer, and the peer sends an acknowledgment in response. By default, IKE sends Hello packets every 10 seconds, and after three unacknowledged packets, IKE declares the neighbor to be dead and tears down the tunnel to the peer. Thereafter, IKE periodically sends a Hello packet to the peer, and re-establishes the tunnel when the peer comes back online.

See https://www.cisco.com/c/en/us/td/docs/routers/sdwan/configuration/security/vedge-20-x/security-book/config-sec-param.html for more information."
  solution    : "You can change the liveness detection interval to a value from 0 through 65535, and you can change the number of retries to a value from 0 through 255.

vEdge(config-interface-ipsecnumber)# dead-peer-detection seconds retries number"
  reference   : "800-171|3.1.3,800-53|AC-4,800-53r5|AC-4,CN-L3|8.1.10.2(c),CSF|DE.AE-1,CSF|ID.AM-3,CSF|PR.AC-4,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-4,NESA|T4.2.1,NESA|T4.5.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.4.6,NESA|T5.7.2,NESA|T7.5.2,NESA|T7.6.4,NIAv2|GS11a,NIAv2|GS12a,NIAv2|GS14a,NIAv2|GS15a,NIAv2|GS16a,NIAv2|NS13a,NIAv2|NS13b,NIAv2|NS13c,NIAv2|NS14,NIAv2|SS23,NIAv2|SS27a,NIAv2|SS27b,NIAv2|SS32,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.4"
  context     : "^\s*vpn .+"
  context     : "^\s*interface ipsec.+"
  item        : "^\s*dead-peer-detection\s+interval @DEAD_PEER_INTERVAL@( retries @DEAD_PEER_RETRIES@)?"
</custom_item>

</check_type>
