#TRUSTED acc4c2b3aac51fb3e7bd5ba762bd5f93556ec38f679cddd7069ab8e5d95b63232e8ca43ee8764cdf1ea590298c5b928764b5418f952a06970057bcf389abb5e86d884ede87b58fbef8220492793f17110902b8bcc893faefdd8f8f8d55c2f3bcb0e5fe5775e0ee3099ee555ac2f6e228e81229a907280262f8e27c7874a6f921847626d7ed9e17447f5a7878ed256d5a036a03490cfb4b703d1ee643f6c76b7a9fbaaa7dff3389f86ccbaf5d3498ec9f6ccdfd009d1215eb1dce6b0d2ae00d8e63f051aa4ceec6b9378f10bc3c04be0afaad88295d97b8c30c8802ae52364be230b9273245aa33a1aa9ebbbd70668a797920dc9a768b297ee229f49b1881bec09b16b8ac81b13a083925cefea1fae1d1b6a0f9f2de81246eeedc8d62a5bb96d1a4c441b4a2b119c96265a4358617df2fd2da451f23aea18670eb756e9f726653495d0a8311be4b56672c20879998e5f33270381373d140ea41655365bb38b54582a175c033b2bc893d327a0c60079b9ab9d8f59035d629f6c577515402d505abd05503d1fc26ff945645fd597ab00d22488a5600ed000eba36ddee4cd61283067268db46154b70a92d798f5fe5a5f8a09e4937f93d21078ccd34da70e6d886012a1ed9ad3c571c5c7f73e5673cd0a0e658b676655016ce732cc65ec76747bbac056b036697999052f89ce7b72d2c4cffa38cad476b75cbd49e8c49d5736a5be7
#TRUST-RSA-SHA256 0e5b6307f459bb55d63e7a64f46d71514eff48f9217278950e765e2b4a8d30ca0b5973df4efd95b029b0565e2b943cde556caad959668ffeab4b98177f9056d490e7a7296bdecab677be0362dde5833447d9d33ef4e21a9db25a1634aee8a8ebe000906394323c0b38b4f56a7ebdae46655c2c5a1db53db455e2c36fed9f2ddb9f02017ee8237af9246134131d21393b73aef06376a40f5f36a63460d75f570904bcdf557c5d4f15e5dcfc6a745f272e139aeeb51c1f35838da7c6cd699c88378ad07b24bad7f5f78949948c49884ab0fdcfb1c2bf7d1c02e8ccb2f1029a003f544eda4d32a20742f37851f360627a879cec4bfc2453ec30a718b66c2d222bb04645b515c2723282f7744bd6db5dbdc2f5d4bbb3950ceb658a9880f1b750594391b1a4e601d899fe92d64ca3dec2d9c5e5b22176fb1fcd47254357c7345217604a0aca09b1621098fc553d3c71eb8263cb077908d5f0c608d498c9efaa437ed371d7b6f750680416cf86a78c66dbc41932a35ebb1f9c0d12f28396f867f474d342a56f88cb597a5793172c384813a0ccbf4878db861319f9138f6c9a19411d5fbf975a83779a147cfdb18fe2313da36fa61dce1ea95db2905e79d55546ee10578bdc29e4605e790e94486ac3bc1576a28935c99c3f943ab8df457363e2862782c78d2491422c3a842ac31a346bc67886609a8189e1e7f74922ca05ff6632bd05
#
# This script is Copyright (C) 2004-2024 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
# $Revision: 1.5 $
# $Date: 2024/06/17 $
#
# Description : This document implements the security configuration as recommended by the
#               CIS F5 Networks Benchmark v1.0.0
#
#<ui_metadata>
#<display_name>CIS F5 Networks v1.0.0 L1</display_name>
#<spec>
#  <type>CIS</type>
#  <name>F5 Networks</name>
#  <profile>L1</profile>
#  <version>1.0.0</version>
#  <link>https://workbench.cisecurity.org/files/3587</link>
#</spec>
#<labels>cis,f5,f5_big-ip,update_20230227</labels>
#<benchmark_refs>CCE,CIS_Recommendation,CSCv6,CSCv7,CSCv8,LEVEL</benchmark_refs>
#<variables>
#  <variable>
#    <name>BANNER_TEXT</name>
#    <default>All unauthorized activity is monitored and logged.</default>
#    <description>Organization-defined pre-login banner</description>
#    <info>4.1 Ensure Prelogin Login Banner is set</info>
#    <value_type>STRING</value_type>
#  </variable>
#  <variable>
#    <name>SNMP_ADDRESS</name>
#    <default>192.168.0.1</default>
#    <description>Organization-defined list of trusted SNMP IPs</description>
#    <info>6.1 Ensure that SNMP access is allowed to trusted agents IPs only</info>
#    <value_type>HOSTNAME_IP_ADDRESS</value_type>
#  </variable>
#  <variable>
#    <name>SYSLOG_SERVER</name>
#    <default>192.168.0.2</default>
#    <description>Organization-defined remote syslog server</description>
#    <info>6.5 Ensure that Remote Syslog Servers are configured</info>
#    <value_type>HOSTNAME_IP_ADDRESS</value_type>
#  </variable>
#</variables>
#</ui_metadata>

<check_type:"F5">

<report type:"WARNING">
  description : "1.1.1 Ensure default password of root is not allowed"
  info        : "To assist users in changing default password for 'root' account

Rationale:

Using Default passwords for 'root' access could cause a compromise to the overall system security

Impact:

Failure of changing default root's password brings high risk to the system as the root account might be abused by unauthorized users who would have full privilege on F5 systems

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "- Log in to the Configuration utility.
- For System, select Platform.
- Under User Administration, choose the Password box for either Root Account or Admin Account.
- Enter the new password.
- Enter the same password in the Confirm box for the account that you chose in step 3.
- Select Update.
- If you have updated the password for Admin Account, the system logs you out of the Configuration
utility, and you must log in again using the new password."
  reference   : "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CIS_Recommendation|1.1.1,CSCv7|4.2,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1"
  see_also    : "https://workbench.cisecurity.org/files/3587"
</report>

<report type:"WARNING">
  description : "1.1.2 Ensure default password of admin is not used"
  info        : "To assist users in changing default password for 'admin' account

Rationale:

Using Default passwords for 'admin' access could cause a compromise to the overall system security

Impact:

Failure of changing default root's password brings high risk to the system as the root account might be abused by unauthorized users who would have full privilege on F5 systems

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "- Log in to the Configuration utility.
- For System, select Platform.
- Under User Administration, choose the Password box for either Root Account or Admin Account.
- Enter the new password.
- Enter the same password in the Confirm box for the account that you chose in step 3.
- Select Update.
- If you have updated the password for Admin Account, the system logs you out of the Configuration
utility, and you must log in again using the new password."
  reference   : "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CIS_Recommendation|1.1.2,CSCv7|4.2,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1"
  see_also    : "https://workbench.cisecurity.org/files/3587"
</report>

<custom_item>
  description    : "1.1.3 Configure Secure Password Policy - Secure Password Enforcement"
  info           : "To assist users in maintaining strong passwords, ensure that passwords are changed at appropriate intervals and new passwords to be used

Rationale:

Having a weak or non-existent password policy will allow users to use weak or easily cracked passwords.

Impact:

Without proper password management the users are more likely to select weak passwords or forget complex passwords. This can create security risks as these passwords make it easier for attackers to crack."
  solution       : "Configuring the password policy using the Configuration utility
1.Log in to the Configuration utility.
2. Navigate to System > Users > Authentication.
3. Under Password Policy, locate the Secure Password Enforcement setting and set it to meet below minimum requirements :

Configuring the password policy using tmsh
1. Log in to tmsh by typing the following command:
tmsh:
modify /auth password-policy


The minimum requirements :

- Secure Password Enforcement : Enabled
- Minimum Password Length is 12
- Required Lowercase is 1
- Required Uppercase is 1
- Required Numeric is 1
- Required Special Characters is 1
- Maximum Duration (in Days): 180
- Minimum Duration (in Days): 90
- Expiration Warning ( in days):14
- EnsurePassword Memory is 24
- Ensure Maximum Login Failures is 3
- User Lockout :  Automatically enable locked-out users after : 300 seconds

**Notice: Some settings can be done through Configuration Utility only while others are done through tmsh only.**"
  reference      : "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CIS_Recommendation|1.1.3,CSCv7|4.2,CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1M,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1"
  see_also       : "https://workbench.cisecurity.org/files/3587"
  f5_command     : "/tm/auth/password-policy"
  json_transform : ".policyEnforcement"
  expect         : "^enabled$"
</custom_item>

<custom_item>
  description    : "1.1.3 Configure Secure Password Policy - Minimum Password Length"
  info           : "To assist users in maintaining strong passwords, ensure that passwords are changed at appropriate intervals and new passwords to be used

Rationale:

Having a weak or non-existent password policy will allow users to use weak or easily cracked passwords.

Impact:

Without proper password management the users are more likely to select weak passwords or forget complex passwords. This can create security risks as these passwords make it easier for attackers to crack."
  solution       : "Configuring the password policy using the Configuration utility
1.Log in to the Configuration utility.
2. Navigate to System > Users > Authentication.
3. Under Password Policy, locate the Secure Password Enforcement setting and set it to meet below minimum requirements :

Configuring the password policy using tmsh
1. Log in to tmsh by typing the following command:
tmsh:
modify /auth password-policy


The minimum requirements :

- Secure Password Enforcement : Enabled
- Minimum Password Length is 12
- Required Lowercase is 1
- Required Uppercase is 1
- Required Numeric is 1
- Required Special Characters is 1
- Maximum Duration (in Days): 180
- Minimum Duration (in Days): 90
- Expiration Warning ( in days):14
- EnsurePassword Memory is 24
- Ensure Maximum Login Failures is 3
- User Lockout :  Automatically enable locked-out users after : 300 seconds

**Notice: Some settings can be done through Configuration Utility only while others are done through tmsh only.**"
  reference      : "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CIS_Recommendation|1.1.3,CSCv7|4.2,CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1M,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1"
  see_also       : "https://workbench.cisecurity.org/files/3587"
  f5_command     : "/tm/auth/password-policy"
  json_transform : ".minimumLength"
  expect         : "(1[2-9]|[2-9][0-9]|[1-9]\d{2,})"
</custom_item>

<custom_item>
  description    : "1.1.3 Configure Secure Password Policy - Required Lowercase"
  info           : "To assist users in maintaining strong passwords, ensure that passwords are changed at appropriate intervals and new passwords to be used

Rationale:

Having a weak or non-existent password policy will allow users to use weak or easily cracked passwords.

Impact:

Without proper password management the users are more likely to select weak passwords or forget complex passwords. This can create security risks as these passwords make it easier for attackers to crack."
  solution       : "Configuring the password policy using the Configuration utility
1.Log in to the Configuration utility.
2. Navigate to System > Users > Authentication.
3. Under Password Policy, locate the Secure Password Enforcement setting and set it to meet below minimum requirements :

Configuring the password policy using tmsh
1. Log in to tmsh by typing the following command:
tmsh:
modify /auth password-policy


The minimum requirements :

- Secure Password Enforcement : Enabled
- Minimum Password Length is 12
- Required Lowercase is 1
- Required Uppercase is 1
- Required Numeric is 1
- Required Special Characters is 1
- Maximum Duration (in Days): 180
- Minimum Duration (in Days): 90
- Expiration Warning ( in days):14
- EnsurePassword Memory is 24
- Ensure Maximum Login Failures is 3
- User Lockout :  Automatically enable locked-out users after : 300 seconds

**Notice: Some settings can be done through Configuration Utility only while others are done through tmsh only.**"
  reference      : "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CIS_Recommendation|1.1.3,CSCv7|4.2,CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1M,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1"
  see_also       : "https://workbench.cisecurity.org/files/3587"
  f5_command     : "/tm/auth/password-policy"
  json_transform : ".requiredLowercase"
  expect         : "[^0]+"
</custom_item>

<custom_item>
  description    : "1.1.3 Configure Secure Password Policy - Required Uppercase"
  info           : "To assist users in maintaining strong passwords, ensure that passwords are changed at appropriate intervals and new passwords to be used

Rationale:

Having a weak or non-existent password policy will allow users to use weak or easily cracked passwords.

Impact:

Without proper password management the users are more likely to select weak passwords or forget complex passwords. This can create security risks as these passwords make it easier for attackers to crack."
  solution       : "Configuring the password policy using the Configuration utility
1.Log in to the Configuration utility.
2. Navigate to System > Users > Authentication.
3. Under Password Policy, locate the Secure Password Enforcement setting and set it to meet below minimum requirements :

Configuring the password policy using tmsh
1. Log in to tmsh by typing the following command:
tmsh:
modify /auth password-policy


The minimum requirements :

- Secure Password Enforcement : Enabled
- Minimum Password Length is 12
- Required Lowercase is 1
- Required Uppercase is 1
- Required Numeric is 1
- Required Special Characters is 1
- Maximum Duration (in Days): 180
- Minimum Duration (in Days): 90
- Expiration Warning ( in days):14
- EnsurePassword Memory is 24
- Ensure Maximum Login Failures is 3
- User Lockout :  Automatically enable locked-out users after : 300 seconds

**Notice: Some settings can be done through Configuration Utility only while others are done through tmsh only.**"
  reference      : "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CIS_Recommendation|1.1.3,CSCv7|4.2,CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1M,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1"
  see_also       : "https://workbench.cisecurity.org/files/3587"
  f5_command     : "/tm/auth/password-policy"
  json_transform : ".requiredUppercase"
  expect         : "[^0]+"
</custom_item>

<custom_item>
  description    : "1.1.3 Configure Secure Password Policy - Required Numeric"
  info           : "To assist users in maintaining strong passwords, ensure that passwords are changed at appropriate intervals and new passwords to be used

Rationale:

Having a weak or non-existent password policy will allow users to use weak or easily cracked passwords.

Impact:

Without proper password management the users are more likely to select weak passwords or forget complex passwords. This can create security risks as these passwords make it easier for attackers to crack."
  solution       : "Configuring the password policy using the Configuration utility
1.Log in to the Configuration utility.
2. Navigate to System > Users > Authentication.
3. Under Password Policy, locate the Secure Password Enforcement setting and set it to meet below minimum requirements :

Configuring the password policy using tmsh
1. Log in to tmsh by typing the following command:
tmsh:
modify /auth password-policy


The minimum requirements :

- Secure Password Enforcement : Enabled
- Minimum Password Length is 12
- Required Lowercase is 1
- Required Uppercase is 1
- Required Numeric is 1
- Required Special Characters is 1
- Maximum Duration (in Days): 180
- Minimum Duration (in Days): 90
- Expiration Warning ( in days):14
- EnsurePassword Memory is 24
- Ensure Maximum Login Failures is 3
- User Lockout :  Automatically enable locked-out users after : 300 seconds

**Notice: Some settings can be done through Configuration Utility only while others are done through tmsh only.**"
  reference      : "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CIS_Recommendation|1.1.3,CSCv7|4.2,CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1M,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1"
  see_also       : "https://workbench.cisecurity.org/files/3587"
  f5_command     : "/tm/auth/password-policy"
  json_transform : ".requiredNumeric"
  expect         : "[^0]+"
</custom_item>

<custom_item>
  description    : "1.1.3 Configure Secure Password Policy - Required Special Characters"
  info           : "To assist users in maintaining strong passwords, ensure that passwords are changed at appropriate intervals and new passwords to be used

Rationale:

Having a weak or non-existent password policy will allow users to use weak or easily cracked passwords.

Impact:

Without proper password management the users are more likely to select weak passwords or forget complex passwords. This can create security risks as these passwords make it easier for attackers to crack."
  solution       : "Configuring the password policy using the Configuration utility
1.Log in to the Configuration utility.
2. Navigate to System > Users > Authentication.
3. Under Password Policy, locate the Secure Password Enforcement setting and set it to meet below minimum requirements :

Configuring the password policy using tmsh
1. Log in to tmsh by typing the following command:
tmsh:
modify /auth password-policy


The minimum requirements :

- Secure Password Enforcement : Enabled
- Minimum Password Length is 12
- Required Lowercase is 1
- Required Uppercase is 1
- Required Numeric is 1
- Required Special Characters is 1
- Maximum Duration (in Days): 180
- Minimum Duration (in Days): 90
- Expiration Warning ( in days):14
- EnsurePassword Memory is 24
- Ensure Maximum Login Failures is 3
- User Lockout :  Automatically enable locked-out users after : 300 seconds

**Notice: Some settings can be done through Configuration Utility only while others are done through tmsh only.**"
  reference      : "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CIS_Recommendation|1.1.3,CSCv7|4.2,CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1M,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1"
  see_also       : "https://workbench.cisecurity.org/files/3587"
  f5_command     : "/tm/auth/password-policy"
  json_transform : ".requiredSpecial"
  expect         : "[^0]+"
</custom_item>

<custom_item>
  description    : "1.1.3 Configure Secure Password Policy - Maximum Duration"
  info           : "To assist users in maintaining strong passwords, ensure that passwords are changed at appropriate intervals and new passwords to be used

Rationale:

Having a weak or non-existent password policy will allow users to use weak or easily cracked passwords.

Impact:

Without proper password management the users are more likely to select weak passwords or forget complex passwords. This can create security risks as these passwords make it easier for attackers to crack."
  solution       : "Configuring the password policy using the Configuration utility
1.Log in to the Configuration utility.
2. Navigate to System > Users > Authentication.
3. Under Password Policy, locate the Secure Password Enforcement setting and set it to meet below minimum requirements :

Configuring the password policy using tmsh
1. Log in to tmsh by typing the following command:
tmsh:
modify /auth password-policy


The minimum requirements :

- Secure Password Enforcement : Enabled
- Minimum Password Length is 12
- Required Lowercase is 1
- Required Uppercase is 1
- Required Numeric is 1
- Required Special Characters is 1
- Maximum Duration (in Days): 180
- Minimum Duration (in Days): 90
- Expiration Warning ( in days):14
- EnsurePassword Memory is 24
- Ensure Maximum Login Failures is 3
- User Lockout :  Automatically enable locked-out users after : 300 seconds

**Notice: Some settings can be done through Configuration Utility only while others are done through tmsh only.**"
  reference      : "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CIS_Recommendation|1.1.3,CSCv7|4.2,CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1M,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1"
  see_also       : "https://workbench.cisecurity.org/files/3587"
  f5_command     : "/tm/auth/password-policy"
  json_transform : ".maxDuration"
  expect         : "^([1-9]|[1-9][0-9]|1[0-7][0-9]|180)$"
</custom_item>

<custom_item>
  description    : "1.1.3 Configure Secure Password Policy - Minimum Duration"
  info           : "To assist users in maintaining strong passwords, ensure that passwords are changed at appropriate intervals and new passwords to be used

Rationale:

Having a weak or non-existent password policy will allow users to use weak or easily cracked passwords.

Impact:

Without proper password management the users are more likely to select weak passwords or forget complex passwords. This can create security risks as these passwords make it easier for attackers to crack."
  solution       : "Configuring the password policy using the Configuration utility
1.Log in to the Configuration utility.
2. Navigate to System > Users > Authentication.
3. Under Password Policy, locate the Secure Password Enforcement setting and set it to meet below minimum requirements :

Configuring the password policy using tmsh
1. Log in to tmsh by typing the following command:
tmsh:
modify /auth password-policy


The minimum requirements :

- Secure Password Enforcement : Enabled
- Minimum Password Length is 12
- Required Lowercase is 1
- Required Uppercase is 1
- Required Numeric is 1
- Required Special Characters is 1
- Maximum Duration (in Days): 180
- Minimum Duration (in Days): 90
- Expiration Warning ( in days):14
- EnsurePassword Memory is 24
- Ensure Maximum Login Failures is 3
- User Lockout :  Automatically enable locked-out users after : 300 seconds

**Notice: Some settings can be done through Configuration Utility only while others are done through tmsh only.**"
  reference      : "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CIS_Recommendation|1.1.3,CSCv7|4.2,CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1M,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1"
  see_also       : "https://workbench.cisecurity.org/files/3587"
  f5_command     : "/tm/auth/password-policy"
  json_transform : ".minDuration"
  expect         : "^([1-9]|[1-8][0-9]|90)$"
</custom_item>

<custom_item>
  description    : "1.1.3 Configure Secure Password Policy - Expiration Warning"
  info           : "To assist users in maintaining strong passwords, ensure that passwords are changed at appropriate intervals and new passwords to be used

Rationale:

Having a weak or non-existent password policy will allow users to use weak or easily cracked passwords.

Impact:

Without proper password management the users are more likely to select weak passwords or forget complex passwords. This can create security risks as these passwords make it easier for attackers to crack."
  solution       : "Configuring the password policy using the Configuration utility
1.Log in to the Configuration utility.
2. Navigate to System > Users > Authentication.
3. Under Password Policy, locate the Secure Password Enforcement setting and set it to meet below minimum requirements :

Configuring the password policy using tmsh
1. Log in to tmsh by typing the following command:
tmsh:
modify /auth password-policy


The minimum requirements :

- Secure Password Enforcement : Enabled
- Minimum Password Length is 12
- Required Lowercase is 1
- Required Uppercase is 1
- Required Numeric is 1
- Required Special Characters is 1
- Maximum Duration (in Days): 180
- Minimum Duration (in Days): 90
- Expiration Warning ( in days):14
- EnsurePassword Memory is 24
- Ensure Maximum Login Failures is 3
- User Lockout :  Automatically enable locked-out users after : 300 seconds

**Notice: Some settings can be done through Configuration Utility only while others are done through tmsh only.**"
  reference      : "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CIS_Recommendation|1.1.3,CSCv7|4.2,CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1M,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1"
  see_also       : "https://workbench.cisecurity.org/files/3587"
  f5_command     : "/tm/auth/password-policy"
  json_transform : ".expirationWarning"
  expect         : "^(1[4-9]|[2-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$"
</custom_item>

<custom_item>
  description    : "1.1.3 Configure Secure Password Policy - EnsurePassword Memory"
  info           : "To assist users in maintaining strong passwords, ensure that passwords are changed at appropriate intervals and new passwords to be used

Rationale:

Having a weak or non-existent password policy will allow users to use weak or easily cracked passwords.

Impact:

Without proper password management the users are more likely to select weak passwords or forget complex passwords. This can create security risks as these passwords make it easier for attackers to crack."
  solution       : "Configuring the password policy using the Configuration utility
1.Log in to the Configuration utility.
2. Navigate to System > Users > Authentication.
3. Under Password Policy, locate the Secure Password Enforcement setting and set it to meet below minimum requirements :

Configuring the password policy using tmsh
1. Log in to tmsh by typing the following command:
tmsh:
modify /auth password-policy


The minimum requirements :

- Secure Password Enforcement : Enabled
- Minimum Password Length is 12
- Required Lowercase is 1
- Required Uppercase is 1
- Required Numeric is 1
- Required Special Characters is 1
- Maximum Duration (in Days): 180
- Minimum Duration (in Days): 90
- Expiration Warning ( in days):14
- EnsurePassword Memory is 24
- Ensure Maximum Login Failures is 3
- User Lockout :  Automatically enable locked-out users after : 300 seconds

**Notice: Some settings can be done through Configuration Utility only while others are done through tmsh only.**"
  reference      : "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CIS_Recommendation|1.1.3,CSCv7|4.2,CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1M,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1"
  see_also       : "https://workbench.cisecurity.org/files/3587"
  f5_command     : "/tm/auth/password-policy"
  json_transform : ".passwordMemory"
  expect         : "^(2[4-9]|[3-9][0-9]|1[01][0-9]|12[0-7])$"
</custom_item>

<custom_item>
  description    : "1.1.3 Configure Secure Password Policy - Ensure Maximum Login Failures"
  info           : "To assist users in maintaining strong passwords, ensure that passwords are changed at appropriate intervals and new passwords to be used

Rationale:

Having a weak or non-existent password policy will allow users to use weak or easily cracked passwords.

Impact:

Without proper password management the users are more likely to select weak passwords or forget complex passwords. This can create security risks as these passwords make it easier for attackers to crack."
  solution       : "Configuring the password policy using the Configuration utility
1.Log in to the Configuration utility.
2. Navigate to System > Users > Authentication.
3. Under Password Policy, locate the Secure Password Enforcement setting and set it to meet below minimum requirements :

Configuring the password policy using tmsh
1. Log in to tmsh by typing the following command:
tmsh:
modify /auth password-policy


The minimum requirements :

- Secure Password Enforcement : Enabled
- Minimum Password Length is 12
- Required Lowercase is 1
- Required Uppercase is 1
- Required Numeric is 1
- Required Special Characters is 1
- Maximum Duration (in Days): 180
- Minimum Duration (in Days): 90
- Expiration Warning ( in days):14
- EnsurePassword Memory is 24
- Ensure Maximum Login Failures is 3
- User Lockout :  Automatically enable locked-out users after : 300 seconds

**Notice: Some settings can be done through Configuration Utility only while others are done through tmsh only.**"
  reference      : "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CIS_Recommendation|1.1.3,CSCv7|4.2,CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1M,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1"
  see_also       : "https://workbench.cisecurity.org/files/3587"
  f5_command     : "/tm/auth/password-policy"
  json_transform : ".maxLoginFailures"
  expect         : "^([1-3])$"
</custom_item>

<custom_item>
  description    : "1.1.3 Configure Secure Password Policy - User Lockout"
  info           : "To assist users in maintaining strong passwords, ensure that passwords are changed at appropriate intervals and new passwords to be used

Rationale:

Having a weak or non-existent password policy will allow users to use weak or easily cracked passwords.

Impact:

Without proper password management the users are more likely to select weak passwords or forget complex passwords. This can create security risks as these passwords make it easier for attackers to crack."
  solution       : "Configuring the password policy using the Configuration utility
1.Log in to the Configuration utility.
2. Navigate to System > Users > Authentication.
3. Under Password Policy, locate the Secure Password Enforcement setting and set it to meet below minimum requirements :

Configuring the password policy using tmsh
1. Log in to tmsh by typing the following command:
tmsh:
modify /auth password-policy


The minimum requirements :

- Secure Password Enforcement : Enabled
- Minimum Password Length is 12
- Required Lowercase is 1
- Required Uppercase is 1
- Required Numeric is 1
- Required Special Characters is 1
- Maximum Duration (in Days): 180
- Minimum Duration (in Days): 90
- Expiration Warning ( in days):14
- EnsurePassword Memory is 24
- Ensure Maximum Login Failures is 3
- User Lockout :  Automatically enable locked-out users after : 300 seconds

**Notice: Some settings can be done through Configuration Utility only while others are done through tmsh only.**"
  reference      : "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CIS_Recommendation|1.1.3,CSCv7|4.2,CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1M,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1"
  see_also       : "https://workbench.cisecurity.org/files/3587"
  f5_command     : "/tm/auth/password-policy"
  json_transform : ".lockoutDuration"
  expect         : "(30\d|3[1-9]\d|[4-9]\d{2}|[1-9]\d{3,5}|0)"
</custom_item>

<custom_item>
  description    : "2.5 Ensure External Users' has access to needed Partitions only"
  info           : "To limit access for remote users to needed partitions only granting a user access to 'All Partitions' might provide the users unauthorized access.

Rationale:

Impact:

Though , there is one partition is configured currently on WD F5 systems ( common) , It is a good practice to specify which partition the users allowed to access."
  solution       : "1. Log in to the Configuration utility.

2. Go to System > Users > Authentication.

3. Under External Users , click 'Change'.

4. For Partition Access , specify which partitions are allowed for External Users."
  reference      : "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CIS_Recommendation|2.5,CSCv7|4.6,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3"
  see_also       : "https://workbench.cisecurity.org/files/3587"
  f5_command     : "/tm/auth/remote-user"
  json_transform : ".defaultPartition"
  not_expect     : "All"
</custom_item>

<custom_item>
  description    : "2.6 Ensure External Users' Terminal Access is Disabled"
  info           : "To prevent remote users from gaining terminal access

Rationale:"
  solution       : "1. Log in to the Configuration utility.

2. Go to System > Users > Authentication.

3. Under External Users , click 'Change'.

4. Set Terminal Access as 'Disabled'"
  reference      : "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CIS_Recommendation|2.6,CSCv7|4.6,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3"
  see_also       : "https://workbench.cisecurity.org/files/3587"
  f5_command     : "/tm/auth/remote-user"
  json_transform : ".remoteConsoleAccess"
  expect         : "disabled"
</custom_item>

<custom_item>
  description    : "3.1 Ensure 'Idle timeout' is less than or equal to 10 minutes for Configuration utility sessions"
  info           : "To set an idle timeout for GUI sessions

Rationale:

Unattended administrative sessions may provide illegal access to the device

Impact:

Indefinite or even long session timeout windows can increase the risk of attackers abusing abandoned sessions."
  solution       : "On Configuration utility:

System > Preferences, Under Security settings...set the value of Idle Time Before Automatic Logout to 600 seconds

Default Value:

1200"
  reference      : "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CIS_Recommendation|3.1,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3"
  see_also       : "https://workbench.cisecurity.org/files/3587"
  f5_command     : "/tm/sys/httpd"
  json_transform : "\"Configuration Utility Timeout: \(.authPamIdleTimeout)\""
  expect         : "^[\s]*Configuration Utility Timeout:[\s]*([1-9]|[1-9][0-9]|[1-5][0-9]{2}|600)[\s]*$"
</custom_item>

<custom_item>
  description    : "3.2 Ensure access to Configuration utility by clients using TLS version 1.2 or later"
  info           : "TLSv1.2 should be used for GUI connections

Rationale:

Restricting the configuration utility to use TLS version 1.2 is recommended

Impact:

Weak security protocols may expose vulnerability by disclosing data through SSL/TLS sessions"
  solution       : "If the value is different, execute the following command to modify the protocol used to access GUI:

tmsh modify /sys httpd ssl-protocol 'TLSv1.2'
tmsh save sys config

Default Value:

ssl-protocol 'All -SSLv2 -SSLv3 -TLSv1'"
  reference      : "800-171|3.1.16,800-171|3.1.17,800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|AC-18,800-53|AC-18(1),800-53|AC-18(3),800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53r5|AC-18,800-53r5|AC-18(1),800-53r5|AC-18(3),800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,CIS_Recommendation|3.2,CSCv7|5.1,CSCv8|4.2,CSF|DE.AE-1,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-18,ITSG-33|AC-18(1),ITSG-33|AC-18(3),ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,LEVEL|1A,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T5.4.2,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NIAv2|NS33,NIAv2|NS34,NIAv2|NS38,NIAv2|SS15a,NIAv2|SS16,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3"
  see_also       : "https://workbench.cisecurity.org/files/3587"
  f5_command     : "/tm/sys/httpd"
  json_transform : "\"SSL Protocol: \(.sslProtocol)\""
  expect         : "^[\s]*SSL[\s]*Protocol:[\s]*TLSv1.(2|3)[\s]*$"
</custom_item>

<custom_item>
  description    : "3.3 Ensure access to Configuration utility is restricted to needed IP addresses only"
  info           : "It is recommended to maintain secure access to the GUI by allowing only trusted IP addresses or range of IP addresses

Rationale:

Any compromised network device within enterprise network would gain illegal access to F5 configuration utility abusing existing unresolved vulnerabilities.

Impact:

Allowing any IP address to access may expose the management interface of F5 to different types of attacks such as DoS"
  solution       : "If the output of the above command show ALL, the following command would be executed to modify the settings:

modify modify /sys httpd allow replace-all-with { <IP address or IP address range> }

Default Value:

ALL"
  reference      : "800-171|3.1.16,800-171|3.1.17,800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|AC-18,800-53|AC-18(1),800-53|AC-18(3),800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53r5|AC-18,800-53r5|AC-18(1),800-53r5|AC-18(3),800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,CIS_Recommendation|3.3,CSCv7|12.3,CSCv8|4.2,CSF|DE.AE-1,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-18,ITSG-33|AC-18(1),ITSG-33|AC-18(3),ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,LEVEL|1A,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T5.4.2,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NIAv2|NS33,NIAv2|NS34,NIAv2|NS38,NIAv2|SS15a,NIAv2|SS16,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3"
  see_also       : "https://workbench.cisecurity.org/files/3587"
  f5_command     : "/tm/sys/httpd"
  json_transform : ".allow"
  not_expect     : "All"
</custom_item>

<custom_item>
  description    : "4.1 Ensure Prelogin 'Login Banner' is set - Login Banner"
  info           : "Rationale:

Impact:

Failure to display adequate warning messages could result in the loss of litigation capabilities."
  solution       : "1-Log in to the Configuration utility.

2-Navigate to System > Configuration > Device

3-Click SSHD.

4-Enter the desired pre-login message banner in the text box and enable appropriate options.

5-To enable this banner message, check the Show The Security Banner On The Login Screen option.
To disable this message banner, clear the Show The Security Banner On The Login Screen option.

6-Click Update."
  reference      : "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CIS_Recommendation|4.1,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1M,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3"
  see_also       : "https://workbench.cisecurity.org/files/3587"
  f5_command     : "/tm/sys/sshd"
  json_transform : ".bannerText"
  expect         : "@BANNER_TEXT@"
</custom_item>

<custom_item>
  description    : "4.1 Ensure Prelogin 'Login Banner' is set - Enabled"
  info           : "Rationale:

Impact:

Failure to display adequate warning messages could result in the loss of litigation capabilities."
  solution       : "1-Log in to the Configuration utility.

2-Navigate to System > Configuration > Device

3-Click SSHD.

4-Enter the desired pre-login message banner in the text box and enable appropriate options.

5-To enable this banner message, check the Show The Security Banner On The Login Screen option.
To disable this message banner, clear the Show The Security Banner On The Login Screen option.

6-Click Update."
  reference      : "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CIS_Recommendation|4.1,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1M,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3"
  see_also       : "https://workbench.cisecurity.org/files/3587"
  f5_command     : "/tm/sys/sshd"
  json_transform : ".banner"
  expect         : "enabled"
</custom_item>

<custom_item>
  description    : "4.2 Ensure 'Idle timeout' is less than or equal to 10 minutes for SSH connections"
  info           : "To set an idle timeout for SSH sessions

Rationale:

Impact:

Indefinite or even long session timeout window increase the risk of attackers abusing abandoned sessions"
  solution       : "1-Log in to tmsh by typing the following command:
tmsh

2-To configure an automatic logout idle time (10 minutes) for SSH sessions, use the following command syntax:
modify /sys sshd inactivity-timeout 600
3-Save the change by typing the following command:
save /sys config"
  reference      : "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CIS_Recommendation|4.2,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1M,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3"
  see_also       : "https://workbench.cisecurity.org/files/3587"
  f5_command     : "/tm/sys/sshd"
  json_transform : "\"SSH Idle Timeout: \(.inactivityTimeout)\""
  expect         : "^[\s]*SSH Idle Timeout:[\s]*([1-9]|[1-9][0-9]|[1-5][0-9]{2}|600)[\s]*$"
</custom_item>

<custom_item>
  description    : "4.3 Ensure 'Idle timeout' is less than or equal to 10 minutes for tmsh sessions"
  info           : "To set an idle timeout for tmsh sessions

Rationale:

Impact:

Indefinite or even long session timeout window increases the risk of attackers abusing abandoned sessions."
  solution       : "1.Log in to tmsh by typing the following command: tmsh

2.To configure an automatic logout idle time for tmsh sessions, use the following command syntax: modify /cli global-settings idle-timeout 10

3.Save the change by typing the following command: save /sys config"
  reference      : "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CIS_Recommendation|4.3,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1M,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3"
  see_also       : "https://workbench.cisecurity.org/files/3587"
  f5_command     : "/tm/cli/global-settings"
  json_transform : "\"TMSH Timeout: \(.idleTimeout)\""
  expect         : "^TMSH Timeout:[\s]*([1-9]|[1-9][0-9]|[1-5][0-9]{2}|600)[\s]*$"
</custom_item>

<custom_item>
  description    : "4.4 Ensure 'Idle timeout' is less than or equal to 10 minutes for serial console sessions"
  info           : "To set an idle timeout for serial console sessions.

Rationale:

Impact:

Indefinite or even long session timeout window increases the risk of attackers abusing abandoned sessions."
  solution       : "- Log in to tmsh by typing the following command:
 tmsh
- To configure an automatic logout idle time for serial console sessions, use the following command :
 modify /sys global-settings console-inactivity-timeout 600
- Save the change by typing the following command:
 save /sys config"
  reference      : "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CIS_Recommendation|4.4,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1M,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3"
  see_also       : "https://workbench.cisecurity.org/files/3587"
  f5_command     : "/tm/sys/global-settings"
  json_transform : "\"Console Idle Timeout: \(.consoleInactivityTimeout)\""
  expect         : "^[\s]*Console Idle Timeout:[\s]*([1-9]|[1-9][0-9]|[1-5][0-9]{2}|600)[\s]*$"
</custom_item>

<custom_item>
  description    : "4.5 Ensure minimum SSH Encryption algorithm is set to aes128-cbc"
  info           : "To set strong SSH Encryption algorithm.

Rationale:

Impact:

Weak encryption algorithms make it possible for attackers to decrypt traffic and reduce the confidentiality capability that SSH provides for remote connections."
  solution       : "1-Log in to tmsh by typing the following command:tmsh

2-To modify the sshd configuration, type the following command to start the vi editor:edit /sys sshd all-properties

3-To change the list of ciphers, you can navigate to the line that starts with the include statement, and use the keyword Ciphers :

include 'Ciphers aes128-cbc,aes128-ctr,aes192-ctr,aes256-ctr,arcfour128,arcfour256,arcfour'"
  reference      : "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CIS_Recommendation|4.5,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1M,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3"
  see_also       : "https://workbench.cisecurity.org/files/3587"
  f5_command     : "/tm/sys/sshd"
  json_transform : ".include"
  expect         : "^[\s]*Ciphers.*aes128-cbc.*$"
</custom_item>

<custom_item>
  description    : "4.6 Ensure to set SSH MAC algorithm to hmac-sha2-256"
  info           : "To set strong Hashing algorithm

Rationale:

Impact:

Weak MAC algorithms make it possible for attackers to bypass authentication , steal keys and reduce the integrity capability that SSH provides for remote connections."
  solution       : "1-Log in to tmsh by typing the following command:tmsh

2-To modify the sshd configuration, type the following command to start the vi editor:edit /sys sshd all-properties

3-To change the list of ciphers, you can navigate to the line that starts with the include statement, and use the keyword MACs ,and adding the list of desired MACs to the 2-line include statement:
include 'Ciphers aes128-cbc,aes128-ctr,aes192-ctr,aes256-ctr,arcfour128,arcfour256,arcfour
MACs hmac-sha2-256'"
  reference      : "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CIS_Recommendation|4.6,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1M,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3"
  see_also       : "https://workbench.cisecurity.org/files/3587"
  f5_command     : "/tm/sys/sshd"
  json_transform : ".include"
  expect         : "^[\s]*Ciphers.*MACs.*hmac-sha2-256.*$"
</custom_item>

<custom_item>
  description    : "4.7 Ensure to set Strong SSH KEY Exchange algorithm"
  info           : "To set strong Key Exchange algorithm

Rationale:

Impact:

Weak Key Exchange algorithms make it possible for attackers to bypass authentication , steal keys and reduce the integrity capability that SSH provides for remote connections ."
  solution       : "1-Log in to tmsh by typing the following command:tmsh


2-To modify the sshd configuration, type the following command to start the vi editor:edit /sys sshd all-properties


3-Set a Key-Exchange algorithm with key of size 256 or longer  example diffie-hellman-group14-sha256)

4-To change the list of ciphers, you can navigate to the line that starts with the include statement, and use the keyword KexAlgorithms ,and adding the list of desired KexAlgorithms to the 2-line include statement:
include 'Ciphers aes128-cbc,aes128-ctr,aes192-ctr,aes256-ctr,arcfour128,arcfour256,arcfour
MACs hmac-sha2-256
KexAlgorithms  diffie-hellman-group14-sha256"
  reference      : "800-171|3.1.16,800-171|3.1.17,800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|AC-18,800-53|AC-18(1),800-53|AC-18(3),800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53r5|AC-18,800-53r5|AC-18(1),800-53r5|AC-18(3),800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,CIS_Recommendation|4.7,CSCv7|11.1,CSCv8|4.2,CSF|DE.AE-1,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-18,ITSG-33|AC-18(1),ITSG-33|AC-18(3),ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,LEVEL|1M,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T5.4.2,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NIAv2|NS33,NIAv2|NS34,NIAv2|NS38,NIAv2|SS15a,NIAv2|SS16,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3"
  see_also       : "https://workbench.cisecurity.org/files/3587"
  f5_command     : "/tm/sys/sshd"
  json_transform : ".include"
  expect         : "^[\s]*Ciphers.*KexAlgorithms.*$"
</custom_item>

<custom_item>
  description    : "4.8 Ensure access SSH to CLI interface is restricted to needed IP addresses only"
  info           : "To limit ssh access to trusted IPs only

Rationale:

Impact:

Restricting access to the system MGT interface is to ensure that even if an attacker gains access to privileged credentials, his/her ability to get in and do damage is still limited."
  solution       : "1-Log in to the Configuration utility.

2-Go to System > Platform.

3-For SSH IP Allow, select Specify Range and then enter the IP addresses or address ranges for the remote systems allowed to use SSH to communicate with this system."
  reference      : "800-171|3.1.16,800-171|3.1.17,800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|AC-18,800-53|AC-18(1),800-53|AC-18(3),800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53r5|AC-18,800-53r5|AC-18(1),800-53r5|AC-18(3),800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,CIS_Recommendation|4.8,CSCv7|11.1,CSCv8|4.2,CSF|DE.AE-1,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-18,ITSG-33|AC-18(1),ITSG-33|AC-18(3),ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,LEVEL|1M,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T5.4.2,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NIAv2|NS33,NIAv2|NS34,NIAv2|NS38,NIAv2|SS15a,NIAv2|SS16,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3"
  see_also       : "https://workbench.cisecurity.org/files/3587"
  f5_command     : "/tm/sys/sshd"
  json_transform : ".allow"
  not_expect     : "All"
</custom_item>

<custom_item>
  description    : "5.1 Ensure redundant NTP servers are configured appropriately"
  info           : "To ensure redundant NTP servers are configured.

Rationale:

Impact:

Failing to connect to an NTP server results on incorrect time zone and date which impacts several functions on BIG-IP systems. It is recommended to have dual NTP servers configured to avoid single point of failure ."
  solution       : "1-Log in to the Configuration utility.

2-Navigate to System > Configuration > Device

3-Click NTP : add trusted NTP servers IP addresses ."
  reference      : "800-171|3.3.6,800-171|3.3.7,800-53|AU-7,800-53|AU-8,800-53r5|AU-7,800-53r5|AU-8,CIS_Recommendation|5.1,CN-L3|7.1.2.3(c),CN-L3|8.1.4.3(b),CSCv7|6.1,CSCv8|8.4,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-7,ITSG-33|AU-8,LEVEL|1M,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4,TBA-FIISB|37.4"
  see_also       : "https://workbench.cisecurity.org/files/3587"
  f5_command     : "/tm/sys/ntp"
  json_transform : ".servers"
  expect         : "[0-9.]+"
</custom_item>

<custom_item>
  description    : "5.2 Ensure to exclude inode information from ETags HTTP Header"
  info           : "To prevent the disclosure of inode information when accessing Configuration utility (GUI).

Rationale:

Impact:

When connecting to the Configuration utility, responses from the Apache server contain an Etag HTTP header that includes the file's inode information.(CVE-2003-1418)."
  solution       : "1-Log in to tmsh by entering the following command: tmsh

2-To specify the format to be used for the Etag header, enter the following command:

3-modify /sys httpd include 'FileETag MTime Size'
  Save the configuration change by entering the following command:
 4-save /sys config

5-To restart the httpd service, enter the following command:
restart /sys service httpd"
  reference      : "800-171|3.1.16,800-171|3.1.17,800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|AC-18,800-53|AC-18(1),800-53|AC-18(3),800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53r5|AC-18,800-53r5|AC-18(1),800-53r5|AC-18(3),800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,CIS_Recommendation|5.2,CSCv7|11.1,CSCv8|4.2,CSF|DE.AE-1,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-18,ITSG-33|AC-18(1),ITSG-33|AC-18(3),ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,LEVEL|1M,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T5.4.2,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NIAv2|NS33,NIAv2|NS34,NIAv2|NS38,NIAv2|SS15a,NIAv2|SS16,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3"
  see_also       : "https://workbench.cisecurity.org/files/3587"
  f5_command     : "/tm/sys/httpd"
  json_transform : ".include"
  expect         : "^[\s]*FileETag[\s]*MTime[\s]*Size[\s]*$"
</custom_item>

<custom_item>
  description    : "5.3 Ensure port lockdown for self IP is set"
  info           : "to secure the BIG-IP system from unwanted connection attempts on self-IP.

Rationale:

Impact:

Default settings allow BIG-IP to listen on several ports on which some are not needed . Attackers may initiate attacks against the system self IPs on these ports . To reduce the risk , only needed ports should be enabled on self IPs."
  solution       : "1-Log in to the Configuration utility.

2-Go to Network > Self IPs.

3-Select the relevant self IP address.

4-If the specified interface does not need to listen to incoming connections ( Example BGP ,BDF ..etc) , set 'Port Lockdown' to 'Allow None'
5-If the specified interface need to listen for incoming connections , set  'Port Lockdown' to 'Allow Custom'. Then in the 'Custom List' add needed ports only."
  reference      : "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.15,800-53|CM-6,800-53|CM-7,800-53|SC-23,800-53r5|CM-6,800-53r5|CM-7,800-53r5|SC-23,CIS_Recommendation|5.3,CSCv7|12.4,CSCv8|12.3,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|SC-23,ITSG-33|SC-23a.,LEVEL|1M,NESA|T4.5.1,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|5.2.1,SWIFT-CSCv1|2.3"
  see_also       : "https://workbench.cisecurity.org/files/3587"
  f5_command     : "/tm/net/self"
  json_transform : ".items[] | \"Name: \(.name) - Port Lockdown: \(.allowService) \""
  not_expect     : "all"
</custom_item>

<custom_item>
  description    : "5.4 Ensure to disable unused services in BIG-IP configuration"
  info           : "To disable unused BIG-IP system daemons

Rationale:

Impact:

Many systems break-ins are a result of people taking advantage of security holes or problems with these programs. The more services that are running on your system, the more opportunities there are for others to use them, break into or take control of your system through them.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution       : "1- Log in to the Configuration utility.

2- Go to System > Services > Services List

3-Select the unnecessary services you want to disable , then click 'stop'

4-Click OK"
  reference      : "800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-171|3.13.5,800-53|CM-7,800-53|CP-6,800-53|CP-7,800-53|PL-8,800-53|PM-7,800-53|SA-8,800-53|SC-7,800-53r5|CM-7,800-53r5|CP-6,800-53r5|CP-7,800-53r5|PL-8,800-53r5|PM-7,800-53r5|SA-8,800-53r5|SC-7,CIS_Recommendation|5.4,CN-L3|8.1.10.6(j),CSCv7|9.2,CSCv8|12.2,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-4,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.c,GDPR|32.1.d,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|CM-7,ITSG-33|CP-6,ITSG-33|CP-7,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SC-7,LEVEL|1M,NESA|T2.2.4,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.6.5,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|SS3,NIAv2|SS15a,NIAv2|VL2,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,SWIFT-CSCv1|2.3,TBA-FIISB|43.1"
  see_also       : "https://workbench.cisecurity.org/files/3587"
  f5_command     : "/tm/sys/service"
  json_transform : ".items[] | \"Service Name: \(.name)\""
  expect         : "MANUAL_REVIEW"
  severity       : MEDIUM
</custom_item>

<custom_item>
  description    : "6.1 Ensure that SNMP access is allowed to trusted agents IPs only"
  info           : "To limit access to trusted SNMP agents only

Rationale:

Impact:

Failing on restricting access to SNMP may allow unauthorised systems to gain access to the network device."
  solution       : "1-Login to Configuration utility

2- Go to System > SNMP > Agent > Configuration

3- Add trusted IP addresses in 'Client Allow List'"
  reference      : "800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-171|3.13.5,800-53|CM-7,800-53|CP-6,800-53|CP-7,800-53|PL-8,800-53|PM-7,800-53|SA-8,800-53|SC-7,800-53r5|CM-7,800-53r5|CP-6,800-53r5|CP-7,800-53r5|PL-8,800-53r5|PM-7,800-53r5|SA-8,800-53r5|SC-7,CIS_Recommendation|6.1,CN-L3|8.1.10.6(j),CSCv7|11.1,CSCv8|12.2,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-4,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.c,GDPR|32.1.d,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|CM-7,ITSG-33|CP-6,ITSG-33|CP-7,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SC-7,LEVEL|1M,NESA|T2.2.4,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.6.5,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|SS3,NIAv2|SS15a,NIAv2|VL2,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,SWIFT-CSCv1|2.3,TBA-FIISB|43.1"
  see_also       : "https://workbench.cisecurity.org/files/3587"
  f5_command     : "/tm/sys/snmp"
  json_transform : ".allowedAddresses"
  expect         : "@SNMP_ADDRESS@"
</custom_item>

<report type:"WARNING">
  description : "6.2 Ensure minimum SNMP version is set to V3 for agent access"
  info        : "To disable the usage of weak SNMP protocols

Rationale:

Impact:

Abuse of SNMP settings could allow an unauthorised third party to gain access to a network device when weak SNMP protocols are used.These protocols ( prior to v3) lack the ability of authentication and encryption .

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "1-Login to Configuration utility

2- Go to System > SNMP > Agent > SNMP Access (v1, v2c) :
Select all listed entries and click 'Delete'

3-Go to System > SNMP > Agent > SNMP Access (v3) :
Make sure there is one entry at least , otherwise create one."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-171|3.13.5,800-53|CM-7,800-53|CP-6,800-53|CP-7,800-53|PL-8,800-53|PM-7,800-53|SA-8,800-53|SC-7,800-53r5|CM-7,800-53r5|CP-6,800-53r5|CP-7,800-53r5|PL-8,800-53r5|PM-7,800-53r5|SA-8,800-53r5|SC-7,CIS_Recommendation|6.2,CN-L3|8.1.10.6(j),CSCv7|11.1,CSCv8|12.2,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-4,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.c,GDPR|32.1.d,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|CM-7,ITSG-33|CP-6,ITSG-33|CP-7,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SC-7,LEVEL|1M,NESA|T2.2.4,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.6.5,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|SS3,NIAv2|SS15a,NIAv2|VL2,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,SWIFT-CSCv1|2.3,TBA-FIISB|43.1"
  see_also    : "https://workbench.cisecurity.org/files/3587"
</report>

<report type:"WARNING">
  description : "6.3 Ensure to lockdown access logs to 'Administrator , Resource Administrator and Auditor ' roles only"
  info        : "To restrict access to the system logs.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "1-Login to Configuration utility

2-Go to System > Logs > Configuration > Options

3- Under Log Access : select 'Allow' for:
Administrator
Resource Administrator
Auditor

Select 'Deny' for other users ."
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-1,800-53|AU-2,800-53r5|AU-1,800-53r5|AU-2,CIS_Recommendation|6.3,CN-L3|8.1.4.3(a),CSCv7|6.2,CSCv8|8.1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-1,ITSG-33|AU-2,LEVEL|1M,NESA|M1.2.2,NESA|M5.5.1,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|SS30,NIAv2|VL8,PCI-DSSv3.2.1|10.8,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4"
  see_also    : "https://workbench.cisecurity.org/files/3587"
</report>

<report type:"WARNING">
  description : "6.4 Ensure that audit logging for 'MCP, tmsh and GUI' is set to enabled"
  info        : "To enable audit logging on configuration changes that users or services make to the BIG-IP system.

Rationale:

Impact:

Audit logging provides a mechanism to investigate security incidents and unauthorised activities . It is also necessary for compliance auditing.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "1-Login to Configuration utility

2-Go to System > Logs > Configuration > Options

3- Under Audit Logging :
Select 'Enable' for all items : 'MCP' , 'tmsh' and 'GUI'"
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-1,800-53|AU-2,800-53r5|AU-1,800-53r5|AU-2,CIS_Recommendation|6.4,CN-L3|8.1.4.3(a),CSCv7|6.2,CSCv8|8.1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-1,ITSG-33|AU-2,LEVEL|1M,NESA|M1.2.2,NESA|M5.5.1,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|SS30,NIAv2|VL8,PCI-DSSv3.2.1|10.8,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4"
  see_also    : "https://workbench.cisecurity.org/files/3587"
</report>

<custom_item>
  description    : "6.5 Ensure that Remote Syslog Servers are configured"
  info           : "To ensure that logs are sent to external servers

Rationale:

Impact:

In case of hardware failure , logs stored locally can be lost. This impacts the ability of investigating security incidents and be in compliance with the requirements of logs retention period ."
  solution       : "1-Log in to the Configuration utility.

2-Go to System > Logs > Configuration > Remote Logging.

3-For Remote IP, enter the destination syslog server IP address, or FQDN. (DNS server configuration required)

4-For Remote Port, enter the remote syslog server UDP port (default is 514).

5-Select Add.

6-Select Update."
  reference      : "800-171|3.3.1,800-171|3.3.5,800-53|AU-6(3),800-53r5|AU-6(3),CIS_Recommendation|6.5,CN-L3|7.1.3.3(d),CSCv7|6.5,CSCv8|8.9,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.DP-4,CSF|PR.PT-1,CSF|RS.AN-1,CSF|RS.CO-2,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-6(3),LEVEL|1M,NESA|M5.2.5,QCSC-v1|5.2.3,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4"
  see_also       : "https://workbench.cisecurity.org/files/3587"
  f5_command     : "/tm/sys/syslog"
  json_transform : ".remoteServers[] | \"Remote Syslog Server: \(.host)\""
  expect         : "^[\s]*Remote Syslog Server:[\s]*@SYSLOG_SERVER@[\s]*$"
</custom_item>

</check_type>
