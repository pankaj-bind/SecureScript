#TRUSTED 0c572b27f3cb8e5bc58eb6b3044cc1c36ea8197f40e5af24a81cfe7ec02905ce2b072531c38dce6599ea39cf14bc004cb6617a9df4d1be53fd43371a189a534d10728276a4d4d0bd267409943f15b096fe5c2fcc632992091129bceb671b8062f0c9e9339f75d08f2d44454c48d4c41ea27a958fbf5973469f5ff395bb665e15b17cf5ad59cfd313f7cd4c42aca76aed22edc0990013f021942ae275b4c065b0e8a8a89afb3f6db031aaf924a9a83e138cd88f3b7d839b53210e94d30b9e907776102e8d8cc663dd03f397d33946eda987887d01b9cc987f23c7f080e5b6dd3d55493b46a167599db8e7b1be12a37c1697274640034310dfa33ed6eb78fd610f28f153d073b448ff9801b4208e53ee85d8bb1e3c69fc42bfa4db56663cbc4285bbe2241557e94d706c568aca0d34c1afad5356d24e3beb963e0b66ae8ed85795aa8543366c4524bbc4445219399969971e13658162a5d4584b668fea77e5e87444b5e67c20d669c7d2133b0f425cf32bd458c1264dc2a90fb86a28a66158cd84b5d71dbfe1bc545f5035d4211d683de931b9851a65b4b802da6feca0db316e02d45095fe3281bfc0d335283cd07bb408f12da4f7f7927ee4dcafefb81dae0b7156a0c46db8f2f4c9b78622d154127a31df0139afe0fee7d0454cc36ecadecd35a64e1e82fbd67e0becce4070eb66f6b928ea93f3102e643f7dc8b39dc71f666e
#TRUST-RSA-SHA256 998c66401f6f733f2466078d9bac266f07df1607f9eb57277b6adbc42bc6cf7081ebd255a40d6cdc333b81d4ae093d91d1ab888d429fcfd388596a2c6ae22e24a382fd3410f0f9fd4868f628449e734cd1756e87c2ad794f9518b1b0f58715aa9b8a2825f35e437d6b5a614cc7234566a23e0e41830d997f562edab7478974fa54d3db2c6a980b0fd79d1d902eeaa275b2fb8e58b9477c82caa2dc65d9c1306f1b801b7eada6dc718354fab6299842e070aeb4f0f40b295df6742cf6a9b6c7576ca8a546a159b3f396d8969ffdf56b7268a2fbc8d4e9e7f13fbbbe52c920df33ed16e9526993b105e912da30e60883fbdb383e19b7ccb26e462b64c9d728595cf520a5b298bbb3ab367b73b1ffd37796a027ffc8e602a9faa04b0e490476e4346a81f28bce8469d15d665fd9315930f05a9467b247626a5dec88dbaa50208d3a47fa9f5b54cfecd8fdc060da0562ae7b4cccdb9e32e543b897a905397164b23c74220ddf58ae4fb2ac2c65c585c215a4120260a441b017aac69109914a747b3295dd0e4ca3ac8f1cb26c3fd1f7aba16b268409997ed675687cc631ff6cc50a6e6f0355b5d573c203dcc00c3d11a812349341799cd89357f41659a67e609696e62da040a0f9dea0425781c95dcfa8481b0bc4ba609d85c4c1fa6c97cbf0bd7e33744fdc801a3e7466f99611c8d30ba7f280a02c6c93d41f8f0e3b55fef8430efc
#
# This script is Copyright (C) 2004-2025 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
# $Revision: 1.0 $
# $Date: 2025/04/30 $
#
# Description : This document implements the security configuration as recommended by the
#               DISA F5 BIG-IP Access Policy Manager v2r4 STIG.
#
#<ui_metadata>
#<display_name>DISA F5 BIG-IP Access Policy Manager STIG v2r4</display_name>
#<spec>
#  <type>DISA STIG</type>
#  <name>F5 BIG-IP Access Policy Manager</name>
#  <version>2.4.0</version>
#  <link>https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_F5_BIG-IP_Y25M01_STIG.zip</link>
#</spec>
#<labels>disa,f5,f5_big-ip</labels>
#<benchmark_refs>CAT,CCE,CCI,DISA_Benchmark,Group-ID,Rule-ID,STIG-ID,STIG-Legacy,Vuln-ID</benchmark_refs>
#</ui_metadata>

<check_type:"F5">

<if>
  <condition type:"AND">
    <custom_item>
      description    : "Verify the target returns expected F5 data"
      f5_command     : "/tm/sys/software/volume"
      json_transform : ".items[] | .product"
      expect         : "^BIG-IP$"
    </custom_item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "DISA_F5_BIG-IP_APM_v2r4.audit from DISA F5 BIG-IP Access Policy Manager v2r4 STIG"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_F5_BIG-IP_Y25M01_STIG.zip"
    </report>

    <custom_item>
      description    : "F5BI-AP-000003 - The BIG-IP APM module must enforce approved authorizations for logical access to information and system resources by employing identity-based, role-based, and/or attribute-based security policies."
      info           : "Successful authentication must not automatically give an entity access to an asset or security boundary. The lack of authorization-based access control could result in the immediate compromise and unauthorized access to sensitive information. All DoD systems must be properly configured to incorporate access control methods that do not rely solely on authentication for authorized access.

Authorization is the process of determining whether an entity, once authenticated, is permitted to access a specific asset. Information systems use access control policies and enforcement mechanisms to implement this requirement. Authorization procedures and controls must be implemented to ensure each authenticated entity also has a validated and current authorization.

Access control policies include identity-based policies, role-based policies, and attribute-based policies. Access enforcement mechanisms include access control lists, access control matrices, and cryptography. ALGs must use these policies and mechanisms to control access on behalf of the application for which it is acting as intermediary.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution       : "If user access control intermediary services are provided  as part of the traffic management functions of the BIG-IP Core, configure the BIG-IP APM module to enforce approved authorizations for logical access to information and system resources by employing identity-based, role-based, and/or attribute-based security policies."
      reference      : "800-171|3.1.1,800-171r3|03.01.02,800-53|AC-3,800-53r5|AC-3,CAT|II,CCI|CCI-000213,CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.PT-3,CSF2.0|PR.AA-05,CSF2.0|PR.DS-10,CSF2.0|PR.IR-01,DISA_Benchmark|F5_BIG-IP_Access_Policy_Manager_11-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO-27001-2022|A.5.15,ISO-27001-2022|A.5.33,ISO-27001-2022|A.8.3,ISO-27001-2022|A.8.18,ISO-27001-2022|A.8.20,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-215714r557355_rule,STIG-ID|F5BI-AP-000003,STIG-Legacy|SV-74359,STIG-Legacy|V-59929,TBA-FIISB|31.1,Vuln-ID|V-215714"
      see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_F5_BIG-IP_Y25M01_STIG.zip"
      f5_command     : "/tm/apm/profile/access"
      json_transform : ".items[] | \"Access Policy Name: \(.name)\""
      regex          : ".*"
      expect         : "^Manual Review Required$"
      severity       : MEDIUM
    </custom_item>

    <custom_item>
      description    : "F5BI-AP-000023 - The F5 BIG-IP appliance providing user access control intermediary services must display the Standard Mandatory DOD-approved Notice and Consent Banner before granting access to resources."
      info           : "Display of the DOD-approved use notification before granting access to the network device ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.

System use notifications are required only for access via logon interfaces with human users.

The banner must be formatted in accordance with DTM-08-060. Use the following verbiage for network elements that can accommodate banners of 1300 characters:

'You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.

By using this IS (which includes any device attached to this IS), you consent to the following conditions:

-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.

-At any time, the USG may inspect and seize data stored on this IS.

-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.

-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.

-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.'

Use the following verbiage for operating systems that have severe limitations on the number of characters that can be displayed in the banner:

'I've read & consent to terms in IS user agreem't.'

This policy only applies to ALGs (e.g., identity management or authentication gateways) that provide user account services as part of the intermediary services.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution       : "From the BIG-IP GUI:
1. Access.
2. Profiles/Policies.
3. Access Profiles.
4. Click 'Edit' under 'Per-Session Policy' for the Access Profile.
5. Click the '+' sign after the point in the policy where the user's UPN has been verified.
6. 'General Purpose' tab.
7. Select 'Decision Box'.
8. Click 'Add Item'.
9. Enter the DOD-approved Notice and Consent Banner in the Decision Box Title.

'You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.

By using this IS (which includes any device attached to this IS), you consent to the following conditions:

-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.

-At any time, the USG may inspect and seize data stored on this IS.

-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.

-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.

-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.'

Use the following verbiage for operating systems that have severe limitations on the number of characters that can be displayed in the banner:

'I've read & consent to terms in IS user agreem't.'

10. Click 'Save'.
11. Click 'Apply Access Policy'."
      reference      : "800-171|3.1.9,800-171r3|03.01.09,800-53|AC-8a.,800-53r5|AC-8a.,CAT|II,CCI|CCI-000048,DISA_Benchmark|F5_BIG-IP_Access_Policy_Manager_11-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.5,ITSG-33|AC-8a.,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,Rule-ID|SV-215715r947409_rule,STIG-ID|F5BI-AP-000023,STIG-Legacy|SV-74361,STIG-Legacy|V-59931,TBA-FIISB|45.2.4,Vuln-ID|V-215715"
      see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_F5_BIG-IP_Y25M01_STIG.zip"
      f5_command     : "/tm/apm/profile/access"
      json_transform : ".items[] | \"Access Policy Name: \(.name)\""
      regex          : ".*"
      expect         : "^Manual Review Required$"
      severity       : MEDIUM
    </custom_item>

    <custom_item>
      description    : "F5BI-AP-000025 - The BIG-IP APM module must retain the Standard Mandatory DoD-approved Notice and Consent Banner on the screen until users accessing virtual servers acknowledge the usage conditions and take explicit actions to log on for further access."
      info           : "The banner must be acknowledged by the user prior to allowing the user access to the network. This provides assurance that the user has seen the message and accepted the conditions for access. If the consent banner is not acknowledged by the user, DoD will not be in compliance with system use notifications required by law.

To establish acceptance of the application usage policy, a click-through banner at application logon is required. The network element must prevent further activity until the user executes a positive action to manifest agreement by clicking on a box indicating 'OK'.

This policy only applies to gateways (e.g., identity management or authentication gateways) that provide user account services as part of the intermediary services.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution       : "If user access control intermediary services are provided, configure an access policy in the BIG-IP APM module to retain the Standard Mandatory DoD-approved Notice and Consent Banner on the screen until users acknowledge the usage conditions and take explicit actions to log on for further access."
      reference      : "800-171|3.1.9,800-171r3|03.01.09,800-53|AC-8b.,800-53r5|AC-8b.,CAT|III,CCI|CCI-000050,DISA_Benchmark|F5_BIG-IP_Access_Policy_Manager_11-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.5,ITSG-33|AC-8b.,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10f,Rule-ID|SV-215716r557355_rule,STIG-ID|F5BI-AP-000025,STIG-Legacy|SV-74363,STIG-Legacy|V-59933,TBA-FIISB|45.2.4,Vuln-ID|V-215716"
      see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_F5_BIG-IP_Y25M01_STIG.zip"
      f5_command     : "/tm/apm/profile/access"
      json_transform : ".items[] | \"Access Policy Name: \(.name)\""
      regex          : ".*"
      expect         : "^Manual Review Required$"
      severity       : MEDIUM
    </custom_item>

    <custom_item>
      description    : "F5BI-AP-000027 - The BIG-IP APM module must display the Standard Mandatory DoD-approved Notice and Consent Banner before granting access to publicly accessible applications."
      info           : "Display of a standardized and approved use notification before granting access to the publicly accessible network element ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.

System use notifications are required only for access via logon interfaces with human users and are not required when such human interfaces do not exist. This requirement applies to network elements that have the concept of a user account and have the logon function residing on the network element.

The banner must be formatted in accordance with DTM-08-060. Use the following verbiage for network elements that can accommodate banners of 1300 characters:

'You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.

By using this IS (which includes any device attached to this IS), you consent to the following conditions:

-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.

-At any time, the USG may inspect and seize data stored on this IS.

-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.

-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.

-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.'

Use the following verbiage for operating systems that have severe limitations on the number of characters that can be displayed in the banner:

'I've read & consent to terms in IS user agreem't.'

This policy only applies to gateways (e.g., identity management or authentication gateways) that provide user account services as part of the intermediary services off-loaded from the application. Publicly access systems are used in DoD to provide benefit information, pay information, or public services. There may also be self-registration and authorization services provided by these gateways.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution       : "If user access control intermediary services are provided, configure an access policy in the BIG-IP APM module to display the Standard Mandatory DoD-approved Notice and Consent Banner before granting access to publicly accessible applications."
      reference      : "800-171|3.1.9,800-171r3|03.01.09,800-53|AC-8c.1.,800-53|AC-8c.2.,800-53|AC-8c.3.,800-53r5|AC-8c.1.,800-53r5|AC-8c.2.,800-53r5|AC-8c.3.,CAT|III,CCI|CCI-001384,CCI|CCI-001385,CCI|CCI-001386,CCI|CCI-001387,CCI|CCI-001388,DISA_Benchmark|F5_BIG-IP_Access_Policy_Manager_11-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.5,ITSG-33|AC-8c.a.,ITSG-33|AC-8c.b.,ITSG-33|AC-8c.c.,NESA|M5.2.5,NESA|T5.5.1,Rule-ID|SV-215717r557355_rule,STIG-ID|F5BI-AP-000027,STIG-Legacy|SV-74455,STIG-Legacy|V-60025,TBA-FIISB|45.2.4,Vuln-ID|V-215717"
      see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_F5_BIG-IP_Y25M01_STIG.zip"
      f5_command     : "/tm/apm/profile/access"
      json_transform : ".items[] | \"Access Policy Name: \(.name)\""
      regex          : ".*"
      expect         : "^Manual Review Required$"
      severity       : MEDIUM
    </custom_item>

    <custom_item>
      description    : "F5BI-AP-000073 - The BIG-IP APM module must uniquely identify and authenticate organizational users (or processes acting on behalf of organizational users) when connecting to virtual servers."
      info           : "To assure accountability and prevent unauthenticated access, organizational users must be identified and authenticated to prevent potential misuse and compromise of the system.

Organizational users include organizational employees or individuals the organization deems to have equivalent status of employees (e.g., contractors). Organizational users (and any processes acting on behalf of users) must be uniquely identified and authenticated for all accesses except the following:

1) Accesses explicitly identified and documented by the organization. Organizations document specific user actions that can be performed on the information system without identification or authentication; and

2) Accesses that occur through authorized use of group authenticators without individual authentication. Organizations may require unique identification of individuals in group accounts (e.g., shared privilege accounts) or for detailed accountability of individual activity.

This requirement applies to ALGs that provide user proxy services, including identification and authentication. This service must use the site's directory service (e.g., Active Directory). Directory services must not be installed onto the gateway.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution       : "If user access control intermediary services are provided, configure an access policy in the BIG-IP APM module to uniquely identify and authenticate organizational users (or processes acting on behalf of organizational users)."
      reference      : "800-171|3.5.1,800-171r3|03.05.01a.,800-53|IA-2,800-53r5|IA-2,CAT|II,CCI|CCI-000764,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|F5_BIG-IP_Access_Policy_Manager_11-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO-27001-2022|A.5.16,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-215718r557355_rule,STIG-ID|F5BI-AP-000073,STIG-Legacy|SV-74457,STIG-Legacy|V-60027,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-215718"
      see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_F5_BIG-IP_Y25M01_STIG.zip"
      f5_command     : "/tm/apm/profile/access"
      json_transform : ".items[] | \"Access Policy Name: \(.name)\""
      regex          : ".*"
      expect         : "^Manual Review Required$"
      severity       : MEDIUM
    </custom_item>

    <custom_item>
      description    : "F5BI-AP-000075 - The BIG-IP APM module must be configured with a pre-established trust relationship and mechanisms with appropriate authorities (e.g., Active Directory or authentication, authorization, and accounting (AAA) server) that validate user account access authorizations and privileges when providing access control to virtual servers."
      info           : "User account and privilege validation must be centralized in order to prevent unauthorized access using changed or revoked privileges.

ALGs can implement functions such as traffic filtering, authentication, access, and authorization functions based on computer and user privileges. However, the directory service (e.g., Active Directory or LDAP) must not be installed on the ALG, particularly if the gateway resides on the untrusted zone of the Enclave.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution       : "If user access control intermediary services are provided, configure an access policy in the BIG-IP APM module with a pre-established trust relationship and mechanisms with appropriate authorities that validate each user access authorization and privileges."
      reference      : "800-171|3.5.1,800-171r3|03.05.01a.,800-53|IA-2,800-53r5|IA-2,CAT|II,CCI|CCI-000764,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|F5_BIG-IP_Access_Policy_Manager_11-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO-27001-2022|A.5.16,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-215719r557355_rule,STIG-ID|F5BI-AP-000075,STIG-Legacy|SV-74459,STIG-Legacy|V-60029,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-215719"
      see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_F5_BIG-IP_Y25M01_STIG.zip"
      f5_command     : "/tm/apm/profile/access"
      json_transform : ".items[] | \"Access Policy Name: \(.name)\""
      regex          : ".*"
      expect         : "^Manual Review Required$"
      severity       : MEDIUM
    </custom_item>

    <custom_item>
      description    : "F5BI-AP-000077 - The BIG-IP APM module must restrict user authentication traffic to specific authentication server(s) when providing user authentication to virtual servers."
      info           : "User authentication can be used as part of the policy filtering rule sets. Some URLs or network resources can be restricted to authenticated users only. Users are prompted by the application or browser for credentials. Authentication service may be provided by the ALG as an intermediary for the application; however, the authentication credential must be stored in the site's directory services server.

This requirement only applies to components where this is specific to the function of the device or has the concept of an organizational user (e.g., proxy capability). This does not apply to authentication for the purpose of configuring the device itself (i.e., device management).

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution       : "If user authentication intermediary services are provided, configure an access policy in the BIG-IP APM module to restrict user authentication traffic to specific authentication server(s)."
      reference      : "800-171|3.5.1,800-171r3|03.05.01a.,800-53|IA-2,800-53r5|IA-2,CAT|II,CCI|CCI-000764,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|F5_BIG-IP_Access_Policy_Manager_11-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO-27001-2022|A.5.16,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-215720r557355_rule,STIG-ID|F5BI-AP-000077,STIG-Legacy|SV-74461,STIG-Legacy|V-60031,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-215720"
      see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_F5_BIG-IP_Y25M01_STIG.zip"
      f5_command     : "/tm/apm/profile/access"
      json_transform : ".items[] | \"Access Policy Name: \(.name)\""
      regex          : ".*"
      expect         : "^Manual Review Required$"
      severity       : MEDIUM
    </custom_item>

    <custom_item>
      description    : "F5BI-AP-000079 - The BIG-IP APM module must use multifactor authentication for network access to non-privileged accounts."
      info           : "To assure accountability and prevent unauthenticated access, non-privileged users must utilize multifactor authentication to prevent potential misuse and compromise of the system.

Multifactor authentication uses two or more factors to achieve authentication. Factors include:

1) Something you know (e.g., password/PIN);

2) Something you have (e.g., cryptographic, identification device, token); and

3) Something you are (e.g., biometric).

Non-privileged accounts are not authorized on the network element regardless of configuration.

Network access is any access to an application by a user (or process acting on behalf of a user) where said access is obtained through a network connection.

The DoD CAC with DoD-approved PKI is an example of multifactor authentication.

This requirement applies to ALGs that provide user authentication intermediary services.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution       : "If user authentication intermediary services are provided, configure an access policy in the BIG-IP APM module to use multifactor authentication for network access to non-privileged accounts."
      reference      : "800-171|3.5.3,800-171r3|03.05.03,800-53|IA-2(2),800-53r5|IA-2(2),CAT|II,CCI|CCI-000766,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|F5_BIG-IP_Access_Policy_Manager_11-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO-27001-2022|A.5.16,ITSG-33|IA-2(2),NESA|T5.4.2,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-215721r954210_rule,STIG-ID|F5BI-AP-000079,STIG-Legacy|SV-74463,STIG-Legacy|V-60033,SWIFT-CSCv1|1.2,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-215721"
      see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_F5_BIG-IP_Y25M01_STIG.zip"
      f5_command     : "/tm/apm/profile/access"
      json_transform : ".items[] | \"Access Policy Name: \(.name)\""
      regex          : ".*"
      expect         : "^Manual Review Required$"
      severity       : MEDIUM
    </custom_item>

    <custom_item>
      description    : "F5BI-AP-000085 - The BIG-IP APM module must map the authenticated identity to the user account for PKI-based authentication to virtual servers."
      info           : "Authorization for access to any network element requires an approved and assigned individual account identifier. To ensure only the assigned individual is using the account, the account must be bound to a user certificate when PKI-based authentication is implemented.

This requirement applies to ALGs that provide user authentication intermediary services (e.g., authentication gateway or TLS gateway). This does not apply to authentication for the purpose of configuring the device itself (device management).

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution       : "If the BIG-IP APM module provides PKI-based, user authentication intermediary services, configure a profile in the BIG-IP APM module to map the authenticated identity to the user account for PKI-based authentication."
      reference      : "800-171|3.5.2,800-171r3|03.05.12,800-53|IA-5(2)(c),800-53r5|IA-5(2)(a)(2),CAT|II,CCI|CCI-000187,CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|F5_BIG-IP_Access_Policy_Manager_11-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.17,ITSG-33|IA-5(2)(c),NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-215722r557355_rule,STIG-ID|F5BI-AP-000085,STIG-Legacy|SV-74465,STIG-Legacy|V-60035,Vuln-ID|V-215722"
      see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_F5_BIG-IP_Y25M01_STIG.zip"
      f5_command     : "/tm/apm/profile/access"
      json_transform : ".items[] | \"Access Policy Name: \(.name)\""
      regex          : ".*"
      expect         : "^Manual Review Required$"
      severity       : MEDIUM
    </custom_item>

    <custom_item>
      description    : "F5BI-AP-000087 - The BIG-IP APM module must be configured to uniquely identify and authenticate non-organizational users (or processes acting on behalf of non-organizational users) when connecting to virtual servers."
      info           : "Lack of authentication enables anyone to gain access to the network or possibly a network element that provides opportunity for intruders to compromise resources within the network infrastructure. By identifying and authenticating non-organizational users, their access to network resources can be restricted accordingly.

Non-organizational users will be uniquely identified and authenticated for all accesses other than those accesses explicitly identified and documented by the organization when related to the use of anonymous access. Authorization requires an individual account identifier that has been approved, assigned, and configured on an authentication server. Authentication of user identities is accomplished through the use of passwords, tokens, biometrics, or in the case of multifactor authentication, some combination thereof.

This control applies to application layer gateways that provide content filtering and proxy services on network segments (e.g., DMZ) that allow access by non-organizational users. This requirement focuses on authentication requests to the proxied application for access to destination resources and policy filtering decisions rather than administrator and management functions.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution       : "If the BIG-IP APM module provides user authentication intermediary services to non-organizational users, configure a profile in the BIG-IP APM module to uniquely identify and authenticate non-organizational users (or processes acting on behalf of non-organizational users) when connecting to virtual servers."
      reference      : "800-53|IA-8,800-53r5|IA-8,CAT|II,CCI|CCI-000804,CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|F5_BIG-IP_Access_Policy_Manager_11-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO-27001-2022|A.5.16,ITSG-33|IA-8,ITSG-33|IA-8a.,NESA|T4.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-215723r557355_rule,STIG-ID|F5BI-AP-000087,STIG-Legacy|SV-74467,STIG-Legacy|V-60037,SWIFT-CSCv1|2.8,Vuln-ID|V-215723"
      see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_F5_BIG-IP_Y25M01_STIG.zip"
      f5_command     : "/tm/apm/profile/access"
      json_transform : ".items[] | \"Access Policy Name: \(.name)\""
      regex          : ".*"
      expect         : "^Manual Review Required$"
      severity       : MEDIUM
    </custom_item>

    <custom_item>
      description    : "F5BI-AP-000147 - The BIG-IP APM module access policy profile must be configured to automatically terminate user sessions for users connected to virtual servers when organization-defined conditions or trigger events occur that require a session disconnect."
      info           : "Automatic session termination addresses the termination of user-initiated logical sessions in contrast to the termination of network connections that are associated with communications sessions (i.e., network disconnect). A logical session (for local, network, and remote access) is initiated whenever a user (or process acting on behalf of a user) accesses an organizational information system. Such user sessions can be terminated (and thus terminate user access) without terminating network sessions.

Session termination terminates all processes associated with a user's logical session except those processes that are specifically created by the user (i.e., session owner) to continue after the session is terminated.

This capability is typically reserved for specific system functionality where the system owner, data owner, or organization requires additional trigger events based on specific mission needs. Conditions or trigger events requiring automatic session termination can include, for example, targeted responses to certain types of incidents and time-of-day restrictions on information system use.

This policy only applies to gateways (e.g., identity management or authentication gateways) that provide user account services as part of the intermediary services.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution       : "If user access control intermediary services are provided, configure an access policy in the BIG-IP APM module to automatically terminate a user session when organization-defined conditions or trigger events occur that require a session disconnect."
      reference      : "800-171|3.1.11,800-171r3|03.01.11,800-53|AC-12,800-53r5|AC-12,CAT|II,CCI|CCI-002361,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSF2.0|PR.AA-03,DISA_Benchmark|F5_BIG-IP_Access_Policy_Manager_11-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ITSG-33|AC-12,NIAv2|NS49,Rule-ID|SV-230211r856822_rule,STIG-ID|F5BI-AP-000147,STIG-Legacy|SV-74469,STIG-Legacy|V-60039,Vuln-ID|V-230211"
      see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_F5_BIG-IP_Y25M01_STIG.zip"
      f5_command     : "/tm/apm/profile/access"
      json_transform : ".items[] | \"Access Policy Name: \(.name)\""
      regex          : ".*"
      expect         : "^Manual Review Required$"
      severity       : MEDIUM
    </custom_item>

    <custom_item>
      description    : "F5BI-AP-000151 - The BIG-IP APM module access policy profile must be configured to display an explicit logoff message to users, indicating the reliable termination of authenticated communications sessions when disconnecting from virtual servers."
      info           : "If a user cannot explicitly end a session, the session may remain open and be exploited by an attacker; this is referred to as a zombie session. Users need to be aware of whether or not the session has been terminated.

Logoff messages for access, for example, can be displayed after authenticated sessions have been terminated. However, for some types of interactive sessions, including, for example, remote logon, information systems typically send logoff messages as final messages prior to terminating sessions.

This policy only applies to ALGs (e.g., identity management or authentication gateways) that provide user account services as part of the intermediary services.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution       : "If user access control intermediary services are provided, configure the BIG-IP APM module to display an explicit logoff message to users indicating the reliable termination of authenticated communications sessions."
      reference      : "800-171|3.1.11,800-171|3.4.2,800-171r3|03.01.11,800-171r3|03.04.02a.,800-53|AC-12(1),800-53|CM-6b.,800-53r5|AC-12(2),800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CCI|CCI-002364,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF2.0|DE.CM-09,CSF2.0|PR.AA-03,CSF2.0|PR.PS-01,DISA_Benchmark|F5_BIG-IP_Access_Policy_Manager_11-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO-27001-2022|A.8.9,ITSG-33|AC-12,ITSG-33|CM-6b.,NESA|T3.2.1,NIAv2|NS49,Rule-ID|SV-230212r856824_rule,STIG-ID|F5BI-AP-000151,STIG-Legacy|SV-74471,STIG-Legacy|V-60041,SWIFT-CSCv1|2.3,Vuln-ID|V-230212"
      see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_F5_BIG-IP_Y25M01_STIG.zip"
      f5_command     : "/tm/apm/profile/access"
      json_transform : ".items[] | \"Access Policy Name: \(.name)\""
      regex          : ".*"
      expect         : "^Manual Review Required$"
      severity       : MEDIUM
    </custom_item>

    <custom_item>
      description    : "F5BI-AP-000153 - The BIG-IP APM module access policy profile must control remote access methods to virtual servers."
      info           : "Remote access devices, such as those providing remote access to network devices and information systems, which lack automated control capabilities, increase risk and make remote user access management difficult at best.

Remote access is access to DoD nonpublic information systems by an authorized user (or an information system) communicating through an external, non-organization-controlled network. Remote access methods include broadband and wireless connections. Remote access methods include, for example, proxied remote encrypted traffic (e.g., TLS gateways, web content filters, and webmail proxies).

This requirement applies to ALGs providing remote access proxy services as part of its intermediary services (e.g., OWA or TLS gateway). ALGs that proxy remote access must be capable of taking enforcement action (i.e., blocking, restricting, or forwarding to an enforcement mechanism) if traffic monitoring reveals unauthorized activity.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution       : "If intermediary services for remote access communications traffic are provided, configure the BIG-IP APM module to control remote access methods."
      reference      : "800-171|3.1.12,800-171r3|03.01.12,800-53|AC-17(1),800-53r5|AC-17(1),CAT|II,CCI|CCI-002314,CN-L3|8.1.4.4(c),CN-L3|8.1.10.6(i),CSF|PR.AC-3,CSF|PR.PT-4,CSF2.0|PR.AA-05,DISA_Benchmark|F5_BIG-IP_Access_Policy_Manager_11-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO-27001-2022|A.8.16,ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17(1),NESA|T5.4.4,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,Rule-ID|SV-215726r831441_rule,STIG-ID|F5BI-AP-000153,STIG-Legacy|SV-74473,STIG-Legacy|V-60043,SWIFT-CSCv1|2.6,Vuln-ID|V-215726"
      see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_F5_BIG-IP_Y25M01_STIG.zip"
      f5_command     : "/tm/apm/profile/access"
      json_transform : ".items[] | \"Access Policy Name: \(.name)\""
      regex          : ".*"
      expect         : "^Manual Review Required$"
      severity       : MEDIUM
    </custom_item>

    <custom_item>
      description    : "F5BI-AP-000191 - The BIG-IP APM module must require users to reauthenticate when the user's role or information authorizations are changed."
      info           : "Without reauthentication, users may access resources or perform tasks for which authorization has been removed.

In addition to the reauthentication requirements associated with session locks, organizations may require reauthentication of individuals and/or devices in other situations. Within the DOD, the minimum circumstances requiring reauthentication are privilege escalation and role changes.

This requirement only applies to components where this is specific to the function of the device or has the concept of user authentication (e.g., VPN or ALG capability). This does not apply to authentication for the purpose of configuring the device itself (i.e., device management).

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution       : "Configure an access policy in the BIG-IP APM module to require users to reauthenticate when the user's role or information authorizations are changed.

This will also require the administrator to force reauthentication when changes occur that the system cannot automatically detect. Update administrator training and the site's SSP to document this process."
      reference      : "800-171r3|03.05.01b.,800-53|IA-11,800-53r5|IA-11,CAT|II,CCI|CCI-002038,CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|F5_BIG-IP_Access_Policy_Manager_11-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(d),QCSC-v1|13.2,Rule-ID|SV-215727r1050784_rule,STIG-ID|F5BI-AP-000191,STIG-Legacy|SV-74475,STIG-Legacy|V-60045,Vuln-ID|V-215727"
      see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_F5_BIG-IP_Y25M01_STIG.zip"
      f5_command     : "/tm/apm/profile/access"
      json_transform : ".items[] | \"Access Policy Name: \(.name)\""
      regex          : ".*"
      expect         : "^Manual Review Required$"
      severity       : MEDIUM
    </custom_item>

    <custom_item>
      description    : "F5BI-AP-000193 - The BIG-IP APM module must be configured to require multifactor authentication for remote access with non-privileged accounts to virtual servers in such a way that one of the factors is provided by a device separate from the system gaining access."
      info           : "For remote access to non-privileged accounts, the purpose of requiring a device that is separate from the information system gaining access for one of the factors during multifactor authentication is to reduce the likelihood of compromising authentication credentials stored on the system.

Multifactor solutions that require devices separate from information systems gaining access include, for example, hardware tokens providing time-based or challenge-response authenticators and smart cards such as the U.S. Government Personal Identity Verification card and the DoD common access card.

A privileged account is defined as an information system account with authorizations of a privileged user.

Remote access is access to DoD nonpublic information systems by an authorized user (or an information system) communicating through an external, non-organization-controlled network. Remote access methods include, for example, dial-up, broadband, and wireless.

An example of compliance with this requirement is the use of a one-time password token and PIN coupled with a password or the use of a CAC/PIV card and PIN coupled with a password.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution       : "If user authentication intermediary services are provided, configure an access policy in the BIG-IP APM module to require multifactor authentication for remote access to non-privileged accounts in such a way that one of the factors is provided by a device separate from the system gaining access."
      reference      : "800-171|3.5.1,800-171r3|03.05.01a.,800-53|IA-2(11),800-53r5|IA-2(6),CAT|II,CCI|CCI-001951,CN-L3|8.1.4.1(d),CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|F5_BIG-IP_Access_Policy_Manager_11-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO-27001-2022|A.5.16,ITSG-33|IA-2(100),NESA|T5.4.2,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSSv3.2.1|8.3,PCI-DSSv3.2.1|8.3.1,PCI-DSSv3.2.1|8.3.2,PCI-DSSv4.0|8.4.1,PCI-DSSv4.0|8.4.3,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-215728r981642_rule,STIG-ID|F5BI-AP-000193,STIG-Legacy|SV-74477,STIG-Legacy|V-60047,SWIFT-CSCv1|4.2,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-215728"
      see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_F5_BIG-IP_Y25M01_STIG.zip"
      f5_command     : "/tm/apm/profile/access"
      json_transform : ".items[] | \"Access Policy Name: \(.name)\""
      regex          : ".*"
      expect         : "^Manual Review Required$"
      severity       : MEDIUM
    </custom_item>

    <custom_item>
      description    : "F5BI-AP-000195 - The BIG-IP APM module must be configured to require multifactor authentication for remote access with privileged accounts to virtual servers in such a way that one of the factors is provided by a device separate from the system gaining access."
      info           : "For remote access to privileged accounts, the purpose of requiring a device that is separate from the information system gaining access for one of the factors during multifactor authentication is to reduce the likelihood of compromising authentication credentials stored on the system.

Multifactor solutions that require devices separate from information systems gaining access include, for example, hardware tokens providing time-based or challenge-response authenticators and smart cards such as the U.S. Government Personal Identity Verification card and the DoD common access card.

A privileged account is defined as an information system account with authorizations of a privileged user.

Remote access is access to DoD nonpublic information systems by an authorized user (or an information system) communicating through an external, non-organization-controlled network. Remote access methods include, for example, dial-up, broadband, and wireless.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution       : "If user authentication intermediary services are provided, configure an access policy in the BIG-IP APM module to require multifactor authentication for remote access to privileged accounts in such a way that one of the factors is provided by a device separate from the system gaining access."
      reference      : "800-171|3.5.1,800-171r3|03.05.01a.,800-53|IA-2(11),800-53r5|IA-2(6),CAT|II,CCI|CCI-001948,CN-L3|8.1.4.1(d),CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|F5_BIG-IP_Access_Policy_Manager_11-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO-27001-2022|A.5.16,ITSG-33|IA-2(100),NESA|T5.4.2,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSSv3.2.1|8.3,PCI-DSSv3.2.1|8.3.1,PCI-DSSv3.2.1|8.3.2,PCI-DSSv4.0|8.4.1,PCI-DSSv4.0|8.4.3,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-215729r981643_rule,STIG-ID|F5BI-AP-000195,STIG-Legacy|SV-74479,STIG-Legacy|V-60049,SWIFT-CSCv1|4.2,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-215729"
      see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_F5_BIG-IP_Y25M01_STIG.zip"
      f5_command     : "/tm/apm/profile/access"
      json_transform : ".items[] | \"Access Policy Name: \(.name)\""
      regex          : ".*"
      expect         : "^Manual Review Required$"
      severity       : MEDIUM
    </custom_item>

    <report type:"WARNING">
      description : "F5BI-AP-000211 - The BIG-IP APM module must conform to FICAM-issued profiles."
      info        : "Without conforming to Federal Identity, Credential, and Access Management (FICAM)-issued profiles, the information system may not be interoperable with FICAM-authentication protocols, such as SAML 2.0 and OpenID 2.0.

Use of FICAM-issued profiles addresses open identity management standards.

This requirement only applies to components where this is specific to the function of the device or has the concept of a non-organizational user, (e.g., ALG capability that is the front end for an application in a DMZ).

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "If the BIG-IP APM module provides user authentication intermediary services to non-organizational users, configure a profile in the BIG-IP APM module that conforms to FICAM-issued profiles."
      reference   : "800-53|IA-8(4),800-53r5|IA-8(4),CAT|II,CCI|CCI-002014,CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|F5_BIG-IP_Access_Policy_Manager_11-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO-27001-2022|A.5.16,ITSG-33|IA-8,ITSG-33|IA-8a.,NESA|T4.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-215735r981646_rule,STIG-ID|F5BI-AP-000211,STIG-Legacy|SV-74491,STIG-Legacy|V-60061,SWIFT-CSCv1|2.8,Vuln-ID|V-215735"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_F5_BIG-IP_Y25M01_STIG.zip"
    </report>

    <report type:"WARNING">
      description : "F5BI-AP-000229 - The BIG-IP APM module must be configured to handle invalid inputs in a predictable and documented manner that reflects organizational and system objectives."
      info        : "A common vulnerability of network elements is unpredictable behavior when invalid inputs are received. This requirement guards against adverse or unintended system behavior caused by invalid inputs, where information system responses to the invalid input may be disruptive or cause the system to fail into an unsafe state.

The behavior will be derived from the organizational and system requirements and includes, but is not limited to, notifying the appropriate personnel, creating an audit record, and rejecting invalid input.

This requirement applies to gateways and firewalls that perform content inspection or have higher layer proxy functions.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Configure the BIG-IP APM module to handle invalid inputs in a predictable and documented manner that reflects organizational and system objectives."
      reference   : "800-53|SI-10(3),800-53r5|SI-10(3),CAT|II,CCI|CCI-002754,CN-L3|8.1.4.4(d),CSF2.0|PR.DS-10,DISA_Benchmark|F5_BIG-IP_Access_Policy_Manager_11-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-10,ITSG-33|SI-10a.,NESA|T7.3.1,NIAv2|SS6e,Rule-ID|SV-215736r831446_rule,STIG-ID|F5BI-AP-000229,STIG-Legacy|SV-74493,STIG-Legacy|V-60063,Vuln-ID|V-215736"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_F5_BIG-IP_Y25M01_STIG.zip"
    </report>

    <custom_item>
      description    : "F5BI-AP-000230 - The F5 BIG-IP appliance must be configured to set a 'Maximum Session Timeout' value of 8 hours or less - Maximum Session Timeout value of 8 hours or less."
      info           : "The Maximum Session Timeout setting configures a limit on the maximum amount of time a user's session is active without needing to reauthenticate. If the value is set to 0 (zero), the user's session is active until either the user terminates the session or the Inactivity Timeout value is reached (the default value is set to 604,800 seconds). When determining how long the maximum user session can last, it may be useful to review the access policy. For example, if the access policy requires that the user's antivirus signatures cannot be older than 8 hours, the Maximum Session Timeout should not exceed that time limit."
      solution       : "From the BIG-IP GUI:
1. Access.
2. Profiles/Policies.
3. Access Profiles.
4. Click the Access profile name.
5. In the 'Settings' section, set the value for 'Maximum Session Timeout' to 28800 seconds (8 hours) or less.
Note: If the setting is grayed out, check the box to the right of the setting and then update it.
6. Click 'Update'.
7. Click 'Apply Access Policy'."
      reference      : "800-171r3|03.05.01b.,800-53|IA-11,800-53r5|IA-11,CAT|II,CCI|CCI-002038,CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|F5_BIG-IP_Access_Policy_Manager_11-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(d),QCSC-v1|13.2,Rule-ID|SV-259330r1050784_rule,STIG-ID|F5BI-AP-000230,Vuln-ID|V-259330"
      see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_F5_BIG-IP_Y25M01_STIG.zip"
      f5_command     : "/tm/apm/profile/access"
      json_transform : ".items[] | \"Access Policy '\(.name)' Maximum Session Timeout: \(.maxSessionTimeout)\""
      regex          : "Maximum Session Timeout:[\s]*.*"
      expect         : "Maximum Session Timeout:[\s]*(?:[1-9]|[1-9][0-9]{1,3}|1[0-9]{4}|2[0-7][0-9]{3}|28[0-7][0-9]{2}|28800)$"
      match_all      : YES
    </custom_item>

    <custom_item>
      description    : "F5BI-AP-000231 - The F5 BIG-IP appliance must be configured to deny access when revocation data is unavailable using OCSP."
      info           : "Without configuring a local cache of revocation data, there is the potential to allow access to users who are no longer authorized (users with revoked certificates).

Caching of CRL files on BIG-IP is not feasible or possible due to the large sizes of DOD/DISA CRL files. Use the alternate mitigation, configuring the system to deny access when revocation data is unavailable, which is done in the APM VPE.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution       : "Update the OCSP Auth.

From the BIG-IP GUI:
1. Access.
2. Profiles/Policies.
3. Access Profiles.
4. Click 'Edit' under 'Per-Session Policy' for the Access Profile.
5. Add an 'OCSP Auth' in the Access Profile.
Note: To create an OCSP Responder, go to Access >> Authentication >> OCSP Responder.
6. Ensure the fallback branch goes to a 'Deny' ending.
7. Click 'Apply Access Policy'."
      reference      : "800-171|3.5.2,800-171r3|03.05.12,800-53|IA-5(2)(d),800-53r5|IA-5(2)(b)(2),CAT|II,CCI|CCI-001991,CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|F5_BIG-IP_Access_Policy_Manager_11-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.17,ITSG-33|IA-5(2),NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-260050r981644_rule,STIG-ID|F5BI-AP-000231,Vuln-ID|V-260050"
      see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_F5_BIG-IP_Y25M01_STIG.zip"
      f5_command     : "/tm/apm/profile/access"
      json_transform : ".items[] | \"Access Policy Name: \(.name)\""
      regex          : ".*"
      expect         : "^Manual Review Required$"
      severity       : MEDIUM
    </custom_item>

    <custom_item>
      description    : "F5BI-AP-000232 - The F5 BIG-IP appliance must configure OCSP to ensure revoked user credentials are prohibited from establishing an allowed session."
      info           : "A certificate's certification path is the path from the end entity certificate to a trusted root certification authority (CA). Certification path validation is necessary for a relying party to make an informed decision regarding acceptance of an end entity certificate.

Certification path validation includes checks such as certificate issuer trust, time validity, and revocation status for each certificate in the certification path. Revocation status information for CA and subject certificates in a certification path is commonly provided via certificate revocation lists (CRLs) or online certificate status protocol (OCSP) responses.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution       : "Add OCSP Auth to Access Policy.

From the BIG-IP GUI:
1. Access.
2. Profiles/Policies.
3. Access Profiles.
4. Click 'Edit' under 'Per-Session Policy' for the Access Profile.
5. Add an 'OCSP Auth' with certificate type of 'User' and/or a 'CRLDP Auth' object in the Access Profile.
Note: To create an OCSP Responder, go to Access >> Authentication >> OCSP Responder.
Note: To create a CRLDP Server object, go to Access >> Authentication >> CRLDP. Add an 'OCSP Auth' object in the Access Profile and select an OCSP Responder.
6. Click 'Update'."
      reference      : "800-171|3.5.2,800-171r3|03.05.12,800-53|IA-5(2)(a),800-53r5|IA-5(2)(b)(1),CAT|II,CCI|CCI-000185,CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|F5_BIG-IP_Access_Policy_Manager_11-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.17,ITSG-33|IA-5(2)(a),NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-260051r947407_rule,STIG-ID|F5BI-AP-000232,Vuln-ID|V-260051"
      see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_F5_BIG-IP_Y25M01_STIG.zip"
      f5_command     : "/tm/apm/profile/access"
      json_transform : ".items[] | \"Access Policy Name: \(.name)\""
      regex          : ".*"
      expect         : "^Manual Review Required$"
      severity       : MEDIUM
    </custom_item>

    <custom_item>
      description    : "F5BI-AP-000233 - The F5 BIG-IP appliance must configure OCSP to ensure revoked machine credentials are prohibited from establishing an allowed session."
      info           : "A certificate's certification path is the path from the end entity certificate to a trusted root certification authority (CA). Certification path validation is necessary for a relying party to make an informed decision regarding acceptance of an end entity certificate.

Certification path validation includes checks such as certificate issuer trust, time validity, and revocation status for each certificate in the certification path. Revocation status information for CA and subject certificates in a certification path is commonly provided via certificate revocation lists (CRLs) or online certificate status protocol (OCSP) responses.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution       : "If the Access Profile is configured to pull a machine cert using the 'Machine Cert Auth' object in the policy, perform the following actions. Note that pulling a Machine Cert requires the use of the APM Edge Client installed on the client.

To add OCSP machine certificate verification to an access policy:

From the BIG-IP GUI:
1. Access.
2. Profiles/Policies.
3. Access Profiles.
4. Click 'Edit' under 'Per-Session Policy' for the Access Profile.
5. Click the '+' icon on the Successful branch of the Machine Cert Auth object.
6. 'Authentication' tab.
7. Select OCSP Auth.
8. Click 'Add Item'.
9. From the OCSP Responder list, select an OCSP responder.
Note: To create an OCSP Responder. go to Access >> Authentication >> OCSP Responder.
10. From the Certificate Type list, select 'Machine'.
11. Click 'Save'.
12. Click 'Apply Access Policy'.

To add CRLDP certificate verification to an access policy:

From the BIG-IP GUI:
1. Access.
2. Profiles/Policies.
3. Access Profiles.
4. Click 'Edit' under 'Per-Session Policy' for the Access Profile.
5. Click the '+' icon on the Successful branch of the Machine Cert Auth object.
6. 'Authentication' tab.
7. Select CRLDP Auth.
8. Click 'Add Item'.
9. Select an item from the CRLDP Server list.
Note: To create a CRLDP Server, go to Access >> Authentication >> CRLDP.
10. Click 'Save'.
11. Click 'Apply Access Policy'."
      reference      : "800-171|3.5.2,800-171r3|03.05.12,800-53|IA-5(2)(a),800-53r5|IA-5(2)(b)(1),CAT|II,CCI|CCI-000185,CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,DISA_Benchmark|F5_BIG-IP_Access_Policy_Manager_11-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.17,ITSG-33|IA-5(2)(a),NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-260052r947419_rule,STIG-ID|F5BI-AP-000233,Vuln-ID|V-260052"
      see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_F5_BIG-IP_Y25M01_STIG.zip"
      f5_command     : "/tm/apm/profile/access"
      json_transform : ".items[] | \"Access Policy Name: \(.name)\""
      regex          : ".*"
      expect         : "^Manual Review Required$"
      severity       : MEDIUM
    </custom_item>

    <custom_item>
      description    : "F5BI-AP-000234 - The F5 BIG-IP appliance must not use the On-Demand Cert Auth VPE agent as part of the APM Policy Profiles."
      info           : "By requiring mutual authentication before any communication, it becomes significantly challenging for attackers to impersonate a client or server and exploit vulnerabilities. Furthermore, the encryption of all data transmitted between the client and server ensures that even if an attacker intercepts the data, it remains unintelligible without the correct keys.

To ensure the use of the mutual TLS (mTLS) for session authentication, the On-Demand Cert Auth VPE agent should not be used. Typically, when a client makes an HTTPS request, an SSL handshake request occurs at the start of an SSL session. However, if On-Demand is configured, the client SSL profile skips the initial SSL handshake, and On-Demand Cert Auth action can renegotiate the SSL connection from an access policy by sending a certificate request to the user. This prompts a certificate screen to open. Setting ODCA to 'require' the client cert means the client cannot get any further in the APM VPE without providing a valid certificate. 'Request' would ask the client for a certificate, but the client could still continue if they did not provide one. Thus, the Client Certificate should be set to 'require' in the client SSL profile (F5BI-LT-000213) since removing ODCA from the VPE alone will result in the client never being prompted for a certificate.

Within the Virtual Policy Editor (VPE) of the relevant Access Profile, do not use the On-Demand Cert Auth VPE agent. Configure only the Client Certification Inspection VPE Agent. This adjustment directs the BIG-IP to scrutinize the Client Certificate during the mTLS handshake process and extract the Certificate's details into APM session variables.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution       : "Remove On-Demand Cert.

From the BIG-IP GUI:
1. Access.
2. Profiles/Policies.
3. Access Profiles.
4. Click 'Edit' under 'Per-Session Policy' for the Access Profile.
5. Remove any 'On-Demand Cert Auth' agents in the profile.
6. Add a 'Client Cert Inspection' object in place of the previous 'On Demand Cert Auth' agent.
7. Click 'Apply Access Policy'."
      reference      : "800-171|3.13.15,800-171r3|03.13.15,800-53|SC-23,800-53r5|SC-23,CAT|II,CCI|CCI-001184,DISA_Benchmark|F5_BIG-IP_Access_Policy_Manager_11-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-23,ITSG-33|SC-23a.,NESA|T4.5.1,QCSC-v1|5.2.1,Rule-ID|SV-260053r947421_rule,STIG-ID|F5BI-AP-000234,Vuln-ID|V-260053"
      see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_F5_BIG-IP_Y25M01_STIG.zip"
      f5_command     : "/tm/apm/profile/access"
      json_transform : ".items[] | \"Access Policy Name: \(.name)\""
      regex          : ".*"
      expect         : "^Manual Review Required$"
      severity       : MEDIUM
    </custom_item>

    <custom_item>
      description    : "F5BI-AP-000235 - The F5 BIG-IP appliance APM Access Policies that grant access to web application resources must allow only client certificates that have the User Persona Name (UPN) value in the User Persona Client Certificates."
      info           : "To enhance the security, it is advisable to append additional checks and APM Deny/Fallback branches to APM Access Profiles in scenarios where a UPN cannot be extracted. To guarantee the exclusive use of User Persona DISA Certificates for accessing Web Applications, it is recommended to carry out additional APM Access Policy checks against the Client Certificate. DISA incorporates a User Principal Name (UPN) in their User Persona Client Certificates. However, this key/value pair is not present in the DISA server certificates.

Based on DOD session authentication policy, the LTM+APM configuration will include Client Certificate Authentication, OCSP Revocation Check, a Variable Assignment to extract the UserPrincipalName, followed by an LDAP query. This query verifies the existence of a corresponding Active Directory User object for the provided UserPrincipalName. Subsequently, the identified sAMAccountName is set as an APM Session variable for use by the SSO Profile. Once an APM LTM+APM session is granted, the User-Agent is permitted to transmit data to the Server-Side of the proxy, which will invoke the SSO Profile if applicable.

To ensure that only DISA Client Certificates from CACs can access the Web Application, an additional branch was added to the Variable Assignment. The scripts were adjusted to verify the existence of the UserPrincipalName. If it does not exist, the value of the UserPrincipalName APM session variable is set to 'UPN Collection Error', which would be directed to an APM Policy Deny.

NPE Certificates issued by DISA incorporate both the TLS WWW Client Authentication (OID.1.3.6.1.5.5.7.3.2) and TLS WWW Server Authentication
(OID.1.3.6.1.5.5.7.3.1) key usage policies.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution       : "Note: If NPE certificates are not in use, implementation is REQUIRED.

Note: If NPE certificates are in use, implementation is OPTIONAL. Sites should test this configuration to prevent operational impacts since this process may potentially flag server and NPE certificates, resulting in denied sessions.

Configure each APM Access Policy to verify use of user persona DISA client certificates for accessing web applications.

From the BIG-IP GUI:
1. Access.
2. Profiles/Policies.
3. Access Profiles.
4. Click 'Edit' on each profile listed to enter the VPE.
5. Click on the object where the Certificate UPN is extracted and assigned to a variable.
6. Append a known variable to the end of the variable assignment expression that will trigger if the UPN cannot be extracted from the client certificate, such as:

else {
  return 'UPN Collection Error'
}

7. Click 'Finished'.
8. In the same Variable Assign object, click the 'Branch Rules' tab.
9. On the branch that continues the policy evaluation (Does not lead to Deny ending) click the 'change' link next to 'Expression'.
10. 'Advanced' tab.
11. Enter an expression that verifies the UPN was extracted successfully, such as:

expr {[mcget {session.logon.last.upn}] !='UPN Collection Error'}
Note - the above assumes the UPN variable name is 'session.logon.last.upn'. Adjust this if another variable name is used to store the client UPN.

12. Click 'Finished'.
13. Click 'Save'.
14. Click 'Apply Access Policy'."
      reference      : "800-171|3.13.15,800-171r3|03.13.15,800-53|SC-23(5),800-53r5|SC-23(5),CAT|III,CCI|CCI-002470,DISA_Benchmark|F5_BIG-IP_Access_Policy_Manager_11-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-23,ITSG-33|SC-23a.,NESA|T4.5.1,QCSC-v1|5.2.1,Rule-ID|SV-260054r947386_rule,STIG-ID|F5BI-AP-000235,Vuln-ID|V-260054"
      see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_F5_BIG-IP_Y25M01_STIG.zip"
      f5_command     : "/tm/apm/profile/access"
      json_transform : ".items[] | \"Access Policy Name: \(.name)\""
      regex          : ".*"
      expect         : "^Manual Review Required$"
      severity       : MEDIUM
    </custom_item>

    <custom_item>
      description    : "F5BI-AP-000236 - The F5 BIG-IP appliance must be configured to limit authenticated client sessions to initial session source IP."
      info           : "The 'Restrict to Single Client IP' is a safeguard against session hijacking or cookie theft. Even if an attacker manages to steal a session cookie, the cookie cannot be used from a different source IP address that the address used to initiate the session. This security measure is set within the APM Access Pro?les.

Sites should test this setting within their network prior to implementing. Users behind a shared proxy address may be denied access. Optionally, the F5 BIG-IP APM can be installed and used to produce access reports to find recurring IP sources within the user community."
      solution       : "Note: Implementation is OPTIONAL. Setting should be tested to ensure that a denial of service (DoS) does not result.

From the BIG-IP GUI:
1. System.
2. Access.
3. Profiles/Policies.
4. Access Profiles.
5. Click the Access profile name.
6. Under 'Settings', check 'Restrict to Single Client IP'.
Note: If the box is grayed out, check the box all the way to the right of the setting first and then check the box.
7. Click 'Update'.
8. Click 'Apply Access Policy'."
      reference      : "800-171|3.13.15,800-171r3|03.13.15,800-53|SC-23,800-53r5|SC-23,CAT|III,CCI|CCI-001184,DISA_Benchmark|F5_BIG-IP_Access_Policy_Manager_11-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-23,ITSG-33|SC-23a.,NESA|T4.5.1,QCSC-v1|5.2.1,Rule-ID|SV-260055r947390_rule,STIG-ID|F5BI-AP-000236,Vuln-ID|V-260055"
      see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_F5_BIG-IP_Y25M01_STIG.zip"
      f5_command     : "/tm/apm/profile/access"
      json_transform : ".items[] | \"Access Policy Name: \(.name), Restrict to Single Client IP: \" + .restrictToSingleClientIp"
      regex          : ".*"
      expect         : "true$"
      match_all      : YES
    </custom_item>

    <custom_item>
      description    : "F5BI-AP-000239 - The F5 BIG-IP appliance must be configured to set the 'Max In Progress Sessions per Client IP' value to 10 or less - Max In Progress Sessions per Client IP value to 10 or less."
      info           : "The 'Max In Progress Sessions Per Client IP' setting in an APM Access Pro?le is a security con?guration that limits the number of simultaneous sessions that can be initiated from a single IP address. This is particularly helpful in preventing a session ?ood, where a hacker might attempt to overwhelm the system by initiating many sessions from a single source. By capping the number of sessions per IP, this setting can help maintain the system's stability and integrity while also providing a layer of protection against such potential attacks.

False positives may result from this setting in networks where users are behind a shared proxy. Sites should conduct operational testing to determine if there are adverse operational impacts. Log reports should be obtained to identify recurring IP sources within the user community."
      solution       : "Note: Implementation is OPTIONAL. This setting may break some known proxies. Testing should be performed in advance to prevent operational impact.

From the BIG-IP GUI:
1. Access.
2. Profiles/Policies.
3. Access Profiles.
4. Click the Access profile name.
5. In the 'Settings' section, set 'Max In Progress Sessions per Client IP' to 10 or less.
Note: If the setting is grayed out, check the box to the right of the setting and then update it.
6. Click 'Update'.
7. Click 'Apply Access Policy'."
      reference      : "800-53|AC-10,800-53r5|AC-10,CAT|III,CCI|CCI-000054,CSF2.0|PR.AA-05,DISA_Benchmark|F5_BIG-IP_Access_Policy_Manager_11-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-10,NESA|T5.5.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,Rule-ID|SV-260056r947393_rule,STIG-ID|F5BI-AP-000239,Vuln-ID|V-260056"
      see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_F5_BIG-IP_Y25M01_STIG.zip"
      f5_command     : "/tm/apm/profile/access"
      json_transform : ".items[] | \"Access Policy Name: \(.name), Max In Progress Sessions per Client IP: \" + (.maxInProgressSessions|tostring)"
      regex          : ".*"
      expect         : "Max In Progress Sessions per Client IP: ([0-9]|10)\b"
      match_all      : YES
    </custom_item>

    <custom_item>
      description    : "F5BI-AP-000240 - The F5 BIG-IP appliance must enforce approved authorizations for logical access to resources by explicitly configuring assigned resources with an authorization list."
      info           : "Authentication alone must not be sufficient to assign APM resources to a connecting client. Access to APM resources (e.g., Portal, VPN, Webtop, Remote Desktop, etc.,) must be granted only after a successful authorization check occurs. Resource assignments can be configured using APM Access Policy Advanced Resource Assign VPE agents and Resource Assign VPE agents. These agents must be configured explicitly with an authorization list. If resources are assigned to these types of agents with empty expressions, that expression acts as the default authorization list.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution       : "For each APM Access Policy, ensure that for each resource, all Advanced Resource Assign agents used in the configuration are explicitly configured to use an authorization list.

From the BIG-IP GUI:
1. Access.
2. Profiles/Policies.
3. Access Profiles.
4. Click 'Edit' under 'Per-Session Policy' for the Access Profile.
5. Click on any items that use the Advanced Resource Assign VPE object.
6. For each entry with an Expression that is 'Empty', click 'change'.
7. Add an appropriate expression that validates the user's authorization to access the resource specified in the item.
8. Click 'Finished'.
9. Click 'Save'.
10. Click 'Apply Access Policy'."
      reference      : "800-171|3.1.1,800-171r3|03.01.02,800-53|AC-3,800-53r5|AC-3,CAT|II,CCI|CCI-000213,CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.PT-3,CSF2.0|PR.AA-05,CSF2.0|PR.DS-10,CSF2.0|PR.IR-01,DISA_Benchmark|F5_BIG-IP_Access_Policy_Manager_11-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO-27001-2022|A.5.15,ISO-27001-2022|A.5.33,ISO-27001-2022|A.8.3,ISO-27001-2022|A.8.18,ISO-27001-2022|A.8.20,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-260057r947423_rule,STIG-ID|F5BI-AP-000240,TBA-FIISB|31.1,Vuln-ID|V-260057"
      see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_F5_BIG-IP_Y25M01_STIG.zip"
      f5_command     : "/tm/apm/profile/access"
      json_transform : ".items[] | \"Access Policy Name: \(.name)\""
      regex          : ".*"
      expect         : "^Manual Review Required$"
      severity       : MEDIUM
    </custom_item>

    <custom_item>
      description    : "F5BI-AP-000241 - When the Access Profile Type is LTM+APM and it is not using any connectivity resources (such as Network Access, Portal Access, etc.) in the VPE, the F5 BIG-IP appliance must be configured to enable the HTTP Only flag."
      info           : "To guard against cookie hijacking, only the BIG-IP APM controller and client must be able to view the full session ID. Setting the APM HTTP Only flag ensures that a third party will not have access to the active session cookies.

This option is only applicable to the LTM+APM access profile type. Other access profile types require access to various session cookies to fully function. Sites must conduct operational testing prior to enabling this setting. For implementations with connectivity resources (such as Network Access, Portal Access, etc.), do not set BIG-IP APM cookies with the HTTP Only flag."
      solution       : "When the Access Profile Type is LTM+APM and it is not using any connectivity resources (such as Network Access, Portal Access, etc.) in the VPE, set the HTTP Only flag.

From the BIG-IP GUI:
1. Access >> Profiles/Policies >> Access profile name >> SSO/Auth Domains.
2. Under 'Cookie Options', check the box next to 'HTTP Only'."
      reference      : "800-171|3.13.15,800-171r3|03.13.15,800-53|SC-23(3),800-53r5|SC-23(3),CAT|III,CCI|CCI-001664,DISA_Benchmark|F5_BIG-IP_Access_Policy_Manager_11-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-23(3),NESA|T4.5.1,QCSC-v1|5.2.1,Rule-ID|SV-260058r947399_rule,STIG-ID|F5BI-AP-000241,Vuln-ID|V-260058"
      see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_F5_BIG-IP_Y25M01_STIG.zip"
      f5_command     : "/tm/apm/profile/access"
      json_transform : ".items[] | .name as $n | select(.type==\"ltm-apm\")| \"Access Policy Name: \" + $n + \", HTTP Only Cookie: \" + .httponlyCookie"
      regex          : ".*"
      expect         : "true$"
      match_all      : YES
    </custom_item>

    <custom_item>
      description    : "F5BI-AP-000242 - The F5 BIG-IP appliance must be configured to enable the 'Secure' cookie flag - Secure cookie flag."
      info           : "To guard against cookie hijacking, only the BIG-IP APM controller and client must be able to view the full session ID. Session cookies are set only after the SSL handshake between the BIG-IP APM system and the user has completed, ensuring that the session cookies are protected from interception with SSL encryption.

To ensure that the client browser will not send session cookies unencrypted, the HTTP header that the BIG-IP APM uses when sending the session cookie is set with the secure option (default). This option is only applicable to the LTM+APM access profile type."
      solution       : "Configure each Access Profile to enable the 'Secure' cookie flag.

From the BIG-IP GUI:
1. Access.
2. Profiles/Policies.
3. Access Profiles.
4. Click the Access profile name.
5. 'SSO/Auth Domains' tab.
6. Under 'Cookie Options', check 'Secure'.
7. Click 'Update'.
8. Click 'Apply Access Policy'."
      reference      : "800-171|3.13.15,800-171r3|03.13.15,800-53|SC-23(3),800-53r5|SC-23(3),CAT|III,CCI|CCI-001664,DISA_Benchmark|F5_BIG-IP_Access_Policy_Manager_11-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-23(3),NESA|T4.5.1,QCSC-v1|5.2.1,Rule-ID|SV-260059r947425_rule,STIG-ID|F5BI-AP-000242,Vuln-ID|V-260059"
      see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_F5_BIG-IP_Y25M01_STIG.zip"
      f5_command     : "/tm/apm/profile/access"
      json_transform : ".items[] | .name as $n | select(.type==\"ltm-apm\")| \"Access Policy Name: \" + $n + \", Secure Cookie: \" + .secureCookie"
      regex          : ".*"
      expect         : "true$"
      match_all      : YES
    </custom_item>

    <custom_item>
      description    : "F5BI-AP-000243 - The F5 BIG-IP appliance must be configured to disable the 'Persistent' cookie flag - Persistent cookie flag."
      info           : "For BIG-IP APM deployments with connectivity resources (such as Network Access, Portal Access, etc.), BIG-IP APM cookies cannot be set as 'Persistent'. This is by design since cookies are stored locally on the client's hard disk and thus could be exposed to unauthorized external access. For some deployments of the BIG-IP APM system, cookie persistence may be required. When cookie persistence is selected, persistence is hard coded at 60 seconds."
      solution       : "Note: Testing must be performed prior to implementation to prevent operational impact. This setting may break access to certain applications that require cookie persistence.

From the BIG-IP GUI:
1. Access.
2. Profiles/Policies.
3. Access Profiles.
4. Click the Access profile name.
5. 'SSO/Auth Domains' tab.
6. Under 'Cookie Options', uncheck 'Persistent'.
7. Click 'Update.'
8. Click 'Apply Access Policy'."
      reference      : "800-171|3.13.15,800-171r3|03.13.15,800-53|SC-23(3),800-53r5|SC-23(3),CAT|III,CCI|CCI-001664,DISA_Benchmark|F5_BIG-IP_Access_Policy_Manager_11-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-23(3),NESA|T4.5.1,QCSC-v1|5.2.1,Rule-ID|SV-260060r947405_rule,STIG-ID|F5BI-AP-000243,Vuln-ID|V-260060"
      see_also       : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_F5_BIG-IP_Y25M01_STIG.zip"
      f5_command     : "/tm/apm/profile/access"
      json_transform : ".items[] | .name as $n | select(.type==\"ltm-apm\")| \"Access Policy Name: \" + $n + \", Persistent Cookie: \" + .persistentCookie"
      regex          : ".*"
      expect         : "false$"
      match_all      : YES
    </custom_item>

    <report type:"WARNING">
      description : "F5BI-AP-999999 - The version of F5 BIG-IP must be a supported version."
      info        : "Security flaws with software applications are discovered daily. Vendors are constantly updating and patching their products to address newly discovered security vulnerabilities. Organizations (including any contractor to the organization) are required to promptly install security-relevant software updates (e.g., patches, service packs, and hot fixes). Flaws discovered during security assessments, continuous monitoring, incident response activities, or information system error handling must also be addressed expeditiously.

    Organization-defined time periods for updating security-relevant software may vary based on a variety of factors including, for example, the security category of the information system or the criticality of the update (i.e., severity of the vulnerability related to the discovered flaw).

    This requirement will apply to software patch management solutions that are used to install patches across the enclave and to applications that are not part of that patch management solution. For example, many browsers today provide the capability to install their own patch software. Patch criticality, as well as system criticality, will vary. Therefore, the tactical situations regarding the patch management process will also vary. This means that the period used must be a configurable parameter. Time frames for application of security-relevant software updates may be dependent upon the Information Assurance Vulnerability Management (IAVM) process.

    The application will be configured to check for and install security-relevant software updates within an identified period from the availability of the update. The specific period will be defined by an authoritative source (e.g., IAVM, CTOs, DTMs, and STIGs).

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Upgrade to a supported version."
      reference   : "800-171|3.14.1,800-171r3|03.14.01b.,800-53|SI-2c.,800-53r5|SI-2c.,CAT|I,CCI|CCI-002605,CN-L3|8.1.4.4(e),CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSF|ID.RA-1,CSF|PR.IP-12,CSF2.0|ID.IM-01,CSF2.0|ID.IM-02,CSF2.0|ID.IM-03,CSF2.0|PR.PS-02,DISA_Benchmark|F5_BIG-IP_Access_Policy_Manager_11-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.6.8,ISO-27001-2022|A.8.8,ISO-27001-2022|A.8.32,ITSG-33|SI-2,NESA|T7.6.2,NESA|T7.7.1,NIAv2|AM38,NIAv2|AM39,NIAv2|SS14b,PCI-DSSv3.2.1|6.2,PCI-DSSv4.0|6.3,PCI-DSSv4.0|6.3.3,QCSC-v1|11.2,Rule-ID|SV-270901r1056147_rule,STIG-ID|F5BI-AP-999999,SWIFT-CSCv1|2.2,Vuln-ID|V-270901"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_F5_BIG-IP_Y25M01_STIG.zip"
    </report>
  </then>

  <else>
    <report type:"WARNING">
      description : "DISA_F5_BIG-IP_APM_v2r4.audit from DISA F5 BIG-IP Access Policy Manager v2r4 STIG"
      info        : "NOTE: Nessus has not identified that the chosen audit applies to the target device."
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_F5_BIG-IP_Y25M01_STIG.zip"
    </report>
  </else>
</if>

</check_type>
