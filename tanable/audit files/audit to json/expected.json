{
  "ui_metadata": {
    "display_name": "CIS Microsoft Windows 11 Stand-alone v4.0.0 L1",
    "spec": {
      "type": "CIS",
      "name": "Microsoft Windows 11 Stand-alone",
      "profile": "L1",
      "version": "4.0.0",
      "link": "https://workbench.cisecurity.org/benchmarks/22007"
    },
    "labels": "windows,cis,microsoft_windows_11_stand-alone,agent,windows_11",
    "benchmark_refs": "CSCv6,CSCv7,CSCv8,LEVEL",
    "variables": [
      {
        "name": "PLATFORM_VERSION",
        "default": "2[26][0-9]{3}",
        "description": "Windows Version",
        "info": "Windows Version",
        "value_type": "STRING"
      },
      {
        "name": "PASSWORD_HISTORY",
        "default": "[24..MAX]",
        "description": "Password history value",
        "info": "Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Account Policies\\Password Policy\\Enforce password history",
        "value_type": "STRING"
      },
      {
        "name": "MAXIMUM_PASSWORD_AGE",
        "default": "[1..365]",
        "description": "Maximum password age value",
        "info": "Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Account Policies\\Password Policy\\Maximum password age",
        "value_type": "STRING"
      },
      {
        "name": "MINIMUM_PASSWORD_AGE",
        "default": "[1..MAX]",
        "description": "Minimum password age value",
        "info": "Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Account Policies\\Password Policy\\Minimum password age",
        "value_type": "STRING"
      },
      {
        "name": "MINIMUM_PASSWORD_LENGTH",
        "default": "[14..MAX]",
        "description": "Minimum password length value",
        "info": "Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Account Policies\\Password Policy\\Minimum password length",
        "value_type": "STRING"
      },
      {
        "name": "LOCKOUT_DURATION",
        "default": "[15..MAX]",
        "description": "Account lockout duration",
        "info": "Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Account Policies\\Account Lockout Policy\\Account lockout duration",
        "value_type": "STRING"
      },
      {
        "name": "LOCKOUT_THRESHOLD",
        "default": "[1..5]",
        "description": "Account lockout threshold",
        "info": "Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Account Policies\\Account Lockout Policy\\Account lockout threshold",
        "value_type": "STRING"
      },
      {
        "name": "LOCKOUT_RESET",
        "default": "[15..MAX]",
        "description": "Reset account lockout",
        "info": "Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Account Policies\\Account Lockout Policy\\Reset account lockout counter after",
        "value_type": "STRING"
      },
      {
        "name": "LEGAL_NOTICE_TEXT",
        "default": "All activities performed on this system will be monitored.",
        "description": "Logon Window Text",
        "info": "This is the window text for the login warning a user receives when logging onto the system.",
        "value_type": "STRING"
      },
      {
        "name": "LEGAL_CAPTION_TEXT",
        "default": "Notice and Consent Banner",
        "description": "Logon Window Caption",
        "info": "This is the window caption text for the login warning a user receives when logging onto the system.",
        "value_type": "STRING"
      },
      {
        "name": "PASSWORD_AGE_PROMPT",
        "default": "[5..14]",
        "description": "Number of days to prompt user for password change before expiration",
        "info": "Value (in days) for \"Interactive logon: Prompt user to change password before expiration\"",
        "value_type": "STRING"
      }
    ]
  },

  "check_type": "Windows",
  "version": "2",
  "group_policy": "CIS Microsoft Windows 11 Stand-alone",
  "if": {
    "condition": {
      "type": "AND",
      "custom_items": [
        {
          "type": "REGISTRY_SETTING",
          "description": "Windows 11 is installed",
          "value_type": "POLICY_TEXT",
          "value_data": "@PLATFORM_VERSION@",
          "reg_key": "HKLM\\Software\\Microsoft\\Windows Nt\\Currentversion",
          "reg_item": "CurrentBuild",
          "check_type": "CHECK_REGEX"
        },
        {
          "type": "REGISTRY_SETTING",
          "description": "Windows 11 installation type",
          "value_type": "POLICY_TEXT",
          "value_data": "Client",
          "reg_key": "HKLM\\Software\\Microsoft\\Windows Nt\\Currentversion",
          "reg_item": "InstallationType"
        }
      ]
    },
    "then": {
      "report": {
        "type": "PASSED",
        "description": "CIS_Microsoft_Windows_11_Stand-alone_v4.0.0_L1.audit from CIS Microsoft Windows 11 Stand-alone Benchmark v4.0.0",
        "see_also": "https://workbench.cisecurity.org/benchmarks/22007",
        "show_output": "YES"
      },
      "custom_items": [
        {
          "type": "PASSWORD_POLICY",
          "description": "1.1.1 (L1) Ensure 'Enforce password history' is set to '24 or more password(s)'",
          "info": "This policy setting determines the number of renewed, unique passwords that have to be associated with a user account before you can reuse an old password. The value for this policy setting must be between 0 and 24 passwords. The default value for stand-alone systems is 0 passwords, but the default setting when joined to a domain is 24 passwords. To maintain the effectiveness of this policy setting, use the Minimum password age setting to prevent users from repeatedly changing their password.\n\nThe recommended state for this setting is: 24 or more password(s)\n\nNote: Password Policy settings (section 1.1) and Account Lockout Policy settings (section 1.2) must be applied via the Default Domain Policy GPO in order to be globally in effect on domain user accounts as their default behavior. If these settings are configured in another GPO, they will only affect local user accounts on the computers that receive the GPO. However, custom exceptions to the default password policy and account lockout policy rules for specific domain users and/or groups can be defined using Password Settings Objects (PSOs), which are completely separate from Group Policy and most easily configured using Active Directory Administrative Center.\n\nNote #2: As of the publication of this benchmark, Microsoft currently has a maximum limit of 24 saved passwords. For more information, please visit\n\nEnforce password history (Windows 10) - Windows security | Microsoft Docs\n\n.\n\nThe longer a user uses the same password, the greater the chance that an attacker can determine the password through brute force attacks. Also, any accounts that may have been compromised will remain exploitable for as long as the password is left unchanged. If password changes are required but password reuse is not prevented, or if users continually reuse a small number of passwords, the effectiveness of a good password policy is greatly reduced.\n\nIf you specify a low number for this policy setting, users will be able to use the same small number of passwords repeatedly. If you do not also configure the Minimum password age setting, users might repeatedly change their passwords until they can reuse their original password.",
          "solution": "To establish the recommended configuration via GP, set the following UI path to 24 or more password(s) :\n\nComputer Configuration\\Policies\\Windows Settings\\Security Settings\\Account Policies\\Password Policy\\Enforce password history\n\nImpact:\n\nThe major impact of this configuration is that users must create a new password every time they are required to change their old one. If users are required to change their passwords to new unique values, there is an increased risk of users who write their passwords somewhere so that they do not forget them. Another risk is that users may create passwords that change incrementally (for example, password01, password02, and so on) to facilitate memorization but make them easier to guess. Also, an excessively low value for the Minimum password age setting will likely increase administrative overhead, because users who forget their passwords might ask the help desk to reset them frequently.",
          "reference": "800-171|3.5.2,800-171r3|03.05.07,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|16.2,CSCv8|5.2,CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.17,ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
          "see_also": "https://workbench.cisecurity.org/benchmarks/22007",
          "value_type": "POLICY_DWORD",
          "value_data": "@PASSWORD_HISTORY@",
          "password_policy": "ENFORCE_PASSWORD_HISTORY"
        }
      ],
      "nested_if": {
        "condition": {
          "auto": "FAILED",
          "type": "AND",
          "custom_items": [
            {
              "type": "REGISTRY_SETTING",
              "description": "Ensure 'ShellSmartScreenLevel' is 'Windows: Registry Value' to 'Block'",
              "value_type": "POLICY_TEXT",
              "value_data": "Block",
              "reg_key": "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\System",
              "reg_item": "ShellSmartScreenLevel",
              "reg_option": "CAN_NOT_BE_NULL"
            },
            {
              "type": "REGISTRY_SETTING",
              "description": "EnableSmartScreen",
              "value_type": "POLICY_DWORD",
              "value_data": "1",
              "reg_key": "HKLM\\Software\\Policies\\Microsoft\\Windows\\System",
              "reg_item": "EnableSmartScreen",
              "reg_option": "CAN_NOT_BE_NULL"
            },
            {
              "type": "REGISTRY_SETTING",
              "description": "EnableSmartScreen",
              "value_type": "POLICY_DWORD",
              "value_data": "1",
              "reg_key": "HKLM\\Software\\Policies\\Microsoft\\Windows\\System",
              "reg_item": "EnableSmartScreen",
              "reg_option": "CAN_NOT_BE_NULL"
            },
            {
              "type": "REGISTRY_SETTING",
              "description": "EnableSmartScreen",
              "value_type": "POLICY_DWORD",
              "value_data": "1",
              "reg_key": "HKLM\\Software\\Policies\\Microsoft\\Windows\\System",
              "reg_item": "EnableSmartScreen",
              "reg_option": "CAN_NOT_BE_NULL"
            }
          ]
        },
        "then": {
          "report": {
            "type": "PASSED",
            "description": "18.10.76.2.1 (L1) Ensure 'Configure Windows Defender SmartScreen' is set to 'Enabled: Warn and prevent bypass'",
            "info": "This policy setting allows you to manage the behavior of Windows Defender SmartScreen. Windows Defender SmartScreen helps keep PCs safer by warning users before running unrecognized programs downloaded from the Internet. Some information is sent to Microsoft about files and programs run on PCs with this feature enabled.\n\nThe recommended state for this setting is: Enabled: Warn and prevent bypass\n\nWindows Defender SmartScreen helps keep PCs safer by warning users before running unrecognized programs downloaded from the Internet. However, due to the fact that some information is sent to Microsoft about files and programs run on PCs some organizations may prefer to disable it.",
            "solution": "To establish the recommended configuration via GP, set the following UI path to Enabled: Warn and prevent bypass :\n\nComputer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Defender SmartScreen\\Explorer\\Configure Windows Defender SmartScreen\n\nNote: This Group Policy path is provided by the Group Policy template WindowsExplorer.admx/adml that is included with the Microsoft Windows 8.0 & Server 2012 (non-R2) Administrative Templates (or newer).\n\nNote #2: In older Microsoft Windows Administrative Templates, this setting was initially named\n\nConfigure Windows SmartScreen\n\n, but it was renamed starting with the Windows 10 Release 1703 Administrative Templates.\n\nImpact:\n\nUsers will be warned and prevented from running unrecognized programs downloaded from the Internet.",
            "reference": "800-53|SI-16,800-53r5|SI-16,CSCv7|8.3,CSCv8|10.5,CSF2.0|PR.DS-10,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-16,LEVEL|1A",
            "see_also": "https://workbench.cisecurity.org/benchmarks/22007",
            "show_output": "YES"
          }
        }
      }
    },
    "else": {
      "report": {
        "type": "WARNING",
        "description": "CIS_Microsoft_Windows_11_Stand-alone_v4.0.0_L1.audit from CIS Microsoft Windows 11 Stand-alone Benchmark v4.0.0",
        "info": "NOTE: Nessus has not identified that the chosen audit applies to the target device.",
        "see_also": "https://workbench.cisecurity.org/benchmarks/22007",
        "show_output": "YES"
      }
    }
  }
}
