{
  "type": "REGISTRY_SETTING",
  "description": "18.10.86.2 (L2) Ensure 'Turn on PowerShell Transcription' is set to 'Enabled'",
  "info": "This Policy setting lets you capture the input and output of Windows PowerShell commands into text-based transcripts.\n\nThe recommended state for this setting is: Enabled\n\nPowerShell transcript input can be very valuable when performing forensic investigations of PowerShell attack incidents to determine what occurred.",
  "solution": "\"To establish the recommended configuration via GP, set the following UI path to Enabled :\n\nComputer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows PowerShell\\Turn on PowerShell Transcription",
  "Note": "This Group Policy path is provided by the Group Policy template PowerShellExecutionPolicy.admx/adml that is included with the Microsoft Windows 10 RTM (Release 1507) Administrative Templates (or newer).",
  "Impact": "PowerShell transcript input will be logged to PowerShell_transcript output files, which are saved to the My Documents folder (within a separate subfolder for each day) of each users' profile by default. Optionally, a specific output directory name can be specified, which will contain all PowerShell transcript logs in a subfolder of My Documents. If specifying a full path outside the users My Documents folder, other users on the system could have access to view these logs, which may contain sensitive information such as passwords.",
  "Warning": "There are potential risks of capturing credentials and sensitive information in PowerShell_transcript output files, which could be exposed to users who have read access to the files.\n\nWarning #2: PowerShell Transcription is not compatible with the natively installed PowerShell v4 on Microsoft Windows 10 Release 1511 and Server 2012 R2 and below. If this recommendation is set as prescribed, PowerShell will need to be updated to at least v5.1 or newer. For more information on updating PowerShell, please see\n\nWindows PowerShell System Requirements - PowerShell | Microsoft Learn\n\n.\"",
  "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-2,800-53r5|AU-2,CN-L3|8.1.4.3(a),CSCv7|8.8,CSCv8|8.8,CSF|PR.PT-1,CSF2.0|PR.PS-04,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO-27001-2022|A.8.15,ITSG-33|AU-2,LEVEL|2A,NESA|M1.2.2,NESA|M5.5.1,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|SS30,NIAv2|VL8,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
  "see_also": "https://workbench.cisecurity.org/benchmarks/17603",
  "value_type": "POLICY_DWORD",
  "value_data": "1",
  "reg_key": "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\Transcription",
  "reg_item": "EnableTranscripting",
  "reg_option": "CAN_NOT_BE_NULL"
}