{
  "check_type": "CONDITIONAL",
  "condition": {
    "auto_status": "FAILED",
    "type": "AND",
    "rules": [
      {
        "type": "REGISTRY_SETTING",
        "description": "Ensure 'EnableRegistrars' is 'Windows: Registry Value' to '0'",
        "value_type": "POLICY_DWORD",
        "value_data": "0",
        "reg_key": "HKLM\\Software\\Policies\\Microsoft\\Windows\\WCN\\Registrars",
        "reg_item": "EnableRegistrars",
        "reg_option": "CAN_NOT_BE_NULL"
      },
      {
        "type": "REGISTRY_SETTING",
        "description": "Ensure 'DisableInBand802DOT11Registrar' is 'Windows: Registry Value' to '0'",
        "value_type": "POLICY_DWORD",
        "value_data": "0",
        "reg_key": "HKLM\\Software\\Policies\\Microsoft\\Windows\\WCN\\Registrars",
        "reg_item": "DisableInBand802DOT11Registrar",
        "reg_option": "CAN_NOT_BE_NULL"
      },
      {
        "type": "REGISTRY_SETTING",
        "description": "Ensure 'DisableFlashConfigRegistrar' is 'Windows: Registry Value' to '0'",
        "value_type": "POLICY_DWORD",
        "value_data": "0",
        "reg_key": "HKLM\\Software\\Policies\\Microsoft\\Windows\\WCN\\Registrars",
        "reg_item": "DisableFlashConfigRegistrar",
        "reg_option": "CAN_NOT_BE_NULL"
      },
      {
        "type": "REGISTRY_SETTING",
        "description": "Ensure 'DisableUPnPRegistrar' is 'Windows: Registry Value' to '0'",
        "value_type": "POLICY_DWORD",
        "value_data": "0",
        "reg_key": "HKLM\\Software\\Policies\\Microsoft\\Windows\\WCN\\Registrars",
        "reg_item": "DisableUPnPRegistrar",
        "reg_option": "CAN_NOT_BE_NULL"
      },
      {
        "type": "REGISTRY_SETTING",
        "description": "Ensure 'DisableWPDRegistrar' is 'Windows: Registry Value' to '0'",
        "value_type": "POLICY_DWORD",
        "value_data": "0",
        "reg_key": "HKLM\\Software\\Policies\\Microsoft\\Windows\\WCN\\Registrars",
        "reg_item": "DisableWPDRegistrar",
        "reg_option": "CAN_NOT_BE_NULL"
      }
    ]
  },
  "then": {
    "report": {
      "description": "18.6.20.1 (L2) Ensure 'Configuration of wireless settings using Windows Connect Now' is set to 'Disabled'",
      "info": "This policy setting allows the configuration of wireless settings using Windows Connect Now (WCN). The WCN Registrar enables the discovery and configuration of devices over Ethernet (UPnP) over in-band 802.11 Wi-Fi through the Windows Portable Device API (WPD) and via USB Flash drives. Additional options are available to allow discovery and configuration over a specific medium.\n\nThe recommended state for this setting is: Disabled\n\nThis setting enhances the security of the environment and reduces the overall risk exposure related to user configuration of wireless settings.",
      "solution": "\"To establish the recommended configuration via GP, set the following UI path to Disabled :\n\nComputer Configuration\\Policies\\Administrative Templates\\Network\\Windows Connect Now\\Configuration of wireless settings using Windows Connect Now",
      "Note": "This Group Policy path is provided by the Group Policy template WindowsConnectNow.admx/adml that is included with all versions of the Microsoft Windows Administrative Templates.",
      "Impact": "WCN operations are disabled over all media.\"",
      "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|15.4,CSCv7|15.5,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
      "see_also": "https://workbench.cisecurity.org/benchmarks/17603",
      "show_output": true,
      "type": "PASSED"
    }
  }
}