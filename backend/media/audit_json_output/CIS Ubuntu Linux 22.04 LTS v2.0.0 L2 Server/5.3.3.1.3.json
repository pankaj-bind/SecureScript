{
  "check_type": "CONDITIONAL",
  "condition": {
    "auto_status": "FAILED",
    "type": "AND",
    "rules": [
      {
        "type": "FILE_CONTENT_CHECK",
        "description": "even_deny_root",
        "file": "/etc/security/faillock.conf",
        "regex": "(?i)^\\\\h*(even_deny_root|root_unlock_time\\\\h*=\\\\h*\\\\d+)\\\\b",
        "expect": "(?i)^\\\\h*(even_deny_root|root_unlock_time\\\\h*=\\\\h*\\\\d+)\\\\b"
      },
      {
        "type": "FILE_CONTENT_CHECK",
        "description": "faillock - root_unlock_time",
        "file": "/etc/security/faillock.conf",
        "regex": "(?i)^\\\\h*root_unlock_time\\\\h*=",
        "expect": "(?i)^\\\\h*root_unlock_time\\\\h*=\\\\h*@PASSWORD_ROOT_UNLOCK_TIME@\\\\b",
        "string_required": false
      },
      {
        "type": "FILE_CONTENT_CHECK",
        "description": "common-auth root_unlock_time",
        "file": "/etc/pam.d/common-auth",
        "regex": "(?i)^\\\\h*auth\\\\h+([^#\\\\n\\\\r]+\\\\h+)pam_faillock\\\\.so\\\\h+([^#\\\\n\\\\r]+\\\\h+)? \\\\h*=",
        "expect": "(?i)^\\\\h*auth\\\\h+([^#\\\\n\\\\r]+\\\\h+)pam_faillock\\\\.so\\\\h+([^#\\\\n\\\\r]+\\\\h+)?root_unlock_time\\\\h*=\\\\h*@PASSWORD_ROOT_UNLOCK_TIME@\\\\b",
        "string_required": false
      }
    ]
  },
  "then": {
    "report": {
      "description": "5.3.3.1.3 Ensure password failed attempts lockout includes root account",
      "info": "even_deny_root - Root account can become locked as well as regular accounts\n\nroot_unlock_time=n - This option implies even_deny_root option. Allow access after n seconds to root account after the account is locked. In case the option is not specified the value is the same as of the unlock_time option.\n\nLocking out user IDs after n unsuccessful consecutive login attempts mitigates brute force password attacks against your systems.",
      "solution": "\"Edit /etc/security/faillock.conf :\n\n - Remove or update any line containing root_unlock_time - OR - set it to a value of 60 or more\n - Update or add the following line:\n\neven_deny_root\n\nRun the following command:\n\n# grep -Pl -- '\\bpam_faillock\\.so\\h+([^#\\n\\r]+\\h+)?(even_deny_root|root_unlock_time)' /usr/share/pam-configs/*\n\nEdit any returned files and remove the even_deny_root and root_unlock_time arguments from the pam_faillock.so line(s):",
      "Impact": "Use of unlock_time=0 or root_unlock_time=0 may allow an attacker to cause denial of service to legitimate users.\"",
      "reference": "800-171|3.1.1,800-53|AC-1,800-53|AC-2,800-53|AC-2(1),800-53r5|AC-1,800-53r5|AC-2,800-53r5|AC-2(1),CN-L3|7.1.3.2(d),CN-L3|8.1.4.2(e),CN-L3|8.1.10.6(c),CSCv7|16.7,CSCv8|6.2,CSF|DE.CM-1,CSF|DE.CM-3,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|GV.OC-03,CSF2.0|GV.OV-01,CSF2.0|GV.PO-01,CSF2.0|GV.PO-02,CSF2.0|GV.SC-03,CSF2.0|ID.IM-01,CSF2.0|ID.IM-02,CSF2.0|ID.IM-03,CSF2.0|PR.AA-01,CSF2.0|PR.AA-05,CSF2.0|PR.DS-10,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.1.1,ISO/IEC-27001|A.9.2.1,ITSG-33|AC-1,ITSG-33|AC-2,ITSG-33|AC-2(1),LEVEL|2A,NESA|M1.2.2,NIAv2|AM28,NIAv2|AM29,NIAv2|AM30,NIAv2|NS5j,NIAv2|SS14e,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2",
      "see_also": "https://workbench.cisecurity.org/benchmarks/17074",
      "show_output": true,
      "type": "PASSED"
    }
  }
}