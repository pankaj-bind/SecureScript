{
  "check_type": "CONDITIONAL",
  "condition": {
    "auto_status": "FAILED",
    "type": "AND",
    "rules": [
      {
        "type": "CMD_EXEC",
        "description": "log_group path permissions",
        "cmd": "#!/bin/bash\n\n{\n  if [ -e /etc/audit/auditd.conf ]; then\n      l_fpath=\\\"$(dirname \\\"$(awk -F \\\"=\\\" '/^\\\\s*log_file/ {print $2}' /etc/audit/auditd.conf | xargs)\\\")\\\"\n      find -L \\\"$l_fpath\\\" -not -path \\\"$l_fpath\\\"/lost+found -type f \\\\( ! -group root -a ! -group adm \\\\) -exec ls -l {} +\n   fi\n} | /bin/awk '{print} END {if (NR == 0) print \\\"pass\\\"; else print \\\"fail\\\"}'",
        "expect": "^pass$"
      },
      {
        "type": "FILE_CONTENT_CHECK",
        "description": "auditd.conf log_group",
        "file": "/etc/audit/auditd.conf",
        "regex": "(?i)^\\\\h*log_group\\\\h*=\\\\h*\\\\H+\\\\b",
        "expect": "(?i)^\\\\h*log_group\\\\h*=\\\\h*(adm|root)\\\\b"
      }
    ]
  },
  "then": {
    "report": {
      "description": "6.3.4.3 Ensure audit log files group owner is configured",
      "info": "Audit log files contain information about the system and system activity.\n\nAccess to audit records can reveal system and configuration data to attackers, potentially compromising its confidentiality.",
      "solution": "Run the following command to configure the audit log files to be group owned by adm :\n\n# find $(dirname $(awk -F\\\"=\\\" '/^\\s*log_file/ {print $2}' /etc/audit/auditd.conf | xargs)) -type f \\( ! -group adm -a ! -group root \\) -exec chgrp adm {} +\n\nRun the following command to set the log_group parameter in the audit configuration file to log_group = adm :\n\n# sed -ri 's/^\\s*#?\\s*log_group\\s*=\\s*\\S+(\\s*#.*)?.*$/log_group = adm\\1/' /etc/audit/auditd.conf\n\nRun the following command to restart the audit daemon to reload the configuration file:\n\n# systemctl restart auditd",
      "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,CSF2.0|PR.AA-05,CSF2.0|PR.DS-10,CSF2.0|PR.IR-01,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|2A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
      "see_also": "https://workbench.cisecurity.org/benchmarks/17074",
      "show_output": true,
      "type": "PASSED"
    }
  }
}