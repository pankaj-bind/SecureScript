{
  "type": "AUDIT_POWERSHELL",
  "description": "18.9.7.1.5 (BL) Ensure 'Prevent installation of devices using drivers that match these device setup classes: Prevent installation of devices using drivers for these device setup' is set to 'IEEE 1394 device setup classes'",
  "info": "\"This policy setting allows you to specify a list of device setup class globally unique identifiers (GUIDs) for device drivers that Windows is prevented from installing. This policy setting takes precedence over any other policy setting that allows Windows to install a device.\n\nIf you enable this policy setting, Windows is prevented from installing or updating device drivers whose device setup class GUIDs appear in the list you create. If you enable this policy setting on a remote desktop server, the policy setting affects redirection of the specified devices from a remote desktop client to the remote desktop server.\n\nIf you disable or do not configure this policy setting, Windows can install and update devices as allowed or prevented by other policy settings.\n\nHere are the four entries we recommend and what they translate to:\n\n - {d48179be-ec20-11d1-b6b8-00c04fa372a7} - IEEE 1394 devices that support the SBP2 Protocol Class\n - {7ebefbc0-3200-11d2-b4c2-00a0C9697d07} - IEEE 1394 devices that support the IEC-61883 Protocol Class\n - {c06ff265-ae09-48f0-812c-16753d7cba83} - IEEE 1394 devices that support the AVC Protocol Class\n - {6bdd1fc1-810f-11d0-bec7-08002be2092f} - IEEE 1394 Host Bus Controller Class\n\nThe full list of system-defined device setup classes available in Windows is here:\n\nSystem-Defined Device Setup Classes Available to Vendors | Microsoft Docs\n\nThe recommended state for this setting is: {d48179be-ec20-11d1-b6b8-00c04fa372a7} {7ebefbc0-3200-11d2-b4c2-00a0C9697d07} {c06ff265-ae09-48f0-812c-16753d7cba83} and {6bdd1fc1-810f-11d0-bec7-08002be2092f}",
  "Note": "This Group Policy path is provided by the Group Policy template DeviceInstallation.admx/adml that is included with all versions of the Microsoft Windows Administrative Templates.",
  "solution": "\"To establish the recommended configuration via GP, set the following UI path to Enabled and add {d48179be-ec20-11d1-b6b8-00c04fa372a7} {7ebefbc0-3200-11d2-b4c2-00a0C9697d07} {c06ff265-ae09-48f0-812c-16753d7cba83} and {6bdd1fc1-810f-11d0-bec7-08002be2092f} to the device setup classes list:\n\nComputer Configuration\\Policies\\Administrative Templates\\System\\Device Installation\\Device Installation Restrictions\\Prevent installation of devices using drivers that match these device setup classes",
  "Impact": "IEEE 1394 drives &amp; devices will be prevented from being installed in Windows.\"",
  "reference": "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3c.2.,800-53r5|SI-3c.2.,CN-L3|7.1.3.6(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CSF|DE.CM-4,CSF|DE.DP-3,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.7,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3c.b.,LEVEL|BLA,NESA|T3.4.1,NIAv2|NS24,PCI-DSSv3.2.1|5.1,PCI-DSSv3.2.1|5.1.1,PCI-DSSv4.0|5.3.2,PCI-DSSv4.0|5.3.3,QCSC-v1|3.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7",
  "see_also": "https://workbench.cisecurity.org/benchmarks/17603",
  "value_type": "POLICY_TEXT",
  "value_data": "STATUS: PASSED",
  "powershell_args": "$values = '{d48179be-ec20-11d1-b6b8-00c04fa372a7}', '{7ebefbc0-3200-11d2-b4c2-00a0C9697d07}', '{c06ff265-ae09-48f0-812c-16753d7cba83}', '{6bdd1fc1-810f-11d0-bec7-08002be2092f}'; $path = 'Registry::HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\Deviceinstall\\Restrictions\\DenyDeviceClasses'; Get-Item -Path $path -ErrorAction SilentlyContinue | Select-Object -ExpandProperty Property | ForEach-Object { $value = (Get-ItemProperty -Path $path -Name $_).$_; if ($values -contains $value) { $values = $values | Where-Object { $_ -ne $value } } }; if ($values) { 'The following values are missing:'; ''; $values; ''; 'STATUS: FAILED' } else { 'STATUS: PASSED' }"
}