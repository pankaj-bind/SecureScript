{
  "type": "CMD_EXEC",
  "description": "2.1.2 Ensure avahi daemon services are not in use",
  "info": "Avahi is a free zeroconf implementation, including a system for multicast DNS/DNS-SD service discovery. Avahi allows programs to publish and discover services and hosts running on a local network with no specific configuration. For example, a user can plug a computer into a network and Avahi automatically finds printers to print to, files to look at and people to talk to, as well as network services running on the machine.\n\nAutomatic discovery of network services is not normally required for system functionality. It is recommended to remove this package to reduce the potential attack surface.",
  "solution": "\"Run the following commands to stop avahi-daemon.socket and avahi-daemon.service and remove the avahi-daemon package:\n\n# systemctl stop avahi-daemon.socket avahi-daemon.service\n# apt purge avahi-daemon\n\n- OR -\n\n- IF - the avahi-daemon package is required as a dependency:\n\nRun the following commands to stop and mask the avahi-daemon.socket and avahi-daemon.service :\n\n# systemctl stop avahi-daemon.socket avahi-daemon.service\n# systemctl mask avahi-daemon.socket avahi-daemon.service",
  "Impact": "There may be packages that are dependent on the avahi package. If the avahi package is removed, these dependent packages will be removed as well. Before removing the avahi package, review any dependent packages to determine if they are required on the system.\n\n- IF - a dependent package is required: stop and mask the avahi-daemon.socket and avahi-daemon.service leaving the avahi package installed.\"",
  "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
  "see_also": "https://workbench.cisecurity.org/benchmarks/17074",
  "cmd": "/bin/dpkg -s avahi-daemon 2>&1 | /bin/grep -E '(^Status:|not installed)'",
  "expect": "(^Status: deinstall ok|not installed)"
}