{
  "check_type": "CONDITIONAL",
  "condition": {
    "auto_status": "FAILED",
    "type": "AND",
    "rules": [
      {
        "type": "FILE_CONTENT_CHECK",
        "description": "admin_space_left_action",
        "file": "/etc/audit/auditd.conf",
        "regex": "(?i)^[\\\\s]*admin_space_left_action[\\\\s]*=",
        "expect": "(?i)^[\\\\s]*admin_space_left_action[\\\\s]*=[\\\\s]*(single|halt)[\\\\s]*$"
      },
      {
        "type": "FILE_CONTENT_CHECK",
        "description": "space_left_action",
        "file": "/etc/audit/auditd.conf",
        "regex": "(?i)^[\\\\s]*space_left_action[\\\\s]*=",
        "expect": "(?i)^[\\\\s]*space_left_action[\\\\s]*=[\\\\s]*(email|exec|single|halt)[\\\\s]*$"
      }
    ]
  },
  "then": {
    "report": {
      "description": "6.3.2.4 Ensure system warns when audit logs are low on space",
      "info": "The auditd daemon can be configured to halt the system, put the system in single user mode or send a warning message, if the partition that holds the audit log files is low on space.\n\nThe space_left_action parameter tells the system what action to take when the system has detected that it is starting to get low on disk space. Valid values are ignore syslog rotate email exec suspend single and halt\n\n - ignore the audit daemon does nothing\n - syslog the audit daemon will issue a warning to syslog\n - rotate the audit daemon will rotate logs, losing the oldest to free up space\n - email the audit daemon will send a warning to the email account specified in action_mail_acct as well as sending the message to syslog\n - exec /path-to-script will execute the script. You cannot pass parameters to the script. The script is also responsible for telling the auditd daemon to resume logging once its completed its action\n - suspend the audit daemon will stop writing records to the disk\n - single the audit daemon will put the computer system in single user mode\n - halt the audit daemon will shut down the system\n\nThe admin_space_left_action parameter tells the system what action to take when the system has detected that it is low on disk space. Valid values are ignore syslog rotate email exec suspend single and halt\n\n - ignore the audit daemon does nothing\n - syslog the audit daemon will issue a warning to syslog\n - rotate the audit daemon will rotate logs, losing the oldest to free up space\n - email the audit daemon will send a warning to the email account specified in action_mail_acct as well as sending the message to syslog\n - exec /path-to-script will execute the script. You cannot pass parameters to the script. The script is also responsible for telling the auditd daemon to resume logging once its completed its action\n - suspend the audit daemon will stop writing records to the disk\n - single the audit daemon will put the computer system in single user mode\n - halt the audit daemon will shut down the system\n\nIn high security contexts, the risk of detecting unauthorized access or nonrepudiation exceeds the benefit of the system's availability.",
      "solution": "\"Set the space_left_action parameter in /etc/audit/auditd.conf to email exec single or halt :",
      "Example": "admin_space_left_action = single",
      "Note": "A Mail Transfer Agent (MTA) must be installed and configured properly to set space_left_action = email",
      "Impact": "If the admin_space_left_action is set to single the audit daemon will put the computer system in single user mode.\"",
      "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-2,800-53|AU-4,800-53|AU-7,800-53|AU-12,800-53r5|AU-2,800-53r5|AU-4,800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(c),CN-L3|8.1.4.3(a),CSCv7|6.2,CSCv8|8.2,CSCv8|8.3,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.DS-4,CSF|PR.PT-1,CSF|RS.AN-3,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|DE.CM-09,CSF2.0|PR.PS-04,CSF2.0|RS.AN-03,CSF2.0|RS.AN-06,CSF2.0|RS.AN-07,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-2,ITSG-33|AU-4,ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|2A,NESA|M1.2.2,NESA|M5.5.1,NESA|T3.3.1,NESA|T3.6.2,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|SS30,NIAv2|VL8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
      "see_also": "https://workbench.cisecurity.org/benchmarks/17074",
      "show_output": true,
      "type": "PASSED"
    }
  }
}