{
  "type": "FILE_CONTENT_CHECK",
  "description": "6.3.2.2 Ensure audit logs are not automatically deleted",
  "info": "The max_log_file_action setting determines how to handle the audit log file reaching the max file size. A value of keep_logs will rotate the logs but never delete old logs.\n\nIn high security contexts, the benefits of maintaining a long audit history exceed the cost of storing the audit history.",
  "solution": "Set the following parameter in /etc/audit/auditd.conf:\n\nmax_log_file_action = keep_logs",
  "reference": "800-53|AU-4,800-53r5|AU-4,CSCv7|6.4,CSCv8|8.3,CSF|PR.DS-4,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-4,LEVEL|2A,NESA|T3.3.1,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|13.2",
  "see_also": "https://workbench.cisecurity.org/benchmarks/17074",
  "file": "/etc/audit/auditd.conf",
  "regex": "^[\\\\s]*max_log_file_action[\\\\s]*=",
  "expect": "^[\\\\s]*max_log_file_action[\\\\s]*=[\\\\s]*(?i)keep_logs(?-i)[\\\\s]*$"
}