{
  "type": "REGISTRY_SETTING",
  "description": "4.7 (L2) Ensure 'Controls the mode of DNS-over-HTTPS' is set to 'Enabled: DNS-over-HTTPS without insecure fallback'",
  "info": "\"This controls the mode of the DNS-over-HTTPS resolver. Please note that this setting will only set the default mode for each query. The mode may be overridden for special types of queries, such as requests to resolve a DNS-over-HTTPS server hostname.\n\n - Disable DNS-over-HTTPS (off)\n - Enable DNS-over-HTTPS with insecure fallback (automatic) - Enable DNS-over-HTTPS queries first if a DNS-over-HTTPS server is available and may fallback to sending insecure queries on error.\n - Enable DNS-over-HTTPS without insecure fallback (secure) - Only send DNS-over-HTTPS queries and will fail to resolve on error.\n\nThe recommended state for this setting is: Enabled with a value of Enable DNS-over-HTTPS without insecure fallback (secure)",
  "Note": "When enabling this policy, it is recommended to also configure the DnsOverHttpsTemplates policy so that the URI templates are set. You can find out more information on the\n\nDnsOverHttpsTemplates enterprise policy site\n\n.\n\nDNS over HTTPS (DOH) has a couple primary benefits:\n\n -\n\nEncrypting DNS name resolution traffic helps to hide your online activities, since DoH hides the name resolution requests from the ISP and from anyone listening on intermediary networks.\n\n -\n\nDoH also helps to prevent DNS spoofing and man-in-the-middle (MitM) attacks.\"",
  "solution": "'To establish the recommended configuration via Group Policy, set the following UI path to Enabled: Enable DNS-over-HTTPS without insecure fallback :\n\nComputer Configuration\\\\Policies\\\\Administrative Templates\\\\Google\\\\Google Chrome\\\\Controls the mode of DNS-over-HTTPS",
  "Impact": "Not all DNS providers support DOH, so choice is limited. Also, Enterprises sometimes monitor DNS requests to block access to malicious or inappropriate sites. DNS monitoring can also sometimes be used to detect malware attempting to \\'phone home.\\' Because DoH encrypts name resolution requests, it can create a security monitoring blind spot.'",
  "reference": "800-171|3.1.13,800-171|3.2.1,800-171|3.2.2,800-171|3.5.2,800-171|3.13.8,800-171r3|03.02.01,800-171r3|03.05.07,800-171r3|03.05.12,800-171r3|03.13.08,800-53|AC-17(2),800-53|AT-2,800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|AT-2,800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv8|3.10,CSCv8|14.4,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.AT-1,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,CSF2.0|PR.AA-05,CSF2.0|PR.AT-01,CSF2.0|PR.DS-02,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO-27001-2022|A.5.10,ISO-27001-2022|A.5.14,ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.17,ISO-27001-2022|A.5.33,ISO-27001-2022|A.6.3,ISO-27001-2022|A.6.7,ISO-27001-2022|A.8.7,ISO-27001-2022|A.8.20,ISO-27001-2022|7.3,ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|AT-2,ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|2A,NESA|M1.3.6,NESA|M3.4.1,NESA|T3.4.1,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM13,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,SWIFT-CSCv1|7.2,TBA-FIISB|29.1",
  "see_also": "https://workbench.cisecurity.org/benchmarks/8691",
  "value_type": "POLICY_TEXT",
  "value_data": "secure",
  "reg_key": "HKLM\\Software\\Policies\\Google\\Chrome",
  "reg_item": "DnsOverHttpsMode",
  "reg_option": "CAN_NOT_BE_NULL"
}