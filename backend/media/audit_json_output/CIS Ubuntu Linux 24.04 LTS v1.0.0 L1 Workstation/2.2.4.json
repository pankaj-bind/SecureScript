{
  "check_type": "CONDITIONAL",
  "condition": {
    "auto_status": "FAILED",
    "type": "AND",
    "rules": [
      {
        "type": "CMD_EXEC",
        "description": "Ensure package name equals 'inetutils-telnet' is not installed",
        "cmd": "/bin/dpkg -s inetutils-telnet 2>&1 | /bin/grep -E '(^Status:|not installed)'",
        "expect": "(^Status: deinstall ok|not installed)"
      },
      {
        "type": "CMD_EXEC",
        "description": "Ensure package name equals 'telnet' is not installed",
        "cmd": "/bin/dpkg -s telnet 2>&1 | /bin/grep -E '(^Status:|not installed)'",
        "expect": "(^Status: deinstall ok|not installed)"
      }
    ]
  },
  "then": {
    "report": {
      "description": "2.2.4 Ensure telnet client is not installed",
      "info": "The inetutils-telnet package contains the telnet client, which allows users to start connections to other systems via the telnet protocol.\n\nThe telnet protocol is insecure and unencrypted. The use of an unencrypted transmission medium could allow an unauthorized user to steal credentials. The ssh package provides an encrypted session and stronger security and is included in most Linux distributions.",
      "solution": "\"Run the following commands to uninstall telnet & inetutils-telnet :\n\n# apt purge telnet\n# apt purge inetutils-telnet",
      "Impact": "Many insecure service clients are used as troubleshooting tools and in testing environments. Uninstalling them can inhibit capability to test and troubleshoot. If they are required it is advisable to remove the clients after use to prevent accidental or intentional misuse.\"",
      "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
      "see_also": "https://workbench.cisecurity.org/benchmarks/18959",
      "show_output": true,
      "type": "PASSED"
    }
  }
}