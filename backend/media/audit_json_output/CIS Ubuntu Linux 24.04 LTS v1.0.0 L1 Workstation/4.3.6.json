{
  "check_type": "CONDITIONAL",
  "condition": {
    "auto_status": "FAILED",
    "type": "AND",
    "rules": [
      {
        "type": "CMD_EXEC",
        "description": "nft list ruleset hook input iif lo accept",
        "cmd": "/sbin/nft list ruleset | /bin/awk '/hook input/,/}/' | /bin/grep 'iif \\\"lo\\\" accept'",
        "expect": "^iif[\\\\s]+\\\"lo\\\"[\\\\s]+accept"
      },
      {
        "type": "CMD_EXEC",
        "description": "nft list ruleset hook input ip saddr",
        "cmd": "/sbin/nft list ruleset | /bin/awk '/hook input/,/}/' | /bin/grep 'ip saddr'",
        "expect": "^ip[\\\\s]+saddr[\\\\s]+127\\\\.0\\\\.0\\\\.0/8"
      }
    ]
  },
  "then": {
    "report": {
      "description": "4.3.6 Ensure nftables loopback traffic is configured",
      "info": "Configure the loopback interface to accept traffic. Configure all other interfaces to deny traffic to the loopback network\n\nLoopback traffic is generated between processes on machine and is typically critical to the operation of the system. The loopback interface is the only place that loopback network traffic should be seen, all other interfaces should ignore traffic on this network as an anti-spoofing measure.",
      "solution": "Run the following commands to implement the loopback rules:\n\n# nft add rule inet filter input iif lo accept # nft add rule inet filter input ip saddr 127.0.0.0/8 counter drop\n\n- IF - IPv6 is enabled on the system:\n\nRun the following command to implement the IPv6 loopback rule:\n\n# nft add rule inet filter input ip6 saddr ::1 counter drop",
      "reference": "800-171|3.13.1,800-171|3.13.5,800-171|3.13.6,800-171r3|03.13.01,800-171r3|03.13.06,800-53|CA-9,800-53|SC-7,800-53|SC-7(5),800-53r5|CA-9,800-53r5|SC-7,800-53r5|SC-7(5),CN-L3|7.1.2.2(c),CN-L3|8.1.10.6(j),CSCv7|9.4,CSCv8|4.4,CSCv8|4.5,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,CSF2.0|DE.CM-01,CSF2.0|ID.AM-03,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,CSF2.0|PR.IR-01,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),ISO-27001-2022|A.5.14,ISO-27001-2022|A.8.16,ISO-27001-2022|A.8.20,ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,ITSG-33|SC-7(5),LEVEL|1A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.1,TBA-FIISB|43.1",
      "see_also": "https://workbench.cisecurity.org/benchmarks/18959",
      "show_output": true,
      "type": "PASSED"
    }
  }
}