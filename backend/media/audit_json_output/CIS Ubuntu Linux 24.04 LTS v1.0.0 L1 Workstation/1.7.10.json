{
  "type": "CMD_EXEC",
  "description": "1.7.10 Ensure XDMCP is not enabled",
  "info": "X Display Manager Control Protocol (XDMCP) is designed to provide authenticated access to display management services for remote displays\n\nXDMCP is inherently insecure.\n\n - XDMCP is not a ciphered protocol. This may allow an attacker to capture keystrokes entered by a user\n - XDMCP is vulnerable to man-in-the-middle attacks. This may allow an attacker to steal the credentials of legitimate users by impersonating the XDMCP server.",
  "solution": "Edit all files returned by the audit and remove or commend out the Enable=true line in the [xdmcp] block:\n\nExample file:\n\n# GDM configuration storage\n#\n# See /usr/share/gdm/gdm.schemas for a list of available options.\n\n[daemon]\n# Uncomment the line below to force the login screen to use Xorg\n#WaylandEnable=false\n\n# Enabling automatic login\n# AutomaticLoginEnable = true\n# AutomaticLogin = user1\n\n# Enabling timed login\n# TimedLoginEnable = true\n# TimedLogin = user1\n# TimedLoginDelay = 10\n\n[security]\n\n[xdmcp]\n# Enable=true <- **This line should be removed or commented out**\n\n[chooser]\n\n[debug]\n# Uncomment the line below to turn on debugging\n# More verbose logs\n# Additionally lets the X server dump core if it crashes\n#Enable=true",
  "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
  "see_also": "https://workbench.cisecurity.org/benchmarks/18959",
  "cmd": "#!/bin/bash\n{\n   while IFS= read -r l_file; do\n      /bin/awk '/\\\\[xdmcp\\\\]/{ f = 1;next } /\\\\[/{ f = 0 } f {if (/^\\\\s*Enable\\\\s*=\\\\s*true/) print \\\"The file: \\\\\\\"'\\\"$l_file\\\"'\\\\\\\" includes: \\\\\\\"\\\" $0 \\\"\\\\\\\" in the \\\\\\\"[xdmcp]\\\\\\\" block\\\"}' \\\"$l_file\\\"\n   done < <(/bin/grep -Psil -- '^\\\\h*\\\\[xdmcp\\\\]' /etc/{gdm3,gdm}/{custom,daemon}.conf)\n} | /bin/awk '{print} END {if (NR == 0) print \\\"Pass\\\"; else print \\\"Fail\\\"}'",
  "expect": "^Pass$"
}