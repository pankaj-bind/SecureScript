{
  "check_type": "CONDITIONAL",
  "condition": {
    "auto_status": "FAILED",
    "type": "OR",
    "rules": [
      {
        "type": "CMD_EXEC",
        "description": "sudo timeout",
        "cmd": "/bin/sudo -V | /bin/grep 'Authentication timestamp timeout:'",
        "expect": "Authentication timestamp timeout:[\\\\s]*([1-9]|1[0-5])\\\\."
      },
      {
        "type": "FILE_CONTENT_CHECK_NOT",
        "description": "On disk timestamp_timeout",
        "file": "/etc/sudoers /etc/sudoers.d/*",
        "regex": "(?i)^\\\\h*defaults\\\\h+(?:[^#\\\\n\\\\r]+\\\\h*,\\\\h*)?timestamp_timeout=(-1|1[6-9]|[2-9][0-9]|[1-9][0-9][0-9]+)\\\\b(\\\\h*,\\\\h*.*)?$",
        "expect": "(?i)^\\\\h*defaults\\\\h+(?:[^#\\\\n\\\\r]+\\\\h*,\\\\h*)?timestamp_timeout=(-1|1[6-9]|[2-9][0-9]|[1-9][0-9][0-9]+)\\\\b(\\\\h*,\\\\h*.*)?$",
        "required": false,
        "min_occurrences": "1"
      }
    ]
  },
  "then": {
    "report": {
      "description": "5.2.6 Ensure sudo authentication timeout is configured correctly",
      "info": "sudo caches used credentials for a default of 15 minutes. This is for ease of use when there are multiple administrative tasks to perform. The timeout can be modified to suit local security policies.\n\nThis default is distribution specific. See audit section for further information.\n\nSetting a timeout value reduces the window of opportunity for unauthorized privileged access to another user.",
      "solution": "If the currently configured timeout is larger than 15 minutes, edit the file listed in the audit section with visudo -f <PATH TO FILE> and modify the entry timestamp_timeout= to 15 minutes or less as per your site policy. The value is in minutes. This particular entry may appear on it's own, or on the same line as env_reset See the following two examples:\n\nDefaults env_reset, timestamp_timeout=15 Defaults timestamp_timeout=15\nDefaults env_reset",
      "reference": "800-171|3.1.5,800-171|3.1.6,800-171r3|03.01.06a.,800-171r3|03.01.06b.,800-53|AC-6(2),800-53|AC-6(5),800-53r5|AC-6(2),800-53r5|AC-6(5),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSCv7|4.3,CSCv8|5.4,CSF|PR.AC-4,CSF2.0|PR.AA-05,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO-27001-2022|A.5.15,ISO-27001-2022|A.8.2,ISO-27001-2022|A.8.18,ISO/IEC-27001|A.9.2.3,ITSG-33|AC-6(2),ITSG-33|AC-6(5),LEVEL|1A,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.6.1,NIAv2|AM1,NIAv2|AM23f,NIAv2|AM32,NIAv2|AM33,NIAv2|SS13c,NIAv2|SS15c,NIAv2|VL3a,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
      "see_also": "https://workbench.cisecurity.org/benchmarks/18959",
      "show_output": true,
      "type": "PASSED"
    }
  }
}