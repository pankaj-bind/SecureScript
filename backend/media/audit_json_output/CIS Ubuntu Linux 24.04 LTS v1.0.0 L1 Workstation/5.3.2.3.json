{
  "type": "FILE_CONTENT_CHECK",
  "description": "5.3.2.3 Ensure pam_pwquality module is enabled",
  "info": "The pam_pwquality.so module performs password quality checking. This module can be plugged into the password stack of a given service to provide strength-checking for passwords. The code was originally based on pam_cracklib module and the module is backwards compatible with its options.\n\nThe action of this module is to prompt the user for a password and check its strength against a system dictionary and a set of rules for identifying poor choices.\n\nThe first action is to prompt for a single password, check its strength and then, if it is considered strong, prompt for the password a second time (to verify that it was typed correctly on the first occasion). All being well, the password is passed on to subsequent modules to be installed as the new authentication token.\n\nUse of a unique, complex passwords helps to increase the time and resources required to compromise the password.",
  "solution": "\"Run the following script to verify the pam_pwquality.so line exists in a pam-auth-update profile:\n\n# grep -P -- '\\bpam_pwquality\\.so\\b' /usr/share/pam-configs/*\n\nOutput should be similar to:",
  "/usr/share/pam-configs/pwquality": "requisite pam_pwquality.so retry=3\n\n- IF - similar output is returned:\n\nRun the following command to update /etc/pam.d/common-password with the returned profile:\n\n# pam-auth-update --enable {PROFILE_NAME}",
  "Example": "#!/usr/bin/env bash\n\n{",
  "Name": "Pwquality password strength checking",
  "Default": "yes",
  "Priority": "1024",
  "Conflicts": "cracklib",
  "Password-Type": "Primary",
  "Password": "requisite pam_pwquality.so retry=3",
  "arr=('Name": "Pwquality password strength checking' 'Default: yes' 'Priority: 1024' 'Conflicts: cracklib' 'Password-Type: Primary' 'Password:' ' requisite pam_pwquality.so retry=3')\n   printf '%s\\n' \\\"${arr[@]}\\\" > /usr/share/pam-configs/pwquality\n}\n\nRun the following command to update /etc/pam.d/common-password with the pwquality profile:\n\n# pam-auth-update --enable pwquality",
  "Note": "- The name used for the file must be used in the pam-auth-update --enable command\n - The Name: line should be easily recognizable and understood\n - The Priority: Line is important as it effects the order of the lines in the /etc/pam.d/ files\n - If a site specific custom profile is being used in your environment to configure PAM that includes the configuration for the pam_pwquality module, enable that module instead\"",
  "reference": "800-171|3.5.2,800-171r3|03.05.07,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.17,ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
  "see_also": "https://workbench.cisecurity.org/benchmarks/18959",
  "file": "/etc/pam.d/common-password",
  "regex": "(?i)^\\\\h*password\\\\h+(requisite|required)\\\\h+pam_pwquality\\\\.so\\\\b",
  "expect": "(?i)^\\\\h*password\\\\h+(requisite|required)\\\\h+pam_pwquality\\\\.so\\\\b"
}