{
  "check_type": "CONDITIONAL",
  "condition": {
    "type": "OR",
    "rules": [
      {
        "type": "CMD_EXEC",
        "description": "journald check - active",
        "cmd": "/bin/systemctl is-active systemd-journald",
        "expect": "^active$"
      },
      {
        "type": "CMD_EXEC",
        "description": "active",
        "cmd": "/bin/systemctl is-active rsyslog",
        "expect": "^active$"
      }
    ]
  },
  "then": {
    "report": {
      "description": "6.1.3.6 Ensure rsyslog is configured to send logs to a remote log host",
      "info": "rsyslog supports the ability to send log events it gathers to a remote log host or to receive messages from remote hosts, thus enabling centralized log management.\n\nStoring log data on a remote host protects log integrity from local attacks. If an attacker gains root access on the local system, they could tamper with or remove log data that is stored on the local system.",
      "solution": "Edit the rsyslog configuration and add the following line (where loghost.example.com is the name of your central log host). The target directive may either be a fully qualified domain name or an IP address.\n\nExample script to create a drop-in configuration file:\n\n#!/usr/bin/env bash\n\n{\n   a_parameters=('*.* action(type=\\\"omfwd\\\" target=\\\"loghost.example.com\\\" port=\\\"514\\\" protocol=\\\"tcp\\\"' \\\n   ' action.resumeRetryCount=\\\"100\\\"' ' queue.type=\\\"LinkedList\\\" queue.size=\\\"1000\\\")')\n   [ ! -d \\\"/etc/rsyslog.d/\\\" ] && mkdir /etc/rsyslod.d/\n   printf '%s\\n' \\\"\\\" \\\"${a_parameters[@]}\\\" >> /etc/rsyslog.d/60-rsyslog.conf\n}\n\nRun the following command to reload rsyslog.service :\n\n# systemctl reload-or-restart rsyslog.service",
      "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-171r3|03.03.01,800-171r3|03.03.03,800-171r3|03.03.06a.,800-53|AU-2,800-53|AU-7,800-53|AU-12,800-53r5|AU-2,800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(c),CN-L3|8.1.4.3(a),CSCv7|6.2,CSCv7|6.3,CSCv8|8.2,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|DE.CM-09,CSF2.0|PR.PS-04,CSF2.0|RS.AN-03,CSF2.0|RS.AN-06,CSF2.0|RS.AN-07,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO-27001-2022|A.8.15,ITSG-33|AU-2,ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1M,NESA|M1.2.2,NESA|M5.5.1,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|SS30,NIAv2|VL8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
      "see_also": "https://workbench.cisecurity.org/benchmarks/18959",
      "show_output": true,
      "type": "PASSED"
    }
  }
}