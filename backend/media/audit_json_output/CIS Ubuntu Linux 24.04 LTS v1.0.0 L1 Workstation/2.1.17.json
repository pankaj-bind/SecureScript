{
  "type": "CMD_EXEC",
  "description": "2.1.17 Ensure web proxy server services are not in use",
  "info": "\"Squid is a standard proxy server used in many distributions and environments.\n\nUnless a system is specifically set up to act as a proxy server, it is recommended that the squid package be removed to reduce the potential attack surface.",
  "Note": "Several HTTP proxy servers exist. These should be checked and removed unless required.\"",
  "solution": "\"Run the following commands to stop squid.service and remove the squid package:\n\n# systemctl stop squid.service\n# apt purge squid\n\n- OR - If the squid package is required as a dependency:\n\nRun the following commands to stop and mask the squid.service :\n\n# systemctl stop squid.service\n# systemctl mask squid.service",
  "Impact": "There may be packages that are dependent on the squid package. If the squid package is removed, these dependent packages will be removed as well. Before removing the squid package, review any dependent packages to determine if they are required on the system.\n\n- IF - a dependent package is required: stop and mask the squid.service leaving the squid package installed.\"",
  "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
  "see_also": "https://workbench.cisecurity.org/benchmarks/18959",
  "cmd": "/bin/dpkg -s squid 2>&1 | /bin/grep -E '(^Status:|not installed)'",
  "expect": "(^Status: deinstall ok|not installed)"
}