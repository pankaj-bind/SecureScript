{
  "check_type": "CONDITIONAL",
  "condition": {
    "auto_status": "FAILED",
    "type": "AND",
    "rules": [
      {
        "type": "CMD_EXEC",
        "description": "Ensure package name equals 'ftp' is not installed",
        "cmd": "/bin/dpkg -s ftp 2>&1 | /bin/grep -E '(^Status:|not installed)'",
        "expect": "(^Status: deinstall ok|not installed)"
      },
      {
        "type": "CMD_EXEC",
        "description": "Ensure package name equals 'tnftp' is not installed",
        "cmd": "/bin/dpkg -s tnftp 2>&1 | /bin/grep -E '(^Status:|not installed)'",
        "expect": "(^Status: deinstall ok|not installed)"
      }
    ]
  },
  "then": {
    "report": {
      "description": "2.2.6 Ensure ftp client is not installed",
      "info": "tnftp an enhanced FTP client, is the user interface to the Internet standard File Transfer Protocol. The program allows a user to transfer files to and from a remote network site.\n\nUnless there is a need to run the system using Internet standard File Transfer Protocol (for example, to allow anonymous downloads), it is recommended that the package be removed to reduce the potential attack surface.",
      "solution": "Run the following commands to uninstall tnftp & ftp :\n\n# apt purge ftp\n# apt purge tnftp",
      "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
      "see_also": "https://workbench.cisecurity.org/benchmarks/18959",
      "show_output": true,
      "type": "PASSED"
    }
  }
}