{
  "check_type": "CONDITIONAL",
  "condition": {
    "auto_status": "FAILED",
    "type": "AND",
    "rules": [
      {
        "type": "FILE_CONTENT_CHECK",
        "description": "/etc/security/faillock.conf",
        "file": "/etc/security/faillock.conf",
        "regex": "(?i)^\\\\h*deny\\\\h*=\\\\h*@PASSWORD_LOCKOUT@\\\\b",
        "expect": "(?i)^\\\\h*deny\\\\h*=\\\\h*@PASSWORD_LOCKOUT@\\\\b"
      },
      {
        "type": "FILE_CONTENT_CHECK",
        "description": "/etc/pam.d/common-auth",
        "file": "/etc/pam.d/common-auth",
        "regex": "^\\\\h*auth\\\\h+(requisite|required|sufficient)\\\\h+pam_faillock\\\\.so\\\\h+([^#\\\\r]+\\\\h+)?deny\\\\h*=",
        "expect": "^\\\\h*auth\\\\h+(requisite|required|sufficient)\\\\h+pam_faillock\\\\.so\\\\h+([^#\\\\r]+\\\\h+)?deny\\\\h*=\\\\h*@PASSWORD_LOCKOUT@\\\\b",
        "string_required": false
      }
    ]
  },
  "then": {
    "report": {
      "description": "5.3.3.1.1 Ensure password failed attempts lockout is configured",
      "info": "The deny=<n> option will deny access if the number of consecutive authentication failures for this user during the recent interval exceeds\n\n.\n\nLocking out user IDs after\n\nn\n\nunsuccessful consecutive login attempts mitigates brute force password attacks against your systems.",
      "solution": "Create or edit the following line in /etc/security/faillock.conf setting the deny option to 5 or less:\n\ndeny = 5\n\nRun the following command:\n\n# grep -Pl -- '\\bpam_faillock\\.so\\h+([^#\\n\\r]+\\h+)?deny\\b' /usr/share/pam-configs/*\n\nEdit any returned files and remove the deny=<N> arguments from the pam_faillock.so line(s):",
      "reference": "800-171|3.1.1,800-171r3|03.01.01,800-171r3|03.15.01,800-53|AC-1,800-53|AC-2,800-53|AC-2(1),800-53r5|AC-1,800-53r5|AC-2,800-53r5|AC-2(1),CN-L3|7.1.3.2(d),CN-L3|8.1.4.2(e),CN-L3|8.1.10.6(c),CSCv7|16.7,CSCv8|6.2,CSF|DE.CM-1,CSF|DE.CM-3,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF2.0|DE.CM-01,CSF2.0|DE.CM-03,CSF2.0|GV.OC-03,CSF2.0|GV.OV-01,CSF2.0|GV.PO-01,CSF2.0|GV.PO-02,CSF2.0|GV.SC-03,CSF2.0|ID.IM-01,CSF2.0|ID.IM-02,CSF2.0|ID.IM-03,CSF2.0|PR.AA-01,CSF2.0|PR.AA-05,CSF2.0|PR.DS-10,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO-27001-2022|A.5.1,ISO-27001-2022|A.5.2,ISO-27001-2022|A.5.4,ISO-27001-2022|A.5.15,ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.18,ISO-27001-2022|A.5.31,ISO-27001-2022|A.5.36,ISO-27001-2022|A.5.37,ISO-27001-2022|A.8.2,ISO-27001-2022|5.2,ISO-27001-2022|5.3,ISO-27001-2022|7.5.1,ISO-27001-2022|7.5.2,ISO-27001-2022|7.5.3,ISO/IEC-27001|A.9.1.1,ISO/IEC-27001|A.9.2.1,ITSG-33|AC-1,ITSG-33|AC-2,ITSG-33|AC-2(1),LEVEL|1A,NESA|M1.2.2,NIAv2|AM28,NIAv2|AM29,NIAv2|AM30,NIAv2|NS5j,NIAv2|SS14e,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2",
      "see_also": "https://workbench.cisecurity.org/benchmarks/18959",
      "show_output": true,
      "type": "PASSED"
    }
  }
}