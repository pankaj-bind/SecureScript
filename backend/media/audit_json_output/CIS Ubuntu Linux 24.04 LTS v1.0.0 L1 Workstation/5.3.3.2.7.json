{
  "check_type": "CONDITIONAL",
  "condition": {
    "auto_status": "FAILED",
    "type": "AND",
    "rules": [
      {
        "type": "FILE_CONTENT_CHECK_NOT",
        "description": "/etc/pam.d/common-password",
        "file": "/etc/pam.d/common-password",
        "regex": "(?i)^\\\\h*password\\\\h+(requisite|required|sufficient)\\\\h+pam_pwquality\\\\.so\\\\h+([^#\\\\r]+\\\\h+)?enforcing\\\\h*=\\\\h*0\\\\b",
        "expect": "(?i)^\\\\h*password\\\\h+(requisite|required|sufficient)\\\\h+pam_pwquality\\\\.so\\\\h+([^#\\\\r]+\\\\h+)?enforcing\\\\h*=\\\\h*0\\\\b"
      },
      {
        "type": "FILE_CONTENT_CHECK_NOT",
        "description": "pwquality - enforcing",
        "file": "/etc/security/pwquality.conf /etc/security/pwquality.conf.d/*.conf",
        "regex": "(?i)^\\\\h*enforcing\\\\h*=\\\\h*0\\\\b",
        "expect": "(?i)^\\\\h*enforcing\\\\h*=\\\\h*0\\\\b"
      }
    ]
  },
  "then": {
    "report": {
      "description": "5.3.3.2.7 Ensure password quality checking is enforced",
      "info": "The pam_pwquality module can be configured to either reject a password if it fails the checks, or only print a warning.\n\nThis is configured by setting the enforcing=<N> argument. If nonzero, a password will be rejected if it fails the checks, otherwise only a warning message will be provided.\n\nThis setting applies only to the pam_pwquality module and possibly other applications that explicitly change their behavior based on it. It does not affect pwmake(1) and pwscore(1).\n\nStrong passwords help protect systems from password attacks. Types of password attacks include dictionary attacks, which attempt to use common words and phrases, and brute force attacks, which try every possible combination of characters. Also attackers may try to obtain the account database so they can use tools to discover the accounts and passwords.",
      "solution": "\"Run the following command:\n\n# grep -Pl -- '\\bpam_pwquality\\.so\\h+([^#\\n\\r]+\\h+)?enforcing=0\\b' /usr/share/pam-configs/*\n\nEdit any returned files and remove the enforcing=0 argument from the pam_pwquality.so line(s)\n\nEdit /etc/security/pwquality.conf and all files ending inconf in the /etc/security/pwquality.conf.d/ directory and remove or comment out any line containing the enforcing = 0 argument:",
      "Example": "# sed -ri 's/^\\s*enforcing\\s*=\\s*0/# &/' /etc/security/pwquality.conf /etc/security/pwquality.conf.d/*.conf\"",
      "reference": "800-171|3.5.2,800-171r3|03.05.07,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.17,ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
      "see_also": "https://workbench.cisecurity.org/benchmarks/18959",
      "show_output": true,
      "type": "PASSED"
    }
  }
}