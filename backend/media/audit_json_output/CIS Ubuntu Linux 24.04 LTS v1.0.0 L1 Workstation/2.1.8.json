{
  "check_type": "CONDITIONAL",
  "condition": {
    "auto_status": "FAILED",
    "type": "AND",
    "rules": [
      {
        "type": "CMD_EXEC",
        "description": "dovecot-pop3 not installed",
        "cmd": "/bin/dpkg -s dovecot-pop3 2>&1 | /bin/grep -E '(^Status:|not installed)'",
        "expect": "(^Status: deinstall ok|not installed)"
      },
      {
        "type": "CMD_EXEC",
        "description": "dovecot-imapd not installed",
        "cmd": "/bin/dpkg -s dovecot-imapd 2>&1 | /bin/grep -E '(^Status:|not installed)'",
        "expect": "(^Status: deinstall ok|not installed)"
      }
    ]
  },
  "then": {
    "report": {
      "description": "2.1.8 Ensure message access server services are not in use",
      "info": "\"dovecot-imapd and dovecot-pop3d are an open source IMAP and POP3 server for Linux based systems.\n\nUnless POP3 and/or IMAP servers are to be provided by this system, it is recommended that the package be removed to reduce the potential attack surface.",
      "Note": "Several IMAP/POP3 servers exist and can use other service names. These should also be audited and the packages removed if not required.\"",
      "solution": "\"Run one of the following commands to remove dovecot-imapd and dovecot-pop3d :\n\nRun the following commands to stop dovecot.socket and dovecot.service and remove the dovecot-imapd and dovecot-pop3d packages:\n\n# systemctl stop dovecot.socket dovecot.service\n# apt purge dovecot-imapd dovecot-pop3d\n\n- OR -\n\n- IF - a package is installed and is required for dependencies:\n\nRun the following commands to stop and mask dovecot.socket and dovecot.service :\n\n# systemctl stop dovecot.socket dovecot.service\n# systemctl mask dovecot.socket dovecot.service",
      "Impact": "There may be packages that are dependent on dovecot-imapd and/or dovecot-pop3d packages. If dovecot-imapd and dovecot-pop3d packages are removed, these dependent packages will be removed as well. Before removing dovecot-imapd and/or dovecot-pop3d packages, review any dependent packages to determine if they are required on the system.\n\n- IF - a dependent package is required: stop and mask dovecot.socket and dovecot.service leaving dovecot-imapd and/or dovecot-pop3d packages installed.\"",
      "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
      "see_also": "https://workbench.cisecurity.org/benchmarks/18959",
      "show_output": true,
      "type": "PASSED"
    }
  }
}