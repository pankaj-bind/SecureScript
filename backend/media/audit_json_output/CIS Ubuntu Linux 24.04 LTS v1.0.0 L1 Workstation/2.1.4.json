{
  "type": "CMD_EXEC",
  "description": "2.1.4 Ensure dns server services are not in use",
  "info": "\"The Domain Name System (DNS) is a hierarchical naming system that maps names to IP addresses for computers, services and other resources connected to a network.",
  "Note": "bind9 is the package and bind.service is the alias for named.service\n\nUnless a system is specifically designated to act as a DNS server, it is recommended that the package be deleted to reduce the potential attack surface.\"",
  "solution": "\"Run the following commands to stop named.service and remove the bind9 package:\n\n# systemctl stop named.service\n# apt purge bind9\n\n- OR -\n\n- IF - the bind9 package is required as a dependency:\n\nRun the following commands to stop and mask bind9.service :\n\n# systemctl stop named.service\n# systemctl mask named.service",
  "Impact": "There may be packages that are dependent on the bind9 package. If the bind9 package is removed, these dependent packages will be removed as well. Before removing the bind9 package, review any dependent packages to determine if they are required on the system.\n\n- IF - a dependent package is required: stop and mask named.service leaving the bind9 package installed.\"",
  "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
  "see_also": "https://workbench.cisecurity.org/benchmarks/18959",
  "cmd": "/bin/dpkg -s bind9 2>&1 | /bin/grep -E '(^Status:|not installed)'",
  "expect": "(^Status: deinstall ok|not installed)"
}