{
  "type": "CMD_EXEC",
  "description": "2.1.14 Ensure samba file server services are not in use",
  "info": "The Samba daemon allows system administrators to configure their Linux systems to share file systems and directories with Windows desktops. Samba will advertise the file systems and directories via the Server Message Block (SMB) protocol. Windows desktop users will be able to mount these directories and file systems as letter drives on their systems.\n\nIf there is no need to mount directories and file systems to Windows systems, then this service should be deleted to reduce the potential attack surface.",
  "solution": "\"Run the following commands to stop smbd.service and remove samba package:\n\n# systemctl stop smbd.service\n# apt purge samba\n\n- OR -\n\n- IF - the samba package is required as a dependency:\n\nRun the following commands to stop and mask the smbd.service :\n\n# systemctl stop smbd.service\n# systemctl mask smbd.service",
  "Impact": "There may be packages that are dependent on the samba package. If the samba package is removed, these dependent packages will be removed as well. Before removing the samba package, review any dependent packages to determine if they are required on the system.\n\n- IF - a dependent package is required: stop and mask the smbd.service leaving the samba package installed.\"",
  "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
  "see_also": "https://workbench.cisecurity.org/benchmarks/18959",
  "cmd": "/bin/dpkg -s samba 2>&1 | /bin/grep -E '(^Status:|not installed)'",
  "expect": "(^Status: deinstall ok|not installed)"
}