{
  "type": "FILE_CONTENT_CHECK",
  "description": "5.4.1.4 Ensure strong password hashing algorithm is configured",
  "info": "\"A cryptographic hash function converts an arbitrary-length input into a fixed length output. Password hashing performs a one-way transformation of a password, turning the password into another string, called the hashed password.\n\nENCRYPT_METHOD (string) - This defines the system default encryption algorithm for encrypting passwords (if no algorithm are specified on the command line). It can take one of these values:\n\n - MD5 - MD5-based algorithm will be used for encrypting password\n - SHA256 - SHA256-based algorithm will be used for encrypting password\n - SHA512 - SHA512-based algorithm will be used for encrypting password\n - BCRYPT - BCRYPT-based algorithm will be used for encrypting password\n - YESCRYPT - YESCRYPT-based algorithm will be used for encrypting password\n - DES - DES-based algorithm will be used for encrypting password (default)",
  "Note": "- This only effects local groups' passwords created after updating the file to use sha512 or yescrypt\n - If it is determined that the password algorithm being used is not sha512 or yescrypt once it is changed, it is recommended that all group passwords be updated to use the stronger hashing algorithm.\n - It is recommended that the chosen hashing algorithm is consistent across /etc/login.defs and the PAM configuration\"",
  "solution": "\"Edit /etc/login.defs and set the ENCRYPT_METHOD to SHA512 or YESCRYPT :\n\nENCRYPT_METHOD <HASHING_ALGORITHM>",
  "Example": "ENCRYPT_METHOD YESCRYPT",
  "reference": "800-171|3.5.2,800-171|3.13.16,800-171r3|03.05.07,800-171r3|03.13.08,800-53|IA-5(1),800-53|SC-28,800-53|SC-28(1),800-53r5|IA-5(1),800-53r5|SC-28,800-53r5|SC-28(1),CN-L3|8.1.4.7(b),CN-L3|8.1.4.8(b),CSCv7|16.4,CSCv8|3.11,CSF|PR.AC-1,CSF|PR.DS-1,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,CSF2.0|PR.DS-01,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(d),HIPAA|164.312(e)(2)(ii),ISO-27001-2022|A.5.10,ISO-27001-2022|A.5.16,ISO-27001-2022|A.5.17,ISO-27001-2022|A.5.33,ITSG-33|IA-5(1),ITSG-33|SC-28,ITSG-33|SC-28a.,ITSG-33|SC-28(1),LEVEL|1A,NESA|T5.2.3,PCI-DSSv3.2.1|3.4,PCI-DSSv4.0|3.3.2,PCI-DSSv4.0|3.5.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|28.1",
  "see_also": "https://workbench.cisecurity.org/benchmarks/18959",
  "file": "/etc/login.defs",
  "regex": "^\\\\s*ENCRYPT_METHOD\\\\s+",
  "expect": "^\\\\s*ENCRYPT_METHOD\\\\s+(?i)@PASSWORD_ENCRYPTION@(?-i)\\\\s*$"
}