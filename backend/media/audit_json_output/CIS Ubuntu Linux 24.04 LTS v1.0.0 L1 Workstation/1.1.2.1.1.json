{
  "type": "CMD_EXEC",
  "description": "1.1.2.1.1 Ensure /tmp is a separate partition",
  "info": "\"The /tmp directory is a world-writable directory used for temporary storage by all users and some applications.\n\n- IF - an entry for /tmp exists in /etc/fstab it will take precedence over entries in systemd default unit file.",
  "Note": "the size=2G is an example of setting a specific size for tmpfs\n\nExample of using a volume or disk with specific mount options. The source location of the volume or disk will vary depending on your environment:\n\n<device> /tmp <fstype> defaults,nodev,nosuid,noexec 0 0",
  "solution": "\"First ensure that systemd is correctly configured to ensure that /tmp will be mounted at boot time.\n\n# systemctl unmask tmp.mount\n\nFor specific configuration requirements of the /tmp mount for your environment, modify /etc/fstab\n\nExample of using tmpfs with specific mount options:\n\ntmpfs\t/tmp\ttmpfs defaults,rw,nosuid,nodev,noexec,relatime,size=2G 0 0",
  "Impact": "By design files saved to /tmp should have no expectation of surviving a reboot of the system. tmpfs is ram based and all files stored to tmpfs will be lost when the system is rebooted.\n\nIf files need to be persistent through a reboot, they should be saved to /var/tmp not /tmp\n\nSince the /tmp directory is intended to be world-writable, there is a risk of resource exhaustion if it is not bound to tmpfs or a separate partition.\n\nRunning out of /tmp space is a problem regardless of what kind of filesystem lies under it, but in a configuration where /tmp is not a separate file system it will essentially have the whole disk available, as the default installation only creates a single / partition. On the other hand, a RAM-based /tmp (as with tmpfs ) will almost certainly be much smaller, which can lead to applications filling up the filesystem much more easily. Another alternative is to create a dedicated partition for /tmp from a separate volume or disk. One of the downsides of a disk-based dedicated partition is that it will be slower than tmpfs which is RAM-based.\"",
  "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
  "see_also": "https://workbench.cisecurity.org/benchmarks/18959",
  "cmd": "/bin/findmnt -nk /tmp",
  "expect": "^[\\\\s]*/tmp[\\\\s]+"
}