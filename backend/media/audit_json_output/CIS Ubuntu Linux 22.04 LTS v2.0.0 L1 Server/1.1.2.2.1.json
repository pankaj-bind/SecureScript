{
  "type": "FILE_CONTENT_CHECK",
  "description": "1.1.2.2.1 Ensure /dev/shm is a separate partition",
  "info": "The /dev/shm directory is a world-writable directory that can function as shared memory that facilitates inter process communication (IPC).\n\nMaking /dev/shm its own file system allows an administrator to set additional mount options such as the noexec option on the mount, making /dev/shm useless for an attacker to install executable code. It would also prevent an attacker from establishing a hard link to a system setuid program and wait for it to be updated. Once the program was updated, the hard link would be broken and the attacker would have his own copy of the program. If the program happened to have a security vulnerability, the attacker could continue to exploit the known flaw.\n\nThis can be accomplished by mounting tmpfs to /dev/shm",
  "solution": "\"For specific configuration requirements of the /dev/shm mount for your environment, modify /etc/fstab",
  "Example": "tmpfs\t/dev/shm\ttmpfs defaults,rw,nosuid,nodev,noexec,relatime,size=2G 0 0",
  "Impact": "Since the /dev/shm directory is intended to be world-writable, there is a risk of resource exhaustion if it is not bound to a separate partition.\n\n/dev/shm utilizing tmpfs can be resized using the size={size} parameter in the relevant entry in /etc/fstab\"",
  "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
  "see_also": "https://workbench.cisecurity.org/benchmarks/17074",
  "file": "/proc/self/mountinfo",
  "regex": "[\\\\s]+/dev/shm[\\\\s]+",
  "expect": "[\\\\s]+/dev/shm[\\\\s]+",
  "required": false
}