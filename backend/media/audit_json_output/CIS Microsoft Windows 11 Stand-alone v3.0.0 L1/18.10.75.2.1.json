{
  "check_type": "CONDITIONAL",
  "condition": {
    "auto_status": "FAILED",
    "type": "AND",
    "rules": [
      {
        "type": "REGISTRY_SETTING",
        "description": "Ensure 'ShellSmartScreenLevel' is 'Windows: Registry Value' to 'Block'",
        "value_type": "POLICY_TEXT",
        "value_data": "Block",
        "reg_key": "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\System",
        "reg_item": "ShellSmartScreenLevel",
        "reg_option": "CAN_NOT_BE_NULL"
      },
      {
        "type": "REGISTRY_SETTING",
        "description": "Ensure 'EnableSmartScreen' is 'Windows: Registry Value' to '1'",
        "value_type": "POLICY_DWORD",
        "value_data": "1",
        "reg_key": "HKLM\\Software\\Policies\\Microsoft\\Windows\\System",
        "reg_item": "EnableSmartScreen",
        "reg_option": "CAN_NOT_BE_NULL"
      }
    ]
  },
  "then": {
    "report": {
      "description": "18.10.75.2.1 (L1) Ensure 'Configure Windows Defender SmartScreen' is set to 'Enabled: Warn and prevent bypass'",
      "info": "This policy setting allows you to manage the behavior of Windows Defender SmartScreen. Windows Defender SmartScreen helps keep PCs safer by warning users before running unrecognized programs downloaded from the Internet. Some information is sent to Microsoft about files and programs run on PCs with this feature enabled.\n\nThe recommended state for this setting is: Enabled: Warn and prevent bypass\n\nWindows Defender SmartScreen helps keep PCs safer by warning users before running unrecognized programs downloaded from the Internet. However, due to the fact that some information is sent to Microsoft about files and programs run on PCs some organizations may prefer to disable it.",
      "solution": "\"To establish the recommended configuration via GP, set the following UI path to Enabled: Warn and prevent bypass :\n\nComputer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Defender SmartScreen\\Explorer\\Configure Windows Defender SmartScreen",
      "Note": "This Group Policy path is provided by the Group Policy template WindowsExplorer.admx/adml that is included with the Microsoft Windows 8.0 &amp; Server 2012 (non-R2) Administrative Templates (or newer).\n\nNote #2: In older Microsoft Windows Administrative Templates, this setting was initially named\n\nConfigure Windows SmartScreen\n\n, but it was renamed starting with the Windows 10 Release 1703 Administrative Templates.",
      "Impact": "Users will be warned and prevented from running unrecognized programs downloaded from the Internet.\"",
      "reference": "800-53|SI-16,800-53r5|SI-16,CSCv7|8.3,CSCv8|10.5,CSF2.0|PR.DS-10,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-16,LEVEL|1A",
      "see_also": "https://workbench.cisecurity.org/benchmarks/17603",
      "show_output": true,
      "type": "PASSED"
    }
  }
}