{
  "type": "REGISTRY_SETTING",
  "description": "18.4.3 (L1) Ensure 'Configure SMB v1 server' is set to 'Disabled'",
  "info": "This setting configures the server-side processing of the Server Message Block version 1 (SMBv1) protocol.\n\nThe recommended state for this setting is: Disabled\n\nSince September 2016, Microsoft has strongly encouraged that SMBv1 be disabled and no longer used on modern networks, as it is a 30 year old design that is much more vulnerable to attacks then much newer designs such as SMBv2 and SMBv3.\n\nMore information on this can be found at the following links:\n\nStop using SMB1 | Storage at Microsoft\n\nDisable SMB v1 in Managed Environments with Group Policy - 'Stay Safe' Cyber Security Blog\n\nDisabling SMBv1 through Group Policy - Microsoft Security Guidance blog",
  "solution": "\"To establish the recommended configuration via GP, set the following UI path to Disabled :\n\nComputer Configuration\\Policies\\Administrative Templates\\MS Security Guide\\Configure SMB v1 server",
  "Note": "This Group Policy path does not exist by default. An additional Group Policy template ( SecGuide.admx/adml ) is required - it is available from Microsoft at\n\nthis link\n\n.",
  "Impact": "Some legacy OSes (e.g. Windows XP, Server 2003 or older), applications and appliances may no longer be able to communicate with the system once SMBv1 is disabled. We recommend careful testing be performed to determine the impact prior to configuring this as a widespread control, and where possible, remediate any incompatibilities found with the vendor of the incompatible system. Microsoft is also maintaining a thorough (although not comprehensive) list of known SMBv1 incompatibilities at this link:\n\nSMB1 Product Clearinghouse | Storage at Microsoft\"",
  "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv7|14.3,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
  "see_also": "https://workbench.cisecurity.org/benchmarks/17603",
  "value_type": "POLICY_DWORD",
  "value_data": "0",
  "reg_key": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters",
  "reg_item": "SMB1",
  "reg_option": "CAN_NOT_BE_NULL"
}