{
  "type": "REGISTRY_SETTING",
  "description": "2.3.10.9 (L1) Ensure 'Network access: Restrict anonymous access to Named Pipes and Shares' is set to 'Enabled'",
  "info": "When enabled, this policy setting restricts anonymous access to only those shares and pipes that are named in the Network access: Named pipes that can be accessed anonymously and Network access: Shares that can be accessed anonymously settings. This policy setting controls null session access to shares on your computers by adding RestrictNullSessAccess with the value 1 in the\n\nHKLM\\SYSTEM\\CurrentControlSet\\Services\\LanManServer\\Parameters\n\nregistry key. This registry value toggles null session shares on or off to control whether the server service restricts unauthenticated clients' access to named resources.\n\nThe recommended state for this setting is: Enabled\n\nNull sessions are a weakness that can be exploited through shares (including the default shares) on computers in your environment.",
  "solution": "\"To establish the recommended configuration via GP, set the following UI path to Enabled :\n\nComputer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network access: Restrict anonymous access to Named Pipes and Shares",
  "Impact": "None - this is the default behavior. If you choose to enable this setting and are supporting Windows NT 4.0 domains, you should check if any of the named pipes are required to maintain trust relationships between the domains, and then add the pipe to the Network access: Named pipes that can be accessed anonymously list:\n\n - COMNAP: SNA session access\n - COMNODE: SNA session access\n - SQL\\QUERY: SQL instance access\n - SPOOLSS: Spooler service\n - LLSRPC: License Logging service\n - NETLOGON: Net Logon service\n - LSARPC: LSA access\n - SAMR: Remote access to SAM objects\n - BROWSER: Computer Browser service\n\nPrevious to the release of Windows Server 2003 with Service Pack 1 (SP1) these named pipes were allowed anonymous access by default, but with the increased hardening in Windows Server 2003 with SP1 these pipes must be explicitly added if needed.\"",
  "reference": "800-171|3.1.7,800-171r3|03.01.07a.,800-53|AC-6(10),800-53r5|AC-6(10),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,CSF2.0|PR.AA-05,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO-27001-2022|A.5.15,ISO-27001-2022|A.8.2,ISO-27001-2022|A.8.18,ITSG-33|AC-6,LEVEL|1A,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
  "see_also": "https://workbench.cisecurity.org/benchmarks/22007",
  "value_type": "POLICY_DWORD",
  "value_data": "1",
  "reg_key": "HKLM\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters",
  "reg_item": "RestrictNullSessAccess",
  "reg_option": "CAN_NOT_BE_NULL"
}