{
  "type": "REGISTRY_SETTING",
  "description": "18.9.7.1.3 (BL) Ensure 'Prevent installation of devices using drivers that match these device setup classes: Also apply to matching devices that are already installed.' is set to 'True' (checked)",
  "info": "This policy setting allows you to specify a list of device setup class globally unique identifiers (GUIDs) for device drivers that Windows is prevented from installing. This policy setting takes precedence over any other policy setting that allows Windows to install a device.\n\nIf you enable this policy setting, Windows is prevented from installing or updating device drivers whose device setup class GUIDs appear in the list you create. If you enable this policy setting on a remote desktop server, the policy setting affects redirection of the specified devices from a remote desktop client to the remote desktop server.\n\nIf you disable or do not configure this policy setting, Windows can install and update devices as allowed or prevented by other policy settings.\n\nThe recommended state for this setting is: True (checked)\n\nA BitLocker-protected computer may be vulnerable to Direct Memory Access (DMA) attacks when the computer is turned on or is in the Standby power state - this includes when the workstation is locked.\n\nBitLocker with TPM-only authentication lets a computer enter the power-on state without any pre-boot authentication. Therefore, an attacker may be able to perform DMA attacks.\n\nThis issue is documented in Microsoft Knowledge Base article 2516445:\n\nBlocking the SBP-2 driver and Thunderbolt controllers to reduce 1394 DMA and Thunderbolt DMA threats to BitLocker\n\n.",
  "solution": "\"To establish the recommended configuration via GP, set the following UI path to Enabled and check the Also apply to matching devices that are already installed. checkbox:\n\nComputer Configuration\\Policies\\Administrative Templates\\System\\Device Installation\\Device Installation Restrictions\\Prevent installation of devices using drivers that match these device setup classes",
  "Note": "This Group Policy path is provided by the Group Policy template DeviceInstallation.admx/adml that is included with all versions of the Microsoft Windows Administrative Templates.",
  "Impact": "Existing devices (that match the device setup classes specified) that were previously installed prior to the hardening will be disabled or removed.\"",
  "reference": "800-53|SI-16,800-53r5|SI-16,CSCv7|2.5,CSCv8|10.5,CSF2.0|PR.DS-10,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-16,LEVEL|1A",
  "see_also": "https://workbench.cisecurity.org/benchmarks/22007",
  "value_type": "POLICY_DWORD",
  "value_data": "1",
  "reg_key": "HKLM\\Software\\Policies\\Microsoft\\Windows\\DeviceInstall\\Restrictions",
  "reg_item": "DenyDeviceClassesRetroactive",
  "reg_option": "CAN_NOT_BE_NULL"
}