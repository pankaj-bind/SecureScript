{
  "type": "REGISTRY_SETTING",
  "description": "18.9.24.1 (BL) Ensure 'Enumeration policy for external devices incompatible with Kernel DMA Protection' is set to 'Enabled: Block All'",
  "info": "\"This policy is intended to provide additional security against external DMA-capable devices. It allows for more control over the enumeration of external DMA-capable devices that are not compatible with DMA Remapping/device memory isolation and sandboxing.\n\nThe recommended state for this setting is: Enabled: Block All",
  "Note": "This Group Policy path is provided by the Group Policy template DmaGuard.admx/adml that is included with the Microsoft Windows 10 Release 1809 &amp; Server 2019 Administrative Templates (or newer).",
  "solution": "\"To establish the recommended configuration via GP, set the following UI path to Enabled: Block All :\n\nComputer Configuration\\Policies\\Administrative Templates\\System\\Kernel DMA Protection\\Enumeration policy for external devices incompatible with Kernel DMA Protection",
  "Impact": "External devices that are not compatible with DMA-remapping will not be enumerated and will not function unless/until the user has logged in successfully\n\nand\n\nhas an unlocked user session. Once enumerated, these devices will continue to function, regardless of the state of the session. Devices that are compatible with DMA-remapping will be enumerated immediately, with their device memory isolated.\"",
  "reference": "800-171|3.4.1,800-53|CM-8,800-53r5|CM-8,CN-L3|8.1.10.2(a),CN-L3|8.1.10.2(b),CSCv7|1.4,CSF|DE.CM-7,CSF|ID.AM-1,CSF|ID.AM-2,CSF|PR.DS-3,CSF2.0|ID.AM-01,CSF2.0|ID.AM-02,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.5.9,ISO-27001-2022|A.8.9,ITSG-33|CM-8,LEVEL|1A,NESA|T1.2.1,NESA|T1.2.2",
  "see_also": "https://workbench.cisecurity.org/benchmarks/17603",
  "value_type": "POLICY_DWORD",
  "value_data": "0",
  "reg_key": "HKLM\\Software\\Policies\\Microsoft\\Windows\\Kernel DMA Protection",
  "reg_item": "DeviceEnumerationPolicy",
  "reg_option": "CAN_NOT_BE_NULL"
}