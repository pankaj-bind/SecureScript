{
  "check_type": "CONDITIONAL",
  "condition": {
    "auto_status": "FAILED",
    "type": "AND",
    "rules": [
      {
        "type": "REGISTRY_SETTING",
        "description": "Ensure 'DeferFeatureUpdatesPeriodInDays' is 'Windows: Registry Value' to '180'",
        "value_type": "POLICY_DWORD",
        "value_data": "[180..MAX]",
        "reg_key": "HKLM\\Software\\Policies\\Microsoft\\Windows\\WindowsUpdate",
        "reg_item": "DeferFeatureUpdatesPeriodInDays",
        "reg_option": "CAN_NOT_BE_NULL"
      },
      {
        "type": "REGISTRY_SETTING",
        "description": "Ensure 'DeferFeatureUpdates' is 'Windows: Registry Value' to '1'",
        "value_type": "POLICY_DWORD",
        "value_data": "1",
        "reg_key": "HKLM\\Software\\Policies\\Microsoft\\Windows\\WindowsUpdate",
        "reg_item": "DeferFeatureUpdates",
        "reg_option": "CAN_NOT_BE_NULL"
      }
    ]
  },
  "then": {
    "report": {
      "description": "18.10.92.4.2 (L1) Ensure 'Select when Preview Builds and Feature Updates are received' is set to 'Enabled: 180 or more days'",
      "info": "\"This policy setting determines when Preview Build or Feature Updates are received.\n\nDefer Updates This enables devices to defer taking the next Feature Update available to your channel for up to 14 days for all the pre-release channels and up to 365 days for the Semi-Annual Channel. Or, if the device is updating from the Semi-Annual Channel, a version for the device to move to and/or stay on until the policy is updated or the device reaches end of service can be specified. Note: If you set both policies, the version specified will take precedence and the deferrals will not be in effect. Please see the Windows Release Information page for OS version information.\n\nPause Updates To prevent Feature Updates from being received on their scheduled time, you can temporarily pause Feature Updates. The pause will remain in effect for 35 days from the specified start date or until the field is cleared (Quality Updates will still be offered).",
      "Note": "This Group Policy path is provided by the Group Policy template WindowsUpdate.admx/adml that is included with the Microsoft Windows 10 Release 1607 &amp; Server 2016 Administrative Templates (or newer).\n\nNote #2: In older Microsoft Windows Administrative Templates, this setting was initially named\n\nSelect when Feature Updates are received\n\n, but it was renamed to\n\nSelect when Preview Builds and Feature Updates are received\n\nstarting with the Windows 10 Release 1709 Administrative Templates.",
      "solution": "\"To establish the recommended configuration via GP, set the following UI path to Enabled: 180 or more days :\n\nComputer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Update\\Manage updates offered from Windows Update\\Select when Preview Builds and Feature Updates are received",
      "Impact": "Feature Updates will be delayed until they are publicly released to general public by Microsoft.\"",
      "reference": "800-171|3.11.2,800-171|3.11.3,800-171|3.14.1,800-53|RA-5,800-53|SI-2,800-53|SI-2(2),800-53r5|RA-5,800-53r5|RA-7,800-53r5|SI-2,800-53r5|SI-2(2),CN-L3|8.1.4.4(e),CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSCv7|2.4,CSCv8|7.3,CSF|DE.CM-8,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.IP-12,CSF|RS.CO-3,CSF|RS.MI-3,CSF2.0|GV.SC-10,CSF2.0|ID.IM-01,CSF2.0|ID.IM-02,CSF2.0|ID.IM-03,CSF2.0|ID.RA-01,CSF2.0|ID.RA-08,CSF2.0|PR.PS-02,GDPR|32.1.b,GDPR|32.1.d,HIPAA|164.306(a)(1),ISO-27001-2022|A.6.8,ISO-27001-2022|A.8.8,ISO-27001-2022|A.8.32,ISO/IEC-27001|A.12.6.1,ITSG-33|RA-5,ITSG-33|SI-2,ITSG-33|SI-2(2),LEVEL|1A,NESA|M1.2.2,NESA|M5.4.1,NESA|T7.6.2,NESA|T7.7.1,NIAv2|PR9,PCI-DSSv3.2.1|6.1,PCI-DSSv3.2.1|6.2,PCI-DSSv4.0|6.3,PCI-DSSv4.0|6.3.1,PCI-DSSv4.0|6.3.3,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,SWIFT-CSCv1|2.2,SWIFT-CSCv1|2.7",
      "see_also": "https://workbench.cisecurity.org/benchmarks/17603",
      "show_output": true,
      "type": "PASSED"
    }
  }
}