{
  "check_type": "CONDITIONAL",
  "condition": {
    "auto_status": "FAILED",
    "type": "AND",
    "rules": [
      {
        "type": "REGISTRY_SETTING",
        "description": "3b576869-a4ec-4529-8536-b80a7769e899",
        "value_type": "POLICY_TEXT",
        "value_data": "1",
        "reg_key": "HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules",
        "reg_item": "3b576869-a4ec-4529-8536-b80a7769e899",
        "reg_option": "CAN_NOT_BE_NULL"
      },
      {
        "type": "REGISTRY_SETTING",
        "description": "9e6c4e1f-7d60-472f-ba1a-a39ef669e4b2",
        "value_type": "POLICY_TEXT",
        "value_data": "1",
        "reg_key": "HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules",
        "reg_item": "9e6c4e1f-7d60-472f-ba1a-a39ef669e4b2",
        "reg_option": "CAN_NOT_BE_NULL"
      },
      {
        "type": "REGISTRY_SETTING",
        "description": "7674ba52-37eb-4a4f-a9a1-f0f9a1619a2c",
        "value_type": "POLICY_TEXT",
        "value_data": "1",
        "reg_key": "HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules",
        "reg_item": "7674ba52-37eb-4a4f-a9a1-f0f9a1619a2c",
        "reg_option": "CAN_NOT_BE_NULL"
      },
      {
        "type": "REGISTRY_SETTING",
        "description": "56a863a9-875e-4185-98a7-b882c64b5ce5",
        "value_type": "POLICY_TEXT",
        "value_data": "1",
        "reg_key": "HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules",
        "reg_item": "56a863a9-875e-4185-98a7-b882c64b5ce5",
        "reg_option": "CAN_NOT_BE_NULL"
      },
      {
        "type": "REGISTRY_SETTING",
        "description": "d4f940ab-401b-4efc-aadc-ad5f3c50688a",
        "value_type": "POLICY_TEXT",
        "value_data": "1",
        "reg_key": "HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules",
        "reg_item": "d4f940ab-401b-4efc-aadc-ad5f3c50688a",
        "reg_option": "CAN_NOT_BE_NULL"
      },
      {
        "type": "REGISTRY_SETTING",
        "description": "e6db77e5-3df2-4cf1-b95a-636979351e5b",
        "value_type": "POLICY_TEXT",
        "value_data": "1",
        "reg_key": "HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules",
        "reg_item": "e6db77e5-3df2-4cf1-b95a-636979351e5b",
        "reg_option": "CAN_NOT_BE_NULL"
      },
      {
        "type": "REGISTRY_SETTING",
        "description": "92e97fa1-2edf-4476-bdd6-9dd0b4dddc7b",
        "value_type": "POLICY_TEXT",
        "value_data": "1",
        "reg_key": "HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules",
        "reg_item": "92e97fa1-2edf-4476-bdd6-9dd0b4dddc7b",
        "reg_option": "CAN_NOT_BE_NULL"
      },
      {
        "type": "REGISTRY_SETTING",
        "description": "d3e037e1-3eb8-44c8-a917-57927947596d",
        "value_type": "POLICY_TEXT",
        "value_data": "1",
        "reg_key": "HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules",
        "reg_item": "d3e037e1-3eb8-44c8-a917-57927947596d",
        "reg_option": "CAN_NOT_BE_NULL"
      },
      {
        "type": "REGISTRY_SETTING",
        "description": "5beb7efe-fd9a-4556-801d-275e5ffc04cc",
        "value_type": "POLICY_TEXT",
        "value_data": "1",
        "reg_key": "HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules",
        "reg_item": "5beb7efe-fd9a-4556-801d-275e5ffc04cc",
        "reg_option": "CAN_NOT_BE_NULL"
      },
      {
        "type": "REGISTRY_SETTING",
        "description": "26190899-1602-49e8-8b27-eb1d0a1ce869",
        "value_type": "POLICY_TEXT",
        "value_data": "1",
        "reg_key": "HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules",
        "reg_item": "26190899-1602-49e8-8b27-eb1d0a1ce869",
        "reg_option": "CAN_NOT_BE_NULL"
      },
      {
        "type": "REGISTRY_SETTING",
        "description": "b2b3f03d-6a65-4f7b-a9c7-1c7ef74a9ba4",
        "value_type": "POLICY_TEXT",
        "value_data": "1",
        "reg_key": "HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules",
        "reg_item": "b2b3f03d-6a65-4f7b-a9c7-1c7ef74a9ba4",
        "reg_option": "CAN_NOT_BE_NULL"
      },
      {
        "type": "REGISTRY_SETTING",
        "description": "be9ba2d9-53ea-4cdc-84e5-9b1eeee46550",
        "value_type": "POLICY_TEXT",
        "value_data": "1",
        "reg_key": "HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules",
        "reg_item": "be9ba2d9-53ea-4cdc-84e5-9b1eeee46550",
        "reg_option": "CAN_NOT_BE_NULL"
      },
      {
        "type": "REGISTRY_SETTING",
        "description": "75668c1f-73b5-4cf0-bb93-3ecf5cb7cc84",
        "value_type": "POLICY_TEXT",
        "value_data": "1",
        "reg_key": "HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules",
        "reg_item": "75668c1f-73b5-4cf0-bb93-3ecf5cb7cc84",
        "reg_option": "CAN_NOT_BE_NULL"
      }
    ]
  },
  "then": {
    "report": {
      "description": "18.10.43.6.1.2 (L1) Ensure 'Configure Attack Surface Reduction rules: Set the state for each ASR rule' is configured",
      "info": "\"This policy setting sets the Attack Surface Reduction rules.\n\nThe recommended state for this setting is:\n\n26190899-1602-49e8-8b27-eb1d0a1ce869 - 1 (Block Office communication application from creating child processes)\n\n3b576869-a4ec-4529-8536-b80a7769e899 - 1 (Block Office applications from creating executable content)\n\n56a863a9-875e-4185-98a7-b882c64b5ce5 - 1 (Block abuse of exploited vulnerable signed drivers)\n\n5beb7efe-fd9a-4556-801d-275e5ffc04cc - 1 (Block execution of potentially obfuscated scripts)\n\n75668c1f-73b5-4cf0-bb93-3ecf5cb7cc84 - 1 (Block Office applications from injecting code into other processes)\n\n7674ba52-37eb-4a4f-a9a1-f0f9a1619a2c - 1 (Block Adobe Reader from creating child processes)\n\n92e97fa1-2edf-4476-bdd6-9dd0b4dddc7b - 1 (Block Win32 API calls from Office macro)\n\n9e6c4e1f-7d60-472f-ba1a-a39ef669e4b2 - 1 (Block credential stealing from the Windows local security authority subsystem (lsass.exe))\n\nb2b3f03d-6a65-4f7b-a9c7-1c7ef74a9ba4 - 1 (Block untrusted and unsigned processes that run from USB)\n\nbe9ba2d9-53ea-4cdc-84e5-9b1eeee46550 - 1 (Block executable content from email client and webmail)\n\nd3e037e1-3eb8-44c8-a917-57927947596d - 1 (Block JavaScript or VBScript from launching downloaded executable content)\n\nd4f940ab-401b-4efc-aadc-ad5f3c50688a - 1 (Block Office applications from creating child processes)\n\ne6db77e5-3df2-4cf1-b95a-636979351e5b - 1 (Block persistence through WMI event subscription)",
      "Note": "This Group Policy path is provided by the Group Policy template WindowsDefender.admx/adml that is included with the Microsoft Windows 10 Release 1709 Administrative Templates (or newer).",
      "solution": "\"To establish the recommended configuration via GP, set the following UI path so that 26190899-1602-49e8-8b27-eb1d0a1ce869 3b576869-a4ec-4529-8536-b80a7769e899 56a863a9-875e-4185-98a7-b882c64b5ce5 5beb7efe-fd9a-4556-801d-275e5ffc04cc 75668c1f-73b5-4cf0-bb93-3ecf5cb7cc84 7674ba52-37eb-4a4f-a9a1-f0f9a1619a2c 92e97fa1-2edf-4476-bdd6-9dd0b4dddc7b 9e6c4e1f-7d60-472f-ba1a-a39ef669e4b2 b2b3f03d-6a65-4f7b-a9c7-1c7ef74a9ba4 be9ba2d9-53ea-4cdc-84e5-9b1eeee46550 d3e037e1-3eb8-44c8-a917-57927947596d d4f940ab-401b-4efc-aadc-ad5f3c50688a and e6db77e5-3df2-4cf1-b95a-636979351e5b are each set to a value of 1 :\n\nComputer Configuration\\Policies\\Administrative Templates\\Windows Components\\Microsoft Defender Antivirus\\Microsoft Defender Exploit Guard\\Attack Surface Reduction\\Configure Attack Surface Reduction rules: Set the state for each ASR rule",
      "Impact": "When a rule is triggered, a notification will be displayed from the Action Center.\"",
      "reference": "800-53|SI-16,800-53r5|SI-16,CSCv7|8.3,CSCv8|10.5,CSF2.0|PR.DS-10,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-16,LEVEL|1A",
      "see_also": "https://workbench.cisecurity.org/benchmarks/21318",
      "show_output": true,
      "type": "PASSED"
    }
  }
}