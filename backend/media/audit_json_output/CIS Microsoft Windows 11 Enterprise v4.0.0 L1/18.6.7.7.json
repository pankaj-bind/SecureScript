{
  "type": "REGISTRY_SETTING",
  "description": "18.6.7.7 (L1) Ensure 'Set authentication rate limiter delay (milliseconds)' is set to 'Enabled: 2000' or more",
  "info": "This policy settings configures the SMB server invalid authentication delay value in milliseconds.\n\nThe recommended state for this setting is: Enabled: 2000 or more.\n\nAuthentication rate limiter considerably reduces the risk of brute force attacks by implementing a 2-second delay (default) between each failed NTLM or PKU2U-based authentication attempt.\n\nAccording to Microsoft\n\n, if an attacker sends 300 brute force attempts per second from a client for 5 minutes which equals 90,000 passwords, the same number of attempts would now take 50 hours or more.",
  "solution": "\"To establish the recommended configuration via GP, set the following UI path to Enabled: 2000 or more:\n\nComputer Configuration\\Policies\\Administrative Templates\\Network\\Lanman Server\\Set authentication rate limiter delay (milliseconds)",
  "Note": "This Group Policy path may not exist by default. It is provided by the Group Policy template LanmanServer.admx/adml that is included with the Microsoft Windows 11 Release 24H2 Administrative Templates (or newer).",
  "Impact": "None - 2,000 milliseconds (2 seconds) is the default behavior.\"",
  "reference": "800-171|3.13.2,800-171|3.13.5,800-171r3|03.13.01,800-53|SC-7(20),800-53r5|SC-7(20),CN-L3|8.1.10.6(j),CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,CSF2.0|DE.CM-01,CSF2.0|PR.DS-01,CSF2.0|PR.DS-02,CSF2.0|PR.DS-10,CSF2.0|PR.IR-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.5.14,ISO-27001-2022|A.8.16,ISO-27001-2022|A.8.20,ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,LEVEL|1A,NESA|T4.5.3,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
  "see_also": "https://workbench.cisecurity.org/benchmarks/21318",
  "value_type": "POLICY_DWORD",
  "value_data": "[2000..MAX]",
  "reg_key": "HKLM\\Software\\Policies\\Microsoft\\Windows\\LanmanServer",
  "reg_item": "InvalidAuthenticationDelayTimeInMs",
  "reg_option": "CAN_NOT_BE_NULL"
}