{
  "check_type": "CONDITIONAL",
  "condition": {
    "auto_status": "FAILED",
    "type": "AND",
    "rules": [
      {
        "type": "REGISTRY_SETTING",
        "description": "Extension 2",
        "value_type": "POLICY_TEXT",
        "value_data": "extension|hosted_app|platform_app|theme",
        "reg_key": "HKLM\\Software\\Policies\\Google\\Chrome\\ExtensionAllowedTypes",
        "reg_item": "2",
        "reg_option": "CAN_NOT_BE_NULL",
        "check_type": "CHECK_REGEX"
      },
      {
        "type": "REGISTRY_SETTING",
        "description": "Extension 4",
        "value_type": "POLICY_TEXT",
        "value_data": "extension|hosted_app|platform_app|theme",
        "reg_key": "HKLM\\Software\\Policies\\Google\\Chrome\\ExtensionAllowedTypes",
        "reg_item": "4",
        "reg_option": "CAN_NOT_BE_NULL",
        "check_type": "CHECK_REGEX"
      },
      {
        "type": "REGISTRY_SETTING",
        "description": "Extension 3",
        "value_type": "POLICY_TEXT",
        "value_data": "extension|hosted_app|platform_app|theme",
        "reg_key": "HKLM\\Software\\Policies\\Google\\Chrome\\ExtensionAllowedTypes",
        "reg_item": "3",
        "reg_option": "CAN_NOT_BE_NULL",
        "check_type": "CHECK_REGEX"
      },
      {
        "type": "REGISTRY_SETTING",
        "description": "Extension 1",
        "value_type": "POLICY_TEXT",
        "value_data": "extension|hosted_app|platform_app|theme",
        "reg_key": "HKLM\\Software\\Policies\\Google\\Chrome\\ExtensionAllowedTypes",
        "reg_item": "1",
        "reg_option": "CAN_NOT_BE_NULL",
        "check_type": "CHECK_REGEX"
      }
    ]
  },
  "then": {
    "report": {
      "description": "2.3.2 (L1) Ensure 'Configure allowed app/extension types' is set to 'Enabled: extension, hosted_app, platform_app, theme'",
      "info": "\"Enabling this setting allows you to specify which app/extension types are allowed.\n\nDisabled (0): Results in no restrictions on the acceptable extension and app types.\n\nThe recommended state for this setting is: Enabled with the values of extension hosted_app platform_app theme\n\nApp or extension types that could be misused or are deprecated shall no longer be installed.",
      "NOTE": "Google has removed support for Chrome Apps which includes the types hosted_app and platform_app. The blog post indicates that these types will require a setting to be enabled for continued use through June 2022.\"",
      "solution": "\"To establish the recommended configuration via Group Policy, set the following UI path to Enabled: extension, hosted_app, platform_app, theme :\n\nComputer Configuration\\Polices\\Administrative Templates\\Google\\Google Chrome\\Extensions\\Configure allowed app/extension types",
      "Impact": "Extensions already installed will be removed if its type is denylisted and the extension itself is not allowlisted.\"",
      "reference": "800-171|3.4.9,800-171|3.13.13,800-171r3|03.13.13,800-53|CM-10,800-53|CM-11,800-53|SC-18,800-53r5|CM-10,800-53r5|CM-11,800-53r5|SC-18,CSCv7|7.2,CSCv8|9.4,CSF|DE.CM-3,CSF|DE.CM-5,CSF2.0|DE.CM-03,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,CSF2.0|PR.PS-02,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.5.32,ISO-27001-2022|A.8.19,ISO/IEC-27001|A.12.6.2,ITSG-33|SC-18,LEVEL|1A,NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1,SWIFT-CSCv1|5.1",
      "see_also": "https://workbench.cisecurity.org/benchmarks/8691",
      "show_output": true,
      "type": "PASSED"
    }
  }
}