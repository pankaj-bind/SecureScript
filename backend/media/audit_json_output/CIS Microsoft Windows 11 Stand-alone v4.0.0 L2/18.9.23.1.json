{
  "check_type": "CONDITIONAL",
  "condition": {
    "auto_status": "FAILED",
    "type": "AND",
    "rules": [
      {
        "type": "REGISTRY_SETTING",
        "description": "Ensure 'DevicePKInitBehavior' is 'Windows: Registry Value' to '0'",
        "value_type": "POLICY_DWORD",
        "value_data": "0",
        "reg_key": "HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\kerberos\\parameters",
        "reg_item": "DevicePKInitBehavior",
        "reg_option": "CAN_NOT_BE_NULL"
      },
      {
        "type": "REGISTRY_SETTING",
        "description": "Ensure 'DevicePKInitEnabled' is 'Windows: Registry Value' to '1'",
        "value_type": "POLICY_DWORD",
        "value_data": "1",
        "reg_key": "HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\kerberos\\parameters",
        "reg_item": "DevicePKInitEnabled",
        "reg_option": "CAN_NOT_BE_NULL"
      }
    ]
  },
  "then": {
    "report": {
      "description": "18.9.23.1 (L2) Ensure 'Support device authentication using certificate' is set to 'Enabled: Automatic'",
      "info": "This policy setting allows you to set support for Kerberos to attempt authentication using the certificate for the device to the domain.\n\nSupport for device authentication using certificate will require connectivity to a DC in the device account domain which supports certificate authentication for computer accounts.\n\nThe recommended state for this setting is: Enabled: Automatic\n\nHaving stronger device authentication with the use of certificates is strongly encouraged over standard username and password authentication. Having this set to Automatic will allow certificate based authentication to be used whenever possible.",
      "solution": "\"To establish the recommended configuration via GP, set the following UI path to Enabled: Automatic :\n\nComputer Configuration\\Policies\\Administrative Templates\\System\\Kerberos\\Support device authentication using certificate",
      "Note": "This Group Policy path is provided by the Group Policy template Kerberos.admx/adml that is included with the Microsoft Windows 10 RTM (Release 1507) Administrative Templates (or newer).",
      "Impact": "None - this is the default behavior.\"",
      "reference": "800-171|3.4.1,800-171r3|03.04.10,800-171r3|03.05.02,800-53|CM-8,800-53|IA-3,800-53r5|CM-8,800-53r5|IA-3,CN-L3|8.1.10.2(a),CN-L3|8.1.10.2(b),CSCv7|1.6,CSCv7|1.8,CSF|DE.CM-7,CSF|ID.AM-1,CSF|ID.AM-2,CSF|PR.AC-1,CSF|PR.DS-3,CSF2.0|ID.AM-01,CSF2.0|ID.AM-02,CSF2.0|PR.AA-01,CSF2.0|PR.AA-03,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO-27001-2022|A.5.9,ISO-27001-2022|A.8.9,ITSG-33|CM-8,ITSG-33|IA-3,ITSG-33|IA-3a.,LEVEL|2A,NESA|T1.2.1,NESA|T1.2.2,NESA|T5.4.3,QCSC-v1|13.2,TBA-FIISB|27.1",
      "see_also": "https://workbench.cisecurity.org/benchmarks/22007",
      "show_output": true,
      "type": "PASSED"
    }
  }
}