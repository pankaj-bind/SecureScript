{
  "type": "REGISTRY_SETTING",
  "description": "5.36 (L2) Ensure 'WinHTTP Web Proxy Auto-Discovery Service (WinHttpAutoProxySvc)' is set to 'Disabled'",
  "info": "\"WinHTTP implements the client HTTP stack and provides developers with a Win32 API and COM Automation component for sending HTTP requests and receiving responses. In addition, WinHTTP provides support for auto-discovering a proxy configuration via its implementation of the Web Proxy Auto-Discovery (WPAD) protocol.\n\nThe recommended state for this setting is: Disabled",
  "Note": "Although CIS categorizes this as a L2 recommendation, if none of the cases listed in the Impact Section apply, we highly recommend disabling this service.\n\nThis service is primarily needed to support Web Proxy Auto-Discovery (WPAD), which is an auto-proxy discovery mechanism that could expose the computer to Man-In-The-Middle (MITM) attacks. If an organization depends on HTTP proxy configuration, it is recommended that other client configuration mechanisms be used instead, such as Group Policy.\"",
  "solution": "\"To establish the recommended configuration, run the following PowerShell command:\n\nSet-Service -Name WinHttpAutoProxySvc -StartupType Disabled",
  "Impact": "WPAD will cease to function for automatic HTTP proxy routing, which may prevent Internet connectivity for workstations in organizations that currently use WPAD. Microsoft also cautions that some software that uses the network stack may have a functional dependency on this service, so it is advised that you test disabling this service on a representation of user workstations and applications before disabling it across the entire organization.\n\nBeginning with Windows 10 Release 1709, Microsoft changed the WPAD service to tightly integrate it with all proxy activity. Disabling this service now has these additional impacts:\n\n - The ability to set a manual (not just auto) proxy configuration.\n - Some VPN clients require the WPAD service, so disabling WPAD breaks them.\n - Some network-related applications will not work without WPAD running (e.g. Fiddler).\"",
  "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171r3|03.04.02,800-171r3|03.04.06,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,CSF2.0|DE.CM-09,CSF2.0|PR.PS-01,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO-27001-2022|A.8.9,ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
  "see_also": "https://workbench.cisecurity.org/benchmarks/22007",
  "value_type": "POLICY_DWORD",
  "value_data": "4",
  "reg_key": "HKLM\\System\\CurrentControlSet\\Services\\WinHttpAutoProxySvc",
  "reg_item": "Start",
  "reg_option": "CAN_NOT_BE_NULL"
}