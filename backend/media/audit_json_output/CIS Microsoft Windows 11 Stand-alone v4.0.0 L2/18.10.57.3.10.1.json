{
  "type": "REGISTRY_SETTING",
  "description": "18.10.57.3.10.1 (L2) Ensure 'Set time limit for active but idle Remote Desktop Services sessions' is set to 'Enabled: 15 minutes or less, but not Never (0)'",
  "info": "This policy setting allows you to specify the maximum amount of time that an active Remote Desktop Services session can be idle (without user input) before it is automatically disconnected.\n\nThe recommended state for this setting is: Enabled: 15 minutes or less, but not Never (0)\n\nThis setting helps to prevent active Remote Desktop sessions from tying up the computer for long periods of time while not in use, preventing computing resources from being consumed by large numbers of inactive sessions. In addition, old, forgotten Remote Desktop sessions that are still active can cause password lockouts if the user's password has changed but the old session is still running. For systems that limit the number of connected users (e.g. servers in the default Administrative mode - 2 sessions only), other users' old but still active sessions can prevent another user from connecting, resulting in an effective denial of service.\n\nIn addition, session timeouts that are misconfigured or set for a long period of time can leave the system open to an attacker hijacking the session.",
  "solution": "\"To establish the recommended configuration via GP, set the following UI path to Enabled: 15 minutes or less, but not Never (0) :\n\nComputer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Session Host\\Session Time Limits\\Set time limit for active but idle Remote Desktop Services sessions",
  "Note": "This Group Policy path is provided by the Group Policy template TerminalServer.admx/adml that is included with all versions of the Microsoft Windows Administrative Templates.\n\nNote #2: In older Microsoft Windows Administrative Templates, this setting was named\n\nSet time limit for active but idle Terminal Services sessions\n\n, but it was renamed starting with the Windows 7 & Server 2008 R2 Administrative Templates.",
  "Impact": "Remote Desktop Services will automatically disconnect active but idle sessions after 15 minutes (or the specified amount of time). The user receives a warning two minutes before the session disconnects, which allows the user to press a key or move the mouse to keep the session active. Note that idle session time limits do not apply to console sessions.\"",
  "reference": "800-171|3.1.10,800-171r3|03.01.10,800-53|AC-11,800-53r5|AC-11,CN-L3|8.1.4.1(b),CSCv7|16.11,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO-27001-2022|A.7.7,ISO-27001-2022|A.8.1,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11,LEVEL|2A,NIAv2|AM23c,NIAv2|AM23d,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8",
  "see_also": "https://workbench.cisecurity.org/benchmarks/22007",
  "value_type": "POLICY_DWORD",
  "value_data": "[1..900000]",
  "reg_key": "HKLM\\Software\\Policies\\Microsoft\\Windows NT\\Terminal Services",
  "reg_item": "MaxIdleTime",
  "reg_option": "CAN_NOT_BE_NULL"
}