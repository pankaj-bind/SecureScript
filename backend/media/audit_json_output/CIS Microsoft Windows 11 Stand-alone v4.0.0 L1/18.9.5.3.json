{
  "type": "REGISTRY_SETTING",
  "description": "18.9.5.3 (L1) Ensure 'Turn On Virtualization Based Security: Virtualization Based Protection of Code Integrity' is set to 'Enabled with UEFI lock'",
  "info": "\"This setting enables virtualization based protection of Kernel Mode Code Integrity. When this is enabled, kernel mode memory protections are enforced and the Code Integrity validation path is protected by the Virtualization Based Security feature.\n\nThe recommended state for this setting is: Enabled with UEFI lock",
  "Note": "This Group Policy path is provided by the Group Policy template DeviceGuard.admx/adml that is included with the Microsoft Windows 10 RTM (Release 1507) Administrative Templates (or newer).",
  "solution": "\"To establish the recommended configuration via GP, set the following UI path to Enabled with UEFI lock :\n\nComputer Configuration\\Policies\\Administrative Templates\\System\\Device Guard\\Turn On Virtualization Based Security: Virtualization Based Protection of Code Integrity",
  "Impact": "Note: This setting was moved from the Next Generation (NG) profile to the Level 1 (L1) profile for the Windows 11 Operating System only NG profile settings were isolated from the L1 profile due to potential hardware compatibility issues. The Windows 11 Operating System is dependent on the same hardware as the NG settings, so hardware compatibility is no longer an issue.",
  "Warning": "All drivers on the system must be compatible with this feature or the system may crash. Ensure that this policy setting is only deployed to computers which are known to be compatible.\n\nWarning #2: Once this setting is turned on and active, Virtualization Based Security cannot be disabled solely via GPO or any other remote method. After removing the setting from GPO, the features must also be manually disabled\n\nlocally at the machine\n\nusing the steps provided at this link:\n\nManage Windows Defender Credential Guard (Windows 10) | Microsoft Docs\"",
  "reference": "800-53|SI-16,800-53r5|SI-16,CSCv7|8.3,CSCv8|10.5,CSF2.0|PR.DS-10,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-16,LEVEL|1A",
  "see_also": "https://workbench.cisecurity.org/benchmarks/22007",
  "value_type": "POLICY_DWORD",
  "value_data": "1",
  "reg_key": "HKLM\\Software\\Policies\\Microsoft\\Windows\\DeviceGuard",
  "reg_item": "HypervisorEnforcedCodeIntegrity",
  "reg_option": "CAN_NOT_BE_NULL"
}